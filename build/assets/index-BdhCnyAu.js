function Zk(e,r){for(var t=0;t<r.length;t++){const s=r[t];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(s,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function y1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var eh={exports:{}},Rl={},th={exports:{}},Rt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oy;function e_(){if(oy)return Rt;oy=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),y=Symbol.iterator;function v(ee){return ee===null||typeof ee!="object"?null:(ee=y&&ee[y]||ee["@@iterator"],typeof ee=="function"?ee:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,w={};function j(ee,U,re){this.props=ee,this.context=U,this.refs=w,this.updater=re||k}j.prototype.isReactComponent={},j.prototype.setState=function(ee,U){if(typeof ee!="object"&&typeof ee!="function"&&ee!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ee,U,"setState")},j.prototype.forceUpdate=function(ee){this.updater.enqueueForceUpdate(this,ee,"forceUpdate")};function O(){}O.prototype=j.prototype;function T(ee,U,re){this.props=ee,this.context=U,this.refs=w,this.updater=re||k}var F=T.prototype=new O;F.constructor=T,b(F,j.prototype),F.isPureReactComponent=!0;var I=Array.isArray,G=Object.prototype.hasOwnProperty,B={current:null},Q={key:!0,ref:!0,__self:!0,__source:!0};function z(ee,U,re){var Y,Z={},xe=null,ie=null;if(U!=null)for(Y in U.ref!==void 0&&(ie=U.ref),U.key!==void 0&&(xe=""+U.key),U)G.call(U,Y)&&!Q.hasOwnProperty(Y)&&(Z[Y]=U[Y]);var Te=arguments.length-2;if(Te===1)Z.children=re;else if(1<Te){for(var ve=Array(Te),Ee=0;Ee<Te;Ee++)ve[Ee]=arguments[Ee+2];Z.children=ve}if(ee&&ee.defaultProps)for(Y in Te=ee.defaultProps,Te)Z[Y]===void 0&&(Z[Y]=Te[Y]);return{$$typeof:e,type:ee,key:xe,ref:ie,props:Z,_owner:B.current}}function J(ee,U){return{$$typeof:e,type:ee.type,key:U,ref:ee.ref,props:ee.props,_owner:ee._owner}}function ne(ee){return typeof ee=="object"&&ee!==null&&ee.$$typeof===e}function fe(ee){var U={"=":"=0",":":"=2"};return"$"+ee.replace(/[=:]/g,function(re){return U[re]})}var me=/\/+/g;function le(ee,U){return typeof ee=="object"&&ee!==null&&ee.key!=null?fe(""+ee.key):U.toString(36)}function K(ee,U,re,Y,Z){var xe=typeof ee;(xe==="undefined"||xe==="boolean")&&(ee=null);var ie=!1;if(ee===null)ie=!0;else switch(xe){case"string":case"number":ie=!0;break;case"object":switch(ee.$$typeof){case e:case r:ie=!0}}if(ie)return ie=ee,Z=Z(ie),ee=Y===""?"."+le(ie,0):Y,I(Z)?(re="",ee!=null&&(re=ee.replace(me,"$&/")+"/"),K(Z,U,re,"",function(Ee){return Ee})):Z!=null&&(ne(Z)&&(Z=J(Z,re+(!Z.key||ie&&ie.key===Z.key?"":(""+Z.key).replace(me,"$&/")+"/")+ee)),U.push(Z)),1;if(ie=0,Y=Y===""?".":Y+":",I(ee))for(var Te=0;Te<ee.length;Te++){xe=ee[Te];var ve=Y+le(xe,Te);ie+=K(xe,U,re,ve,Z)}else if(ve=v(ee),typeof ve=="function")for(ee=ve.call(ee),Te=0;!(xe=ee.next()).done;)xe=xe.value,ve=Y+le(xe,Te++),ie+=K(xe,U,re,ve,Z);else if(xe==="object")throw U=String(ee),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(ee).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return ie}function Fe(ee,U,re){if(ee==null)return ee;var Y=[],Z=0;return K(ee,Y,"","",function(xe){return U.call(re,xe,Z++)}),Y}function we(ee){if(ee._status===-1){var U=ee._result;U=U(),U.then(function(re){(ee._status===0||ee._status===-1)&&(ee._status=1,ee._result=re)},function(re){(ee._status===0||ee._status===-1)&&(ee._status=2,ee._result=re)}),ee._status===-1&&(ee._status=0,ee._result=U)}if(ee._status===1)return ee._result.default;throw ee._result}var oe={current:null},V={transition:null},de={ReactCurrentDispatcher:oe,ReactCurrentBatchConfig:V,ReactCurrentOwner:B};function Ne(){throw Error("act(...) is not supported in production builds of React.")}return Rt.Children={map:Fe,forEach:function(ee,U,re){Fe(ee,function(){U.apply(this,arguments)},re)},count:function(ee){var U=0;return Fe(ee,function(){U++}),U},toArray:function(ee){return Fe(ee,function(U){return U})||[]},only:function(ee){if(!ne(ee))throw Error("React.Children.only expected to receive a single React element child.");return ee}},Rt.Component=j,Rt.Fragment=t,Rt.Profiler=a,Rt.PureComponent=T,Rt.StrictMode=s,Rt.Suspense=p,Rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=de,Rt.act=Ne,Rt.cloneElement=function(ee,U,re){if(ee==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ee+".");var Y=b({},ee.props),Z=ee.key,xe=ee.ref,ie=ee._owner;if(U!=null){if(U.ref!==void 0&&(xe=U.ref,ie=B.current),U.key!==void 0&&(Z=""+U.key),ee.type&&ee.type.defaultProps)var Te=ee.type.defaultProps;for(ve in U)G.call(U,ve)&&!Q.hasOwnProperty(ve)&&(Y[ve]=U[ve]===void 0&&Te!==void 0?Te[ve]:U[ve])}var ve=arguments.length-2;if(ve===1)Y.children=re;else if(1<ve){Te=Array(ve);for(var Ee=0;Ee<ve;Ee++)Te[Ee]=arguments[Ee+2];Y.children=Te}return{$$typeof:e,type:ee.type,key:Z,ref:xe,props:Y,_owner:ie}},Rt.createContext=function(ee){return ee={$$typeof:c,_currentValue:ee,_currentValue2:ee,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ee.Provider={$$typeof:o,_context:ee},ee.Consumer=ee},Rt.createElement=z,Rt.createFactory=function(ee){var U=z.bind(null,ee);return U.type=ee,U},Rt.createRef=function(){return{current:null}},Rt.forwardRef=function(ee){return{$$typeof:u,render:ee}},Rt.isValidElement=ne,Rt.lazy=function(ee){return{$$typeof:x,_payload:{_status:-1,_result:ee},_init:we}},Rt.memo=function(ee,U){return{$$typeof:h,type:ee,compare:U===void 0?null:U}},Rt.startTransition=function(ee){var U=V.transition;V.transition={};try{ee()}finally{V.transition=U}},Rt.unstable_act=Ne,Rt.useCallback=function(ee,U){return oe.current.useCallback(ee,U)},Rt.useContext=function(ee){return oe.current.useContext(ee)},Rt.useDebugValue=function(){},Rt.useDeferredValue=function(ee){return oe.current.useDeferredValue(ee)},Rt.useEffect=function(ee,U){return oe.current.useEffect(ee,U)},Rt.useId=function(){return oe.current.useId()},Rt.useImperativeHandle=function(ee,U,re){return oe.current.useImperativeHandle(ee,U,re)},Rt.useInsertionEffect=function(ee,U){return oe.current.useInsertionEffect(ee,U)},Rt.useLayoutEffect=function(ee,U){return oe.current.useLayoutEffect(ee,U)},Rt.useMemo=function(ee,U){return oe.current.useMemo(ee,U)},Rt.useReducer=function(ee,U,re){return oe.current.useReducer(ee,U,re)},Rt.useRef=function(ee){return oe.current.useRef(ee)},Rt.useState=function(ee){return oe.current.useState(ee)},Rt.useSyncExternalStore=function(ee,U,re){return oe.current.useSyncExternalStore(ee,U,re)},Rt.useTransition=function(){return oe.current.useTransition()},Rt.version="18.3.1",Rt}var ly;function $u(){return ly||(ly=1,th.exports=e_()),th.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cy;function t_(){if(cy)return Rl;cy=1;var e=$u(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(u,p,h){var x,y={},v=null,k=null;h!==void 0&&(v=""+h),p.key!==void 0&&(v=""+p.key),p.ref!==void 0&&(k=p.ref);for(x in p)s.call(p,x)&&!o.hasOwnProperty(x)&&(y[x]=p[x]);if(u&&u.defaultProps)for(x in p=u.defaultProps,p)y[x]===void 0&&(y[x]=p[x]);return{$$typeof:r,type:u,key:v,ref:k,props:y,_owner:a.current}}return Rl.Fragment=t,Rl.jsx=c,Rl.jsxs=c,Rl}var dy;function r_(){return dy||(dy=1,eh.exports=t_()),eh.exports}var n=r_(),Ld={},rh={exports:{}},Dn={},nh={exports:{}},sh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uy;function n_(){return uy||(uy=1,(function(e){function r(V,de){var Ne=V.length;V.push(de);e:for(;0<Ne;){var ee=Ne-1>>>1,U=V[ee];if(0<a(U,de))V[ee]=de,V[Ne]=U,Ne=ee;else break e}}function t(V){return V.length===0?null:V[0]}function s(V){if(V.length===0)return null;var de=V[0],Ne=V.pop();if(Ne!==de){V[0]=Ne;e:for(var ee=0,U=V.length,re=U>>>1;ee<re;){var Y=2*(ee+1)-1,Z=V[Y],xe=Y+1,ie=V[xe];if(0>a(Z,Ne))xe<U&&0>a(ie,Z)?(V[ee]=ie,V[xe]=Ne,ee=xe):(V[ee]=Z,V[Y]=Ne,ee=Y);else if(xe<U&&0>a(ie,Ne))V[ee]=ie,V[xe]=Ne,ee=xe;else break e}}return de}function a(V,de){var Ne=V.sortIndex-de.sortIndex;return Ne!==0?Ne:V.id-de.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var p=[],h=[],x=1,y=null,v=3,k=!1,b=!1,w=!1,j=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(V){for(var de=t(h);de!==null;){if(de.callback===null)s(h);else if(de.startTime<=V)s(h),de.sortIndex=de.expirationTime,r(p,de);else break;de=t(h)}}function I(V){if(w=!1,F(V),!b)if(t(p)!==null)b=!0,we(G);else{var de=t(h);de!==null&&oe(I,de.startTime-V)}}function G(V,de){b=!1,w&&(w=!1,O(z),z=-1),k=!0;var Ne=v;try{for(F(de),y=t(p);y!==null&&(!(y.expirationTime>de)||V&&!fe());){var ee=y.callback;if(typeof ee=="function"){y.callback=null,v=y.priorityLevel;var U=ee(y.expirationTime<=de);de=e.unstable_now(),typeof U=="function"?y.callback=U:y===t(p)&&s(p),F(de)}else s(p);y=t(p)}if(y!==null)var re=!0;else{var Y=t(h);Y!==null&&oe(I,Y.startTime-de),re=!1}return re}finally{y=null,v=Ne,k=!1}}var B=!1,Q=null,z=-1,J=5,ne=-1;function fe(){return!(e.unstable_now()-ne<J)}function me(){if(Q!==null){var V=e.unstable_now();ne=V;var de=!0;try{de=Q(!0,V)}finally{de?le():(B=!1,Q=null)}}else B=!1}var le;if(typeof T=="function")le=function(){T(me)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Fe=K.port2;K.port1.onmessage=me,le=function(){Fe.postMessage(null)}}else le=function(){j(me,0)};function we(V){Q=V,B||(B=!0,le())}function oe(V,de){z=j(function(){V(e.unstable_now())},de)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){b||k||(b=!0,we(G))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_getFirstCallbackNode=function(){return t(p)},e.unstable_next=function(V){switch(v){case 1:case 2:case 3:var de=3;break;default:de=v}var Ne=v;v=de;try{return V()}finally{v=Ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,de){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Ne=v;v=V;try{return de()}finally{v=Ne}},e.unstable_scheduleCallback=function(V,de,Ne){var ee=e.unstable_now();switch(typeof Ne=="object"&&Ne!==null?(Ne=Ne.delay,Ne=typeof Ne=="number"&&0<Ne?ee+Ne:ee):Ne=ee,V){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=Ne+U,V={id:x++,callback:de,priorityLevel:V,startTime:Ne,expirationTime:U,sortIndex:-1},Ne>ee?(V.sortIndex=Ne,r(h,V),t(p)===null&&V===t(h)&&(w?(O(z),z=-1):w=!0,oe(I,Ne-ee))):(V.sortIndex=U,r(p,V),b||k||(b=!0,we(G))),V},e.unstable_shouldYield=fe,e.unstable_wrapCallback=function(V){var de=v;return function(){var Ne=v;v=de;try{return V.apply(this,arguments)}finally{v=Ne}}}})(sh)),sh}var fy;function s_(){return fy||(fy=1,nh.exports=n_()),nh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hy;function a_(){if(hy)return Dn;hy=1;var e=$u(),r=s_();function t(i){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+i,f=1;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+i+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function o(i,l){c(i,l),c(i+"Capture",l)}function c(i,l){for(a[i]=l,i=0;i<l.length;i++)s.add(l[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),p=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x={},y={};function v(i){return p.call(y,i)?!0:p.call(x,i)?!1:h.test(i)?y[i]=!0:(x[i]=!0,!1)}function k(i,l,f,g){if(f!==null&&f.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return g?!1:f!==null?!f.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function b(i,l,f,g){if(l===null||typeof l>"u"||k(i,l,f,g))return!0;if(g)return!1;if(f!==null)switch(f.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function w(i,l,f,g,N,_,L){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=g,this.attributeNamespace=N,this.mustUseProperty=f,this.propertyName=i,this.type=l,this.sanitizeURL=_,this.removeEmptyString=L}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){j[i]=new w(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var l=i[0];j[l]=new w(l,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){j[i]=new w(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){j[i]=new w(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){j[i]=new w(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){j[i]=new w(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){j[i]=new w(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){j[i]=new w(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){j[i]=new w(i,5,!1,i.toLowerCase(),null,!1,!1)});var O=/[\-:]([a-z])/g;function T(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var l=i.replace(O,T);j[l]=new w(l,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var l=i.replace(O,T);j[l]=new w(l,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var l=i.replace(O,T);j[l]=new w(l,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){j[i]=new w(i,1,!1,i.toLowerCase(),null,!1,!1)}),j.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){j[i]=new w(i,1,!1,i.toLowerCase(),null,!0,!0)});function F(i,l,f,g){var N=j.hasOwnProperty(l)?j[l]:null;(N!==null?N.type!==0:g||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(b(l,f,N,g)&&(f=null),g||N===null?v(l)&&(f===null?i.removeAttribute(l):i.setAttribute(l,""+f)):N.mustUseProperty?i[N.propertyName]=f===null?N.type===3?!1:"":f:(l=N.attributeName,g=N.attributeNamespace,f===null?i.removeAttribute(l):(N=N.type,f=N===3||N===4&&f===!0?"":""+f,g?i.setAttributeNS(g,l,f):i.setAttribute(l,f))))}var I=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,G=Symbol.for("react.element"),B=Symbol.for("react.portal"),Q=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),ne=Symbol.for("react.provider"),fe=Symbol.for("react.context"),me=Symbol.for("react.forward_ref"),le=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),Fe=Symbol.for("react.memo"),we=Symbol.for("react.lazy"),oe=Symbol.for("react.offscreen"),V=Symbol.iterator;function de(i){return i===null||typeof i!="object"?null:(i=V&&i[V]||i["@@iterator"],typeof i=="function"?i:null)}var Ne=Object.assign,ee;function U(i){if(ee===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);ee=l&&l[1]||""}return`
`+ee+i}var re=!1;function Y(i,l){if(!i||re)return"";re=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(Ae){var g=Ae}Reflect.construct(i,[],l)}else{try{l.call()}catch(Ae){g=Ae}i.call(l.prototype)}else{try{throw Error()}catch(Ae){g=Ae}i()}}catch(Ae){if(Ae&&g&&typeof Ae.stack=="string"){for(var N=Ae.stack.split(`
`),_=g.stack.split(`
`),L=N.length-1,te=_.length-1;1<=L&&0<=te&&N[L]!==_[te];)te--;for(;1<=L&&0<=te;L--,te--)if(N[L]!==_[te]){if(L!==1||te!==1)do if(L--,te--,0>te||N[L]!==_[te]){var ae=`
`+N[L].replace(" at new "," at ");return i.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",i.displayName)),ae}while(1<=L&&0<=te);break}}}finally{re=!1,Error.prepareStackTrace=f}return(i=i?i.displayName||i.name:"")?U(i):""}function Z(i){switch(i.tag){case 5:return U(i.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return i=Y(i.type,!1),i;case 11:return i=Y(i.type.render,!1),i;case 1:return i=Y(i.type,!0),i;default:return""}}function xe(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Q:return"Fragment";case B:return"Portal";case J:return"Profiler";case z:return"StrictMode";case le:return"Suspense";case K:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case fe:return(i.displayName||"Context")+".Consumer";case ne:return(i._context.displayName||"Context")+".Provider";case me:var l=i.render;return i=i.displayName,i||(i=l.displayName||l.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Fe:return l=i.displayName||null,l!==null?l:xe(i.type)||"Memo";case we:l=i._payload,i=i._init;try{return xe(i(l))}catch{}}return null}function ie(i){var l=i.type;switch(i.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=l.render,i=i.displayName||i.name||"",l.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return xe(l);case 8:return l===z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Te(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ve(i){var l=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Ee(i){var l=ve(i)?"checked":"value",f=Object.getOwnPropertyDescriptor(i.constructor.prototype,l),g=""+i[l];if(!i.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var N=f.get,_=f.set;return Object.defineProperty(i,l,{configurable:!0,get:function(){return N.call(this)},set:function(L){g=""+L,_.call(this,L)}}),Object.defineProperty(i,l,{enumerable:f.enumerable}),{getValue:function(){return g},setValue:function(L){g=""+L},stopTracking:function(){i._valueTracker=null,delete i[l]}}}}function Me(i){i._valueTracker||(i._valueTracker=Ee(i))}function D(i){if(!i)return!1;var l=i._valueTracker;if(!l)return!0;var f=l.getValue(),g="";return i&&(g=ve(i)?i.checked?"true":"false":i.value),i=g,i!==f?(l.setValue(i),!0):!1}function ut(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function et(i,l){var f=l.checked;return Ne({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??i._wrapperState.initialChecked})}function Ge(i,l){var f=l.defaultValue==null?"":l.defaultValue,g=l.checked!=null?l.checked:l.defaultChecked;f=Te(l.value!=null?l.value:f),i._wrapperState={initialChecked:g,initialValue:f,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function Be(i,l){l=l.checked,l!=null&&F(i,"checked",l,!1)}function Le(i,l){Be(i,l);var f=Te(l.value),g=l.type;if(f!=null)g==="number"?(f===0&&i.value===""||i.value!=f)&&(i.value=""+f):i.value!==""+f&&(i.value=""+f);else if(g==="submit"||g==="reset"){i.removeAttribute("value");return}l.hasOwnProperty("value")?rt(i,l.type,f):l.hasOwnProperty("defaultValue")&&rt(i,l.type,Te(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(i.defaultChecked=!!l.defaultChecked)}function ft(i,l,f){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var g=l.type;if(!(g!=="submit"&&g!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+i._wrapperState.initialValue,f||l===i.value||(i.value=l),i.defaultValue=l}f=i.name,f!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,f!==""&&(i.name=f)}function rt(i,l,f){(l!=="number"||ut(i.ownerDocument)!==i)&&(f==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+f&&(i.defaultValue=""+f))}var hr=Array.isArray;function lr(i,l,f,g){if(i=i.options,l){l={};for(var N=0;N<f.length;N++)l["$"+f[N]]=!0;for(f=0;f<i.length;f++)N=l.hasOwnProperty("$"+i[f].value),i[f].selected!==N&&(i[f].selected=N),N&&g&&(i[f].defaultSelected=!0)}else{for(f=""+Te(f),l=null,N=0;N<i.length;N++){if(i[N].value===f){i[N].selected=!0,g&&(i[N].defaultSelected=!0);return}l!==null||i[N].disabled||(l=i[N])}l!==null&&(l.selected=!0)}}function Nr(i,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return Ne({},l,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Zt(i,l){var f=l.value;if(f==null){if(f=l.children,l=l.defaultValue,f!=null){if(l!=null)throw Error(t(92));if(hr(f)){if(1<f.length)throw Error(t(93));f=f[0]}l=f}l==null&&(l=""),f=l}i._wrapperState={initialValue:Te(f)}}function cr(i,l){var f=Te(l.value),g=Te(l.defaultValue);f!=null&&(f=""+f,f!==i.value&&(i.value=f),l.defaultValue==null&&i.defaultValue!==f&&(i.defaultValue=f)),g!=null&&(i.defaultValue=""+g)}function Mt(i){var l=i.textContent;l===i._wrapperState.initialValue&&l!==""&&l!==null&&(i.value=l)}function Dt(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function St(i,l){return i==null||i==="http://www.w3.org/1999/xhtml"?Dt(l):i==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Je,Ht=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,f,g,N){MSApp.execUnsafeLocalFunction(function(){return i(l,f,g,N)})}:i})(function(i,l){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=l;else{for(Je=Je||document.createElement("div"),Je.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=Je.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;l.firstChild;)i.appendChild(l.firstChild)}});function Ue(i,l){if(l){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=l;return}}i.textContent=l}var Ft={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gt=["Webkit","ms","Moz","O"];Object.keys(Ft).forEach(function(i){Gt.forEach(function(l){l=l+i.charAt(0).toUpperCase()+i.substring(1),Ft[l]=Ft[i]})});function kt(i,l,f){return l==null||typeof l=="boolean"||l===""?"":f||typeof l!="number"||l===0||Ft.hasOwnProperty(i)&&Ft[i]?(""+l).trim():l+"px"}function _t(i,l){i=i.style;for(var f in l)if(l.hasOwnProperty(f)){var g=f.indexOf("--")===0,N=kt(f,l[f],g);f==="float"&&(f="cssFloat"),g?i.setProperty(f,N):i[f]=N}}var Ct=Ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wt(i,l){if(l){if(Ct[i]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function qt(i,l){if(i.indexOf("-")===-1)return typeof l.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bt=null;function $t(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ut=null,Lt=null,It=null;function zt(i){if(i=yl(i)){if(typeof Ut!="function")throw Error(t(280));var l=i.stateNode;l&&(l=Jc(l),Ut(i.stateNode,i.type,l))}}function ge(i){Lt?It?It.push(i):It=[i]:Lt=i}function he(){if(Lt){var i=Lt,l=It;if(It=Lt=null,zt(i),l)for(i=0;i<l.length;i++)zt(l[i])}}function Re(i,l){return i(l)}function pe(){}var _e=!1;function at(i,l,f){if(_e)return i(l,f);_e=!0;try{return Re(i,l,f)}finally{_e=!1,(Lt!==null||It!==null)&&(pe(),he())}}function d(i,l){var f=i.stateNode;if(f===null)return null;var g=Jc(f);if(g===null)return null;f=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(i=i.type,g=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!g;break e;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(t(231,l,typeof f));return f}var A=!1;if(u)try{var E={};Object.defineProperty(E,"passive",{get:function(){A=!0}}),window.addEventListener("test",E,E),window.removeEventListener("test",E,E)}catch{A=!1}function S(i,l,f,g,N,_,L,te,ae){var Ae=Array.prototype.slice.call(arguments,3);try{l.apply(f,Ae)}catch(ze){this.onError(ze)}}var P=!1,se=null,C=!1,M=null,W={onError:function(i){P=!0,se=i}};function q(i,l,f,g,N,_,L,te,ae){P=!1,se=null,S.apply(W,arguments)}function H(i,l,f,g,N,_,L,te,ae){if(q.apply(this,arguments),P){if(P){var Ae=se;P=!1,se=null}else throw Error(t(198));C||(C=!0,M=Ae)}}function X(i){var l=i,f=i;if(i.alternate)for(;l.return;)l=l.return;else{i=l;do l=i,(l.flags&4098)!==0&&(f=l.return),i=l.return;while(i)}return l.tag===3?f:null}function Se(i){if(i.tag===13){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function De(i){if(X(i)!==i)throw Error(t(188))}function je(i){var l=i.alternate;if(!l){if(l=X(i),l===null)throw Error(t(188));return l!==i?null:i}for(var f=i,g=l;;){var N=f.return;if(N===null)break;var _=N.alternate;if(_===null){if(g=N.return,g!==null){f=g;continue}break}if(N.child===_.child){for(_=N.child;_;){if(_===f)return De(N),i;if(_===g)return De(N),l;_=_.sibling}throw Error(t(188))}if(f.return!==g.return)f=N,g=_;else{for(var L=!1,te=N.child;te;){if(te===f){L=!0,f=N,g=_;break}if(te===g){L=!0,g=N,f=_;break}te=te.sibling}if(!L){for(te=_.child;te;){if(te===f){L=!0,f=_,g=N;break}if(te===g){L=!0,g=_,f=N;break}te=te.sibling}if(!L)throw Error(t(189))}}if(f.alternate!==g)throw Error(t(190))}if(f.tag!==3)throw Error(t(188));return f.stateNode.current===f?i:l}function ke(i){return i=je(i),i!==null?Ce(i):null}function Ce(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var l=Ce(i);if(l!==null)return l;i=i.sibling}return null}var We=r.unstable_scheduleCallback,Xe=r.unstable_cancelCallback,nt=r.unstable_shouldYield,Qe=r.unstable_requestPaint,Ve=r.unstable_now,Et=r.unstable_getCurrentPriorityLevel,pr=r.unstable_ImmediatePriority,mr=r.unstable_UserBlockingPriority,Pr=r.unstable_NormalPriority,fi=r.unstable_LowPriority,Ea=r.unstable_IdlePriority,zs=null,Qr=null;function Zo(i){if(Qr&&typeof Qr.onCommitFiberRoot=="function")try{Qr.onCommitFiberRoot(zs,i,void 0,(i.current.flags&128)===128)}catch{}}var Rr=Math.clz32?Math.clz32:gj,mj=Math.log,xj=Math.LN2;function gj(i){return i>>>=0,i===0?32:31-(mj(i)/xj|0)|0}var Dc=64,Fc=4194304;function el(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Mc(i,l){var f=i.pendingLanes;if(f===0)return 0;var g=0,N=i.suspendedLanes,_=i.pingedLanes,L=f&268435455;if(L!==0){var te=L&~N;te!==0?g=el(te):(_&=L,_!==0&&(g=el(_)))}else L=f&~N,L!==0?g=el(L):_!==0&&(g=el(_));if(g===0)return 0;if(l!==0&&l!==g&&(l&N)===0&&(N=g&-g,_=l&-l,N>=_||N===16&&(_&4194240)!==0))return l;if((g&4)!==0&&(g|=f&16),l=i.entangledLanes,l!==0)for(i=i.entanglements,l&=g;0<l;)f=31-Rr(l),N=1<<f,g|=i[f],l&=~N;return g}function yj(i,l){switch(i){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function vj(i,l){for(var f=i.suspendedLanes,g=i.pingedLanes,N=i.expirationTimes,_=i.pendingLanes;0<_;){var L=31-Rr(_),te=1<<L,ae=N[L];ae===-1?((te&f)===0||(te&g)!==0)&&(N[L]=yj(te,l)):ae<=l&&(i.expiredLanes|=te),_&=~te}}function w0(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Im(){var i=Dc;return Dc<<=1,(Dc&4194240)===0&&(Dc=64),i}function N0(i){for(var l=[],f=0;31>f;f++)l.push(i);return l}function tl(i,l,f){i.pendingLanes|=l,l!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,l=31-Rr(l),i[l]=f}function wj(i,l){var f=i.pendingLanes&~l;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=l,i.mutableReadLanes&=l,i.entangledLanes&=l,l=i.entanglements;var g=i.eventTimes;for(i=i.expirationTimes;0<f;){var N=31-Rr(f),_=1<<N;l[N]=0,g[N]=-1,i[N]=-1,f&=~_}}function S0(i,l){var f=i.entangledLanes|=l;for(i=i.entanglements;f;){var g=31-Rr(f),N=1<<g;N&l|i[g]&l&&(i[g]|=l),f&=~N}}var er=0;function Bm(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var $m,b0,Um,zm,Wm,j0=!1,Lc=[],Aa=null,Ta=null,Oa=null,rl=new Map,nl=new Map,Pa=[],Nj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qm(i,l){switch(i){case"focusin":case"focusout":Aa=null;break;case"dragenter":case"dragleave":Ta=null;break;case"mouseover":case"mouseout":Oa=null;break;case"pointerover":case"pointerout":rl.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":nl.delete(l.pointerId)}}function sl(i,l,f,g,N,_){return i===null||i.nativeEvent!==_?(i={blockedOn:l,domEventName:f,eventSystemFlags:g,nativeEvent:_,targetContainers:[N]},l!==null&&(l=yl(l),l!==null&&b0(l)),i):(i.eventSystemFlags|=g,l=i.targetContainers,N!==null&&l.indexOf(N)===-1&&l.push(N),i)}function Sj(i,l,f,g,N){switch(l){case"focusin":return Aa=sl(Aa,i,l,f,g,N),!0;case"dragenter":return Ta=sl(Ta,i,l,f,g,N),!0;case"mouseover":return Oa=sl(Oa,i,l,f,g,N),!0;case"pointerover":var _=N.pointerId;return rl.set(_,sl(rl.get(_)||null,i,l,f,g,N)),!0;case"gotpointercapture":return _=N.pointerId,nl.set(_,sl(nl.get(_)||null,i,l,f,g,N)),!0}return!1}function Vm(i){var l=hi(i.target);if(l!==null){var f=X(l);if(f!==null){if(l=f.tag,l===13){if(l=Se(f),l!==null){i.blockedOn=l,Wm(i.priority,function(){Um(f)});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Ic(i){if(i.blockedOn!==null)return!1;for(var l=i.targetContainers;0<l.length;){var f=_0(i.domEventName,i.eventSystemFlags,l[0],i.nativeEvent);if(f===null){f=i.nativeEvent;var g=new f.constructor(f.type,f);Bt=g,f.target.dispatchEvent(g),Bt=null}else return l=yl(f),l!==null&&b0(l),i.blockedOn=f,!1;l.shift()}return!0}function Qm(i,l,f){Ic(i)&&f.delete(l)}function bj(){j0=!1,Aa!==null&&Ic(Aa)&&(Aa=null),Ta!==null&&Ic(Ta)&&(Ta=null),Oa!==null&&Ic(Oa)&&(Oa=null),rl.forEach(Qm),nl.forEach(Qm)}function al(i,l){i.blockedOn===l&&(i.blockedOn=null,j0||(j0=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,bj)))}function il(i){function l(N){return al(N,i)}if(0<Lc.length){al(Lc[0],i);for(var f=1;f<Lc.length;f++){var g=Lc[f];g.blockedOn===i&&(g.blockedOn=null)}}for(Aa!==null&&al(Aa,i),Ta!==null&&al(Ta,i),Oa!==null&&al(Oa,i),rl.forEach(l),nl.forEach(l),f=0;f<Pa.length;f++)g=Pa[f],g.blockedOn===i&&(g.blockedOn=null);for(;0<Pa.length&&(f=Pa[0],f.blockedOn===null);)Vm(f),f.blockedOn===null&&Pa.shift()}var Gi=I.ReactCurrentBatchConfig,Bc=!0;function jj(i,l,f,g){var N=er,_=Gi.transition;Gi.transition=null;try{er=1,k0(i,l,f,g)}finally{er=N,Gi.transition=_}}function kj(i,l,f,g){var N=er,_=Gi.transition;Gi.transition=null;try{er=4,k0(i,l,f,g)}finally{er=N,Gi.transition=_}}function k0(i,l,f,g){if(Bc){var N=_0(i,l,f,g);if(N===null)W0(i,l,g,$c,f),qm(i,g);else if(Sj(N,i,l,f,g))g.stopPropagation();else if(qm(i,g),l&4&&-1<Nj.indexOf(i)){for(;N!==null;){var _=yl(N);if(_!==null&&$m(_),_=_0(i,l,f,g),_===null&&W0(i,l,g,$c,f),_===N)break;N=_}N!==null&&g.stopPropagation()}else W0(i,l,g,null,f)}}var $c=null;function _0(i,l,f,g){if($c=null,i=$t(g),i=hi(i),i!==null)if(l=X(i),l===null)i=null;else if(f=l.tag,f===13){if(i=Se(l),i!==null)return i;i=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;i=null}else l!==i&&(i=null);return $c=i,null}function Hm(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Et()){case pr:return 1;case mr:return 4;case Pr:case fi:return 16;case Ea:return 536870912;default:return 16}default:return 16}}var Ra=null,C0=null,Uc=null;function Gm(){if(Uc)return Uc;var i,l=C0,f=l.length,g,N="value"in Ra?Ra.value:Ra.textContent,_=N.length;for(i=0;i<f&&l[i]===N[i];i++);var L=f-i;for(g=1;g<=L&&l[f-g]===N[_-g];g++);return Uc=N.slice(i,1<g?1-g:void 0)}function zc(i){var l=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&l===13&&(i=13)):i=l,i===10&&(i=13),32<=i||i===13?i:0}function Wc(){return!0}function Ym(){return!1}function Xn(i){function l(f,g,N,_,L){this._reactName=f,this._targetInst=N,this.type=g,this.nativeEvent=_,this.target=L,this.currentTarget=null;for(var te in i)i.hasOwnProperty(te)&&(f=i[te],this[te]=f?f(_):_[te]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?Wc:Ym,this.isPropagationStopped=Ym,this}return Ne(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=Wc)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=Wc)},persist:function(){},isPersistent:Wc}),l}var Yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},E0=Xn(Yi),ol=Ne({},Yi,{view:0,detail:0}),_j=Xn(ol),A0,T0,ll,qc=Ne({},ol,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:P0,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ll&&(ll&&i.type==="mousemove"?(A0=i.screenX-ll.screenX,T0=i.screenY-ll.screenY):T0=A0=0,ll=i),A0)},movementY:function(i){return"movementY"in i?i.movementY:T0}}),Km=Xn(qc),Cj=Ne({},qc,{dataTransfer:0}),Ej=Xn(Cj),Aj=Ne({},ol,{relatedTarget:0}),O0=Xn(Aj),Tj=Ne({},Yi,{animationName:0,elapsedTime:0,pseudoElement:0}),Oj=Xn(Tj),Pj=Ne({},Yi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Rj=Xn(Pj),Dj=Ne({},Yi,{data:0}),Xm=Xn(Dj),Fj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ij(i){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(i):(i=Lj[i])?!!l[i]:!1}function P0(){return Ij}var Bj=Ne({},ol,{key:function(i){if(i.key){var l=Fj[i.key]||i.key;if(l!=="Unidentified")return l}return i.type==="keypress"?(i=zc(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Mj[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:P0,charCode:function(i){return i.type==="keypress"?zc(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?zc(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),$j=Xn(Bj),Uj=Ne({},qc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Jm=Xn(Uj),zj=Ne({},ol,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:P0}),Wj=Xn(zj),qj=Ne({},Yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vj=Xn(qj),Qj=Ne({},qc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Hj=Xn(Qj),Gj=[9,13,27,32],R0=u&&"CompositionEvent"in window,cl=null;u&&"documentMode"in document&&(cl=document.documentMode);var Yj=u&&"TextEvent"in window&&!cl,Zm=u&&(!R0||cl&&8<cl&&11>=cl),ex=" ",tx=!1;function rx(i,l){switch(i){case"keyup":return Gj.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nx(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ki=!1;function Kj(i,l){switch(i){case"compositionend":return nx(l);case"keypress":return l.which!==32?null:(tx=!0,ex);case"textInput":return i=l.data,i===ex&&tx?null:i;default:return null}}function Xj(i,l){if(Ki)return i==="compositionend"||!R0&&rx(i,l)?(i=Gm(),Uc=C0=Ra=null,Ki=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Zm&&l.locale!=="ko"?null:l.data;default:return null}}var Jj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sx(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l==="input"?!!Jj[i.type]:l==="textarea"}function ax(i,l,f,g){ge(g),l=Yc(l,"onChange"),0<l.length&&(f=new E0("onChange","change",null,f,g),i.push({event:f,listeners:l}))}var dl=null,ul=null;function Zj(i){bx(i,0)}function Vc(i){var l=to(i);if(D(l))return i}function ek(i,l){if(i==="change")return l}var ix=!1;if(u){var D0;if(u){var F0="oninput"in document;if(!F0){var ox=document.createElement("div");ox.setAttribute("oninput","return;"),F0=typeof ox.oninput=="function"}D0=F0}else D0=!1;ix=D0&&(!document.documentMode||9<document.documentMode)}function lx(){dl&&(dl.detachEvent("onpropertychange",cx),ul=dl=null)}function cx(i){if(i.propertyName==="value"&&Vc(ul)){var l=[];ax(l,ul,i,$t(i)),at(Zj,l)}}function tk(i,l,f){i==="focusin"?(lx(),dl=l,ul=f,dl.attachEvent("onpropertychange",cx)):i==="focusout"&&lx()}function rk(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Vc(ul)}function nk(i,l){if(i==="click")return Vc(l)}function sk(i,l){if(i==="input"||i==="change")return Vc(l)}function ak(i,l){return i===l&&(i!==0||1/i===1/l)||i!==i&&l!==l}var ws=typeof Object.is=="function"?Object.is:ak;function fl(i,l){if(ws(i,l))return!0;if(typeof i!="object"||i===null||typeof l!="object"||l===null)return!1;var f=Object.keys(i),g=Object.keys(l);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var N=f[g];if(!p.call(l,N)||!ws(i[N],l[N]))return!1}return!0}function dx(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function ux(i,l){var f=dx(i);i=0;for(var g;f;){if(f.nodeType===3){if(g=i+f.textContent.length,i<=l&&g>=l)return{node:f,offset:l-i};i=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=dx(f)}}function fx(i,l){return i&&l?i===l?!0:i&&i.nodeType===3?!1:l&&l.nodeType===3?fx(i,l.parentNode):"contains"in i?i.contains(l):i.compareDocumentPosition?!!(i.compareDocumentPosition(l)&16):!1:!1}function hx(){for(var i=window,l=ut();l instanceof i.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)i=l.contentWindow;else break;l=ut(i.document)}return l}function M0(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l&&(l==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||l==="textarea"||i.contentEditable==="true")}function ik(i){var l=hx(),f=i.focusedElem,g=i.selectionRange;if(l!==f&&f&&f.ownerDocument&&fx(f.ownerDocument.documentElement,f)){if(g!==null&&M0(f)){if(l=g.start,i=g.end,i===void 0&&(i=l),"selectionStart"in f)f.selectionStart=l,f.selectionEnd=Math.min(i,f.value.length);else if(i=(l=f.ownerDocument||document)&&l.defaultView||window,i.getSelection){i=i.getSelection();var N=f.textContent.length,_=Math.min(g.start,N);g=g.end===void 0?_:Math.min(g.end,N),!i.extend&&_>g&&(N=g,g=_,_=N),N=ux(f,_);var L=ux(f,g);N&&L&&(i.rangeCount!==1||i.anchorNode!==N.node||i.anchorOffset!==N.offset||i.focusNode!==L.node||i.focusOffset!==L.offset)&&(l=l.createRange(),l.setStart(N.node,N.offset),i.removeAllRanges(),_>g?(i.addRange(l),i.extend(L.node,L.offset)):(l.setEnd(L.node,L.offset),i.addRange(l)))}}for(l=[],i=f;i=i.parentNode;)i.nodeType===1&&l.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<l.length;f++)i=l[f],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var ok=u&&"documentMode"in document&&11>=document.documentMode,Xi=null,L0=null,hl=null,I0=!1;function px(i,l,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;I0||Xi==null||Xi!==ut(g)||(g=Xi,"selectionStart"in g&&M0(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),hl&&fl(hl,g)||(hl=g,g=Yc(L0,"onSelect"),0<g.length&&(l=new E0("onSelect","select",null,l,f),i.push({event:l,listeners:g}),l.target=Xi)))}function Qc(i,l){var f={};return f[i.toLowerCase()]=l.toLowerCase(),f["Webkit"+i]="webkit"+l,f["Moz"+i]="moz"+l,f}var Ji={animationend:Qc("Animation","AnimationEnd"),animationiteration:Qc("Animation","AnimationIteration"),animationstart:Qc("Animation","AnimationStart"),transitionend:Qc("Transition","TransitionEnd")},B0={},mx={};u&&(mx=document.createElement("div").style,"AnimationEvent"in window||(delete Ji.animationend.animation,delete Ji.animationiteration.animation,delete Ji.animationstart.animation),"TransitionEvent"in window||delete Ji.transitionend.transition);function Hc(i){if(B0[i])return B0[i];if(!Ji[i])return i;var l=Ji[i],f;for(f in l)if(l.hasOwnProperty(f)&&f in mx)return B0[i]=l[f];return i}var xx=Hc("animationend"),gx=Hc("animationiteration"),yx=Hc("animationstart"),vx=Hc("transitionend"),wx=new Map,Nx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Da(i,l){wx.set(i,l),o(l,[i])}for(var $0=0;$0<Nx.length;$0++){var U0=Nx[$0],lk=U0.toLowerCase(),ck=U0[0].toUpperCase()+U0.slice(1);Da(lk,"on"+ck)}Da(xx,"onAnimationEnd"),Da(gx,"onAnimationIteration"),Da(yx,"onAnimationStart"),Da("dblclick","onDoubleClick"),Da("focusin","onFocus"),Da("focusout","onBlur"),Da(vx,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dk=new Set("cancel close invalid load scroll toggle".split(" ").concat(pl));function Sx(i,l,f){var g=i.type||"unknown-event";i.currentTarget=f,H(g,l,void 0,i),i.currentTarget=null}function bx(i,l){l=(l&4)!==0;for(var f=0;f<i.length;f++){var g=i[f],N=g.event;g=g.listeners;e:{var _=void 0;if(l)for(var L=g.length-1;0<=L;L--){var te=g[L],ae=te.instance,Ae=te.currentTarget;if(te=te.listener,ae!==_&&N.isPropagationStopped())break e;Sx(N,te,Ae),_=ae}else for(L=0;L<g.length;L++){if(te=g[L],ae=te.instance,Ae=te.currentTarget,te=te.listener,ae!==_&&N.isPropagationStopped())break e;Sx(N,te,Ae),_=ae}}}if(C)throw i=M,C=!1,M=null,i}function yr(i,l){var f=l[Y0];f===void 0&&(f=l[Y0]=new Set);var g=i+"__bubble";f.has(g)||(jx(l,i,2,!1),f.add(g))}function z0(i,l,f){var g=0;l&&(g|=4),jx(f,i,g,l)}var Gc="_reactListening"+Math.random().toString(36).slice(2);function ml(i){if(!i[Gc]){i[Gc]=!0,s.forEach(function(f){f!=="selectionchange"&&(dk.has(f)||z0(f,!1,i),z0(f,!0,i))});var l=i.nodeType===9?i:i.ownerDocument;l===null||l[Gc]||(l[Gc]=!0,z0("selectionchange",!1,l))}}function jx(i,l,f,g){switch(Hm(l)){case 1:var N=jj;break;case 4:N=kj;break;default:N=k0}f=N.bind(null,l,f,i),N=void 0,!A||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(N=!0),g?N!==void 0?i.addEventListener(l,f,{capture:!0,passive:N}):i.addEventListener(l,f,!0):N!==void 0?i.addEventListener(l,f,{passive:N}):i.addEventListener(l,f,!1)}function W0(i,l,f,g,N){var _=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var L=g.tag;if(L===3||L===4){var te=g.stateNode.containerInfo;if(te===N||te.nodeType===8&&te.parentNode===N)break;if(L===4)for(L=g.return;L!==null;){var ae=L.tag;if((ae===3||ae===4)&&(ae=L.stateNode.containerInfo,ae===N||ae.nodeType===8&&ae.parentNode===N))return;L=L.return}for(;te!==null;){if(L=hi(te),L===null)return;if(ae=L.tag,ae===5||ae===6){g=_=L;continue e}te=te.parentNode}}g=g.return}at(function(){var Ae=_,ze=$t(f),qe=[];e:{var $e=wx.get(i);if($e!==void 0){var tt=E0,it=i;switch(i){case"keypress":if(zc(f)===0)break e;case"keydown":case"keyup":tt=$j;break;case"focusin":it="focus",tt=O0;break;case"focusout":it="blur",tt=O0;break;case"beforeblur":case"afterblur":tt=O0;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tt=Km;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tt=Ej;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tt=Wj;break;case xx:case gx:case yx:tt=Oj;break;case vx:tt=Vj;break;case"scroll":tt=_j;break;case"wheel":tt=Hj;break;case"copy":case"cut":case"paste":tt=Rj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tt=Jm}var dt=(l&4)!==0,Dr=!dt&&i==="scroll",ye=dt?$e!==null?$e+"Capture":null:$e;dt=[];for(var ue=Ae,be;ue!==null;){be=ue;var He=be.stateNode;if(be.tag===5&&He!==null&&(be=He,ye!==null&&(He=d(ue,ye),He!=null&&dt.push(xl(ue,He,be)))),Dr)break;ue=ue.return}0<dt.length&&($e=new tt($e,it,null,f,ze),qe.push({event:$e,listeners:dt}))}}if((l&7)===0){e:{if($e=i==="mouseover"||i==="pointerover",tt=i==="mouseout"||i==="pointerout",$e&&f!==Bt&&(it=f.relatedTarget||f.fromElement)&&(hi(it)||it[oa]))break e;if((tt||$e)&&($e=ze.window===ze?ze:($e=ze.ownerDocument)?$e.defaultView||$e.parentWindow:window,tt?(it=f.relatedTarget||f.toElement,tt=Ae,it=it?hi(it):null,it!==null&&(Dr=X(it),it!==Dr||it.tag!==5&&it.tag!==6)&&(it=null)):(tt=null,it=Ae),tt!==it)){if(dt=Km,He="onMouseLeave",ye="onMouseEnter",ue="mouse",(i==="pointerout"||i==="pointerover")&&(dt=Jm,He="onPointerLeave",ye="onPointerEnter",ue="pointer"),Dr=tt==null?$e:to(tt),be=it==null?$e:to(it),$e=new dt(He,ue+"leave",tt,f,ze),$e.target=Dr,$e.relatedTarget=be,He=null,hi(ze)===Ae&&(dt=new dt(ye,ue+"enter",it,f,ze),dt.target=be,dt.relatedTarget=Dr,He=dt),Dr=He,tt&&it)t:{for(dt=tt,ye=it,ue=0,be=dt;be;be=Zi(be))ue++;for(be=0,He=ye;He;He=Zi(He))be++;for(;0<ue-be;)dt=Zi(dt),ue--;for(;0<be-ue;)ye=Zi(ye),be--;for(;ue--;){if(dt===ye||ye!==null&&dt===ye.alternate)break t;dt=Zi(dt),ye=Zi(ye)}dt=null}else dt=null;tt!==null&&kx(qe,$e,tt,dt,!1),it!==null&&Dr!==null&&kx(qe,Dr,it,dt,!0)}}e:{if($e=Ae?to(Ae):window,tt=$e.nodeName&&$e.nodeName.toLowerCase(),tt==="select"||tt==="input"&&$e.type==="file")var ht=ek;else if(sx($e))if(ix)ht=sk;else{ht=rk;var wt=tk}else(tt=$e.nodeName)&&tt.toLowerCase()==="input"&&($e.type==="checkbox"||$e.type==="radio")&&(ht=nk);if(ht&&(ht=ht(i,Ae))){ax(qe,ht,f,ze);break e}wt&&wt(i,$e,Ae),i==="focusout"&&(wt=$e._wrapperState)&&wt.controlled&&$e.type==="number"&&rt($e,"number",$e.value)}switch(wt=Ae?to(Ae):window,i){case"focusin":(sx(wt)||wt.contentEditable==="true")&&(Xi=wt,L0=Ae,hl=null);break;case"focusout":hl=L0=Xi=null;break;case"mousedown":I0=!0;break;case"contextmenu":case"mouseup":case"dragend":I0=!1,px(qe,f,ze);break;case"selectionchange":if(ok)break;case"keydown":case"keyup":px(qe,f,ze)}var Nt;if(R0)e:{switch(i){case"compositionstart":var jt="onCompositionStart";break e;case"compositionend":jt="onCompositionEnd";break e;case"compositionupdate":jt="onCompositionUpdate";break e}jt=void 0}else Ki?rx(i,f)&&(jt="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(jt="onCompositionStart");jt&&(Zm&&f.locale!=="ko"&&(Ki||jt!=="onCompositionStart"?jt==="onCompositionEnd"&&Ki&&(Nt=Gm()):(Ra=ze,C0="value"in Ra?Ra.value:Ra.textContent,Ki=!0)),wt=Yc(Ae,jt),0<wt.length&&(jt=new Xm(jt,i,null,f,ze),qe.push({event:jt,listeners:wt}),Nt?jt.data=Nt:(Nt=nx(f),Nt!==null&&(jt.data=Nt)))),(Nt=Yj?Kj(i,f):Xj(i,f))&&(Ae=Yc(Ae,"onBeforeInput"),0<Ae.length&&(ze=new Xm("onBeforeInput","beforeinput",null,f,ze),qe.push({event:ze,listeners:Ae}),ze.data=Nt))}bx(qe,l)})}function xl(i,l,f){return{instance:i,listener:l,currentTarget:f}}function Yc(i,l){for(var f=l+"Capture",g=[];i!==null;){var N=i,_=N.stateNode;N.tag===5&&_!==null&&(N=_,_=d(i,f),_!=null&&g.unshift(xl(i,_,N)),_=d(i,l),_!=null&&g.push(xl(i,_,N))),i=i.return}return g}function Zi(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function kx(i,l,f,g,N){for(var _=l._reactName,L=[];f!==null&&f!==g;){var te=f,ae=te.alternate,Ae=te.stateNode;if(ae!==null&&ae===g)break;te.tag===5&&Ae!==null&&(te=Ae,N?(ae=d(f,_),ae!=null&&L.unshift(xl(f,ae,te))):N||(ae=d(f,_),ae!=null&&L.push(xl(f,ae,te)))),f=f.return}L.length!==0&&i.push({event:l,listeners:L})}var uk=/\r\n?/g,fk=/\u0000|\uFFFD/g;function _x(i){return(typeof i=="string"?i:""+i).replace(uk,`
`).replace(fk,"")}function Kc(i,l,f){if(l=_x(l),_x(i)!==l&&f)throw Error(t(425))}function Xc(){}var q0=null,V0=null;function Q0(i,l){return i==="textarea"||i==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var H0=typeof setTimeout=="function"?setTimeout:void 0,hk=typeof clearTimeout=="function"?clearTimeout:void 0,Cx=typeof Promise=="function"?Promise:void 0,pk=typeof queueMicrotask=="function"?queueMicrotask:typeof Cx<"u"?function(i){return Cx.resolve(null).then(i).catch(mk)}:H0;function mk(i){setTimeout(function(){throw i})}function G0(i,l){var f=l,g=0;do{var N=f.nextSibling;if(i.removeChild(f),N&&N.nodeType===8)if(f=N.data,f==="/$"){if(g===0){i.removeChild(N),il(l);return}g--}else f!=="$"&&f!=="$?"&&f!=="$!"||g++;f=N}while(f);il(l)}function Fa(i){for(;i!=null;i=i.nextSibling){var l=i.nodeType;if(l===1||l===3)break;if(l===8){if(l=i.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return i}function Ex(i){i=i.previousSibling;for(var l=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"){if(l===0)return i;l--}else f==="/$"&&l++}i=i.previousSibling}return null}var eo=Math.random().toString(36).slice(2),Ws="__reactFiber$"+eo,gl="__reactProps$"+eo,oa="__reactContainer$"+eo,Y0="__reactEvents$"+eo,xk="__reactListeners$"+eo,gk="__reactHandles$"+eo;function hi(i){var l=i[Ws];if(l)return l;for(var f=i.parentNode;f;){if(l=f[oa]||f[Ws]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(i=Ex(i);i!==null;){if(f=i[Ws])return f;i=Ex(i)}return l}i=f,f=i.parentNode}return null}function yl(i){return i=i[Ws]||i[oa],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function to(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function Jc(i){return i[gl]||null}var K0=[],ro=-1;function Ma(i){return{current:i}}function vr(i){0>ro||(i.current=K0[ro],K0[ro]=null,ro--)}function xr(i,l){ro++,K0[ro]=i.current,i.current=l}var La={},cn=Ma(La),An=Ma(!1),pi=La;function no(i,l){var f=i.type.contextTypes;if(!f)return La;var g=i.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===l)return g.__reactInternalMemoizedMaskedChildContext;var N={},_;for(_ in f)N[_]=l[_];return g&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=l,i.__reactInternalMemoizedMaskedChildContext=N),N}function Tn(i){return i=i.childContextTypes,i!=null}function Zc(){vr(An),vr(cn)}function Ax(i,l,f){if(cn.current!==La)throw Error(t(168));xr(cn,l),xr(An,f)}function Tx(i,l,f){var g=i.stateNode;if(l=l.childContextTypes,typeof g.getChildContext!="function")return f;g=g.getChildContext();for(var N in g)if(!(N in l))throw Error(t(108,ie(i)||"Unknown",N));return Ne({},f,g)}function ed(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||La,pi=cn.current,xr(cn,i),xr(An,An.current),!0}function Ox(i,l,f){var g=i.stateNode;if(!g)throw Error(t(169));f?(i=Tx(i,l,pi),g.__reactInternalMemoizedMergedChildContext=i,vr(An),vr(cn),xr(cn,i)):vr(An),xr(An,f)}var la=null,td=!1,X0=!1;function Px(i){la===null?la=[i]:la.push(i)}function yk(i){td=!0,Px(i)}function Ia(){if(!X0&&la!==null){X0=!0;var i=0,l=er;try{var f=la;for(er=1;i<f.length;i++){var g=f[i];do g=g(!0);while(g!==null)}la=null,td=!1}catch(N){throw la!==null&&(la=la.slice(i+1)),We(pr,Ia),N}finally{er=l,X0=!1}}return null}var so=[],ao=0,rd=null,nd=0,cs=[],ds=0,mi=null,ca=1,da="";function xi(i,l){so[ao++]=nd,so[ao++]=rd,rd=i,nd=l}function Rx(i,l,f){cs[ds++]=ca,cs[ds++]=da,cs[ds++]=mi,mi=i;var g=ca;i=da;var N=32-Rr(g)-1;g&=~(1<<N),f+=1;var _=32-Rr(l)+N;if(30<_){var L=N-N%5;_=(g&(1<<L)-1).toString(32),g>>=L,N-=L,ca=1<<32-Rr(l)+N|f<<N|g,da=_+i}else ca=1<<_|f<<N|g,da=i}function J0(i){i.return!==null&&(xi(i,1),Rx(i,1,0))}function Z0(i){for(;i===rd;)rd=so[--ao],so[ao]=null,nd=so[--ao],so[ao]=null;for(;i===mi;)mi=cs[--ds],cs[ds]=null,da=cs[--ds],cs[ds]=null,ca=cs[--ds],cs[ds]=null}var Jn=null,Zn=null,Sr=!1,Ns=null;function Dx(i,l){var f=ps(5,null,null,0);f.elementType="DELETED",f.stateNode=l,f.return=i,l=i.deletions,l===null?(i.deletions=[f],i.flags|=16):l.push(f)}function Fx(i,l){switch(i.tag){case 5:var f=i.type;return l=l.nodeType!==1||f.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(i.stateNode=l,Jn=i,Zn=Fa(l.firstChild),!0):!1;case 6:return l=i.pendingProps===""||l.nodeType!==3?null:l,l!==null?(i.stateNode=l,Jn=i,Zn=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(f=mi!==null?{id:ca,overflow:da}:null,i.memoizedState={dehydrated:l,treeContext:f,retryLane:1073741824},f=ps(18,null,null,0),f.stateNode=l,f.return=i,i.child=f,Jn=i,Zn=null,!0):!1;default:return!1}}function ef(i){return(i.mode&1)!==0&&(i.flags&128)===0}function tf(i){if(Sr){var l=Zn;if(l){var f=l;if(!Fx(i,l)){if(ef(i))throw Error(t(418));l=Fa(f.nextSibling);var g=Jn;l&&Fx(i,l)?Dx(g,f):(i.flags=i.flags&-4097|2,Sr=!1,Jn=i)}}else{if(ef(i))throw Error(t(418));i.flags=i.flags&-4097|2,Sr=!1,Jn=i}}}function Mx(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Jn=i}function sd(i){if(i!==Jn)return!1;if(!Sr)return Mx(i),Sr=!0,!1;var l;if((l=i.tag!==3)&&!(l=i.tag!==5)&&(l=i.type,l=l!=="head"&&l!=="body"&&!Q0(i.type,i.memoizedProps)),l&&(l=Zn)){if(ef(i))throw Lx(),Error(t(418));for(;l;)Dx(i,l),l=Fa(l.nextSibling)}if(Mx(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,l=0;i;){if(i.nodeType===8){var f=i.data;if(f==="/$"){if(l===0){Zn=Fa(i.nextSibling);break e}l--}else f!=="$"&&f!=="$!"&&f!=="$?"||l++}i=i.nextSibling}Zn=null}}else Zn=Jn?Fa(i.stateNode.nextSibling):null;return!0}function Lx(){for(var i=Zn;i;)i=Fa(i.nextSibling)}function io(){Zn=Jn=null,Sr=!1}function rf(i){Ns===null?Ns=[i]:Ns.push(i)}var vk=I.ReactCurrentBatchConfig;function vl(i,l,f){if(i=f.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(t(309));var g=f.stateNode}if(!g)throw Error(t(147,i));var N=g,_=""+i;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===_?l.ref:(l=function(L){var te=N.refs;L===null?delete te[_]:te[_]=L},l._stringRef=_,l)}if(typeof i!="string")throw Error(t(284));if(!f._owner)throw Error(t(290,i))}return i}function ad(i,l){throw i=Object.prototype.toString.call(l),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":i))}function Ix(i){var l=i._init;return l(i._payload)}function Bx(i){function l(ye,ue){if(i){var be=ye.deletions;be===null?(ye.deletions=[ue],ye.flags|=16):be.push(ue)}}function f(ye,ue){if(!i)return null;for(;ue!==null;)l(ye,ue),ue=ue.sibling;return null}function g(ye,ue){for(ye=new Map;ue!==null;)ue.key!==null?ye.set(ue.key,ue):ye.set(ue.index,ue),ue=ue.sibling;return ye}function N(ye,ue){return ye=Qa(ye,ue),ye.index=0,ye.sibling=null,ye}function _(ye,ue,be){return ye.index=be,i?(be=ye.alternate,be!==null?(be=be.index,be<ue?(ye.flags|=2,ue):be):(ye.flags|=2,ue)):(ye.flags|=1048576,ue)}function L(ye){return i&&ye.alternate===null&&(ye.flags|=2),ye}function te(ye,ue,be,He){return ue===null||ue.tag!==6?(ue=Gf(be,ye.mode,He),ue.return=ye,ue):(ue=N(ue,be),ue.return=ye,ue)}function ae(ye,ue,be,He){var ht=be.type;return ht===Q?ze(ye,ue,be.props.children,He,be.key):ue!==null&&(ue.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===we&&Ix(ht)===ue.type)?(He=N(ue,be.props),He.ref=vl(ye,ue,be),He.return=ye,He):(He=Ad(be.type,be.key,be.props,null,ye.mode,He),He.ref=vl(ye,ue,be),He.return=ye,He)}function Ae(ye,ue,be,He){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==be.containerInfo||ue.stateNode.implementation!==be.implementation?(ue=Yf(be,ye.mode,He),ue.return=ye,ue):(ue=N(ue,be.children||[]),ue.return=ye,ue)}function ze(ye,ue,be,He,ht){return ue===null||ue.tag!==7?(ue=ji(be,ye.mode,He,ht),ue.return=ye,ue):(ue=N(ue,be),ue.return=ye,ue)}function qe(ye,ue,be){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return ue=Gf(""+ue,ye.mode,be),ue.return=ye,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case G:return be=Ad(ue.type,ue.key,ue.props,null,ye.mode,be),be.ref=vl(ye,null,ue),be.return=ye,be;case B:return ue=Yf(ue,ye.mode,be),ue.return=ye,ue;case we:var He=ue._init;return qe(ye,He(ue._payload),be)}if(hr(ue)||de(ue))return ue=ji(ue,ye.mode,be,null),ue.return=ye,ue;ad(ye,ue)}return null}function $e(ye,ue,be,He){var ht=ue!==null?ue.key:null;if(typeof be=="string"&&be!==""||typeof be=="number")return ht!==null?null:te(ye,ue,""+be,He);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case G:return be.key===ht?ae(ye,ue,be,He):null;case B:return be.key===ht?Ae(ye,ue,be,He):null;case we:return ht=be._init,$e(ye,ue,ht(be._payload),He)}if(hr(be)||de(be))return ht!==null?null:ze(ye,ue,be,He,null);ad(ye,be)}return null}function tt(ye,ue,be,He,ht){if(typeof He=="string"&&He!==""||typeof He=="number")return ye=ye.get(be)||null,te(ue,ye,""+He,ht);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case G:return ye=ye.get(He.key===null?be:He.key)||null,ae(ue,ye,He,ht);case B:return ye=ye.get(He.key===null?be:He.key)||null,Ae(ue,ye,He,ht);case we:var wt=He._init;return tt(ye,ue,be,wt(He._payload),ht)}if(hr(He)||de(He))return ye=ye.get(be)||null,ze(ue,ye,He,ht,null);ad(ue,He)}return null}function it(ye,ue,be,He){for(var ht=null,wt=null,Nt=ue,jt=ue=0,Yr=null;Nt!==null&&jt<be.length;jt++){Nt.index>jt?(Yr=Nt,Nt=null):Yr=Nt.sibling;var Yt=$e(ye,Nt,be[jt],He);if(Yt===null){Nt===null&&(Nt=Yr);break}i&&Nt&&Yt.alternate===null&&l(ye,Nt),ue=_(Yt,ue,jt),wt===null?ht=Yt:wt.sibling=Yt,wt=Yt,Nt=Yr}if(jt===be.length)return f(ye,Nt),Sr&&xi(ye,jt),ht;if(Nt===null){for(;jt<be.length;jt++)Nt=qe(ye,be[jt],He),Nt!==null&&(ue=_(Nt,ue,jt),wt===null?ht=Nt:wt.sibling=Nt,wt=Nt);return Sr&&xi(ye,jt),ht}for(Nt=g(ye,Nt);jt<be.length;jt++)Yr=tt(Nt,ye,jt,be[jt],He),Yr!==null&&(i&&Yr.alternate!==null&&Nt.delete(Yr.key===null?jt:Yr.key),ue=_(Yr,ue,jt),wt===null?ht=Yr:wt.sibling=Yr,wt=Yr);return i&&Nt.forEach(function(Ha){return l(ye,Ha)}),Sr&&xi(ye,jt),ht}function dt(ye,ue,be,He){var ht=de(be);if(typeof ht!="function")throw Error(t(150));if(be=ht.call(be),be==null)throw Error(t(151));for(var wt=ht=null,Nt=ue,jt=ue=0,Yr=null,Yt=be.next();Nt!==null&&!Yt.done;jt++,Yt=be.next()){Nt.index>jt?(Yr=Nt,Nt=null):Yr=Nt.sibling;var Ha=$e(ye,Nt,Yt.value,He);if(Ha===null){Nt===null&&(Nt=Yr);break}i&&Nt&&Ha.alternate===null&&l(ye,Nt),ue=_(Ha,ue,jt),wt===null?ht=Ha:wt.sibling=Ha,wt=Ha,Nt=Yr}if(Yt.done)return f(ye,Nt),Sr&&xi(ye,jt),ht;if(Nt===null){for(;!Yt.done;jt++,Yt=be.next())Yt=qe(ye,Yt.value,He),Yt!==null&&(ue=_(Yt,ue,jt),wt===null?ht=Yt:wt.sibling=Yt,wt=Yt);return Sr&&xi(ye,jt),ht}for(Nt=g(ye,Nt);!Yt.done;jt++,Yt=be.next())Yt=tt(Nt,ye,jt,Yt.value,He),Yt!==null&&(i&&Yt.alternate!==null&&Nt.delete(Yt.key===null?jt:Yt.key),ue=_(Yt,ue,jt),wt===null?ht=Yt:wt.sibling=Yt,wt=Yt);return i&&Nt.forEach(function(Jk){return l(ye,Jk)}),Sr&&xi(ye,jt),ht}function Dr(ye,ue,be,He){if(typeof be=="object"&&be!==null&&be.type===Q&&be.key===null&&(be=be.props.children),typeof be=="object"&&be!==null){switch(be.$$typeof){case G:e:{for(var ht=be.key,wt=ue;wt!==null;){if(wt.key===ht){if(ht=be.type,ht===Q){if(wt.tag===7){f(ye,wt.sibling),ue=N(wt,be.props.children),ue.return=ye,ye=ue;break e}}else if(wt.elementType===ht||typeof ht=="object"&&ht!==null&&ht.$$typeof===we&&Ix(ht)===wt.type){f(ye,wt.sibling),ue=N(wt,be.props),ue.ref=vl(ye,wt,be),ue.return=ye,ye=ue;break e}f(ye,wt);break}else l(ye,wt);wt=wt.sibling}be.type===Q?(ue=ji(be.props.children,ye.mode,He,be.key),ue.return=ye,ye=ue):(He=Ad(be.type,be.key,be.props,null,ye.mode,He),He.ref=vl(ye,ue,be),He.return=ye,ye=He)}return L(ye);case B:e:{for(wt=be.key;ue!==null;){if(ue.key===wt)if(ue.tag===4&&ue.stateNode.containerInfo===be.containerInfo&&ue.stateNode.implementation===be.implementation){f(ye,ue.sibling),ue=N(ue,be.children||[]),ue.return=ye,ye=ue;break e}else{f(ye,ue);break}else l(ye,ue);ue=ue.sibling}ue=Yf(be,ye.mode,He),ue.return=ye,ye=ue}return L(ye);case we:return wt=be._init,Dr(ye,ue,wt(be._payload),He)}if(hr(be))return it(ye,ue,be,He);if(de(be))return dt(ye,ue,be,He);ad(ye,be)}return typeof be=="string"&&be!==""||typeof be=="number"?(be=""+be,ue!==null&&ue.tag===6?(f(ye,ue.sibling),ue=N(ue,be),ue.return=ye,ye=ue):(f(ye,ue),ue=Gf(be,ye.mode,He),ue.return=ye,ye=ue),L(ye)):f(ye,ue)}return Dr}var oo=Bx(!0),$x=Bx(!1),id=Ma(null),od=null,lo=null,nf=null;function sf(){nf=lo=od=null}function af(i){var l=id.current;vr(id),i._currentValue=l}function of(i,l,f){for(;i!==null;){var g=i.alternate;if((i.childLanes&l)!==l?(i.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),i===f)break;i=i.return}}function co(i,l){od=i,nf=lo=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&l)!==0&&(On=!0),i.firstContext=null)}function us(i){var l=i._currentValue;if(nf!==i)if(i={context:i,memoizedValue:l,next:null},lo===null){if(od===null)throw Error(t(308));lo=i,od.dependencies={lanes:0,firstContext:i}}else lo=lo.next=i;return l}var gi=null;function lf(i){gi===null?gi=[i]:gi.push(i)}function Ux(i,l,f,g){var N=l.interleaved;return N===null?(f.next=f,lf(l)):(f.next=N.next,N.next=f),l.interleaved=f,ua(i,g)}function ua(i,l){i.lanes|=l;var f=i.alternate;for(f!==null&&(f.lanes|=l),f=i,i=i.return;i!==null;)i.childLanes|=l,f=i.alternate,f!==null&&(f.childLanes|=l),f=i,i=i.return;return f.tag===3?f.stateNode:null}var Ba=!1;function cf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zx(i,l){i=i.updateQueue,l.updateQueue===i&&(l.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function fa(i,l){return{eventTime:i,lane:l,tag:0,payload:null,callback:null,next:null}}function $a(i,l,f){var g=i.updateQueue;if(g===null)return null;if(g=g.shared,(Vt&2)!==0){var N=g.pending;return N===null?l.next=l:(l.next=N.next,N.next=l),g.pending=l,ua(i,f)}return N=g.interleaved,N===null?(l.next=l,lf(g)):(l.next=N.next,N.next=l),g.interleaved=l,ua(i,f)}function ld(i,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194240)!==0)){var g=l.lanes;g&=i.pendingLanes,f|=g,l.lanes=f,S0(i,f)}}function Wx(i,l){var f=i.updateQueue,g=i.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var N=null,_=null;if(f=f.firstBaseUpdate,f!==null){do{var L={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};_===null?N=_=L:_=_.next=L,f=f.next}while(f!==null);_===null?N=_=l:_=_.next=l}else N=_=l;f={baseState:g.baseState,firstBaseUpdate:N,lastBaseUpdate:_,shared:g.shared,effects:g.effects},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=l:i.next=l,f.lastBaseUpdate=l}function cd(i,l,f,g){var N=i.updateQueue;Ba=!1;var _=N.firstBaseUpdate,L=N.lastBaseUpdate,te=N.shared.pending;if(te!==null){N.shared.pending=null;var ae=te,Ae=ae.next;ae.next=null,L===null?_=Ae:L.next=Ae,L=ae;var ze=i.alternate;ze!==null&&(ze=ze.updateQueue,te=ze.lastBaseUpdate,te!==L&&(te===null?ze.firstBaseUpdate=Ae:te.next=Ae,ze.lastBaseUpdate=ae))}if(_!==null){var qe=N.baseState;L=0,ze=Ae=ae=null,te=_;do{var $e=te.lane,tt=te.eventTime;if((g&$e)===$e){ze!==null&&(ze=ze.next={eventTime:tt,lane:0,tag:te.tag,payload:te.payload,callback:te.callback,next:null});e:{var it=i,dt=te;switch($e=l,tt=f,dt.tag){case 1:if(it=dt.payload,typeof it=="function"){qe=it.call(tt,qe,$e);break e}qe=it;break e;case 3:it.flags=it.flags&-65537|128;case 0:if(it=dt.payload,$e=typeof it=="function"?it.call(tt,qe,$e):it,$e==null)break e;qe=Ne({},qe,$e);break e;case 2:Ba=!0}}te.callback!==null&&te.lane!==0&&(i.flags|=64,$e=N.effects,$e===null?N.effects=[te]:$e.push(te))}else tt={eventTime:tt,lane:$e,tag:te.tag,payload:te.payload,callback:te.callback,next:null},ze===null?(Ae=ze=tt,ae=qe):ze=ze.next=tt,L|=$e;if(te=te.next,te===null){if(te=N.shared.pending,te===null)break;$e=te,te=$e.next,$e.next=null,N.lastBaseUpdate=$e,N.shared.pending=null}}while(!0);if(ze===null&&(ae=qe),N.baseState=ae,N.firstBaseUpdate=Ae,N.lastBaseUpdate=ze,l=N.shared.interleaved,l!==null){N=l;do L|=N.lane,N=N.next;while(N!==l)}else _===null&&(N.shared.lanes=0);wi|=L,i.lanes=L,i.memoizedState=qe}}function qx(i,l,f){if(i=l.effects,l.effects=null,i!==null)for(l=0;l<i.length;l++){var g=i[l],N=g.callback;if(N!==null){if(g.callback=null,g=f,typeof N!="function")throw Error(t(191,N));N.call(g)}}}var wl={},qs=Ma(wl),Nl=Ma(wl),Sl=Ma(wl);function yi(i){if(i===wl)throw Error(t(174));return i}function df(i,l){switch(xr(Sl,l),xr(Nl,i),xr(qs,wl),i=l.nodeType,i){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:St(null,"");break;default:i=i===8?l.parentNode:l,l=i.namespaceURI||null,i=i.tagName,l=St(l,i)}vr(qs),xr(qs,l)}function uo(){vr(qs),vr(Nl),vr(Sl)}function Vx(i){yi(Sl.current);var l=yi(qs.current),f=St(l,i.type);l!==f&&(xr(Nl,i),xr(qs,f))}function uf(i){Nl.current===i&&(vr(qs),vr(Nl))}var Cr=Ma(0);function dd(i){for(var l=i;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var ff=[];function hf(){for(var i=0;i<ff.length;i++)ff[i]._workInProgressVersionPrimary=null;ff.length=0}var ud=I.ReactCurrentDispatcher,pf=I.ReactCurrentBatchConfig,vi=0,Er=null,$r=null,Hr=null,fd=!1,bl=!1,jl=0,wk=0;function dn(){throw Error(t(321))}function mf(i,l){if(l===null)return!1;for(var f=0;f<l.length&&f<i.length;f++)if(!ws(i[f],l[f]))return!1;return!0}function xf(i,l,f,g,N,_){if(vi=_,Er=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,ud.current=i===null||i.memoizedState===null?jk:kk,i=f(g,N),bl){_=0;do{if(bl=!1,jl=0,25<=_)throw Error(t(301));_+=1,Hr=$r=null,l.updateQueue=null,ud.current=_k,i=f(g,N)}while(bl)}if(ud.current=md,l=$r!==null&&$r.next!==null,vi=0,Hr=$r=Er=null,fd=!1,l)throw Error(t(300));return i}function gf(){var i=jl!==0;return jl=0,i}function Vs(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hr===null?Er.memoizedState=Hr=i:Hr=Hr.next=i,Hr}function fs(){if($r===null){var i=Er.alternate;i=i!==null?i.memoizedState:null}else i=$r.next;var l=Hr===null?Er.memoizedState:Hr.next;if(l!==null)Hr=l,$r=i;else{if(i===null)throw Error(t(310));$r=i,i={memoizedState:$r.memoizedState,baseState:$r.baseState,baseQueue:$r.baseQueue,queue:$r.queue,next:null},Hr===null?Er.memoizedState=Hr=i:Hr=Hr.next=i}return Hr}function kl(i,l){return typeof l=="function"?l(i):l}function yf(i){var l=fs(),f=l.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=i;var g=$r,N=g.baseQueue,_=f.pending;if(_!==null){if(N!==null){var L=N.next;N.next=_.next,_.next=L}g.baseQueue=N=_,f.pending=null}if(N!==null){_=N.next,g=g.baseState;var te=L=null,ae=null,Ae=_;do{var ze=Ae.lane;if((vi&ze)===ze)ae!==null&&(ae=ae.next={lane:0,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),g=Ae.hasEagerState?Ae.eagerState:i(g,Ae.action);else{var qe={lane:ze,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null};ae===null?(te=ae=qe,L=g):ae=ae.next=qe,Er.lanes|=ze,wi|=ze}Ae=Ae.next}while(Ae!==null&&Ae!==_);ae===null?L=g:ae.next=te,ws(g,l.memoizedState)||(On=!0),l.memoizedState=g,l.baseState=L,l.baseQueue=ae,f.lastRenderedState=g}if(i=f.interleaved,i!==null){N=i;do _=N.lane,Er.lanes|=_,wi|=_,N=N.next;while(N!==i)}else N===null&&(f.lanes=0);return[l.memoizedState,f.dispatch]}function vf(i){var l=fs(),f=l.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=i;var g=f.dispatch,N=f.pending,_=l.memoizedState;if(N!==null){f.pending=null;var L=N=N.next;do _=i(_,L.action),L=L.next;while(L!==N);ws(_,l.memoizedState)||(On=!0),l.memoizedState=_,l.baseQueue===null&&(l.baseState=_),f.lastRenderedState=_}return[_,g]}function Qx(){}function Hx(i,l){var f=Er,g=fs(),N=l(),_=!ws(g.memoizedState,N);if(_&&(g.memoizedState=N,On=!0),g=g.queue,wf(Kx.bind(null,f,g,i),[i]),g.getSnapshot!==l||_||Hr!==null&&Hr.memoizedState.tag&1){if(f.flags|=2048,_l(9,Yx.bind(null,f,g,N,l),void 0,null),Gr===null)throw Error(t(349));(vi&30)!==0||Gx(f,l,N)}return N}function Gx(i,l,f){i.flags|=16384,i={getSnapshot:l,value:f},l=Er.updateQueue,l===null?(l={lastEffect:null,stores:null},Er.updateQueue=l,l.stores=[i]):(f=l.stores,f===null?l.stores=[i]:f.push(i))}function Yx(i,l,f,g){l.value=f,l.getSnapshot=g,Xx(l)&&Jx(i)}function Kx(i,l,f){return f(function(){Xx(l)&&Jx(i)})}function Xx(i){var l=i.getSnapshot;i=i.value;try{var f=l();return!ws(i,f)}catch{return!0}}function Jx(i){var l=ua(i,1);l!==null&&ks(l,i,1,-1)}function Zx(i){var l=Vs();return typeof i=="function"&&(i=i()),l.memoizedState=l.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kl,lastRenderedState:i},l.queue=i,i=i.dispatch=bk.bind(null,Er,i),[l.memoizedState,i]}function _l(i,l,f,g){return i={tag:i,create:l,destroy:f,deps:g,next:null},l=Er.updateQueue,l===null?(l={lastEffect:null,stores:null},Er.updateQueue=l,l.lastEffect=i.next=i):(f=l.lastEffect,f===null?l.lastEffect=i.next=i:(g=f.next,f.next=i,i.next=g,l.lastEffect=i)),i}function eg(){return fs().memoizedState}function hd(i,l,f,g){var N=Vs();Er.flags|=i,N.memoizedState=_l(1|l,f,void 0,g===void 0?null:g)}function pd(i,l,f,g){var N=fs();g=g===void 0?null:g;var _=void 0;if($r!==null){var L=$r.memoizedState;if(_=L.destroy,g!==null&&mf(g,L.deps)){N.memoizedState=_l(l,f,_,g);return}}Er.flags|=i,N.memoizedState=_l(1|l,f,_,g)}function tg(i,l){return hd(8390656,8,i,l)}function wf(i,l){return pd(2048,8,i,l)}function rg(i,l){return pd(4,2,i,l)}function ng(i,l){return pd(4,4,i,l)}function sg(i,l){if(typeof l=="function")return i=i(),l(i),function(){l(null)};if(l!=null)return i=i(),l.current=i,function(){l.current=null}}function ag(i,l,f){return f=f!=null?f.concat([i]):null,pd(4,4,sg.bind(null,l,i),f)}function Nf(){}function ig(i,l){var f=fs();l=l===void 0?null:l;var g=f.memoizedState;return g!==null&&l!==null&&mf(l,g[1])?g[0]:(f.memoizedState=[i,l],i)}function og(i,l){var f=fs();l=l===void 0?null:l;var g=f.memoizedState;return g!==null&&l!==null&&mf(l,g[1])?g[0]:(i=i(),f.memoizedState=[i,l],i)}function lg(i,l,f){return(vi&21)===0?(i.baseState&&(i.baseState=!1,On=!0),i.memoizedState=f):(ws(f,l)||(f=Im(),Er.lanes|=f,wi|=f,i.baseState=!0),l)}function Nk(i,l){var f=er;er=f!==0&&4>f?f:4,i(!0);var g=pf.transition;pf.transition={};try{i(!1),l()}finally{er=f,pf.transition=g}}function cg(){return fs().memoizedState}function Sk(i,l,f){var g=qa(i);if(f={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null},dg(i))ug(l,f);else if(f=Ux(i,l,f,g),f!==null){var N=Nn();ks(f,i,g,N),fg(f,l,g)}}function bk(i,l,f){var g=qa(i),N={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null};if(dg(i))ug(l,N);else{var _=i.alternate;if(i.lanes===0&&(_===null||_.lanes===0)&&(_=l.lastRenderedReducer,_!==null))try{var L=l.lastRenderedState,te=_(L,f);if(N.hasEagerState=!0,N.eagerState=te,ws(te,L)){var ae=l.interleaved;ae===null?(N.next=N,lf(l)):(N.next=ae.next,ae.next=N),l.interleaved=N;return}}catch{}finally{}f=Ux(i,l,N,g),f!==null&&(N=Nn(),ks(f,i,g,N),fg(f,l,g))}}function dg(i){var l=i.alternate;return i===Er||l!==null&&l===Er}function ug(i,l){bl=fd=!0;var f=i.pending;f===null?l.next=l:(l.next=f.next,f.next=l),i.pending=l}function fg(i,l,f){if((f&4194240)!==0){var g=l.lanes;g&=i.pendingLanes,f|=g,l.lanes=f,S0(i,f)}}var md={readContext:us,useCallback:dn,useContext:dn,useEffect:dn,useImperativeHandle:dn,useInsertionEffect:dn,useLayoutEffect:dn,useMemo:dn,useReducer:dn,useRef:dn,useState:dn,useDebugValue:dn,useDeferredValue:dn,useTransition:dn,useMutableSource:dn,useSyncExternalStore:dn,useId:dn,unstable_isNewReconciler:!1},jk={readContext:us,useCallback:function(i,l){return Vs().memoizedState=[i,l===void 0?null:l],i},useContext:us,useEffect:tg,useImperativeHandle:function(i,l,f){return f=f!=null?f.concat([i]):null,hd(4194308,4,sg.bind(null,l,i),f)},useLayoutEffect:function(i,l){return hd(4194308,4,i,l)},useInsertionEffect:function(i,l){return hd(4,2,i,l)},useMemo:function(i,l){var f=Vs();return l=l===void 0?null:l,i=i(),f.memoizedState=[i,l],i},useReducer:function(i,l,f){var g=Vs();return l=f!==void 0?f(l):l,g.memoizedState=g.baseState=l,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:l},g.queue=i,i=i.dispatch=Sk.bind(null,Er,i),[g.memoizedState,i]},useRef:function(i){var l=Vs();return i={current:i},l.memoizedState=i},useState:Zx,useDebugValue:Nf,useDeferredValue:function(i){return Vs().memoizedState=i},useTransition:function(){var i=Zx(!1),l=i[0];return i=Nk.bind(null,i[1]),Vs().memoizedState=i,[l,i]},useMutableSource:function(){},useSyncExternalStore:function(i,l,f){var g=Er,N=Vs();if(Sr){if(f===void 0)throw Error(t(407));f=f()}else{if(f=l(),Gr===null)throw Error(t(349));(vi&30)!==0||Gx(g,l,f)}N.memoizedState=f;var _={value:f,getSnapshot:l};return N.queue=_,tg(Kx.bind(null,g,_,i),[i]),g.flags|=2048,_l(9,Yx.bind(null,g,_,f,l),void 0,null),f},useId:function(){var i=Vs(),l=Gr.identifierPrefix;if(Sr){var f=da,g=ca;f=(g&~(1<<32-Rr(g)-1)).toString(32)+f,l=":"+l+"R"+f,f=jl++,0<f&&(l+="H"+f.toString(32)),l+=":"}else f=wk++,l=":"+l+"r"+f.toString(32)+":";return i.memoizedState=l},unstable_isNewReconciler:!1},kk={readContext:us,useCallback:ig,useContext:us,useEffect:wf,useImperativeHandle:ag,useInsertionEffect:rg,useLayoutEffect:ng,useMemo:og,useReducer:yf,useRef:eg,useState:function(){return yf(kl)},useDebugValue:Nf,useDeferredValue:function(i){var l=fs();return lg(l,$r.memoizedState,i)},useTransition:function(){var i=yf(kl)[0],l=fs().memoizedState;return[i,l]},useMutableSource:Qx,useSyncExternalStore:Hx,useId:cg,unstable_isNewReconciler:!1},_k={readContext:us,useCallback:ig,useContext:us,useEffect:wf,useImperativeHandle:ag,useInsertionEffect:rg,useLayoutEffect:ng,useMemo:og,useReducer:vf,useRef:eg,useState:function(){return vf(kl)},useDebugValue:Nf,useDeferredValue:function(i){var l=fs();return $r===null?l.memoizedState=i:lg(l,$r.memoizedState,i)},useTransition:function(){var i=vf(kl)[0],l=fs().memoizedState;return[i,l]},useMutableSource:Qx,useSyncExternalStore:Hx,useId:cg,unstable_isNewReconciler:!1};function Ss(i,l){if(i&&i.defaultProps){l=Ne({},l),i=i.defaultProps;for(var f in i)l[f]===void 0&&(l[f]=i[f]);return l}return l}function Sf(i,l,f,g){l=i.memoizedState,f=f(g,l),f=f==null?l:Ne({},l,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var xd={isMounted:function(i){return(i=i._reactInternals)?X(i)===i:!1},enqueueSetState:function(i,l,f){i=i._reactInternals;var g=Nn(),N=qa(i),_=fa(g,N);_.payload=l,f!=null&&(_.callback=f),l=$a(i,_,N),l!==null&&(ks(l,i,N,g),ld(l,i,N))},enqueueReplaceState:function(i,l,f){i=i._reactInternals;var g=Nn(),N=qa(i),_=fa(g,N);_.tag=1,_.payload=l,f!=null&&(_.callback=f),l=$a(i,_,N),l!==null&&(ks(l,i,N,g),ld(l,i,N))},enqueueForceUpdate:function(i,l){i=i._reactInternals;var f=Nn(),g=qa(i),N=fa(f,g);N.tag=2,l!=null&&(N.callback=l),l=$a(i,N,g),l!==null&&(ks(l,i,g,f),ld(l,i,g))}};function hg(i,l,f,g,N,_,L){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(g,_,L):l.prototype&&l.prototype.isPureReactComponent?!fl(f,g)||!fl(N,_):!0}function pg(i,l,f){var g=!1,N=La,_=l.contextType;return typeof _=="object"&&_!==null?_=us(_):(N=Tn(l)?pi:cn.current,g=l.contextTypes,_=(g=g!=null)?no(i,N):La),l=new l(f,_),i.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=xd,i.stateNode=l,l._reactInternals=i,g&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=N,i.__reactInternalMemoizedMaskedChildContext=_),l}function mg(i,l,f,g){i=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,g),l.state!==i&&xd.enqueueReplaceState(l,l.state,null)}function bf(i,l,f,g){var N=i.stateNode;N.props=f,N.state=i.memoizedState,N.refs={},cf(i);var _=l.contextType;typeof _=="object"&&_!==null?N.context=us(_):(_=Tn(l)?pi:cn.current,N.context=no(i,_)),N.state=i.memoizedState,_=l.getDerivedStateFromProps,typeof _=="function"&&(Sf(i,l,_,f),N.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(l=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),l!==N.state&&xd.enqueueReplaceState(N,N.state,null),cd(i,f,N,g),N.state=i.memoizedState),typeof N.componentDidMount=="function"&&(i.flags|=4194308)}function fo(i,l){try{var f="",g=l;do f+=Z(g),g=g.return;while(g);var N=f}catch(_){N=`
Error generating stack: `+_.message+`
`+_.stack}return{value:i,source:l,stack:N,digest:null}}function jf(i,l,f){return{value:i,source:null,stack:f??null,digest:l??null}}function kf(i,l){try{console.error(l.value)}catch(f){setTimeout(function(){throw f})}}var Ck=typeof WeakMap=="function"?WeakMap:Map;function xg(i,l,f){f=fa(-1,f),f.tag=3,f.payload={element:null};var g=l.value;return f.callback=function(){bd||(bd=!0,$f=g),kf(i,l)},f}function gg(i,l,f){f=fa(-1,f),f.tag=3;var g=i.type.getDerivedStateFromError;if(typeof g=="function"){var N=l.value;f.payload=function(){return g(N)},f.callback=function(){kf(i,l)}}var _=i.stateNode;return _!==null&&typeof _.componentDidCatch=="function"&&(f.callback=function(){kf(i,l),typeof g!="function"&&(za===null?za=new Set([this]):za.add(this));var L=l.stack;this.componentDidCatch(l.value,{componentStack:L!==null?L:""})}),f}function yg(i,l,f){var g=i.pingCache;if(g===null){g=i.pingCache=new Ck;var N=new Set;g.set(l,N)}else N=g.get(l),N===void 0&&(N=new Set,g.set(l,N));N.has(f)||(N.add(f),i=Uk.bind(null,i,l,f),l.then(i,i))}function vg(i){do{var l;if((l=i.tag===13)&&(l=i.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return i;i=i.return}while(i!==null);return null}function wg(i,l,f,g,N){return(i.mode&1)===0?(i===l?i.flags|=65536:(i.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(l=fa(-1,1),l.tag=2,$a(f,l,1))),f.lanes|=1),i):(i.flags|=65536,i.lanes=N,i)}var Ek=I.ReactCurrentOwner,On=!1;function wn(i,l,f,g){l.child=i===null?$x(l,null,f,g):oo(l,i.child,f,g)}function Ng(i,l,f,g,N){f=f.render;var _=l.ref;return co(l,N),g=xf(i,l,f,g,_,N),f=gf(),i!==null&&!On?(l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~N,ha(i,l,N)):(Sr&&f&&J0(l),l.flags|=1,wn(i,l,g,N),l.child)}function Sg(i,l,f,g,N){if(i===null){var _=f.type;return typeof _=="function"&&!Hf(_)&&_.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(l.tag=15,l.type=_,bg(i,l,_,g,N)):(i=Ad(f.type,null,g,l,l.mode,N),i.ref=l.ref,i.return=l,l.child=i)}if(_=i.child,(i.lanes&N)===0){var L=_.memoizedProps;if(f=f.compare,f=f!==null?f:fl,f(L,g)&&i.ref===l.ref)return ha(i,l,N)}return l.flags|=1,i=Qa(_,g),i.ref=l.ref,i.return=l,l.child=i}function bg(i,l,f,g,N){if(i!==null){var _=i.memoizedProps;if(fl(_,g)&&i.ref===l.ref)if(On=!1,l.pendingProps=g=_,(i.lanes&N)!==0)(i.flags&131072)!==0&&(On=!0);else return l.lanes=i.lanes,ha(i,l,N)}return _f(i,l,f,g,N)}function jg(i,l,f){var g=l.pendingProps,N=g.children,_=i!==null?i.memoizedState:null;if(g.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},xr(po,es),es|=f;else{if((f&1073741824)===0)return i=_!==null?_.baseLanes|f:f,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:i,cachePool:null,transitions:null},l.updateQueue=null,xr(po,es),es|=i,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=_!==null?_.baseLanes:f,xr(po,es),es|=g}else _!==null?(g=_.baseLanes|f,l.memoizedState=null):g=f,xr(po,es),es|=g;return wn(i,l,N,f),l.child}function kg(i,l){var f=l.ref;(i===null&&f!==null||i!==null&&i.ref!==f)&&(l.flags|=512,l.flags|=2097152)}function _f(i,l,f,g,N){var _=Tn(f)?pi:cn.current;return _=no(l,_),co(l,N),f=xf(i,l,f,g,_,N),g=gf(),i!==null&&!On?(l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~N,ha(i,l,N)):(Sr&&g&&J0(l),l.flags|=1,wn(i,l,f,N),l.child)}function _g(i,l,f,g,N){if(Tn(f)){var _=!0;ed(l)}else _=!1;if(co(l,N),l.stateNode===null)yd(i,l),pg(l,f,g),bf(l,f,g,N),g=!0;else if(i===null){var L=l.stateNode,te=l.memoizedProps;L.props=te;var ae=L.context,Ae=f.contextType;typeof Ae=="object"&&Ae!==null?Ae=us(Ae):(Ae=Tn(f)?pi:cn.current,Ae=no(l,Ae));var ze=f.getDerivedStateFromProps,qe=typeof ze=="function"||typeof L.getSnapshotBeforeUpdate=="function";qe||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(te!==g||ae!==Ae)&&mg(l,L,g,Ae),Ba=!1;var $e=l.memoizedState;L.state=$e,cd(l,g,L,N),ae=l.memoizedState,te!==g||$e!==ae||An.current||Ba?(typeof ze=="function"&&(Sf(l,f,ze,g),ae=l.memoizedState),(te=Ba||hg(l,f,te,g,$e,ae,Ae))?(qe||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(l.flags|=4194308)):(typeof L.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=ae),L.props=g,L.state=ae,L.context=Ae,g=te):(typeof L.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{L=l.stateNode,zx(i,l),te=l.memoizedProps,Ae=l.type===l.elementType?te:Ss(l.type,te),L.props=Ae,qe=l.pendingProps,$e=L.context,ae=f.contextType,typeof ae=="object"&&ae!==null?ae=us(ae):(ae=Tn(f)?pi:cn.current,ae=no(l,ae));var tt=f.getDerivedStateFromProps;(ze=typeof tt=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(te!==qe||$e!==ae)&&mg(l,L,g,ae),Ba=!1,$e=l.memoizedState,L.state=$e,cd(l,g,L,N);var it=l.memoizedState;te!==qe||$e!==it||An.current||Ba?(typeof tt=="function"&&(Sf(l,f,tt,g),it=l.memoizedState),(Ae=Ba||hg(l,f,Ae,g,$e,it,ae)||!1)?(ze||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(g,it,ae),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(g,it,ae)),typeof L.componentDidUpdate=="function"&&(l.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof L.componentDidUpdate!="function"||te===i.memoizedProps&&$e===i.memoizedState||(l.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||te===i.memoizedProps&&$e===i.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=it),L.props=g,L.state=it,L.context=ae,g=Ae):(typeof L.componentDidUpdate!="function"||te===i.memoizedProps&&$e===i.memoizedState||(l.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||te===i.memoizedProps&&$e===i.memoizedState||(l.flags|=1024),g=!1)}return Cf(i,l,f,g,_,N)}function Cf(i,l,f,g,N,_){kg(i,l);var L=(l.flags&128)!==0;if(!g&&!L)return N&&Ox(l,f,!1),ha(i,l,_);g=l.stateNode,Ek.current=l;var te=L&&typeof f.getDerivedStateFromError!="function"?null:g.render();return l.flags|=1,i!==null&&L?(l.child=oo(l,i.child,null,_),l.child=oo(l,null,te,_)):wn(i,l,te,_),l.memoizedState=g.state,N&&Ox(l,f,!0),l.child}function Cg(i){var l=i.stateNode;l.pendingContext?Ax(i,l.pendingContext,l.pendingContext!==l.context):l.context&&Ax(i,l.context,!1),df(i,l.containerInfo)}function Eg(i,l,f,g,N){return io(),rf(N),l.flags|=256,wn(i,l,f,g),l.child}var Ef={dehydrated:null,treeContext:null,retryLane:0};function Af(i){return{baseLanes:i,cachePool:null,transitions:null}}function Ag(i,l,f){var g=l.pendingProps,N=Cr.current,_=!1,L=(l.flags&128)!==0,te;if((te=L)||(te=i!==null&&i.memoizedState===null?!1:(N&2)!==0),te?(_=!0,l.flags&=-129):(i===null||i.memoizedState!==null)&&(N|=1),xr(Cr,N&1),i===null)return tf(l),i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((l.mode&1)===0?l.lanes=1:i.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(L=g.children,i=g.fallback,_?(g=l.mode,_=l.child,L={mode:"hidden",children:L},(g&1)===0&&_!==null?(_.childLanes=0,_.pendingProps=L):_=Td(L,g,0,null),i=ji(i,g,f,null),_.return=l,i.return=l,_.sibling=i,l.child=_,l.child.memoizedState=Af(f),l.memoizedState=Ef,i):Tf(l,L));if(N=i.memoizedState,N!==null&&(te=N.dehydrated,te!==null))return Ak(i,l,L,g,te,N,f);if(_){_=g.fallback,L=l.mode,N=i.child,te=N.sibling;var ae={mode:"hidden",children:g.children};return(L&1)===0&&l.child!==N?(g=l.child,g.childLanes=0,g.pendingProps=ae,l.deletions=null):(g=Qa(N,ae),g.subtreeFlags=N.subtreeFlags&14680064),te!==null?_=Qa(te,_):(_=ji(_,L,f,null),_.flags|=2),_.return=l,g.return=l,g.sibling=_,l.child=g,g=_,_=l.child,L=i.child.memoizedState,L=L===null?Af(f):{baseLanes:L.baseLanes|f,cachePool:null,transitions:L.transitions},_.memoizedState=L,_.childLanes=i.childLanes&~f,l.memoizedState=Ef,g}return _=i.child,i=_.sibling,g=Qa(_,{mode:"visible",children:g.children}),(l.mode&1)===0&&(g.lanes=f),g.return=l,g.sibling=null,i!==null&&(f=l.deletions,f===null?(l.deletions=[i],l.flags|=16):f.push(i)),l.child=g,l.memoizedState=null,g}function Tf(i,l){return l=Td({mode:"visible",children:l},i.mode,0,null),l.return=i,i.child=l}function gd(i,l,f,g){return g!==null&&rf(g),oo(l,i.child,null,f),i=Tf(l,l.pendingProps.children),i.flags|=2,l.memoizedState=null,i}function Ak(i,l,f,g,N,_,L){if(f)return l.flags&256?(l.flags&=-257,g=jf(Error(t(422))),gd(i,l,L,g)):l.memoizedState!==null?(l.child=i.child,l.flags|=128,null):(_=g.fallback,N=l.mode,g=Td({mode:"visible",children:g.children},N,0,null),_=ji(_,N,L,null),_.flags|=2,g.return=l,_.return=l,g.sibling=_,l.child=g,(l.mode&1)!==0&&oo(l,i.child,null,L),l.child.memoizedState=Af(L),l.memoizedState=Ef,_);if((l.mode&1)===0)return gd(i,l,L,null);if(N.data==="$!"){if(g=N.nextSibling&&N.nextSibling.dataset,g)var te=g.dgst;return g=te,_=Error(t(419)),g=jf(_,g,void 0),gd(i,l,L,g)}if(te=(L&i.childLanes)!==0,On||te){if(g=Gr,g!==null){switch(L&-L){case 4:N=2;break;case 16:N=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:N=32;break;case 536870912:N=268435456;break;default:N=0}N=(N&(g.suspendedLanes|L))!==0?0:N,N!==0&&N!==_.retryLane&&(_.retryLane=N,ua(i,N),ks(g,i,N,-1))}return Qf(),g=jf(Error(t(421))),gd(i,l,L,g)}return N.data==="$?"?(l.flags|=128,l.child=i.child,l=zk.bind(null,i),N._reactRetry=l,null):(i=_.treeContext,Zn=Fa(N.nextSibling),Jn=l,Sr=!0,Ns=null,i!==null&&(cs[ds++]=ca,cs[ds++]=da,cs[ds++]=mi,ca=i.id,da=i.overflow,mi=l),l=Tf(l,g.children),l.flags|=4096,l)}function Tg(i,l,f){i.lanes|=l;var g=i.alternate;g!==null&&(g.lanes|=l),of(i.return,l,f)}function Of(i,l,f,g,N){var _=i.memoizedState;_===null?i.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:N}:(_.isBackwards=l,_.rendering=null,_.renderingStartTime=0,_.last=g,_.tail=f,_.tailMode=N)}function Og(i,l,f){var g=l.pendingProps,N=g.revealOrder,_=g.tail;if(wn(i,l,g.children,f),g=Cr.current,(g&2)!==0)g=g&1|2,l.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=l.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Tg(i,f,l);else if(i.tag===19)Tg(i,f,l);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break e;for(;i.sibling===null;){if(i.return===null||i.return===l)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}g&=1}if(xr(Cr,g),(l.mode&1)===0)l.memoizedState=null;else switch(N){case"forwards":for(f=l.child,N=null;f!==null;)i=f.alternate,i!==null&&dd(i)===null&&(N=f),f=f.sibling;f=N,f===null?(N=l.child,l.child=null):(N=f.sibling,f.sibling=null),Of(l,!1,N,f,_);break;case"backwards":for(f=null,N=l.child,l.child=null;N!==null;){if(i=N.alternate,i!==null&&dd(i)===null){l.child=N;break}i=N.sibling,N.sibling=f,f=N,N=i}Of(l,!0,f,null,_);break;case"together":Of(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function yd(i,l){(l.mode&1)===0&&i!==null&&(i.alternate=null,l.alternate=null,l.flags|=2)}function ha(i,l,f){if(i!==null&&(l.dependencies=i.dependencies),wi|=l.lanes,(f&l.childLanes)===0)return null;if(i!==null&&l.child!==i.child)throw Error(t(153));if(l.child!==null){for(i=l.child,f=Qa(i,i.pendingProps),l.child=f,f.return=l;i.sibling!==null;)i=i.sibling,f=f.sibling=Qa(i,i.pendingProps),f.return=l;f.sibling=null}return l.child}function Tk(i,l,f){switch(l.tag){case 3:Cg(l),io();break;case 5:Vx(l);break;case 1:Tn(l.type)&&ed(l);break;case 4:df(l,l.stateNode.containerInfo);break;case 10:var g=l.type._context,N=l.memoizedProps.value;xr(id,g._currentValue),g._currentValue=N;break;case 13:if(g=l.memoizedState,g!==null)return g.dehydrated!==null?(xr(Cr,Cr.current&1),l.flags|=128,null):(f&l.child.childLanes)!==0?Ag(i,l,f):(xr(Cr,Cr.current&1),i=ha(i,l,f),i!==null?i.sibling:null);xr(Cr,Cr.current&1);break;case 19:if(g=(f&l.childLanes)!==0,(i.flags&128)!==0){if(g)return Og(i,l,f);l.flags|=128}if(N=l.memoizedState,N!==null&&(N.rendering=null,N.tail=null,N.lastEffect=null),xr(Cr,Cr.current),g)break;return null;case 22:case 23:return l.lanes=0,jg(i,l,f)}return ha(i,l,f)}var Pg,Pf,Rg,Dg;Pg=function(i,l){for(var f=l.child;f!==null;){if(f.tag===5||f.tag===6)i.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===l)break;for(;f.sibling===null;){if(f.return===null||f.return===l)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Pf=function(){},Rg=function(i,l,f,g){var N=i.memoizedProps;if(N!==g){i=l.stateNode,yi(qs.current);var _=null;switch(f){case"input":N=et(i,N),g=et(i,g),_=[];break;case"select":N=Ne({},N,{value:void 0}),g=Ne({},g,{value:void 0}),_=[];break;case"textarea":N=Nr(i,N),g=Nr(i,g),_=[];break;default:typeof N.onClick!="function"&&typeof g.onClick=="function"&&(i.onclick=Xc)}Wt(f,g);var L;f=null;for(Ae in N)if(!g.hasOwnProperty(Ae)&&N.hasOwnProperty(Ae)&&N[Ae]!=null)if(Ae==="style"){var te=N[Ae];for(L in te)te.hasOwnProperty(L)&&(f||(f={}),f[L]="")}else Ae!=="dangerouslySetInnerHTML"&&Ae!=="children"&&Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&Ae!=="autoFocus"&&(a.hasOwnProperty(Ae)?_||(_=[]):(_=_||[]).push(Ae,null));for(Ae in g){var ae=g[Ae];if(te=N?.[Ae],g.hasOwnProperty(Ae)&&ae!==te&&(ae!=null||te!=null))if(Ae==="style")if(te){for(L in te)!te.hasOwnProperty(L)||ae&&ae.hasOwnProperty(L)||(f||(f={}),f[L]="");for(L in ae)ae.hasOwnProperty(L)&&te[L]!==ae[L]&&(f||(f={}),f[L]=ae[L])}else f||(_||(_=[]),_.push(Ae,f)),f=ae;else Ae==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,te=te?te.__html:void 0,ae!=null&&te!==ae&&(_=_||[]).push(Ae,ae)):Ae==="children"?typeof ae!="string"&&typeof ae!="number"||(_=_||[]).push(Ae,""+ae):Ae!=="suppressContentEditableWarning"&&Ae!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ae)?(ae!=null&&Ae==="onScroll"&&yr("scroll",i),_||te===ae||(_=[])):(_=_||[]).push(Ae,ae))}f&&(_=_||[]).push("style",f);var Ae=_;(l.updateQueue=Ae)&&(l.flags|=4)}},Dg=function(i,l,f,g){f!==g&&(l.flags|=4)};function Cl(i,l){if(!Sr)switch(i.tailMode){case"hidden":l=i.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?l||i.tail===null?i.tail=null:i.tail.sibling=null:g.sibling=null}}function un(i){var l=i.alternate!==null&&i.alternate.child===i.child,f=0,g=0;if(l)for(var N=i.child;N!==null;)f|=N.lanes|N.childLanes,g|=N.subtreeFlags&14680064,g|=N.flags&14680064,N.return=i,N=N.sibling;else for(N=i.child;N!==null;)f|=N.lanes|N.childLanes,g|=N.subtreeFlags,g|=N.flags,N.return=i,N=N.sibling;return i.subtreeFlags|=g,i.childLanes=f,l}function Ok(i,l,f){var g=l.pendingProps;switch(Z0(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return un(l),null;case 1:return Tn(l.type)&&Zc(),un(l),null;case 3:return g=l.stateNode,uo(),vr(An),vr(cn),hf(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(i===null||i.child===null)&&(sd(l)?l.flags|=4:i===null||i.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Ns!==null&&(Wf(Ns),Ns=null))),Pf(i,l),un(l),null;case 5:uf(l);var N=yi(Sl.current);if(f=l.type,i!==null&&l.stateNode!=null)Rg(i,l,f,g,N),i.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!g){if(l.stateNode===null)throw Error(t(166));return un(l),null}if(i=yi(qs.current),sd(l)){g=l.stateNode,f=l.type;var _=l.memoizedProps;switch(g[Ws]=l,g[gl]=_,i=(l.mode&1)!==0,f){case"dialog":yr("cancel",g),yr("close",g);break;case"iframe":case"object":case"embed":yr("load",g);break;case"video":case"audio":for(N=0;N<pl.length;N++)yr(pl[N],g);break;case"source":yr("error",g);break;case"img":case"image":case"link":yr("error",g),yr("load",g);break;case"details":yr("toggle",g);break;case"input":Ge(g,_),yr("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!_.multiple},yr("invalid",g);break;case"textarea":Zt(g,_),yr("invalid",g)}Wt(f,_),N=null;for(var L in _)if(_.hasOwnProperty(L)){var te=_[L];L==="children"?typeof te=="string"?g.textContent!==te&&(_.suppressHydrationWarning!==!0&&Kc(g.textContent,te,i),N=["children",te]):typeof te=="number"&&g.textContent!==""+te&&(_.suppressHydrationWarning!==!0&&Kc(g.textContent,te,i),N=["children",""+te]):a.hasOwnProperty(L)&&te!=null&&L==="onScroll"&&yr("scroll",g)}switch(f){case"input":Me(g),ft(g,_,!0);break;case"textarea":Me(g),Mt(g);break;case"select":case"option":break;default:typeof _.onClick=="function"&&(g.onclick=Xc)}g=N,l.updateQueue=g,g!==null&&(l.flags|=4)}else{L=N.nodeType===9?N:N.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Dt(f)),i==="http://www.w3.org/1999/xhtml"?f==="script"?(i=L.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof g.is=="string"?i=L.createElement(f,{is:g.is}):(i=L.createElement(f),f==="select"&&(L=i,g.multiple?L.multiple=!0:g.size&&(L.size=g.size))):i=L.createElementNS(i,f),i[Ws]=l,i[gl]=g,Pg(i,l,!1,!1),l.stateNode=i;e:{switch(L=qt(f,g),f){case"dialog":yr("cancel",i),yr("close",i),N=g;break;case"iframe":case"object":case"embed":yr("load",i),N=g;break;case"video":case"audio":for(N=0;N<pl.length;N++)yr(pl[N],i);N=g;break;case"source":yr("error",i),N=g;break;case"img":case"image":case"link":yr("error",i),yr("load",i),N=g;break;case"details":yr("toggle",i),N=g;break;case"input":Ge(i,g),N=et(i,g),yr("invalid",i);break;case"option":N=g;break;case"select":i._wrapperState={wasMultiple:!!g.multiple},N=Ne({},g,{value:void 0}),yr("invalid",i);break;case"textarea":Zt(i,g),N=Nr(i,g),yr("invalid",i);break;default:N=g}Wt(f,N),te=N;for(_ in te)if(te.hasOwnProperty(_)){var ae=te[_];_==="style"?_t(i,ae):_==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&Ht(i,ae)):_==="children"?typeof ae=="string"?(f!=="textarea"||ae!=="")&&Ue(i,ae):typeof ae=="number"&&Ue(i,""+ae):_!=="suppressContentEditableWarning"&&_!=="suppressHydrationWarning"&&_!=="autoFocus"&&(a.hasOwnProperty(_)?ae!=null&&_==="onScroll"&&yr("scroll",i):ae!=null&&F(i,_,ae,L))}switch(f){case"input":Me(i),ft(i,g,!1);break;case"textarea":Me(i),Mt(i);break;case"option":g.value!=null&&i.setAttribute("value",""+Te(g.value));break;case"select":i.multiple=!!g.multiple,_=g.value,_!=null?lr(i,!!g.multiple,_,!1):g.defaultValue!=null&&lr(i,!!g.multiple,g.defaultValue,!0);break;default:typeof N.onClick=="function"&&(i.onclick=Xc)}switch(f){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return un(l),null;case 6:if(i&&l.stateNode!=null)Dg(i,l,i.memoizedProps,g);else{if(typeof g!="string"&&l.stateNode===null)throw Error(t(166));if(f=yi(Sl.current),yi(qs.current),sd(l)){if(g=l.stateNode,f=l.memoizedProps,g[Ws]=l,(_=g.nodeValue!==f)&&(i=Jn,i!==null))switch(i.tag){case 3:Kc(g.nodeValue,f,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Kc(g.nodeValue,f,(i.mode&1)!==0)}_&&(l.flags|=4)}else g=(f.nodeType===9?f:f.ownerDocument).createTextNode(g),g[Ws]=l,l.stateNode=g}return un(l),null;case 13:if(vr(Cr),g=l.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Sr&&Zn!==null&&(l.mode&1)!==0&&(l.flags&128)===0)Lx(),io(),l.flags|=98560,_=!1;else if(_=sd(l),g!==null&&g.dehydrated!==null){if(i===null){if(!_)throw Error(t(318));if(_=l.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(t(317));_[Ws]=l}else io(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;un(l),_=!1}else Ns!==null&&(Wf(Ns),Ns=null),_=!0;if(!_)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=f,l):(g=g!==null,g!==(i!==null&&i.memoizedState!==null)&&g&&(l.child.flags|=8192,(l.mode&1)!==0&&(i===null||(Cr.current&1)!==0?Ur===0&&(Ur=3):Qf())),l.updateQueue!==null&&(l.flags|=4),un(l),null);case 4:return uo(),Pf(i,l),i===null&&ml(l.stateNode.containerInfo),un(l),null;case 10:return af(l.type._context),un(l),null;case 17:return Tn(l.type)&&Zc(),un(l),null;case 19:if(vr(Cr),_=l.memoizedState,_===null)return un(l),null;if(g=(l.flags&128)!==0,L=_.rendering,L===null)if(g)Cl(_,!1);else{if(Ur!==0||i!==null&&(i.flags&128)!==0)for(i=l.child;i!==null;){if(L=dd(i),L!==null){for(l.flags|=128,Cl(_,!1),g=L.updateQueue,g!==null&&(l.updateQueue=g,l.flags|=4),l.subtreeFlags=0,g=f,f=l.child;f!==null;)_=f,i=g,_.flags&=14680066,L=_.alternate,L===null?(_.childLanes=0,_.lanes=i,_.child=null,_.subtreeFlags=0,_.memoizedProps=null,_.memoizedState=null,_.updateQueue=null,_.dependencies=null,_.stateNode=null):(_.childLanes=L.childLanes,_.lanes=L.lanes,_.child=L.child,_.subtreeFlags=0,_.deletions=null,_.memoizedProps=L.memoizedProps,_.memoizedState=L.memoizedState,_.updateQueue=L.updateQueue,_.type=L.type,i=L.dependencies,_.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),f=f.sibling;return xr(Cr,Cr.current&1|2),l.child}i=i.sibling}_.tail!==null&&Ve()>mo&&(l.flags|=128,g=!0,Cl(_,!1),l.lanes=4194304)}else{if(!g)if(i=dd(L),i!==null){if(l.flags|=128,g=!0,f=i.updateQueue,f!==null&&(l.updateQueue=f,l.flags|=4),Cl(_,!0),_.tail===null&&_.tailMode==="hidden"&&!L.alternate&&!Sr)return un(l),null}else 2*Ve()-_.renderingStartTime>mo&&f!==1073741824&&(l.flags|=128,g=!0,Cl(_,!1),l.lanes=4194304);_.isBackwards?(L.sibling=l.child,l.child=L):(f=_.last,f!==null?f.sibling=L:l.child=L,_.last=L)}return _.tail!==null?(l=_.tail,_.rendering=l,_.tail=l.sibling,_.renderingStartTime=Ve(),l.sibling=null,f=Cr.current,xr(Cr,g?f&1|2:f&1),l):(un(l),null);case 22:case 23:return Vf(),g=l.memoizedState!==null,i!==null&&i.memoizedState!==null!==g&&(l.flags|=8192),g&&(l.mode&1)!==0?(es&1073741824)!==0&&(un(l),l.subtreeFlags&6&&(l.flags|=8192)):un(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function Pk(i,l){switch(Z0(l),l.tag){case 1:return Tn(l.type)&&Zc(),i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 3:return uo(),vr(An),vr(cn),hf(),i=l.flags,(i&65536)!==0&&(i&128)===0?(l.flags=i&-65537|128,l):null;case 5:return uf(l),null;case 13:if(vr(Cr),i=l.memoizedState,i!==null&&i.dehydrated!==null){if(l.alternate===null)throw Error(t(340));io()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 19:return vr(Cr),null;case 4:return uo(),null;case 10:return af(l.type._context),null;case 22:case 23:return Vf(),null;case 24:return null;default:return null}}var vd=!1,fn=!1,Rk=typeof WeakSet=="function"?WeakSet:Set,st=null;function ho(i,l){var f=i.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(g){Ar(i,l,g)}else f.current=null}function Rf(i,l,f){try{f()}catch(g){Ar(i,l,g)}}var Fg=!1;function Dk(i,l){if(q0=Bc,i=hx(),M0(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else e:{f=(f=i.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var N=g.anchorOffset,_=g.focusNode;g=g.focusOffset;try{f.nodeType,_.nodeType}catch{f=null;break e}var L=0,te=-1,ae=-1,Ae=0,ze=0,qe=i,$e=null;t:for(;;){for(var tt;qe!==f||N!==0&&qe.nodeType!==3||(te=L+N),qe!==_||g!==0&&qe.nodeType!==3||(ae=L+g),qe.nodeType===3&&(L+=qe.nodeValue.length),(tt=qe.firstChild)!==null;)$e=qe,qe=tt;for(;;){if(qe===i)break t;if($e===f&&++Ae===N&&(te=L),$e===_&&++ze===g&&(ae=L),(tt=qe.nextSibling)!==null)break;qe=$e,$e=qe.parentNode}qe=tt}f=te===-1||ae===-1?null:{start:te,end:ae}}else f=null}f=f||{start:0,end:0}}else f=null;for(V0={focusedElem:i,selectionRange:f},Bc=!1,st=l;st!==null;)if(l=st,i=l.child,(l.subtreeFlags&1028)!==0&&i!==null)i.return=l,st=i;else for(;st!==null;){l=st;try{var it=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(it!==null){var dt=it.memoizedProps,Dr=it.memoizedState,ye=l.stateNode,ue=ye.getSnapshotBeforeUpdate(l.elementType===l.type?dt:Ss(l.type,dt),Dr);ye.__reactInternalSnapshotBeforeUpdate=ue}break;case 3:var be=l.stateNode.containerInfo;be.nodeType===1?be.textContent="":be.nodeType===9&&be.documentElement&&be.removeChild(be.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(He){Ar(l,l.return,He)}if(i=l.sibling,i!==null){i.return=l.return,st=i;break}st=l.return}return it=Fg,Fg=!1,it}function El(i,l,f){var g=l.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var N=g=g.next;do{if((N.tag&i)===i){var _=N.destroy;N.destroy=void 0,_!==void 0&&Rf(l,f,_)}N=N.next}while(N!==g)}}function wd(i,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var f=l=l.next;do{if((f.tag&i)===i){var g=f.create;f.destroy=g()}f=f.next}while(f!==l)}}function Df(i){var l=i.ref;if(l!==null){var f=i.stateNode;switch(i.tag){case 5:i=f;break;default:i=f}typeof l=="function"?l(i):l.current=i}}function Mg(i){var l=i.alternate;l!==null&&(i.alternate=null,Mg(l)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(l=i.stateNode,l!==null&&(delete l[Ws],delete l[gl],delete l[Y0],delete l[xk],delete l[gk])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Lg(i){return i.tag===5||i.tag===3||i.tag===4}function Ig(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Lg(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Ff(i,l,f){var g=i.tag;if(g===5||g===6)i=i.stateNode,l?f.nodeType===8?f.parentNode.insertBefore(i,l):f.insertBefore(i,l):(f.nodeType===8?(l=f.parentNode,l.insertBefore(i,f)):(l=f,l.appendChild(i)),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=Xc));else if(g!==4&&(i=i.child,i!==null))for(Ff(i,l,f),i=i.sibling;i!==null;)Ff(i,l,f),i=i.sibling}function Mf(i,l,f){var g=i.tag;if(g===5||g===6)i=i.stateNode,l?f.insertBefore(i,l):f.appendChild(i);else if(g!==4&&(i=i.child,i!==null))for(Mf(i,l,f),i=i.sibling;i!==null;)Mf(i,l,f),i=i.sibling}var Zr=null,bs=!1;function Ua(i,l,f){for(f=f.child;f!==null;)Bg(i,l,f),f=f.sibling}function Bg(i,l,f){if(Qr&&typeof Qr.onCommitFiberUnmount=="function")try{Qr.onCommitFiberUnmount(zs,f)}catch{}switch(f.tag){case 5:fn||ho(f,l);case 6:var g=Zr,N=bs;Zr=null,Ua(i,l,f),Zr=g,bs=N,Zr!==null&&(bs?(i=Zr,f=f.stateNode,i.nodeType===8?i.parentNode.removeChild(f):i.removeChild(f)):Zr.removeChild(f.stateNode));break;case 18:Zr!==null&&(bs?(i=Zr,f=f.stateNode,i.nodeType===8?G0(i.parentNode,f):i.nodeType===1&&G0(i,f),il(i)):G0(Zr,f.stateNode));break;case 4:g=Zr,N=bs,Zr=f.stateNode.containerInfo,bs=!0,Ua(i,l,f),Zr=g,bs=N;break;case 0:case 11:case 14:case 15:if(!fn&&(g=f.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){N=g=g.next;do{var _=N,L=_.destroy;_=_.tag,L!==void 0&&((_&2)!==0||(_&4)!==0)&&Rf(f,l,L),N=N.next}while(N!==g)}Ua(i,l,f);break;case 1:if(!fn&&(ho(f,l),g=f.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=f.memoizedProps,g.state=f.memoizedState,g.componentWillUnmount()}catch(te){Ar(f,l,te)}Ua(i,l,f);break;case 21:Ua(i,l,f);break;case 22:f.mode&1?(fn=(g=fn)||f.memoizedState!==null,Ua(i,l,f),fn=g):Ua(i,l,f);break;default:Ua(i,l,f)}}function $g(i){var l=i.updateQueue;if(l!==null){i.updateQueue=null;var f=i.stateNode;f===null&&(f=i.stateNode=new Rk),l.forEach(function(g){var N=Wk.bind(null,i,g);f.has(g)||(f.add(g),g.then(N,N))})}}function js(i,l){var f=l.deletions;if(f!==null)for(var g=0;g<f.length;g++){var N=f[g];try{var _=i,L=l,te=L;e:for(;te!==null;){switch(te.tag){case 5:Zr=te.stateNode,bs=!1;break e;case 3:Zr=te.stateNode.containerInfo,bs=!0;break e;case 4:Zr=te.stateNode.containerInfo,bs=!0;break e}te=te.return}if(Zr===null)throw Error(t(160));Bg(_,L,N),Zr=null,bs=!1;var ae=N.alternate;ae!==null&&(ae.return=null),N.return=null}catch(Ae){Ar(N,l,Ae)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Ug(l,i),l=l.sibling}function Ug(i,l){var f=i.alternate,g=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(js(l,i),Qs(i),g&4){try{El(3,i,i.return),wd(3,i)}catch(dt){Ar(i,i.return,dt)}try{El(5,i,i.return)}catch(dt){Ar(i,i.return,dt)}}break;case 1:js(l,i),Qs(i),g&512&&f!==null&&ho(f,f.return);break;case 5:if(js(l,i),Qs(i),g&512&&f!==null&&ho(f,f.return),i.flags&32){var N=i.stateNode;try{Ue(N,"")}catch(dt){Ar(i,i.return,dt)}}if(g&4&&(N=i.stateNode,N!=null)){var _=i.memoizedProps,L=f!==null?f.memoizedProps:_,te=i.type,ae=i.updateQueue;if(i.updateQueue=null,ae!==null)try{te==="input"&&_.type==="radio"&&_.name!=null&&Be(N,_),qt(te,L);var Ae=qt(te,_);for(L=0;L<ae.length;L+=2){var ze=ae[L],qe=ae[L+1];ze==="style"?_t(N,qe):ze==="dangerouslySetInnerHTML"?Ht(N,qe):ze==="children"?Ue(N,qe):F(N,ze,qe,Ae)}switch(te){case"input":Le(N,_);break;case"textarea":cr(N,_);break;case"select":var $e=N._wrapperState.wasMultiple;N._wrapperState.wasMultiple=!!_.multiple;var tt=_.value;tt!=null?lr(N,!!_.multiple,tt,!1):$e!==!!_.multiple&&(_.defaultValue!=null?lr(N,!!_.multiple,_.defaultValue,!0):lr(N,!!_.multiple,_.multiple?[]:"",!1))}N[gl]=_}catch(dt){Ar(i,i.return,dt)}}break;case 6:if(js(l,i),Qs(i),g&4){if(i.stateNode===null)throw Error(t(162));N=i.stateNode,_=i.memoizedProps;try{N.nodeValue=_}catch(dt){Ar(i,i.return,dt)}}break;case 3:if(js(l,i),Qs(i),g&4&&f!==null&&f.memoizedState.isDehydrated)try{il(l.containerInfo)}catch(dt){Ar(i,i.return,dt)}break;case 4:js(l,i),Qs(i);break;case 13:js(l,i),Qs(i),N=i.child,N.flags&8192&&(_=N.memoizedState!==null,N.stateNode.isHidden=_,!_||N.alternate!==null&&N.alternate.memoizedState!==null||(Bf=Ve())),g&4&&$g(i);break;case 22:if(ze=f!==null&&f.memoizedState!==null,i.mode&1?(fn=(Ae=fn)||ze,js(l,i),fn=Ae):js(l,i),Qs(i),g&8192){if(Ae=i.memoizedState!==null,(i.stateNode.isHidden=Ae)&&!ze&&(i.mode&1)!==0)for(st=i,ze=i.child;ze!==null;){for(qe=st=ze;st!==null;){switch($e=st,tt=$e.child,$e.tag){case 0:case 11:case 14:case 15:El(4,$e,$e.return);break;case 1:ho($e,$e.return);var it=$e.stateNode;if(typeof it.componentWillUnmount=="function"){g=$e,f=$e.return;try{l=g,it.props=l.memoizedProps,it.state=l.memoizedState,it.componentWillUnmount()}catch(dt){Ar(g,f,dt)}}break;case 5:ho($e,$e.return);break;case 22:if($e.memoizedState!==null){qg(qe);continue}}tt!==null?(tt.return=$e,st=tt):qg(qe)}ze=ze.sibling}e:for(ze=null,qe=i;;){if(qe.tag===5){if(ze===null){ze=qe;try{N=qe.stateNode,Ae?(_=N.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none"):(te=qe.stateNode,ae=qe.memoizedProps.style,L=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,te.style.display=kt("display",L))}catch(dt){Ar(i,i.return,dt)}}}else if(qe.tag===6){if(ze===null)try{qe.stateNode.nodeValue=Ae?"":qe.memoizedProps}catch(dt){Ar(i,i.return,dt)}}else if((qe.tag!==22&&qe.tag!==23||qe.memoizedState===null||qe===i)&&qe.child!==null){qe.child.return=qe,qe=qe.child;continue}if(qe===i)break e;for(;qe.sibling===null;){if(qe.return===null||qe.return===i)break e;ze===qe&&(ze=null),qe=qe.return}ze===qe&&(ze=null),qe.sibling.return=qe.return,qe=qe.sibling}}break;case 19:js(l,i),Qs(i),g&4&&$g(i);break;case 21:break;default:js(l,i),Qs(i)}}function Qs(i){var l=i.flags;if(l&2){try{e:{for(var f=i.return;f!==null;){if(Lg(f)){var g=f;break e}f=f.return}throw Error(t(160))}switch(g.tag){case 5:var N=g.stateNode;g.flags&32&&(Ue(N,""),g.flags&=-33);var _=Ig(i);Mf(i,_,N);break;case 3:case 4:var L=g.stateNode.containerInfo,te=Ig(i);Ff(i,te,L);break;default:throw Error(t(161))}}catch(ae){Ar(i,i.return,ae)}i.flags&=-3}l&4096&&(i.flags&=-4097)}function Fk(i,l,f){st=i,zg(i)}function zg(i,l,f){for(var g=(i.mode&1)!==0;st!==null;){var N=st,_=N.child;if(N.tag===22&&g){var L=N.memoizedState!==null||vd;if(!L){var te=N.alternate,ae=te!==null&&te.memoizedState!==null||fn;te=vd;var Ae=fn;if(vd=L,(fn=ae)&&!Ae)for(st=N;st!==null;)L=st,ae=L.child,L.tag===22&&L.memoizedState!==null?Vg(N):ae!==null?(ae.return=L,st=ae):Vg(N);for(;_!==null;)st=_,zg(_),_=_.sibling;st=N,vd=te,fn=Ae}Wg(i)}else(N.subtreeFlags&8772)!==0&&_!==null?(_.return=N,st=_):Wg(i)}}function Wg(i){for(;st!==null;){var l=st;if((l.flags&8772)!==0){var f=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:fn||wd(5,l);break;case 1:var g=l.stateNode;if(l.flags&4&&!fn)if(f===null)g.componentDidMount();else{var N=l.elementType===l.type?f.memoizedProps:Ss(l.type,f.memoizedProps);g.componentDidUpdate(N,f.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var _=l.updateQueue;_!==null&&qx(l,_,g);break;case 3:var L=l.updateQueue;if(L!==null){if(f=null,l.child!==null)switch(l.child.tag){case 5:f=l.child.stateNode;break;case 1:f=l.child.stateNode}qx(l,L,f)}break;case 5:var te=l.stateNode;if(f===null&&l.flags&4){f=te;var ae=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&f.focus();break;case"img":ae.src&&(f.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var Ae=l.alternate;if(Ae!==null){var ze=Ae.memoizedState;if(ze!==null){var qe=ze.dehydrated;qe!==null&&il(qe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}fn||l.flags&512&&Df(l)}catch($e){Ar(l,l.return,$e)}}if(l===i){st=null;break}if(f=l.sibling,f!==null){f.return=l.return,st=f;break}st=l.return}}function qg(i){for(;st!==null;){var l=st;if(l===i){st=null;break}var f=l.sibling;if(f!==null){f.return=l.return,st=f;break}st=l.return}}function Vg(i){for(;st!==null;){var l=st;try{switch(l.tag){case 0:case 11:case 15:var f=l.return;try{wd(4,l)}catch(ae){Ar(l,f,ae)}break;case 1:var g=l.stateNode;if(typeof g.componentDidMount=="function"){var N=l.return;try{g.componentDidMount()}catch(ae){Ar(l,N,ae)}}var _=l.return;try{Df(l)}catch(ae){Ar(l,_,ae)}break;case 5:var L=l.return;try{Df(l)}catch(ae){Ar(l,L,ae)}}}catch(ae){Ar(l,l.return,ae)}if(l===i){st=null;break}var te=l.sibling;if(te!==null){te.return=l.return,st=te;break}st=l.return}}var Mk=Math.ceil,Nd=I.ReactCurrentDispatcher,Lf=I.ReactCurrentOwner,hs=I.ReactCurrentBatchConfig,Vt=0,Gr=null,Mr=null,en=0,es=0,po=Ma(0),Ur=0,Al=null,wi=0,Sd=0,If=0,Tl=null,Pn=null,Bf=0,mo=1/0,pa=null,bd=!1,$f=null,za=null,jd=!1,Wa=null,kd=0,Ol=0,Uf=null,_d=-1,Cd=0;function Nn(){return(Vt&6)!==0?Ve():_d!==-1?_d:_d=Ve()}function qa(i){return(i.mode&1)===0?1:(Vt&2)!==0&&en!==0?en&-en:vk.transition!==null?(Cd===0&&(Cd=Im()),Cd):(i=er,i!==0||(i=window.event,i=i===void 0?16:Hm(i.type)),i)}function ks(i,l,f,g){if(50<Ol)throw Ol=0,Uf=null,Error(t(185));tl(i,f,g),((Vt&2)===0||i!==Gr)&&(i===Gr&&((Vt&2)===0&&(Sd|=f),Ur===4&&Va(i,en)),Rn(i,g),f===1&&Vt===0&&(l.mode&1)===0&&(mo=Ve()+500,td&&Ia()))}function Rn(i,l){var f=i.callbackNode;vj(i,l);var g=Mc(i,i===Gr?en:0);if(g===0)f!==null&&Xe(f),i.callbackNode=null,i.callbackPriority=0;else if(l=g&-g,i.callbackPriority!==l){if(f!=null&&Xe(f),l===1)i.tag===0?yk(Hg.bind(null,i)):Px(Hg.bind(null,i)),pk(function(){(Vt&6)===0&&Ia()}),f=null;else{switch(Bm(g)){case 1:f=pr;break;case 4:f=mr;break;case 16:f=Pr;break;case 536870912:f=Ea;break;default:f=Pr}f=ty(f,Qg.bind(null,i))}i.callbackPriority=l,i.callbackNode=f}}function Qg(i,l){if(_d=-1,Cd=0,(Vt&6)!==0)throw Error(t(327));var f=i.callbackNode;if(xo()&&i.callbackNode!==f)return null;var g=Mc(i,i===Gr?en:0);if(g===0)return null;if((g&30)!==0||(g&i.expiredLanes)!==0||l)l=Ed(i,g);else{l=g;var N=Vt;Vt|=2;var _=Yg();(Gr!==i||en!==l)&&(pa=null,mo=Ve()+500,Si(i,l));do try{Bk();break}catch(te){Gg(i,te)}while(!0);sf(),Nd.current=_,Vt=N,Mr!==null?l=0:(Gr=null,en=0,l=Ur)}if(l!==0){if(l===2&&(N=w0(i),N!==0&&(g=N,l=zf(i,N))),l===1)throw f=Al,Si(i,0),Va(i,g),Rn(i,Ve()),f;if(l===6)Va(i,g);else{if(N=i.current.alternate,(g&30)===0&&!Lk(N)&&(l=Ed(i,g),l===2&&(_=w0(i),_!==0&&(g=_,l=zf(i,_))),l===1))throw f=Al,Si(i,0),Va(i,g),Rn(i,Ve()),f;switch(i.finishedWork=N,i.finishedLanes=g,l){case 0:case 1:throw Error(t(345));case 2:bi(i,Pn,pa);break;case 3:if(Va(i,g),(g&130023424)===g&&(l=Bf+500-Ve(),10<l)){if(Mc(i,0)!==0)break;if(N=i.suspendedLanes,(N&g)!==g){Nn(),i.pingedLanes|=i.suspendedLanes&N;break}i.timeoutHandle=H0(bi.bind(null,i,Pn,pa),l);break}bi(i,Pn,pa);break;case 4:if(Va(i,g),(g&4194240)===g)break;for(l=i.eventTimes,N=-1;0<g;){var L=31-Rr(g);_=1<<L,L=l[L],L>N&&(N=L),g&=~_}if(g=N,g=Ve()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*Mk(g/1960))-g,10<g){i.timeoutHandle=H0(bi.bind(null,i,Pn,pa),g);break}bi(i,Pn,pa);break;case 5:bi(i,Pn,pa);break;default:throw Error(t(329))}}}return Rn(i,Ve()),i.callbackNode===f?Qg.bind(null,i):null}function zf(i,l){var f=Tl;return i.current.memoizedState.isDehydrated&&(Si(i,l).flags|=256),i=Ed(i,l),i!==2&&(l=Pn,Pn=f,l!==null&&Wf(l)),i}function Wf(i){Pn===null?Pn=i:Pn.push.apply(Pn,i)}function Lk(i){for(var l=i;;){if(l.flags&16384){var f=l.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var g=0;g<f.length;g++){var N=f[g],_=N.getSnapshot;N=N.value;try{if(!ws(_(),N))return!1}catch{return!1}}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Va(i,l){for(l&=~If,l&=~Sd,i.suspendedLanes|=l,i.pingedLanes&=~l,i=i.expirationTimes;0<l;){var f=31-Rr(l),g=1<<f;i[f]=-1,l&=~g}}function Hg(i){if((Vt&6)!==0)throw Error(t(327));xo();var l=Mc(i,0);if((l&1)===0)return Rn(i,Ve()),null;var f=Ed(i,l);if(i.tag!==0&&f===2){var g=w0(i);g!==0&&(l=g,f=zf(i,g))}if(f===1)throw f=Al,Si(i,0),Va(i,l),Rn(i,Ve()),f;if(f===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=l,bi(i,Pn,pa),Rn(i,Ve()),null}function qf(i,l){var f=Vt;Vt|=1;try{return i(l)}finally{Vt=f,Vt===0&&(mo=Ve()+500,td&&Ia())}}function Ni(i){Wa!==null&&Wa.tag===0&&(Vt&6)===0&&xo();var l=Vt;Vt|=1;var f=hs.transition,g=er;try{if(hs.transition=null,er=1,i)return i()}finally{er=g,hs.transition=f,Vt=l,(Vt&6)===0&&Ia()}}function Vf(){es=po.current,vr(po)}function Si(i,l){i.finishedWork=null,i.finishedLanes=0;var f=i.timeoutHandle;if(f!==-1&&(i.timeoutHandle=-1,hk(f)),Mr!==null)for(f=Mr.return;f!==null;){var g=f;switch(Z0(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Zc();break;case 3:uo(),vr(An),vr(cn),hf();break;case 5:uf(g);break;case 4:uo();break;case 13:vr(Cr);break;case 19:vr(Cr);break;case 10:af(g.type._context);break;case 22:case 23:Vf()}f=f.return}if(Gr=i,Mr=i=Qa(i.current,null),en=es=l,Ur=0,Al=null,If=Sd=wi=0,Pn=Tl=null,gi!==null){for(l=0;l<gi.length;l++)if(f=gi[l],g=f.interleaved,g!==null){f.interleaved=null;var N=g.next,_=f.pending;if(_!==null){var L=_.next;_.next=N,g.next=L}f.pending=g}gi=null}return i}function Gg(i,l){do{var f=Mr;try{if(sf(),ud.current=md,fd){for(var g=Er.memoizedState;g!==null;){var N=g.queue;N!==null&&(N.pending=null),g=g.next}fd=!1}if(vi=0,Hr=$r=Er=null,bl=!1,jl=0,Lf.current=null,f===null||f.return===null){Ur=1,Al=l,Mr=null;break}e:{var _=i,L=f.return,te=f,ae=l;if(l=en,te.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var Ae=ae,ze=te,qe=ze.tag;if((ze.mode&1)===0&&(qe===0||qe===11||qe===15)){var $e=ze.alternate;$e?(ze.updateQueue=$e.updateQueue,ze.memoizedState=$e.memoizedState,ze.lanes=$e.lanes):(ze.updateQueue=null,ze.memoizedState=null)}var tt=vg(L);if(tt!==null){tt.flags&=-257,wg(tt,L,te,_,l),tt.mode&1&&yg(_,Ae,l),l=tt,ae=Ae;var it=l.updateQueue;if(it===null){var dt=new Set;dt.add(ae),l.updateQueue=dt}else it.add(ae);break e}else{if((l&1)===0){yg(_,Ae,l),Qf();break e}ae=Error(t(426))}}else if(Sr&&te.mode&1){var Dr=vg(L);if(Dr!==null){(Dr.flags&65536)===0&&(Dr.flags|=256),wg(Dr,L,te,_,l),rf(fo(ae,te));break e}}_=ae=fo(ae,te),Ur!==4&&(Ur=2),Tl===null?Tl=[_]:Tl.push(_),_=L;do{switch(_.tag){case 3:_.flags|=65536,l&=-l,_.lanes|=l;var ye=xg(_,ae,l);Wx(_,ye);break e;case 1:te=ae;var ue=_.type,be=_.stateNode;if((_.flags&128)===0&&(typeof ue.getDerivedStateFromError=="function"||be!==null&&typeof be.componentDidCatch=="function"&&(za===null||!za.has(be)))){_.flags|=65536,l&=-l,_.lanes|=l;var He=gg(_,te,l);Wx(_,He);break e}}_=_.return}while(_!==null)}Xg(f)}catch(ht){l=ht,Mr===f&&f!==null&&(Mr=f=f.return);continue}break}while(!0)}function Yg(){var i=Nd.current;return Nd.current=md,i===null?md:i}function Qf(){(Ur===0||Ur===3||Ur===2)&&(Ur=4),Gr===null||(wi&268435455)===0&&(Sd&268435455)===0||Va(Gr,en)}function Ed(i,l){var f=Vt;Vt|=2;var g=Yg();(Gr!==i||en!==l)&&(pa=null,Si(i,l));do try{Ik();break}catch(N){Gg(i,N)}while(!0);if(sf(),Vt=f,Nd.current=g,Mr!==null)throw Error(t(261));return Gr=null,en=0,Ur}function Ik(){for(;Mr!==null;)Kg(Mr)}function Bk(){for(;Mr!==null&&!nt();)Kg(Mr)}function Kg(i){var l=ey(i.alternate,i,es);i.memoizedProps=i.pendingProps,l===null?Xg(i):Mr=l,Lf.current=null}function Xg(i){var l=i;do{var f=l.alternate;if(i=l.return,(l.flags&32768)===0){if(f=Ok(f,l,es),f!==null){Mr=f;return}}else{if(f=Pk(f,l),f!==null){f.flags&=32767,Mr=f;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Ur=6,Mr=null;return}}if(l=l.sibling,l!==null){Mr=l;return}Mr=l=i}while(l!==null);Ur===0&&(Ur=5)}function bi(i,l,f){var g=er,N=hs.transition;try{hs.transition=null,er=1,$k(i,l,f,g)}finally{hs.transition=N,er=g}return null}function $k(i,l,f,g){do xo();while(Wa!==null);if((Vt&6)!==0)throw Error(t(327));f=i.finishedWork;var N=i.finishedLanes;if(f===null)return null;if(i.finishedWork=null,i.finishedLanes=0,f===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var _=f.lanes|f.childLanes;if(wj(i,_),i===Gr&&(Mr=Gr=null,en=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||jd||(jd=!0,ty(Pr,function(){return xo(),null})),_=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||_){_=hs.transition,hs.transition=null;var L=er;er=1;var te=Vt;Vt|=4,Lf.current=null,Dk(i,f),Ug(f,i),ik(V0),Bc=!!q0,V0=q0=null,i.current=f,Fk(f),Qe(),Vt=te,er=L,hs.transition=_}else i.current=f;if(jd&&(jd=!1,Wa=i,kd=N),_=i.pendingLanes,_===0&&(za=null),Zo(f.stateNode),Rn(i,Ve()),l!==null)for(g=i.onRecoverableError,f=0;f<l.length;f++)N=l[f],g(N.value,{componentStack:N.stack,digest:N.digest});if(bd)throw bd=!1,i=$f,$f=null,i;return(kd&1)!==0&&i.tag!==0&&xo(),_=i.pendingLanes,(_&1)!==0?i===Uf?Ol++:(Ol=0,Uf=i):Ol=0,Ia(),null}function xo(){if(Wa!==null){var i=Bm(kd),l=hs.transition,f=er;try{if(hs.transition=null,er=16>i?16:i,Wa===null)var g=!1;else{if(i=Wa,Wa=null,kd=0,(Vt&6)!==0)throw Error(t(331));var N=Vt;for(Vt|=4,st=i.current;st!==null;){var _=st,L=_.child;if((st.flags&16)!==0){var te=_.deletions;if(te!==null){for(var ae=0;ae<te.length;ae++){var Ae=te[ae];for(st=Ae;st!==null;){var ze=st;switch(ze.tag){case 0:case 11:case 15:El(8,ze,_)}var qe=ze.child;if(qe!==null)qe.return=ze,st=qe;else for(;st!==null;){ze=st;var $e=ze.sibling,tt=ze.return;if(Mg(ze),ze===Ae){st=null;break}if($e!==null){$e.return=tt,st=$e;break}st=tt}}}var it=_.alternate;if(it!==null){var dt=it.child;if(dt!==null){it.child=null;do{var Dr=dt.sibling;dt.sibling=null,dt=Dr}while(dt!==null)}}st=_}}if((_.subtreeFlags&2064)!==0&&L!==null)L.return=_,st=L;else e:for(;st!==null;){if(_=st,(_.flags&2048)!==0)switch(_.tag){case 0:case 11:case 15:El(9,_,_.return)}var ye=_.sibling;if(ye!==null){ye.return=_.return,st=ye;break e}st=_.return}}var ue=i.current;for(st=ue;st!==null;){L=st;var be=L.child;if((L.subtreeFlags&2064)!==0&&be!==null)be.return=L,st=be;else e:for(L=ue;st!==null;){if(te=st,(te.flags&2048)!==0)try{switch(te.tag){case 0:case 11:case 15:wd(9,te)}}catch(ht){Ar(te,te.return,ht)}if(te===L){st=null;break e}var He=te.sibling;if(He!==null){He.return=te.return,st=He;break e}st=te.return}}if(Vt=N,Ia(),Qr&&typeof Qr.onPostCommitFiberRoot=="function")try{Qr.onPostCommitFiberRoot(zs,i)}catch{}g=!0}return g}finally{er=f,hs.transition=l}}return!1}function Jg(i,l,f){l=fo(f,l),l=xg(i,l,1),i=$a(i,l,1),l=Nn(),i!==null&&(tl(i,1,l),Rn(i,l))}function Ar(i,l,f){if(i.tag===3)Jg(i,i,f);else for(;l!==null;){if(l.tag===3){Jg(l,i,f);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(za===null||!za.has(g))){i=fo(f,i),i=gg(l,i,1),l=$a(l,i,1),i=Nn(),l!==null&&(tl(l,1,i),Rn(l,i));break}}l=l.return}}function Uk(i,l,f){var g=i.pingCache;g!==null&&g.delete(l),l=Nn(),i.pingedLanes|=i.suspendedLanes&f,Gr===i&&(en&f)===f&&(Ur===4||Ur===3&&(en&130023424)===en&&500>Ve()-Bf?Si(i,0):If|=f),Rn(i,l)}function Zg(i,l){l===0&&((i.mode&1)===0?l=1:(l=Fc,Fc<<=1,(Fc&130023424)===0&&(Fc=4194304)));var f=Nn();i=ua(i,l),i!==null&&(tl(i,l,f),Rn(i,f))}function zk(i){var l=i.memoizedState,f=0;l!==null&&(f=l.retryLane),Zg(i,f)}function Wk(i,l){var f=0;switch(i.tag){case 13:var g=i.stateNode,N=i.memoizedState;N!==null&&(f=N.retryLane);break;case 19:g=i.stateNode;break;default:throw Error(t(314))}g!==null&&g.delete(l),Zg(i,f)}var ey;ey=function(i,l,f){if(i!==null)if(i.memoizedProps!==l.pendingProps||An.current)On=!0;else{if((i.lanes&f)===0&&(l.flags&128)===0)return On=!1,Tk(i,l,f);On=(i.flags&131072)!==0}else On=!1,Sr&&(l.flags&1048576)!==0&&Rx(l,nd,l.index);switch(l.lanes=0,l.tag){case 2:var g=l.type;yd(i,l),i=l.pendingProps;var N=no(l,cn.current);co(l,f),N=xf(null,l,g,i,N,f);var _=gf();return l.flags|=1,typeof N=="object"&&N!==null&&typeof N.render=="function"&&N.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,Tn(g)?(_=!0,ed(l)):_=!1,l.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,cf(l),N.updater=xd,l.stateNode=N,N._reactInternals=l,bf(l,g,i,f),l=Cf(null,l,g,!0,_,f)):(l.tag=0,Sr&&_&&J0(l),wn(null,l,N,f),l=l.child),l;case 16:g=l.elementType;e:{switch(yd(i,l),i=l.pendingProps,N=g._init,g=N(g._payload),l.type=g,N=l.tag=Vk(g),i=Ss(g,i),N){case 0:l=_f(null,l,g,i,f);break e;case 1:l=_g(null,l,g,i,f);break e;case 11:l=Ng(null,l,g,i,f);break e;case 14:l=Sg(null,l,g,Ss(g.type,i),f);break e}throw Error(t(306,g,""))}return l;case 0:return g=l.type,N=l.pendingProps,N=l.elementType===g?N:Ss(g,N),_f(i,l,g,N,f);case 1:return g=l.type,N=l.pendingProps,N=l.elementType===g?N:Ss(g,N),_g(i,l,g,N,f);case 3:e:{if(Cg(l),i===null)throw Error(t(387));g=l.pendingProps,_=l.memoizedState,N=_.element,zx(i,l),cd(l,g,null,f);var L=l.memoizedState;if(g=L.element,_.isDehydrated)if(_={element:g,isDehydrated:!1,cache:L.cache,pendingSuspenseBoundaries:L.pendingSuspenseBoundaries,transitions:L.transitions},l.updateQueue.baseState=_,l.memoizedState=_,l.flags&256){N=fo(Error(t(423)),l),l=Eg(i,l,g,f,N);break e}else if(g!==N){N=fo(Error(t(424)),l),l=Eg(i,l,g,f,N);break e}else for(Zn=Fa(l.stateNode.containerInfo.firstChild),Jn=l,Sr=!0,Ns=null,f=$x(l,null,g,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(io(),g===N){l=ha(i,l,f);break e}wn(i,l,g,f)}l=l.child}return l;case 5:return Vx(l),i===null&&tf(l),g=l.type,N=l.pendingProps,_=i!==null?i.memoizedProps:null,L=N.children,Q0(g,N)?L=null:_!==null&&Q0(g,_)&&(l.flags|=32),kg(i,l),wn(i,l,L,f),l.child;case 6:return i===null&&tf(l),null;case 13:return Ag(i,l,f);case 4:return df(l,l.stateNode.containerInfo),g=l.pendingProps,i===null?l.child=oo(l,null,g,f):wn(i,l,g,f),l.child;case 11:return g=l.type,N=l.pendingProps,N=l.elementType===g?N:Ss(g,N),Ng(i,l,g,N,f);case 7:return wn(i,l,l.pendingProps,f),l.child;case 8:return wn(i,l,l.pendingProps.children,f),l.child;case 12:return wn(i,l,l.pendingProps.children,f),l.child;case 10:e:{if(g=l.type._context,N=l.pendingProps,_=l.memoizedProps,L=N.value,xr(id,g._currentValue),g._currentValue=L,_!==null)if(ws(_.value,L)){if(_.children===N.children&&!An.current){l=ha(i,l,f);break e}}else for(_=l.child,_!==null&&(_.return=l);_!==null;){var te=_.dependencies;if(te!==null){L=_.child;for(var ae=te.firstContext;ae!==null;){if(ae.context===g){if(_.tag===1){ae=fa(-1,f&-f),ae.tag=2;var Ae=_.updateQueue;if(Ae!==null){Ae=Ae.shared;var ze=Ae.pending;ze===null?ae.next=ae:(ae.next=ze.next,ze.next=ae),Ae.pending=ae}}_.lanes|=f,ae=_.alternate,ae!==null&&(ae.lanes|=f),of(_.return,f,l),te.lanes|=f;break}ae=ae.next}}else if(_.tag===10)L=_.type===l.type?null:_.child;else if(_.tag===18){if(L=_.return,L===null)throw Error(t(341));L.lanes|=f,te=L.alternate,te!==null&&(te.lanes|=f),of(L,f,l),L=_.sibling}else L=_.child;if(L!==null)L.return=_;else for(L=_;L!==null;){if(L===l){L=null;break}if(_=L.sibling,_!==null){_.return=L.return,L=_;break}L=L.return}_=L}wn(i,l,N.children,f),l=l.child}return l;case 9:return N=l.type,g=l.pendingProps.children,co(l,f),N=us(N),g=g(N),l.flags|=1,wn(i,l,g,f),l.child;case 14:return g=l.type,N=Ss(g,l.pendingProps),N=Ss(g.type,N),Sg(i,l,g,N,f);case 15:return bg(i,l,l.type,l.pendingProps,f);case 17:return g=l.type,N=l.pendingProps,N=l.elementType===g?N:Ss(g,N),yd(i,l),l.tag=1,Tn(g)?(i=!0,ed(l)):i=!1,co(l,f),pg(l,g,N),bf(l,g,N,f),Cf(null,l,g,!0,i,f);case 19:return Og(i,l,f);case 22:return jg(i,l,f)}throw Error(t(156,l.tag))};function ty(i,l){return We(i,l)}function qk(i,l,f,g){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ps(i,l,f,g){return new qk(i,l,f,g)}function Hf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Vk(i){if(typeof i=="function")return Hf(i)?1:0;if(i!=null){if(i=i.$$typeof,i===me)return 11;if(i===Fe)return 14}return 2}function Qa(i,l){var f=i.alternate;return f===null?(f=ps(i.tag,l,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=l,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&14680064,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,l=i.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f}function Ad(i,l,f,g,N,_){var L=2;if(g=i,typeof i=="function")Hf(i)&&(L=1);else if(typeof i=="string")L=5;else e:switch(i){case Q:return ji(f.children,N,_,l);case z:L=8,N|=8;break;case J:return i=ps(12,f,l,N|2),i.elementType=J,i.lanes=_,i;case le:return i=ps(13,f,l,N),i.elementType=le,i.lanes=_,i;case K:return i=ps(19,f,l,N),i.elementType=K,i.lanes=_,i;case oe:return Td(f,N,_,l);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case ne:L=10;break e;case fe:L=9;break e;case me:L=11;break e;case Fe:L=14;break e;case we:L=16,g=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return l=ps(L,f,l,N),l.elementType=i,l.type=g,l.lanes=_,l}function ji(i,l,f,g){return i=ps(7,i,g,l),i.lanes=f,i}function Td(i,l,f,g){return i=ps(22,i,g,l),i.elementType=oe,i.lanes=f,i.stateNode={isHidden:!1},i}function Gf(i,l,f){return i=ps(6,i,null,l),i.lanes=f,i}function Yf(i,l,f){return l=ps(4,i.children!==null?i.children:[],i.key,l),l.lanes=f,l.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},l}function Qk(i,l,f,g,N){this.tag=l,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=N0(0),this.expirationTimes=N0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=N0(0),this.identifierPrefix=g,this.onRecoverableError=N,this.mutableSourceEagerHydrationData=null}function Kf(i,l,f,g,N,_,L,te,ae){return i=new Qk(i,l,f,te,ae),l===1?(l=1,_===!0&&(l|=8)):l=0,_=ps(3,null,null,l),i.current=_,_.stateNode=i,_.memoizedState={element:g,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},cf(_),i}function Hk(i,l,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:g==null?null:""+g,children:i,containerInfo:l,implementation:f}}function ry(i){if(!i)return La;i=i._reactInternals;e:{if(X(i)!==i||i.tag!==1)throw Error(t(170));var l=i;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(Tn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(i.tag===1){var f=i.type;if(Tn(f))return Tx(i,f,l)}return l}function ny(i,l,f,g,N,_,L,te,ae){return i=Kf(f,g,!0,i,N,_,L,te,ae),i.context=ry(null),f=i.current,g=Nn(),N=qa(f),_=fa(g,N),_.callback=l??null,$a(f,_,N),i.current.lanes=N,tl(i,N,g),Rn(i,g),i}function Od(i,l,f,g){var N=l.current,_=Nn(),L=qa(N);return f=ry(f),l.context===null?l.context=f:l.pendingContext=f,l=fa(_,L),l.payload={element:i},g=g===void 0?null:g,g!==null&&(l.callback=g),i=$a(N,l,L),i!==null&&(ks(i,N,L,_),ld(i,N,L)),L}function Pd(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function sy(i,l){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<l?f:l}}function Xf(i,l){sy(i,l),(i=i.alternate)&&sy(i,l)}function Gk(){return null}var ay=typeof reportError=="function"?reportError:function(i){console.error(i)};function Jf(i){this._internalRoot=i}Rd.prototype.render=Jf.prototype.render=function(i){var l=this._internalRoot;if(l===null)throw Error(t(409));Od(i,l,null,null)},Rd.prototype.unmount=Jf.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var l=i.containerInfo;Ni(function(){Od(null,i,null,null)}),l[oa]=null}};function Rd(i){this._internalRoot=i}Rd.prototype.unstable_scheduleHydration=function(i){if(i){var l=zm();i={blockedOn:null,target:i,priority:l};for(var f=0;f<Pa.length&&l!==0&&l<Pa[f].priority;f++);Pa.splice(f,0,i),f===0&&Vm(i)}};function Zf(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Dd(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function iy(){}function Yk(i,l,f,g,N){if(N){if(typeof g=="function"){var _=g;g=function(){var Ae=Pd(L);_.call(Ae)}}var L=ny(l,g,i,0,null,!1,!1,"",iy);return i._reactRootContainer=L,i[oa]=L.current,ml(i.nodeType===8?i.parentNode:i),Ni(),L}for(;N=i.lastChild;)i.removeChild(N);if(typeof g=="function"){var te=g;g=function(){var Ae=Pd(ae);te.call(Ae)}}var ae=Kf(i,0,!1,null,null,!1,!1,"",iy);return i._reactRootContainer=ae,i[oa]=ae.current,ml(i.nodeType===8?i.parentNode:i),Ni(function(){Od(l,ae,f,g)}),ae}function Fd(i,l,f,g,N){var _=f._reactRootContainer;if(_){var L=_;if(typeof N=="function"){var te=N;N=function(){var ae=Pd(L);te.call(ae)}}Od(l,L,i,N)}else L=Yk(f,l,i,N,g);return Pd(L)}$m=function(i){switch(i.tag){case 3:var l=i.stateNode;if(l.current.memoizedState.isDehydrated){var f=el(l.pendingLanes);f!==0&&(S0(l,f|1),Rn(l,Ve()),(Vt&6)===0&&(mo=Ve()+500,Ia()))}break;case 13:Ni(function(){var g=ua(i,1);if(g!==null){var N=Nn();ks(g,i,1,N)}}),Xf(i,1)}},b0=function(i){if(i.tag===13){var l=ua(i,134217728);if(l!==null){var f=Nn();ks(l,i,134217728,f)}Xf(i,134217728)}},Um=function(i){if(i.tag===13){var l=qa(i),f=ua(i,l);if(f!==null){var g=Nn();ks(f,i,l,g)}Xf(i,l)}},zm=function(){return er},Wm=function(i,l){var f=er;try{return er=i,l()}finally{er=f}},Ut=function(i,l,f){switch(l){case"input":if(Le(i,f),l=f.name,f.type==="radio"&&l!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<f.length;l++){var g=f[l];if(g!==i&&g.form===i.form){var N=Jc(g);if(!N)throw Error(t(90));D(g),Le(g,N)}}}break;case"textarea":cr(i,f);break;case"select":l=f.value,l!=null&&lr(i,!!f.multiple,l,!1)}},Re=qf,pe=Ni;var Kk={usingClientEntryPoint:!1,Events:[yl,to,Jc,ge,he,qf]},Pl={findFiberByHostInstance:hi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Xk={bundleType:Pl.bundleType,version:Pl.version,rendererPackageName:Pl.rendererPackageName,rendererConfig:Pl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=ke(i),i===null?null:i.stateNode},findFiberByHostInstance:Pl.findFiberByHostInstance||Gk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Md=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Md.isDisabled&&Md.supportsFiber)try{zs=Md.inject(Xk),Qr=Md}catch{}}return Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kk,Dn.createPortal=function(i,l){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zf(l))throw Error(t(200));return Hk(i,l,null,f)},Dn.createRoot=function(i,l){if(!Zf(i))throw Error(t(299));var f=!1,g="",N=ay;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onRecoverableError!==void 0&&(N=l.onRecoverableError)),l=Kf(i,1,!1,null,null,f,!1,g,N),i[oa]=l.current,ml(i.nodeType===8?i.parentNode:i),new Jf(l)},Dn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var l=i._reactInternals;if(l===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=ke(l),i=i===null?null:i.stateNode,i},Dn.flushSync=function(i){return Ni(i)},Dn.hydrate=function(i,l,f){if(!Dd(l))throw Error(t(200));return Fd(null,i,l,!0,f)},Dn.hydrateRoot=function(i,l,f){if(!Zf(i))throw Error(t(405));var g=f!=null&&f.hydratedSources||null,N=!1,_="",L=ay;if(f!=null&&(f.unstable_strictMode===!0&&(N=!0),f.identifierPrefix!==void 0&&(_=f.identifierPrefix),f.onRecoverableError!==void 0&&(L=f.onRecoverableError)),l=ny(l,null,i,1,f??null,N,!1,_,L),i[oa]=l.current,ml(i),g)for(i=0;i<g.length;i++)f=g[i],N=f._getVersion,N=N(f._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[f,N]:l.mutableSourceEagerHydrationData.push(f,N);return new Rd(l)},Dn.render=function(i,l,f){if(!Dd(l))throw Error(t(200));return Fd(null,i,l,!1,f)},Dn.unmountComponentAtNode=function(i){if(!Dd(i))throw Error(t(40));return i._reactRootContainer?(Ni(function(){Fd(null,null,i,!1,function(){i._reactRootContainer=null,i[oa]=null})}),!0):!1},Dn.unstable_batchedUpdates=qf,Dn.unstable_renderSubtreeIntoContainer=function(i,l,f,g){if(!Dd(f))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return Fd(i,l,f,!1,g)},Dn.version="18.3.1-next-f1338f8080-20240426",Dn}var py;function v1(){if(py)return rh.exports;py=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),rh.exports=a_(),rh.exports}var my;function i_(){if(my)return Ld;my=1;var e=v1();return Ld.createRoot=e.createRoot,Ld.hydrateRoot=e.hydrateRoot,Ld}var o_=i_(),m=$u();const Xa=y1(m),mp=Zk({__proto__:null,default:Xa},[m]);/**
 * react-router v7.9.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var xy="popstate";function l_(e={}){function r(s,a){let{pathname:o,search:c,hash:u}=s.location;return $h("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){return typeof a=="string"?a:Yl(a)}return d_(r,t,null,e)}function br(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function Ps(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function c_(){return Math.random().toString(36).substring(2,10)}function gy(e,r){return{usr:e.state,key:e.key,idx:r}}function $h(e,r,t=null,s){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof r=="string"?Io(r):r,state:t,key:r&&r.key||s||c_()}}function Yl({pathname:e="/",search:r="",hash:t=""}){return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function Io(e){let r={};if(e){let t=e.indexOf("#");t>=0&&(r.hash=e.substring(t),e=e.substring(0,t));let s=e.indexOf("?");s>=0&&(r.search=e.substring(s),e=e.substring(0,s)),e&&(r.pathname=e)}return r}function d_(e,r,t,s={}){let{window:a=document.defaultView,v5Compat:o=!1}=s,c=a.history,u="POP",p=null,h=x();h==null&&(h=0,c.replaceState({...c.state,idx:h},""));function x(){return(c.state||{idx:null}).idx}function y(){u="POP";let j=x(),O=j==null?null:j-h;h=j,p&&p({action:u,location:w.location,delta:O})}function v(j,O){u="PUSH";let T=$h(w.location,j,O);h=x()+1;let F=gy(T,h),I=w.createHref(T);try{c.pushState(F,"",I)}catch(G){if(G instanceof DOMException&&G.name==="DataCloneError")throw G;a.location.assign(I)}o&&p&&p({action:u,location:w.location,delta:1})}function k(j,O){u="REPLACE";let T=$h(w.location,j,O);h=x();let F=gy(T,h),I=w.createHref(T);c.replaceState(F,"",I),o&&p&&p({action:u,location:w.location,delta:0})}function b(j){return u_(j)}let w={get action(){return u},get location(){return e(a,c)},listen(j){if(p)throw new Error("A history only accepts one active listener");return a.addEventListener(xy,y),p=j,()=>{a.removeEventListener(xy,y),p=null}},createHref(j){return r(a,j)},createURL:b,encodeLocation(j){let O=b(j);return{pathname:O.pathname,search:O.search,hash:O.hash}},push:v,replace:k,go(j){return c.go(j)}};return w}function u_(e,r=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),br(t,"No window.location.(origin|href) available to create URL");let s=typeof e=="string"?e:Yl(e);return s=s.replace(/ $/,"%20"),!r&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function w1(e,r,t="/"){return f_(e,r,t,!1)}function f_(e,r,t,s){let a=typeof r=="string"?Io(r):r,o=Na(a.pathname||"/",t);if(o==null)return null;let c=N1(e);h_(c);let u=null;for(let p=0;u==null&&p<c.length;++p){let h=j_(o);u=S_(c[p],h,s)}return u}function N1(e,r=[],t=[],s="",a=!1){let o=(c,u,p=a,h)=>{let x={relativePath:h===void 0?c.path||"":h,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(s)&&p)return;br(x.relativePath.startsWith(s),`Absolute route path "${x.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(s.length)}let y=ga([s,x.relativePath]),v=t.concat(x);c.children&&c.children.length>0&&(br(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${y}".`),N1(c.children,r,v,y,p)),!(c.path==null&&!c.index)&&r.push({path:y,score:w_(y,c.index),routesMeta:v})};return e.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))o(c,u);else for(let p of S1(c.path))o(c,u,!0,p)}),r}function S1(e){let r=e.split("/");if(r.length===0)return[];let[t,...s]=r,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(s.length===0)return a?[o,""]:[o];let c=S1(s.join("/")),u=[];return u.push(...c.map(p=>p===""?o:[o,p].join("/"))),a&&u.push(...c),u.map(p=>e.startsWith("/")&&p===""?"/":p)}function h_(e){e.sort((r,t)=>r.score!==t.score?t.score-r.score:N_(r.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var p_=/^:[\w-]+$/,m_=3,x_=2,g_=1,y_=10,v_=-2,yy=e=>e==="*";function w_(e,r){let t=e.split("/"),s=t.length;return t.some(yy)&&(s+=v_),r&&(s+=x_),t.filter(a=>!yy(a)).reduce((a,o)=>a+(p_.test(o)?m_:o===""?g_:y_),s)}function N_(e,r){return e.length===r.length&&e.slice(0,-1).every((s,a)=>s===r[a])?e[e.length-1]-r[r.length-1]:0}function S_(e,r,t=!1){let{routesMeta:s}=e,a={},o="/",c=[];for(let u=0;u<s.length;++u){let p=s[u],h=u===s.length-1,x=o==="/"?r:r.slice(o.length)||"/",y=uu({path:p.relativePath,caseSensitive:p.caseSensitive,end:h},x),v=p.route;if(!y&&h&&t&&!s[s.length-1].route.index&&(y=uu({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},x)),!y)return null;Object.assign(a,y.params),c.push({params:a,pathname:ga([o,y.pathname]),pathnameBase:E_(ga([o,y.pathnameBase])),route:v}),y.pathnameBase!=="/"&&(o=ga([o,y.pathnameBase]))}return c}function uu(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,s]=b_(e.path,e.caseSensitive,e.end),a=r.match(t);if(!a)return null;let o=a[0],c=o.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:s.reduce((h,{paramName:x,isOptional:y},v)=>{if(x==="*"){let b=u[v]||"";c=o.slice(0,o.length-b.length).replace(/(.)\/+$/,"$1")}const k=u[v];return y&&!k?h[x]=void 0:h[x]=(k||"").replace(/%2F/g,"/"),h},{}),pathname:o,pathnameBase:c,pattern:e}}function b_(e,r=!1,t=!0){Ps(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let s=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,p)=>(s.push({paramName:u,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(s.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,r?void 0:"i"),s]}function j_(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Ps(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),e}}function Na(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let t=r.endsWith("/")?r.length-1:r.length,s=e.charAt(t);return s&&s!=="/"?null:e.slice(t)||"/"}function k_(e,r="/"){let{pathname:t,search:s="",hash:a=""}=typeof e=="string"?Io(e):e;return{pathname:t?t.startsWith("/")?t:__(t,r):r,search:A_(s),hash:T_(a)}}function __(e,r){let t=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function ah(e,r,t,s){return`Cannot include a '${e}' character in a manually specified \`to.${r}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function C_(e){return e.filter((r,t)=>t===0||r.route.path&&r.route.path.length>0)}function xp(e){let r=C_(e);return r.map((t,s)=>s===r.length-1?t.pathname:t.pathnameBase)}function gp(e,r,t,s=!1){let a;typeof e=="string"?a=Io(e):(a={...e},br(!a.pathname||!a.pathname.includes("?"),ah("?","pathname","search",a)),br(!a.pathname||!a.pathname.includes("#"),ah("#","pathname","hash",a)),br(!a.search||!a.search.includes("#"),ah("#","search","hash",a)));let o=e===""||a.pathname==="",c=o?"/":a.pathname,u;if(c==null)u=t;else{let y=r.length-1;if(!s&&c.startsWith("..")){let v=c.split("/");for(;v[0]==="..";)v.shift(),y-=1;a.pathname=v.join("/")}u=y>=0?r[y]:"/"}let p=k_(a,u),h=c&&c!=="/"&&c.endsWith("/"),x=(o||c===".")&&t.endsWith("/");return!p.pathname.endsWith("/")&&(h||x)&&(p.pathname+="/"),p}var ga=e=>e.join("/").replace(/\/\/+/g,"/"),E_=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),A_=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,T_=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function O_(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var b1=["POST","PUT","PATCH","DELETE"];new Set(b1);var P_=["GET",...b1];new Set(P_);var Bo=m.createContext(null);Bo.displayName="DataRouter";var Uu=m.createContext(null);Uu.displayName="DataRouterState";m.createContext(!1);var j1=m.createContext({isTransitioning:!1});j1.displayName="ViewTransition";var R_=m.createContext(new Map);R_.displayName="Fetchers";var D_=m.createContext(null);D_.displayName="Await";var Is=m.createContext(null);Is.displayName="Navigation";var lc=m.createContext(null);lc.displayName="Location";var sa=m.createContext({outlet:null,matches:[],isDataRoute:!1});sa.displayName="Route";var yp=m.createContext(null);yp.displayName="RouteError";function F_(e,{relative:r}={}){br($o(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=m.useContext(Is),{hash:a,pathname:o,search:c}=cc(e,{relative:r}),u=o;return t!=="/"&&(u=o==="/"?t:ga([t,o])),s.createHref({pathname:u,search:c,hash:a})}function $o(){return m.useContext(lc)!=null}function oi(){return br($o(),"useLocation() may be used only in the context of a <Router> component."),m.useContext(lc).location}var k1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function _1(e){m.useContext(Is).static||m.useLayoutEffect(e)}function vp(){let{isDataRoute:e}=m.useContext(sa);return e?G_():M_()}function M_(){br($o(),"useNavigate() may be used only in the context of a <Router> component.");let e=m.useContext(Bo),{basename:r,navigator:t}=m.useContext(Is),{matches:s}=m.useContext(sa),{pathname:a}=oi(),o=JSON.stringify(xp(s)),c=m.useRef(!1);return _1(()=>{c.current=!0}),m.useCallback((p,h={})=>{if(Ps(c.current,k1),!c.current)return;if(typeof p=="number"){t.go(p);return}let x=gp(p,JSON.parse(o),a,h.relative==="path");e==null&&r!=="/"&&(x.pathname=x.pathname==="/"?r:ga([r,x.pathname])),(h.replace?t.replace:t.push)(x,h.state,h)},[r,t,o,a,e])}m.createContext(null);function cc(e,{relative:r}={}){let{matches:t}=m.useContext(sa),{pathname:s}=oi(),a=JSON.stringify(xp(t));return m.useMemo(()=>gp(e,JSON.parse(a),s,r==="path"),[e,a,s,r])}function L_(e,r){return C1(e,r)}function C1(e,r,t,s,a){br($o(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=m.useContext(Is),{matches:c}=m.useContext(sa),u=c[c.length-1],p=u?u.params:{},h=u?u.pathname:"/",x=u?u.pathnameBase:"/",y=u&&u.route;{let T=y&&y.path||"";E1(h,!y||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let v=oi(),k;if(r){let T=typeof r=="string"?Io(r):r;br(x==="/"||T.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${T.pathname}" was given in the \`location\` prop.`),k=T}else k=v;let b=k.pathname||"/",w=b;if(x!=="/"){let T=x.replace(/^\//,"").split("/");w="/"+b.replace(/^\//,"").split("/").slice(T.length).join("/")}let j=w1(e,{pathname:w});Ps(y||j!=null,`No routes matched location "${k.pathname}${k.search}${k.hash}" `),Ps(j==null||j[j.length-1].route.element!==void 0||j[j.length-1].route.Component!==void 0||j[j.length-1].route.lazy!==void 0,`Matched leaf route at location "${k.pathname}${k.search}${k.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let O=z_(j&&j.map(T=>Object.assign({},T,{params:Object.assign({},p,T.params),pathname:ga([x,o.encodeLocation?o.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?x:ga([x,o.encodeLocation?o.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),c,t,s,a);return r&&O?m.createElement(lc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...k},navigationType:"POP"}},O):O}function I_(){let e=H_(),r=O_(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:s},o={padding:"2px 4px",backgroundColor:s},c=null;return console.error("Error handled by React Router default ErrorBoundary:",e),c=m.createElement(m.Fragment,null,m.createElement("p",null," Hey developer "),m.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",m.createElement("code",{style:o},"ErrorBoundary")," or"," ",m.createElement("code",{style:o},"errorElement")," prop on your route.")),m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},r),t?m.createElement("pre",{style:a},t):null,c)}var B_=m.createElement(I_,null),$_=class extends m.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){this.props.unstable_onError?this.props.unstable_onError(e,r):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?m.createElement(sa.Provider,{value:this.props.routeContext},m.createElement(yp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function U_({routeContext:e,match:r,children:t}){let s=m.useContext(Bo);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),m.createElement(sa.Provider,{value:e},t)}function z_(e,r=[],t=null,s=null,a=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(r.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let o=e,c=t?.errors;if(c!=null){let h=o.findIndex(x=>x.route.id&&c?.[x.route.id]!==void 0);br(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),o=o.slice(0,Math.min(o.length,h+1))}let u=!1,p=-1;if(t)for(let h=0;h<o.length;h++){let x=o[h];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=h),x.route.id){let{loaderData:y,errors:v}=t,k=x.route.loader&&!y.hasOwnProperty(x.route.id)&&(!v||v[x.route.id]===void 0);if(x.route.lazy||k){u=!0,p>=0?o=o.slice(0,p+1):o=[o[0]];break}}}return o.reduceRight((h,x,y)=>{let v,k=!1,b=null,w=null;t&&(v=c&&x.route.id?c[x.route.id]:void 0,b=x.route.errorElement||B_,u&&(p<0&&y===0?(E1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),k=!0,w=null):p===y&&(k=!0,w=x.route.hydrateFallbackElement||null)));let j=r.concat(o.slice(0,y+1)),O=()=>{let T;return v?T=b:k?T=w:x.route.Component?T=m.createElement(x.route.Component,null):x.route.element?T=x.route.element:T=h,m.createElement(U_,{match:x,routeContext:{outlet:h,matches:j,isDataRoute:t!=null},children:T})};return t&&(x.route.ErrorBoundary||x.route.errorElement||y===0)?m.createElement($_,{location:t.location,revalidation:t.revalidation,component:b,error:v,children:O(),routeContext:{outlet:null,matches:j,isDataRoute:!0},unstable_onError:s}):O()},null)}function wp(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function W_(e){let r=m.useContext(Bo);return br(r,wp(e)),r}function q_(e){let r=m.useContext(Uu);return br(r,wp(e)),r}function V_(e){let r=m.useContext(sa);return br(r,wp(e)),r}function Np(e){let r=V_(e),t=r.matches[r.matches.length-1];return br(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function Q_(){return Np("useRouteId")}function H_(){let e=m.useContext(yp),r=q_("useRouteError"),t=Np("useRouteError");return e!==void 0?e:r.errors?.[t]}function G_(){let{router:e}=W_("useNavigate"),r=Np("useNavigate"),t=m.useRef(!1);return _1(()=>{t.current=!0}),m.useCallback(async(a,o={})=>{Ps(t.current,k1),t.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:r,...o}))},[e,r])}var vy={};function E1(e,r,t){!r&&!vy[e]&&(vy[e]=!0,Ps(!1,t))}m.memo(Y_);function Y_({routes:e,future:r,state:t,unstable_onError:s}){return C1(e,void 0,t,s,r)}function Uh({to:e,replace:r,state:t,relative:s}){br($o(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=m.useContext(Is);Ps(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=m.useContext(sa),{pathname:c}=oi(),u=vp(),p=gp(e,xp(o),c,s==="path"),h=JSON.stringify(p);return m.useEffect(()=>{u(JSON.parse(h),{replace:r,state:t,relative:s})},[u,h,s,r,t]),null}function tn(e){br(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function K_({basename:e="/",children:r=null,location:t,navigationType:s="POP",navigator:a,static:o=!1}){br(!$o(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=e.replace(/^\/*/,"/"),u=m.useMemo(()=>({basename:c,navigator:a,static:o,future:{}}),[c,a,o]);typeof t=="string"&&(t=Io(t));let{pathname:p="/",search:h="",hash:x="",state:y=null,key:v="default"}=t,k=m.useMemo(()=>{let b=Na(p,c);return b==null?null:{location:{pathname:b,search:h,hash:x,state:y,key:v},navigationType:s}},[c,p,h,x,y,v,s]);return Ps(k!=null,`<Router basename="${c}"> is not able to match the URL "${p}${h}${x}" because it does not start with the basename, so the <Router> won't render anything.`),k==null?null:m.createElement(Is.Provider,{value:u},m.createElement(lc.Provider,{children:r,value:k}))}function X_({children:e,location:r}){return L_(zh(e),r)}function zh(e,r=[]){let t=[];return m.Children.forEach(e,(s,a)=>{if(!m.isValidElement(s))return;let o=[...r,a];if(s.type===m.Fragment){t.push.apply(t,zh(s.props.children,o));return}br(s.type===tn,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),br(!s.props.index||!s.props.children,"An index route cannot have child routes.");let c={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(c.children=zh(s.props.children,o)),t.push(c)}),t}var ru="get",nu="application/x-www-form-urlencoded";function zu(e){return e!=null&&typeof e.tagName=="string"}function J_(e){return zu(e)&&e.tagName.toLowerCase()==="button"}function Z_(e){return zu(e)&&e.tagName.toLowerCase()==="form"}function eC(e){return zu(e)&&e.tagName.toLowerCase()==="input"}function tC(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function rC(e,r){return e.button===0&&(!r||r==="_self")&&!tC(e)}var Id=null;function nC(){if(Id===null)try{new FormData(document.createElement("form"),0),Id=!1}catch{Id=!0}return Id}var sC=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ih(e){return e!=null&&!sC.has(e)?(Ps(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${nu}"`),null):e}function aC(e,r){let t,s,a,o,c;if(Z_(e)){let u=e.getAttribute("action");s=u?Na(u,r):null,t=e.getAttribute("method")||ru,a=ih(e.getAttribute("enctype"))||nu,o=new FormData(e)}else if(J_(e)||eC(e)&&(e.type==="submit"||e.type==="image")){let u=e.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=e.getAttribute("formaction")||u.getAttribute("action");if(s=p?Na(p,r):null,t=e.getAttribute("formmethod")||u.getAttribute("method")||ru,a=ih(e.getAttribute("formenctype"))||ih(u.getAttribute("enctype"))||nu,o=new FormData(u,e),!nC()){let{name:h,type:x,value:y}=e;if(x==="image"){let v=h?`${h}.`:"";o.append(`${v}x`,"0"),o.append(`${v}y`,"0")}else h&&o.append(h,y)}}else{if(zu(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=ru,s=null,a=nu,c=e}return o&&a==="text/plain"&&(c=o,o=void 0),{action:s,method:t.toLowerCase(),encType:a,formData:o,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Sp(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function iC(e,r,t){let s=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return s.pathname==="/"?s.pathname=`_root.${t}`:r&&Na(s.pathname,r)==="/"?s.pathname=`${r.replace(/\/$/,"")}/_root.${t}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${t}`,s}async function oC(e,r){if(e.id in r)return r[e.id];try{let t=await import(e.module);return r[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function lC(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function cC(e,r,t){let s=await Promise.all(e.map(async a=>{let o=r.routes[a.route.id];if(o){let c=await oC(o,t);return c.links?c.links():[]}return[]}));return hC(s.flat(1).filter(lC).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function wy(e,r,t,s,a,o){let c=(p,h)=>t[h]?p.route.id!==t[h].route.id:!0,u=(p,h)=>t[h].pathname!==p.pathname||t[h].route.path?.endsWith("*")&&t[h].params["*"]!==p.params["*"];return o==="assets"?r.filter((p,h)=>c(p,h)||u(p,h)):o==="data"?r.filter((p,h)=>{let x=s.routes[p.route.id];if(!x||!x.hasLoader)return!1;if(c(p,h)||u(p,h))return!0;if(p.route.shouldRevalidate){let y=p.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function dC(e,r,{includeHydrateFallback:t}={}){return uC(e.map(s=>{let a=r.routes[s.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function uC(e){return[...new Set(e)]}function fC(e){let r={},t=Object.keys(e).sort();for(let s of t)r[s]=e[s];return r}function hC(e,r){let t=new Set;return new Set(r),e.reduce((s,a)=>{let o=JSON.stringify(fC(a));return t.has(o)||(t.add(o),s.push({key:o,link:a})),s},[])}function A1(){let e=m.useContext(Bo);return Sp(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function pC(){let e=m.useContext(Uu);return Sp(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var bp=m.createContext(void 0);bp.displayName="FrameworkContext";function T1(){let e=m.useContext(bp);return Sp(e,"You must render this element inside a <HydratedRouter> element"),e}function mC(e,r){let t=m.useContext(bp),[s,a]=m.useState(!1),[o,c]=m.useState(!1),{onFocus:u,onBlur:p,onMouseEnter:h,onMouseLeave:x,onTouchStart:y}=r,v=m.useRef(null);m.useEffect(()=>{if(e==="render"&&c(!0),e==="viewport"){let w=O=>{O.forEach(T=>{c(T.isIntersecting)})},j=new IntersectionObserver(w,{threshold:.5});return v.current&&j.observe(v.current),()=>{j.disconnect()}}},[e]),m.useEffect(()=>{if(s){let w=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(w)}}},[s]);let k=()=>{a(!0)},b=()=>{a(!1),c(!1)};return t?e!=="intent"?[o,v,{}]:[o,v,{onFocus:Dl(u,k),onBlur:Dl(p,b),onMouseEnter:Dl(h,k),onMouseLeave:Dl(x,b),onTouchStart:Dl(y,k)}]:[!1,v,{}]}function Dl(e,r){return t=>{e&&e(t),t.defaultPrevented||r(t)}}function xC({page:e,...r}){let{router:t}=A1(),s=m.useMemo(()=>w1(t.routes,e,t.basename),[t.routes,e,t.basename]);return s?m.createElement(yC,{page:e,matches:s,...r}):null}function gC(e){let{manifest:r,routeModules:t}=T1(),[s,a]=m.useState([]);return m.useEffect(()=>{let o=!1;return cC(e,r,t).then(c=>{o||a(c)}),()=>{o=!0}},[e,r,t]),s}function yC({page:e,matches:r,...t}){let s=oi(),{manifest:a,routeModules:o}=T1(),{basename:c}=A1(),{loaderData:u,matches:p}=pC(),h=m.useMemo(()=>wy(e,r,p,a,s,"data"),[e,r,p,a,s]),x=m.useMemo(()=>wy(e,r,p,a,s,"assets"),[e,r,p,a,s]),y=m.useMemo(()=>{if(e===s.pathname+s.search+s.hash)return[];let b=new Set,w=!1;if(r.forEach(O=>{let T=a.routes[O.route.id];!T||!T.hasLoader||(!h.some(F=>F.route.id===O.route.id)&&O.route.id in u&&o[O.route.id]?.shouldRevalidate||T.hasClientLoader?w=!0:b.add(O.route.id))}),b.size===0)return[];let j=iC(e,c,"data");return w&&b.size>0&&j.searchParams.set("_routes",r.filter(O=>b.has(O.route.id)).map(O=>O.route.id).join(",")),[j.pathname+j.search]},[c,u,s,a,h,r,e,o]),v=m.useMemo(()=>dC(x,a),[x,a]),k=gC(x);return m.createElement(m.Fragment,null,y.map(b=>m.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...t})),v.map(b=>m.createElement("link",{key:b,rel:"modulepreload",href:b,...t})),k.map(({key:b,link:w})=>m.createElement("link",{key:b,nonce:t.nonce,...w})))}function vC(...e){return r=>{e.forEach(t=>{typeof t=="function"?t(r):t!=null&&(t.current=r)})}}var O1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{O1&&(window.__reactRouterVersion="7.9.5")}catch{}function wC({basename:e,children:r,window:t}){let s=m.useRef();s.current==null&&(s.current=l_({window:t,v5Compat:!0}));let a=s.current,[o,c]=m.useState({action:a.action,location:a.location}),u=m.useCallback(p=>{m.startTransition(()=>c(p))},[c]);return m.useLayoutEffect(()=>a.listen(u),[a,u]),m.createElement(K_,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:a})}var P1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,R1=m.forwardRef(function({onClick:r,discover:t="render",prefetch:s="none",relative:a,reloadDocument:o,replace:c,state:u,target:p,to:h,preventScrollReset:x,viewTransition:y,...v},k){let{basename:b}=m.useContext(Is),w=typeof h=="string"&&P1.test(h),j,O=!1;if(typeof h=="string"&&w&&(j=h,O1))try{let J=new URL(window.location.href),ne=h.startsWith("//")?new URL(J.protocol+h):new URL(h),fe=Na(ne.pathname,b);ne.origin===J.origin&&fe!=null?h=fe+ne.search+ne.hash:O=!0}catch{Ps(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=F_(h,{relative:a}),[F,I,G]=mC(s,v),B=jC(h,{replace:c,state:u,target:p,preventScrollReset:x,relative:a,viewTransition:y});function Q(J){r&&r(J),J.defaultPrevented||B(J)}let z=m.createElement("a",{...v,...G,href:j||T,onClick:O||o?r:Q,ref:vC(k,I),target:p,"data-discover":!w&&t==="render"?"true":void 0});return F&&!w?m.createElement(m.Fragment,null,z,m.createElement(xC,{page:T})):z});R1.displayName="Link";var NC=m.forwardRef(function({"aria-current":r="page",caseSensitive:t=!1,className:s="",end:a=!1,style:o,to:c,viewTransition:u,children:p,...h},x){let y=cc(c,{relative:h.relative}),v=oi(),k=m.useContext(Uu),{navigator:b,basename:w}=m.useContext(Is),j=k!=null&&AC(y)&&u===!0,O=b.encodeLocation?b.encodeLocation(y).pathname:y.pathname,T=v.pathname,F=k&&k.navigation&&k.navigation.location?k.navigation.location.pathname:null;t||(T=T.toLowerCase(),F=F?F.toLowerCase():null,O=O.toLowerCase()),F&&w&&(F=Na(F,w)||F);const I=O!=="/"&&O.endsWith("/")?O.length-1:O.length;let G=T===O||!a&&T.startsWith(O)&&T.charAt(I)==="/",B=F!=null&&(F===O||!a&&F.startsWith(O)&&F.charAt(O.length)==="/"),Q={isActive:G,isPending:B,isTransitioning:j},z=G?r:void 0,J;typeof s=="function"?J=s(Q):J=[s,G?"active":null,B?"pending":null,j?"transitioning":null].filter(Boolean).join(" ");let ne=typeof o=="function"?o(Q):o;return m.createElement(R1,{...h,"aria-current":z,className:J,ref:x,style:ne,to:c,viewTransition:u},typeof p=="function"?p(Q):p)});NC.displayName="NavLink";var SC=m.forwardRef(({discover:e="render",fetcherKey:r,navigate:t,reloadDocument:s,replace:a,state:o,method:c=ru,action:u,onSubmit:p,relative:h,preventScrollReset:x,viewTransition:y,...v},k)=>{let b=CC(),w=EC(u,{relative:h}),j=c.toLowerCase()==="get"?"get":"post",O=typeof u=="string"&&P1.test(u),T=F=>{if(p&&p(F),F.defaultPrevented)return;F.preventDefault();let I=F.nativeEvent.submitter,G=I?.getAttribute("formmethod")||c;b(I||F.currentTarget,{fetcherKey:r,method:G,navigate:t,replace:a,state:o,relative:h,preventScrollReset:x,viewTransition:y})};return m.createElement("form",{ref:k,method:j,action:w,onSubmit:s?p:T,...v,"data-discover":!O&&e==="render"?"true":void 0})});SC.displayName="Form";function bC(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function D1(e){let r=m.useContext(Bo);return br(r,bC(e)),r}function jC(e,{target:r,replace:t,state:s,preventScrollReset:a,relative:o,viewTransition:c}={}){let u=vp(),p=oi(),h=cc(e,{relative:o});return m.useCallback(x=>{if(rC(x,r)){x.preventDefault();let y=t!==void 0?t:Yl(p)===Yl(h);u(e,{replace:y,state:s,preventScrollReset:a,relative:o,viewTransition:c})}},[p,u,h,t,s,r,e,a,o,c])}var kC=0,_C=()=>`__${String(++kC)}__`;function CC(){let{router:e}=D1("useSubmit"),{basename:r}=m.useContext(Is),t=Q_();return m.useCallback(async(s,a={})=>{let{action:o,method:c,encType:u,formData:p,body:h}=aC(s,r);if(a.navigate===!1){let x=a.fetcherKey||_C();await e.fetch(x,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:p,body:h,formMethod:a.method||c,formEncType:a.encType||u,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:p,body:h,formMethod:a.method||c,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,r,t])}function EC(e,{relative:r}={}){let{basename:t}=m.useContext(Is),s=m.useContext(sa);br(s,"useFormAction must be used inside a RouteContext");let[a]=s.matches.slice(-1),o={...cc(e||".",{relative:r})},c=oi();if(e==null){o.search=c.search;let u=new URLSearchParams(o.search),p=u.getAll("index");if(p.some(x=>x==="")){u.delete("index"),p.filter(y=>y).forEach(y=>u.append("index",y));let x=u.toString();o.search=x?`?${x}`:""}}return(!e||e===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:ga([t,o.pathname])),Yl(o)}function AC(e,{relative:r}={}){let t=m.useContext(j1);br(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=D1("useViewTransitionState"),a=cc(e,{relative:r});if(!t.isTransitioning)return!1;let o=Na(t.currentLocation.pathname,s)||t.currentLocation.pathname,c=Na(t.nextLocation.pathname,s)||t.nextLocation.pathname;return uu(a.pathname,c)!=null||uu(a.pathname,o)!=null}var dc=v1();const TC=y1(dc),OC="https://gmvalve.lvpro.live/api";async function PC(e,r){const t=await fetch(`${OC}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})});if(!t.ok)throw new Error("Login failed");return t.json()}const pt="https://gmvalve.lvpro.live/api";function RC(e){const r=e.toLowerCase();return r.startsWith("planning")?"planning":r.startsWith("materialissue")?"material-issue":r.startsWith("semiqc")?"semi-qc":r.startsWith("phospatingqc")?"phosphating-qc":r.startsWith("assembly")?"assembly":r.startsWith("testing")?"testing":r.startsWith("marking")?"marking":r.startsWith("svs")?"svs":r.startsWith("pdi")?"pdi":r.startsWith("tpi")?"tpi":r.startsWith("dispatch")?"dispatch":r.startsWith("admin")?"admin":"user"}function Ny(e,r){if(typeof e=="function")return e(r);e!=null&&(e.current=r)}function aa(...e){return r=>{let t=!1;const s=e.map(a=>{const o=Ny(a,r);return!t&&typeof o=="function"&&(t=!0),o});if(t)return()=>{for(let a=0;a<s.length;a++){const o=s[a];typeof o=="function"?o():Ny(e[a],null)}}}}function Jt(...e){return m.useCallback(aa(...e),e)}var DC=Symbol.for("react.lazy"),fu=mp[" use ".trim().toString()];function FC(e){return typeof e=="object"&&e!==null&&"then"in e}function F1(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===DC&&"_payload"in e&&FC(e._payload)}function jp(e){const r=MC(e),t=m.forwardRef((s,a)=>{let{children:o,...c}=s;F1(o)&&typeof fu=="function"&&(o=fu(o._payload));const u=m.Children.toArray(o),p=u.find(IC);if(p){const h=p.props.children,x=u.map(y=>y===p?m.Children.count(h)>1?m.Children.only(null):m.isValidElement(h)?h.props.children:null:y);return n.jsx(r,{...c,ref:a,children:m.isValidElement(h)?m.cloneElement(h,void 0,x):null})}return n.jsx(r,{...c,ref:a,children:o})});return t.displayName=`${e}.Slot`,t}var M1=jp("Slot");function MC(e){const r=m.forwardRef((t,s)=>{let{children:a,...o}=t;if(F1(a)&&typeof fu=="function"&&(a=fu(a._payload)),m.isValidElement(a)){const c=$C(a),u=BC(o,a.props);return a.type!==m.Fragment&&(u.ref=s?aa(s,c):c),m.cloneElement(a,u)}return m.Children.count(a)>1?m.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var LC=Symbol("radix.slottable");function IC(e){return m.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===LC}function BC(e,r){const t={...r};for(const s in r){const a=e[s],o=r[s];/^on[A-Z]/.test(s)?a&&o?t[s]=(...u)=>{const p=o(...u);return a(...u),p}:a&&(t[s]=a):s==="style"?t[s]={...a,...o}:s==="className"&&(t[s]=[a,o].filter(Boolean).join(" "))}return{...e,...t}}function $C(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}function L1(e){var r,t,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(r=0;r<a;r++)e[r]&&(t=L1(e[r]))&&(s&&(s+=" "),s+=t)}else for(t in e)e[t]&&(s&&(s+=" "),s+=t);return s}function I1(){for(var e,r,t=0,s="",a=arguments.length;t<a;t++)(e=arguments[t])&&(r=L1(e))&&(s&&(s+=" "),s+=r);return s}const Sy=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,by=I1,B1=(e,r)=>t=>{var s;if(r?.variants==null)return by(e,t?.class,t?.className);const{variants:a,defaultVariants:o}=r,c=Object.keys(a).map(h=>{const x=t?.[h],y=o?.[h];if(x===null)return null;const v=Sy(x)||Sy(y);return a[h][v]}),u=t&&Object.entries(t).reduce((h,x)=>{let[y,v]=x;return v===void 0||(h[y]=v),h},{}),p=r==null||(s=r.compoundVariants)===null||s===void 0?void 0:s.reduce((h,x)=>{let{class:y,className:v,...k}=x;return Object.entries(k).every(b=>{let[w,j]=b;return Array.isArray(j)?j.includes({...o,...u}[w]):{...o,...u}[w]===j})?[...h,y,v]:h},[]);return by(e,c,p,t?.class,t?.className)},kp="-",UC=e=>{const r=WC(e),{conflictingClassGroups:t,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:c=>{const u=c.split(kp);return u[0]===""&&u.length!==1&&u.shift(),$1(u,r)||zC(c)},getConflictingClassGroupIds:(c,u)=>{const p=t[c]||[];return u&&s[c]?[...p,...s[c]]:p}}},$1=(e,r)=>{if(e.length===0)return r.classGroupId;const t=e[0],s=r.nextPart.get(t),a=s?$1(e.slice(1),s):void 0;if(a)return a;if(r.validators.length===0)return;const o=e.join(kp);return r.validators.find(({validator:c})=>c(o))?.classGroupId},jy=/^\[(.+)\]$/,zC=e=>{if(jy.test(e)){const r=jy.exec(e)[1],t=r?.substring(0,r.indexOf(":"));if(t)return"arbitrary.."+t}},WC=e=>{const{theme:r,classGroups:t}=e,s={nextPart:new Map,validators:[]};for(const a in t)Wh(t[a],s,a,r);return s},Wh=(e,r,t,s)=>{e.forEach(a=>{if(typeof a=="string"){const o=a===""?r:ky(r,a);o.classGroupId=t;return}if(typeof a=="function"){if(qC(a)){Wh(a(s),r,t,s);return}r.validators.push({validator:a,classGroupId:t});return}Object.entries(a).forEach(([o,c])=>{Wh(c,ky(r,o),t,s)})})},ky=(e,r)=>{let t=e;return r.split(kp).forEach(s=>{t.nextPart.has(s)||t.nextPart.set(s,{nextPart:new Map,validators:[]}),t=t.nextPart.get(s)}),t},qC=e=>e.isThemeGetter,VC=e=>{if(e<1)return{get:()=>{},set:()=>{}};let r=0,t=new Map,s=new Map;const a=(o,c)=>{t.set(o,c),r++,r>e&&(r=0,s=t,t=new Map)};return{get(o){let c=t.get(o);if(c!==void 0)return c;if((c=s.get(o))!==void 0)return a(o,c),c},set(o,c){t.has(o)?t.set(o,c):a(o,c)}}},qh="!",Vh=":",QC=Vh.length,HC=e=>{const{prefix:r,experimentalParseClassName:t}=e;let s=a=>{const o=[];let c=0,u=0,p=0,h;for(let b=0;b<a.length;b++){let w=a[b];if(c===0&&u===0){if(w===Vh){o.push(a.slice(p,b)),p=b+QC;continue}if(w==="/"){h=b;continue}}w==="["?c++:w==="]"?c--:w==="("?u++:w===")"&&u--}const x=o.length===0?a:a.substring(p),y=GC(x),v=y!==x,k=h&&h>p?h-p:void 0;return{modifiers:o,hasImportantModifier:v,baseClassName:y,maybePostfixModifierPosition:k}};if(r){const a=r+Vh,o=s;s=c=>c.startsWith(a)?o(c.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:c,maybePostfixModifierPosition:void 0}}if(t){const a=s;s=o=>t({className:o,parseClassName:a})}return s},GC=e=>e.endsWith(qh)?e.substring(0,e.length-1):e.startsWith(qh)?e.substring(1):e,YC=e=>{const r=Object.fromEntries(e.orderSensitiveModifiers.map(s=>[s,!0]));return s=>{if(s.length<=1)return s;const a=[];let o=[];return s.forEach(c=>{c[0]==="["||r[c]?(a.push(...o.sort(),c),o=[]):o.push(c)}),a.push(...o.sort()),a}},KC=e=>({cache:VC(e.cacheSize),parseClassName:HC(e),sortModifiers:YC(e),...UC(e)}),XC=/\s+/,JC=(e,r)=>{const{parseClassName:t,getClassGroupId:s,getConflictingClassGroupIds:a,sortModifiers:o}=r,c=[],u=e.trim().split(XC);let p="";for(let h=u.length-1;h>=0;h-=1){const x=u[h],{isExternal:y,modifiers:v,hasImportantModifier:k,baseClassName:b,maybePostfixModifierPosition:w}=t(x);if(y){p=x+(p.length>0?" "+p:p);continue}let j=!!w,O=s(j?b.substring(0,w):b);if(!O){if(!j){p=x+(p.length>0?" "+p:p);continue}if(O=s(b),!O){p=x+(p.length>0?" "+p:p);continue}j=!1}const T=o(v).join(":"),F=k?T+qh:T,I=F+O;if(c.includes(I))continue;c.push(I);const G=a(O,j);for(let B=0;B<G.length;++B){const Q=G[B];c.push(F+Q)}p=x+(p.length>0?" "+p:p)}return p};function ZC(){let e=0,r,t,s="";for(;e<arguments.length;)(r=arguments[e++])&&(t=U1(r))&&(s&&(s+=" "),s+=t);return s}const U1=e=>{if(typeof e=="string")return e;let r,t="";for(let s=0;s<e.length;s++)e[s]&&(r=U1(e[s]))&&(t&&(t+=" "),t+=r);return t};function eE(e,...r){let t,s,a,o=c;function c(p){const h=r.reduce((x,y)=>y(x),e());return t=KC(h),s=t.cache.get,a=t.cache.set,o=u,u(p)}function u(p){const h=s(p);if(h)return h;const x=JC(p,t);return a(p,x),x}return function(){return o(ZC.apply(null,arguments))}}const zr=e=>{const r=t=>t[e]||[];return r.isThemeGetter=!0,r},z1=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,W1=/^\((?:(\w[\w-]*):)?(.+)\)$/i,tE=/^\d+\/\d+$/,rE=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,nE=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,sE=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,aE=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,iE=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,go=e=>tE.test(e),Ot=e=>!!e&&!Number.isNaN(Number(e)),Ga=e=>!!e&&Number.isInteger(Number(e)),oh=e=>e.endsWith("%")&&Ot(e.slice(0,-1)),ma=e=>rE.test(e),oE=()=>!0,lE=e=>nE.test(e)&&!sE.test(e),q1=()=>!1,cE=e=>aE.test(e),dE=e=>iE.test(e),uE=e=>!ot(e)&&!lt(e),fE=e=>Uo(e,H1,q1),ot=e=>z1.test(e),ki=e=>Uo(e,G1,lE),lh=e=>Uo(e,gE,Ot),_y=e=>Uo(e,V1,q1),hE=e=>Uo(e,Q1,dE),Bd=e=>Uo(e,Y1,cE),lt=e=>W1.test(e),Fl=e=>zo(e,G1),pE=e=>zo(e,yE),Cy=e=>zo(e,V1),mE=e=>zo(e,H1),xE=e=>zo(e,Q1),$d=e=>zo(e,Y1,!0),Uo=(e,r,t)=>{const s=z1.exec(e);return s?s[1]?r(s[1]):t(s[2]):!1},zo=(e,r,t=!1)=>{const s=W1.exec(e);return s?s[1]?r(s[1]):t:!1},V1=e=>e==="position"||e==="percentage",Q1=e=>e==="image"||e==="url",H1=e=>e==="length"||e==="size"||e==="bg-size",G1=e=>e==="length",gE=e=>e==="number",yE=e=>e==="family-name",Y1=e=>e==="shadow",vE=()=>{const e=zr("color"),r=zr("font"),t=zr("text"),s=zr("font-weight"),a=zr("tracking"),o=zr("leading"),c=zr("breakpoint"),u=zr("container"),p=zr("spacing"),h=zr("radius"),x=zr("shadow"),y=zr("inset-shadow"),v=zr("text-shadow"),k=zr("drop-shadow"),b=zr("blur"),w=zr("perspective"),j=zr("aspect"),O=zr("ease"),T=zr("animate"),F=()=>["auto","avoid","all","avoid-page","page","left","right","column"],I=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],G=()=>[...I(),lt,ot],B=()=>["auto","hidden","clip","visible","scroll"],Q=()=>["auto","contain","none"],z=()=>[lt,ot,p],J=()=>[go,"full","auto",...z()],ne=()=>[Ga,"none","subgrid",lt,ot],fe=()=>["auto",{span:["full",Ga,lt,ot]},Ga,lt,ot],me=()=>[Ga,"auto",lt,ot],le=()=>["auto","min","max","fr",lt,ot],K=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Fe=()=>["start","end","center","stretch","center-safe","end-safe"],we=()=>["auto",...z()],oe=()=>[go,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...z()],V=()=>[e,lt,ot],de=()=>[...I(),Cy,_y,{position:[lt,ot]}],Ne=()=>["no-repeat",{repeat:["","x","y","space","round"]}],ee=()=>["auto","cover","contain",mE,fE,{size:[lt,ot]}],U=()=>[oh,Fl,ki],re=()=>["","none","full",h,lt,ot],Y=()=>["",Ot,Fl,ki],Z=()=>["solid","dashed","dotted","double"],xe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ie=()=>[Ot,oh,Cy,_y],Te=()=>["","none",b,lt,ot],ve=()=>["none",Ot,lt,ot],Ee=()=>["none",Ot,lt,ot],Me=()=>[Ot,lt,ot],D=()=>[go,"full",...z()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[ma],breakpoint:[ma],color:[oE],container:[ma],"drop-shadow":[ma],ease:["in","out","in-out"],font:[uE],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[ma],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[ma],shadow:[ma],spacing:["px",Ot],text:[ma],"text-shadow":[ma],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",go,ot,lt,j]}],container:["container"],columns:[{columns:[Ot,ot,lt,u]}],"break-after":[{"break-after":F()}],"break-before":[{"break-before":F()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:G()}],overflow:[{overflow:B()}],"overflow-x":[{"overflow-x":B()}],"overflow-y":[{"overflow-y":B()}],overscroll:[{overscroll:Q()}],"overscroll-x":[{"overscroll-x":Q()}],"overscroll-y":[{"overscroll-y":Q()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:J()}],"inset-x":[{"inset-x":J()}],"inset-y":[{"inset-y":J()}],start:[{start:J()}],end:[{end:J()}],top:[{top:J()}],right:[{right:J()}],bottom:[{bottom:J()}],left:[{left:J()}],visibility:["visible","invisible","collapse"],z:[{z:[Ga,"auto",lt,ot]}],basis:[{basis:[go,"full","auto",u,...z()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ot,go,"auto","initial","none",ot]}],grow:[{grow:["",Ot,lt,ot]}],shrink:[{shrink:["",Ot,lt,ot]}],order:[{order:[Ga,"first","last","none",lt,ot]}],"grid-cols":[{"grid-cols":ne()}],"col-start-end":[{col:fe()}],"col-start":[{"col-start":me()}],"col-end":[{"col-end":me()}],"grid-rows":[{"grid-rows":ne()}],"row-start-end":[{row:fe()}],"row-start":[{"row-start":me()}],"row-end":[{"row-end":me()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":le()}],"auto-rows":[{"auto-rows":le()}],gap:[{gap:z()}],"gap-x":[{"gap-x":z()}],"gap-y":[{"gap-y":z()}],"justify-content":[{justify:[...K(),"normal"]}],"justify-items":[{"justify-items":[...Fe(),"normal"]}],"justify-self":[{"justify-self":["auto",...Fe()]}],"align-content":[{content:["normal",...K()]}],"align-items":[{items:[...Fe(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Fe(),{baseline:["","last"]}]}],"place-content":[{"place-content":K()}],"place-items":[{"place-items":[...Fe(),"baseline"]}],"place-self":[{"place-self":["auto",...Fe()]}],p:[{p:z()}],px:[{px:z()}],py:[{py:z()}],ps:[{ps:z()}],pe:[{pe:z()}],pt:[{pt:z()}],pr:[{pr:z()}],pb:[{pb:z()}],pl:[{pl:z()}],m:[{m:we()}],mx:[{mx:we()}],my:[{my:we()}],ms:[{ms:we()}],me:[{me:we()}],mt:[{mt:we()}],mr:[{mr:we()}],mb:[{mb:we()}],ml:[{ml:we()}],"space-x":[{"space-x":z()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":z()}],"space-y-reverse":["space-y-reverse"],size:[{size:oe()}],w:[{w:[u,"screen",...oe()]}],"min-w":[{"min-w":[u,"screen","none",...oe()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[c]},...oe()]}],h:[{h:["screen","lh",...oe()]}],"min-h":[{"min-h":["screen","lh","none",...oe()]}],"max-h":[{"max-h":["screen","lh",...oe()]}],"font-size":[{text:["base",t,Fl,ki]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,lt,lh]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",oh,ot]}],"font-family":[{font:[pE,ot,r]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,lt,ot]}],"line-clamp":[{"line-clamp":[Ot,"none",lt,lh]}],leading:[{leading:[o,...z()]}],"list-image":[{"list-image":["none",lt,ot]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",lt,ot]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:V()}],"text-color":[{text:V()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Z(),"wavy"]}],"text-decoration-thickness":[{decoration:[Ot,"from-font","auto",lt,ki]}],"text-decoration-color":[{decoration:V()}],"underline-offset":[{"underline-offset":[Ot,"auto",lt,ot]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:z()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",lt,ot]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",lt,ot]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:de()}],"bg-repeat":[{bg:Ne()}],"bg-size":[{bg:ee()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ga,lt,ot],radial:["",lt,ot],conic:[Ga,lt,ot]},xE,hE]}],"bg-color":[{bg:V()}],"gradient-from-pos":[{from:U()}],"gradient-via-pos":[{via:U()}],"gradient-to-pos":[{to:U()}],"gradient-from":[{from:V()}],"gradient-via":[{via:V()}],"gradient-to":[{to:V()}],rounded:[{rounded:re()}],"rounded-s":[{"rounded-s":re()}],"rounded-e":[{"rounded-e":re()}],"rounded-t":[{"rounded-t":re()}],"rounded-r":[{"rounded-r":re()}],"rounded-b":[{"rounded-b":re()}],"rounded-l":[{"rounded-l":re()}],"rounded-ss":[{"rounded-ss":re()}],"rounded-se":[{"rounded-se":re()}],"rounded-ee":[{"rounded-ee":re()}],"rounded-es":[{"rounded-es":re()}],"rounded-tl":[{"rounded-tl":re()}],"rounded-tr":[{"rounded-tr":re()}],"rounded-br":[{"rounded-br":re()}],"rounded-bl":[{"rounded-bl":re()}],"border-w":[{border:Y()}],"border-w-x":[{"border-x":Y()}],"border-w-y":[{"border-y":Y()}],"border-w-s":[{"border-s":Y()}],"border-w-e":[{"border-e":Y()}],"border-w-t":[{"border-t":Y()}],"border-w-r":[{"border-r":Y()}],"border-w-b":[{"border-b":Y()}],"border-w-l":[{"border-l":Y()}],"divide-x":[{"divide-x":Y()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Y()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Z(),"hidden","none"]}],"divide-style":[{divide:[...Z(),"hidden","none"]}],"border-color":[{border:V()}],"border-color-x":[{"border-x":V()}],"border-color-y":[{"border-y":V()}],"border-color-s":[{"border-s":V()}],"border-color-e":[{"border-e":V()}],"border-color-t":[{"border-t":V()}],"border-color-r":[{"border-r":V()}],"border-color-b":[{"border-b":V()}],"border-color-l":[{"border-l":V()}],"divide-color":[{divide:V()}],"outline-style":[{outline:[...Z(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Ot,lt,ot]}],"outline-w":[{outline:["",Ot,Fl,ki]}],"outline-color":[{outline:V()}],shadow:[{shadow:["","none",x,$d,Bd]}],"shadow-color":[{shadow:V()}],"inset-shadow":[{"inset-shadow":["none",y,$d,Bd]}],"inset-shadow-color":[{"inset-shadow":V()}],"ring-w":[{ring:Y()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:V()}],"ring-offset-w":[{"ring-offset":[Ot,ki]}],"ring-offset-color":[{"ring-offset":V()}],"inset-ring-w":[{"inset-ring":Y()}],"inset-ring-color":[{"inset-ring":V()}],"text-shadow":[{"text-shadow":["none",v,$d,Bd]}],"text-shadow-color":[{"text-shadow":V()}],opacity:[{opacity:[Ot,lt,ot]}],"mix-blend":[{"mix-blend":[...xe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":xe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ot]}],"mask-image-linear-from-pos":[{"mask-linear-from":ie()}],"mask-image-linear-to-pos":[{"mask-linear-to":ie()}],"mask-image-linear-from-color":[{"mask-linear-from":V()}],"mask-image-linear-to-color":[{"mask-linear-to":V()}],"mask-image-t-from-pos":[{"mask-t-from":ie()}],"mask-image-t-to-pos":[{"mask-t-to":ie()}],"mask-image-t-from-color":[{"mask-t-from":V()}],"mask-image-t-to-color":[{"mask-t-to":V()}],"mask-image-r-from-pos":[{"mask-r-from":ie()}],"mask-image-r-to-pos":[{"mask-r-to":ie()}],"mask-image-r-from-color":[{"mask-r-from":V()}],"mask-image-r-to-color":[{"mask-r-to":V()}],"mask-image-b-from-pos":[{"mask-b-from":ie()}],"mask-image-b-to-pos":[{"mask-b-to":ie()}],"mask-image-b-from-color":[{"mask-b-from":V()}],"mask-image-b-to-color":[{"mask-b-to":V()}],"mask-image-l-from-pos":[{"mask-l-from":ie()}],"mask-image-l-to-pos":[{"mask-l-to":ie()}],"mask-image-l-from-color":[{"mask-l-from":V()}],"mask-image-l-to-color":[{"mask-l-to":V()}],"mask-image-x-from-pos":[{"mask-x-from":ie()}],"mask-image-x-to-pos":[{"mask-x-to":ie()}],"mask-image-x-from-color":[{"mask-x-from":V()}],"mask-image-x-to-color":[{"mask-x-to":V()}],"mask-image-y-from-pos":[{"mask-y-from":ie()}],"mask-image-y-to-pos":[{"mask-y-to":ie()}],"mask-image-y-from-color":[{"mask-y-from":V()}],"mask-image-y-to-color":[{"mask-y-to":V()}],"mask-image-radial":[{"mask-radial":[lt,ot]}],"mask-image-radial-from-pos":[{"mask-radial-from":ie()}],"mask-image-radial-to-pos":[{"mask-radial-to":ie()}],"mask-image-radial-from-color":[{"mask-radial-from":V()}],"mask-image-radial-to-color":[{"mask-radial-to":V()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":I()}],"mask-image-conic-pos":[{"mask-conic":[Ot]}],"mask-image-conic-from-pos":[{"mask-conic-from":ie()}],"mask-image-conic-to-pos":[{"mask-conic-to":ie()}],"mask-image-conic-from-color":[{"mask-conic-from":V()}],"mask-image-conic-to-color":[{"mask-conic-to":V()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:de()}],"mask-repeat":[{mask:Ne()}],"mask-size":[{mask:ee()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",lt,ot]}],filter:[{filter:["","none",lt,ot]}],blur:[{blur:Te()}],brightness:[{brightness:[Ot,lt,ot]}],contrast:[{contrast:[Ot,lt,ot]}],"drop-shadow":[{"drop-shadow":["","none",k,$d,Bd]}],"drop-shadow-color":[{"drop-shadow":V()}],grayscale:[{grayscale:["",Ot,lt,ot]}],"hue-rotate":[{"hue-rotate":[Ot,lt,ot]}],invert:[{invert:["",Ot,lt,ot]}],saturate:[{saturate:[Ot,lt,ot]}],sepia:[{sepia:["",Ot,lt,ot]}],"backdrop-filter":[{"backdrop-filter":["","none",lt,ot]}],"backdrop-blur":[{"backdrop-blur":Te()}],"backdrop-brightness":[{"backdrop-brightness":[Ot,lt,ot]}],"backdrop-contrast":[{"backdrop-contrast":[Ot,lt,ot]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ot,lt,ot]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ot,lt,ot]}],"backdrop-invert":[{"backdrop-invert":["",Ot,lt,ot]}],"backdrop-opacity":[{"backdrop-opacity":[Ot,lt,ot]}],"backdrop-saturate":[{"backdrop-saturate":[Ot,lt,ot]}],"backdrop-sepia":[{"backdrop-sepia":["",Ot,lt,ot]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":z()}],"border-spacing-x":[{"border-spacing-x":z()}],"border-spacing-y":[{"border-spacing-y":z()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",lt,ot]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ot,"initial",lt,ot]}],ease:[{ease:["linear","initial",O,lt,ot]}],delay:[{delay:[Ot,lt,ot]}],animate:[{animate:["none",T,lt,ot]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[w,lt,ot]}],"perspective-origin":[{"perspective-origin":G()}],rotate:[{rotate:ve()}],"rotate-x":[{"rotate-x":ve()}],"rotate-y":[{"rotate-y":ve()}],"rotate-z":[{"rotate-z":ve()}],scale:[{scale:Ee()}],"scale-x":[{"scale-x":Ee()}],"scale-y":[{"scale-y":Ee()}],"scale-z":[{"scale-z":Ee()}],"scale-3d":["scale-3d"],skew:[{skew:Me()}],"skew-x":[{"skew-x":Me()}],"skew-y":[{"skew-y":Me()}],transform:[{transform:[lt,ot,"","none","gpu","cpu"]}],"transform-origin":[{origin:G()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:D()}],"translate-x":[{"translate-x":D()}],"translate-y":[{"translate-y":D()}],"translate-z":[{"translate-z":D()}],"translate-none":["translate-none"],accent:[{accent:V()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:V()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",lt,ot]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":z()}],"scroll-mx":[{"scroll-mx":z()}],"scroll-my":[{"scroll-my":z()}],"scroll-ms":[{"scroll-ms":z()}],"scroll-me":[{"scroll-me":z()}],"scroll-mt":[{"scroll-mt":z()}],"scroll-mr":[{"scroll-mr":z()}],"scroll-mb":[{"scroll-mb":z()}],"scroll-ml":[{"scroll-ml":z()}],"scroll-p":[{"scroll-p":z()}],"scroll-px":[{"scroll-px":z()}],"scroll-py":[{"scroll-py":z()}],"scroll-ps":[{"scroll-ps":z()}],"scroll-pe":[{"scroll-pe":z()}],"scroll-pt":[{"scroll-pt":z()}],"scroll-pr":[{"scroll-pr":z()}],"scroll-pb":[{"scroll-pb":z()}],"scroll-pl":[{"scroll-pl":z()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",lt,ot]}],fill:[{fill:["none",...V()]}],"stroke-w":[{stroke:[Ot,Fl,ki,lh]}],stroke:[{stroke:["none",...V()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},wE=eE(vE);function sr(...e){return wE(I1(e))}const Qh=B1("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all duration-200 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive relative overflow-hidden active:scale-95",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm hover:shadow-md",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60 shadow-sm hover:shadow-md",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 hover:border-accent-foreground/20",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm hover:shadow-md",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),ce=m.forwardRef(({className:e,variant:r,size:t,asChild:s=!1,...a},o)=>{const c=s?M1:"button";return n.jsx(c,{"data-slot":"button",className:sr(Qh({variant:r,size:t,className:e})),ref:o,...a})});ce.displayName="Button";function or({className:e,type:r,...t}){return n.jsx("input",{type:r,"data-slot":"input",className:sr("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-all duration-200 outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:shadow-sm","hover:border-ring/50","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...t})}function NE(e,r){const t=m.createContext(r),s=o=>{const{children:c,...u}=o,p=m.useMemo(()=>u,Object.values(u));return n.jsx(t.Provider,{value:p,children:c})};s.displayName=e+"Provider";function a(o){const c=m.useContext(t);if(c)return c;if(r!==void 0)return r;throw new Error(`\`${o}\` must be used within \`${e}\``)}return[s,a]}function _a(e,r=[]){let t=[];function s(o,c){const u=m.createContext(c),p=t.length;t=[...t,c];const h=y=>{const{scope:v,children:k,...b}=y,w=v?.[e]?.[p]||u,j=m.useMemo(()=>b,Object.values(b));return n.jsx(w.Provider,{value:j,children:k})};h.displayName=o+"Provider";function x(y,v){const k=v?.[e]?.[p]||u,b=m.useContext(k);if(b)return b;if(c!==void 0)return c;throw new Error(`\`${y}\` must be used within \`${o}\``)}return[h,x]}const a=()=>{const o=t.map(c=>m.createContext(c));return function(u){const p=u?.[e]||o;return m.useMemo(()=>({[`__scope${e}`]:{...u,[e]:p}}),[u,p])}};return a.scopeName=e,[s,SE(a,...r)]}function SE(...e){const r=e[0];if(e.length===1)return r;const t=()=>{const s=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const c=s.reduce((u,{useScope:p,scopeName:h})=>{const y=p(o)[`__scope${h}`];return{...u,...y}},{});return m.useMemo(()=>({[`__scope${r.scopeName}`]:c}),[c])}};return t.scopeName=r.scopeName,t}function ct(e,r,{checkForDefaultPrevented:t=!0}={}){return function(a){if(e?.(a),t===!1||!a.defaultPrevented)return r?.(a)}}var Vr=globalThis?.document?m.useLayoutEffect:()=>{},bE=mp[" useInsertionEffect ".trim().toString()]||Vr;function Oi({prop:e,defaultProp:r,onChange:t=()=>{},caller:s}){const[a,o,c]=jE({defaultProp:r,onChange:t}),u=e!==void 0,p=u?e:a;{const x=m.useRef(e!==void 0);m.useEffect(()=>{const y=x.current;y!==u&&console.warn(`${s} is changing from ${y?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),x.current=u},[u,s])}const h=m.useCallback(x=>{if(u){const y=kE(x)?x(e):x;y!==e&&c.current?.(y)}else o(x)},[u,e,o,c]);return[p,h]}function jE({defaultProp:e,onChange:r}){const[t,s]=m.useState(e),a=m.useRef(t),o=m.useRef(r);return bE(()=>{o.current=r},[r]),m.useEffect(()=>{a.current!==t&&(o.current?.(t),a.current=t)},[t,a]),[t,s,o]}function kE(e){return typeof e=="function"}function K1(e){const r=m.useRef({value:e,previous:e});return m.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}function X1(e){const[r,t]=m.useState(void 0);return Vr(()=>{if(e){t({width:e.offsetWidth,height:e.offsetHeight});const s=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let c,u;if("borderBoxSize"in o){const p=o.borderBoxSize,h=Array.isArray(p)?p[0]:p;c=h.inlineSize,u=h.blockSize}else c=e.offsetWidth,u=e.offsetHeight;t({width:c,height:u})});return s.observe(e,{box:"border-box"}),()=>s.unobserve(e)}else t(void 0)},[e]),r}function _E(e,r){return m.useReducer((t,s)=>r[t][s]??t,e)}var Bs=e=>{const{present:r,children:t}=e,s=CE(r),a=typeof t=="function"?t({present:s.isPresent}):m.Children.only(t),o=Jt(s.ref,EE(a));return typeof t=="function"||s.isPresent?m.cloneElement(a,{ref:o}):null};Bs.displayName="Presence";function CE(e){const[r,t]=m.useState(),s=m.useRef(null),a=m.useRef(e),o=m.useRef("none"),c=e?"mounted":"unmounted",[u,p]=_E(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const h=Ud(s.current);o.current=u==="mounted"?h:"none"},[u]),Vr(()=>{const h=s.current,x=a.current;if(x!==e){const v=o.current,k=Ud(h);e?p("MOUNT"):k==="none"||h?.display==="none"?p("UNMOUNT"):p(x&&v!==k?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,p]),Vr(()=>{if(r){let h;const x=r.ownerDocument.defaultView??window,y=k=>{const w=Ud(s.current).includes(CSS.escape(k.animationName));if(k.target===r&&w&&(p("ANIMATION_END"),!a.current)){const j=r.style.animationFillMode;r.style.animationFillMode="forwards",h=x.setTimeout(()=>{r.style.animationFillMode==="forwards"&&(r.style.animationFillMode=j)})}},v=k=>{k.target===r&&(o.current=Ud(s.current))};return r.addEventListener("animationstart",v),r.addEventListener("animationcancel",y),r.addEventListener("animationend",y),()=>{x.clearTimeout(h),r.removeEventListener("animationstart",v),r.removeEventListener("animationcancel",y),r.removeEventListener("animationend",y)}}else p("ANIMATION_END")},[r,p]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:m.useCallback(h=>{s.current=h?getComputedStyle(h):null,t(h)},[])}}function Ud(e){return e?.animationName||"none"}function EE(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}function AE(e){const r=TE(e),t=m.forwardRef((s,a)=>{const{children:o,...c}=s,u=m.Children.toArray(o),p=u.find(PE);if(p){const h=p.props.children,x=u.map(y=>y===p?m.Children.count(h)>1?m.Children.only(null):m.isValidElement(h)?h.props.children:null:y);return n.jsx(r,{...c,ref:a,children:m.isValidElement(h)?m.cloneElement(h,void 0,x):null})}return n.jsx(r,{...c,ref:a,children:o})});return t.displayName=`${e}.Slot`,t}function TE(e){const r=m.forwardRef((t,s)=>{const{children:a,...o}=t;if(m.isValidElement(a)){const c=DE(a),u=RE(o,a.props);return a.type!==m.Fragment&&(u.ref=s?aa(s,c):c),m.cloneElement(a,u)}return m.Children.count(a)>1?m.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var OE=Symbol("radix.slottable");function PE(e){return m.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===OE}function RE(e,r){const t={...r};for(const s in r){const a=e[s],o=r[s];/^on[A-Z]/.test(s)?a&&o?t[s]=(...u)=>{const p=o(...u);return a(...u),p}:a&&(t[s]=a):s==="style"?t[s]={...a,...o}:s==="className"&&(t[s]=[a,o].filter(Boolean).join(" "))}return{...e,...t}}function DE(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}var FE=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Pt=FE.reduce((e,r)=>{const t=AE(`Primitive.${r}`),s=m.forwardRef((a,o)=>{const{asChild:c,...u}=a,p=c?t:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),n.jsx(p,{...u,ref:o})});return s.displayName=`Primitive.${r}`,{...e,[r]:s}},{});function J1(e,r){e&&dc.flushSync(()=>e.dispatchEvent(r))}var Wu="Checkbox",[ME]=_a(Wu),[LE,_p]=ME(Wu);function IE(e){const{__scopeCheckbox:r,checked:t,children:s,defaultChecked:a,disabled:o,form:c,name:u,onCheckedChange:p,required:h,value:x="on",internal_do_not_use_render:y}=e,[v,k]=Oi({prop:t,defaultProp:a??!1,onChange:p,caller:Wu}),[b,w]=m.useState(null),[j,O]=m.useState(null),T=m.useRef(!1),F=b?!!c||!!b.closest("form"):!0,I={checked:v,disabled:o,setChecked:k,control:b,setControl:w,name:u,form:c,value:x,hasConsumerStoppedPropagationRef:T,required:h,defaultChecked:ti(a)?!1:a,isFormControl:F,bubbleInput:j,setBubbleInput:O};return n.jsx(LE,{scope:r,...I,children:BE(y)?y(I):s})}var Z1="CheckboxTrigger",ew=m.forwardRef(({__scopeCheckbox:e,onKeyDown:r,onClick:t,...s},a)=>{const{control:o,value:c,disabled:u,checked:p,required:h,setControl:x,setChecked:y,hasConsumerStoppedPropagationRef:v,isFormControl:k,bubbleInput:b}=_p(Z1,e),w=Jt(a,x),j=m.useRef(p);return m.useEffect(()=>{const O=o?.form;if(O){const T=()=>y(j.current);return O.addEventListener("reset",T),()=>O.removeEventListener("reset",T)}},[o,y]),n.jsx(Pt.button,{type:"button",role:"checkbox","aria-checked":ti(p)?"mixed":p,"aria-required":h,"data-state":iw(p),"data-disabled":u?"":void 0,disabled:u,value:c,...s,ref:w,onKeyDown:ct(r,O=>{O.key==="Enter"&&O.preventDefault()}),onClick:ct(t,O=>{y(T=>ti(T)?!0:!T),b&&k&&(v.current=O.isPropagationStopped(),v.current||O.stopPropagation())})})});ew.displayName=Z1;var tw=m.forwardRef((e,r)=>{const{__scopeCheckbox:t,name:s,checked:a,defaultChecked:o,required:c,disabled:u,value:p,onCheckedChange:h,form:x,...y}=e;return n.jsx(IE,{__scopeCheckbox:t,checked:a,defaultChecked:o,disabled:u,required:c,onCheckedChange:h,name:s,form:x,value:p,internal_do_not_use_render:({isFormControl:v})=>n.jsxs(n.Fragment,{children:[n.jsx(ew,{...y,ref:r,__scopeCheckbox:t}),v&&n.jsx(aw,{__scopeCheckbox:t})]})})});tw.displayName=Wu;var rw="CheckboxIndicator",nw=m.forwardRef((e,r)=>{const{__scopeCheckbox:t,forceMount:s,...a}=e,o=_p(rw,t);return n.jsx(Bs,{present:s||ti(o.checked)||o.checked===!0,children:n.jsx(Pt.span,{"data-state":iw(o.checked),"data-disabled":o.disabled?"":void 0,...a,ref:r,style:{pointerEvents:"none",...e.style}})})});nw.displayName=rw;var sw="CheckboxBubbleInput",aw=m.forwardRef(({__scopeCheckbox:e,...r},t)=>{const{control:s,hasConsumerStoppedPropagationRef:a,checked:o,defaultChecked:c,required:u,disabled:p,name:h,value:x,form:y,bubbleInput:v,setBubbleInput:k}=_p(sw,e),b=Jt(t,k),w=K1(o),j=X1(s);m.useEffect(()=>{const T=v;if(!T)return;const F=window.HTMLInputElement.prototype,G=Object.getOwnPropertyDescriptor(F,"checked").set,B=!a.current;if(w!==o&&G){const Q=new Event("click",{bubbles:B});T.indeterminate=ti(o),G.call(T,ti(o)?!1:o),T.dispatchEvent(Q)}},[v,w,o,a]);const O=m.useRef(ti(o)?!1:o);return n.jsx(Pt.input,{type:"checkbox","aria-hidden":!0,defaultChecked:c??O.current,required:u,disabled:p,name:h,value:x,form:y,...r,tabIndex:-1,ref:b,style:{...r.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});aw.displayName=sw;function BE(e){return typeof e=="function"}function ti(e){return e==="indeterminate"}function iw(e){return ti(e)?"indeterminate":e?"checked":"unchecked"}/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),UE=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,t,s)=>s?s.toUpperCase():t.toLowerCase()),Ey=e=>{const r=UE(e);return r.charAt(0).toUpperCase()+r.slice(1)},ow=(...e)=>e.filter((r,t,s)=>!!r&&r.trim()!==""&&s.indexOf(r)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=m.forwardRef(({color:e="currentColor",size:r=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:a="",children:o,iconNode:c,...u},p)=>m.createElement("svg",{ref:p,...zE,width:r,height:r,stroke:e,strokeWidth:s?Number(t)*24/Number(r):t,className:ow("lucide",a),...u},[...c.map(([h,x])=>m.createElement(h,x)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=(e,r)=>{const t=m.forwardRef(({className:s,...a},o)=>m.createElement(WE,{ref:o,iconNode:r,className:ow(`lucide-${$E(Ey(e))}`,`lucide-${e}`,s),...a}));return t.displayName=Ey(e),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Wn=_r("arrow-right",qE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],QE=_r("bell",VE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ay=_r("calendar",HE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],lw=_r("check",GE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Cp=_r("chevron-down",YE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KE=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],XE=_r("chevron-left",KE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JE=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ZE=_r("chevron-right",JE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],cw=_r("chevron-up",e4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],r4=_r("circle-check-big",t4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],s4=_r("circle-x",n4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],i4=_r("eye-off",a4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],_n=_r("eye",o4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],c4=_r("file-spreadsheet",l4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],u4=_r("file-text",d4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f4=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],h4=_r("log-out",f4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],qn=_r("message-square-plus",p4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],x4=_r("plus",m4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g4=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],ur=_r("printer",g4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y4=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Vn=_r("search",y4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v4=[["path",{d:"M7 18v-6a5 5 0 1 1 10 0v6",key:"pcx96s"}],["path",{d:"M5 21a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-1a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2z",key:"1b4s83"}],["path",{d:"M21 12h1",key:"jtio3y"}],["path",{d:"M18.5 4.5 18 5",key:"g5sp9y"}],["path",{d:"M2 12h1",key:"1uaihz"}],["path",{d:"M12 2v1",key:"11qlp1"}],["path",{d:"m4.929 4.929.707.707",key:"1i51kw"}],["path",{d:"M12 12v6",key:"3ahymv"}]],fr=_r("siren",v4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w4=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],N4=_r("sliders-horizontal",w4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S4=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],b4=_r("triangle-alert",S4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j4=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],k4=_r("upload",j4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _4=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],hu=_r("x",_4);function Cn({className:e,...r}){return n.jsx(tw,{"data-slot":"checkbox",className:sr("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...r,children:n.jsx(nw,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:n.jsx(lw,{className:"size-3.5"})})})}const dw="/assets/gm-logo-CDaWe3Uk.png",C4=({onLogin:e})=>{const[r,t]=m.useState(!1),[s,a]=m.useState(!1),[o,c]=m.useState(""),[u,p]=m.useState(""),[h,x]=m.useState(!1),[y,v]=m.useState(""),k=vp(),b=async j=>{j.preventDefault(),x(!0),v("");try{const O=await PC(o,u);if(O&&O.status&&O.data){const{user:T,token:F}=O.data;localStorage.setItem("user",JSON.stringify(T)),localStorage.setItem("token",F);const I=T&&(T.role?.name||T.role)||"",G=w(String(I),o);e&&e(),k(`/${G}`)}else v(O?.message||"Login failed")}catch(O){v(O?.message||"Login failed. Check your credentials or server.")}finally{x(!1)}};function w(j,O){const T=(j||"").toLowerCase().replace(/\s+/g,"-"),F=RC(O),I=[T,F];for(const G of I)if(G){if(G==="admin"||G==="planning"||G.startsWith("planning"))return"planning";if(G==="material-issue"||G.startsWith("materialissue"))return"material-issue";if(G==="semi-qc"||G.startsWith("semiqc"))return"semi-qc";if(G==="phosphating"||G==="phosphating-qc"||G.startsWith("phosp"))return"phosphating";if(G==="assembly"||G.startsWith("assembly"))return"assembly";if(G==="svs"||G.startsWith("svs"))return"svs";if(G==="tpi"||G.startsWith("tpi"))return"tpi";if(G==="dispatch"||G.startsWith("dispatch"))return"dispatch";if(G==="testing"||G==="testing1"||G.startsWith("testing1"))return"testing1";if(G==="testing2"||G.startsWith("testing2"))return"testing2";if(G==="marking"||G==="marking1"||G.startsWith("marking1"))return"marking1";if(G==="marking2"||G.startsWith("marking2"))return"marking2";if(G==="pdi"||G==="pdi1"||G.startsWith("pdi1"))return"pdi1";if(G==="pdi2"||G.startsWith("pdi2"))return"pdi2"}return"planning"}return n.jsxs("form",{onSubmit:b,className:"space-y-6 animate-fade-in",children:[n.jsx("div",{className:"mb-2 animate-fade-in",children:n.jsx("img",{src:dw,alt:"GM Logo",className:"h-16 w-auto object-contain hover:scale-110 transition-transform duration-300"})}),n.jsxs("div",{className:"space-y-2 animate-fade-in-up",style:{animationDelay:"0.1s"},children:[n.jsx("h1",{className:"text-gray-900 font-semibold text-xl",children:"Welcome Back"}),n.jsx("p",{className:"text-gray-600",children:"Log in to continue to your workspace."})]}),y&&n.jsx("p",{className:"text-red-500 bg-red-50 border border-red-200 rounded-lg py-2 text-center animate-fade-in-up",children:y}),n.jsxs("div",{className:"space-y-2 animate-fade-in-up",style:{animationDelay:"0.1s"},children:[n.jsx("label",{htmlFor:"email",className:"text-gray-700 text-sm font-medium",children:"Email"}),n.jsx(or,{id:"email",type:"email",placeholder:"Enter your email",value:o,onChange:j=>c(j.target.value),required:!0,className:"rounded-3xl h-12 px-4 bg-white/80 border-2 border-gray-200 hover:border-[#174a9f]/50 focus:border-[#174a9f] focus:ring-2 focus:ring-[#174a9f]/20 transition-all duration-300 shadow-sm hover:shadow-md"})]}),n.jsxs("div",{className:"space-y-2 animate-fade-in-up",style:{animationDelay:"0.2s"},children:[n.jsx("label",{htmlFor:"password",className:"text-gray-700 text-sm font-medium",children:"Password"}),n.jsxs("div",{className:"relative",children:[n.jsx(or,{id:"password",type:r?"text":"password",placeholder:"Enter your password",value:u,onChange:j=>p(j.target.value),required:!0,className:"rounded-3xl h-12 px-4 pr-12 bg-white/80 border-2 border-gray-200 hover:border-[#174a9f]/50 focus:border-[#174a9f] focus:ring-2 focus:ring-[#174a9f]/20 transition-all duration-300 shadow-sm hover:shadow-md"}),n.jsx("button",{type:"button",onClick:()=>t(!r),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-[#174a9f] transition-all duration-300 hover:scale-110",children:r?n.jsx(i4,{size:20}):n.jsx(_n,{size:20})})]})]}),n.jsxs("div",{className:"flex items-center justify-between animate-fade-in-up",style:{animationDelay:"0.25s"},children:[n.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer group",children:[n.jsx(Cn,{checked:s,onCheckedChange:a,className:"rounded border-2 hover:border-[#174a9f] transition-all duration-300"}),n.jsx("span",{className:"text-gray-600 group-hover:text-[#174a9f] transition-colors duration-300",children:"Remember me"})]}),n.jsx("a",{href:"#",className:"text-sm text-[#174a9f] hover:underline",children:"Forgot Password?"})]}),n.jsxs(ce,{type:"submit",className:"w-full h-12 rounded-3xl bg-gradient-to-r from-[#2461c7] to-[#174a9f] hover:from-[#174a9f] hover:to-[#123a7f] text-white border-0 shadow-lg hover:shadow-2xl transition-all duration-300 relative overflow-hidden group hover:-translate-y-1 active:translate-y-0 animate-fade-in-up",style:{animationDelay:"0.3s"},children:[n.jsx("span",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"}),n.jsxs("span",{className:"relative z-10 flex items-center justify-center gap-2",children:[h?"Logging in...":"Sign In",n.jsx("span",{className:"text-lg group-hover:translate-x-1 transition-transform duration-300",children:""})]})]})]})},E4="/assets/8d0931fbd565c8647b87305fabaa79cd19ae515f-nOF_erTR.png";function A4(){return n.jsxs("div",{className:"relative h-full w-full overflow-hidden bg-gradient-to-br from-[#0d2a5f] via-[#174a9f] to-[#2461c7]",children:[n.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat transform hover:scale-105 transition-transform duration-700",style:{backgroundImage:`url('${E4}')`}}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#174a9f]/30 via-[#0d2a5f]/40 to-[#174a9f]/50"}),n.jsx("div",{className:"absolute top-20 right-20 w-64 h-64 bg-white/5 rounded-full blur-3xl animate-pulse-soft"}),n.jsx("div",{className:"absolute bottom-40 left-20 w-96 h-96 bg-indigo-400/10 rounded-full blur-3xl animate-float"}),n.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:`linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px),
                         linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)`,backgroundSize:"50px 50px"}}),n.jsxs("div",{className:"absolute bottom-12 left-12 text-white space-y-6 max-w-lg",children:[n.jsxs("div",{className:"space-y-3 animate-fade-in-up",children:[n.jsx("div",{className:"inline-block px-4 py-2 bg-white/10 backdrop-blur-md rounded-full border border-white/20 text-sm",children:" Manufacturing Excellence"}),n.jsx("h2",{className:"text-5xl mb-3 leading-tight bg-gradient-to-r from-white to-blue-100 bg-clip-text text-transparent",children:"Industrial Excellence"}),n.jsx("p",{className:"text-white/90 text-xl",children:"Precision Engineering Solutions"})]}),n.jsxs("div",{className:"flex gap-3 animate-fade-in-up",style:{animationDelay:"0.2s"},children:[n.jsx("div",{className:"px-4 py-2 bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 text-sm hover:bg-white/20 transition-all duration-300 hover:-translate-y-1",children:" Real-time Tracking"}),n.jsx("div",{className:"px-4 py-2 bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 text-sm hover:bg-white/20 transition-all duration-300 hover:-translate-y-1",children:" Quality Control"})]})]}),n.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-white/10 to-transparent"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-tr from-white/10 to-transparent"})]})}function T4({onLogin:e}){return n.jsxs("div",{className:"min-h-screen flex",children:[n.jsx("div",{className:"flex-1 relative hidden lg:block",children:n.jsx(A4,{})}),n.jsxs("div",{className:"flex-1 flex items-center justify-center px-8 py-12 background-accent-blue relative overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 background-accent-blue"}),n.jsx("div",{className:"background-glow-top animate-pulse-soft"}),n.jsx("div",{className:"background-glow-bottom animate-pulse-soft",style:{animationDelay:"1s"}}),n.jsx("div",{className:"absolute top-1/4 left-1/4 w-32 h-32 bg-[#174a9f]/10 rounded-full blur-3xl animate-float"}),n.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-40 h-40 bg-indigo-400/10 rounded-full blur-3xl animate-float",style:{animationDelay:"1.5s"}}),n.jsx("div",{className:"relative w-full max-w-md form-card animate-scale-in hover:shadow-2xl transition-shadow duration-500",children:n.jsx(C4,{onLogin:e})})]})]})}const uw=m.createContext(void 0);function O4({children:e}){const[r,t]=m.useState({}),[s,a]=m.useState({}),o=(h,x)=>{t(y=>({...y,[h]:x}))},c=h=>{a(x=>({...x,[h]:!x[h]}))},u=h=>r[h]||"",p=h=>s[h]||!1;return n.jsx(uw.Provider,{value:{remarks:r,alertStatuses:s,updateRemark:o,toggleAlertStatus:c,getRemark:u,getAlertStatus:p},children:e})}function Qn(){const e=m.useContext(uw);if(e===void 0)throw new Error("useOrderContext must be used within an OrderProvider");return e}const Fn=({allowedRole:e,children:r})=>{const t=localStorage.getItem("user");if(!t)return n.jsx(Uh,{to:"/",replace:!0});const s=JSON.parse(t),a=typeof s.role=="object"?s.role.name:s.role,o=h=>(h||"").trim().toLowerCase().replace(/\s+/g,"-").replace(/_/g,"-"),u=(h=>!h||h.includes("admin")||h.includes("planning")?"planning":h.includes("material")?"material-issue":h.includes("semi")?"semi-qc":h.includes("phosphat")?"phosphating":h.includes("assembly")?"assembly":h.includes("svs")?"svs":h.includes("tpi")?"tpi":h.includes("dispatch")?"dispatch":h.includes("testing1")||h.includes("testing-1")?"testing1":h.includes("testing2")||h.includes("testing-2")?"testing2":h==="testing"?"testing1":h.includes("marking1")||h.includes("marking-1")?"marking1":h.includes("marking2")||h.includes("marking-2")?"marking2":h==="marking"?"marking1":h.includes("pdi1")||h.includes("pdi-1")?"pdi1":h.includes("pdi2")||h.includes("pdi-2")?"pdi2":h==="pdi"?"pdi1":h)(o(a)),p=o(e);return u!==p?(console.warn(`Access denied: user role "${u}" cannot access "${p}" page`),n.jsx(Uh,{to:"/",replace:!0})):n.jsx(n.Fragment,{children:r})};function fw(e,r){return function(){return e.apply(r,arguments)}}const{toString:P4}=Object.prototype,{getPrototypeOf:Ep}=Object,{iterator:qu,toStringTag:hw}=Symbol,Vu=(e=>r=>{const t=P4.call(r);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),$s=e=>(e=e.toLowerCase(),r=>Vu(r)===e),Qu=e=>r=>typeof r===e,{isArray:Wo}=Array,Ro=Qu("undefined");function uc(e){return e!==null&&!Ro(e)&&e.constructor!==null&&!Ro(e.constructor)&&Ln(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const pw=$s("ArrayBuffer");function R4(e){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(e):r=e&&e.buffer&&pw(e.buffer),r}const D4=Qu("string"),Ln=Qu("function"),mw=Qu("number"),fc=e=>e!==null&&typeof e=="object",F4=e=>e===!0||e===!1,su=e=>{if(Vu(e)!=="object")return!1;const r=Ep(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(hw in e)&&!(qu in e)},M4=e=>{if(!fc(e)||uc(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},L4=$s("Date"),I4=$s("File"),B4=$s("Blob"),$4=$s("FileList"),U4=e=>fc(e)&&Ln(e.pipe),z4=e=>{let r;return e&&(typeof FormData=="function"&&e instanceof FormData||Ln(e.append)&&((r=Vu(e))==="formdata"||r==="object"&&Ln(e.toString)&&e.toString()==="[object FormData]"))},W4=$s("URLSearchParams"),[q4,V4,Q4,H4]=["ReadableStream","Request","Response","Headers"].map($s),G4=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function hc(e,r,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let s,a;if(typeof e!="object"&&(e=[e]),Wo(e))for(s=0,a=e.length;s<a;s++)r.call(null,e[s],s,e);else{if(uc(e))return;const o=t?Object.getOwnPropertyNames(e):Object.keys(e),c=o.length;let u;for(s=0;s<c;s++)u=o[s],r.call(null,e[u],u,e)}}function xw(e,r){if(uc(e))return null;r=r.toLowerCase();const t=Object.keys(e);let s=t.length,a;for(;s-- >0;)if(a=t[s],r===a.toLowerCase())return a;return null}const Ei=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,gw=e=>!Ro(e)&&e!==Ei;function Hh(){const{caseless:e,skipUndefined:r}=gw(this)&&this||{},t={},s=(a,o)=>{const c=e&&xw(t,o)||o;su(t[c])&&su(a)?t[c]=Hh(t[c],a):su(a)?t[c]=Hh({},a):Wo(a)?t[c]=a.slice():(!r||!Ro(a))&&(t[c]=a)};for(let a=0,o=arguments.length;a<o;a++)arguments[a]&&hc(arguments[a],s);return t}const Y4=(e,r,t,{allOwnKeys:s}={})=>(hc(r,(a,o)=>{t&&Ln(a)?e[o]=fw(a,t):e[o]=a},{allOwnKeys:s}),e),K4=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),X4=(e,r,t,s)=>{e.prototype=Object.create(r.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:r.prototype}),t&&Object.assign(e.prototype,t)},J4=(e,r,t,s)=>{let a,o,c;const u={};if(r=r||{},e==null)return r;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)c=a[o],(!s||s(c,e,r))&&!u[c]&&(r[c]=e[c],u[c]=!0);e=t!==!1&&Ep(e)}while(e&&(!t||t(e,r))&&e!==Object.prototype);return r},Z4=(e,r,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=r.length;const s=e.indexOf(r,t);return s!==-1&&s===t},e3=e=>{if(!e)return null;if(Wo(e))return e;let r=e.length;if(!mw(r))return null;const t=new Array(r);for(;r-- >0;)t[r]=e[r];return t},t3=(e=>r=>e&&r instanceof e)(typeof Uint8Array<"u"&&Ep(Uint8Array)),r3=(e,r)=>{const s=(e&&e[qu]).call(e);let a;for(;(a=s.next())&&!a.done;){const o=a.value;r.call(e,o[0],o[1])}},n3=(e,r)=>{let t;const s=[];for(;(t=e.exec(r))!==null;)s.push(t);return s},s3=$s("HTMLFormElement"),a3=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,s,a){return s.toUpperCase()+a}),Ty=(({hasOwnProperty:e})=>(r,t)=>e.call(r,t))(Object.prototype),i3=$s("RegExp"),yw=(e,r)=>{const t=Object.getOwnPropertyDescriptors(e),s={};hc(t,(a,o)=>{let c;(c=r(a,o,e))!==!1&&(s[o]=c||a)}),Object.defineProperties(e,s)},o3=e=>{yw(e,(r,t)=>{if(Ln(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const s=e[t];if(Ln(s)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},l3=(e,r)=>{const t={},s=a=>{a.forEach(o=>{t[o]=!0})};return Wo(e)?s(e):s(String(e).split(r)),t},c3=()=>{},d3=(e,r)=>e!=null&&Number.isFinite(e=+e)?e:r;function u3(e){return!!(e&&Ln(e.append)&&e[hw]==="FormData"&&e[qu])}const f3=e=>{const r=new Array(10),t=(s,a)=>{if(fc(s)){if(r.indexOf(s)>=0)return;if(uc(s))return s;if(!("toJSON"in s)){r[a]=s;const o=Wo(s)?[]:{};return hc(s,(c,u)=>{const p=t(c,a+1);!Ro(p)&&(o[u]=p)}),r[a]=void 0,o}}return s};return t(e,0)},h3=$s("AsyncFunction"),p3=e=>e&&(fc(e)||Ln(e))&&Ln(e.then)&&Ln(e.catch),vw=((e,r)=>e?setImmediate:r?((t,s)=>(Ei.addEventListener("message",({source:a,data:o})=>{a===Ei&&o===t&&s.length&&s.shift()()},!1),a=>{s.push(a),Ei.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Ln(Ei.postMessage)),m3=typeof queueMicrotask<"u"?queueMicrotask.bind(Ei):typeof process<"u"&&process.nextTick||vw,x3=e=>e!=null&&Ln(e[qu]),Oe={isArray:Wo,isArrayBuffer:pw,isBuffer:uc,isFormData:z4,isArrayBufferView:R4,isString:D4,isNumber:mw,isBoolean:F4,isObject:fc,isPlainObject:su,isEmptyObject:M4,isReadableStream:q4,isRequest:V4,isResponse:Q4,isHeaders:H4,isUndefined:Ro,isDate:L4,isFile:I4,isBlob:B4,isRegExp:i3,isFunction:Ln,isStream:U4,isURLSearchParams:W4,isTypedArray:t3,isFileList:$4,forEach:hc,merge:Hh,extend:Y4,trim:G4,stripBOM:K4,inherits:X4,toFlatObject:J4,kindOf:Vu,kindOfTest:$s,endsWith:Z4,toArray:e3,forEachEntry:r3,matchAll:n3,isHTMLForm:s3,hasOwnProperty:Ty,hasOwnProp:Ty,reduceDescriptors:yw,freezeMethods:o3,toObjectSet:l3,toCamelCase:a3,noop:c3,toFiniteNumber:d3,findKey:xw,global:Ei,isContextDefined:gw,isSpecCompliantForm:u3,toJSONObject:f3,isAsyncFn:h3,isThenable:p3,setImmediate:vw,asap:m3,isIterable:x3};function At(e,r,t,s,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",r&&(this.code=r),t&&(this.config=t),s&&(this.request=s),a&&(this.response=a,this.status=a.status?a.status:null)}Oe.inherits(At,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Oe.toJSONObject(this.config),code:this.code,status:this.status}}});const ww=At.prototype,Nw={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Nw[e]={value:e}});Object.defineProperties(At,Nw);Object.defineProperty(ww,"isAxiosError",{value:!0});At.from=(e,r,t,s,a,o)=>{const c=Object.create(ww);Oe.toFlatObject(e,c,function(x){return x!==Error.prototype},h=>h!=="isAxiosError");const u=e&&e.message?e.message:"Error",p=r==null&&e?e.code:r;return At.call(c,u,p,t,s,a),e&&c.cause==null&&Object.defineProperty(c,"cause",{value:e,configurable:!0}),c.name=e&&e.name||"Error",o&&Object.assign(c,o),c};const g3=null;function Gh(e){return Oe.isPlainObject(e)||Oe.isArray(e)}function Sw(e){return Oe.endsWith(e,"[]")?e.slice(0,-2):e}function Oy(e,r,t){return e?e.concat(r).map(function(a,o){return a=Sw(a),!t&&o?"["+a+"]":a}).join(t?".":""):r}function y3(e){return Oe.isArray(e)&&!e.some(Gh)}const v3=Oe.toFlatObject(Oe,{},null,function(r){return/^is[A-Z]/.test(r)});function Hu(e,r,t){if(!Oe.isObject(e))throw new TypeError("target must be an object");r=r||new FormData,t=Oe.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,j){return!Oe.isUndefined(j[w])});const s=t.metaTokens,a=t.visitor||x,o=t.dots,c=t.indexes,p=(t.Blob||typeof Blob<"u"&&Blob)&&Oe.isSpecCompliantForm(r);if(!Oe.isFunction(a))throw new TypeError("visitor must be a function");function h(b){if(b===null)return"";if(Oe.isDate(b))return b.toISOString();if(Oe.isBoolean(b))return b.toString();if(!p&&Oe.isBlob(b))throw new At("Blob is not supported. Use a Buffer instead.");return Oe.isArrayBuffer(b)||Oe.isTypedArray(b)?p&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function x(b,w,j){let O=b;if(b&&!j&&typeof b=="object"){if(Oe.endsWith(w,"{}"))w=s?w:w.slice(0,-2),b=JSON.stringify(b);else if(Oe.isArray(b)&&y3(b)||(Oe.isFileList(b)||Oe.endsWith(w,"[]"))&&(O=Oe.toArray(b)))return w=Sw(w),O.forEach(function(F,I){!(Oe.isUndefined(F)||F===null)&&r.append(c===!0?Oy([w],I,o):c===null?w:w+"[]",h(F))}),!1}return Gh(b)?!0:(r.append(Oy(j,w,o),h(b)),!1)}const y=[],v=Object.assign(v3,{defaultVisitor:x,convertValue:h,isVisitable:Gh});function k(b,w){if(!Oe.isUndefined(b)){if(y.indexOf(b)!==-1)throw Error("Circular reference detected in "+w.join("."));y.push(b),Oe.forEach(b,function(O,T){(!(Oe.isUndefined(O)||O===null)&&a.call(r,O,Oe.isString(T)?T.trim():T,w,v))===!0&&k(O,w?w.concat(T):[T])}),y.pop()}}if(!Oe.isObject(e))throw new TypeError("data must be an object");return k(e),r}function Py(e){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(s){return r[s]})}function Ap(e,r){this._pairs=[],e&&Hu(e,this,r)}const bw=Ap.prototype;bw.append=function(r,t){this._pairs.push([r,t])};bw.toString=function(r){const t=r?function(s){return r.call(this,s,Py)}:Py;return this._pairs.map(function(a){return t(a[0])+"="+t(a[1])},"").join("&")};function w3(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function jw(e,r,t){if(!r)return e;const s=t&&t.encode||w3;Oe.isFunction(t)&&(t={serialize:t});const a=t&&t.serialize;let o;if(a?o=a(r,t):o=Oe.isURLSearchParams(r)?r.toString():new Ap(r,t).toString(s),o){const c=e.indexOf("#");c!==-1&&(e=e.slice(0,c)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class Ry{constructor(){this.handlers=[]}use(r,t,s){return this.handlers.push({fulfilled:r,rejected:t,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){Oe.forEach(this.handlers,function(s){s!==null&&r(s)})}}const kw={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},N3=typeof URLSearchParams<"u"?URLSearchParams:Ap,S3=typeof FormData<"u"?FormData:null,b3=typeof Blob<"u"?Blob:null,j3={isBrowser:!0,classes:{URLSearchParams:N3,FormData:S3,Blob:b3},protocols:["http","https","file","blob","url","data"]},Tp=typeof window<"u"&&typeof document<"u",Yh=typeof navigator=="object"&&navigator||void 0,k3=Tp&&(!Yh||["ReactNative","NativeScript","NS"].indexOf(Yh.product)<0),_3=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",C3=Tp&&window.location.href||"http://localhost",E3=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Tp,hasStandardBrowserEnv:k3,hasStandardBrowserWebWorkerEnv:_3,navigator:Yh,origin:C3},Symbol.toStringTag,{value:"Module"})),hn={...E3,...j3};function A3(e,r){return Hu(e,new hn.classes.URLSearchParams,{visitor:function(t,s,a,o){return hn.isNode&&Oe.isBuffer(t)?(this.append(s,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)},...r})}function T3(e){return Oe.matchAll(/\w+|\[(\w*)]/g,e).map(r=>r[0]==="[]"?"":r[1]||r[0])}function O3(e){const r={},t=Object.keys(e);let s;const a=t.length;let o;for(s=0;s<a;s++)o=t[s],r[o]=e[o];return r}function _w(e){function r(t,s,a,o){let c=t[o++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),p=o>=t.length;return c=!c&&Oe.isArray(a)?a.length:c,p?(Oe.hasOwnProp(a,c)?a[c]=[a[c],s]:a[c]=s,!u):((!a[c]||!Oe.isObject(a[c]))&&(a[c]=[]),r(t,s,a[c],o)&&Oe.isArray(a[c])&&(a[c]=O3(a[c])),!u)}if(Oe.isFormData(e)&&Oe.isFunction(e.entries)){const t={};return Oe.forEachEntry(e,(s,a)=>{r(T3(s),a,t,0)}),t}return null}function P3(e,r,t){if(Oe.isString(e))try{return(r||JSON.parse)(e),Oe.trim(e)}catch(s){if(s.name!=="SyntaxError")throw s}return(t||JSON.stringify)(e)}const pc={transitional:kw,adapter:["xhr","http","fetch"],transformRequest:[function(r,t){const s=t.getContentType()||"",a=s.indexOf("application/json")>-1,o=Oe.isObject(r);if(o&&Oe.isHTMLForm(r)&&(r=new FormData(r)),Oe.isFormData(r))return a?JSON.stringify(_w(r)):r;if(Oe.isArrayBuffer(r)||Oe.isBuffer(r)||Oe.isStream(r)||Oe.isFile(r)||Oe.isBlob(r)||Oe.isReadableStream(r))return r;if(Oe.isArrayBufferView(r))return r.buffer;if(Oe.isURLSearchParams(r))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let u;if(o){if(s.indexOf("application/x-www-form-urlencoded")>-1)return A3(r,this.formSerializer).toString();if((u=Oe.isFileList(r))||s.indexOf("multipart/form-data")>-1){const p=this.env&&this.env.FormData;return Hu(u?{"files[]":r}:r,p&&new p,this.formSerializer)}}return o||a?(t.setContentType("application/json",!1),P3(r)):r}],transformResponse:[function(r){const t=this.transitional||pc.transitional,s=t&&t.forcedJSONParsing,a=this.responseType==="json";if(Oe.isResponse(r)||Oe.isReadableStream(r))return r;if(r&&Oe.isString(r)&&(s&&!this.responseType||a)){const c=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(r,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?At.from(u,At.ERR_BAD_RESPONSE,this,null,this.response):u}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:hn.classes.FormData,Blob:hn.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Oe.forEach(["delete","get","head","post","put","patch"],e=>{pc.headers[e]={}});const R3=Oe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),D3=e=>{const r={};let t,s,a;return e&&e.split(`
`).forEach(function(c){a=c.indexOf(":"),t=c.substring(0,a).trim().toLowerCase(),s=c.substring(a+1).trim(),!(!t||r[t]&&R3[t])&&(t==="set-cookie"?r[t]?r[t].push(s):r[t]=[s]:r[t]=r[t]?r[t]+", "+s:s)}),r},Dy=Symbol("internals");function Ml(e){return e&&String(e).trim().toLowerCase()}function au(e){return e===!1||e==null?e:Oe.isArray(e)?e.map(au):String(e)}function F3(e){const r=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=t.exec(e);)r[s[1]]=s[2];return r}const M3=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ch(e,r,t,s,a){if(Oe.isFunction(s))return s.call(this,r,t);if(a&&(r=t),!!Oe.isString(r)){if(Oe.isString(s))return r.indexOf(s)!==-1;if(Oe.isRegExp(s))return s.test(r)}}function L3(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,t,s)=>t.toUpperCase()+s)}function I3(e,r){const t=Oe.toCamelCase(" "+r);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+t,{value:function(a,o,c){return this[s].call(this,r,a,o,c)},configurable:!0})})}let In=class{constructor(r){r&&this.set(r)}set(r,t,s){const a=this;function o(u,p,h){const x=Ml(p);if(!x)throw new Error("header name must be a non-empty string");const y=Oe.findKey(a,x);(!y||a[y]===void 0||h===!0||h===void 0&&a[y]!==!1)&&(a[y||p]=au(u))}const c=(u,p)=>Oe.forEach(u,(h,x)=>o(h,x,p));if(Oe.isPlainObject(r)||r instanceof this.constructor)c(r,t);else if(Oe.isString(r)&&(r=r.trim())&&!M3(r))c(D3(r),t);else if(Oe.isObject(r)&&Oe.isIterable(r)){let u={},p,h;for(const x of r){if(!Oe.isArray(x))throw TypeError("Object iterator must return a key-value pair");u[h=x[0]]=(p=u[h])?Oe.isArray(p)?[...p,x[1]]:[p,x[1]]:x[1]}c(u,t)}else r!=null&&o(t,r,s);return this}get(r,t){if(r=Ml(r),r){const s=Oe.findKey(this,r);if(s){const a=this[s];if(!t)return a;if(t===!0)return F3(a);if(Oe.isFunction(t))return t.call(this,a,s);if(Oe.isRegExp(t))return t.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,t){if(r=Ml(r),r){const s=Oe.findKey(this,r);return!!(s&&this[s]!==void 0&&(!t||ch(this,this[s],s,t)))}return!1}delete(r,t){const s=this;let a=!1;function o(c){if(c=Ml(c),c){const u=Oe.findKey(s,c);u&&(!t||ch(s,s[u],u,t))&&(delete s[u],a=!0)}}return Oe.isArray(r)?r.forEach(o):o(r),a}clear(r){const t=Object.keys(this);let s=t.length,a=!1;for(;s--;){const o=t[s];(!r||ch(this,this[o],o,r,!0))&&(delete this[o],a=!0)}return a}normalize(r){const t=this,s={};return Oe.forEach(this,(a,o)=>{const c=Oe.findKey(s,o);if(c){t[c]=au(a),delete t[o];return}const u=r?L3(o):String(o).trim();u!==o&&delete t[o],t[u]=au(a),s[u]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const t=Object.create(null);return Oe.forEach(this,(s,a)=>{s!=null&&s!==!1&&(t[a]=r&&Oe.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,t])=>r+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...t){const s=new this(r);return t.forEach(a=>s.set(a)),s}static accessor(r){const s=(this[Dy]=this[Dy]={accessors:{}}).accessors,a=this.prototype;function o(c){const u=Ml(c);s[u]||(I3(a,c),s[u]=!0)}return Oe.isArray(r)?r.forEach(o):o(r),this}};In.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Oe.reduceDescriptors(In.prototype,({value:e},r)=>{let t=r[0].toUpperCase()+r.slice(1);return{get:()=>e,set(s){this[t]=s}}});Oe.freezeMethods(In);function dh(e,r){const t=this||pc,s=r||t,a=In.from(s.headers);let o=s.data;return Oe.forEach(e,function(u){o=u.call(t,o,a.normalize(),r?r.status:void 0)}),a.normalize(),o}function Cw(e){return!!(e&&e.__CANCEL__)}function qo(e,r,t){At.call(this,e??"canceled",At.ERR_CANCELED,r,t),this.name="CanceledError"}Oe.inherits(qo,At,{__CANCEL__:!0});function Ew(e,r,t){const s=t.config.validateStatus;!t.status||!s||s(t.status)?e(t):r(new At("Request failed with status code "+t.status,[At.ERR_BAD_REQUEST,At.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function B3(e){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return r&&r[1]||""}function $3(e,r){e=e||10;const t=new Array(e),s=new Array(e);let a=0,o=0,c;return r=r!==void 0?r:1e3,function(p){const h=Date.now(),x=s[o];c||(c=h),t[a]=p,s[a]=h;let y=o,v=0;for(;y!==a;)v+=t[y++],y=y%e;if(a=(a+1)%e,a===o&&(o=(o+1)%e),h-c<r)return;const k=x&&h-x;return k?Math.round(v*1e3/k):void 0}}function U3(e,r){let t=0,s=1e3/r,a,o;const c=(h,x=Date.now())=>{t=x,a=null,o&&(clearTimeout(o),o=null),e(...h)};return[(...h)=>{const x=Date.now(),y=x-t;y>=s?c(h,x):(a=h,o||(o=setTimeout(()=>{o=null,c(a)},s-y)))},()=>a&&c(a)]}const pu=(e,r,t=3)=>{let s=0;const a=$3(50,250);return U3(o=>{const c=o.loaded,u=o.lengthComputable?o.total:void 0,p=c-s,h=a(p),x=c<=u;s=c;const y={loaded:c,total:u,progress:u?c/u:void 0,bytes:p,rate:h||void 0,estimated:h&&u&&x?(u-c)/h:void 0,event:o,lengthComputable:u!=null,[r?"download":"upload"]:!0};e(y)},t)},Fy=(e,r)=>{const t=e!=null;return[s=>r[0]({lengthComputable:t,total:e,loaded:s}),r[1]]},My=e=>(...r)=>Oe.asap(()=>e(...r)),z3=hn.hasStandardBrowserEnv?((e,r)=>t=>(t=new URL(t,hn.origin),e.protocol===t.protocol&&e.host===t.host&&(r||e.port===t.port)))(new URL(hn.origin),hn.navigator&&/(msie|trident)/i.test(hn.navigator.userAgent)):()=>!0,W3=hn.hasStandardBrowserEnv?{write(e,r,t,s,a,o,c){if(typeof document>"u")return;const u=[`${e}=${encodeURIComponent(r)}`];Oe.isNumber(t)&&u.push(`expires=${new Date(t).toUTCString()}`),Oe.isString(s)&&u.push(`path=${s}`),Oe.isString(a)&&u.push(`domain=${a}`),o===!0&&u.push("secure"),Oe.isString(c)&&u.push(`SameSite=${c}`),document.cookie=u.join("; ")},read(e){if(typeof document>"u")return null;const r=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return r?decodeURIComponent(r[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function q3(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function V3(e,r){return r?e.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):e}function Aw(e,r,t){let s=!q3(r);return e&&(s||t==!1)?V3(e,r):r}const Ly=e=>e instanceof In?{...e}:e;function Pi(e,r){r=r||{};const t={};function s(h,x,y,v){return Oe.isPlainObject(h)&&Oe.isPlainObject(x)?Oe.merge.call({caseless:v},h,x):Oe.isPlainObject(x)?Oe.merge({},x):Oe.isArray(x)?x.slice():x}function a(h,x,y,v){if(Oe.isUndefined(x)){if(!Oe.isUndefined(h))return s(void 0,h,y,v)}else return s(h,x,y,v)}function o(h,x){if(!Oe.isUndefined(x))return s(void 0,x)}function c(h,x){if(Oe.isUndefined(x)){if(!Oe.isUndefined(h))return s(void 0,h)}else return s(void 0,x)}function u(h,x,y){if(y in r)return s(h,x);if(y in e)return s(void 0,h)}const p={url:o,method:o,data:o,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(h,x,y)=>a(Ly(h),Ly(x),y,!0)};return Oe.forEach(Object.keys({...e,...r}),function(x){const y=p[x]||a,v=y(e[x],r[x],x);Oe.isUndefined(v)&&y!==u||(t[x]=v)}),t}const Tw=e=>{const r=Pi({},e);let{data:t,withXSRFToken:s,xsrfHeaderName:a,xsrfCookieName:o,headers:c,auth:u}=r;if(r.headers=c=In.from(c),r.url=jw(Aw(r.baseURL,r.url,r.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),Oe.isFormData(t)){if(hn.hasStandardBrowserEnv||hn.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(Oe.isFunction(t.getHeaders)){const p=t.getHeaders(),h=["content-type","content-length"];Object.entries(p).forEach(([x,y])=>{h.includes(x.toLowerCase())&&c.set(x,y)})}}if(hn.hasStandardBrowserEnv&&(s&&Oe.isFunction(s)&&(s=s(r)),s||s!==!1&&z3(r.url))){const p=a&&o&&W3.read(o);p&&c.set(a,p)}return r},Q3=typeof XMLHttpRequest<"u",H3=Q3&&function(e){return new Promise(function(t,s){const a=Tw(e);let o=a.data;const c=In.from(a.headers).normalize();let{responseType:u,onUploadProgress:p,onDownloadProgress:h}=a,x,y,v,k,b;function w(){k&&k(),b&&b(),a.cancelToken&&a.cancelToken.unsubscribe(x),a.signal&&a.signal.removeEventListener("abort",x)}let j=new XMLHttpRequest;j.open(a.method.toUpperCase(),a.url,!0),j.timeout=a.timeout;function O(){if(!j)return;const F=In.from("getAllResponseHeaders"in j&&j.getAllResponseHeaders()),G={data:!u||u==="text"||u==="json"?j.responseText:j.response,status:j.status,statusText:j.statusText,headers:F,config:e,request:j};Ew(function(Q){t(Q),w()},function(Q){s(Q),w()},G),j=null}"onloadend"in j?j.onloadend=O:j.onreadystatechange=function(){!j||j.readyState!==4||j.status===0&&!(j.responseURL&&j.responseURL.indexOf("file:")===0)||setTimeout(O)},j.onabort=function(){j&&(s(new At("Request aborted",At.ECONNABORTED,e,j)),j=null)},j.onerror=function(I){const G=I&&I.message?I.message:"Network Error",B=new At(G,At.ERR_NETWORK,e,j);B.event=I||null,s(B),j=null},j.ontimeout=function(){let I=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const G=a.transitional||kw;a.timeoutErrorMessage&&(I=a.timeoutErrorMessage),s(new At(I,G.clarifyTimeoutError?At.ETIMEDOUT:At.ECONNABORTED,e,j)),j=null},o===void 0&&c.setContentType(null),"setRequestHeader"in j&&Oe.forEach(c.toJSON(),function(I,G){j.setRequestHeader(G,I)}),Oe.isUndefined(a.withCredentials)||(j.withCredentials=!!a.withCredentials),u&&u!=="json"&&(j.responseType=a.responseType),h&&([v,b]=pu(h,!0),j.addEventListener("progress",v)),p&&j.upload&&([y,k]=pu(p),j.upload.addEventListener("progress",y),j.upload.addEventListener("loadend",k)),(a.cancelToken||a.signal)&&(x=F=>{j&&(s(!F||F.type?new qo(null,e,j):F),j.abort(),j=null)},a.cancelToken&&a.cancelToken.subscribe(x),a.signal&&(a.signal.aborted?x():a.signal.addEventListener("abort",x)));const T=B3(a.url);if(T&&hn.protocols.indexOf(T)===-1){s(new At("Unsupported protocol "+T+":",At.ERR_BAD_REQUEST,e));return}j.send(o||null)})},G3=(e,r)=>{const{length:t}=e=e?e.filter(Boolean):[];if(r||t){let s=new AbortController,a;const o=function(h){if(!a){a=!0,u();const x=h instanceof Error?h:this.reason;s.abort(x instanceof At?x:new qo(x instanceof Error?x.message:x))}};let c=r&&setTimeout(()=>{c=null,o(new At(`timeout ${r} of ms exceeded`,At.ETIMEDOUT))},r);const u=()=>{e&&(c&&clearTimeout(c),c=null,e.forEach(h=>{h.unsubscribe?h.unsubscribe(o):h.removeEventListener("abort",o)}),e=null)};e.forEach(h=>h.addEventListener("abort",o));const{signal:p}=s;return p.unsubscribe=()=>Oe.asap(u),p}},Y3=function*(e,r){let t=e.byteLength;if(t<r){yield e;return}let s=0,a;for(;s<t;)a=s+r,yield e.slice(s,a),s=a},K3=async function*(e,r){for await(const t of X3(e))yield*Y3(t,r)},X3=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const r=e.getReader();try{for(;;){const{done:t,value:s}=await r.read();if(t)break;yield s}}finally{await r.cancel()}},Iy=(e,r,t,s)=>{const a=K3(e,r);let o=0,c,u=p=>{c||(c=!0,s&&s(p))};return new ReadableStream({async pull(p){try{const{done:h,value:x}=await a.next();if(h){u(),p.close();return}let y=x.byteLength;if(t){let v=o+=y;t(v)}p.enqueue(new Uint8Array(x))}catch(h){throw u(h),h}},cancel(p){return u(p),a.return()}},{highWaterMark:2})},By=64*1024,{isFunction:zd}=Oe,J3=(({Request:e,Response:r})=>({Request:e,Response:r}))(Oe.global),{ReadableStream:$y,TextEncoder:Uy}=Oe.global,zy=(e,...r)=>{try{return!!e(...r)}catch{return!1}},Z3=e=>{e=Oe.merge.call({skipUndefined:!0},J3,e);const{fetch:r,Request:t,Response:s}=e,a=r?zd(r):typeof fetch=="function",o=zd(t),c=zd(s);if(!a)return!1;const u=a&&zd($y),p=a&&(typeof Uy=="function"?(b=>w=>b.encode(w))(new Uy):async b=>new Uint8Array(await new t(b).arrayBuffer())),h=o&&u&&zy(()=>{let b=!1;const w=new t(hn.origin,{body:new $y,method:"POST",get duplex(){return b=!0,"half"}}).headers.has("Content-Type");return b&&!w}),x=c&&u&&zy(()=>Oe.isReadableStream(new s("").body)),y={stream:x&&(b=>b.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(b=>{!y[b]&&(y[b]=(w,j)=>{let O=w&&w[b];if(O)return O.call(w);throw new At(`Response type '${b}' is not supported`,At.ERR_NOT_SUPPORT,j)})});const v=async b=>{if(b==null)return 0;if(Oe.isBlob(b))return b.size;if(Oe.isSpecCompliantForm(b))return(await new t(hn.origin,{method:"POST",body:b}).arrayBuffer()).byteLength;if(Oe.isArrayBufferView(b)||Oe.isArrayBuffer(b))return b.byteLength;if(Oe.isURLSearchParams(b)&&(b=b+""),Oe.isString(b))return(await p(b)).byteLength},k=async(b,w)=>{const j=Oe.toFiniteNumber(b.getContentLength());return j??v(w)};return async b=>{let{url:w,method:j,data:O,signal:T,cancelToken:F,timeout:I,onDownloadProgress:G,onUploadProgress:B,responseType:Q,headers:z,withCredentials:J="same-origin",fetchOptions:ne}=Tw(b),fe=r||fetch;Q=Q?(Q+"").toLowerCase():"text";let me=G3([T,F&&F.toAbortSignal()],I),le=null;const K=me&&me.unsubscribe&&(()=>{me.unsubscribe()});let Fe;try{if(B&&h&&j!=="get"&&j!=="head"&&(Fe=await k(z,O))!==0){let ee=new t(w,{method:"POST",body:O,duplex:"half"}),U;if(Oe.isFormData(O)&&(U=ee.headers.get("content-type"))&&z.setContentType(U),ee.body){const[re,Y]=Fy(Fe,pu(My(B)));O=Iy(ee.body,By,re,Y)}}Oe.isString(J)||(J=J?"include":"omit");const we=o&&"credentials"in t.prototype,oe={...ne,signal:me,method:j.toUpperCase(),headers:z.normalize().toJSON(),body:O,duplex:"half",credentials:we?J:void 0};le=o&&new t(w,oe);let V=await(o?fe(le,ne):fe(w,oe));const de=x&&(Q==="stream"||Q==="response");if(x&&(G||de&&K)){const ee={};["status","statusText","headers"].forEach(Z=>{ee[Z]=V[Z]});const U=Oe.toFiniteNumber(V.headers.get("content-length")),[re,Y]=G&&Fy(U,pu(My(G),!0))||[];V=new s(Iy(V.body,By,re,()=>{Y&&Y(),K&&K()}),ee)}Q=Q||"text";let Ne=await y[Oe.findKey(y,Q)||"text"](V,b);return!de&&K&&K(),await new Promise((ee,U)=>{Ew(ee,U,{data:Ne,headers:In.from(V.headers),status:V.status,statusText:V.statusText,config:b,request:le})})}catch(we){throw K&&K(),we&&we.name==="TypeError"&&/Load failed|fetch/i.test(we.message)?Object.assign(new At("Network Error",At.ERR_NETWORK,b,le),{cause:we.cause||we}):At.from(we,we&&we.code,b,le)}}},eA=new Map,Ow=e=>{let r=e&&e.env||{};const{fetch:t,Request:s,Response:a}=r,o=[s,a,t];let c=o.length,u=c,p,h,x=eA;for(;u--;)p=o[u],h=x.get(p),h===void 0&&x.set(p,h=u?new Map:Z3(r)),x=h;return h};Ow();const Op={http:g3,xhr:H3,fetch:{get:Ow}};Oe.forEach(Op,(e,r)=>{if(e){try{Object.defineProperty(e,"name",{value:r})}catch{}Object.defineProperty(e,"adapterName",{value:r})}});const Wy=e=>`- ${e}`,tA=e=>Oe.isFunction(e)||e===null||e===!1;function rA(e,r){e=Oe.isArray(e)?e:[e];const{length:t}=e;let s,a;const o={};for(let c=0;c<t;c++){s=e[c];let u;if(a=s,!tA(s)&&(a=Op[(u=String(s)).toLowerCase()],a===void 0))throw new At(`Unknown adapter '${u}'`);if(a&&(Oe.isFunction(a)||(a=a.get(r))))break;o[u||"#"+c]=a}if(!a){const c=Object.entries(o).map(([p,h])=>`adapter ${p} `+(h===!1?"is not supported by the environment":"is not available in the build"));let u=t?c.length>1?`since :
`+c.map(Wy).join(`
`):" "+Wy(c[0]):"as no adapter specified";throw new At("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return a}const Pw={getAdapter:rA,adapters:Op};function uh(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new qo(null,e)}function qy(e){return uh(e),e.headers=In.from(e.headers),e.data=dh.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Pw.getAdapter(e.adapter||pc.adapter,e)(e).then(function(s){return uh(e),s.data=dh.call(e,e.transformResponse,s),s.headers=In.from(s.headers),s},function(s){return Cw(s)||(uh(e),s&&s.response&&(s.response.data=dh.call(e,e.transformResponse,s.response),s.response.headers=In.from(s.response.headers))),Promise.reject(s)})}const Rw="1.13.2",Gu={};["object","boolean","number","function","string","symbol"].forEach((e,r)=>{Gu[e]=function(s){return typeof s===e||"a"+(r<1?"n ":" ")+e}});const Vy={};Gu.transitional=function(r,t,s){function a(o,c){return"[Axios v"+Rw+"] Transitional option '"+o+"'"+c+(s?". "+s:"")}return(o,c,u)=>{if(r===!1)throw new At(a(c," has been removed"+(t?" in "+t:"")),At.ERR_DEPRECATED);return t&&!Vy[c]&&(Vy[c]=!0,console.warn(a(c," has been deprecated since v"+t+" and will be removed in the near future"))),r?r(o,c,u):!0}};Gu.spelling=function(r){return(t,s)=>(console.warn(`${s} is likely a misspelling of ${r}`),!0)};function nA(e,r,t){if(typeof e!="object")throw new At("options must be an object",At.ERR_BAD_OPTION_VALUE);const s=Object.keys(e);let a=s.length;for(;a-- >0;){const o=s[a],c=r[o];if(c){const u=e[o],p=u===void 0||c(u,o,e);if(p!==!0)throw new At("option "+o+" must be "+p,At.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new At("Unknown option "+o,At.ERR_BAD_OPTION)}}const iu={assertOptions:nA,validators:Gu},Hs=iu.validators;let Ai=class{constructor(r){this.defaults=r||{},this.interceptors={request:new Ry,response:new Ry}}async request(r,t){try{return await this._request(r,t)}catch(s){if(s instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{s.stack?o&&!String(s.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+o):s.stack=o}catch{}}throw s}}_request(r,t){typeof r=="string"?(t=t||{},t.url=r):t=r||{},t=Pi(this.defaults,t);const{transitional:s,paramsSerializer:a,headers:o}=t;s!==void 0&&iu.assertOptions(s,{silentJSONParsing:Hs.transitional(Hs.boolean),forcedJSONParsing:Hs.transitional(Hs.boolean),clarifyTimeoutError:Hs.transitional(Hs.boolean)},!1),a!=null&&(Oe.isFunction(a)?t.paramsSerializer={serialize:a}:iu.assertOptions(a,{encode:Hs.function,serialize:Hs.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),iu.assertOptions(t,{baseUrl:Hs.spelling("baseURL"),withXsrfToken:Hs.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let c=o&&Oe.merge(o.common,o[t.method]);o&&Oe.forEach(["delete","get","head","post","put","patch","common"],b=>{delete o[b]}),t.headers=In.concat(c,o);const u=[];let p=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(t)===!1||(p=p&&w.synchronous,u.unshift(w.fulfilled,w.rejected))});const h=[];this.interceptors.response.forEach(function(w){h.push(w.fulfilled,w.rejected)});let x,y=0,v;if(!p){const b=[qy.bind(this),void 0];for(b.unshift(...u),b.push(...h),v=b.length,x=Promise.resolve(t);y<v;)x=x.then(b[y++],b[y++]);return x}v=u.length;let k=t;for(;y<v;){const b=u[y++],w=u[y++];try{k=b(k)}catch(j){w.call(this,j);break}}try{x=qy.call(this,k)}catch(b){return Promise.reject(b)}for(y=0,v=h.length;y<v;)x=x.then(h[y++],h[y++]);return x}getUri(r){r=Pi(this.defaults,r);const t=Aw(r.baseURL,r.url,r.allowAbsoluteUrls);return jw(t,r.params,r.paramsSerializer)}};Oe.forEach(["delete","get","head","options"],function(r){Ai.prototype[r]=function(t,s){return this.request(Pi(s||{},{method:r,url:t,data:(s||{}).data}))}});Oe.forEach(["post","put","patch"],function(r){function t(s){return function(o,c,u){return this.request(Pi(u||{},{method:r,headers:s?{"Content-Type":"multipart/form-data"}:{},url:o,data:c}))}}Ai.prototype[r]=t(),Ai.prototype[r+"Form"]=t(!0)});let sA=class Dw{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const s=this;this.promise.then(a=>{if(!s._listeners)return;let o=s._listeners.length;for(;o-- >0;)s._listeners[o](a);s._listeners=null}),this.promise.then=a=>{let o;const c=new Promise(u=>{s.subscribe(u),o=u}).then(a);return c.cancel=function(){s.unsubscribe(o)},c},r(function(o,c,u){s.reason||(s.reason=new qo(o,c,u),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const t=this._listeners.indexOf(r);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const r=new AbortController,t=s=>{r.abort(s)};return this.subscribe(t),r.signal.unsubscribe=()=>this.unsubscribe(t),r.signal}static source(){let r;return{token:new Dw(function(a){r=a}),cancel:r}}};function aA(e){return function(t){return e.apply(null,t)}}function iA(e){return Oe.isObject(e)&&e.isAxiosError===!0}const Kh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Kh).forEach(([e,r])=>{Kh[r]=e});function Fw(e){const r=new Ai(e),t=fw(Ai.prototype.request,r);return Oe.extend(t,Ai.prototype,r,{allOwnKeys:!0}),Oe.extend(t,r,null,{allOwnKeys:!0}),t.create=function(a){return Fw(Pi(e,a))},t}const Ze=Fw(pc);Ze.Axios=Ai;Ze.CanceledError=qo;Ze.CancelToken=sA;Ze.isCancel=Cw;Ze.VERSION=Rw;Ze.toFormData=Hu;Ze.AxiosError=At;Ze.Cancel=Ze.CanceledError;Ze.all=function(r){return Promise.all(r)};Ze.spread=aA;Ze.isAxiosError=iA;Ze.mergeConfig=Pi;Ze.AxiosHeaders=In;Ze.formToJSON=e=>_w(Oe.isHTMLForm(e)?new FormData(e):e);Ze.getAdapter=Pw.getAdapter;Ze.HttpStatusCode=Kh;Ze.default=Ze;const{Axios:iU,AxiosError:oU,CanceledError:lU,isCancel:cU,CancelToken:dU,VERSION:uU,all:fU,Cancel:hU,isAxiosError:pU,spread:mU,toFormData:xU,AxiosHeaders:gU,HttpStatusCode:yU,formToJSON:vU,getAdapter:wU,mergeConfig:NU}=Ze,oA=B1("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Hn({className:e,variant:r,asChild:t=!1,...s}){const a=t?M1:"span";return n.jsx(a,{"data-slot":"badge",className:sr(oA({variant:r}),e),...s})}var lA=mp[" useId ".trim().toString()]||(()=>{}),cA=0;function Zs(e){const[r,t]=m.useState(lA());return Vr(()=>{t(s=>s??String(cA++))},[e]),e||(r?`radix-${r}`:"")}function Rs(e){const r=m.useRef(e);return m.useEffect(()=>{r.current=e}),m.useMemo(()=>(...t)=>r.current?.(...t),[])}function dA(e,r=globalThis?.document){const t=Rs(e);m.useEffect(()=>{const s=a=>{a.key==="Escape"&&t(a)};return r.addEventListener("keydown",s,{capture:!0}),()=>r.removeEventListener("keydown",s,{capture:!0})},[t,r])}var uA="DismissableLayer",Xh="dismissableLayer.update",fA="dismissableLayer.pointerDownOutside",hA="dismissableLayer.focusOutside",Qy,Mw=m.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),mc=m.forwardRef((e,r)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:c,onDismiss:u,...p}=e,h=m.useContext(Mw),[x,y]=m.useState(null),v=x?.ownerDocument??globalThis?.document,[,k]=m.useState({}),b=Jt(r,Q=>y(Q)),w=Array.from(h.layers),[j]=[...h.layersWithOutsidePointerEventsDisabled].slice(-1),O=w.indexOf(j),T=x?w.indexOf(x):-1,F=h.layersWithOutsidePointerEventsDisabled.size>0,I=T>=O,G=xA(Q=>{const z=Q.target,J=[...h.branches].some(ne=>ne.contains(z));!I||J||(a?.(Q),c?.(Q),Q.defaultPrevented||u?.())},v),B=gA(Q=>{const z=Q.target;[...h.branches].some(ne=>ne.contains(z))||(o?.(Q),c?.(Q),Q.defaultPrevented||u?.())},v);return dA(Q=>{T===h.layers.size-1&&(s?.(Q),!Q.defaultPrevented&&u&&(Q.preventDefault(),u()))},v),m.useEffect(()=>{if(x)return t&&(h.layersWithOutsidePointerEventsDisabled.size===0&&(Qy=v.body.style.pointerEvents,v.body.style.pointerEvents="none"),h.layersWithOutsidePointerEventsDisabled.add(x)),h.layers.add(x),Hy(),()=>{t&&h.layersWithOutsidePointerEventsDisabled.size===1&&(v.body.style.pointerEvents=Qy)}},[x,v,t,h]),m.useEffect(()=>()=>{x&&(h.layers.delete(x),h.layersWithOutsidePointerEventsDisabled.delete(x),Hy())},[x,h]),m.useEffect(()=>{const Q=()=>k({});return document.addEventListener(Xh,Q),()=>document.removeEventListener(Xh,Q)},[]),n.jsx(Pt.div,{...p,ref:b,style:{pointerEvents:F?I?"auto":"none":void 0,...e.style},onFocusCapture:ct(e.onFocusCapture,B.onFocusCapture),onBlurCapture:ct(e.onBlurCapture,B.onBlurCapture),onPointerDownCapture:ct(e.onPointerDownCapture,G.onPointerDownCapture)})});mc.displayName=uA;var pA="DismissableLayerBranch",mA=m.forwardRef((e,r)=>{const t=m.useContext(Mw),s=m.useRef(null),a=Jt(r,s);return m.useEffect(()=>{const o=s.current;if(o)return t.branches.add(o),()=>{t.branches.delete(o)}},[t.branches]),n.jsx(Pt.div,{...e,ref:a})});mA.displayName=pA;function xA(e,r=globalThis?.document){const t=Rs(e),s=m.useRef(!1),a=m.useRef(()=>{});return m.useEffect(()=>{const o=u=>{if(u.target&&!s.current){let p=function(){Lw(fA,t,h,{discrete:!0})};const h={originalEvent:u};u.pointerType==="touch"?(r.removeEventListener("click",a.current),a.current=p,r.addEventListener("click",a.current,{once:!0})):p()}else r.removeEventListener("click",a.current);s.current=!1},c=window.setTimeout(()=>{r.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(c),r.removeEventListener("pointerdown",o),r.removeEventListener("click",a.current)}},[r,t]),{onPointerDownCapture:()=>s.current=!0}}function gA(e,r=globalThis?.document){const t=Rs(e),s=m.useRef(!1);return m.useEffect(()=>{const a=o=>{o.target&&!s.current&&Lw(hA,t,{originalEvent:o},{discrete:!1})};return r.addEventListener("focusin",a),()=>r.removeEventListener("focusin",a)},[r,t]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function Hy(){const e=new CustomEvent(Xh);document.dispatchEvent(e)}function Lw(e,r,t,{discrete:s}){const a=t.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:t});r&&a.addEventListener(e,r,{once:!0}),s?J1(a,o):a.dispatchEvent(o)}var fh="focusScope.autoFocusOnMount",hh="focusScope.autoFocusOnUnmount",Gy={bubbles:!1,cancelable:!0},yA="FocusScope",xc=m.forwardRef((e,r)=>{const{loop:t=!1,trapped:s=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...c}=e,[u,p]=m.useState(null),h=Rs(a),x=Rs(o),y=m.useRef(null),v=Jt(r,w=>p(w)),k=m.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;m.useEffect(()=>{if(s){let w=function(F){if(k.paused||!u)return;const I=F.target;u.contains(I)?y.current=I:Ja(y.current,{select:!0})},j=function(F){if(k.paused||!u)return;const I=F.relatedTarget;I!==null&&(u.contains(I)||Ja(y.current,{select:!0}))},O=function(F){if(document.activeElement===document.body)for(const G of F)G.removedNodes.length>0&&Ja(u)};document.addEventListener("focusin",w),document.addEventListener("focusout",j);const T=new MutationObserver(O);return u&&T.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",w),document.removeEventListener("focusout",j),T.disconnect()}}},[s,u,k.paused]),m.useEffect(()=>{if(u){Ky.add(k);const w=document.activeElement;if(!u.contains(w)){const O=new CustomEvent(fh,Gy);u.addEventListener(fh,h),u.dispatchEvent(O),O.defaultPrevented||(vA(jA(Iw(u)),{select:!0}),document.activeElement===w&&Ja(u))}return()=>{u.removeEventListener(fh,h),setTimeout(()=>{const O=new CustomEvent(hh,Gy);u.addEventListener(hh,x),u.dispatchEvent(O),O.defaultPrevented||Ja(w??document.body,{select:!0}),u.removeEventListener(hh,x),Ky.remove(k)},0)}}},[u,h,x,k]);const b=m.useCallback(w=>{if(!t&&!s||k.paused)return;const j=w.key==="Tab"&&!w.altKey&&!w.ctrlKey&&!w.metaKey,O=document.activeElement;if(j&&O){const T=w.currentTarget,[F,I]=wA(T);F&&I?!w.shiftKey&&O===I?(w.preventDefault(),t&&Ja(F,{select:!0})):w.shiftKey&&O===F&&(w.preventDefault(),t&&Ja(I,{select:!0})):O===T&&w.preventDefault()}},[t,s,k.paused]);return n.jsx(Pt.div,{tabIndex:-1,...c,ref:v,onKeyDown:b})});xc.displayName=yA;function vA(e,{select:r=!1}={}){const t=document.activeElement;for(const s of e)if(Ja(s,{select:r}),document.activeElement!==t)return}function wA(e){const r=Iw(e),t=Yy(r,e),s=Yy(r.reverse(),e);return[t,s]}function Iw(e){const r=[],t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)r.push(t.currentNode);return r}function Yy(e,r){for(const t of e)if(!NA(t,{upTo:r}))return t}function NA(e,{upTo:r}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(r!==void 0&&e===r)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function SA(e){return e instanceof HTMLInputElement&&"select"in e}function Ja(e,{select:r=!1}={}){if(e&&e.focus){const t=document.activeElement;e.focus({preventScroll:!0}),e!==t&&SA(e)&&r&&e.select()}}var Ky=bA();function bA(){let e=[];return{add(r){const t=e[0];r!==t&&t?.pause(),e=Xy(e,r),e.unshift(r)},remove(r){e=Xy(e,r),e[0]?.resume()}}}function Xy(e,r){const t=[...e],s=t.indexOf(r);return s!==-1&&t.splice(s,1),t}function jA(e){return e.filter(r=>r.tagName!=="A")}var kA="Portal",gc=m.forwardRef((e,r)=>{const{container:t,...s}=e,[a,o]=m.useState(!1);Vr(()=>o(!0),[]);const c=t||a&&globalThis?.document?.body;return c?TC.createPortal(n.jsx(Pt.div,{...s,ref:r}),c):null});gc.displayName=kA;var ph=0;function Yu(){m.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Jy()),document.body.insertAdjacentElement("beforeend",e[1]??Jy()),ph++,()=>{ph===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),ph--}},[])}function Jy(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Ks=function(){return Ks=Object.assign||function(r){for(var t,s=1,a=arguments.length;s<a;s++){t=arguments[s];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ks.apply(this,arguments)};function Bw(e,r){var t={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)r.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(t[s[a]]=e[s[a]]);return t}function _A(e,r,t){if(t||arguments.length===2)for(var s=0,a=r.length,o;s<a;s++)(o||!(s in r))&&(o||(o=Array.prototype.slice.call(r,0,s)),o[s]=r[s]);return e.concat(o||Array.prototype.slice.call(r))}var ou="right-scroll-bar-position",lu="width-before-scroll-bar",CA="with-scroll-bars-hidden",EA="--removed-body-scroll-bar-size";function mh(e,r){return typeof e=="function"?e(r):e&&(e.current=r),e}function AA(e,r){var t=m.useState(function(){return{value:e,callback:r,facade:{get current(){return t.value},set current(s){var a=t.value;a!==s&&(t.value=s,t.callback(s,a))}}}})[0];return t.callback=r,t.facade}var TA=typeof window<"u"?m.useLayoutEffect:m.useEffect,Zy=new WeakMap;function OA(e,r){var t=AA(null,function(s){return e.forEach(function(a){return mh(a,s)})});return TA(function(){var s=Zy.get(t);if(s){var a=new Set(s),o=new Set(e),c=t.current;a.forEach(function(u){o.has(u)||mh(u,null)}),o.forEach(function(u){a.has(u)||mh(u,c)})}Zy.set(t,e)},[e]),t}function PA(e){return e}function RA(e,r){r===void 0&&(r=PA);var t=[],s=!1,a={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:e},useMedium:function(o){var c=r(o,s);return t.push(c),function(){t=t.filter(function(u){return u!==c})}},assignSyncMedium:function(o){for(s=!0;t.length;){var c=t;t=[],c.forEach(o)}t={push:function(u){return o(u)},filter:function(){return t}}},assignMedium:function(o){s=!0;var c=[];if(t.length){var u=t;t=[],u.forEach(o),c=t}var p=function(){var x=c;c=[],x.forEach(o)},h=function(){return Promise.resolve().then(p)};h(),t={push:function(x){c.push(x),h()},filter:function(x){return c=c.filter(x),t}}}};return a}function DA(e){e===void 0&&(e={});var r=RA(null);return r.options=Ks({async:!0,ssr:!1},e),r}var $w=function(e){var r=e.sideCar,t=Bw(e,["sideCar"]);if(!r)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=r.read();if(!s)throw new Error("Sidecar medium not found");return m.createElement(s,Ks({},t))};$w.isSideCarExport=!0;function FA(e,r){return e.useMedium(r),$w}var Uw=DA(),xh=function(){},Ku=m.forwardRef(function(e,r){var t=m.useRef(null),s=m.useState({onScrollCapture:xh,onWheelCapture:xh,onTouchMoveCapture:xh}),a=s[0],o=s[1],c=e.forwardProps,u=e.children,p=e.className,h=e.removeScrollBar,x=e.enabled,y=e.shards,v=e.sideCar,k=e.noRelative,b=e.noIsolation,w=e.inert,j=e.allowPinchZoom,O=e.as,T=O===void 0?"div":O,F=e.gapMode,I=Bw(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),G=v,B=OA([t,r]),Q=Ks(Ks({},I),a);return m.createElement(m.Fragment,null,x&&m.createElement(G,{sideCar:Uw,removeScrollBar:h,shards:y,noRelative:k,noIsolation:b,inert:w,setCallbacks:o,allowPinchZoom:!!j,lockRef:t,gapMode:F}),c?m.cloneElement(m.Children.only(u),Ks(Ks({},Q),{ref:B})):m.createElement(T,Ks({},Q,{className:p,ref:B}),u))});Ku.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ku.classNames={fullWidth:lu,zeroRight:ou};var MA=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function LA(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var r=MA();return r&&e.setAttribute("nonce",r),e}function IA(e,r){e.styleSheet?e.styleSheet.cssText=r:e.appendChild(document.createTextNode(r))}function BA(e){var r=document.head||document.getElementsByTagName("head")[0];r.appendChild(e)}var $A=function(){var e=0,r=null;return{add:function(t){e==0&&(r=LA())&&(IA(r,t),BA(r)),e++},remove:function(){e--,!e&&r&&(r.parentNode&&r.parentNode.removeChild(r),r=null)}}},UA=function(){var e=$A();return function(r,t){m.useEffect(function(){return e.add(r),function(){e.remove()}},[r&&t])}},zw=function(){var e=UA(),r=function(t){var s=t.styles,a=t.dynamic;return e(s,a),null};return r},zA={left:0,top:0,right:0,gap:0},gh=function(e){return parseInt(e||"",10)||0},WA=function(e){var r=window.getComputedStyle(document.body),t=r[e==="padding"?"paddingLeft":"marginLeft"],s=r[e==="padding"?"paddingTop":"marginTop"],a=r[e==="padding"?"paddingRight":"marginRight"];return[gh(t),gh(s),gh(a)]},qA=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return zA;var r=WA(e),t=document.documentElement.clientWidth,s=window.innerWidth;return{left:r[0],top:r[1],right:r[2],gap:Math.max(0,s-t+r[2]-r[0])}},VA=zw(),Co="data-scroll-locked",QA=function(e,r,t,s){var a=e.left,o=e.top,c=e.right,u=e.gap;return t===void 0&&(t="margin"),`
  .`.concat(CA,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(u,"px ").concat(s,`;
  }
  body[`).concat(Co,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([r&&"position: relative ".concat(s,";"),t==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(u,"px ").concat(s,`;
    `),t==="padding"&&"padding-right: ".concat(u,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(ou,` {
    right: `).concat(u,"px ").concat(s,`;
  }
  
  .`).concat(lu,` {
    margin-right: `).concat(u,"px ").concat(s,`;
  }
  
  .`).concat(ou," .").concat(ou,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(lu," .").concat(lu,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Co,`] {
    `).concat(EA,": ").concat(u,`px;
  }
`)},ev=function(){var e=parseInt(document.body.getAttribute(Co)||"0",10);return isFinite(e)?e:0},HA=function(){m.useEffect(function(){return document.body.setAttribute(Co,(ev()+1).toString()),function(){var e=ev()-1;e<=0?document.body.removeAttribute(Co):document.body.setAttribute(Co,e.toString())}},[])},GA=function(e){var r=e.noRelative,t=e.noImportant,s=e.gapMode,a=s===void 0?"margin":s;HA();var o=m.useMemo(function(){return qA(a)},[a]);return m.createElement(VA,{styles:QA(o,!r,a,t?"":"!important")})},Jh=!1;if(typeof window<"u")try{var Wd=Object.defineProperty({},"passive",{get:function(){return Jh=!0,!0}});window.addEventListener("test",Wd,Wd),window.removeEventListener("test",Wd,Wd)}catch{Jh=!1}var yo=Jh?{passive:!1}:!1,YA=function(e){return e.tagName==="TEXTAREA"},Ww=function(e,r){if(!(e instanceof Element))return!1;var t=window.getComputedStyle(e);return t[r]!=="hidden"&&!(t.overflowY===t.overflowX&&!YA(e)&&t[r]==="visible")},KA=function(e){return Ww(e,"overflowY")},XA=function(e){return Ww(e,"overflowX")},tv=function(e,r){var t=r.ownerDocument,s=r;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var a=qw(e,s);if(a){var o=Vw(e,s),c=o[1],u=o[2];if(c>u)return!0}s=s.parentNode}while(s&&s!==t.body);return!1},JA=function(e){var r=e.scrollTop,t=e.scrollHeight,s=e.clientHeight;return[r,t,s]},ZA=function(e){var r=e.scrollLeft,t=e.scrollWidth,s=e.clientWidth;return[r,t,s]},qw=function(e,r){return e==="v"?KA(r):XA(r)},Vw=function(e,r){return e==="v"?JA(r):ZA(r)},eT=function(e,r){return e==="h"&&r==="rtl"?-1:1},tT=function(e,r,t,s,a){var o=eT(e,window.getComputedStyle(r).direction),c=o*s,u=t.target,p=r.contains(u),h=!1,x=c>0,y=0,v=0;do{if(!u)break;var k=Vw(e,u),b=k[0],w=k[1],j=k[2],O=w-j-o*b;(b||O)&&qw(e,u)&&(y+=O,v+=b);var T=u.parentNode;u=T&&T.nodeType===Node.DOCUMENT_FRAGMENT_NODE?T.host:T}while(!p&&u!==document.body||p&&(r.contains(u)||r===u));return(x&&Math.abs(y)<1||!x&&Math.abs(v)<1)&&(h=!0),h},qd=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},rv=function(e){return[e.deltaX,e.deltaY]},nv=function(e){return e&&"current"in e?e.current:e},rT=function(e,r){return e[0]===r[0]&&e[1]===r[1]},nT=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},sT=0,vo=[];function aT(e){var r=m.useRef([]),t=m.useRef([0,0]),s=m.useRef(),a=m.useState(sT++)[0],o=m.useState(zw)[0],c=m.useRef(e);m.useEffect(function(){c.current=e},[e]),m.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var w=_A([e.lockRef.current],(e.shards||[]).map(nv),!0).filter(Boolean);return w.forEach(function(j){return j.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),w.forEach(function(j){return j.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var u=m.useCallback(function(w,j){if("touches"in w&&w.touches.length===2||w.type==="wheel"&&w.ctrlKey)return!c.current.allowPinchZoom;var O=qd(w),T=t.current,F="deltaX"in w?w.deltaX:T[0]-O[0],I="deltaY"in w?w.deltaY:T[1]-O[1],G,B=w.target,Q=Math.abs(F)>Math.abs(I)?"h":"v";if("touches"in w&&Q==="h"&&B.type==="range")return!1;var z=tv(Q,B);if(!z)return!0;if(z?G=Q:(G=Q==="v"?"h":"v",z=tv(Q,B)),!z)return!1;if(!s.current&&"changedTouches"in w&&(F||I)&&(s.current=G),!G)return!0;var J=s.current||G;return tT(J,j,w,J==="h"?F:I)},[]),p=m.useCallback(function(w){var j=w;if(!(!vo.length||vo[vo.length-1]!==o)){var O="deltaY"in j?rv(j):qd(j),T=r.current.filter(function(G){return G.name===j.type&&(G.target===j.target||j.target===G.shadowParent)&&rT(G.delta,O)})[0];if(T&&T.should){j.cancelable&&j.preventDefault();return}if(!T){var F=(c.current.shards||[]).map(nv).filter(Boolean).filter(function(G){return G.contains(j.target)}),I=F.length>0?u(j,F[0]):!c.current.noIsolation;I&&j.cancelable&&j.preventDefault()}}},[]),h=m.useCallback(function(w,j,O,T){var F={name:w,delta:j,target:O,should:T,shadowParent:iT(O)};r.current.push(F),setTimeout(function(){r.current=r.current.filter(function(I){return I!==F})},1)},[]),x=m.useCallback(function(w){t.current=qd(w),s.current=void 0},[]),y=m.useCallback(function(w){h(w.type,rv(w),w.target,u(w,e.lockRef.current))},[]),v=m.useCallback(function(w){h(w.type,qd(w),w.target,u(w,e.lockRef.current))},[]);m.useEffect(function(){return vo.push(o),e.setCallbacks({onScrollCapture:y,onWheelCapture:y,onTouchMoveCapture:v}),document.addEventListener("wheel",p,yo),document.addEventListener("touchmove",p,yo),document.addEventListener("touchstart",x,yo),function(){vo=vo.filter(function(w){return w!==o}),document.removeEventListener("wheel",p,yo),document.removeEventListener("touchmove",p,yo),document.removeEventListener("touchstart",x,yo)}},[]);var k=e.removeScrollBar,b=e.inert;return m.createElement(m.Fragment,null,b?m.createElement(o,{styles:nT(a)}):null,k?m.createElement(GA,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function iT(e){for(var r=null;e!==null;)e instanceof ShadowRoot&&(r=e.host,e=e.host),e=e.parentNode;return r}const oT=FA(Uw,aT);var yc=m.forwardRef(function(e,r){return m.createElement(Ku,Ks({},e,{ref:r,sideCar:oT}))});yc.classNames=Ku.classNames;var lT=function(e){if(typeof document>"u")return null;var r=Array.isArray(e)?e[0]:e;return r.ownerDocument.body},wo=new WeakMap,Vd=new WeakMap,Qd={},yh=0,Qw=function(e){return e&&(e.host||Qw(e.parentNode))},cT=function(e,r){return r.map(function(t){if(e.contains(t))return t;var s=Qw(t);return s&&e.contains(s)?s:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)}).filter(function(t){return!!t})},dT=function(e,r,t,s){var a=cT(r,Array.isArray(e)?e:[e]);Qd[t]||(Qd[t]=new WeakMap);var o=Qd[t],c=[],u=new Set,p=new Set(a),h=function(y){!y||u.has(y)||(u.add(y),h(y.parentNode))};a.forEach(h);var x=function(y){!y||p.has(y)||Array.prototype.forEach.call(y.children,function(v){if(u.has(v))x(v);else try{var k=v.getAttribute(s),b=k!==null&&k!=="false",w=(wo.get(v)||0)+1,j=(o.get(v)||0)+1;wo.set(v,w),o.set(v,j),c.push(v),w===1&&b&&Vd.set(v,!0),j===1&&v.setAttribute(t,"true"),b||v.setAttribute(s,"true")}catch(O){console.error("aria-hidden: cannot operate on ",v,O)}})};return x(r),u.clear(),yh++,function(){c.forEach(function(y){var v=wo.get(y)-1,k=o.get(y)-1;wo.set(y,v),o.set(y,k),v||(Vd.has(y)||y.removeAttribute(s),Vd.delete(y)),k||y.removeAttribute(t)}),yh--,yh||(wo=new WeakMap,wo=new WeakMap,Vd=new WeakMap,Qd={})}},Xu=function(e,r,t){t===void 0&&(t="data-aria-hidden");var s=Array.from(Array.isArray(e)?e:[e]),a=lT(e);return a?(s.push.apply(s,Array.from(a.querySelectorAll("[aria-live], script"))),dT(s,a,t,"aria-hidden")):function(){return null}};function uT(e){const r=fT(e),t=m.forwardRef((s,a)=>{const{children:o,...c}=s,u=m.Children.toArray(o),p=u.find(pT);if(p){const h=p.props.children,x=u.map(y=>y===p?m.Children.count(h)>1?m.Children.only(null):m.isValidElement(h)?h.props.children:null:y);return n.jsx(r,{...c,ref:a,children:m.isValidElement(h)?m.cloneElement(h,void 0,x):null})}return n.jsx(r,{...c,ref:a,children:o})});return t.displayName=`${e}.Slot`,t}function fT(e){const r=m.forwardRef((t,s)=>{const{children:a,...o}=t;if(m.isValidElement(a)){const c=xT(a),u=mT(o,a.props);return a.type!==m.Fragment&&(u.ref=s?aa(s,c):c),m.cloneElement(a,u)}return m.Children.count(a)>1?m.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var hT=Symbol("radix.slottable");function pT(e){return m.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===hT}function mT(e,r){const t={...r};for(const s in r){const a=e[s],o=r[s];/^on[A-Z]/.test(s)?a&&o?t[s]=(...u)=>{const p=o(...u);return a(...u),p}:a&&(t[s]=a):s==="style"?t[s]={...a,...o}:s==="className"&&(t[s]=[a,o].filter(Boolean).join(" "))}return{...e,...t}}function xT(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}var Ju="Dialog",[Hw]=_a(Ju),[gT,Us]=Hw(Ju),Gw=e=>{const{__scopeDialog:r,children:t,open:s,defaultOpen:a,onOpenChange:o,modal:c=!0}=e,u=m.useRef(null),p=m.useRef(null),[h,x]=Oi({prop:s,defaultProp:a??!1,onChange:o,caller:Ju});return n.jsx(gT,{scope:r,triggerRef:u,contentRef:p,contentId:Zs(),titleId:Zs(),descriptionId:Zs(),open:h,onOpenChange:x,onOpenToggle:m.useCallback(()=>x(y=>!y),[x]),modal:c,children:t})};Gw.displayName=Ju;var Yw="DialogTrigger",yT=m.forwardRef((e,r)=>{const{__scopeDialog:t,...s}=e,a=Us(Yw,t),o=Jt(r,a.triggerRef);return n.jsx(Pt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Dp(a.open),...s,ref:o,onClick:ct(e.onClick,a.onOpenToggle)})});yT.displayName=Yw;var Pp="DialogPortal",[vT,Kw]=Hw(Pp,{forceMount:void 0}),Xw=e=>{const{__scopeDialog:r,forceMount:t,children:s,container:a}=e,o=Us(Pp,r);return n.jsx(vT,{scope:r,forceMount:t,children:m.Children.map(s,c=>n.jsx(Bs,{present:t||o.open,children:n.jsx(gc,{asChild:!0,container:a,children:c})}))})};Xw.displayName=Pp;var mu="DialogOverlay",Jw=m.forwardRef((e,r)=>{const t=Kw(mu,e.__scopeDialog),{forceMount:s=t.forceMount,...a}=e,o=Us(mu,e.__scopeDialog);return o.modal?n.jsx(Bs,{present:s||o.open,children:n.jsx(NT,{...a,ref:r})}):null});Jw.displayName=mu;var wT=uT("DialogOverlay.RemoveScroll"),NT=m.forwardRef((e,r)=>{const{__scopeDialog:t,...s}=e,a=Us(mu,t);return n.jsx(yc,{as:wT,allowPinchZoom:!0,shards:[a.contentRef],children:n.jsx(Pt.div,{"data-state":Dp(a.open),...s,ref:r,style:{pointerEvents:"auto",...s.style}})})}),Ri="DialogContent",Zw=m.forwardRef((e,r)=>{const t=Kw(Ri,e.__scopeDialog),{forceMount:s=t.forceMount,...a}=e,o=Us(Ri,e.__scopeDialog);return n.jsx(Bs,{present:s||o.open,children:o.modal?n.jsx(ST,{...a,ref:r}):n.jsx(bT,{...a,ref:r})})});Zw.displayName=Ri;var ST=m.forwardRef((e,r)=>{const t=Us(Ri,e.__scopeDialog),s=m.useRef(null),a=Jt(r,t.contentRef,s);return m.useEffect(()=>{const o=s.current;if(o)return Xu(o)},[]),n.jsx(e2,{...e,ref:a,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ct(e.onCloseAutoFocus,o=>{o.preventDefault(),t.triggerRef.current?.focus()}),onPointerDownOutside:ct(e.onPointerDownOutside,o=>{const c=o.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0;(c.button===2||u)&&o.preventDefault()}),onFocusOutside:ct(e.onFocusOutside,o=>o.preventDefault())})}),bT=m.forwardRef((e,r)=>{const t=Us(Ri,e.__scopeDialog),s=m.useRef(!1),a=m.useRef(!1);return n.jsx(e2,{...e,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{e.onCloseAutoFocus?.(o),o.defaultPrevented||(s.current||t.triggerRef.current?.focus(),o.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:o=>{e.onInteractOutside?.(o),o.defaultPrevented||(s.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const c=o.target;t.triggerRef.current?.contains(c)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),e2=m.forwardRef((e,r)=>{const{__scopeDialog:t,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:o,...c}=e,u=Us(Ri,t),p=m.useRef(null),h=Jt(r,p);return Yu(),n.jsxs(n.Fragment,{children:[n.jsx(xc,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:o,children:n.jsx(mc,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":Dp(u.open),...c,ref:h,onDismiss:()=>u.onOpenChange(!1)})}),n.jsxs(n.Fragment,{children:[n.jsx(jT,{titleId:u.titleId}),n.jsx(_T,{contentRef:p,descriptionId:u.descriptionId})]})]})}),Rp="DialogTitle",t2=m.forwardRef((e,r)=>{const{__scopeDialog:t,...s}=e,a=Us(Rp,t);return n.jsx(Pt.h2,{id:a.titleId,...s,ref:r})});t2.displayName=Rp;var r2="DialogDescription",n2=m.forwardRef((e,r)=>{const{__scopeDialog:t,...s}=e,a=Us(r2,t);return n.jsx(Pt.p,{id:a.descriptionId,...s,ref:r})});n2.displayName=r2;var s2="DialogClose",a2=m.forwardRef((e,r)=>{const{__scopeDialog:t,...s}=e,a=Us(s2,t);return n.jsx(Pt.button,{type:"button",...s,ref:r,onClick:ct(e.onClick,()=>a.onOpenChange(!1))})});a2.displayName=s2;function Dp(e){return e?"open":"closed"}var i2="DialogTitleWarning",[SU,o2]=NE(i2,{contentName:Ri,titleName:Rp,docsSlug:"dialog"}),jT=({titleId:e})=>{const r=o2(i2),t=`\`${r.contentName}\` requires a \`${r.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${r.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${r.docsSlug}`;return m.useEffect(()=>{e&&(document.getElementById(e)||console.error(t))},[t,e]),null},kT="DialogDescriptionWarning",_T=({contentRef:e,descriptionId:r})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${o2(kT).contentName}}.`;return m.useEffect(()=>{const a=e.current?.getAttribute("aria-describedby");r&&a&&(document.getElementById(r)||console.warn(s))},[s,e,r]),null},CT=Gw,ET=Xw,l2=Jw,c2=Zw,AT=t2,TT=n2,OT=a2;function xt({...e}){return n.jsx(CT,{"data-slot":"dialog",...e})}function PT({...e}){return n.jsx(ET,{"data-slot":"dialog-portal",...e})}const d2=m.forwardRef(({className:e,...r},t)=>n.jsx(l2,{ref:t,"data-slot":"dialog-overlay",className:sr("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...r}));d2.displayName=l2.displayName;const mt=m.forwardRef(({className:e,children:r,...t},s)=>n.jsxs(PT,{"data-slot":"dialog-portal",children:[n.jsx(d2,{}),n.jsxs(c2,{ref:s,"data-slot":"dialog-content",className:sr("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...t,children:[r,n.jsxs(OT,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[n.jsx(hu,{}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));mt.displayName=c2.displayName;function gt({className:e,...r}){return n.jsx("div",{"data-slot":"dialog-header",className:sr("flex flex-col gap-2 text-center sm:text-left",e),...r})}function yt({className:e,...r}){return n.jsx(AT,{"data-slot":"dialog-title",className:sr("text-lg leading-none font-semibold",e),...r})}function vt({className:e,...r}){return n.jsx(TT,{"data-slot":"dialog-description",className:sr("text-muted-foreground text-sm",e),...r})}function Gn({className:e,...r}){return n.jsx("textarea",{"data-slot":"textarea",className:sr("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...r})}var RT=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],DT=RT.reduce((e,r)=>{const t=jp(`Primitive.${r}`),s=m.forwardRef((a,o)=>{const{asChild:c,...u}=a,p=c?t:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),n.jsx(p,{...u,ref:o})});return s.displayName=`Primitive.${r}`,{...e,[r]:s}},{}),FT="Label",u2=m.forwardRef((e,r)=>n.jsx(DT.label,{...e,ref:r,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));u2.displayName=FT;var MT=u2;function R({className:e,...r}){return n.jsx(MT,{"data-slot":"label",className:sr("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...r})}function sv(e,[r,t]){return Math.min(t,Math.max(r,e))}function av(e){const r=LT(e),t=m.forwardRef((s,a)=>{const{children:o,...c}=s,u=m.Children.toArray(o),p=u.find(BT);if(p){const h=p.props.children,x=u.map(y=>y===p?m.Children.count(h)>1?m.Children.only(null):m.isValidElement(h)?h.props.children:null:y);return n.jsx(r,{...c,ref:a,children:m.isValidElement(h)?m.cloneElement(h,void 0,x):null})}return n.jsx(r,{...c,ref:a,children:o})});return t.displayName=`${e}.Slot`,t}function LT(e){const r=m.forwardRef((t,s)=>{const{children:a,...o}=t;if(m.isValidElement(a)){const c=UT(a),u=$T(o,a.props);return a.type!==m.Fragment&&(u.ref=s?aa(s,c):c),m.cloneElement(a,u)}return m.Children.count(a)>1?m.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var IT=Symbol("radix.slottable");function BT(e){return m.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===IT}function $T(e,r){const t={...r};for(const s in r){const a=e[s],o=r[s];/^on[A-Z]/.test(s)?a&&o?t[s]=(...u)=>{const p=o(...u);return a(...u),p}:a&&(t[s]=a):s==="style"?t[s]={...a,...o}:s==="className"&&(t[s]=[a,o].filter(Boolean).join(" "))}return{...e,...t}}function UT(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}function Fp(e){const r=e+"CollectionProvider",[t,s]=_a(r),[a,o]=t(r,{collectionRef:{current:null},itemMap:new Map}),c=w=>{const{scope:j,children:O}=w,T=Xa.useRef(null),F=Xa.useRef(new Map).current;return n.jsx(a,{scope:j,itemMap:F,collectionRef:T,children:O})};c.displayName=r;const u=e+"CollectionSlot",p=av(u),h=Xa.forwardRef((w,j)=>{const{scope:O,children:T}=w,F=o(u,O),I=Jt(j,F.collectionRef);return n.jsx(p,{ref:I,children:T})});h.displayName=u;const x=e+"CollectionItemSlot",y="data-radix-collection-item",v=av(x),k=Xa.forwardRef((w,j)=>{const{scope:O,children:T,...F}=w,I=Xa.useRef(null),G=Jt(j,I),B=o(x,O);return Xa.useEffect(()=>(B.itemMap.set(I,{ref:I,...F}),()=>void B.itemMap.delete(I))),n.jsx(v,{[y]:"",ref:G,children:T})});k.displayName=x;function b(w){const j=o(e+"CollectionConsumer",w);return Xa.useCallback(()=>{const T=j.collectionRef.current;if(!T)return[];const F=Array.from(T.querySelectorAll(`[${y}]`));return Array.from(j.itemMap.values()).sort((B,Q)=>F.indexOf(B.ref.current)-F.indexOf(Q.ref.current))},[j.collectionRef,j.itemMap])}return[{Provider:c,Slot:h,ItemSlot:k},b,s]}var zT=m.createContext(void 0);function Mp(e){const r=m.useContext(zT);return e||r||"ltr"}const WT=["top","right","bottom","left"],ri=Math.min,ns=Math.max,xu=Math.round,Hd=Math.floor,ea=e=>({x:e,y:e}),qT={left:"right",right:"left",bottom:"top",top:"bottom"},VT={start:"end",end:"start"};function Zh(e,r,t){return ns(e,ri(r,t))}function Sa(e,r){return typeof e=="function"?e(r):e}function ba(e){return e.split("-")[0]}function Vo(e){return e.split("-")[1]}function Lp(e){return e==="x"?"y":"x"}function Ip(e){return e==="y"?"height":"width"}const QT=new Set(["top","bottom"]);function Xs(e){return QT.has(ba(e))?"y":"x"}function Bp(e){return Lp(Xs(e))}function HT(e,r,t){t===void 0&&(t=!1);const s=Vo(e),a=Bp(e),o=Ip(a);let c=a==="x"?s===(t?"end":"start")?"right":"left":s==="start"?"bottom":"top";return r.reference[o]>r.floating[o]&&(c=gu(c)),[c,gu(c)]}function GT(e){const r=gu(e);return[ep(e),r,ep(r)]}function ep(e){return e.replace(/start|end/g,r=>VT[r])}const iv=["left","right"],ov=["right","left"],YT=["top","bottom"],KT=["bottom","top"];function XT(e,r,t){switch(e){case"top":case"bottom":return t?r?ov:iv:r?iv:ov;case"left":case"right":return r?YT:KT;default:return[]}}function JT(e,r,t,s){const a=Vo(e);let o=XT(ba(e),t==="start",s);return a&&(o=o.map(c=>c+"-"+a),r&&(o=o.concat(o.map(ep)))),o}function gu(e){return e.replace(/left|right|bottom|top/g,r=>qT[r])}function ZT(e){return{top:0,right:0,bottom:0,left:0,...e}}function f2(e){return typeof e!="number"?ZT(e):{top:e,right:e,bottom:e,left:e}}function yu(e){const{x:r,y:t,width:s,height:a}=e;return{width:s,height:a,top:t,left:r,right:r+s,bottom:t+a,x:r,y:t}}function lv(e,r,t){let{reference:s,floating:a}=e;const o=Xs(r),c=Bp(r),u=Ip(c),p=ba(r),h=o==="y",x=s.x+s.width/2-a.width/2,y=s.y+s.height/2-a.height/2,v=s[u]/2-a[u]/2;let k;switch(p){case"top":k={x,y:s.y-a.height};break;case"bottom":k={x,y:s.y+s.height};break;case"right":k={x:s.x+s.width,y};break;case"left":k={x:s.x-a.width,y};break;default:k={x:s.x,y:s.y}}switch(Vo(r)){case"start":k[c]-=v*(t&&h?-1:1);break;case"end":k[c]+=v*(t&&h?-1:1);break}return k}const eO=async(e,r,t)=>{const{placement:s="bottom",strategy:a="absolute",middleware:o=[],platform:c}=t,u=o.filter(Boolean),p=await(c.isRTL==null?void 0:c.isRTL(r));let h=await c.getElementRects({reference:e,floating:r,strategy:a}),{x,y}=lv(h,s,p),v=s,k={},b=0;for(let w=0;w<u.length;w++){const{name:j,fn:O}=u[w],{x:T,y:F,data:I,reset:G}=await O({x,y,initialPlacement:s,placement:v,strategy:a,middlewareData:k,rects:h,platform:c,elements:{reference:e,floating:r}});x=T??x,y=F??y,k={...k,[j]:{...k[j],...I}},G&&b<=50&&(b++,typeof G=="object"&&(G.placement&&(v=G.placement),G.rects&&(h=G.rects===!0?await c.getElementRects({reference:e,floating:r,strategy:a}):G.rects),{x,y}=lv(h,v,p)),w=-1)}return{x,y,placement:v,strategy:a,middlewareData:k}};async function Kl(e,r){var t;r===void 0&&(r={});const{x:s,y:a,platform:o,rects:c,elements:u,strategy:p}=e,{boundary:h="clippingAncestors",rootBoundary:x="viewport",elementContext:y="floating",altBoundary:v=!1,padding:k=0}=Sa(r,e),b=f2(k),j=u[v?y==="floating"?"reference":"floating":y],O=yu(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(j)))==null||t?j:j.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(u.floating)),boundary:h,rootBoundary:x,strategy:p})),T=y==="floating"?{x:s,y:a,width:c.floating.width,height:c.floating.height}:c.reference,F=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u.floating)),I=await(o.isElement==null?void 0:o.isElement(F))?await(o.getScale==null?void 0:o.getScale(F))||{x:1,y:1}:{x:1,y:1},G=yu(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:T,offsetParent:F,strategy:p}):T);return{top:(O.top-G.top+b.top)/I.y,bottom:(G.bottom-O.bottom+b.bottom)/I.y,left:(O.left-G.left+b.left)/I.x,right:(G.right-O.right+b.right)/I.x}}const tO=e=>({name:"arrow",options:e,async fn(r){const{x:t,y:s,placement:a,rects:o,platform:c,elements:u,middlewareData:p}=r,{element:h,padding:x=0}=Sa(e,r)||{};if(h==null)return{};const y=f2(x),v={x:t,y:s},k=Bp(a),b=Ip(k),w=await c.getDimensions(h),j=k==="y",O=j?"top":"left",T=j?"bottom":"right",F=j?"clientHeight":"clientWidth",I=o.reference[b]+o.reference[k]-v[k]-o.floating[b],G=v[k]-o.reference[k],B=await(c.getOffsetParent==null?void 0:c.getOffsetParent(h));let Q=B?B[F]:0;(!Q||!await(c.isElement==null?void 0:c.isElement(B)))&&(Q=u.floating[F]||o.floating[b]);const z=I/2-G/2,J=Q/2-w[b]/2-1,ne=ri(y[O],J),fe=ri(y[T],J),me=ne,le=Q-w[b]-fe,K=Q/2-w[b]/2+z,Fe=Zh(me,K,le),we=!p.arrow&&Vo(a)!=null&&K!==Fe&&o.reference[b]/2-(K<me?ne:fe)-w[b]/2<0,oe=we?K<me?K-me:K-le:0;return{[k]:v[k]+oe,data:{[k]:Fe,centerOffset:K-Fe-oe,...we&&{alignmentOffset:oe}},reset:we}}}),rO=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(r){var t,s;const{placement:a,middlewareData:o,rects:c,initialPlacement:u,platform:p,elements:h}=r,{mainAxis:x=!0,crossAxis:y=!0,fallbackPlacements:v,fallbackStrategy:k="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:w=!0,...j}=Sa(e,r);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const O=ba(a),T=Xs(u),F=ba(u)===u,I=await(p.isRTL==null?void 0:p.isRTL(h.floating)),G=v||(F||!w?[gu(u)]:GT(u)),B=b!=="none";!v&&B&&G.push(...JT(u,w,b,I));const Q=[u,...G],z=await Kl(r,j),J=[];let ne=((s=o.flip)==null?void 0:s.overflows)||[];if(x&&J.push(z[O]),y){const K=HT(a,c,I);J.push(z[K[0]],z[K[1]])}if(ne=[...ne,{placement:a,overflows:J}],!J.every(K=>K<=0)){var fe,me;const K=(((fe=o.flip)==null?void 0:fe.index)||0)+1,Fe=Q[K];if(Fe&&(!(y==="alignment"?T!==Xs(Fe):!1)||ne.every(V=>Xs(V.placement)===T?V.overflows[0]>0:!0)))return{data:{index:K,overflows:ne},reset:{placement:Fe}};let we=(me=ne.filter(oe=>oe.overflows[0]<=0).sort((oe,V)=>oe.overflows[1]-V.overflows[1])[0])==null?void 0:me.placement;if(!we)switch(k){case"bestFit":{var le;const oe=(le=ne.filter(V=>{if(B){const de=Xs(V.placement);return de===T||de==="y"}return!0}).map(V=>[V.placement,V.overflows.filter(de=>de>0).reduce((de,Ne)=>de+Ne,0)]).sort((V,de)=>V[1]-de[1])[0])==null?void 0:le[0];oe&&(we=oe);break}case"initialPlacement":we=u;break}if(a!==we)return{reset:{placement:we}}}return{}}}};function cv(e,r){return{top:e.top-r.height,right:e.right-r.width,bottom:e.bottom-r.height,left:e.left-r.width}}function dv(e){return WT.some(r=>e[r]>=0)}const nO=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(r){const{rects:t}=r,{strategy:s="referenceHidden",...a}=Sa(e,r);switch(s){case"referenceHidden":{const o=await Kl(r,{...a,elementContext:"reference"}),c=cv(o,t.reference);return{data:{referenceHiddenOffsets:c,referenceHidden:dv(c)}}}case"escaped":{const o=await Kl(r,{...a,altBoundary:!0}),c=cv(o,t.floating);return{data:{escapedOffsets:c,escaped:dv(c)}}}default:return{}}}}},h2=new Set(["left","top"]);async function sO(e,r){const{placement:t,platform:s,elements:a}=e,o=await(s.isRTL==null?void 0:s.isRTL(a.floating)),c=ba(t),u=Vo(t),p=Xs(t)==="y",h=h2.has(c)?-1:1,x=o&&p?-1:1,y=Sa(r,e);let{mainAxis:v,crossAxis:k,alignmentAxis:b}=typeof y=="number"?{mainAxis:y,crossAxis:0,alignmentAxis:null}:{mainAxis:y.mainAxis||0,crossAxis:y.crossAxis||0,alignmentAxis:y.alignmentAxis};return u&&typeof b=="number"&&(k=u==="end"?b*-1:b),p?{x:k*x,y:v*h}:{x:v*h,y:k*x}}const aO=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(r){var t,s;const{x:a,y:o,placement:c,middlewareData:u}=r,p=await sO(r,e);return c===((t=u.offset)==null?void 0:t.placement)&&(s=u.arrow)!=null&&s.alignmentOffset?{}:{x:a+p.x,y:o+p.y,data:{...p,placement:c}}}}},iO=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(r){const{x:t,y:s,placement:a}=r,{mainAxis:o=!0,crossAxis:c=!1,limiter:u={fn:j=>{let{x:O,y:T}=j;return{x:O,y:T}}},...p}=Sa(e,r),h={x:t,y:s},x=await Kl(r,p),y=Xs(ba(a)),v=Lp(y);let k=h[v],b=h[y];if(o){const j=v==="y"?"top":"left",O=v==="y"?"bottom":"right",T=k+x[j],F=k-x[O];k=Zh(T,k,F)}if(c){const j=y==="y"?"top":"left",O=y==="y"?"bottom":"right",T=b+x[j],F=b-x[O];b=Zh(T,b,F)}const w=u.fn({...r,[v]:k,[y]:b});return{...w,data:{x:w.x-t,y:w.y-s,enabled:{[v]:o,[y]:c}}}}}},oO=function(e){return e===void 0&&(e={}),{options:e,fn(r){const{x:t,y:s,placement:a,rects:o,middlewareData:c}=r,{offset:u=0,mainAxis:p=!0,crossAxis:h=!0}=Sa(e,r),x={x:t,y:s},y=Xs(a),v=Lp(y);let k=x[v],b=x[y];const w=Sa(u,r),j=typeof w=="number"?{mainAxis:w,crossAxis:0}:{mainAxis:0,crossAxis:0,...w};if(p){const F=v==="y"?"height":"width",I=o.reference[v]-o.floating[F]+j.mainAxis,G=o.reference[v]+o.reference[F]-j.mainAxis;k<I?k=I:k>G&&(k=G)}if(h){var O,T;const F=v==="y"?"width":"height",I=h2.has(ba(a)),G=o.reference[y]-o.floating[F]+(I&&((O=c.offset)==null?void 0:O[y])||0)+(I?0:j.crossAxis),B=o.reference[y]+o.reference[F]+(I?0:((T=c.offset)==null?void 0:T[y])||0)-(I?j.crossAxis:0);b<G?b=G:b>B&&(b=B)}return{[v]:k,[y]:b}}}},lO=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(r){var t,s;const{placement:a,rects:o,platform:c,elements:u}=r,{apply:p=()=>{},...h}=Sa(e,r),x=await Kl(r,h),y=ba(a),v=Vo(a),k=Xs(a)==="y",{width:b,height:w}=o.floating;let j,O;y==="top"||y==="bottom"?(j=y,O=v===(await(c.isRTL==null?void 0:c.isRTL(u.floating))?"start":"end")?"left":"right"):(O=y,j=v==="end"?"top":"bottom");const T=w-x.top-x.bottom,F=b-x.left-x.right,I=ri(w-x[j],T),G=ri(b-x[O],F),B=!r.middlewareData.shift;let Q=I,z=G;if((t=r.middlewareData.shift)!=null&&t.enabled.x&&(z=F),(s=r.middlewareData.shift)!=null&&s.enabled.y&&(Q=T),B&&!v){const ne=ns(x.left,0),fe=ns(x.right,0),me=ns(x.top,0),le=ns(x.bottom,0);k?z=b-2*(ne!==0||fe!==0?ne+fe:ns(x.left,x.right)):Q=w-2*(me!==0||le!==0?me+le:ns(x.top,x.bottom))}await p({...r,availableWidth:z,availableHeight:Q});const J=await c.getDimensions(u.floating);return b!==J.width||w!==J.height?{reset:{rects:!0}}:{}}}};function Zu(){return typeof window<"u"}function Qo(e){return p2(e)?(e.nodeName||"").toLowerCase():"#document"}function is(e){var r;return(e==null||(r=e.ownerDocument)==null?void 0:r.defaultView)||window}function ia(e){var r;return(r=(p2(e)?e.ownerDocument:e.document)||window.document)==null?void 0:r.documentElement}function p2(e){return Zu()?e instanceof Node||e instanceof is(e).Node:!1}function Ds(e){return Zu()?e instanceof Element||e instanceof is(e).Element:!1}function ta(e){return Zu()?e instanceof HTMLElement||e instanceof is(e).HTMLElement:!1}function uv(e){return!Zu()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof is(e).ShadowRoot}const cO=new Set(["inline","contents"]);function vc(e){const{overflow:r,overflowX:t,overflowY:s,display:a}=Fs(e);return/auto|scroll|overlay|hidden|clip/.test(r+s+t)&&!cO.has(a)}const dO=new Set(["table","td","th"]);function uO(e){return dO.has(Qo(e))}const fO=[":popover-open",":modal"];function e0(e){return fO.some(r=>{try{return e.matches(r)}catch{return!1}})}const hO=["transform","translate","scale","rotate","perspective"],pO=["transform","translate","scale","rotate","perspective","filter"],mO=["paint","layout","strict","content"];function $p(e){const r=Up(),t=Ds(e)?Fs(e):e;return hO.some(s=>t[s]?t[s]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!r&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!r&&(t.filter?t.filter!=="none":!1)||pO.some(s=>(t.willChange||"").includes(s))||mO.some(s=>(t.contain||"").includes(s))}function xO(e){let r=ni(e);for(;ta(r)&&!Do(r);){if($p(r))return r;if(e0(r))return null;r=ni(r)}return null}function Up(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const gO=new Set(["html","body","#document"]);function Do(e){return gO.has(Qo(e))}function Fs(e){return is(e).getComputedStyle(e)}function t0(e){return Ds(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function ni(e){if(Qo(e)==="html")return e;const r=e.assignedSlot||e.parentNode||uv(e)&&e.host||ia(e);return uv(r)?r.host:r}function m2(e){const r=ni(e);return Do(r)?e.ownerDocument?e.ownerDocument.body:e.body:ta(r)&&vc(r)?r:m2(r)}function Xl(e,r,t){var s;r===void 0&&(r=[]),t===void 0&&(t=!0);const a=m2(e),o=a===((s=e.ownerDocument)==null?void 0:s.body),c=is(a);if(o){const u=tp(c);return r.concat(c,c.visualViewport||[],vc(a)?a:[],u&&t?Xl(u):[])}return r.concat(a,Xl(a,[],t))}function tp(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function x2(e){const r=Fs(e);let t=parseFloat(r.width)||0,s=parseFloat(r.height)||0;const a=ta(e),o=a?e.offsetWidth:t,c=a?e.offsetHeight:s,u=xu(t)!==o||xu(s)!==c;return u&&(t=o,s=c),{width:t,height:s,$:u}}function zp(e){return Ds(e)?e:e.contextElement}function Eo(e){const r=zp(e);if(!ta(r))return ea(1);const t=r.getBoundingClientRect(),{width:s,height:a,$:o}=x2(r);let c=(o?xu(t.width):t.width)/s,u=(o?xu(t.height):t.height)/a;return(!c||!Number.isFinite(c))&&(c=1),(!u||!Number.isFinite(u))&&(u=1),{x:c,y:u}}const yO=ea(0);function g2(e){const r=is(e);return!Up()||!r.visualViewport?yO:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function vO(e,r,t){return r===void 0&&(r=!1),!t||r&&t!==is(e)?!1:r}function Di(e,r,t,s){r===void 0&&(r=!1),t===void 0&&(t=!1);const a=e.getBoundingClientRect(),o=zp(e);let c=ea(1);r&&(s?Ds(s)&&(c=Eo(s)):c=Eo(e));const u=vO(o,t,s)?g2(o):ea(0);let p=(a.left+u.x)/c.x,h=(a.top+u.y)/c.y,x=a.width/c.x,y=a.height/c.y;if(o){const v=is(o),k=s&&Ds(s)?is(s):s;let b=v,w=tp(b);for(;w&&s&&k!==b;){const j=Eo(w),O=w.getBoundingClientRect(),T=Fs(w),F=O.left+(w.clientLeft+parseFloat(T.paddingLeft))*j.x,I=O.top+(w.clientTop+parseFloat(T.paddingTop))*j.y;p*=j.x,h*=j.y,x*=j.x,y*=j.y,p+=F,h+=I,b=is(w),w=tp(b)}}return yu({width:x,height:y,x:p,y:h})}function r0(e,r){const t=t0(e).scrollLeft;return r?r.left+t:Di(ia(e)).left+t}function y2(e,r){const t=e.getBoundingClientRect(),s=t.left+r.scrollLeft-r0(e,t),a=t.top+r.scrollTop;return{x:s,y:a}}function wO(e){let{elements:r,rect:t,offsetParent:s,strategy:a}=e;const o=a==="fixed",c=ia(s),u=r?e0(r.floating):!1;if(s===c||u&&o)return t;let p={scrollLeft:0,scrollTop:0},h=ea(1);const x=ea(0),y=ta(s);if((y||!y&&!o)&&((Qo(s)!=="body"||vc(c))&&(p=t0(s)),ta(s))){const k=Di(s);h=Eo(s),x.x=k.x+s.clientLeft,x.y=k.y+s.clientTop}const v=c&&!y&&!o?y2(c,p):ea(0);return{width:t.width*h.x,height:t.height*h.y,x:t.x*h.x-p.scrollLeft*h.x+x.x+v.x,y:t.y*h.y-p.scrollTop*h.y+x.y+v.y}}function NO(e){return Array.from(e.getClientRects())}function SO(e){const r=ia(e),t=t0(e),s=e.ownerDocument.body,a=ns(r.scrollWidth,r.clientWidth,s.scrollWidth,s.clientWidth),o=ns(r.scrollHeight,r.clientHeight,s.scrollHeight,s.clientHeight);let c=-t.scrollLeft+r0(e);const u=-t.scrollTop;return Fs(s).direction==="rtl"&&(c+=ns(r.clientWidth,s.clientWidth)-a),{width:a,height:o,x:c,y:u}}const fv=25;function bO(e,r){const t=is(e),s=ia(e),a=t.visualViewport;let o=s.clientWidth,c=s.clientHeight,u=0,p=0;if(a){o=a.width,c=a.height;const x=Up();(!x||x&&r==="fixed")&&(u=a.offsetLeft,p=a.offsetTop)}const h=r0(s);if(h<=0){const x=s.ownerDocument,y=x.body,v=getComputedStyle(y),k=x.compatMode==="CSS1Compat"&&parseFloat(v.marginLeft)+parseFloat(v.marginRight)||0,b=Math.abs(s.clientWidth-y.clientWidth-k);b<=fv&&(o-=b)}else h<=fv&&(o+=h);return{width:o,height:c,x:u,y:p}}const jO=new Set(["absolute","fixed"]);function kO(e,r){const t=Di(e,!0,r==="fixed"),s=t.top+e.clientTop,a=t.left+e.clientLeft,o=ta(e)?Eo(e):ea(1),c=e.clientWidth*o.x,u=e.clientHeight*o.y,p=a*o.x,h=s*o.y;return{width:c,height:u,x:p,y:h}}function hv(e,r,t){let s;if(r==="viewport")s=bO(e,t);else if(r==="document")s=SO(ia(e));else if(Ds(r))s=kO(r,t);else{const a=g2(e);s={x:r.x-a.x,y:r.y-a.y,width:r.width,height:r.height}}return yu(s)}function v2(e,r){const t=ni(e);return t===r||!Ds(t)||Do(t)?!1:Fs(t).position==="fixed"||v2(t,r)}function _O(e,r){const t=r.get(e);if(t)return t;let s=Xl(e,[],!1).filter(u=>Ds(u)&&Qo(u)!=="body"),a=null;const o=Fs(e).position==="fixed";let c=o?ni(e):e;for(;Ds(c)&&!Do(c);){const u=Fs(c),p=$p(c);!p&&u.position==="fixed"&&(a=null),(o?!p&&!a:!p&&u.position==="static"&&!!a&&jO.has(a.position)||vc(c)&&!p&&v2(e,c))?s=s.filter(x=>x!==c):a=u,c=ni(c)}return r.set(e,s),s}function CO(e){let{element:r,boundary:t,rootBoundary:s,strategy:a}=e;const c=[...t==="clippingAncestors"?e0(r)?[]:_O(r,this._c):[].concat(t),s],u=c[0],p=c.reduce((h,x)=>{const y=hv(r,x,a);return h.top=ns(y.top,h.top),h.right=ri(y.right,h.right),h.bottom=ri(y.bottom,h.bottom),h.left=ns(y.left,h.left),h},hv(r,u,a));return{width:p.right-p.left,height:p.bottom-p.top,x:p.left,y:p.top}}function EO(e){const{width:r,height:t}=x2(e);return{width:r,height:t}}function AO(e,r,t){const s=ta(r),a=ia(r),o=t==="fixed",c=Di(e,!0,o,r);let u={scrollLeft:0,scrollTop:0};const p=ea(0);function h(){p.x=r0(a)}if(s||!s&&!o)if((Qo(r)!=="body"||vc(a))&&(u=t0(r)),s){const k=Di(r,!0,o,r);p.x=k.x+r.clientLeft,p.y=k.y+r.clientTop}else a&&h();o&&!s&&a&&h();const x=a&&!s&&!o?y2(a,u):ea(0),y=c.left+u.scrollLeft-p.x-x.x,v=c.top+u.scrollTop-p.y-x.y;return{x:y,y:v,width:c.width,height:c.height}}function vh(e){return Fs(e).position==="static"}function pv(e,r){if(!ta(e)||Fs(e).position==="fixed")return null;if(r)return r(e);let t=e.offsetParent;return ia(e)===t&&(t=t.ownerDocument.body),t}function w2(e,r){const t=is(e);if(e0(e))return t;if(!ta(e)){let a=ni(e);for(;a&&!Do(a);){if(Ds(a)&&!vh(a))return a;a=ni(a)}return t}let s=pv(e,r);for(;s&&uO(s)&&vh(s);)s=pv(s,r);return s&&Do(s)&&vh(s)&&!$p(s)?t:s||xO(e)||t}const TO=async function(e){const r=this.getOffsetParent||w2,t=this.getDimensions,s=await t(e.floating);return{reference:AO(e.reference,await r(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function OO(e){return Fs(e).direction==="rtl"}const PO={convertOffsetParentRelativeRectToViewportRelativeRect:wO,getDocumentElement:ia,getClippingRect:CO,getOffsetParent:w2,getElementRects:TO,getClientRects:NO,getDimensions:EO,getScale:Eo,isElement:Ds,isRTL:OO};function N2(e,r){return e.x===r.x&&e.y===r.y&&e.width===r.width&&e.height===r.height}function RO(e,r){let t=null,s;const a=ia(e);function o(){var u;clearTimeout(s),(u=t)==null||u.disconnect(),t=null}function c(u,p){u===void 0&&(u=!1),p===void 0&&(p=1),o();const h=e.getBoundingClientRect(),{left:x,top:y,width:v,height:k}=h;if(u||r(),!v||!k)return;const b=Hd(y),w=Hd(a.clientWidth-(x+v)),j=Hd(a.clientHeight-(y+k)),O=Hd(x),F={rootMargin:-b+"px "+-w+"px "+-j+"px "+-O+"px",threshold:ns(0,ri(1,p))||1};let I=!0;function G(B){const Q=B[0].intersectionRatio;if(Q!==p){if(!I)return c();Q?c(!1,Q):s=setTimeout(()=>{c(!1,1e-7)},1e3)}Q===1&&!N2(h,e.getBoundingClientRect())&&c(),I=!1}try{t=new IntersectionObserver(G,{...F,root:a.ownerDocument})}catch{t=new IntersectionObserver(G,F)}t.observe(e)}return c(!0),o}function DO(e,r,t,s){s===void 0&&(s={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:p=!1}=s,h=zp(e),x=a||o?[...h?Xl(h):[],...Xl(r)]:[];x.forEach(O=>{a&&O.addEventListener("scroll",t,{passive:!0}),o&&O.addEventListener("resize",t)});const y=h&&u?RO(h,t):null;let v=-1,k=null;c&&(k=new ResizeObserver(O=>{let[T]=O;T&&T.target===h&&k&&(k.unobserve(r),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var F;(F=k)==null||F.observe(r)})),t()}),h&&!p&&k.observe(h),k.observe(r));let b,w=p?Di(e):null;p&&j();function j(){const O=Di(e);w&&!N2(w,O)&&t(),w=O,b=requestAnimationFrame(j)}return t(),()=>{var O;x.forEach(T=>{a&&T.removeEventListener("scroll",t),o&&T.removeEventListener("resize",t)}),y?.(),(O=k)==null||O.disconnect(),k=null,p&&cancelAnimationFrame(b)}}const FO=aO,MO=iO,LO=rO,IO=lO,BO=nO,mv=tO,$O=oO,UO=(e,r,t)=>{const s=new Map,a={platform:PO,...t},o={...a.platform,_c:s};return eO(e,r,{...a,platform:o})};var zO=typeof document<"u",WO=function(){},cu=zO?m.useLayoutEffect:WO;function vu(e,r){if(e===r)return!0;if(typeof e!=typeof r)return!1;if(typeof e=="function"&&e.toString()===r.toString())return!0;let t,s,a;if(e&&r&&typeof e=="object"){if(Array.isArray(e)){if(t=e.length,t!==r.length)return!1;for(s=t;s--!==0;)if(!vu(e[s],r[s]))return!1;return!0}if(a=Object.keys(e),t=a.length,t!==Object.keys(r).length)return!1;for(s=t;s--!==0;)if(!{}.hasOwnProperty.call(r,a[s]))return!1;for(s=t;s--!==0;){const o=a[s];if(!(o==="_owner"&&e.$$typeof)&&!vu(e[o],r[o]))return!1}return!0}return e!==e&&r!==r}function S2(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function xv(e,r){const t=S2(e);return Math.round(r*t)/t}function wh(e){const r=m.useRef(e);return cu(()=>{r.current=e}),r}function qO(e){e===void 0&&(e={});const{placement:r="bottom",strategy:t="absolute",middleware:s=[],platform:a,elements:{reference:o,floating:c}={},transform:u=!0,whileElementsMounted:p,open:h}=e,[x,y]=m.useState({x:0,y:0,strategy:t,placement:r,middlewareData:{},isPositioned:!1}),[v,k]=m.useState(s);vu(v,s)||k(s);const[b,w]=m.useState(null),[j,O]=m.useState(null),T=m.useCallback(V=>{V!==B.current&&(B.current=V,w(V))},[]),F=m.useCallback(V=>{V!==Q.current&&(Q.current=V,O(V))},[]),I=o||b,G=c||j,B=m.useRef(null),Q=m.useRef(null),z=m.useRef(x),J=p!=null,ne=wh(p),fe=wh(a),me=wh(h),le=m.useCallback(()=>{if(!B.current||!Q.current)return;const V={placement:r,strategy:t,middleware:v};fe.current&&(V.platform=fe.current),UO(B.current,Q.current,V).then(de=>{const Ne={...de,isPositioned:me.current!==!1};K.current&&!vu(z.current,Ne)&&(z.current=Ne,dc.flushSync(()=>{y(Ne)}))})},[v,r,t,fe,me]);cu(()=>{h===!1&&z.current.isPositioned&&(z.current.isPositioned=!1,y(V=>({...V,isPositioned:!1})))},[h]);const K=m.useRef(!1);cu(()=>(K.current=!0,()=>{K.current=!1}),[]),cu(()=>{if(I&&(B.current=I),G&&(Q.current=G),I&&G){if(ne.current)return ne.current(I,G,le);le()}},[I,G,le,ne,J]);const Fe=m.useMemo(()=>({reference:B,floating:Q,setReference:T,setFloating:F}),[T,F]),we=m.useMemo(()=>({reference:I,floating:G}),[I,G]),oe=m.useMemo(()=>{const V={position:t,left:0,top:0};if(!we.floating)return V;const de=xv(we.floating,x.x),Ne=xv(we.floating,x.y);return u?{...V,transform:"translate("+de+"px, "+Ne+"px)",...S2(we.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:de,top:Ne}},[t,u,we.floating,x.x,x.y]);return m.useMemo(()=>({...x,update:le,refs:Fe,elements:we,floatingStyles:oe}),[x,le,Fe,we,oe])}const VO=e=>{function r(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:e,fn(t){const{element:s,padding:a}=typeof e=="function"?e(t):e;return s&&r(s)?s.current!=null?mv({element:s.current,padding:a}).fn(t):{}:s?mv({element:s,padding:a}).fn(t):{}}}},QO=(e,r)=>({...FO(e),options:[e,r]}),HO=(e,r)=>({...MO(e),options:[e,r]}),GO=(e,r)=>({...$O(e),options:[e,r]}),YO=(e,r)=>({...LO(e),options:[e,r]}),KO=(e,r)=>({...IO(e),options:[e,r]}),XO=(e,r)=>({...BO(e),options:[e,r]}),JO=(e,r)=>({...VO(e),options:[e,r]});var ZO="Arrow",b2=m.forwardRef((e,r)=>{const{children:t,width:s=10,height:a=5,...o}=e;return n.jsx(Pt.svg,{...o,ref:r,width:s,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?t:n.jsx("polygon",{points:"0,0 30,0 15,10"})})});b2.displayName=ZO;var eP=b2,Wp="Popper",[j2,Ho]=_a(Wp),[tP,k2]=j2(Wp),_2=e=>{const{__scopePopper:r,children:t}=e,[s,a]=m.useState(null);return n.jsx(tP,{scope:r,anchor:s,onAnchorChange:a,children:t})};_2.displayName=Wp;var C2="PopperAnchor",E2=m.forwardRef((e,r)=>{const{__scopePopper:t,virtualRef:s,...a}=e,o=k2(C2,t),c=m.useRef(null),u=Jt(r,c),p=m.useRef(null);return m.useEffect(()=>{const h=p.current;p.current=s?.current||c.current,h!==p.current&&o.onAnchorChange(p.current)}),s?null:n.jsx(Pt.div,{...a,ref:u})});E2.displayName=C2;var qp="PopperContent",[rP,nP]=j2(qp),A2=m.forwardRef((e,r)=>{const{__scopePopper:t,side:s="bottom",sideOffset:a=0,align:o="center",alignOffset:c=0,arrowPadding:u=0,avoidCollisions:p=!0,collisionBoundary:h=[],collisionPadding:x=0,sticky:y="partial",hideWhenDetached:v=!1,updatePositionStrategy:k="optimized",onPlaced:b,...w}=e,j=k2(qp,t),[O,T]=m.useState(null),F=Jt(r,ie=>T(ie)),[I,G]=m.useState(null),B=X1(I),Q=B?.width??0,z=B?.height??0,J=s+(o!=="center"?"-"+o:""),ne=typeof x=="number"?x:{top:0,right:0,bottom:0,left:0,...x},fe=Array.isArray(h)?h:[h],me=fe.length>0,le={padding:ne,boundary:fe.filter(aP),altBoundary:me},{refs:K,floatingStyles:Fe,placement:we,isPositioned:oe,middlewareData:V}=qO({strategy:"fixed",placement:J,whileElementsMounted:(...ie)=>DO(...ie,{animationFrame:k==="always"}),elements:{reference:j.anchor},middleware:[QO({mainAxis:a+z,alignmentAxis:c}),p&&HO({mainAxis:!0,crossAxis:!1,limiter:y==="partial"?GO():void 0,...le}),p&&YO({...le}),KO({...le,apply:({elements:ie,rects:Te,availableWidth:ve,availableHeight:Ee})=>{const{width:Me,height:D}=Te.reference,ut=ie.floating.style;ut.setProperty("--radix-popper-available-width",`${ve}px`),ut.setProperty("--radix-popper-available-height",`${Ee}px`),ut.setProperty("--radix-popper-anchor-width",`${Me}px`),ut.setProperty("--radix-popper-anchor-height",`${D}px`)}}),I&&JO({element:I,padding:u}),iP({arrowWidth:Q,arrowHeight:z}),v&&XO({strategy:"referenceHidden",...le})]}),[de,Ne]=P2(we),ee=Rs(b);Vr(()=>{oe&&ee?.()},[oe,ee]);const U=V.arrow?.x,re=V.arrow?.y,Y=V.arrow?.centerOffset!==0,[Z,xe]=m.useState();return Vr(()=>{O&&xe(window.getComputedStyle(O).zIndex)},[O]),n.jsx("div",{ref:K.setFloating,"data-radix-popper-content-wrapper":"",style:{...Fe,transform:oe?Fe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Z,"--radix-popper-transform-origin":[V.transformOrigin?.x,V.transformOrigin?.y].join(" "),...V.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:n.jsx(rP,{scope:t,placedSide:de,onArrowChange:G,arrowX:U,arrowY:re,shouldHideArrow:Y,children:n.jsx(Pt.div,{"data-side":de,"data-align":Ne,...w,ref:F,style:{...w.style,animation:oe?void 0:"none"}})})})});A2.displayName=qp;var T2="PopperArrow",sP={top:"bottom",right:"left",bottom:"top",left:"right"},O2=m.forwardRef(function(r,t){const{__scopePopper:s,...a}=r,o=nP(T2,s),c=sP[o.placedSide];return n.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:n.jsx(eP,{...a,ref:t,style:{...a.style,display:"block"}})})});O2.displayName=T2;function aP(e){return e!==null}var iP=e=>({name:"transformOrigin",options:e,fn(r){const{placement:t,rects:s,middlewareData:a}=r,c=a.arrow?.centerOffset!==0,u=c?0:e.arrowWidth,p=c?0:e.arrowHeight,[h,x]=P2(t),y={start:"0%",center:"50%",end:"100%"}[x],v=(a.arrow?.x??0)+u/2,k=(a.arrow?.y??0)+p/2;let b="",w="";return h==="bottom"?(b=c?y:`${v}px`,w=`${-p}px`):h==="top"?(b=c?y:`${v}px`,w=`${s.floating.height+p}px`):h==="right"?(b=`${-p}px`,w=c?y:`${k}px`):h==="left"&&(b=`${s.floating.width+p}px`,w=c?y:`${k}px`),{data:{x:b,y:w}}}});function P2(e){const[r,t="center"]=e.split("-");return[r,t]}var Vp=_2,n0=E2,Qp=A2,Hp=O2;function oP(e){const r=lP(e),t=m.forwardRef((s,a)=>{const{children:o,...c}=s,u=m.Children.toArray(o),p=u.find(dP);if(p){const h=p.props.children,x=u.map(y=>y===p?m.Children.count(h)>1?m.Children.only(null):m.isValidElement(h)?h.props.children:null:y);return n.jsx(r,{...c,ref:a,children:m.isValidElement(h)?m.cloneElement(h,void 0,x):null})}return n.jsx(r,{...c,ref:a,children:o})});return t.displayName=`${e}.Slot`,t}function lP(e){const r=m.forwardRef((t,s)=>{const{children:a,...o}=t;if(m.isValidElement(a)){const c=fP(a),u=uP(o,a.props);return a.type!==m.Fragment&&(u.ref=s?aa(s,c):c),m.cloneElement(a,u)}return m.Children.count(a)>1?m.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var cP=Symbol("radix.slottable");function dP(e){return m.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===cP}function uP(e,r){const t={...r};for(const s in r){const a=e[s],o=r[s];/^on[A-Z]/.test(s)?a&&o?t[s]=(...u)=>{const p=o(...u);return a(...u),p}:a&&(t[s]=a):s==="style"?t[s]={...a,...o}:s==="className"&&(t[s]=[a,o].filter(Boolean).join(" "))}return{...e,...t}}function fP(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}var R2=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),hP="VisuallyHidden",pP=m.forwardRef((e,r)=>n.jsx(Pt.span,{...e,ref:r,style:{...R2,...e.style}}));pP.displayName=hP;var mP=[" ","Enter","ArrowUp","ArrowDown"],xP=[" ","Enter"],Fi="Select",[s0,a0,gP]=Fp(Fi),[Go]=_a(Fi,[gP,Ho]),i0=Ho(),[yP,li]=Go(Fi),[vP,wP]=Go(Fi),D2=e=>{const{__scopeSelect:r,children:t,open:s,defaultOpen:a,onOpenChange:o,value:c,defaultValue:u,onValueChange:p,dir:h,name:x,autoComplete:y,disabled:v,required:k,form:b}=e,w=i0(r),[j,O]=m.useState(null),[T,F]=m.useState(null),[I,G]=m.useState(!1),B=Mp(h),[Q,z]=Oi({prop:s,defaultProp:a??!1,onChange:o,caller:Fi}),[J,ne]=Oi({prop:c,defaultProp:u,onChange:p,caller:Fi}),fe=m.useRef(null),me=j?b||!!j.closest("form"):!0,[le,K]=m.useState(new Set),Fe=Array.from(le).map(we=>we.props.value).join(";");return n.jsx(Vp,{...w,children:n.jsxs(yP,{required:k,scope:r,trigger:j,onTriggerChange:O,valueNode:T,onValueNodeChange:F,valueNodeHasChildren:I,onValueNodeHasChildrenChange:G,contentId:Zs(),value:J,onValueChange:ne,open:Q,onOpenChange:z,dir:B,triggerPointerDownPosRef:fe,disabled:v,children:[n.jsx(s0.Provider,{scope:r,children:n.jsx(vP,{scope:e.__scopeSelect,onNativeOptionAdd:m.useCallback(we=>{K(oe=>new Set(oe).add(we))},[]),onNativeOptionRemove:m.useCallback(we=>{K(oe=>{const V=new Set(oe);return V.delete(we),V})},[]),children:t})}),me?n.jsxs(rN,{"aria-hidden":!0,required:k,tabIndex:-1,name:x,autoComplete:y,value:J,onChange:we=>ne(we.target.value),disabled:v,form:b,children:[J===void 0?n.jsx("option",{value:""}):null,Array.from(le)]},Fe):null]})})};D2.displayName=Fi;var F2="SelectTrigger",M2=m.forwardRef((e,r)=>{const{__scopeSelect:t,disabled:s=!1,...a}=e,o=i0(t),c=li(F2,t),u=c.disabled||s,p=Jt(r,c.onTriggerChange),h=a0(t),x=m.useRef("touch"),[y,v,k]=sN(w=>{const j=h().filter(F=>!F.disabled),O=j.find(F=>F.value===c.value),T=aN(j,w,O);T!==void 0&&c.onValueChange(T.value)}),b=w=>{u||(c.onOpenChange(!0),k()),w&&(c.triggerPointerDownPosRef.current={x:Math.round(w.pageX),y:Math.round(w.pageY)})};return n.jsx(n0,{asChild:!0,...o,children:n.jsx(Pt.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:u,"data-disabled":u?"":void 0,"data-placeholder":nN(c.value)?"":void 0,...a,ref:p,onClick:ct(a.onClick,w=>{w.currentTarget.focus(),x.current!=="mouse"&&b(w)}),onPointerDown:ct(a.onPointerDown,w=>{x.current=w.pointerType;const j=w.target;j.hasPointerCapture(w.pointerId)&&j.releasePointerCapture(w.pointerId),w.button===0&&w.ctrlKey===!1&&w.pointerType==="mouse"&&(b(w),w.preventDefault())}),onKeyDown:ct(a.onKeyDown,w=>{const j=y.current!=="";!(w.ctrlKey||w.altKey||w.metaKey)&&w.key.length===1&&v(w.key),!(j&&w.key===" ")&&mP.includes(w.key)&&(b(),w.preventDefault())})})})});M2.displayName=F2;var L2="SelectValue",I2=m.forwardRef((e,r)=>{const{__scopeSelect:t,className:s,style:a,children:o,placeholder:c="",...u}=e,p=li(L2,t),{onValueNodeHasChildrenChange:h}=p,x=o!==void 0,y=Jt(r,p.onValueNodeChange);return Vr(()=>{h(x)},[h,x]),n.jsx(Pt.span,{...u,ref:y,style:{pointerEvents:"none"},children:nN(p.value)?n.jsx(n.Fragment,{children:c}):o})});I2.displayName=L2;var NP="SelectIcon",B2=m.forwardRef((e,r)=>{const{__scopeSelect:t,children:s,...a}=e;return n.jsx(Pt.span,{"aria-hidden":!0,...a,ref:r,children:s||""})});B2.displayName=NP;var SP="SelectPortal",$2=e=>n.jsx(gc,{asChild:!0,...e});$2.displayName=SP;var Mi="SelectContent",U2=m.forwardRef((e,r)=>{const t=li(Mi,e.__scopeSelect),[s,a]=m.useState();if(Vr(()=>{a(new DocumentFragment)},[]),!t.open){const o=s;return o?dc.createPortal(n.jsx(z2,{scope:e.__scopeSelect,children:n.jsx(s0.Slot,{scope:e.__scopeSelect,children:n.jsx("div",{children:e.children})})}),o):null}return n.jsx(W2,{...e,ref:r})});U2.displayName=Mi;var Es=10,[z2,ci]=Go(Mi),bP="SelectContentImpl",jP=oP("SelectContent.RemoveScroll"),W2=m.forwardRef((e,r)=>{const{__scopeSelect:t,position:s="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:c,side:u,sideOffset:p,align:h,alignOffset:x,arrowPadding:y,collisionBoundary:v,collisionPadding:k,sticky:b,hideWhenDetached:w,avoidCollisions:j,...O}=e,T=li(Mi,t),[F,I]=m.useState(null),[G,B]=m.useState(null),Q=Jt(r,ie=>I(ie)),[z,J]=m.useState(null),[ne,fe]=m.useState(null),me=a0(t),[le,K]=m.useState(!1),Fe=m.useRef(!1);m.useEffect(()=>{if(F)return Xu(F)},[F]),Yu();const we=m.useCallback(ie=>{const[Te,...ve]=me().map(D=>D.ref.current),[Ee]=ve.slice(-1),Me=document.activeElement;for(const D of ie)if(D===Me||(D?.scrollIntoView({block:"nearest"}),D===Te&&G&&(G.scrollTop=0),D===Ee&&G&&(G.scrollTop=G.scrollHeight),D?.focus(),document.activeElement!==Me))return},[me,G]),oe=m.useCallback(()=>we([z,F]),[we,z,F]);m.useEffect(()=>{le&&oe()},[le,oe]);const{onOpenChange:V,triggerPointerDownPosRef:de}=T;m.useEffect(()=>{if(F){let ie={x:0,y:0};const Te=Ee=>{ie={x:Math.abs(Math.round(Ee.pageX)-(de.current?.x??0)),y:Math.abs(Math.round(Ee.pageY)-(de.current?.y??0))}},ve=Ee=>{ie.x<=10&&ie.y<=10?Ee.preventDefault():F.contains(Ee.target)||V(!1),document.removeEventListener("pointermove",Te),de.current=null};return de.current!==null&&(document.addEventListener("pointermove",Te),document.addEventListener("pointerup",ve,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Te),document.removeEventListener("pointerup",ve,{capture:!0})}}},[F,V,de]),m.useEffect(()=>{const ie=()=>V(!1);return window.addEventListener("blur",ie),window.addEventListener("resize",ie),()=>{window.removeEventListener("blur",ie),window.removeEventListener("resize",ie)}},[V]);const[Ne,ee]=sN(ie=>{const Te=me().filter(Me=>!Me.disabled),ve=Te.find(Me=>Me.ref.current===document.activeElement),Ee=aN(Te,ie,ve);Ee&&setTimeout(()=>Ee.ref.current.focus())}),U=m.useCallback((ie,Te,ve)=>{const Ee=!Fe.current&&!ve;(T.value!==void 0&&T.value===Te||Ee)&&(J(ie),Ee&&(Fe.current=!0))},[T.value]),re=m.useCallback(()=>F?.focus(),[F]),Y=m.useCallback((ie,Te,ve)=>{const Ee=!Fe.current&&!ve;(T.value!==void 0&&T.value===Te||Ee)&&fe(ie)},[T.value]),Z=s==="popper"?rp:q2,xe=Z===rp?{side:u,sideOffset:p,align:h,alignOffset:x,arrowPadding:y,collisionBoundary:v,collisionPadding:k,sticky:b,hideWhenDetached:w,avoidCollisions:j}:{};return n.jsx(z2,{scope:t,content:F,viewport:G,onViewportChange:B,itemRefCallback:U,selectedItem:z,onItemLeave:re,itemTextRefCallback:Y,focusSelectedItem:oe,selectedItemText:ne,position:s,isPositioned:le,searchRef:Ne,children:n.jsx(yc,{as:jP,allowPinchZoom:!0,children:n.jsx(xc,{asChild:!0,trapped:T.open,onMountAutoFocus:ie=>{ie.preventDefault()},onUnmountAutoFocus:ct(a,ie=>{T.trigger?.focus({preventScroll:!0}),ie.preventDefault()}),children:n.jsx(mc,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:ie=>ie.preventDefault(),onDismiss:()=>T.onOpenChange(!1),children:n.jsx(Z,{role:"listbox",id:T.contentId,"data-state":T.open?"open":"closed",dir:T.dir,onContextMenu:ie=>ie.preventDefault(),...O,...xe,onPlaced:()=>K(!0),ref:Q,style:{display:"flex",flexDirection:"column",outline:"none",...O.style},onKeyDown:ct(O.onKeyDown,ie=>{const Te=ie.ctrlKey||ie.altKey||ie.metaKey;if(ie.key==="Tab"&&ie.preventDefault(),!Te&&ie.key.length===1&&ee(ie.key),["ArrowUp","ArrowDown","Home","End"].includes(ie.key)){let Ee=me().filter(Me=>!Me.disabled).map(Me=>Me.ref.current);if(["ArrowUp","End"].includes(ie.key)&&(Ee=Ee.slice().reverse()),["ArrowUp","ArrowDown"].includes(ie.key)){const Me=ie.target,D=Ee.indexOf(Me);Ee=Ee.slice(D+1)}setTimeout(()=>we(Ee)),ie.preventDefault()}})})})})})})});W2.displayName=bP;var kP="SelectItemAlignedPosition",q2=m.forwardRef((e,r)=>{const{__scopeSelect:t,onPlaced:s,...a}=e,o=li(Mi,t),c=ci(Mi,t),[u,p]=m.useState(null),[h,x]=m.useState(null),y=Jt(r,Q=>x(Q)),v=a0(t),k=m.useRef(!1),b=m.useRef(!0),{viewport:w,selectedItem:j,selectedItemText:O,focusSelectedItem:T}=c,F=m.useCallback(()=>{if(o.trigger&&o.valueNode&&u&&h&&w&&j&&O){const Q=o.trigger.getBoundingClientRect(),z=h.getBoundingClientRect(),J=o.valueNode.getBoundingClientRect(),ne=O.getBoundingClientRect();if(o.dir!=="rtl"){const Me=ne.left-z.left,D=J.left-Me,ut=Q.left-D,et=Q.width+ut,Ge=Math.max(et,z.width),Be=window.innerWidth-Es,Le=sv(D,[Es,Math.max(Es,Be-Ge)]);u.style.minWidth=et+"px",u.style.left=Le+"px"}else{const Me=z.right-ne.right,D=window.innerWidth-J.right-Me,ut=window.innerWidth-Q.right-D,et=Q.width+ut,Ge=Math.max(et,z.width),Be=window.innerWidth-Es,Le=sv(D,[Es,Math.max(Es,Be-Ge)]);u.style.minWidth=et+"px",u.style.right=Le+"px"}const fe=v(),me=window.innerHeight-Es*2,le=w.scrollHeight,K=window.getComputedStyle(h),Fe=parseInt(K.borderTopWidth,10),we=parseInt(K.paddingTop,10),oe=parseInt(K.borderBottomWidth,10),V=parseInt(K.paddingBottom,10),de=Fe+we+le+V+oe,Ne=Math.min(j.offsetHeight*5,de),ee=window.getComputedStyle(w),U=parseInt(ee.paddingTop,10),re=parseInt(ee.paddingBottom,10),Y=Q.top+Q.height/2-Es,Z=me-Y,xe=j.offsetHeight/2,ie=j.offsetTop+xe,Te=Fe+we+ie,ve=de-Te;if(Te<=Y){const Me=fe.length>0&&j===fe[fe.length-1].ref.current;u.style.bottom="0px";const D=h.clientHeight-w.offsetTop-w.offsetHeight,ut=Math.max(Z,xe+(Me?re:0)+D+oe),et=Te+ut;u.style.height=et+"px"}else{const Me=fe.length>0&&j===fe[0].ref.current;u.style.top="0px";const ut=Math.max(Y,Fe+w.offsetTop+(Me?U:0)+xe)+ve;u.style.height=ut+"px",w.scrollTop=Te-Y+w.offsetTop}u.style.margin=`${Es}px 0`,u.style.minHeight=Ne+"px",u.style.maxHeight=me+"px",s?.(),requestAnimationFrame(()=>k.current=!0)}},[v,o.trigger,o.valueNode,u,h,w,j,O,o.dir,s]);Vr(()=>F(),[F]);const[I,G]=m.useState();Vr(()=>{h&&G(window.getComputedStyle(h).zIndex)},[h]);const B=m.useCallback(Q=>{Q&&b.current===!0&&(F(),T?.(),b.current=!1)},[F,T]);return n.jsx(CP,{scope:t,contentWrapper:u,shouldExpandOnScrollRef:k,onScrollButtonChange:B,children:n.jsx("div",{ref:p,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:I},children:n.jsx(Pt.div,{...a,ref:y,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});q2.displayName=kP;var _P="SelectPopperPosition",rp=m.forwardRef((e,r)=>{const{__scopeSelect:t,align:s="start",collisionPadding:a=Es,...o}=e,c=i0(t);return n.jsx(Qp,{...c,...o,ref:r,align:s,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});rp.displayName=_P;var[CP,Gp]=Go(Mi,{}),np="SelectViewport",V2=m.forwardRef((e,r)=>{const{__scopeSelect:t,nonce:s,...a}=e,o=ci(np,t),c=Gp(np,t),u=Jt(r,o.onViewportChange),p=m.useRef(0);return n.jsxs(n.Fragment,{children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),n.jsx(s0.Slot,{scope:t,children:n.jsx(Pt.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:u,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ct(a.onScroll,h=>{const x=h.currentTarget,{contentWrapper:y,shouldExpandOnScrollRef:v}=c;if(v?.current&&y){const k=Math.abs(p.current-x.scrollTop);if(k>0){const b=window.innerHeight-Es*2,w=parseFloat(y.style.minHeight),j=parseFloat(y.style.height),O=Math.max(w,j);if(O<b){const T=O+k,F=Math.min(b,T),I=T-F;y.style.height=F+"px",y.style.bottom==="0px"&&(x.scrollTop=I>0?I:0,y.style.justifyContent="flex-end")}}}p.current=x.scrollTop})})})]})});V2.displayName=np;var Q2="SelectGroup",[EP,AP]=Go(Q2),TP=m.forwardRef((e,r)=>{const{__scopeSelect:t,...s}=e,a=Zs();return n.jsx(EP,{scope:t,id:a,children:n.jsx(Pt.div,{role:"group","aria-labelledby":a,...s,ref:r})})});TP.displayName=Q2;var H2="SelectLabel",OP=m.forwardRef((e,r)=>{const{__scopeSelect:t,...s}=e,a=AP(H2,t);return n.jsx(Pt.div,{id:a.id,...s,ref:r})});OP.displayName=H2;var wu="SelectItem",[PP,G2]=Go(wu),Y2=m.forwardRef((e,r)=>{const{__scopeSelect:t,value:s,disabled:a=!1,textValue:o,...c}=e,u=li(wu,t),p=ci(wu,t),h=u.value===s,[x,y]=m.useState(o??""),[v,k]=m.useState(!1),b=Jt(r,T=>p.itemRefCallback?.(T,s,a)),w=Zs(),j=m.useRef("touch"),O=()=>{a||(u.onValueChange(s),u.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return n.jsx(PP,{scope:t,value:s,disabled:a,textId:w,isSelected:h,onItemTextChange:m.useCallback(T=>{y(F=>F||(T?.textContent??"").trim())},[]),children:n.jsx(s0.ItemSlot,{scope:t,value:s,disabled:a,textValue:x,children:n.jsx(Pt.div,{role:"option","aria-labelledby":w,"data-highlighted":v?"":void 0,"aria-selected":h&&v,"data-state":h?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...c,ref:b,onFocus:ct(c.onFocus,()=>k(!0)),onBlur:ct(c.onBlur,()=>k(!1)),onClick:ct(c.onClick,()=>{j.current!=="mouse"&&O()}),onPointerUp:ct(c.onPointerUp,()=>{j.current==="mouse"&&O()}),onPointerDown:ct(c.onPointerDown,T=>{j.current=T.pointerType}),onPointerMove:ct(c.onPointerMove,T=>{j.current=T.pointerType,a?p.onItemLeave?.():j.current==="mouse"&&T.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ct(c.onPointerLeave,T=>{T.currentTarget===document.activeElement&&p.onItemLeave?.()}),onKeyDown:ct(c.onKeyDown,T=>{p.searchRef?.current!==""&&T.key===" "||(xP.includes(T.key)&&O(),T.key===" "&&T.preventDefault())})})})})});Y2.displayName=wu;var $l="SelectItemText",K2=m.forwardRef((e,r)=>{const{__scopeSelect:t,className:s,style:a,...o}=e,c=li($l,t),u=ci($l,t),p=G2($l,t),h=wP($l,t),[x,y]=m.useState(null),v=Jt(r,O=>y(O),p.onItemTextChange,O=>u.itemTextRefCallback?.(O,p.value,p.disabled)),k=x?.textContent,b=m.useMemo(()=>n.jsx("option",{value:p.value,disabled:p.disabled,children:k},p.value),[p.disabled,p.value,k]),{onNativeOptionAdd:w,onNativeOptionRemove:j}=h;return Vr(()=>(w(b),()=>j(b)),[w,j,b]),n.jsxs(n.Fragment,{children:[n.jsx(Pt.span,{id:p.textId,...o,ref:v}),p.isSelected&&c.valueNode&&!c.valueNodeHasChildren?dc.createPortal(o.children,c.valueNode):null]})});K2.displayName=$l;var X2="SelectItemIndicator",J2=m.forwardRef((e,r)=>{const{__scopeSelect:t,...s}=e;return G2(X2,t).isSelected?n.jsx(Pt.span,{"aria-hidden":!0,...s,ref:r}):null});J2.displayName=X2;var sp="SelectScrollUpButton",Z2=m.forwardRef((e,r)=>{const t=ci(sp,e.__scopeSelect),s=Gp(sp,e.__scopeSelect),[a,o]=m.useState(!1),c=Jt(r,s.onScrollButtonChange);return Vr(()=>{if(t.viewport&&t.isPositioned){let u=function(){const h=p.scrollTop>0;o(h)};const p=t.viewport;return u(),p.addEventListener("scroll",u),()=>p.removeEventListener("scroll",u)}},[t.viewport,t.isPositioned]),a?n.jsx(tN,{...e,ref:c,onAutoScroll:()=>{const{viewport:u,selectedItem:p}=t;u&&p&&(u.scrollTop=u.scrollTop-p.offsetHeight)}}):null});Z2.displayName=sp;var ap="SelectScrollDownButton",eN=m.forwardRef((e,r)=>{const t=ci(ap,e.__scopeSelect),s=Gp(ap,e.__scopeSelect),[a,o]=m.useState(!1),c=Jt(r,s.onScrollButtonChange);return Vr(()=>{if(t.viewport&&t.isPositioned){let u=function(){const h=p.scrollHeight-p.clientHeight,x=Math.ceil(p.scrollTop)<h;o(x)};const p=t.viewport;return u(),p.addEventListener("scroll",u),()=>p.removeEventListener("scroll",u)}},[t.viewport,t.isPositioned]),a?n.jsx(tN,{...e,ref:c,onAutoScroll:()=>{const{viewport:u,selectedItem:p}=t;u&&p&&(u.scrollTop=u.scrollTop+p.offsetHeight)}}):null});eN.displayName=ap;var tN=m.forwardRef((e,r)=>{const{__scopeSelect:t,onAutoScroll:s,...a}=e,o=ci("SelectScrollButton",t),c=m.useRef(null),u=a0(t),p=m.useCallback(()=>{c.current!==null&&(window.clearInterval(c.current),c.current=null)},[]);return m.useEffect(()=>()=>p(),[p]),Vr(()=>{u().find(x=>x.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[u]),n.jsx(Pt.div,{"aria-hidden":!0,...a,ref:r,style:{flexShrink:0,...a.style},onPointerDown:ct(a.onPointerDown,()=>{c.current===null&&(c.current=window.setInterval(s,50))}),onPointerMove:ct(a.onPointerMove,()=>{o.onItemLeave?.(),c.current===null&&(c.current=window.setInterval(s,50))}),onPointerLeave:ct(a.onPointerLeave,()=>{p()})})}),RP="SelectSeparator",DP=m.forwardRef((e,r)=>{const{__scopeSelect:t,...s}=e;return n.jsx(Pt.div,{"aria-hidden":!0,...s,ref:r})});DP.displayName=RP;var ip="SelectArrow",FP=m.forwardRef((e,r)=>{const{__scopeSelect:t,...s}=e,a=i0(t),o=li(ip,t),c=ci(ip,t);return o.open&&c.position==="popper"?n.jsx(Hp,{...a,...s,ref:r}):null});FP.displayName=ip;var MP="SelectBubbleInput",rN=m.forwardRef(({__scopeSelect:e,value:r,...t},s)=>{const a=m.useRef(null),o=Jt(s,a),c=K1(r);return m.useEffect(()=>{const u=a.current;if(!u)return;const p=window.HTMLSelectElement.prototype,x=Object.getOwnPropertyDescriptor(p,"value").set;if(c!==r&&x){const y=new Event("change",{bubbles:!0});x.call(u,r),u.dispatchEvent(y)}},[c,r]),n.jsx(Pt.select,{...t,style:{...R2,...t.style},ref:o,defaultValue:r})});rN.displayName=MP;function nN(e){return e===""||e===void 0}function sN(e){const r=Rs(e),t=m.useRef(""),s=m.useRef(0),a=m.useCallback(c=>{const u=t.current+c;r(u),(function p(h){t.current=h,window.clearTimeout(s.current),h!==""&&(s.current=window.setTimeout(()=>p(""),1e3))})(u)},[r]),o=m.useCallback(()=>{t.current="",window.clearTimeout(s.current)},[]);return m.useEffect(()=>()=>window.clearTimeout(s.current),[]),[t,a,o]}function aN(e,r,t){const a=r.length>1&&Array.from(r).every(h=>h===r[0])?r[0]:r,o=t?e.indexOf(t):-1;let c=LP(e,Math.max(o,0));a.length===1&&(c=c.filter(h=>h!==t));const p=c.find(h=>h.textValue.toLowerCase().startsWith(a.toLowerCase()));return p!==t?p:void 0}function LP(e,r){return e.map((t,s)=>e[(r+s)%e.length])}var IP=D2,BP=M2,$P=I2,UP=B2,zP=$2,WP=U2,qP=V2,VP=Y2,QP=K2,HP=J2,GP=Z2,YP=eN;function pn({...e}){return n.jsx(IP,{"data-slot":"select",...e})}function mn({...e}){return n.jsx($P,{"data-slot":"select-value",...e})}function xn({className:e,size:r="default",children:t,...s}){return n.jsxs(BP,{"data-slot":"select-trigger","data-size":r,className:sr("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-all duration-200 outline-none focus-visible:ring-[3px] focus-visible:shadow-sm hover:border-ring/50 disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s,children:[t,n.jsx(UP,{asChild:!0,children:n.jsx(Cp,{className:"size-4 opacity-50"})})]})}function gn({className:e,children:r,position:t="popper",...s}){return n.jsx(zP,{children:n.jsxs(WP,{"data-slot":"select-content",className:sr("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...s,children:[n.jsx(KP,{}),n.jsx(qP,{className:sr("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:r}),n.jsx(XP,{})]})})}function qr({className:e,children:r,...t}){return n.jsxs(VP,{"data-slot":"select-item",className:sr("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...t,children:[n.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:n.jsx(HP,{children:n.jsx(lw,{className:"size-4"})})}),n.jsx(QP,{children:r})]})}function KP({className:e,...r}){return n.jsx(GP,{"data-slot":"select-scroll-up-button",className:sr("flex cursor-default items-center justify-center py-1",e),...r,children:n.jsx(cw,{className:"size-4"})})}function XP({className:e,...r}){return n.jsx(YP,{"data-slot":"select-scroll-down-button",className:sr("flex cursor-default items-center justify-center py-1",e),...r,children:n.jsx(Cp,{className:"size-4"})})}function JP(e){const r=ZP(e),t=m.forwardRef((s,a)=>{const{children:o,...c}=s,u=m.Children.toArray(o),p=u.find(tR);if(p){const h=p.props.children,x=u.map(y=>y===p?m.Children.count(h)>1?m.Children.only(null):m.isValidElement(h)?h.props.children:null:y);return n.jsx(r,{...c,ref:a,children:m.isValidElement(h)?m.cloneElement(h,void 0,x):null})}return n.jsx(r,{...c,ref:a,children:o})});return t.displayName=`${e}.Slot`,t}function ZP(e){const r=m.forwardRef((t,s)=>{const{children:a,...o}=t;if(m.isValidElement(a)){const c=nR(a),u=rR(o,a.props);return a.type!==m.Fragment&&(u.ref=s?aa(s,c):c),m.cloneElement(a,u)}return m.Children.count(a)>1?m.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var eR=Symbol("radix.slottable");function tR(e){return m.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===eR}function rR(e,r){const t={...r};for(const s in r){const a=e[s],o=r[s];/^on[A-Z]/.test(s)?a&&o?t[s]=(...u)=>{const p=o(...u);return a(...u),p}:a&&(t[s]=a):s==="style"?t[s]={...a,...o}:s==="className"&&(t[s]=[a,o].filter(Boolean).join(" "))}return{...e,...t}}function nR(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}var o0="Popover",[iN]=_a(o0,[Ho]),wc=Ho(),[sR,di]=iN(o0),oN=e=>{const{__scopePopover:r,children:t,open:s,defaultOpen:a,onOpenChange:o,modal:c=!1}=e,u=wc(r),p=m.useRef(null),[h,x]=m.useState(!1),[y,v]=Oi({prop:s,defaultProp:a??!1,onChange:o,caller:o0});return n.jsx(Vp,{...u,children:n.jsx(sR,{scope:r,contentId:Zs(),triggerRef:p,open:y,onOpenChange:v,onOpenToggle:m.useCallback(()=>v(k=>!k),[v]),hasCustomAnchor:h,onCustomAnchorAdd:m.useCallback(()=>x(!0),[]),onCustomAnchorRemove:m.useCallback(()=>x(!1),[]),modal:c,children:t})})};oN.displayName=o0;var lN="PopoverAnchor",aR=m.forwardRef((e,r)=>{const{__scopePopover:t,...s}=e,a=di(lN,t),o=wc(t),{onCustomAnchorAdd:c,onCustomAnchorRemove:u}=a;return m.useEffect(()=>(c(),()=>u()),[c,u]),n.jsx(n0,{...o,...s,ref:r})});aR.displayName=lN;var cN="PopoverTrigger",dN=m.forwardRef((e,r)=>{const{__scopePopover:t,...s}=e,a=di(cN,t),o=wc(t),c=Jt(r,a.triggerRef),u=n.jsx(Pt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":mN(a.open),...s,ref:c,onClick:ct(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?u:n.jsx(n0,{asChild:!0,...o,children:u})});dN.displayName=cN;var Yp="PopoverPortal",[iR,oR]=iN(Yp,{forceMount:void 0}),uN=e=>{const{__scopePopover:r,forceMount:t,children:s,container:a}=e,o=di(Yp,r);return n.jsx(iR,{scope:r,forceMount:t,children:n.jsx(Bs,{present:t||o.open,children:n.jsx(gc,{asChild:!0,container:a,children:s})})})};uN.displayName=Yp;var Fo="PopoverContent",fN=m.forwardRef((e,r)=>{const t=oR(Fo,e.__scopePopover),{forceMount:s=t.forceMount,...a}=e,o=di(Fo,e.__scopePopover);return n.jsx(Bs,{present:s||o.open,children:o.modal?n.jsx(cR,{...a,ref:r}):n.jsx(dR,{...a,ref:r})})});fN.displayName=Fo;var lR=JP("PopoverContent.RemoveScroll"),cR=m.forwardRef((e,r)=>{const t=di(Fo,e.__scopePopover),s=m.useRef(null),a=Jt(r,s),o=m.useRef(!1);return m.useEffect(()=>{const c=s.current;if(c)return Xu(c)},[]),n.jsx(yc,{as:lR,allowPinchZoom:!0,children:n.jsx(hN,{...e,ref:a,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ct(e.onCloseAutoFocus,c=>{c.preventDefault(),o.current||t.triggerRef.current?.focus()}),onPointerDownOutside:ct(e.onPointerDownOutside,c=>{const u=c.detail.originalEvent,p=u.button===0&&u.ctrlKey===!0,h=u.button===2||p;o.current=h},{checkForDefaultPrevented:!1}),onFocusOutside:ct(e.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1})})})}),dR=m.forwardRef((e,r)=>{const t=di(Fo,e.__scopePopover),s=m.useRef(!1),a=m.useRef(!1);return n.jsx(hN,{...e,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{e.onCloseAutoFocus?.(o),o.defaultPrevented||(s.current||t.triggerRef.current?.focus(),o.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:o=>{e.onInteractOutside?.(o),o.defaultPrevented||(s.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const c=o.target;t.triggerRef.current?.contains(c)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),hN=m.forwardRef((e,r)=>{const{__scopePopover:t,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:c,onEscapeKeyDown:u,onPointerDownOutside:p,onFocusOutside:h,onInteractOutside:x,...y}=e,v=di(Fo,t),k=wc(t);return Yu(),n.jsx(xc,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:o,children:n.jsx(mc,{asChild:!0,disableOutsidePointerEvents:c,onInteractOutside:x,onEscapeKeyDown:u,onPointerDownOutside:p,onFocusOutside:h,onDismiss:()=>v.onOpenChange(!1),children:n.jsx(Qp,{"data-state":mN(v.open),role:"dialog",id:v.contentId,...k,...y,ref:r,style:{...y.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),pN="PopoverClose",uR=m.forwardRef((e,r)=>{const{__scopePopover:t,...s}=e,a=di(pN,t);return n.jsx(Pt.button,{type:"button",...s,ref:r,onClick:ct(e.onClick,()=>a.onOpenChange(!1))})});uR.displayName=pN;var fR="PopoverArrow",hR=m.forwardRef((e,r)=>{const{__scopePopover:t,...s}=e,a=wc(t);return n.jsx(Hp,{...a,...s,ref:r})});hR.displayName=fR;function mN(e){return e?"open":"closed"}var pR=oN,xN=dN,mR=uN,gN=fN;function xR({...e}){return n.jsx(pR,{"data-slot":"popover",...e})}const yN=m.forwardRef((e,r)=>n.jsx(xN,{ref:r,"data-slot":"popover-trigger",...e}));yN.displayName=xN.displayName;const vN=m.forwardRef(({className:e,align:r="center",sideOffset:t=4,...s},a)=>n.jsx(mR,{children:n.jsx(gN,{ref:a,"data-slot":"popover-content",align:r,sideOffset:t,className:sr("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...s})}));vN.displayName=gN.displayName;function Qt(e){const r=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&r==="[object Date]"?new e.constructor(+e):typeof e=="number"||r==="[object Number]"||typeof e=="string"||r==="[object String]"?new Date(e):new Date(NaN)}function os(e,r){return e instanceof Date?new e.constructor(r):new Date(r)}function Sn(e,r){const t=Qt(e);return isNaN(r)?os(e,NaN):(r&&t.setDate(t.getDate()+r),t)}function Ms(e,r){const t=Qt(e);if(isNaN(r))return os(e,NaN);if(!r)return t;const s=t.getDate(),a=os(e,t.getTime());a.setMonth(t.getMonth()+r+1,0);const o=a.getDate();return s>=o?a:(t.setFullYear(a.getFullYear(),a.getMonth(),s),t)}const Kp=6048e5,gR=864e5;let yR={};function Nc(){return yR}function ra(e,r){const t=Nc(),s=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=Qt(e),o=a.getDay(),c=(o<s?7:0)+o-s;return a.setDate(a.getDate()-c),a.setHours(0,0,0,0),a}function Li(e){return ra(e,{weekStartsOn:1})}function wN(e){const r=Qt(e),t=r.getFullYear(),s=os(e,0);s.setFullYear(t+1,0,4),s.setHours(0,0,0,0);const a=Li(s),o=os(e,0);o.setFullYear(t,0,4),o.setHours(0,0,0,0);const c=Li(o);return r.getTime()>=a.getTime()?t+1:r.getTime()>=c.getTime()?t:t-1}function Mo(e){const r=Qt(e);return r.setHours(0,0,0,0),r}function Nu(e){const r=Qt(e),t=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return t.setUTCFullYear(r.getFullYear()),+e-+t}function Js(e,r){const t=Mo(e),s=Mo(r),a=+t-Nu(t),o=+s-Nu(s);return Math.round((a-o)/gR)}function vR(e){const r=wN(e),t=os(e,0);return t.setFullYear(r,0,4),t.setHours(0,0,0,0),Li(t)}function op(e,r){const t=r*7;return Sn(e,t)}function wR(e,r){return Ms(e,r*12)}function NR(e){let r;return e.forEach(function(t){const s=Qt(t);(r===void 0||r<s||isNaN(Number(s)))&&(r=s)}),r||new Date(NaN)}function SR(e){let r;return e.forEach(t=>{const s=Qt(t);(!r||r>s||isNaN(+s))&&(r=s)}),r||new Date(NaN)}function Mn(e,r){const t=Mo(e),s=Mo(r);return+t==+s}function Xp(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function bR(e){if(!Xp(e)&&typeof e!="number")return!1;const r=Qt(e);return!isNaN(Number(r))}function Jl(e,r){const t=Qt(e),s=Qt(r),a=t.getFullYear()-s.getFullYear(),o=t.getMonth()-s.getMonth();return a*12+o}function jR(e,r,t){const s=ra(e,t),a=ra(r,t),o=+s-Nu(s),c=+a-Nu(a);return Math.round((o-c)/Kp)}function Jp(e){const r=Qt(e),t=r.getMonth();return r.setFullYear(r.getFullYear(),t+1,0),r.setHours(23,59,59,999),r}function Bn(e){const r=Qt(e);return r.setDate(1),r.setHours(0,0,0,0),r}function NN(e){const r=Qt(e),t=os(e,0);return t.setFullYear(r.getFullYear(),0,1),t.setHours(0,0,0,0),t}function Zp(e,r){const t=Nc(),s=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=Qt(e),o=a.getDay(),c=(o<s?-7:0)+6-(o-s);return a.setDate(a.getDate()+c),a.setHours(23,59,59,999),a}function SN(e){return Zp(e,{weekStartsOn:1})}const kR={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},_R=(e,r,t)=>{let s;const a=kR[e];return typeof a=="string"?s=a:r===1?s=a.one:s=a.other.replace("{{count}}",r.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+s:s+" ago":s};function Nh(e){return(r={})=>{const t=r.width?String(r.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const CR={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ER={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},AR={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},TR={date:Nh({formats:CR,defaultWidth:"full"}),time:Nh({formats:ER,defaultWidth:"full"}),dateTime:Nh({formats:AR,defaultWidth:"full"})},OR={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},PR=(e,r,t,s)=>OR[e];function Ll(e){return(r,t)=>{const s=t?.context?String(t.context):"standalone";let a;if(s==="formatting"&&e.formattingValues){const c=e.defaultFormattingWidth||e.defaultWidth,u=t?.width?String(t.width):c;a=e.formattingValues[u]||e.formattingValues[c]}else{const c=e.defaultWidth,u=t?.width?String(t.width):e.defaultWidth;a=e.values[u]||e.values[c]}const o=e.argumentCallback?e.argumentCallback(r):r;return a[o]}}const RR={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},DR={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},FR={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},MR={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},LR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},IR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},BR=(e,r)=>{const t=Number(e),s=t%100;if(s>20||s<10)switch(s%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},$R={ordinalNumber:BR,era:Ll({values:RR,defaultWidth:"wide"}),quarter:Ll({values:DR,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ll({values:FR,defaultWidth:"wide"}),day:Ll({values:MR,defaultWidth:"wide"}),dayPeriod:Ll({values:LR,defaultWidth:"wide",formattingValues:IR,defaultFormattingWidth:"wide"})};function Il(e){return(r,t={})=>{const s=t.width,a=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],o=r.match(a);if(!o)return null;const c=o[0],u=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],p=Array.isArray(u)?zR(u,y=>y.test(c)):UR(u,y=>y.test(c));let h;h=e.valueCallback?e.valueCallback(p):p,h=t.valueCallback?t.valueCallback(h):h;const x=r.slice(c.length);return{value:h,rest:x}}}function UR(e,r){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&r(e[t]))return t}function zR(e,r){for(let t=0;t<e.length;t++)if(r(e[t]))return t}function WR(e){return(r,t={})=>{const s=r.match(e.matchPattern);if(!s)return null;const a=s[0],o=r.match(e.parsePattern);if(!o)return null;let c=e.valueCallback?e.valueCallback(o[0]):o[0];c=t.valueCallback?t.valueCallback(c):c;const u=r.slice(a.length);return{value:c,rest:u}}}const qR=/^(\d+)(th|st|nd|rd)?/i,VR=/\d+/i,QR={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},HR={any:[/^b/i,/^(a|c)/i]},GR={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},YR={any:[/1/i,/2/i,/3/i,/4/i]},KR={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},XR={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},JR={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ZR={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},e5={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},t5={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},r5={ordinalNumber:WR({matchPattern:qR,parsePattern:VR,valueCallback:e=>parseInt(e,10)}),era:Il({matchPatterns:QR,defaultMatchWidth:"wide",parsePatterns:HR,defaultParseWidth:"any"}),quarter:Il({matchPatterns:GR,defaultMatchWidth:"wide",parsePatterns:YR,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Il({matchPatterns:KR,defaultMatchWidth:"wide",parsePatterns:XR,defaultParseWidth:"any"}),day:Il({matchPatterns:JR,defaultMatchWidth:"wide",parsePatterns:ZR,defaultParseWidth:"any"}),dayPeriod:Il({matchPatterns:e5,defaultMatchWidth:"any",parsePatterns:t5,defaultParseWidth:"any"})},bN={code:"en-US",formatDistance:_R,formatLong:TR,formatRelative:PR,localize:$R,match:r5,options:{weekStartsOn:0,firstWeekContainsDate:1}};function n5(e){const r=Qt(e);return Js(r,NN(r))+1}function jN(e){const r=Qt(e),t=+Li(r)-+vR(r);return Math.round(t/Kp)+1}function kN(e,r){const t=Qt(e),s=t.getFullYear(),a=Nc(),o=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,c=os(e,0);c.setFullYear(s+1,0,o),c.setHours(0,0,0,0);const u=ra(c,r),p=os(e,0);p.setFullYear(s,0,o),p.setHours(0,0,0,0);const h=ra(p,r);return t.getTime()>=u.getTime()?s+1:t.getTime()>=h.getTime()?s:s-1}function s5(e,r){const t=Nc(),s=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=kN(e,r),o=os(e,0);return o.setFullYear(a,0,s),o.setHours(0,0,0,0),ra(o,r)}function _N(e,r){const t=Qt(e),s=+ra(t,r)-+s5(t,r);return Math.round(s/Kp)+1}function rr(e,r){const t=e<0?"-":"",s=Math.abs(e).toString().padStart(r,"0");return t+s}const Ya={y(e,r){const t=e.getFullYear(),s=t>0?t:1-t;return rr(r==="yy"?s%100:s,r.length)},M(e,r){const t=e.getMonth();return r==="M"?String(t+1):rr(t+1,2)},d(e,r){return rr(e.getDate(),r.length)},a(e,r){const t=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,r){return rr(e.getHours()%12||12,r.length)},H(e,r){return rr(e.getHours(),r.length)},m(e,r){return rr(e.getMinutes(),r.length)},s(e,r){return rr(e.getSeconds(),r.length)},S(e,r){const t=r.length,s=e.getMilliseconds(),a=Math.trunc(s*Math.pow(10,t-3));return rr(a,r.length)}},No={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},gv={G:function(e,r,t){const s=e.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return t.era(s,{width:"abbreviated"});case"GGGGG":return t.era(s,{width:"narrow"});case"GGGG":default:return t.era(s,{width:"wide"})}},y:function(e,r,t){if(r==="yo"){const s=e.getFullYear(),a=s>0?s:1-s;return t.ordinalNumber(a,{unit:"year"})}return Ya.y(e,r)},Y:function(e,r,t,s){const a=kN(e,s),o=a>0?a:1-a;if(r==="YY"){const c=o%100;return rr(c,2)}return r==="Yo"?t.ordinalNumber(o,{unit:"year"}):rr(o,r.length)},R:function(e,r){const t=wN(e);return rr(t,r.length)},u:function(e,r){const t=e.getFullYear();return rr(t,r.length)},Q:function(e,r,t){const s=Math.ceil((e.getMonth()+1)/3);switch(r){case"Q":return String(s);case"QQ":return rr(s,2);case"Qo":return t.ordinalNumber(s,{unit:"quarter"});case"QQQ":return t.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,r,t){const s=Math.ceil((e.getMonth()+1)/3);switch(r){case"q":return String(s);case"qq":return rr(s,2);case"qo":return t.ordinalNumber(s,{unit:"quarter"});case"qqq":return t.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,r,t){const s=e.getMonth();switch(r){case"M":case"MM":return Ya.M(e,r);case"Mo":return t.ordinalNumber(s+1,{unit:"month"});case"MMM":return t.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(s,{width:"wide",context:"formatting"})}},L:function(e,r,t){const s=e.getMonth();switch(r){case"L":return String(s+1);case"LL":return rr(s+1,2);case"Lo":return t.ordinalNumber(s+1,{unit:"month"});case"LLL":return t.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(s,{width:"wide",context:"standalone"})}},w:function(e,r,t,s){const a=_N(e,s);return r==="wo"?t.ordinalNumber(a,{unit:"week"}):rr(a,r.length)},I:function(e,r,t){const s=jN(e);return r==="Io"?t.ordinalNumber(s,{unit:"week"}):rr(s,r.length)},d:function(e,r,t){return r==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):Ya.d(e,r)},D:function(e,r,t){const s=n5(e);return r==="Do"?t.ordinalNumber(s,{unit:"dayOfYear"}):rr(s,r.length)},E:function(e,r,t){const s=e.getDay();switch(r){case"E":case"EE":case"EEE":return t.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(s,{width:"short",context:"formatting"});case"EEEE":default:return t.day(s,{width:"wide",context:"formatting"})}},e:function(e,r,t,s){const a=e.getDay(),o=(a-s.weekStartsOn+8)%7||7;switch(r){case"e":return String(o);case"ee":return rr(o,2);case"eo":return t.ordinalNumber(o,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,r,t,s){const a=e.getDay(),o=(a-s.weekStartsOn+8)%7||7;switch(r){case"c":return String(o);case"cc":return rr(o,r.length);case"co":return t.ordinalNumber(o,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,r,t){const s=e.getDay(),a=s===0?7:s;switch(r){case"i":return String(a);case"ii":return rr(a,r.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(s,{width:"short",context:"formatting"});case"iiii":default:return t.day(s,{width:"wide",context:"formatting"})}},a:function(e,r,t){const a=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,r,t){const s=e.getHours();let a;switch(s===12?a=No.noon:s===0?a=No.midnight:a=s/12>=1?"pm":"am",r){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,r,t){const s=e.getHours();let a;switch(s>=17?a=No.evening:s>=12?a=No.afternoon:s>=4?a=No.morning:a=No.night,r){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,r,t){if(r==="ho"){let s=e.getHours()%12;return s===0&&(s=12),t.ordinalNumber(s,{unit:"hour"})}return Ya.h(e,r)},H:function(e,r,t){return r==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):Ya.H(e,r)},K:function(e,r,t){const s=e.getHours()%12;return r==="Ko"?t.ordinalNumber(s,{unit:"hour"}):rr(s,r.length)},k:function(e,r,t){let s=e.getHours();return s===0&&(s=24),r==="ko"?t.ordinalNumber(s,{unit:"hour"}):rr(s,r.length)},m:function(e,r,t){return r==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ya.m(e,r)},s:function(e,r,t){return r==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):Ya.s(e,r)},S:function(e,r){return Ya.S(e,r)},X:function(e,r,t){const s=e.getTimezoneOffset();if(s===0)return"Z";switch(r){case"X":return vv(s);case"XXXX":case"XX":return _i(s);case"XXXXX":case"XXX":default:return _i(s,":")}},x:function(e,r,t){const s=e.getTimezoneOffset();switch(r){case"x":return vv(s);case"xxxx":case"xx":return _i(s);case"xxxxx":case"xxx":default:return _i(s,":")}},O:function(e,r,t){const s=e.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+yv(s,":");case"OOOO":default:return"GMT"+_i(s,":")}},z:function(e,r,t){const s=e.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+yv(s,":");case"zzzz":default:return"GMT"+_i(s,":")}},t:function(e,r,t){const s=Math.trunc(e.getTime()/1e3);return rr(s,r.length)},T:function(e,r,t){const s=e.getTime();return rr(s,r.length)}};function yv(e,r=""){const t=e>0?"-":"+",s=Math.abs(e),a=Math.trunc(s/60),o=s%60;return o===0?t+String(a):t+String(a)+r+rr(o,2)}function vv(e,r){return e%60===0?(e>0?"-":"+")+rr(Math.abs(e)/60,2):_i(e,r)}function _i(e,r=""){const t=e>0?"-":"+",s=Math.abs(e),a=rr(Math.trunc(s/60),2),o=rr(s%60,2);return t+a+r+o}const wv=(e,r)=>{switch(e){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},CN=(e,r)=>{switch(e){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},a5=(e,r)=>{const t=e.match(/(P+)(p+)?/)||[],s=t[1],a=t[2];if(!a)return wv(e,r);let o;switch(s){case"P":o=r.dateTime({width:"short"});break;case"PP":o=r.dateTime({width:"medium"});break;case"PPP":o=r.dateTime({width:"long"});break;case"PPPP":default:o=r.dateTime({width:"full"});break}return o.replace("{{date}}",wv(s,r)).replace("{{time}}",CN(a,r))},i5={p:CN,P:a5},o5=/^D+$/,l5=/^Y+$/,c5=["D","DD","YY","YYYY"];function d5(e){return o5.test(e)}function u5(e){return l5.test(e)}function f5(e,r,t){const s=h5(e,r,t);if(console.warn(s),c5.includes(e))throw new RangeError(s)}function h5(e,r,t){const s=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${r}\`) for formatting ${s} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const p5=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,m5=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,x5=/^'([^]*?)'?$/,g5=/''/g,y5=/[a-zA-Z]/;function Fr(e,r,t){const s=Nc(),a=t?.locale??s.locale??bN,o=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,c=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??s.weekStartsOn??s.locale?.options?.weekStartsOn??0,u=Qt(e);if(!bR(u))throw new RangeError("Invalid time value");let p=r.match(m5).map(x=>{const y=x[0];if(y==="p"||y==="P"){const v=i5[y];return v(x,a.formatLong)}return x}).join("").match(p5).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const y=x[0];if(y==="'")return{isToken:!1,value:v5(x)};if(gv[y])return{isToken:!0,value:x};if(y.match(y5))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:x}});a.localize.preprocessor&&(p=a.localize.preprocessor(u,p));const h={firstWeekContainsDate:o,weekStartsOn:c,locale:a};return p.map(x=>{if(!x.isToken)return x.value;const y=x.value;(!t?.useAdditionalWeekYearTokens&&u5(y)||!t?.useAdditionalDayOfYearTokens&&d5(y))&&f5(y,r,String(e));const v=gv[y[0]];return v(u,y,a.localize,h)}).join("")}function v5(e){const r=e.match(x5);return r?r[1].replace(g5,"'"):e}function w5(e){const r=Qt(e),t=r.getFullYear(),s=r.getMonth(),a=os(e,0);return a.setFullYear(t,s+1,0),a.setHours(0,0,0,0),a.getDate()}function N5(e){return Math.trunc(+Qt(e)/1e3)}function S5(e){const r=Qt(e),t=r.getMonth();return r.setFullYear(r.getFullYear(),t+1,0),r.setHours(0,0,0,0),r}function b5(e,r){return jR(S5(e),Bn(e),r)+1}function lp(e,r){const t=Qt(e),s=Qt(r);return t.getTime()>s.getTime()}function EN(e,r){const t=Qt(e),s=Qt(r);return+t<+s}function em(e,r){const t=Qt(e),s=Qt(r);return t.getFullYear()===s.getFullYear()&&t.getMonth()===s.getMonth()}function j5(e,r){const t=Qt(e),s=Qt(r);return t.getFullYear()===s.getFullYear()}function Sh(e,r){return Sn(e,-r)}function bh(e,r){const t=Qt(e),s=t.getFullYear(),a=t.getDate(),o=os(e,0);o.setFullYear(s,r,15),o.setHours(0,0,0,0);const c=w5(o);return t.setMonth(r,Math.min(a,c)),t}function Nv(e,r){const t=Qt(e);return isNaN(+t)?os(e,NaN):(t.setFullYear(r),t)}var bt=function(){return bt=Object.assign||function(r){for(var t,s=1,a=arguments.length;s<a;s++){t=arguments[s];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},bt.apply(this,arguments)};function k5(e,r){var t={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)r.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(t[s[a]]=e[s[a]]);return t}function AN(e,r,t){for(var s=0,a=r.length,o;s<a;s++)(o||!(s in r))&&(o||(o=Array.prototype.slice.call(r,0,s)),o[s]=r[s]);return e.concat(o||Array.prototype.slice.call(r))}function Sc(e){return e.mode==="multiple"}function bc(e){return e.mode==="range"}function l0(e){return e.mode==="single"}var _5={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function C5(e,r){return Fr(e,"LLLL y",r)}function E5(e,r){return Fr(e,"d",r)}function A5(e,r){return Fr(e,"LLLL",r)}function T5(e){return"".concat(e)}function O5(e,r){return Fr(e,"cccccc",r)}function P5(e,r){return Fr(e,"yyyy",r)}var R5=Object.freeze({__proto__:null,formatCaption:C5,formatDay:E5,formatMonthCaption:A5,formatWeekNumber:T5,formatWeekdayName:O5,formatYearCaption:P5}),D5=function(e,r,t){return Fr(e,"do MMMM (EEEE)",t)},F5=function(){return"Month: "},M5=function(){return"Go to next month"},L5=function(){return"Go to previous month"},I5=function(e,r){return Fr(e,"cccc",r)},B5=function(e){return"Week n. ".concat(e)},$5=function(){return"Year: "},U5=Object.freeze({__proto__:null,labelDay:D5,labelMonthDropdown:F5,labelNext:M5,labelPrevious:L5,labelWeekNumber:B5,labelWeekday:I5,labelYearDropdown:$5});function z5(){var e="buttons",r=_5,t=bN,s={},a={},o=1,c={},u=new Date;return{captionLayout:e,classNames:r,formatters:R5,labels:U5,locale:t,modifiersClassNames:s,modifiers:a,numberOfMonths:o,styles:c,today:u,mode:"default"}}function W5(e){var r=e.fromYear,t=e.toYear,s=e.fromMonth,a=e.toMonth,o=e.fromDate,c=e.toDate;return s?o=Bn(s):r&&(o=new Date(r,0,1)),a?c=Jp(a):t&&(c=new Date(t,11,31)),{fromDate:o?Mo(o):void 0,toDate:c?Mo(c):void 0}}var TN=m.createContext(void 0);function q5(e){var r,t=e.initialProps,s=z5(),a=W5(t),o=a.fromDate,c=a.toDate,u=(r=t.captionLayout)!==null&&r!==void 0?r:s.captionLayout;u!=="buttons"&&(!o||!c)&&(u="buttons");var p;(l0(t)||Sc(t)||bc(t))&&(p=t.onSelect);var h=bt(bt(bt({},s),t),{captionLayout:u,classNames:bt(bt({},s.classNames),t.classNames),components:bt({},t.components),formatters:bt(bt({},s.formatters),t.formatters),fromDate:o,labels:bt(bt({},s.labels),t.labels),mode:t.mode||s.mode,modifiers:bt(bt({},s.modifiers),t.modifiers),modifiersClassNames:bt(bt({},s.modifiersClassNames),t.modifiersClassNames),onSelect:p,styles:bt(bt({},s.styles),t.styles),toDate:c});return n.jsx(TN.Provider,{value:h,children:e.children})}function gr(){var e=m.useContext(TN);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function ON(e){var r=gr(),t=r.locale,s=r.classNames,a=r.styles,o=r.formatters.formatCaption;return n.jsx("div",{className:s.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:o(e.displayMonth,{locale:t})})}function V5(e){return n.jsx("svg",bt({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:n.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function PN(e){var r,t,s=e.onChange,a=e.value,o=e.children,c=e.caption,u=e.className,p=e.style,h=gr(),x=(t=(r=h.components)===null||r===void 0?void 0:r.IconDropdown)!==null&&t!==void 0?t:V5;return n.jsxs("div",{className:u,style:p,children:[n.jsx("span",{className:h.classNames.vhidden,children:e["aria-label"]}),n.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:h.classNames.dropdown,style:h.styles.dropdown,value:a,onChange:s,children:o}),n.jsxs("div",{className:h.classNames.caption_label,style:h.styles.caption_label,"aria-hidden":"true",children:[c,n.jsx(x,{className:h.classNames.dropdown_icon,style:h.styles.dropdown_icon})]})]})}function Q5(e){var r,t=gr(),s=t.fromDate,a=t.toDate,o=t.styles,c=t.locale,u=t.formatters.formatMonthCaption,p=t.classNames,h=t.components,x=t.labels.labelMonthDropdown;if(!s)return n.jsx(n.Fragment,{});if(!a)return n.jsx(n.Fragment,{});var y=[];if(j5(s,a))for(var v=Bn(s),k=s.getMonth();k<=a.getMonth();k++)y.push(bh(v,k));else for(var v=Bn(new Date),k=0;k<=11;k++)y.push(bh(v,k));var b=function(j){var O=Number(j.target.value),T=bh(Bn(e.displayMonth),O);e.onChange(T)},w=(r=h?.Dropdown)!==null&&r!==void 0?r:PN;return n.jsx(w,{name:"months","aria-label":x(),className:p.dropdown_month,style:o.dropdown_month,onChange:b,value:e.displayMonth.getMonth(),caption:u(e.displayMonth,{locale:c}),children:y.map(function(j){return n.jsx("option",{value:j.getMonth(),children:u(j,{locale:c})},j.getMonth())})})}function H5(e){var r,t=e.displayMonth,s=gr(),a=s.fromDate,o=s.toDate,c=s.locale,u=s.styles,p=s.classNames,h=s.components,x=s.formatters.formatYearCaption,y=s.labels.labelYearDropdown,v=[];if(!a)return n.jsx(n.Fragment,{});if(!o)return n.jsx(n.Fragment,{});for(var k=a.getFullYear(),b=o.getFullYear(),w=k;w<=b;w++)v.push(Nv(NN(new Date),w));var j=function(T){var F=Nv(Bn(t),Number(T.target.value));e.onChange(F)},O=(r=h?.Dropdown)!==null&&r!==void 0?r:PN;return n.jsx(O,{name:"years","aria-label":y(),className:p.dropdown_year,style:u.dropdown_year,onChange:j,value:t.getFullYear(),caption:x(t,{locale:c}),children:v.map(function(T){return n.jsx("option",{value:T.getFullYear(),children:x(T,{locale:c})},T.getFullYear())})})}function G5(e,r){var t=m.useState(e),s=t[0],a=t[1],o=r===void 0?s:r;return[o,a]}function Y5(e){var r=e.month,t=e.defaultMonth,s=e.today,a=r||t||s||new Date,o=e.toDate,c=e.fromDate,u=e.numberOfMonths,p=u===void 0?1:u;if(o&&Jl(o,a)<0){var h=-1*(p-1);a=Ms(o,h)}return c&&Jl(a,c)<0&&(a=c),Bn(a)}function K5(){var e=gr(),r=Y5(e),t=G5(r,e.month),s=t[0],a=t[1],o=function(c){var u;if(!e.disableNavigation){var p=Bn(c);a(p),(u=e.onMonthChange)===null||u===void 0||u.call(e,p)}};return[s,o]}function X5(e,r){for(var t=r.reverseMonths,s=r.numberOfMonths,a=Bn(e),o=Bn(Ms(a,s)),c=Jl(o,a),u=[],p=0;p<c;p++){var h=Ms(a,p);u.push(h)}return t&&(u=u.reverse()),u}function J5(e,r){if(!r.disableNavigation){var t=r.toDate,s=r.pagedNavigation,a=r.numberOfMonths,o=a===void 0?1:a,c=s?o:1,u=Bn(e);if(!t)return Ms(u,c);var p=Jl(t,e);if(!(p<o))return Ms(u,c)}}function Z5(e,r){if(!r.disableNavigation){var t=r.fromDate,s=r.pagedNavigation,a=r.numberOfMonths,o=a===void 0?1:a,c=s?o:1,u=Bn(e);if(!t)return Ms(u,-c);var p=Jl(u,t);if(!(p<=0))return Ms(u,-c)}}var RN=m.createContext(void 0);function eD(e){var r=gr(),t=K5(),s=t[0],a=t[1],o=X5(s,r),c=J5(s,r),u=Z5(s,r),p=function(y){return o.some(function(v){return em(y,v)})},h=function(y,v){p(y)||(v&&EN(y,v)?a(Ms(y,1+r.numberOfMonths*-1)):a(y))},x={currentMonth:s,displayMonths:o,goToMonth:a,goToDate:h,previousMonth:u,nextMonth:c,isDateDisplayed:p};return n.jsx(RN.Provider,{value:x,children:e.children})}function jc(){var e=m.useContext(RN);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function Sv(e){var r,t=gr(),s=t.classNames,a=t.styles,o=t.components,c=jc().goToMonth,u=function(x){c(Ms(x,e.displayIndex?-e.displayIndex:0))},p=(r=o?.CaptionLabel)!==null&&r!==void 0?r:ON,h=n.jsx(p,{id:e.id,displayMonth:e.displayMonth});return n.jsxs("div",{className:s.caption_dropdowns,style:a.caption_dropdowns,children:[n.jsx("div",{className:s.vhidden,children:h}),n.jsx(Q5,{onChange:u,displayMonth:e.displayMonth}),n.jsx(H5,{onChange:u,displayMonth:e.displayMonth})]})}function tD(e){return n.jsx("svg",bt({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:n.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function rD(e){return n.jsx("svg",bt({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:n.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var Su=m.forwardRef(function(e,r){var t=gr(),s=t.classNames,a=t.styles,o=[s.button_reset,s.button];e.className&&o.push(e.className);var c=o.join(" "),u=bt(bt({},a.button_reset),a.button);return e.style&&Object.assign(u,e.style),n.jsx("button",bt({},e,{ref:r,type:"button",className:c,style:u}))});function nD(e){var r,t,s=gr(),a=s.dir,o=s.locale,c=s.classNames,u=s.styles,p=s.labels,h=p.labelPrevious,x=p.labelNext,y=s.components;if(!e.nextMonth&&!e.previousMonth)return n.jsx(n.Fragment,{});var v=h(e.previousMonth,{locale:o}),k=[c.nav_button,c.nav_button_previous].join(" "),b=x(e.nextMonth,{locale:o}),w=[c.nav_button,c.nav_button_next].join(" "),j=(r=y?.IconRight)!==null&&r!==void 0?r:rD,O=(t=y?.IconLeft)!==null&&t!==void 0?t:tD;return n.jsxs("div",{className:c.nav,style:u.nav,children:[!e.hidePrevious&&n.jsx(Su,{name:"previous-month","aria-label":v,className:k,style:u.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?n.jsx(j,{className:c.nav_icon,style:u.nav_icon}):n.jsx(O,{className:c.nav_icon,style:u.nav_icon})}),!e.hideNext&&n.jsx(Su,{name:"next-month","aria-label":b,className:w,style:u.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?n.jsx(O,{className:c.nav_icon,style:u.nav_icon}):n.jsx(j,{className:c.nav_icon,style:u.nav_icon})})]})}function bv(e){var r=gr().numberOfMonths,t=jc(),s=t.previousMonth,a=t.nextMonth,o=t.goToMonth,c=t.displayMonths,u=c.findIndex(function(b){return em(e.displayMonth,b)}),p=u===0,h=u===c.length-1,x=r>1&&(p||!h),y=r>1&&(h||!p),v=function(){s&&o(s)},k=function(){a&&o(a)};return n.jsx(nD,{displayMonth:e.displayMonth,hideNext:x,hidePrevious:y,nextMonth:a,previousMonth:s,onPreviousClick:v,onNextClick:k})}function sD(e){var r,t=gr(),s=t.classNames,a=t.disableNavigation,o=t.styles,c=t.captionLayout,u=t.components,p=(r=u?.CaptionLabel)!==null&&r!==void 0?r:ON,h;return a?h=n.jsx(p,{id:e.id,displayMonth:e.displayMonth}):c==="dropdown"?h=n.jsx(Sv,{displayMonth:e.displayMonth,id:e.id}):c==="dropdown-buttons"?h=n.jsxs(n.Fragment,{children:[n.jsx(Sv,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),n.jsx(bv,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):h=n.jsxs(n.Fragment,{children:[n.jsx(p,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),n.jsx(bv,{displayMonth:e.displayMonth,id:e.id})]}),n.jsx("div",{className:s.caption,style:o.caption,children:h})}function aD(e){var r=gr(),t=r.footer,s=r.styles,a=r.classNames.tfoot;return t?n.jsx("tfoot",{className:a,style:s.tfoot,children:n.jsx("tr",{children:n.jsx("td",{colSpan:8,children:t})})}):n.jsx(n.Fragment,{})}function iD(e,r,t){for(var s=t?Li(new Date):ra(new Date,{locale:e,weekStartsOn:r}),a=[],o=0;o<7;o++){var c=Sn(s,o);a.push(c)}return a}function oD(){var e=gr(),r=e.classNames,t=e.styles,s=e.showWeekNumber,a=e.locale,o=e.weekStartsOn,c=e.ISOWeek,u=e.formatters.formatWeekdayName,p=e.labels.labelWeekday,h=iD(a,o,c);return n.jsxs("tr",{style:t.head_row,className:r.head_row,children:[s&&n.jsx("td",{style:t.head_cell,className:r.head_cell}),h.map(function(x,y){return n.jsx("th",{scope:"col",className:r.head_cell,style:t.head_cell,"aria-label":p(x,{locale:a}),children:u(x,{locale:a})},y)})]})}function lD(){var e,r=gr(),t=r.classNames,s=r.styles,a=r.components,o=(e=a?.HeadRow)!==null&&e!==void 0?e:oD;return n.jsx("thead",{style:s.head,className:t.head,children:n.jsx(o,{})})}function cD(e){var r=gr(),t=r.locale,s=r.formatters.formatDay;return n.jsx(n.Fragment,{children:s(e.date,{locale:t})})}var tm=m.createContext(void 0);function dD(e){if(!Sc(e.initialProps)){var r={selected:void 0,modifiers:{disabled:[]}};return n.jsx(tm.Provider,{value:r,children:e.children})}return n.jsx(uD,{initialProps:e.initialProps,children:e.children})}function uD(e){var r=e.initialProps,t=e.children,s=r.selected,a=r.min,o=r.max,c=function(h,x,y){var v,k;(v=r.onDayClick)===null||v===void 0||v.call(r,h,x,y);var b=!!(x.selected&&a&&s?.length===a);if(!b){var w=!!(!x.selected&&o&&s?.length===o);if(!w){var j=s?AN([],s):[];if(x.selected){var O=j.findIndex(function(T){return Mn(h,T)});j.splice(O,1)}else j.push(h);(k=r.onSelect)===null||k===void 0||k.call(r,j,h,x,y)}}},u={disabled:[]};s&&u.disabled.push(function(h){var x=o&&s.length>o-1,y=s.some(function(v){return Mn(v,h)});return!!(x&&!y)});var p={selected:s,onDayClick:c,modifiers:u};return n.jsx(tm.Provider,{value:p,children:t})}function rm(){var e=m.useContext(tm);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function fD(e,r){var t=r||{},s=t.from,a=t.to;return s&&a?Mn(a,e)&&Mn(s,e)?void 0:Mn(a,e)?{from:a,to:void 0}:Mn(s,e)?void 0:lp(s,e)?{from:e,to:a}:{from:s,to:e}:a?lp(e,a)?{from:a,to:e}:{from:e,to:a}:s?EN(e,s)?{from:e,to:s}:{from:s,to:e}:{from:e,to:void 0}}var nm=m.createContext(void 0);function hD(e){if(!bc(e.initialProps)){var r={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return n.jsx(nm.Provider,{value:r,children:e.children})}return n.jsx(pD,{initialProps:e.initialProps,children:e.children})}function pD(e){var r=e.initialProps,t=e.children,s=r.selected,a=s||{},o=a.from,c=a.to,u=r.min,p=r.max,h=function(k,b,w){var j,O;(j=r.onDayClick)===null||j===void 0||j.call(r,k,b,w);var T=fD(k,s);(O=r.onSelect)===null||O===void 0||O.call(r,T,k,b,w)},x={range_start:[],range_end:[],range_middle:[],disabled:[]};if(o?(x.range_start=[o],c?(x.range_end=[c],Mn(o,c)||(x.range_middle=[{after:o,before:c}])):x.range_end=[o]):c&&(x.range_start=[c],x.range_end=[c]),u&&(o&&!c&&x.disabled.push({after:Sh(o,u-1),before:Sn(o,u-1)}),o&&c&&x.disabled.push({after:o,before:Sn(o,u-1)}),!o&&c&&x.disabled.push({after:Sh(c,u-1),before:Sn(c,u-1)})),p){if(o&&!c&&(x.disabled.push({before:Sn(o,-p+1)}),x.disabled.push({after:Sn(o,p-1)})),o&&c){var y=Js(c,o)+1,v=p-y;x.disabled.push({before:Sh(o,v)}),x.disabled.push({after:Sn(c,v)})}!o&&c&&(x.disabled.push({before:Sn(c,-p+1)}),x.disabled.push({after:Sn(c,p-1)}))}return n.jsx(nm.Provider,{value:{selected:s,onDayClick:h,modifiers:x},children:t})}function sm(){var e=m.useContext(nm);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function du(e){return Array.isArray(e)?AN([],e):e!==void 0?[e]:[]}function mD(e){var r={};return Object.entries(e).forEach(function(t){var s=t[0],a=t[1];r[s]=du(a)}),r}var Ls;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Ls||(Ls={}));var xD=Ls.Selected,xa=Ls.Disabled,gD=Ls.Hidden,yD=Ls.Today,jh=Ls.RangeEnd,kh=Ls.RangeMiddle,_h=Ls.RangeStart,vD=Ls.Outside;function wD(e,r,t){var s,a=(s={},s[xD]=du(e.selected),s[xa]=du(e.disabled),s[gD]=du(e.hidden),s[yD]=[e.today],s[jh]=[],s[kh]=[],s[_h]=[],s[vD]=[],s);return e.fromDate&&a[xa].push({before:e.fromDate}),e.toDate&&a[xa].push({after:e.toDate}),Sc(e)?a[xa]=a[xa].concat(r.modifiers[xa]):bc(e)&&(a[xa]=a[xa].concat(t.modifiers[xa]),a[_h]=t.modifiers[_h],a[kh]=t.modifiers[kh],a[jh]=t.modifiers[jh]),a}var DN=m.createContext(void 0);function ND(e){var r=gr(),t=rm(),s=sm(),a=wD(r,t,s),o=mD(r.modifiers),c=bt(bt({},a),o);return n.jsx(DN.Provider,{value:c,children:e.children})}function FN(){var e=m.useContext(DN);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function SD(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function bD(e){return!!(e&&typeof e=="object"&&"from"in e)}function jD(e){return!!(e&&typeof e=="object"&&"after"in e)}function kD(e){return!!(e&&typeof e=="object"&&"before"in e)}function _D(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function CD(e,r){var t,s=r.from,a=r.to;if(s&&a){var o=Js(a,s)<0;o&&(t=[a,s],s=t[0],a=t[1]);var c=Js(e,s)>=0&&Js(a,e)>=0;return c}return a?Mn(a,e):s?Mn(s,e):!1}function ED(e){return Xp(e)}function AD(e){return Array.isArray(e)&&e.every(Xp)}function TD(e,r){return r.some(function(t){if(typeof t=="boolean")return t;if(ED(t))return Mn(e,t);if(AD(t))return t.includes(e);if(bD(t))return CD(e,t);if(_D(t))return t.dayOfWeek.includes(e.getDay());if(SD(t)){var s=Js(t.before,e),a=Js(t.after,e),o=s>0,c=a<0,u=lp(t.before,t.after);return u?c&&o:o||c}return jD(t)?Js(e,t.after)>0:kD(t)?Js(t.before,e)>0:typeof t=="function"?t(e):!1})}function am(e,r,t){var s=Object.keys(r).reduce(function(o,c){var u=r[c];return TD(e,u)&&o.push(c),o},[]),a={};return s.forEach(function(o){return a[o]=!0}),t&&!em(e,t)&&(a.outside=!0),a}function OD(e,r){for(var t=Bn(e[0]),s=Jp(e[e.length-1]),a,o,c=t;c<=s;){var u=am(c,r),p=!u.disabled&&!u.hidden;if(!p){c=Sn(c,1);continue}if(u.selected)return c;u.today&&!o&&(o=c),a||(a=c),c=Sn(c,1)}return o||a}var PD=365;function MN(e,r){var t=r.moveBy,s=r.direction,a=r.context,o=r.modifiers,c=r.retry,u=c===void 0?{count:0,lastFocused:e}:c,p=a.weekStartsOn,h=a.fromDate,x=a.toDate,y=a.locale,v={day:Sn,week:op,month:Ms,year:wR,startOfWeek:function(j){return a.ISOWeek?Li(j):ra(j,{locale:y,weekStartsOn:p})},endOfWeek:function(j){return a.ISOWeek?SN(j):Zp(j,{locale:y,weekStartsOn:p})}},k=v[t](e,s==="after"?1:-1);s==="before"&&h?k=NR([h,k]):s==="after"&&x&&(k=SR([x,k]));var b=!0;if(o){var w=am(k,o);b=!w.disabled&&!w.hidden}return b?k:u.count>PD?u.lastFocused:MN(k,{moveBy:t,direction:s,context:a,modifiers:o,retry:bt(bt({},u),{count:u.count+1})})}var LN=m.createContext(void 0);function RD(e){var r=jc(),t=FN(),s=m.useState(),a=s[0],o=s[1],c=m.useState(),u=c[0],p=c[1],h=OD(r.displayMonths,t),x=a??(u&&r.isDateDisplayed(u))?u:h,y=function(){p(a),o(void 0)},v=function(j){o(j)},k=gr(),b=function(j,O){if(a){var T=MN(a,{moveBy:j,direction:O,context:k,modifiers:t});Mn(a,T)||(r.goToDate(T,a),v(T))}},w={focusedDay:a,focusTarget:x,blur:y,focus:v,focusDayAfter:function(){return b("day","after")},focusDayBefore:function(){return b("day","before")},focusWeekAfter:function(){return b("week","after")},focusWeekBefore:function(){return b("week","before")},focusMonthBefore:function(){return b("month","before")},focusMonthAfter:function(){return b("month","after")},focusYearBefore:function(){return b("year","before")},focusYearAfter:function(){return b("year","after")},focusStartOfWeek:function(){return b("startOfWeek","before")},focusEndOfWeek:function(){return b("endOfWeek","after")}};return n.jsx(LN.Provider,{value:w,children:e.children})}function im(){var e=m.useContext(LN);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function DD(e,r){var t=FN(),s=am(e,t,r);return s}var om=m.createContext(void 0);function FD(e){if(!l0(e.initialProps)){var r={selected:void 0};return n.jsx(om.Provider,{value:r,children:e.children})}return n.jsx(MD,{initialProps:e.initialProps,children:e.children})}function MD(e){var r=e.initialProps,t=e.children,s=function(o,c,u){var p,h,x;if((p=r.onDayClick)===null||p===void 0||p.call(r,o,c,u),c.selected&&!r.required){(h=r.onSelect)===null||h===void 0||h.call(r,void 0,o,c,u);return}(x=r.onSelect)===null||x===void 0||x.call(r,o,o,c,u)},a={selected:r.selected,onDayClick:s};return n.jsx(om.Provider,{value:a,children:t})}function IN(){var e=m.useContext(om);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function LD(e,r){var t=gr(),s=IN(),a=rm(),o=sm(),c=im(),u=c.focusDayAfter,p=c.focusDayBefore,h=c.focusWeekAfter,x=c.focusWeekBefore,y=c.blur,v=c.focus,k=c.focusMonthBefore,b=c.focusMonthAfter,w=c.focusYearBefore,j=c.focusYearAfter,O=c.focusStartOfWeek,T=c.focusEndOfWeek,F=function(oe){var V,de,Ne,ee;l0(t)?(V=s.onDayClick)===null||V===void 0||V.call(s,e,r,oe):Sc(t)?(de=a.onDayClick)===null||de===void 0||de.call(a,e,r,oe):bc(t)?(Ne=o.onDayClick)===null||Ne===void 0||Ne.call(o,e,r,oe):(ee=t.onDayClick)===null||ee===void 0||ee.call(t,e,r,oe)},I=function(oe){var V;v(e),(V=t.onDayFocus)===null||V===void 0||V.call(t,e,r,oe)},G=function(oe){var V;y(),(V=t.onDayBlur)===null||V===void 0||V.call(t,e,r,oe)},B=function(oe){var V;(V=t.onDayMouseEnter)===null||V===void 0||V.call(t,e,r,oe)},Q=function(oe){var V;(V=t.onDayMouseLeave)===null||V===void 0||V.call(t,e,r,oe)},z=function(oe){var V;(V=t.onDayPointerEnter)===null||V===void 0||V.call(t,e,r,oe)},J=function(oe){var V;(V=t.onDayPointerLeave)===null||V===void 0||V.call(t,e,r,oe)},ne=function(oe){var V;(V=t.onDayTouchCancel)===null||V===void 0||V.call(t,e,r,oe)},fe=function(oe){var V;(V=t.onDayTouchEnd)===null||V===void 0||V.call(t,e,r,oe)},me=function(oe){var V;(V=t.onDayTouchMove)===null||V===void 0||V.call(t,e,r,oe)},le=function(oe){var V;(V=t.onDayTouchStart)===null||V===void 0||V.call(t,e,r,oe)},K=function(oe){var V;(V=t.onDayKeyUp)===null||V===void 0||V.call(t,e,r,oe)},Fe=function(oe){var V;switch(oe.key){case"ArrowLeft":oe.preventDefault(),oe.stopPropagation(),t.dir==="rtl"?u():p();break;case"ArrowRight":oe.preventDefault(),oe.stopPropagation(),t.dir==="rtl"?p():u();break;case"ArrowDown":oe.preventDefault(),oe.stopPropagation(),h();break;case"ArrowUp":oe.preventDefault(),oe.stopPropagation(),x();break;case"PageUp":oe.preventDefault(),oe.stopPropagation(),oe.shiftKey?w():k();break;case"PageDown":oe.preventDefault(),oe.stopPropagation(),oe.shiftKey?j():b();break;case"Home":oe.preventDefault(),oe.stopPropagation(),O();break;case"End":oe.preventDefault(),oe.stopPropagation(),T();break}(V=t.onDayKeyDown)===null||V===void 0||V.call(t,e,r,oe)},we={onClick:F,onFocus:I,onBlur:G,onKeyDown:Fe,onKeyUp:K,onMouseEnter:B,onMouseLeave:Q,onPointerEnter:z,onPointerLeave:J,onTouchCancel:ne,onTouchEnd:fe,onTouchMove:me,onTouchStart:le};return we}function ID(){var e=gr(),r=IN(),t=rm(),s=sm(),a=l0(e)?r.selected:Sc(e)?t.selected:bc(e)?s.selected:void 0;return a}function BD(e){return Object.values(Ls).includes(e)}function $D(e,r){var t=[e.classNames.day];return Object.keys(r).forEach(function(s){var a=e.modifiersClassNames[s];if(a)t.push(a);else if(BD(s)){var o=e.classNames["day_".concat(s)];o&&t.push(o)}}),t}function UD(e,r){var t=bt({},e.styles.day);return Object.keys(r).forEach(function(s){var a;t=bt(bt({},t),(a=e.modifiersStyles)===null||a===void 0?void 0:a[s])}),t}function zD(e,r,t){var s,a,o,c=gr(),u=im(),p=DD(e,r),h=LD(e,p),x=ID(),y=!!(c.onDayClick||c.mode!=="default");m.useEffect(function(){var B;p.outside||u.focusedDay&&y&&Mn(u.focusedDay,e)&&((B=t.current)===null||B===void 0||B.focus())},[u.focusedDay,e,t,y,p.outside]);var v=$D(c,p).join(" "),k=UD(c,p),b=!!(p.outside&&!c.showOutsideDays||p.hidden),w=(o=(a=c.components)===null||a===void 0?void 0:a.DayContent)!==null&&o!==void 0?o:cD,j=n.jsx(w,{date:e,displayMonth:r,activeModifiers:p}),O={style:k,className:v,children:j,role:"gridcell"},T=u.focusTarget&&Mn(u.focusTarget,e)&&!p.outside,F=u.focusedDay&&Mn(u.focusedDay,e),I=bt(bt(bt({},O),(s={disabled:p.disabled,role:"gridcell"},s["aria-selected"]=p.selected,s.tabIndex=F||T?0:-1,s)),h),G={isButton:y,isHidden:b,activeModifiers:p,selectedDays:x,buttonProps:I,divProps:O};return G}function WD(e){var r=m.useRef(null),t=zD(e.date,e.displayMonth,r);return t.isHidden?n.jsx("div",{role:"gridcell"}):t.isButton?n.jsx(Su,bt({name:"day",ref:r},t.buttonProps)):n.jsx("div",bt({},t.divProps))}function qD(e){var r=e.number,t=e.dates,s=gr(),a=s.onWeekNumberClick,o=s.styles,c=s.classNames,u=s.locale,p=s.labels.labelWeekNumber,h=s.formatters.formatWeekNumber,x=h(Number(r),{locale:u});if(!a)return n.jsx("span",{className:c.weeknumber,style:o.weeknumber,children:x});var y=p(Number(r),{locale:u}),v=function(k){a(r,t,k)};return n.jsx(Su,{name:"week-number","aria-label":y,className:c.weeknumber,style:o.weeknumber,onClick:v,children:x})}function VD(e){var r,t,s=gr(),a=s.styles,o=s.classNames,c=s.showWeekNumber,u=s.components,p=(r=u?.Day)!==null&&r!==void 0?r:WD,h=(t=u?.WeekNumber)!==null&&t!==void 0?t:qD,x;return c&&(x=n.jsx("td",{className:o.cell,style:a.cell,children:n.jsx(h,{number:e.weekNumber,dates:e.dates})})),n.jsxs("tr",{className:o.row,style:a.row,children:[x,e.dates.map(function(y){return n.jsx("td",{className:o.cell,style:a.cell,role:"presentation",children:n.jsx(p,{displayMonth:e.displayMonth,date:y})},N5(y))})]})}function jv(e,r,t){for(var s=t?.ISOWeek?SN(r):Zp(r,t),a=t?.ISOWeek?Li(e):ra(e,t),o=Js(s,a),c=[],u=0;u<=o;u++)c.push(Sn(a,u));var p=c.reduce(function(h,x){var y=t?.ISOWeek?jN(x):_N(x,t),v=h.find(function(k){return k.weekNumber===y});return v?(v.dates.push(x),h):(h.push({weekNumber:y,dates:[x]}),h)},[]);return p}function QD(e,r){var t=jv(Bn(e),Jp(e),r);if(r?.useFixedWeeks){var s=b5(e,r);if(s<6){var a=t[t.length-1],o=a.dates[a.dates.length-1],c=op(o,6-s),u=jv(op(o,1),c,r);t.push.apply(t,u)}}return t}function HD(e){var r,t,s,a=gr(),o=a.locale,c=a.classNames,u=a.styles,p=a.hideHead,h=a.fixedWeeks,x=a.components,y=a.weekStartsOn,v=a.firstWeekContainsDate,k=a.ISOWeek,b=QD(e.displayMonth,{useFixedWeeks:!!h,ISOWeek:k,locale:o,weekStartsOn:y,firstWeekContainsDate:v}),w=(r=x?.Head)!==null&&r!==void 0?r:lD,j=(t=x?.Row)!==null&&t!==void 0?t:VD,O=(s=x?.Footer)!==null&&s!==void 0?s:aD;return n.jsxs("table",{id:e.id,className:c.table,style:u.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!p&&n.jsx(w,{}),n.jsx("tbody",{className:c.tbody,style:u.tbody,children:b.map(function(T){return n.jsx(j,{displayMonth:e.displayMonth,dates:T.dates,weekNumber:T.weekNumber},T.weekNumber)})}),n.jsx(O,{displayMonth:e.displayMonth})]})}function GD(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var YD=GD()?m.useLayoutEffect:m.useEffect,Ch=!1,KD=0;function kv(){return"react-day-picker-".concat(++KD)}function XD(e){var r,t=e??(Ch?kv():null),s=m.useState(t),a=s[0],o=s[1];return YD(function(){a===null&&o(kv())},[]),m.useEffect(function(){Ch===!1&&(Ch=!0)},[]),(r=e??a)!==null&&r!==void 0?r:void 0}function JD(e){var r,t,s=gr(),a=s.dir,o=s.classNames,c=s.styles,u=s.components,p=jc().displayMonths,h=XD(s.id?"".concat(s.id,"-").concat(e.displayIndex):void 0),x=s.id?"".concat(s.id,"-grid-").concat(e.displayIndex):void 0,y=[o.month],v=c.month,k=e.displayIndex===0,b=e.displayIndex===p.length-1,w=!k&&!b;a==="rtl"&&(r=[k,b],b=r[0],k=r[1]),k&&(y.push(o.caption_start),v=bt(bt({},v),c.caption_start)),b&&(y.push(o.caption_end),v=bt(bt({},v),c.caption_end)),w&&(y.push(o.caption_between),v=bt(bt({},v),c.caption_between));var j=(t=u?.Caption)!==null&&t!==void 0?t:sD;return n.jsxs("div",{className:y.join(" "),style:v,children:[n.jsx(j,{id:h,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),n.jsx(HD,{id:x,"aria-labelledby":h,displayMonth:e.displayMonth})]},e.displayIndex)}function ZD(e){var r=gr(),t=r.classNames,s=r.styles;return n.jsx("div",{className:t.months,style:s.months,children:e.children})}function eF(e){var r,t,s=e.initialProps,a=gr(),o=im(),c=jc(),u=m.useState(!1),p=u[0],h=u[1];m.useEffect(function(){a.initialFocus&&o.focusTarget&&(p||(o.focus(o.focusTarget),h(!0)))},[a.initialFocus,p,o.focus,o.focusTarget,o]);var x=[a.classNames.root,a.className];a.numberOfMonths>1&&x.push(a.classNames.multiple_months),a.showWeekNumber&&x.push(a.classNames.with_weeknumber);var y=bt(bt({},a.styles.root),a.style),v=Object.keys(s).filter(function(b){return b.startsWith("data-")}).reduce(function(b,w){var j;return bt(bt({},b),(j={},j[w]=s[w],j))},{}),k=(t=(r=s.components)===null||r===void 0?void 0:r.Months)!==null&&t!==void 0?t:ZD;return n.jsx("div",bt({className:x.join(" "),style:y,dir:a.dir,id:a.id,nonce:s.nonce,title:s.title,lang:s.lang},v,{children:n.jsx(k,{children:c.displayMonths.map(function(b,w){return n.jsx(JD,{displayIndex:w,displayMonth:b},w)})})}))}function tF(e){var r=e.children,t=k5(e,["children"]);return n.jsx(q5,{initialProps:t,children:n.jsx(eD,{children:n.jsx(FD,{initialProps:t,children:n.jsx(dD,{initialProps:t,children:n.jsx(hD,{initialProps:t,children:n.jsx(ND,{children:n.jsx(RD,{children:r})})})})})})})}function rF(e){return n.jsx(tF,bt({},e,{children:n.jsx(eF,{initialProps:e})}))}function _v({className:e,classNames:r,showOutsideDays:t=!0,...s}){return n.jsx(rF,{showOutsideDays:t,className:sr("p-3",e),classNames:{months:"flex flex-col sm:flex-row gap-2",month:"flex flex-col gap-4",caption:"flex justify-center pt-1 relative items-center w-full",caption_label:"text-sm font-medium",nav:"flex items-center gap-1",nav_button:sr(Qh({variant:"outline"}),"size-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-x-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:sr("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",s.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:sr(Qh({variant:"ghost"}),"size-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",day_range_end:"day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:({className:a,...o})=>n.jsx(XE,{className:sr("size-4",a),...o}),IconRight:({className:a,...o})=>n.jsx(ZE,{className:sr("size-4",a),...o})},...s})}function Yn({assemblyLineFilter:e,setAssemblyLineFilter:r,dateFilterMode:t,setDateFilterMode:s,dateFrom:a,setDateFrom:o,dateTo:c,setDateTo:u,assemblyLines:p,onClearFilters:h,hasActiveFilters:x}){const[y,v]=m.useState(!0),k=new Date().getFullYear(),b=Array.from({length:6},(O,T)=>k-T),w=[{value:0,label:"January"},{value:1,label:"February"},{value:2,label:"March"},{value:3,label:"April"},{value:4,label:"May"},{value:5,label:"June"},{value:6,label:"July"},{value:7,label:"August"},{value:8,label:"September"},{value:9,label:"October"},{value:10,label:"November"},{value:11,label:"December"}],j=()=>{if(t==="year"&&a)return Fr(a,"yyyy");if(t==="month"&&a)return Fr(a,"MMMM yyyy");if(t==="range"){if(a&&c)return`${Fr(a,"MMM dd")} - ${Fr(c,"MMM dd, yyyy")}`;if(a)return`From ${Fr(a,"MMM dd, yyyy")}`;if(c)return`Until ${Fr(c,"MMM dd, yyyy")}`}return"Select date"};return n.jsxs("div",{className:"relative bg-gradient-to-br from-white/95 via-white/90 to-[#f8fbff]/95 backdrop-blur-md border-2 border-[#174a9f]/20 rounded-xl p-5 shadow-lg shadow-[#174a9f]/5 transition-all duration-300 hover:shadow-xl animate-fade-in",children:[n.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-gradient-to-br from-[#174a9f]/5 to-transparent rounded-bl-full animate-pulse-soft"}),n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2.5 mb-4 pb-3 border-b-2 border-[#174a9f]/10",children:[n.jsxs("div",{className:"flex items-center gap-2.5",children:[n.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-gradient-to-br from-[#174a9f] to-[#1a5cb8] shadow-md shadow-[#174a9f]/20",children:n.jsx(N4,{className:"h-4 w-4 text-white"})}),n.jsx("span",{className:"text-[#174a9f]",children:"Advanced Filters"})]}),n.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>v(!y),className:"h-8 px-2 text-[#174a9f] hover:bg-[#174a9f]/10 transition-all duration-300 hover:scale-110",children:y?n.jsx(cw,{className:"h-4 w-4 transition-transform duration-300"}):n.jsx(Cp,{className:"h-4 w-4 transition-transform duration-300"})})]}),y&&n.jsxs("div",{className:"animate-fade-in-up",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[n.jsxs("div",{className:"space-y-1.5",children:[n.jsx("label",{className:"text-xs text-[#174a9f]/70 pl-1",children:"Assembly Line"}),n.jsxs(pn,{value:e,onValueChange:r,children:[n.jsx(xn,{className:"h-10 bg-white/90 backdrop-blur-sm border-2 border-[#174a9f]/20 hover:border-[#174a9f]/40 focus:border-[#174a9f] transition-all duration-200 shadow-sm hover:shadow-md",children:n.jsx(mn,{placeholder:"Select Line"})}),n.jsxs(gn,{children:[n.jsx(qr,{value:"all",children:"All Assembly Lines"}),p.map(O=>n.jsx(qr,{value:O,children:O},O))]})]})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsx("label",{className:"text-xs text-[#174a9f]/70 pl-1",children:"Date Filter Type"}),n.jsxs(pn,{value:t,onValueChange:O=>{s(O),o(void 0),u(void 0)},children:[n.jsx(xn,{className:"h-10 bg-white/90 backdrop-blur-sm border-2 border-[#174a9f]/20 hover:border-[#174a9f]/40 focus:border-[#174a9f] transition-all duration-200 shadow-sm hover:shadow-md",children:n.jsx(mn,{})}),n.jsxs(gn,{children:[n.jsx(qr,{value:"year",children:"Filter by Year"}),n.jsx(qr,{value:"month",children:"Filter by Month"}),n.jsx(qr,{value:"range",children:"Filter by Date Range"})]})]})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs("label",{className:"text-xs text-[#174a9f]/70 pl-1",children:[t==="year"&&"Select Year",t==="month"&&"Select Month",t==="range"&&"Select Date Range"]}),n.jsxs(xR,{children:[n.jsx(yN,{asChild:!0,children:n.jsxs(ce,{variant:"outline",className:"h-10 w-full justify-start text-left bg-white/90 backdrop-blur-sm border-2 border-[#174a9f]/20 hover:border-[#174a9f]/40 hover:bg-white transition-all duration-200 shadow-sm hover:shadow-md",children:[n.jsx(Ay,{className:"mr-2 h-4 w-4 text-[#174a9f]/70"}),n.jsx("span",{className:!a&&!c?"text-gray-500":"",children:j()})]})}),n.jsxs(vN,{className:"w-auto p-0 border-2 border-[#174a9f]/20",align:"start",children:[t==="year"&&n.jsxs("div",{className:"p-4 space-y-2",children:[n.jsx("div",{className:"text-sm text-[#174a9f] mb-3",children:"Select Year"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:b.map(O=>n.jsx(ce,{variant:"outline",className:`h-10 ${a&&Fr(a,"yyyy")===O.toString()?"bg-[#174a9f] text-white hover:bg-[#174a9f]/90":"hover:bg-[#174a9f]/10"}`,onClick:()=>{const T=new Date(O,0,1);o(T),u(new Date(O,11,31))},children:O},O))})]}),t==="month"&&n.jsxs("div",{className:"p-4 space-y-3",children:[n.jsx("div",{className:"text-sm text-[#174a9f] mb-2",children:"Select Month & Year"}),n.jsxs(pn,{value:a?Fr(a,"yyyy"):k.toString(),onValueChange:O=>{const T=parseInt(O),F=a?a.getMonth():0,I=new Date(T,F,1);o(I);const G=new Date(T,F+1,0).getDate();u(new Date(T,F,G))},children:[n.jsx(xn,{className:"w-full",children:n.jsx(mn,{})}),n.jsx(gn,{children:b.map(O=>n.jsx(qr,{value:O.toString(),children:O},O))})]}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:w.map(({value:O,label:T})=>{const F=a?a.getFullYear():k,I=a&&a.getMonth()===O&&a.getFullYear()===F;return n.jsx(ce,{variant:"outline",className:`h-9 text-xs ${I?"bg-[#174a9f] text-white hover:bg-[#174a9f]/90":"hover:bg-[#174a9f]/10"}`,onClick:()=>{const G=new Date(F,O,1);o(G);const B=new Date(F,O+1,0).getDate();u(new Date(F,O,B))},children:T.slice(0,3)},O)})})]}),t==="range"&&n.jsxs("div",{className:"p-4",children:[n.jsx("div",{className:"text-sm text-[#174a9f] mb-4",children:"Select Date Range"}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-xs text-[#174a9f]/70 px-1",children:"Start Date"}),n.jsx(_v,{mode:"single",selected:a,onSelect:o,initialFocus:!0})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-xs text-[#174a9f]/70 px-1",children:"End Date"}),n.jsx(_v,{mode:"single",selected:c,onSelect:u,disabled:O=>a?O<a:!1})]})]})]})]})]})]})]}),(a||c)&&n.jsx("div",{className:"mt-3 p-3 bg-gradient-to-r from-[#174a9f]/5 to-[#174a9f]/10 backdrop-blur-sm border-2 border-[#174a9f]/20 rounded-lg",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ay,{className:"h-4 w-4 text-[#174a9f]"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-xs text-[#174a9f]/70 mb-0.5",children:"Selected Date Range (Assembly Date)"}),n.jsxs("div",{className:"text-[#174a9f]",children:[t==="year"&&a&&n.jsx("span",{children:Fr(a,"yyyy")}),t==="month"&&a&&n.jsx("span",{children:Fr(a,"MMMM yyyy")}),t==="range"&&n.jsxs(n.Fragment,{children:[a&&c&&n.jsxs("span",{children:[Fr(a,"MMM dd, yyyy"),"  ",Fr(c,"MMM dd, yyyy")]}),a&&!c&&n.jsxs("span",{children:["From ",Fr(a,"MMM dd, yyyy")]}),!a&&c&&n.jsxs("span",{children:["Until ",Fr(c,"MMM dd, yyyy")]})]})]})]}),n.jsx(ce,{variant:"ghost",size:"sm",onClick:()=>{o(void 0),u(void 0)},className:"h-7 px-2 text-xs text-[#174a9f]/70 hover:text-[#174a9f] hover:bg-[#174a9f]/10",children:n.jsx(hu,{className:"h-3.5 w-3.5"})})]})}),x&&n.jsx("div",{className:"mt-4 pt-3 border-t-2 border-[#174a9f]/10 flex justify-end",children:n.jsxs(ce,{variant:"ghost",size:"sm",onClick:h,className:"h-9 px-4 text-xs bg-gradient-to-r from-red-50 to-red-100/80 text-red-600 hover:from-red-100 hover:to-red-200 border-2 border-red-200/60 hover:border-red-300 transition-all duration-200 shadow-sm hover:shadow-md flex items-center gap-1.5",children:[n.jsx(hu,{className:"h-3.5 w-3.5"}),"Clear All Filters"]})})]})]})]})}function nF(e,r=[]){let t=[];function s(o,c){const u=m.createContext(c);u.displayName=o+"Context";const p=t.length;t=[...t,c];const h=y=>{const{scope:v,children:k,...b}=y,w=v?.[e]?.[p]||u,j=m.useMemo(()=>b,Object.values(b));return n.jsx(w.Provider,{value:j,children:k})};h.displayName=o+"Provider";function x(y,v){const k=v?.[e]?.[p]||u,b=m.useContext(k);if(b)return b;if(c!==void 0)return c;throw new Error(`\`${y}\` must be used within \`${o}\``)}return[h,x]}const a=()=>{const o=t.map(c=>m.createContext(c));return function(u){const p=u?.[e]||o;return m.useMemo(()=>({[`__scope${e}`]:{...u,[e]:p}}),[u,p])}};return a.scopeName=e,[s,sF(a,...r)]}function sF(...e){const r=e[0];if(e.length===1)return r;const t=()=>{const s=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const c=s.reduce((u,{useScope:p,scopeName:h})=>{const y=p(o)[`__scope${h}`];return{...u,...y}},{});return m.useMemo(()=>({[`__scope${r.scopeName}`]:c}),[c])}};return t.scopeName=r.scopeName,t}var aF=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],lm=aF.reduce((e,r)=>{const t=jp(`Primitive.${r}`),s=m.forwardRef((a,o)=>{const{asChild:c,...u}=a,p=c?t:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),n.jsx(p,{...u,ref:o})});return s.displayName=`Primitive.${r}`,{...e,[r]:s}},{}),Eh={exports:{}},Ah={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cv;function iF(){if(Cv)return Ah;Cv=1;var e=$u();function r(y,v){return y===v&&(y!==0||1/y===1/v)||y!==y&&v!==v}var t=typeof Object.is=="function"?Object.is:r,s=e.useState,a=e.useEffect,o=e.useLayoutEffect,c=e.useDebugValue;function u(y,v){var k=v(),b=s({inst:{value:k,getSnapshot:v}}),w=b[0].inst,j=b[1];return o(function(){w.value=k,w.getSnapshot=v,p(w)&&j({inst:w})},[y,k,v]),a(function(){return p(w)&&j({inst:w}),y(function(){p(w)&&j({inst:w})})},[y]),c(k),k}function p(y){var v=y.getSnapshot;y=y.value;try{var k=v();return!t(y,k)}catch{return!0}}function h(y,v){return v()}var x=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:u;return Ah.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:x,Ah}var Ev;function oF(){return Ev||(Ev=1,Eh.exports=iF()),Eh.exports}var lF=oF();function cF(){return lF.useSyncExternalStore(dF,()=>!0,()=>!1)}function dF(){return()=>{}}var cm="Avatar",[uF]=nF(cm),[fF,BN]=uF(cm),$N=m.forwardRef((e,r)=>{const{__scopeAvatar:t,...s}=e,[a,o]=m.useState("idle");return n.jsx(fF,{scope:t,imageLoadingStatus:a,onImageLoadingStatusChange:o,children:n.jsx(lm.span,{...s,ref:r})})});$N.displayName=cm;var UN="AvatarImage",zN=m.forwardRef((e,r)=>{const{__scopeAvatar:t,src:s,onLoadingStatusChange:a=()=>{},...o}=e,c=BN(UN,t),u=hF(s,o),p=Rs(h=>{a(h),c.onImageLoadingStatusChange(h)});return Vr(()=>{u!=="idle"&&p(u)},[u,p]),u==="loaded"?n.jsx(lm.img,{...o,ref:r,src:s}):null});zN.displayName=UN;var WN="AvatarFallback",qN=m.forwardRef((e,r)=>{const{__scopeAvatar:t,delayMs:s,...a}=e,o=BN(WN,t),[c,u]=m.useState(s===void 0);return m.useEffect(()=>{if(s!==void 0){const p=window.setTimeout(()=>u(!0),s);return()=>window.clearTimeout(p)}},[s]),c&&o.imageLoadingStatus!=="loaded"?n.jsx(lm.span,{...a,ref:r}):null});qN.displayName=WN;function Av(e,r){return e?r?(e.src!==r&&(e.src=r),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function hF(e,{referrerPolicy:r,crossOrigin:t}){const s=cF(),a=m.useRef(null),o=s?(a.current||(a.current=new window.Image),a.current):null,[c,u]=m.useState(()=>Av(o,e));return Vr(()=>{u(Av(o,e))},[o,e]),Vr(()=>{const p=y=>()=>{u(y)};if(!o)return;const h=p("loaded"),x=p("error");return o.addEventListener("load",h),o.addEventListener("error",x),r&&(o.referrerPolicy=r),typeof t=="string"&&(o.crossOrigin=t),()=>{o.removeEventListener("load",h),o.removeEventListener("error",x)}},[o,t,r]),c}var VN=$N,QN=zN,HN=qN;const GN=m.forwardRef(({className:e,...r},t)=>n.jsx(VN,{ref:t,"data-slot":"avatar",className:sr("relative flex size-10 shrink-0 overflow-hidden rounded-full",e),...r}));GN.displayName=VN.displayName;const YN=m.forwardRef(({className:e,...r},t)=>n.jsx(QN,{ref:t,"data-slot":"avatar-image",className:sr("aspect-square size-full",e),...r}));YN.displayName=QN.displayName;const KN=m.forwardRef(({className:e,...r},t)=>n.jsx(HN,{ref:t,"data-slot":"avatar-fallback",className:sr("bg-muted flex size-full items-center justify-center rounded-full",e),...r}));KN.displayName=HN.displayName;var Th="rovingFocusGroup.onEntryFocus",pF={bubbles:!1,cancelable:!0},kc="RovingFocusGroup",[cp,XN,mF]=Fp(kc),[xF,JN]=_a(kc,[mF]),[gF,yF]=xF(kc),ZN=m.forwardRef((e,r)=>n.jsx(cp.Provider,{scope:e.__scopeRovingFocusGroup,children:n.jsx(cp.Slot,{scope:e.__scopeRovingFocusGroup,children:n.jsx(vF,{...e,ref:r})})}));ZN.displayName=kc;var vF=m.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:t,orientation:s,loop:a=!1,dir:o,currentTabStopId:c,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:p,onEntryFocus:h,preventScrollOnEntryFocus:x=!1,...y}=e,v=m.useRef(null),k=Jt(r,v),b=Mp(o),[w,j]=Oi({prop:c,defaultProp:u??null,onChange:p,caller:kc}),[O,T]=m.useState(!1),F=Rs(h),I=XN(t),G=m.useRef(!1),[B,Q]=m.useState(0);return m.useEffect(()=>{const z=v.current;if(z)return z.addEventListener(Th,F),()=>z.removeEventListener(Th,F)},[F]),n.jsx(gF,{scope:t,orientation:s,dir:b,loop:a,currentTabStopId:w,onItemFocus:m.useCallback(z=>j(z),[j]),onItemShiftTab:m.useCallback(()=>T(!0),[]),onFocusableItemAdd:m.useCallback(()=>Q(z=>z+1),[]),onFocusableItemRemove:m.useCallback(()=>Q(z=>z-1),[]),children:n.jsx(Pt.div,{tabIndex:O||B===0?-1:0,"data-orientation":s,...y,ref:k,style:{outline:"none",...e.style},onMouseDown:ct(e.onMouseDown,()=>{G.current=!0}),onFocus:ct(e.onFocus,z=>{const J=!G.current;if(z.target===z.currentTarget&&J&&!O){const ne=new CustomEvent(Th,pF);if(z.currentTarget.dispatchEvent(ne),!ne.defaultPrevented){const fe=I().filter(we=>we.focusable),me=fe.find(we=>we.active),le=fe.find(we=>we.id===w),Fe=[me,le,...fe].filter(Boolean).map(we=>we.ref.current);rS(Fe,x)}}G.current=!1}),onBlur:ct(e.onBlur,()=>T(!1))})})}),eS="RovingFocusGroupItem",tS=m.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:t,focusable:s=!0,active:a=!1,tabStopId:o,children:c,...u}=e,p=Zs(),h=o||p,x=yF(eS,t),y=x.currentTabStopId===h,v=XN(t),{onFocusableItemAdd:k,onFocusableItemRemove:b,currentTabStopId:w}=x;return m.useEffect(()=>{if(s)return k(),()=>b()},[s,k,b]),n.jsx(cp.ItemSlot,{scope:t,id:h,focusable:s,active:a,children:n.jsx(Pt.span,{tabIndex:y?0:-1,"data-orientation":x.orientation,...u,ref:r,onMouseDown:ct(e.onMouseDown,j=>{s?x.onItemFocus(h):j.preventDefault()}),onFocus:ct(e.onFocus,()=>x.onItemFocus(h)),onKeyDown:ct(e.onKeyDown,j=>{if(j.key==="Tab"&&j.shiftKey){x.onItemShiftTab();return}if(j.target!==j.currentTarget)return;const O=SF(j,x.orientation,x.dir);if(O!==void 0){if(j.metaKey||j.ctrlKey||j.altKey||j.shiftKey)return;j.preventDefault();let F=v().filter(I=>I.focusable).map(I=>I.ref.current);if(O==="last")F.reverse();else if(O==="prev"||O==="next"){O==="prev"&&F.reverse();const I=F.indexOf(j.currentTarget);F=x.loop?bF(F,I+1):F.slice(I+1)}setTimeout(()=>rS(F))}}),children:typeof c=="function"?c({isCurrentTabStop:y,hasTabStop:w!=null}):c})})});tS.displayName=eS;var wF={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function NF(e,r){return r!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function SF(e,r,t){const s=NF(e.key,t);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return wF[s]}function rS(e,r=!1){const t=document.activeElement;for(const s of e)if(s===t||(s.focus({preventScroll:r}),document.activeElement!==t))return}function bF(e,r){return e.map((t,s)=>e[(r+s)%e.length])}var jF=ZN,kF=tS;function _F(e){const r=CF(e),t=m.forwardRef((s,a)=>{const{children:o,...c}=s,u=m.Children.toArray(o),p=u.find(AF);if(p){const h=p.props.children,x=u.map(y=>y===p?m.Children.count(h)>1?m.Children.only(null):m.isValidElement(h)?h.props.children:null:y);return n.jsx(r,{...c,ref:a,children:m.isValidElement(h)?m.cloneElement(h,void 0,x):null})}return n.jsx(r,{...c,ref:a,children:o})});return t.displayName=`${e}.Slot`,t}function CF(e){const r=m.forwardRef((t,s)=>{const{children:a,...o}=t;if(m.isValidElement(a)){const c=OF(a),u=TF(o,a.props);return a.type!==m.Fragment&&(u.ref=s?aa(s,c):c),m.cloneElement(a,u)}return m.Children.count(a)>1?m.Children.only(null):null});return r.displayName=`${e}.SlotClone`,r}var EF=Symbol("radix.slottable");function AF(e){return m.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===EF}function TF(e,r){const t={...r};for(const s in r){const a=e[s],o=r[s];/^on[A-Z]/.test(s)?a&&o?t[s]=(...u)=>{const p=o(...u);return a(...u),p}:a&&(t[s]=a):s==="style"?t[s]={...a,...o}:s==="className"&&(t[s]=[a,o].filter(Boolean).join(" "))}return{...e,...t}}function OF(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(r=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}var dp=["Enter"," "],PF=["ArrowDown","PageUp","Home"],nS=["ArrowUp","PageDown","End"],RF=[...PF,...nS],DF={ltr:[...dp,"ArrowRight"],rtl:[...dp,"ArrowLeft"]},FF={ltr:["ArrowLeft"],rtl:["ArrowRight"]},_c="Menu",[Zl,MF,LF]=Fp(_c),[Ui,sS]=_a(_c,[LF,Ho,JN]),c0=Ho(),aS=JN(),[IF,zi]=Ui(_c),[BF,Cc]=Ui(_c),iS=e=>{const{__scopeMenu:r,open:t=!1,children:s,dir:a,onOpenChange:o,modal:c=!0}=e,u=c0(r),[p,h]=m.useState(null),x=m.useRef(!1),y=Rs(o),v=Mp(a);return m.useEffect(()=>{const k=()=>{x.current=!0,document.addEventListener("pointerdown",b,{capture:!0,once:!0}),document.addEventListener("pointermove",b,{capture:!0,once:!0})},b=()=>x.current=!1;return document.addEventListener("keydown",k,{capture:!0}),()=>{document.removeEventListener("keydown",k,{capture:!0}),document.removeEventListener("pointerdown",b,{capture:!0}),document.removeEventListener("pointermove",b,{capture:!0})}},[]),n.jsx(Vp,{...u,children:n.jsx(IF,{scope:r,open:t,onOpenChange:y,content:p,onContentChange:h,children:n.jsx(BF,{scope:r,onClose:m.useCallback(()=>y(!1),[y]),isUsingKeyboardRef:x,dir:v,modal:c,children:s})})})};iS.displayName=_c;var $F="MenuAnchor",dm=m.forwardRef((e,r)=>{const{__scopeMenu:t,...s}=e,a=c0(t);return n.jsx(n0,{...a,...s,ref:r})});dm.displayName=$F;var um="MenuPortal",[UF,oS]=Ui(um,{forceMount:void 0}),lS=e=>{const{__scopeMenu:r,forceMount:t,children:s,container:a}=e,o=zi(um,r);return n.jsx(UF,{scope:r,forceMount:t,children:n.jsx(Bs,{present:t||o.open,children:n.jsx(gc,{asChild:!0,container:a,children:s})})})};lS.displayName=um;var gs="MenuContent",[zF,fm]=Ui(gs),cS=m.forwardRef((e,r)=>{const t=oS(gs,e.__scopeMenu),{forceMount:s=t.forceMount,...a}=e,o=zi(gs,e.__scopeMenu),c=Cc(gs,e.__scopeMenu);return n.jsx(Zl.Provider,{scope:e.__scopeMenu,children:n.jsx(Bs,{present:s||o.open,children:n.jsx(Zl.Slot,{scope:e.__scopeMenu,children:c.modal?n.jsx(WF,{...a,ref:r}):n.jsx(qF,{...a,ref:r})})})})}),WF=m.forwardRef((e,r)=>{const t=zi(gs,e.__scopeMenu),s=m.useRef(null),a=Jt(r,s);return m.useEffect(()=>{const o=s.current;if(o)return Xu(o)},[]),n.jsx(hm,{...e,ref:a,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:ct(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),qF=m.forwardRef((e,r)=>{const t=zi(gs,e.__scopeMenu);return n.jsx(hm,{...e,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),VF=_F("MenuContent.ScrollLock"),hm=m.forwardRef((e,r)=>{const{__scopeMenu:t,loop:s=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:c,disableOutsidePointerEvents:u,onEntryFocus:p,onEscapeKeyDown:h,onPointerDownOutside:x,onFocusOutside:y,onInteractOutside:v,onDismiss:k,disableOutsideScroll:b,...w}=e,j=zi(gs,t),O=Cc(gs,t),T=c0(t),F=aS(t),I=MF(t),[G,B]=m.useState(null),Q=m.useRef(null),z=Jt(r,Q,j.onContentChange),J=m.useRef(0),ne=m.useRef(""),fe=m.useRef(0),me=m.useRef(null),le=m.useRef("right"),K=m.useRef(0),Fe=b?yc:m.Fragment,we=b?{as:VF,allowPinchZoom:!0}:void 0,oe=de=>{const Ne=ne.current+de,ee=I().filter(ie=>!ie.disabled),U=document.activeElement,re=ee.find(ie=>ie.ref.current===U)?.textValue,Y=ee.map(ie=>ie.textValue),Z=nM(Y,Ne,re),xe=ee.find(ie=>ie.textValue===Z)?.ref.current;(function ie(Te){ne.current=Te,window.clearTimeout(J.current),Te!==""&&(J.current=window.setTimeout(()=>ie(""),1e3))})(Ne),xe&&setTimeout(()=>xe.focus())};m.useEffect(()=>()=>window.clearTimeout(J.current),[]),Yu();const V=m.useCallback(de=>le.current===me.current?.side&&aM(de,me.current?.area),[]);return n.jsx(zF,{scope:t,searchRef:ne,onItemEnter:m.useCallback(de=>{V(de)&&de.preventDefault()},[V]),onItemLeave:m.useCallback(de=>{V(de)||(Q.current?.focus(),B(null))},[V]),onTriggerLeave:m.useCallback(de=>{V(de)&&de.preventDefault()},[V]),pointerGraceTimerRef:fe,onPointerGraceIntentChange:m.useCallback(de=>{me.current=de},[]),children:n.jsx(Fe,{...we,children:n.jsx(xc,{asChild:!0,trapped:a,onMountAutoFocus:ct(o,de=>{de.preventDefault(),Q.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:n.jsx(mc,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:h,onPointerDownOutside:x,onFocusOutside:y,onInteractOutside:v,onDismiss:k,children:n.jsx(jF,{asChild:!0,...F,dir:O.dir,orientation:"vertical",loop:s,currentTabStopId:G,onCurrentTabStopIdChange:B,onEntryFocus:ct(p,de=>{O.isUsingKeyboardRef.current||de.preventDefault()}),preventScrollOnEntryFocus:!0,children:n.jsx(Qp,{role:"menu","aria-orientation":"vertical","data-state":kS(j.open),"data-radix-menu-content":"",dir:O.dir,...T,...w,ref:z,style:{outline:"none",...w.style},onKeyDown:ct(w.onKeyDown,de=>{const ee=de.target.closest("[data-radix-menu-content]")===de.currentTarget,U=de.ctrlKey||de.altKey||de.metaKey,re=de.key.length===1;ee&&(de.key==="Tab"&&de.preventDefault(),!U&&re&&oe(de.key));const Y=Q.current;if(de.target!==Y||!RF.includes(de.key))return;de.preventDefault();const xe=I().filter(ie=>!ie.disabled).map(ie=>ie.ref.current);nS.includes(de.key)&&xe.reverse(),tM(xe)}),onBlur:ct(e.onBlur,de=>{de.currentTarget.contains(de.target)||(window.clearTimeout(J.current),ne.current="")}),onPointerMove:ct(e.onPointerMove,ec(de=>{const Ne=de.target,ee=K.current!==de.clientX;if(de.currentTarget.contains(Ne)&&ee){const U=de.clientX>K.current?"right":"left";le.current=U,K.current=de.clientX}}))})})})})})})});cS.displayName=gs;var QF="MenuGroup",pm=m.forwardRef((e,r)=>{const{__scopeMenu:t,...s}=e;return n.jsx(Pt.div,{role:"group",...s,ref:r})});pm.displayName=QF;var HF="MenuLabel",dS=m.forwardRef((e,r)=>{const{__scopeMenu:t,...s}=e;return n.jsx(Pt.div,{...s,ref:r})});dS.displayName=HF;var bu="MenuItem",Tv="menu.itemSelect",d0=m.forwardRef((e,r)=>{const{disabled:t=!1,onSelect:s,...a}=e,o=m.useRef(null),c=Cc(bu,e.__scopeMenu),u=fm(bu,e.__scopeMenu),p=Jt(r,o),h=m.useRef(!1),x=()=>{const y=o.current;if(!t&&y){const v=new CustomEvent(Tv,{bubbles:!0,cancelable:!0});y.addEventListener(Tv,k=>s?.(k),{once:!0}),J1(y,v),v.defaultPrevented?h.current=!1:c.onClose()}};return n.jsx(uS,{...a,ref:p,disabled:t,onClick:ct(e.onClick,x),onPointerDown:y=>{e.onPointerDown?.(y),h.current=!0},onPointerUp:ct(e.onPointerUp,y=>{h.current||y.currentTarget?.click()}),onKeyDown:ct(e.onKeyDown,y=>{const v=u.searchRef.current!=="";t||v&&y.key===" "||dp.includes(y.key)&&(y.currentTarget.click(),y.preventDefault())})})});d0.displayName=bu;var uS=m.forwardRef((e,r)=>{const{__scopeMenu:t,disabled:s=!1,textValue:a,...o}=e,c=fm(bu,t),u=aS(t),p=m.useRef(null),h=Jt(r,p),[x,y]=m.useState(!1),[v,k]=m.useState("");return m.useEffect(()=>{const b=p.current;b&&k((b.textContent??"").trim())},[o.children]),n.jsx(Zl.ItemSlot,{scope:t,disabled:s,textValue:a??v,children:n.jsx(kF,{asChild:!0,...u,focusable:!s,children:n.jsx(Pt.div,{role:"menuitem","data-highlighted":x?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...o,ref:h,onPointerMove:ct(e.onPointerMove,ec(b=>{s?c.onItemLeave(b):(c.onItemEnter(b),b.defaultPrevented||b.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ct(e.onPointerLeave,ec(b=>c.onItemLeave(b))),onFocus:ct(e.onFocus,()=>y(!0)),onBlur:ct(e.onBlur,()=>y(!1))})})})}),GF="MenuCheckboxItem",fS=m.forwardRef((e,r)=>{const{checked:t=!1,onCheckedChange:s,...a}=e;return n.jsx(gS,{scope:e.__scopeMenu,checked:t,children:n.jsx(d0,{role:"menuitemcheckbox","aria-checked":ju(t)?"mixed":t,...a,ref:r,"data-state":xm(t),onSelect:ct(a.onSelect,()=>s?.(ju(t)?!0:!t),{checkForDefaultPrevented:!1})})})});fS.displayName=GF;var hS="MenuRadioGroup",[YF,KF]=Ui(hS,{value:void 0,onValueChange:()=>{}}),pS=m.forwardRef((e,r)=>{const{value:t,onValueChange:s,...a}=e,o=Rs(s);return n.jsx(YF,{scope:e.__scopeMenu,value:t,onValueChange:o,children:n.jsx(pm,{...a,ref:r})})});pS.displayName=hS;var mS="MenuRadioItem",xS=m.forwardRef((e,r)=>{const{value:t,...s}=e,a=KF(mS,e.__scopeMenu),o=t===a.value;return n.jsx(gS,{scope:e.__scopeMenu,checked:o,children:n.jsx(d0,{role:"menuitemradio","aria-checked":o,...s,ref:r,"data-state":xm(o),onSelect:ct(s.onSelect,()=>a.onValueChange?.(t),{checkForDefaultPrevented:!1})})})});xS.displayName=mS;var mm="MenuItemIndicator",[gS,XF]=Ui(mm,{checked:!1}),yS=m.forwardRef((e,r)=>{const{__scopeMenu:t,forceMount:s,...a}=e,o=XF(mm,t);return n.jsx(Bs,{present:s||ju(o.checked)||o.checked===!0,children:n.jsx(Pt.span,{...a,ref:r,"data-state":xm(o.checked)})})});yS.displayName=mm;var JF="MenuSeparator",vS=m.forwardRef((e,r)=>{const{__scopeMenu:t,...s}=e;return n.jsx(Pt.div,{role:"separator","aria-orientation":"horizontal",...s,ref:r})});vS.displayName=JF;var ZF="MenuArrow",wS=m.forwardRef((e,r)=>{const{__scopeMenu:t,...s}=e,a=c0(t);return n.jsx(Hp,{...a,...s,ref:r})});wS.displayName=ZF;var eM="MenuSub",[bU,NS]=Ui(eM),Ul="MenuSubTrigger",SS=m.forwardRef((e,r)=>{const t=zi(Ul,e.__scopeMenu),s=Cc(Ul,e.__scopeMenu),a=NS(Ul,e.__scopeMenu),o=fm(Ul,e.__scopeMenu),c=m.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:p}=o,h={__scopeMenu:e.__scopeMenu},x=m.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return m.useEffect(()=>x,[x]),m.useEffect(()=>{const y=u.current;return()=>{window.clearTimeout(y),p(null)}},[u,p]),n.jsx(dm,{asChild:!0,...h,children:n.jsx(uS,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":a.contentId,"data-state":kS(t.open),...e,ref:aa(r,a.onTriggerChange),onClick:y=>{e.onClick?.(y),!(e.disabled||y.defaultPrevented)&&(y.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:ct(e.onPointerMove,ec(y=>{o.onItemEnter(y),!y.defaultPrevented&&!e.disabled&&!t.open&&!c.current&&(o.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{t.onOpenChange(!0),x()},100))})),onPointerLeave:ct(e.onPointerLeave,ec(y=>{x();const v=t.content?.getBoundingClientRect();if(v){const k=t.content?.dataset.side,b=k==="right",w=b?-5:5,j=v[b?"left":"right"],O=v[b?"right":"left"];o.onPointerGraceIntentChange({area:[{x:y.clientX+w,y:y.clientY},{x:j,y:v.top},{x:O,y:v.top},{x:O,y:v.bottom},{x:j,y:v.bottom}],side:k}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(y),y.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:ct(e.onKeyDown,y=>{const v=o.searchRef.current!=="";e.disabled||v&&y.key===" "||DF[s.dir].includes(y.key)&&(t.onOpenChange(!0),t.content?.focus(),y.preventDefault())})})})});SS.displayName=Ul;var bS="MenuSubContent",jS=m.forwardRef((e,r)=>{const t=oS(gs,e.__scopeMenu),{forceMount:s=t.forceMount,...a}=e,o=zi(gs,e.__scopeMenu),c=Cc(gs,e.__scopeMenu),u=NS(bS,e.__scopeMenu),p=m.useRef(null),h=Jt(r,p);return n.jsx(Zl.Provider,{scope:e.__scopeMenu,children:n.jsx(Bs,{present:s||o.open,children:n.jsx(Zl.Slot,{scope:e.__scopeMenu,children:n.jsx(hm,{id:u.contentId,"aria-labelledby":u.triggerId,...a,ref:h,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:x=>{c.isUsingKeyboardRef.current&&p.current?.focus(),x.preventDefault()},onCloseAutoFocus:x=>x.preventDefault(),onFocusOutside:ct(e.onFocusOutside,x=>{x.target!==u.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:ct(e.onEscapeKeyDown,x=>{c.onClose(),x.preventDefault()}),onKeyDown:ct(e.onKeyDown,x=>{const y=x.currentTarget.contains(x.target),v=FF[c.dir].includes(x.key);y&&v&&(o.onOpenChange(!1),u.trigger?.focus(),x.preventDefault())})})})})})});jS.displayName=bS;function kS(e){return e?"open":"closed"}function ju(e){return e==="indeterminate"}function xm(e){return ju(e)?"indeterminate":e?"checked":"unchecked"}function tM(e){const r=document.activeElement;for(const t of e)if(t===r||(t.focus(),document.activeElement!==r))return}function rM(e,r){return e.map((t,s)=>e[(r+s)%e.length])}function nM(e,r,t){const a=r.length>1&&Array.from(r).every(h=>h===r[0])?r[0]:r,o=t?e.indexOf(t):-1;let c=rM(e,Math.max(o,0));a.length===1&&(c=c.filter(h=>h!==t));const p=c.find(h=>h.toLowerCase().startsWith(a.toLowerCase()));return p!==t?p:void 0}function sM(e,r){const{x:t,y:s}=e;let a=!1;for(let o=0,c=r.length-1;o<r.length;c=o++){const u=r[o],p=r[c],h=u.x,x=u.y,y=p.x,v=p.y;x>s!=v>s&&t<(y-h)*(s-x)/(v-x)+h&&(a=!a)}return a}function aM(e,r){if(!r)return!1;const t={x:e.clientX,y:e.clientY};return sM(t,r)}function ec(e){return r=>r.pointerType==="mouse"?e(r):void 0}var iM=iS,oM=dm,lM=lS,cM=cS,dM=pm,uM=dS,fM=d0,hM=fS,pM=pS,mM=xS,xM=yS,gM=vS,yM=wS,vM=SS,wM=jS,u0="DropdownMenu",[NM]=_a(u0,[sS]),En=sS(),[SM,_S]=NM(u0),CS=e=>{const{__scopeDropdownMenu:r,children:t,dir:s,open:a,defaultOpen:o,onOpenChange:c,modal:u=!0}=e,p=En(r),h=m.useRef(null),[x,y]=Oi({prop:a,defaultProp:o??!1,onChange:c,caller:u0});return n.jsx(SM,{scope:r,triggerId:Zs(),triggerRef:h,contentId:Zs(),open:x,onOpenChange:y,onOpenToggle:m.useCallback(()=>y(v=>!v),[y]),modal:u,children:n.jsx(iM,{...p,open:x,onOpenChange:y,dir:s,modal:u,children:t})})};CS.displayName=u0;var ES="DropdownMenuTrigger",AS=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,disabled:s=!1,...a}=e,o=_S(ES,t),c=En(t);return n.jsx(oM,{asChild:!0,...c,children:n.jsx(Pt.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...a,ref:aa(r,o.triggerRef),onPointerDown:ct(e.onPointerDown,u=>{!s&&u.button===0&&u.ctrlKey===!1&&(o.onOpenToggle(),o.open||u.preventDefault())}),onKeyDown:ct(e.onKeyDown,u=>{s||(["Enter"," "].includes(u.key)&&o.onOpenToggle(),u.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(u.key)&&u.preventDefault())})})})});AS.displayName=ES;var bM="DropdownMenuPortal",TS=e=>{const{__scopeDropdownMenu:r,...t}=e,s=En(r);return n.jsx(lM,{...s,...t})};TS.displayName=bM;var OS="DropdownMenuContent",PS=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...s}=e,a=_S(OS,t),o=En(t),c=m.useRef(!1);return n.jsx(cM,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...s,ref:r,onCloseAutoFocus:ct(e.onCloseAutoFocus,u=>{c.current||a.triggerRef.current?.focus(),c.current=!1,u.preventDefault()}),onInteractOutside:ct(e.onInteractOutside,u=>{const p=u.detail.originalEvent,h=p.button===0&&p.ctrlKey===!0,x=p.button===2||h;(!a.modal||x)&&(c.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});PS.displayName=OS;var jM="DropdownMenuGroup",kM=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...s}=e,a=En(t);return n.jsx(dM,{...a,...s,ref:r})});kM.displayName=jM;var _M="DropdownMenuLabel",CM=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...s}=e,a=En(t);return n.jsx(uM,{...a,...s,ref:r})});CM.displayName=_M;var EM="DropdownMenuItem",RS=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...s}=e,a=En(t);return n.jsx(fM,{...a,...s,ref:r})});RS.displayName=EM;var AM="DropdownMenuCheckboxItem",TM=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...s}=e,a=En(t);return n.jsx(hM,{...a,...s,ref:r})});TM.displayName=AM;var OM="DropdownMenuRadioGroup",PM=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...s}=e,a=En(t);return n.jsx(pM,{...a,...s,ref:r})});PM.displayName=OM;var RM="DropdownMenuRadioItem",DM=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...s}=e,a=En(t);return n.jsx(mM,{...a,...s,ref:r})});DM.displayName=RM;var FM="DropdownMenuItemIndicator",MM=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...s}=e,a=En(t);return n.jsx(xM,{...a,...s,ref:r})});MM.displayName=FM;var LM="DropdownMenuSeparator",IM=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...s}=e,a=En(t);return n.jsx(gM,{...a,...s,ref:r})});IM.displayName=LM;var BM="DropdownMenuArrow",$M=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...s}=e,a=En(t);return n.jsx(yM,{...a,...s,ref:r})});$M.displayName=BM;var UM="DropdownMenuSubTrigger",zM=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...s}=e,a=En(t);return n.jsx(vM,{...a,...s,ref:r})});zM.displayName=UM;var WM="DropdownMenuSubContent",qM=m.forwardRef((e,r)=>{const{__scopeDropdownMenu:t,...s}=e,a=En(t);return n.jsx(wM,{...a,...s,ref:r,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});qM.displayName=WM;var VM=CS,QM=AS,HM=TS,GM=PS,YM=RS;function KM({...e}){return n.jsx(VM,{"data-slot":"dropdown-menu",...e})}function XM({...e}){return n.jsx(QM,{"data-slot":"dropdown-menu-trigger",...e})}function JM({className:e,sideOffset:r=4,...t}){return n.jsx(HM,{children:n.jsx(GM,{"data-slot":"dropdown-menu-content",sideOffset:r,className:sr("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...t})})}function ZM({className:e,inset:r,variant:t="default",...s}){return n.jsx(YM,{"data-slot":"dropdown-menu-item","data-inset":r,"data-variant":t,className:sr("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...s})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ku={};ku.version="0.18.5";var DS=1252,eL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],FS=function(e){eL.indexOf(e)!=-1&&(DS=e)};function tL(){FS(1252)}var tc=function(e){FS(e)};function rL(){tc(1200),tL()}var Gd=function(r){return String.fromCharCode(r)},Ov=function(r){return String.fromCharCode(r)},_u,Za="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function rc(e){for(var r="",t=0,s=0,a=0,o=0,c=0,u=0,p=0,h=0;h<e.length;)t=e.charCodeAt(h++),o=t>>2,s=e.charCodeAt(h++),c=(t&3)<<4|s>>4,a=e.charCodeAt(h++),u=(s&15)<<2|a>>6,p=a&63,isNaN(s)?u=p=64:isNaN(a)&&(p=64),r+=Za.charAt(o)+Za.charAt(c)+Za.charAt(u)+Za.charAt(p);return r}function ja(e){var r="",t=0,s=0,a=0,o=0,c=0,u=0,p=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)o=Za.indexOf(e.charAt(h++)),c=Za.indexOf(e.charAt(h++)),t=o<<2|c>>4,r+=String.fromCharCode(t),u=Za.indexOf(e.charAt(h++)),s=(c&15)<<4|u>>2,u!==64&&(r+=String.fromCharCode(s)),p=Za.indexOf(e.charAt(h++)),a=(u&3)<<6|p,p!==64&&(r+=String.fromCharCode(a));return r}var Xt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ca=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Ii(e){return Xt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Pv(e){return Xt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var As=function(r){return Xt?Ca(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function f0(e){if(typeof ArrayBuffer>"u")return As(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),s=0;s!=e.length;++s)t[s]=e.charCodeAt(s)&255;return r}function Ec(e){if(Array.isArray(e))return e.map(function(s){return String.fromCharCode(s)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function nL(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var sn=Xt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Ca(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var s=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)s.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";s.set(new Uint8Array(e[r]),t)}return s}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function sL(e){for(var r=[],t=0,s=e.length+250,a=Ii(e.length+255),o=0;o<e.length;++o){var c=e.charCodeAt(o);if(c<128)a[t++]=c;else if(c<2048)a[t++]=192|c>>6&31,a[t++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=e.charCodeAt(++o)&1023;a[t++]=240|c>>8&7,a[t++]=128|c>>2&63,a[t++]=128|u>>6&15|(c&3)<<4,a[t++]=128|u&63}else a[t++]=224|c>>12&15,a[t++]=128|c>>6&63,a[t++]=128|c&63;t>s&&(r.push(a.slice(0,t)),t=0,a=Ii(65535),s=65530)}return r.push(a.slice(0,t)),sn(r)}var Wl=/\u0000/g,Yd=/[\u0001-\u0006]/g;function Ao(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function Ts(e,r){var t=""+e;return t.length>=r?t:Tr("0",r-t.length)+t}function gm(e,r){var t=""+e;return t.length>=r?t:Tr(" ",r-t.length)+t}function Cu(e,r){var t=""+e;return t.length>=r?t:t+Tr(" ",r-t.length)}function aL(e,r){var t=""+Math.round(e);return t.length>=r?t:Tr("0",r-t.length)+t}function iL(e,r){var t=""+e;return t.length>=r?t:Tr("0",r-t.length)+t}var Rv=Math.pow(2,32);function So(e,r){if(e>Rv||e<-Rv)return aL(e,r);var t=Math.round(e);return iL(t,r)}function Eu(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Dv=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Oh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function oL(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Or={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Fv={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lL={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Au(e,r,t){for(var s=e<0?-1:1,a=e*s,o=0,c=1,u=0,p=1,h=0,x=0,y=Math.floor(a);h<r&&(y=Math.floor(a),u=y*c+o,x=y*h+p,!(a-y<5e-8));)a=1/(a-y),o=c,c=u,p=h,h=x;if(x>r&&(h>r?(x=p,u=o):(x=h,u=c)),!t)return[0,s*u,x];var v=Math.floor(s*u/x);return[v,s*u-v*x,x]}function Kd(e,r,t){if(e>2958465||e<0)return null;var s=e|0,a=Math.floor(86400*(e-s)),o=0,c=[],u={D:s,T:a,u:86400*(e-s)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),r&&r.date1904&&(s+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++s,++u.D)),s===60)c=t?[1317,10,29]:[1900,2,29],o=3;else if(s===0)c=t?[1317,8,29]:[1900,1,0],o=6;else{s>60&&--s;var p=new Date(1900,0,1);p.setDate(p.getDate()+s-1),c=[p.getFullYear(),p.getMonth()+1,p.getDate()],o=p.getDay(),s<60&&(o=(o+6)%7),t&&(o=mL(p,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var MS=new Date(1899,11,31,0,0,0),cL=MS.getTime(),dL=new Date(1900,2,1,0,0,0);function LS(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=dL&&(t+=1440*60*1e3),(t-(cL+(e.getTimezoneOffset()-MS.getTimezoneOffset())*6e4))/(1440*60*1e3)}function ym(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function uL(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function fL(e){var r=e<0?12:11,t=ym(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function hL(e){var r=ym(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function pL(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=fL(e):r===10?t=e.toFixed(10).substr(0,12):t=hL(e),ym(uL(t.toUpperCase()))}function up(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):pL(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return si(14,LS(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function mL(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function xL(e,r,t,s){var a="",o=0,c=0,u=t.y,p,h=0;switch(e){case 98:u=t.y+543;case 121:switch(r.length){case 1:case 2:p=u%100,h=2;break;default:p=u%1e4,h=4;break}break;case 109:switch(r.length){case 1:case 2:p=t.m,h=r.length;break;case 3:return Oh[t.m-1][1];case 5:return Oh[t.m-1][0];default:return Oh[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:p=t.d,h=r.length;break;case 3:return Dv[t.q][0];default:return Dv[t.q][1]}break;case 104:switch(r.length){case 1:case 2:p=1+(t.H+11)%12,h=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:p=t.H,h=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:p=t.M,h=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?Ts(t.S,r.length):(s>=2?c=s===3?1e3:100:c=s===1?10:1,o=Math.round(c*(t.S+t.u)),o>=60*c&&(o=0),r==="s"?o===0?"0":""+o/c:(a=Ts(o,2+s),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":p=t.D*24+t.H;break;case"[m]":case"[mm]":p=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":p=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}h=r.length===3?1:2;break;case 101:p=u,h=1;break}var x=h>0?Ts(p,h):"";return x}function ei(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,s=e.substr(0,t);t!=e.length;t+=r)s+=(s.length>0?",":"")+e.substr(t,r);return s}var IS=/%/g;function gL(e,r,t){var s=r.replace(IS,""),a=r.length-s.length;return ya(e,s,t*Math.pow(10,2*a))+Tr("%",a)}function yL(e,r,t){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return ya(e,r.substr(0,s),t/Math.pow(10,3*(r.length-s)))}function BS(e,r){var t,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+BS(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(r/Math.pow(10,o)).toPrecision(s+1+(a+o)%a),t.indexOf("e")===-1){var c=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+o):t+="E+"+(c-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,p,h,x){return p+h+x.substr(0,(a+o)%a)+"."+x.substr(o)+"E"})}else t=r.toExponential(s);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var $S=/# (\?+)( ?)\/( ?)(\d+)/;function vL(e,r,t){var s=parseInt(e[4],10),a=Math.round(r*s),o=Math.floor(a/s),c=a-o*s,u=s;return t+(o===0?"":""+o)+" "+(c===0?Tr(" ",e[1].length+1+e[4].length):gm(c,e[1].length)+e[2]+"/"+e[3]+Ts(u,e[4].length))}function wL(e,r,t){return t+(r===0?"":""+r)+Tr(" ",e[1].length+2+e[4].length)}var US=/^#*0*\.([0#]+)/,zS=/\).*[0#]/,WS=/\(###\) ###\\?-####/;function bn(e){for(var r="",t,s=0;s!=e.length;++s)switch(t=e.charCodeAt(s)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Mv(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Lv(e,r){var t=e-Math.floor(e),s=Math.pow(10,r);return r<(""+Math.round(t*s)).length?0:Math.round(t*s)}function NL(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function SL(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ms(e,r,t){if(e.charCodeAt(0)===40&&!r.match(zS)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ms("n",s,t):"("+ms("n",s,-t)+")"}if(r.charCodeAt(r.length-1)===44)return yL(e,r,t);if(r.indexOf("%")!==-1)return gL(e,r,t);if(r.indexOf("E")!==-1)return BS(r,t);if(r.charCodeAt(0)===36)return"$"+ms(e,r.substr(r.charAt(1)==" "?2:1),t);var a,o,c,u,p=Math.abs(t),h=t<0?"-":"";if(r.match(/^00+$/))return h+So(p,r.length);if(r.match(/^[#?]+$/))return a=So(t,0),a==="0"&&(a=""),a.length>r.length?a:bn(r.substr(0,r.length-a.length))+a;if(o=r.match($S))return vL(o,p,h);if(r.match(/^#+0+$/))return h+So(p,r.length-r.indexOf("0"));if(o=r.match(US))return a=Mv(t,o[1].length).replace(/^([^\.]+)$/,"$1."+bn(o[1])).replace(/\.$/,"."+bn(o[1])).replace(/\.(\d*)$/,function(b,w){return"."+w+Tr("0",bn(o[1]).length-w.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return h+Mv(p,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return h+ei(So(p,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ms(e,r,-t):ei(""+(Math.floor(t)+NL(t,o[1].length)))+"."+Ts(Lv(t,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return ms(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ao(ms(e,r.replace(/[\\-]/g,""),t)),c=0,Ao(Ao(r.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<a.length?a.charAt(c++):b==="0"?"0":""}));if(r.match(WS))return a=ms(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var x="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=Au(p,Math.pow(10,c)-1,!1),a=""+h,x=ya("n",o[1],u[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),a+=x+o[2]+"/"+o[3],x=Cu(u[2],c),x.length<o[4].length&&(x=bn(o[4].substr(o[4].length-x.length))+x),a+=x,a;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=Au(p,Math.pow(10,c)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?gm(u[1],c)+o[2]+"/"+o[3]+Cu(u[2],c):Tr(" ",2*c+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return a=So(t,0),r.length<=a.length?a:bn(r.substr(0,r.length-a.length))+a;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var y=r.indexOf(".")-c,v=r.length-a.length-y;return bn(r.substr(0,y)+a+r.substr(r.length-v))}if(o=r.match(/^00,000\.([#0]*0)$/))return c=Lv(t,o[1].length),t<0?"-"+ms(e,r,-t):ei(SL(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Ts(0,3-b.length):"")+b})+"."+Ts(c,o[1].length);switch(r){case"###,##0.00":return ms(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var k=ei(So(p,0));return k!=="0"?h+k:"";case"###,###.00":return ms(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ms(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function bL(e,r,t){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return ya(e,r.substr(0,s),t/Math.pow(10,3*(r.length-s)))}function jL(e,r,t){var s=r.replace(IS,""),a=r.length-s.length;return ya(e,s,t*Math.pow(10,2*a))+Tr("%",a)}function qS(e,r){var t,s=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+qS(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%a;if(o<0&&(o+=a),t=(r/Math.pow(10,o)).toPrecision(s+1+(a+o)%a),!t.match(/[Ee]/)){var c=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+o):t+="E+"+(c-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,p,h,x){return p+h+x.substr(0,(a+o)%a)+"."+x.substr(o)+"E"})}else t=r.toExponential(s);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Gs(e,r,t){if(e.charCodeAt(0)===40&&!r.match(zS)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Gs("n",s,t):"("+Gs("n",s,-t)+")"}if(r.charCodeAt(r.length-1)===44)return bL(e,r,t);if(r.indexOf("%")!==-1)return jL(e,r,t);if(r.indexOf("E")!==-1)return qS(r,t);if(r.charCodeAt(0)===36)return"$"+Gs(e,r.substr(r.charAt(1)==" "?2:1),t);var a,o,c,u,p=Math.abs(t),h=t<0?"-":"";if(r.match(/^00+$/))return h+Ts(p,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:bn(r.substr(0,r.length-a.length))+a;if(o=r.match($S))return wL(o,p,h);if(r.match(/^#+0+$/))return h+Ts(p,r.length-r.indexOf("0"));if(o=r.match(US))return a=(""+t).replace(/^([^\.]+)$/,"$1."+bn(o[1])).replace(/\.$/,"."+bn(o[1])),a=a.replace(/\.(\d*)$/,function(b,w){return"."+w+Tr("0",bn(o[1]).length-w.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return h+(""+p).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return h+ei(""+p);if(o=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Gs(e,r,-t):ei(""+t)+"."+Tr("0",o[1].length);if(o=r.match(/^#,#*,#0/))return Gs(e,r.replace(/^#,#*,/,""),t);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ao(Gs(e,r.replace(/[\\-]/g,""),t)),c=0,Ao(Ao(r.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<a.length?a.charAt(c++):b==="0"?"0":""}));if(r.match(WS))return a=Gs(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var x="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=Au(p,Math.pow(10,c)-1,!1),a=""+h,x=ya("n",o[1],u[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),a+=x+o[2]+"/"+o[3],x=Cu(u[2],c),x.length<o[4].length&&(x=bn(o[4].substr(o[4].length-x.length))+x),a+=x,a;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=Au(p,Math.pow(10,c)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?gm(u[1],c)+o[2]+"/"+o[3]+Cu(u[2],c):Tr(" ",2*c+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:bn(r.substr(0,r.length-a.length))+a;if(o=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var y=r.indexOf(".")-c,v=r.length-a.length-y;return bn(r.substr(0,y)+a+r.substr(r.length-v))}if(o=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Gs(e,r,-t):ei(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Ts(0,3-b.length):"")+b})+"."+Ts(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var k=ei(""+p);return k!=="0"?h+k:"";default:if(r.match(/\.[0#?]*$/))return Gs(e,r.slice(0,r.lastIndexOf(".")),t)+bn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function ya(e,r,t){return(t|0)===t?Gs(e,r,t):ms(e,r,t)}function kL(e){for(var r=[],t=!1,s=0,a=0;s<e.length;++s)switch(e.charCodeAt(s)){case 34:t=!t;break;case 95:case 42:case 92:++s;break;case 59:r[r.length]=e.substr(a,s-a),a=s+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var VS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function QS(e){for(var r=0,t="",s="";r<e.length;)switch(t=e.charAt(r)){case"G":Eu(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(s=t;e.charAt(r++)!=="]"&&r<e.length;)s+=e.charAt(r);if(s.match(VS))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function _L(e,r,t,s){for(var a=[],o="",c=0,u="",p="t",h,x,y,v="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Eu(e,c))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";(y=e.charCodeAt(++c))!==34&&c<e.length;)o+=String.fromCharCode(y);a[a.length]={t:"t",v:o},++c;break;case"\\":var k=e.charAt(++c),b=k==="("||k===")"?k:"t";a[a.length]={t:b,v:k},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:r},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(h==null&&(h=Kd(r,t,e.charAt(c+1)==="2"),h==null))return"";a[a.length]={t:"X",v:e.substr(c,2)},p=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||h==null&&(h=Kd(r,t),h==null))return"";for(o=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)o+=u;u==="m"&&p.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),a[a.length]={t:u,v:o},p=u;break;case"A":case"a":case"":var w={t:u,v:u};if(h==null&&(h=Kd(r,t)),e.substr(c,3).toUpperCase()==="A/P"?(h!=null&&(w.v=h.H>=12?"P":"A"),w.t="T",v="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(h!=null&&(w.v=h.H>=12?"PM":"AM"),w.t="T",c+=5,v="h"):e.substr(c,5).toUpperCase()==="/"?(h!=null&&(w.v=h.H>=12?"":""),w.t="T",c+=5,v="h"):(w.t="t",++c),h==null&&w.t==="T")return"";a[a.length]=w,p=u;break;case"[":for(o=u;e.charAt(c++)!=="]"&&c<e.length;)o+=e.charAt(c);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(VS)){if(h==null&&(h=Kd(r,t),h==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},p=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",QS(e)||(a[a.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=u;++c<e.length&&(u=e.charAt(c))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;e.charAt(++c)===u;)o+=u;a[a.length]={t:u,v:o},p=u;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":a[a.length]={t:s===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)o+=e.charAt(c);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++c;break}var j=0,O=0,T;for(c=a.length-1,p="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=v,p="h",j<1&&(j=1);break;case"s":(T=a[c].v.match(/\.0+$/))&&(O=Math.max(O,T[0].length-1)),j<3&&(j=3);case"d":case"y":case"M":case"e":p=a[c].t;break;case"m":p==="s"&&(a[c].t="M",j<2&&(j=2));break;case"X":break;case"Z":j<1&&a[c].v.match(/[Hh]/)&&(j=1),j<2&&a[c].v.match(/[Mm]/)&&(j=2),j<3&&a[c].v.match(/[Ss]/)&&(j=3)}switch(j){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var F="",I;for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=xL(a[c].t.charCodeAt(0),a[c].v,h,O),a[c].t="t";break;case"n":case"?":for(I=c+1;a[I]!=null&&((u=a[I].t)==="?"||u==="D"||(u===" "||u==="t")&&a[I+1]!=null&&(a[I+1].t==="?"||a[I+1].t==="t"&&a[I+1].v==="/")||a[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[I].v==="/"||a[I].v===" "&&a[I+1]!=null&&a[I+1].t=="?"));)a[c].v+=a[I].v,a[I]={v:"",t:";"},++I;F+=a[c].v,c=I-1;break;case"G":a[c].t="t",a[c].v=up(r,t);break}var G="",B,Q;if(F.length>0){F.charCodeAt(0)==40?(B=r<0&&F.charCodeAt(0)===45?-r:r,Q=ya("n",F,B)):(B=r<0&&s>1?-r:r,Q=ya("n",F,B),B<0&&a[0]&&a[0].t=="t"&&(Q=Q.substr(1),a[0].v="-"+a[0].v)),I=Q.length-1;var z=a.length;for(c=0;c<a.length;++c)if(a[c]!=null&&a[c].t!="t"&&a[c].v.indexOf(".")>-1){z=c;break}var J=a.length;if(z===a.length&&Q.indexOf("E")===-1){for(c=a.length-1;c>=0;--c)a[c]==null||"n?".indexOf(a[c].t)===-1||(I>=a[c].v.length-1?(I-=a[c].v.length,a[c].v=Q.substr(I+1,a[c].v.length)):I<0?a[c].v="":(a[c].v=Q.substr(0,I+1),I=-1),a[c].t="t",J=c);I>=0&&J<a.length&&(a[J].v=Q.substr(0,I+1)+a[J].v)}else if(z!==a.length&&Q.indexOf("E")===-1){for(I=Q.indexOf(".")-1,c=z;c>=0;--c)if(!(a[c]==null||"n?".indexOf(a[c].t)===-1)){for(x=a[c].v.indexOf(".")>-1&&c===z?a[c].v.indexOf(".")-1:a[c].v.length-1,G=a[c].v.substr(x+1);x>=0;--x)I>=0&&(a[c].v.charAt(x)==="0"||a[c].v.charAt(x)==="#")&&(G=Q.charAt(I--)+G);a[c].v=G,a[c].t="t",J=c}for(I>=0&&J<a.length&&(a[J].v=Q.substr(0,I+1)+a[J].v),I=Q.indexOf(".")+1,c=z;c<a.length;++c)if(!(a[c]==null||"n?(".indexOf(a[c].t)===-1&&c!==z)){for(x=a[c].v.indexOf(".")>-1&&c===z?a[c].v.indexOf(".")+1:0,G=a[c].v.substr(0,x);x<a[c].v.length;++x)I<Q.length&&(G+=Q.charAt(I++));a[c].v=G,a[c].t="t",J=c}}}for(c=0;c<a.length;++c)a[c]!=null&&"n?".indexOf(a[c].t)>-1&&(B=s>1&&r<0&&c>0&&a[c-1].v==="-"?-r:r,a[c].v=ya(a[c].t,a[c].v,B),a[c].t="t");var ne="";for(c=0;c!==a.length;++c)a[c]!=null&&(ne+=a[c].v);return ne}var Iv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Bv(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function CL(e,r){var t=kL(e),s=t.length,a=t[s-1].indexOf("@");if(s<4&&a>-1&&--s,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var o=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[s,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var c=t[0].match(Iv),u=t[1].match(Iv);return Bv(r,c)?[s,t[0]]:Bv(r,u)?[s,t[1]]:[s,t[c!=null&&u!=null?2:1]]}return[s,o]}function si(e,r,t){t==null&&(t={});var s="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?s=t.dateNF:s=e;break;case"number":e==14&&t.dateNF?s=t.dateNF:s=(t.table!=null?t.table:Or)[e],s==null&&(s=t.table&&t.table[Fv[e]]||Or[Fv[e]]),s==null&&(s=lL[e]||"General");break}if(Eu(s,0))return up(r,t);r instanceof Date&&(r=LS(r,t.date1904));var a=CL(s,r);if(Eu(a[1]))return up(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return _L(a[1],r,t,a[0])}function HS(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(Or[t]==null){r<0&&(r=t);continue}if(Or[t]==e){r=t;break}}r<0&&(r=391)}return Or[r]=e,r}function h0(e){for(var r=0;r!=392;++r)e[r]!==void 0&&HS(e[r],r)}function p0(){Or=oL()}var GS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function EL(e){var r=typeof e=="number"?Or[e]:e;return r=r.replace(GS,"(\\d+)"),new RegExp("^"+r+"$")}function AL(e,r,t){var s=-1,a=-1,o=-1,c=-1,u=-1,p=-1;(r.match(GS)||[]).forEach(function(y,v){var k=parseInt(t[v+1],10);switch(y.toLowerCase().charAt(0)){case"y":s=k;break;case"d":o=k;break;case"h":c=k;break;case"s":p=k;break;case"m":c>=0?u=k:a=k;break}}),p>=0&&u==-1&&a>=0&&(u=a,a=-1);var h=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var x=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2);return c==-1&&u==-1&&p==-1?h:s==-1&&a==-1&&o==-1?x:h+"T"+x}var TL=(function(){var e={};e.version="1.2.0";function r(){for(var Q=0,z=new Array(256),J=0;J!=256;++J)Q=J,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,Q=Q&1?-306674912^Q>>>1:Q>>>1,z[J]=Q;return typeof Int32Array<"u"?new Int32Array(z):z}var t=r();function s(Q){var z=0,J=0,ne=0,fe=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ne=0;ne!=256;++ne)fe[ne]=Q[ne];for(ne=0;ne!=256;++ne)for(J=Q[ne],z=256+ne;z<4096;z+=256)J=fe[z]=J>>>8^Q[J&255];var me=[];for(ne=1;ne!=16;++ne)me[ne-1]=typeof Int32Array<"u"?fe.subarray(ne*256,ne*256+256):fe.slice(ne*256,ne*256+256);return me}var a=s(t),o=a[0],c=a[1],u=a[2],p=a[3],h=a[4],x=a[5],y=a[6],v=a[7],k=a[8],b=a[9],w=a[10],j=a[11],O=a[12],T=a[13],F=a[14];function I(Q,z){for(var J=z^-1,ne=0,fe=Q.length;ne<fe;)J=J>>>8^t[(J^Q.charCodeAt(ne++))&255];return~J}function G(Q,z){for(var J=z^-1,ne=Q.length-15,fe=0;fe<ne;)J=F[Q[fe++]^J&255]^T[Q[fe++]^J>>8&255]^O[Q[fe++]^J>>16&255]^j[Q[fe++]^J>>>24]^w[Q[fe++]]^b[Q[fe++]]^k[Q[fe++]]^v[Q[fe++]]^y[Q[fe++]]^x[Q[fe++]]^h[Q[fe++]]^p[Q[fe++]]^u[Q[fe++]]^c[Q[fe++]]^o[Q[fe++]]^t[Q[fe++]];for(ne+=15;fe<ne;)J=J>>>8^t[(J^Q[fe++])&255];return~J}function B(Q,z){for(var J=z^-1,ne=0,fe=Q.length,me=0,le=0;ne<fe;)me=Q.charCodeAt(ne++),me<128?J=J>>>8^t[(J^me)&255]:me<2048?(J=J>>>8^t[(J^(192|me>>6&31))&255],J=J>>>8^t[(J^(128|me&63))&255]):me>=55296&&me<57344?(me=(me&1023)+64,le=Q.charCodeAt(ne++)&1023,J=J>>>8^t[(J^(240|me>>8&7))&255],J=J>>>8^t[(J^(128|me>>2&63))&255],J=J>>>8^t[(J^(128|le>>6&15|(me&3)<<4))&255],J=J>>>8^t[(J^(128|le&63))&255]):(J=J>>>8^t[(J^(224|me>>12&15))&255],J=J>>>8^t[(J^(128|me>>6&63))&255],J=J>>>8^t[(J^(128|me&63))&255]);return~J}return e.table=t,e.bstr=I,e.buf=G,e.str=B,e})(),dr=(function(){var r={};r.version="1.2.1";function t(C,M){for(var W=C.split("/"),q=M.split("/"),H=0,X=0,Se=Math.min(W.length,q.length);H<Se;++H){if(X=W[H].length-q[H].length)return X;if(W[H]!=q[H])return W[H]<q[H]?-1:1}return W.length-q.length}function s(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:s(C.slice(0,-1));var M=C.lastIndexOf("/");return M===-1?C:C.slice(0,M+1)}function a(C){if(C.charAt(C.length-1)=="/")return a(C.slice(0,-1));var M=C.lastIndexOf("/");return M===-1?C:C.slice(M+1)}function o(C,M){typeof M=="string"&&(M=new Date(M));var W=M.getHours();W=W<<6|M.getMinutes(),W=W<<5|M.getSeconds()>>>1,C.write_shift(2,W);var q=M.getFullYear()-1980;q=q<<4|M.getMonth()+1,q=q<<5|M.getDate(),C.write_shift(2,q)}function c(C){var M=C.read_shift(2)&65535,W=C.read_shift(2)&65535,q=new Date,H=W&31;W>>>=5;var X=W&15;W>>>=4,q.setMilliseconds(0),q.setFullYear(W+1980),q.setMonth(X-1),q.setDate(H);var Se=M&31;M>>>=5;var De=M&63;return M>>>=6,q.setHours(M),q.setMinutes(De),q.setSeconds(Se<<1),q}function u(C){rs(C,0);for(var M={},W=0;C.l<=C.length-4;){var q=C.read_shift(2),H=C.read_shift(2),X=C.l+H,Se={};switch(q){case 21589:W=C.read_shift(1),W&1&&(Se.mtime=C.read_shift(4)),H>5&&(W&2&&(Se.atime=C.read_shift(4)),W&4&&(Se.ctime=C.read_shift(4))),Se.mtime&&(Se.mt=new Date(Se.mtime*1e3));break}C.l=X,M[q]=Se}return M}var p;function h(){return p||(p={})}function x(C,M){if(C[0]==80&&C[1]==75)return Ut(C,M);if((C[0]|32)==109&&(C[1]|32)==105)return at(C,M);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var W=3,q=512,H=0,X=0,Se=0,De=0,je=0,ke=[],Ce=C.slice(0,512);rs(Ce,0);var We=y(Ce);switch(W=We[0],W){case 3:q=512;break;case 4:q=4096;break;case 0:if(We[1]==0)return Ut(C,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+W)}q!==512&&(Ce=C.slice(0,q),rs(Ce,28));var Xe=C.slice(0,q);v(Ce,W);var nt=Ce.read_shift(4,"i");if(W===3&&nt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+nt);Ce.l+=4,Se=Ce.read_shift(4,"i"),Ce.l+=4,Ce.chk("00100000","Mini Stream Cutoff Size: "),De=Ce.read_shift(4,"i"),H=Ce.read_shift(4,"i"),je=Ce.read_shift(4,"i"),X=Ce.read_shift(4,"i");for(var Qe=-1,Ve=0;Ve<109&&(Qe=Ce.read_shift(4,"i"),!(Qe<0));++Ve)ke[Ve]=Qe;var Et=k(C,q);j(je,X,Et,q,ke);var pr=T(Et,Se,ke,q);pr[Se].name="!Directory",H>0&&De!==le&&(pr[De].name="!MiniFAT"),pr[ke[0]].name="!FAT",pr.fat_addrs=ke,pr.ssz=q;var mr={},Pr=[],fi=[],Ea=[];F(Se,pr,Et,Pr,H,mr,fi,De),b(fi,Ea,Pr),Pr.shift();var zs={FileIndex:fi,FullPaths:Ea};return M&&M.raw&&(zs.raw={header:Xe,sectors:Et}),zs}function y(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(K,"Header Signature: "),C.l+=16;var M=C.read_shift(2,"u");return[C.read_shift(2,"u"),M]}function v(C,M){var W=9;switch(C.l+=2,W=C.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+W);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+W);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+W)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function k(C,M){for(var W=Math.ceil(C.length/M)-1,q=[],H=1;H<W;++H)q[H-1]=C.slice(H*M,(H+1)*M);return q[W-1]=C.slice(W*M),q}function b(C,M,W){for(var q=0,H=0,X=0,Se=0,De=0,je=W.length,ke=[],Ce=[];q<je;++q)ke[q]=Ce[q]=q,M[q]=W[q];for(;De<Ce.length;++De)q=Ce[De],H=C[q].L,X=C[q].R,Se=C[q].C,ke[q]===q&&(H!==-1&&ke[H]!==H&&(ke[q]=ke[H]),X!==-1&&ke[X]!==X&&(ke[q]=ke[X])),Se!==-1&&(ke[Se]=q),H!==-1&&q!=ke[q]&&(ke[H]=ke[q],Ce.lastIndexOf(H)<De&&Ce.push(H)),X!==-1&&q!=ke[q]&&(ke[X]=ke[q],Ce.lastIndexOf(X)<De&&Ce.push(X));for(q=1;q<je;++q)ke[q]===q&&(X!==-1&&ke[X]!==X?ke[q]=ke[X]:H!==-1&&ke[H]!==H&&(ke[q]=ke[H]));for(q=1;q<je;++q)if(C[q].type!==0){if(De=q,De!=ke[De])do De=ke[De],M[q]=M[De]+"/"+M[q];while(De!==0&&ke[De]!==-1&&De!=ke[De]);ke[q]=-1}for(M[0]+="/",q=1;q<je;++q)C[q].type!==2&&(M[q]+="/")}function w(C,M,W){for(var q=C.start,H=C.size,X=[],Se=q;W&&H>0&&Se>=0;)X.push(M.slice(Se*me,Se*me+me)),H-=me,Se=Ci(W,Se*4);return X.length===0?Pe(0):sn(X).slice(0,C.size)}function j(C,M,W,q,H){var X=le;if(C===le){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var Se=W[C],De=(q>>>2)-1;if(!Se)return;for(var je=0;je<De&&(X=Ci(Se,je*4))!==le;++je)H.push(X);j(Ci(Se,q-4),M-1,W,q,H)}}function O(C,M,W,q,H){var X=[],Se=[];H||(H=[]);var De=q-1,je=0,ke=0;for(je=M;je>=0;){H[je]=!0,X[X.length]=je,Se.push(C[je]);var Ce=W[Math.floor(je*4/q)];if(ke=je*4&De,q<4+ke)throw new Error("FAT boundary crossed: "+je+" 4 "+q);if(!C[Ce])break;je=Ci(C[Ce],ke)}return{nodes:X,data:Hv([Se])}}function T(C,M,W,q){var H=C.length,X=[],Se=[],De=[],je=[],ke=q-1,Ce=0,We=0,Xe=0,nt=0;for(Ce=0;Ce<H;++Ce)if(De=[],Xe=Ce+M,Xe>=H&&(Xe-=H),!Se[Xe]){je=[];var Qe=[];for(We=Xe;We>=0;){Qe[We]=!0,Se[We]=!0,De[De.length]=We,je.push(C[We]);var Ve=W[Math.floor(We*4/q)];if(nt=We*4&ke,q<4+nt)throw new Error("FAT boundary crossed: "+We+" 4 "+q);if(!C[Ve]||(We=Ci(C[Ve],nt),Qe[We]))break}X[Xe]={nodes:De,data:Hv([je])}}return X}function F(C,M,W,q,H,X,Se,De){for(var je=0,ke=q.length?2:0,Ce=M[C].data,We=0,Xe=0,nt;We<Ce.length;We+=128){var Qe=Ce.slice(We,We+128);rs(Qe,64),Xe=Qe.read_shift(2),nt=bm(Qe,0,Xe-ke),q.push(nt);var Ve={name:nt,type:Qe.read_shift(1),color:Qe.read_shift(1),L:Qe.read_shift(4,"i"),R:Qe.read_shift(4,"i"),C:Qe.read_shift(4,"i"),clsid:Qe.read_shift(16),state:Qe.read_shift(4,"i"),start:0,size:0},Et=Qe.read_shift(2)+Qe.read_shift(2)+Qe.read_shift(2)+Qe.read_shift(2);Et!==0&&(Ve.ct=I(Qe,Qe.l-8));var pr=Qe.read_shift(2)+Qe.read_shift(2)+Qe.read_shift(2)+Qe.read_shift(2);pr!==0&&(Ve.mt=I(Qe,Qe.l-8)),Ve.start=Qe.read_shift(4,"i"),Ve.size=Qe.read_shift(4,"i"),Ve.size<0&&Ve.start<0&&(Ve.size=Ve.type=0,Ve.start=le,Ve.name=""),Ve.type===5?(je=Ve.start,H>0&&je!==le&&(M[je].name="!StreamData")):Ve.size>=4096?(Ve.storage="fat",M[Ve.start]===void 0&&(M[Ve.start]=O(W,Ve.start,M.fat_addrs,M.ssz)),M[Ve.start].name=Ve.name,Ve.content=M[Ve.start].data.slice(0,Ve.size)):(Ve.storage="minifat",Ve.size<0?Ve.size=0:je!==le&&Ve.start!==le&&M[je]&&(Ve.content=w(Ve,M[je].data,(M[De]||{}).data))),Ve.content&&rs(Ve.content,0),X[nt]=Ve,Se.push(Ve)}}function I(C,M){return new Date((as(C,M+4)/1e7*Math.pow(2,32)+as(C,M)/1e7-11644473600)*1e3)}function G(C,M){return h(),x(p.readFileSync(C),M)}function B(C,M){var W=M&&M.type;switch(W||Xt&&Buffer.isBuffer(C)&&(W="buffer"),W||"base64"){case"file":return G(C,M);case"base64":return x(As(ja(C)),M);case"binary":return x(As(C),M)}return x(C,M)}function Q(C,M){var W=M||{},q=W.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=q+"/",C.FileIndex[0]={name:q,type:5}),W.CLSID&&(C.FileIndex[0].clsid=W.CLSID),z(C)}function z(C){var M="Sh33tJ5";if(!dr.find(C,"/"+M)){var W=Pe(4);W[0]=55,W[1]=W[3]=50,W[2]=54,C.FileIndex.push({name:M,type:2,content:W,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+M),J(C)}}function J(C,M){Q(C);for(var W=!1,q=!1,H=C.FullPaths.length-1;H>=0;--H){var X=C.FileIndex[H];switch(X.type){case 0:q?W=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:q=!0,isNaN(X.R*X.L*X.C)&&(W=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(W=!0);break;default:W=!0;break}}if(!(!W&&!M)){var Se=new Date(1987,1,19),De=0,je=Object.create?Object.create(null):{},ke=[];for(H=0;H<C.FullPaths.length;++H)je[C.FullPaths[H]]=!0,C.FileIndex[H].type!==0&&ke.push([C.FullPaths[H],C.FileIndex[H]]);for(H=0;H<ke.length;++H){var Ce=s(ke[H][0]);q=je[Ce],q||(ke.push([Ce,{name:a(Ce).replace("/",""),type:1,clsid:we,ct:Se,mt:Se,content:null}]),je[Ce]=!0)}for(ke.sort(function(nt,Qe){return t(nt[0],Qe[0])}),C.FullPaths=[],C.FileIndex=[],H=0;H<ke.length;++H)C.FullPaths[H]=ke[H][0],C.FileIndex[H]=ke[H][1];for(H=0;H<ke.length;++H){var We=C.FileIndex[H],Xe=C.FullPaths[H];if(We.name=a(Xe).replace("/",""),We.L=We.R=We.C=-(We.color=1),We.size=We.content?We.content.length:0,We.start=0,We.clsid=We.clsid||we,H===0)We.C=ke.length>1?1:-1,We.size=0,We.type=5;else if(Xe.slice(-1)=="/"){for(De=H+1;De<ke.length&&s(C.FullPaths[De])!=Xe;++De);for(We.C=De>=ke.length?-1:De,De=H+1;De<ke.length&&s(C.FullPaths[De])!=s(Xe);++De);We.R=De>=ke.length?-1:De,We.type=1}else s(C.FullPaths[H+1]||"")==s(Xe)&&(We.R=H+1),We.type=2}}}function ne(C,M){var W=M||{};if(W.fileType=="mad")return d(C,W);switch(J(C),W.fileType){case"zip":return It(C,W)}var q=(function(nt){for(var Qe=0,Ve=0,Et=0;Et<nt.FileIndex.length;++Et){var pr=nt.FileIndex[Et];if(pr.content){var mr=pr.content.length;mr>0&&(mr<4096?Qe+=mr+63>>6:Ve+=mr+511>>9)}}for(var Pr=nt.FullPaths.length+3>>2,fi=Qe+7>>3,Ea=Qe+127>>7,zs=fi+Ve+Pr+Ea,Qr=zs+127>>7,Zo=Qr<=109?0:Math.ceil((Qr-109)/127);zs+Qr+Zo+127>>7>Qr;)Zo=++Qr<=109?0:Math.ceil((Qr-109)/127);var Rr=[1,Zo,Qr,Ea,Pr,Ve,Qe,0];return nt.FileIndex[0].size=Qe<<6,Rr[7]=(nt.FileIndex[0].start=Rr[0]+Rr[1]+Rr[2]+Rr[3]+Rr[4]+Rr[5])+(Rr[6]+7>>3),Rr})(C),H=Pe(q[7]<<9),X=0,Se=0;{for(X=0;X<8;++X)H.write_shift(1,Fe[X]);for(X=0;X<8;++X)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),X=0;X<3;++X)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,q[2]),H.write_shift(4,q[0]+q[1]+q[2]+q[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,q[3]?q[0]+q[1]+q[2]-1:le),H.write_shift(4,q[3]),H.write_shift(-4,q[1]?q[0]-1:le),H.write_shift(4,q[1]),X=0;X<109;++X)H.write_shift(-4,X<q[2]?q[1]+X:-1)}if(q[1])for(Se=0;Se<q[1];++Se){for(;X<236+Se*127;++X)H.write_shift(-4,X<q[2]?q[1]+X:-1);H.write_shift(-4,Se===q[1]-1?le:Se+1)}var De=function(nt){for(Se+=nt;X<Se-1;++X)H.write_shift(-4,X+1);nt&&(++X,H.write_shift(-4,le))};for(Se=X=0,Se+=q[1];X<Se;++X)H.write_shift(-4,oe.DIFSECT);for(Se+=q[2];X<Se;++X)H.write_shift(-4,oe.FATSECT);De(q[3]),De(q[4]);for(var je=0,ke=0,Ce=C.FileIndex[0];je<C.FileIndex.length;++je)Ce=C.FileIndex[je],Ce.content&&(ke=Ce.content.length,!(ke<4096)&&(Ce.start=Se,De(ke+511>>9)));for(De(q[6]+7>>3);H.l&511;)H.write_shift(-4,oe.ENDOFCHAIN);for(Se=X=0,je=0;je<C.FileIndex.length;++je)Ce=C.FileIndex[je],Ce.content&&(ke=Ce.content.length,!(!ke||ke>=4096)&&(Ce.start=Se,De(ke+63>>6)));for(;H.l&511;)H.write_shift(-4,oe.ENDOFCHAIN);for(X=0;X<q[4]<<2;++X){var We=C.FullPaths[X];if(!We||We.length===0){for(je=0;je<17;++je)H.write_shift(4,0);for(je=0;je<3;++je)H.write_shift(4,-1);for(je=0;je<12;++je)H.write_shift(4,0);continue}Ce=C.FileIndex[X],X===0&&(Ce.start=Ce.size?Ce.start-1:le);var Xe=X===0&&W.root||Ce.name;if(ke=2*(Xe.length+1),H.write_shift(64,Xe,"utf16le"),H.write_shift(2,ke),H.write_shift(1,Ce.type),H.write_shift(1,Ce.color),H.write_shift(-4,Ce.L),H.write_shift(-4,Ce.R),H.write_shift(-4,Ce.C),Ce.clsid)H.write_shift(16,Ce.clsid,"hex");else for(je=0;je<4;++je)H.write_shift(4,0);H.write_shift(4,Ce.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,Ce.start),H.write_shift(4,Ce.size),H.write_shift(4,0)}for(X=1;X<C.FileIndex.length;++X)if(Ce=C.FileIndex[X],Ce.size>=4096)if(H.l=Ce.start+1<<9,Xt&&Buffer.isBuffer(Ce.content))Ce.content.copy(H,H.l,0,Ce.size),H.l+=Ce.size+511&-512;else{for(je=0;je<Ce.size;++je)H.write_shift(1,Ce.content[je]);for(;je&511;++je)H.write_shift(1,0)}for(X=1;X<C.FileIndex.length;++X)if(Ce=C.FileIndex[X],Ce.size>0&&Ce.size<4096)if(Xt&&Buffer.isBuffer(Ce.content))Ce.content.copy(H,H.l,0,Ce.size),H.l+=Ce.size+63&-64;else{for(je=0;je<Ce.size;++je)H.write_shift(1,Ce.content[je]);for(;je&63;++je)H.write_shift(1,0)}if(Xt)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function fe(C,M){var W=C.FullPaths.map(function(je){return je.toUpperCase()}),q=W.map(function(je){var ke=je.split("/");return ke[ke.length-(je.slice(-1)=="/"?2:1)]}),H=!1;M.charCodeAt(0)===47?(H=!0,M=W[0].slice(0,-1)+M):H=M.indexOf("/")!==-1;var X=M.toUpperCase(),Se=H===!0?W.indexOf(X):q.indexOf(X);if(Se!==-1)return C.FileIndex[Se];var De=!X.match(Yd);for(X=X.replace(Wl,""),De&&(X=X.replace(Yd,"!")),Se=0;Se<W.length;++Se)if((De?W[Se].replace(Yd,"!"):W[Se]).replace(Wl,"")==X||(De?q[Se].replace(Yd,"!"):q[Se]).replace(Wl,"")==X)return C.FileIndex[Se];return null}var me=64,le=-2,K="d0cf11e0a1b11ae1",Fe=[208,207,17,224,161,177,26,225],we="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:le,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:we,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function V(C,M,W){h();var q=ne(C,W);p.writeFileSync(M,q)}function de(C){for(var M=new Array(C.length),W=0;W<C.length;++W)M[W]=String.fromCharCode(C[W]);return M.join("")}function Ne(C,M){var W=ne(C,M);switch(M&&M.type||"buffer"){case"file":return h(),p.writeFileSync(M.filename,W),W;case"binary":return typeof W=="string"?W:de(W);case"base64":return rc(typeof W=="string"?W:de(W));case"buffer":if(Xt)return Buffer.isBuffer(W)?W:Ca(W);case"array":return typeof W=="string"?As(W):W}return W}var ee;function U(C){try{var M=C.InflateRaw,W=new M;if(W._processChunk(new Uint8Array([3,0]),W._finishFlushFlag),W.bytesRead)ee=C;else throw new Error("zlib does not expose bytesRead")}catch(q){console.error("cannot use native zlib: "+(q.message||q))}}function re(C,M){if(!ee)return Bt(C,M);var W=ee.InflateRaw,q=new W,H=q._processChunk(C.slice(C.l),q._finishFlushFlag);return C.l+=q.bytesRead,H}function Y(C){return ee?ee.deflateRawSync(C):Ue(C)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Te(C){var M=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(M>>16|M>>8|M)&255}for(var ve=typeof Uint8Array<"u",Ee=ve?new Uint8Array(256):[],Me=0;Me<256;++Me)Ee[Me]=Te(Me);function D(C,M){var W=Ee[C&255];return M<=8?W>>>8-M:(W=W<<8|Ee[C>>8&255],M<=16?W>>>16-M:(W=W<<8|Ee[C>>16&255],W>>>24-M))}function ut(C,M){var W=M&7,q=M>>>3;return(C[q]|(W<=6?0:C[q+1]<<8))>>>W&3}function et(C,M){var W=M&7,q=M>>>3;return(C[q]|(W<=5?0:C[q+1]<<8))>>>W&7}function Ge(C,M){var W=M&7,q=M>>>3;return(C[q]|(W<=4?0:C[q+1]<<8))>>>W&15}function Be(C,M){var W=M&7,q=M>>>3;return(C[q]|(W<=3?0:C[q+1]<<8))>>>W&31}function Le(C,M){var W=M&7,q=M>>>3;return(C[q]|(W<=1?0:C[q+1]<<8))>>>W&127}function ft(C,M,W){var q=M&7,H=M>>>3,X=(1<<W)-1,Se=C[H]>>>q;return W<8-q||(Se|=C[H+1]<<8-q,W<16-q)||(Se|=C[H+2]<<16-q,W<24-q)||(Se|=C[H+3]<<24-q),Se&X}function rt(C,M,W){var q=M&7,H=M>>>3;return q<=5?C[H]|=(W&7)<<q:(C[H]|=W<<q&255,C[H+1]=(W&7)>>8-q),M+3}function hr(C,M,W){var q=M&7,H=M>>>3;return W=(W&1)<<q,C[H]|=W,M+1}function lr(C,M,W){var q=M&7,H=M>>>3;return W<<=q,C[H]|=W&255,W>>>=8,C[H+1]=W,M+8}function Nr(C,M,W){var q=M&7,H=M>>>3;return W<<=q,C[H]|=W&255,W>>>=8,C[H+1]=W&255,C[H+2]=W>>>8,M+16}function Zt(C,M){var W=C.length,q=2*W>M?2*W:M+5,H=0;if(W>=M)return C;if(Xt){var X=Pv(q);if(C.copy)C.copy(X);else for(;H<C.length;++H)X[H]=C[H];return X}else if(ve){var Se=new Uint8Array(q);if(Se.set)Se.set(C);else for(;H<W;++H)Se[H]=C[H];return Se}return C.length=q,C}function cr(C){for(var M=new Array(C),W=0;W<C;++W)M[W]=0;return M}function Mt(C,M,W){var q=1,H=0,X=0,Se=0,De=0,je=C.length,ke=ve?new Uint16Array(32):cr(32);for(X=0;X<32;++X)ke[X]=0;for(X=je;X<W;++X)C[X]=0;je=C.length;var Ce=ve?new Uint16Array(je):cr(je);for(X=0;X<je;++X)ke[H=C[X]]++,q<H&&(q=H),Ce[X]=0;for(ke[0]=0,X=1;X<=q;++X)ke[X+16]=De=De+ke[X-1]<<1;for(X=0;X<je;++X)De=C[X],De!=0&&(Ce[X]=ke[De+16]++);var We=0;for(X=0;X<je;++X)if(We=C[X],We!=0)for(De=D(Ce[X],q)>>q-We,Se=(1<<q+4-We)-1;Se>=0;--Se)M[De|Se<<We]=We&15|X<<4;return q}var Dt=ve?new Uint16Array(512):cr(512),St=ve?new Uint16Array(32):cr(32);if(!ve){for(var Je=0;Je<512;++Je)Dt[Je]=0;for(Je=0;Je<32;++Je)St[Je]=0}(function(){for(var C=[],M=0;M<32;M++)C.push(5);Mt(C,St,32);var W=[];for(M=0;M<=143;M++)W.push(8);for(;M<=255;M++)W.push(9);for(;M<=279;M++)W.push(7);for(;M<=287;M++)W.push(8);Mt(W,Dt,288)})();var Ht=(function(){for(var M=ve?new Uint8Array(32768):[],W=0,q=0;W<ie.length-1;++W)for(;q<ie[W+1];++q)M[q]=W;for(;q<32768;++q)M[q]=29;var H=ve?new Uint8Array(259):[];for(W=0,q=0;W<xe.length-1;++W)for(;q<xe[W+1];++q)H[q]=W;function X(De,je){for(var ke=0;ke<De.length;){var Ce=Math.min(65535,De.length-ke),We=ke+Ce==De.length;for(je.write_shift(1,+We),je.write_shift(2,Ce),je.write_shift(2,~Ce&65535);Ce-- >0;)je[je.l++]=De[ke++]}return je.l}function Se(De,je){for(var ke=0,Ce=0,We=ve?new Uint16Array(32768):[];Ce<De.length;){var Xe=Math.min(65535,De.length-Ce);if(Xe<10){for(ke=rt(je,ke,+(Ce+Xe==De.length)),ke&7&&(ke+=8-(ke&7)),je.l=ke/8|0,je.write_shift(2,Xe),je.write_shift(2,~Xe&65535);Xe-- >0;)je[je.l++]=De[Ce++];ke=je.l*8;continue}ke=rt(je,ke,+(Ce+Xe==De.length)+2);for(var nt=0;Xe-- >0;){var Qe=De[Ce];nt=(nt<<5^Qe)&32767;var Ve=-1,Et=0;if((Ve=We[nt])&&(Ve|=Ce&-32768,Ve>Ce&&(Ve-=32768),Ve<Ce))for(;De[Ve+Et]==De[Ce+Et]&&Et<250;)++Et;if(Et>2){Qe=H[Et],Qe<=22?ke=lr(je,ke,Ee[Qe+1]>>1)-1:(lr(je,ke,3),ke+=5,lr(je,ke,Ee[Qe-23]>>5),ke+=3);var pr=Qe<8?0:Qe-4>>2;pr>0&&(Nr(je,ke,Et-xe[Qe]),ke+=pr),Qe=M[Ce-Ve],ke=lr(je,ke,Ee[Qe]>>3),ke-=3;var mr=Qe<4?0:Qe-2>>1;mr>0&&(Nr(je,ke,Ce-Ve-ie[Qe]),ke+=mr);for(var Pr=0;Pr<Et;++Pr)We[nt]=Ce&32767,nt=(nt<<5^De[Ce])&32767,++Ce;Xe-=Et-1}else Qe<=143?Qe=Qe+48:ke=hr(je,ke,1),ke=lr(je,ke,Ee[Qe]),We[nt]=Ce&32767,++Ce}ke=lr(je,ke,0)-1}return je.l=(ke+7)/8|0,je.l}return function(je,ke){return je.length<8?X(je,ke):Se(je,ke)}})();function Ue(C){var M=Pe(50+Math.floor(C.length*1.1)),W=Ht(C,M);return M.slice(0,W)}var Ft=ve?new Uint16Array(32768):cr(32768),Gt=ve?new Uint16Array(32768):cr(32768),kt=ve?new Uint16Array(128):cr(128),_t=1,Ct=1;function Wt(C,M){var W=Be(C,M)+257;M+=5;var q=Be(C,M)+1;M+=5;var H=Ge(C,M)+4;M+=4;for(var X=0,Se=ve?new Uint8Array(19):cr(19),De=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],je=1,ke=ve?new Uint8Array(8):cr(8),Ce=ve?new Uint8Array(8):cr(8),We=Se.length,Xe=0;Xe<H;++Xe)Se[Z[Xe]]=X=et(C,M),je<X&&(je=X),ke[X]++,M+=3;var nt=0;for(ke[0]=0,Xe=1;Xe<=je;++Xe)Ce[Xe]=nt=nt+ke[Xe-1]<<1;for(Xe=0;Xe<We;++Xe)(nt=Se[Xe])!=0&&(De[Xe]=Ce[nt]++);var Qe=0;for(Xe=0;Xe<We;++Xe)if(Qe=Se[Xe],Qe!=0){nt=Ee[De[Xe]]>>8-Qe;for(var Ve=(1<<7-Qe)-1;Ve>=0;--Ve)kt[nt|Ve<<Qe]=Qe&7|Xe<<3}var Et=[];for(je=1;Et.length<W+q;)switch(nt=kt[Le(C,M)],M+=nt&7,nt>>>=3){case 16:for(X=3+ut(C,M),M+=2,nt=Et[Et.length-1];X-- >0;)Et.push(nt);break;case 17:for(X=3+et(C,M),M+=3;X-- >0;)Et.push(0);break;case 18:for(X=11+Le(C,M),M+=7;X-- >0;)Et.push(0);break;default:Et.push(nt),je<nt&&(je=nt);break}var pr=Et.slice(0,W),mr=Et.slice(W);for(Xe=W;Xe<286;++Xe)pr[Xe]=0;for(Xe=q;Xe<30;++Xe)mr[Xe]=0;return _t=Mt(pr,Ft,286),Ct=Mt(mr,Gt,30),M}function qt(C,M){if(C[0]==3&&!(C[1]&3))return[Ii(M),2];for(var W=0,q=0,H=Pv(M||1<<18),X=0,Se=H.length>>>0,De=0,je=0;(q&1)==0;){if(q=et(C,W),W+=3,q>>>1)q>>1==1?(De=9,je=5):(W=Wt(C,W),De=_t,je=Ct);else{W&7&&(W+=8-(W&7));var ke=C[W>>>3]|C[(W>>>3)+1]<<8;if(W+=32,ke>0)for(!M&&Se<X+ke&&(H=Zt(H,X+ke),Se=H.length);ke-- >0;)H[X++]=C[W>>>3],W+=8;continue}for(;;){!M&&Se<X+32767&&(H=Zt(H,X+32767),Se=H.length);var Ce=ft(C,W,De),We=q>>>1==1?Dt[Ce]:Ft[Ce];if(W+=We&15,We>>>=4,(We>>>8&255)===0)H[X++]=We;else{if(We==256)break;We-=257;var Xe=We<8?0:We-4>>2;Xe>5&&(Xe=0);var nt=X+xe[We];Xe>0&&(nt+=ft(C,W,Xe),W+=Xe),Ce=ft(C,W,je),We=q>>>1==1?St[Ce]:Gt[Ce],W+=We&15,We>>>=4;var Qe=We<4?0:We-2>>1,Ve=ie[We];for(Qe>0&&(Ve+=ft(C,W,Qe),W+=Qe),!M&&Se<nt&&(H=Zt(H,nt+100),Se=H.length);X<nt;)H[X]=H[X-Ve],++X}}}return M?[H,W+7>>>3]:[H.slice(0,X),W+7>>>3]}function Bt(C,M){var W=C.slice(C.l||0),q=qt(W,M);return C.l+=q[1],q[0]}function $t(C,M){if(C)typeof console<"u"&&console.error(M);else throw new Error(M)}function Ut(C,M){var W=C;rs(W,0);var q=[],H=[],X={FileIndex:q,FullPaths:H};Q(X,{root:M.root});for(var Se=W.length-4;(W[Se]!=80||W[Se+1]!=75||W[Se+2]!=5||W[Se+3]!=6)&&Se>=0;)--Se;W.l=Se+4,W.l+=4;var De=W.read_shift(2);W.l+=6;var je=W.read_shift(4);for(W.l=je,Se=0;Se<De;++Se){W.l+=20;var ke=W.read_shift(4),Ce=W.read_shift(4),We=W.read_shift(2),Xe=W.read_shift(2),nt=W.read_shift(2);W.l+=8;var Qe=W.read_shift(4),Ve=u(W.slice(W.l+We,W.l+We+Xe));W.l+=We+Xe+nt;var Et=W.l;W.l=Qe+4,Lt(W,ke,Ce,X,Ve),W.l=Et}return X}function Lt(C,M,W,q,H){C.l+=2;var X=C.read_shift(2),Se=C.read_shift(2),De=c(C);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var je=C.read_shift(4),ke=C.read_shift(4),Ce=C.read_shift(4),We=C.read_shift(2),Xe=C.read_shift(2),nt="",Qe=0;Qe<We;++Qe)nt+=String.fromCharCode(C[C.l++]);if(Xe){var Ve=u(C.slice(C.l,C.l+Xe));(Ve[21589]||{}).mt&&(De=Ve[21589].mt),((H||{})[21589]||{}).mt&&(De=H[21589].mt)}C.l+=Xe;var Et=C.slice(C.l,C.l+ke);switch(Se){case 8:Et=re(C,Ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Se)}var pr=!1;X&8&&(je=C.read_shift(4),je==134695760&&(je=C.read_shift(4),pr=!0),ke=C.read_shift(4),Ce=C.read_shift(4)),ke!=M&&$t(pr,"Bad compressed size: "+M+" != "+ke),Ce!=W&&$t(pr,"Bad uncompressed size: "+W+" != "+Ce),E(q,nt,Et,{unsafe:!0,mt:De})}function It(C,M){var W=M||{},q=[],H=[],X=Pe(1),Se=W.compression?8:0,De=0,je=0,ke=0,Ce=0,We=0,Xe=C.FullPaths[0],nt=Xe,Qe=C.FileIndex[0],Ve=[],Et=0;for(je=1;je<C.FullPaths.length;++je)if(nt=C.FullPaths[je].slice(Xe.length),Qe=C.FileIndex[je],!(!Qe.size||!Qe.content||nt=="Sh33tJ5")){var pr=Ce,mr=Pe(nt.length);for(ke=0;ke<nt.length;++ke)mr.write_shift(1,nt.charCodeAt(ke)&127);mr=mr.slice(0,mr.l),Ve[We]=TL.buf(Qe.content,0);var Pr=Qe.content;Se==8&&(Pr=Y(Pr)),X=Pe(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,De),X.write_shift(2,Se),Qe.mt?o(X,Qe.mt):X.write_shift(4,0),X.write_shift(-4,Ve[We]),X.write_shift(4,Pr.length),X.write_shift(4,Qe.content.length),X.write_shift(2,mr.length),X.write_shift(2,0),Ce+=X.length,q.push(X),Ce+=mr.length,q.push(mr),Ce+=Pr.length,q.push(Pr),X=Pe(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,De),X.write_shift(2,Se),X.write_shift(4,0),X.write_shift(-4,Ve[We]),X.write_shift(4,Pr.length),X.write_shift(4,Qe.content.length),X.write_shift(2,mr.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,pr),Et+=X.l,H.push(X),Et+=mr.length,H.push(mr),++We}return X=Pe(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,We),X.write_shift(2,We),X.write_shift(4,Et),X.write_shift(4,Ce),X.write_shift(2,0),sn([sn(q),sn(H),X])}var zt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ge(C,M){if(C.ctype)return C.ctype;var W=C.name||"",q=W.match(/\.([^\.]+)$/);return q&&zt[q[1]]||M&&(q=(W=M).match(/[\.\\]([^\.\\])+$/),q&&zt[q[1]])?zt[q[1]]:"application/octet-stream"}function he(C){for(var M=rc(C),W=[],q=0;q<M.length;q+=76)W.push(M.slice(q,q+76));return W.join(`\r
`)+`\r
`}function Re(C){var M=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ke){var Ce=ke.charCodeAt(0).toString(16).toUpperCase();return"="+(Ce.length==1?"0"+Ce:Ce)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var W=[],q=M.split(`\r
`),H=0;H<q.length;++H){var X=q[H];if(X.length==0){W.push("");continue}for(var Se=0;Se<X.length;){var De=76,je=X.slice(Se,Se+De);je.charAt(De-1)=="="?De--:je.charAt(De-2)=="="?De-=2:je.charAt(De-3)=="="&&(De-=3),je=X.slice(Se,Se+De),Se+=De,Se<X.length&&(je+="="),W.push(je)}}return W.join(`\r
`)}function pe(C){for(var M=[],W=0;W<C.length;++W){for(var q=C[W];W<=C.length&&q.charAt(q.length-1)=="=";)q=q.slice(0,q.length-1)+C[++W];M.push(q)}for(var H=0;H<M.length;++H)M[H]=M[H].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return As(M.join(`\r
`))}function _e(C,M,W){for(var q="",H="",X="",Se,De=0;De<10;++De){var je=M[De];if(!je||je.match(/^\s*$/))break;var ke=je.match(/^(.*?):\s*([^\s].*)$/);if(ke)switch(ke[1].toLowerCase()){case"content-location":q=ke[2].trim();break;case"content-type":X=ke[2].trim();break;case"content-transfer-encoding":H=ke[2].trim();break}}switch(++De,H.toLowerCase()){case"base64":Se=As(ja(M.slice(De).join("")));break;case"quoted-printable":Se=pe(M.slice(De));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var Ce=E(C,q.slice(W.length),Se,{unsafe:!0});X&&(Ce.ctype=X)}function at(C,M){if(de(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var W=M&&M.root||"",q=(Xt&&Buffer.isBuffer(C)?C.toString("binary"):de(C)).split(`\r
`),H=0,X="";for(H=0;H<q.length;++H)if(X=q[H],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),W||(W=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,W.length)!=W))for(;W.length>0&&(W=W.slice(0,W.length-1),W=W.slice(0,W.lastIndexOf("/")+1),X.slice(0,W.length)!=W););var Se=(q[1]||"").match(/boundary="(.*?)"/);if(!Se)throw new Error("MAD cannot find boundary");var De="--"+(Se[1]||""),je=[],ke=[],Ce={FileIndex:je,FullPaths:ke};Q(Ce);var We,Xe=0;for(H=0;H<q.length;++H){var nt=q[H];nt!==De&&nt!==De+"--"||(Xe++&&_e(Ce,q.slice(We,H),W),We=H)}return Ce}function d(C,M){var W=M||{},q=W.boundary||"SheetJS";q="------="+q;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+q.slice(2)+'"',"","",""],X=C.FullPaths[0],Se=X,De=C.FileIndex[0],je=1;je<C.FullPaths.length;++je)if(Se=C.FullPaths[je].slice(X.length),De=C.FileIndex[je],!(!De.size||!De.content||Se=="Sh33tJ5")){Se=Se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Et){return"_x"+Et.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Et){return"_u"+Et.charCodeAt(0).toString(16)+"_"});for(var ke=De.content,Ce=Xt&&Buffer.isBuffer(ke)?ke.toString("binary"):de(ke),We=0,Xe=Math.min(1024,Ce.length),nt=0,Qe=0;Qe<=Xe;++Qe)(nt=Ce.charCodeAt(Qe))>=32&&nt<128&&++We;var Ve=We>=Xe*4/5;H.push(q),H.push("Content-Location: "+(W.root||"file:///C:/SheetJS/")+Se),H.push("Content-Transfer-Encoding: "+(Ve?"quoted-printable":"base64")),H.push("Content-Type: "+ge(De,Se)),H.push(""),H.push(Ve?Re(Ce):he(Ce))}return H.push(q+`--\r
`),H.join(`\r
`)}function A(C){var M={};return Q(M,C),M}function E(C,M,W,q){var H=q&&q.unsafe;H||Q(C);var X=!H&&dr.find(C,M);if(!X){var Se=C.FullPaths[0];M.slice(0,Se.length)==Se?Se=M:(Se.slice(-1)!="/"&&(Se+="/"),Se=(Se+M).replace("//","/")),X={name:a(M),type:2},C.FileIndex.push(X),C.FullPaths.push(Se),H||dr.utils.cfb_gc(C)}return X.content=W,X.size=W?W.length:0,q&&(q.CLSID&&(X.clsid=q.CLSID),q.mt&&(X.mt=q.mt),q.ct&&(X.ct=q.ct)),X}function S(C,M){Q(C);var W=dr.find(C,M);if(W){for(var q=0;q<C.FileIndex.length;++q)if(C.FileIndex[q]==W)return C.FileIndex.splice(q,1),C.FullPaths.splice(q,1),!0}return!1}function P(C,M,W){Q(C);var q=dr.find(C,M);if(q){for(var H=0;H<C.FileIndex.length;++H)if(C.FileIndex[H]==q)return C.FileIndex[H].name=a(W),C.FullPaths[H]=W,!0}return!1}function se(C){J(C,!0)}return r.find=fe,r.read=B,r.parse=x,r.write=Ne,r.writeFile=V,r.utils={cfb_new:A,cfb_add:E,cfb_del:S,cfb_mov:P,cfb_gc:se,ReadShift:Vl,CheckField:fb,prep_blob:rs,bconcat:sn,use_zlib:U,_deflateRaw:Ue,_inflateRaw:Bt,consts:oe},r})();function OL(e){return typeof e=="string"?f0(e):Array.isArray(e)?nL(e):e}function Ac(e,r,t){if(typeof Deno<"u"){if(t&&typeof r=="string")switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=f0(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var s=t=="utf8"?sc(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,e);if(typeof Blob<"u"){var a=new Blob([OL(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=e,c.href=o,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(r)&&(r=Ec(r)),u.write(r),u.close(),r}catch(p){if(!p.message||!p.message.match(/onstruct/))throw p}throw new Error("cannot save file "+e)}function ln(e){for(var r=Object.keys(e),t=[],s=0;s<r.length;++s)Object.prototype.hasOwnProperty.call(e,r[s])&&t.push(r[s]);return t}function $v(e,r){for(var t=[],s=ln(e),a=0;a!==s.length;++a)t[e[s[a]][r]]==null&&(t[e[s[a]][r]]=s[a]);return t}function vm(e){for(var r=[],t=ln(e),s=0;s!==t.length;++s)r[e[t[s]]]=t[s];return r}function m0(e){for(var r=[],t=ln(e),s=0;s!==t.length;++s)r[e[t[s]]]=parseInt(t[s],10);return r}function PL(e){for(var r=[],t=ln(e),s=0;s!==t.length;++s)r[e[t[s]]]==null&&(r[e[t[s]]]=[]),r[e[t[s]]].push(t[s]);return r}var Tu=new Date(1899,11,30,0,0,0);function Un(e,r){var t=e.getTime(),s=Tu.getTime()+(e.getTimezoneOffset()-Tu.getTimezoneOffset())*6e4;return(t-s)/(1440*60*1e3)}var YS=new Date,RL=Tu.getTime()+(YS.getTimezoneOffset()-Tu.getTimezoneOffset())*6e4,Uv=YS.getTimezoneOffset();function KS(e){var r=new Date;return r.setTime(e*24*60*60*1e3+RL),r.getTimezoneOffset()!==Uv&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Uv)*6e4),r}var zv=new Date("2017-02-19T19:06:09.000Z"),XS=isNaN(zv.getFullYear())?new Date("2/19/17"):zv,DL=XS.getFullYear()==2017;function kn(e,r){var t=new Date(e);if(DL)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(XS.getFullYear()==1917&&!isNaN(t.getFullYear())){var s=t.getFullYear();return e.indexOf(""+s)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function x0(e,r){if(Xt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return t[o]||o})}catch{}for(var s=[],a=0;a!=e.length;++a)s.push(String.fromCharCode(e[a]));return s.join("")}function zn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=zn(e[t]));return r}function Tr(e,r){for(var t="";t.length<r;)t+=e;return t}function va(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,s=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(s))||(s=s.replace(/[(](.*)[)]/,function(a,o){return t=-t,o}),!isNaN(r=Number(s)))?r/t:r}var FL=["january","february","march","april","may","june","july","august","september","october","november","december"];function nc(e){var r=new Date(e),t=new Date(NaN),s=r.getYear(),a=r.getMonth(),o=r.getDate();if(isNaN(o))return t;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&FL.indexOf(c)==-1)return t}else if(c.match(/[a-z]/))return t;return s<0||s>8099?t:(a>0||o>1)&&s!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}function Tt(e,r,t){if(e.FullPaths){if(typeof t=="string"){var s;return Xt?s=Ca(t):s=sL(t),dr.utils.cfb_add(e,r,s)}dr.utils.cfb_add(e,r,t)}else e.file(r,t)}function wm(){return dr.utils.cfb_new()}var Br=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ML={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Nm=vm(ML),Sm=/[&<>'"]/g,LL=/[\u0000-\u0008\u000b-\u001f]/g;function ar(e){var r=e+"";return r.replace(Sm,function(t){return Nm[t]}).replace(LL,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Wv(e){return ar(e).replace(/ /g,"_x0020_")}var JS=/[\u0000-\u001f]/g;function IL(e){var r=e+"";return r.replace(Sm,function(t){return Nm[t]}).replace(/\n/g,"<br/>").replace(JS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function BL(e){var r=e+"";return r.replace(Sm,function(t){return Nm[t]}).replace(JS,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function $L(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function UL(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ph(e){for(var r="",t=0,s=0,a=0,o=0,c=0,u=0;t<e.length;){if(s=e.charCodeAt(t++),s<128){r+=String.fromCharCode(s);continue}if(a=e.charCodeAt(t++),s>191&&s<224){c=(s&31)<<6,c|=a&63,r+=String.fromCharCode(c);continue}if(o=e.charCodeAt(t++),s<240){r+=String.fromCharCode((s&15)<<12|(a&63)<<6|o&63);continue}c=e.charCodeAt(t++),u=((s&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536,r+=String.fromCharCode(55296+(u>>>10&1023)),r+=String.fromCharCode(56320+(u&1023))}return r}function qv(e){var r=Ii(2*e.length),t,s,a=1,o=0,c=0,u;for(s=0;s<e.length;s+=a)a=1,(u=e.charCodeAt(s))<128?t=u:u<224?(t=(u&31)*64+(e.charCodeAt(s+1)&63),a=2):u<240?(t=(u&15)*4096+(e.charCodeAt(s+1)&63)*64+(e.charCodeAt(s+2)&63),a=3):(a=4,t=(u&7)*262144+(e.charCodeAt(s+1)&63)*4096+(e.charCodeAt(s+2)&63)*64+(e.charCodeAt(s+3)&63),t-=65536,c=55296+(t>>>10&1023),t=56320+(t&1023)),c!==0&&(r[o++]=c&255,r[o++]=c>>>8,c=0),r[o++]=t%256,r[o++]=t>>>8;return r.slice(0,o).toString("ucs2")}function Vv(e){return Ca(e,"binary").toString("utf8")}var Xd="foo bar baz",ql=Xt&&(Vv(Xd)==Ph(Xd)&&Vv||qv(Xd)==Ph(Xd)&&qv)||Ph,sc=Xt?function(e){return Ca(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,s=0,a=0;t<e.length;)switch(s=e.charCodeAt(t++),!0){case s<128:r.push(String.fromCharCode(s));break;case s<2048:r.push(String.fromCharCode(192+(s>>6))),r.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,a=e.charCodeAt(t++)-56320+(s<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(s>>12))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)))}return r.join("")},zL=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var s=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)s=s.replace(e[a][0],e[a][1]);return s}})(),ZS=/(^\s|\s$|\n)/;function an(e,r){return"<"+e+(r.match(ZS)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function ac(e){return ln(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Ye(e,r,t){return"<"+e+(t!=null?ac(t):"")+(r!=null?(r.match(ZS)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function fp(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function WL(e,r){switch(typeof e){case"string":var t=Ye("vt:lpwstr",ar(e));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ye((e|0)==e?"vt:i4":"vt:r8",ar(String(e)));case"boolean":return Ye("vt:bool",e?"true":"false")}if(e instanceof Date)return Ye("vt:filetime",fp(e));throw new Error("Unable to serialize "+e)}var Kr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Yo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ss={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function qL(e,r){for(var t=1-2*(e[r+7]>>>7),s=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,o=5;o>=0;--o)a=a*256+e[r+o];return s==2047?a==0?t*(1/0):NaN:(s==0?s=-1022:(s-=1023,a+=Math.pow(2,52)),t*Math.pow(2,s-52)*a)}function VL(e,r,t){var s=(r<0||1/r==-1/0?1:0)<<7,a=0,o=0,c=s?-r:r;isFinite(c)?c==0?a=o=0:(a=Math.floor(Math.log(c)/Math.LN2),o=c*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(r)?26985:0);for(var u=0;u<=5;++u,o/=256)e[t+u]=o&255;e[t+6]=(a&15)<<4|o&15,e[t+7]=a>>4|s}var Qv=function(e){for(var r=[],t=10240,s=0;s<e[0].length;++s)if(e[0][s])for(var a=0,o=e[0][s].length;a<o;a+=t)r.push.apply(r,e[0][s].slice(a,a+t));return r},Hv=Xt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Ca(r)})):Qv(e)}:Qv,Gv=function(e,r,t){for(var s=[],a=r;a<t;a+=2)s.push(String.fromCharCode(zl(e,a)));return s.join("").replace(Wl,"")},bm=Xt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Wl,""):Gv(e,r,t)}:Gv,Yv=function(e,r,t){for(var s=[],a=r;a<r+t;++a)s.push(("0"+e[a].toString(16)).slice(-2));return s.join("")},eb=Xt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Yv(e,r,t)}:Yv,Kv=function(e,r,t){for(var s=[],a=r;a<t;a++)s.push(String.fromCharCode(ko(e,a)));return s.join("")},Tc=Xt?function(r,t,s){return Buffer.isBuffer(r)?r.toString("utf8",t,s):Kv(r,t,s)}:Kv,tb=function(e,r){var t=as(e,r);return t>0?Tc(e,r+4,r+4+t-1):""},rb=tb,nb=function(e,r){var t=as(e,r);return t>0?Tc(e,r+4,r+4+t-1):""},sb=nb,ab=function(e,r){var t=2*as(e,r);return t>0?Tc(e,r+4,r+4+t-1):""},ib=ab,ob=function(r,t){var s=as(r,t);return s>0?bm(r,t+4,t+4+s):""},lb=ob,cb=function(e,r){var t=as(e,r);return t>0?Tc(e,r+4,r+4+t):""},db=cb,ub=function(e,r){return qL(e,r)},Ou=ub,jm=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Xt&&(rb=function(r,t){if(!Buffer.isBuffer(r))return tb(r,t);var s=r.readUInt32LE(t);return s>0?r.toString("utf8",t+4,t+4+s-1):""},sb=function(r,t){if(!Buffer.isBuffer(r))return nb(r,t);var s=r.readUInt32LE(t);return s>0?r.toString("utf8",t+4,t+4+s-1):""},ib=function(r,t){if(!Buffer.isBuffer(r))return ab(r,t);var s=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+s-1)},lb=function(r,t){if(!Buffer.isBuffer(r))return ob(r,t);var s=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+s)},db=function(r,t){if(!Buffer.isBuffer(r))return cb(r,t);var s=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+s)},Ou=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):ub(r,t)},jm=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var ko=function(e,r){return e[r]},zl=function(e,r){return e[r+1]*256+e[r]},QL=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},as=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Ci=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},HL=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Vl(e,r){var t="",s,a,o=[],c,u,p,h;switch(r){case"dbcs":if(h=this.l,Xt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(p=0;p<e;++p)t+=String.fromCharCode(zl(this,h)),h+=2;e*=2;break;case"utf8":t=Tc(this,this.l,this.l+e);break;case"utf16le":e*=2,t=bm(this,this.l,this.l+e);break;case"wstr":return Vl.call(this,e,"dbcs");case"lpstr-ansi":t=rb(this,this.l),e=4+as(this,this.l);break;case"lpstr-cp":t=sb(this,this.l),e=4+as(this,this.l);break;case"lpwstr":t=ib(this,this.l),e=4+2*as(this,this.l);break;case"lpp4":e=4+as(this,this.l),t=lb(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+as(this,this.l),t=db(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(c=ko(this,this.l+e++))!==0;)o.push(Gd(c));t=o.join("");break;case"_wstr":for(e=0,t="";(c=zl(this,this.l+e))!==0;)o.push(Gd(c)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",h=this.l,p=0;p<e;++p){if(this.lens&&this.lens.indexOf(h)!==-1)return c=ko(this,h),this.l=h+1,u=Vl.call(this,e-p,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Gd(zl(this,h))),h+=2}t=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,p=0;p!=e;++p){if(this.lens&&this.lens.indexOf(h)!==-1)return c=ko(this,h),this.l=h+1,u=Vl.call(this,e-p,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Gd(ko(this,h))),h+=1}t=o.join("");break;default:switch(e){case 1:return s=ko(this,this.l),this.l++,s;case 2:return s=(r==="i"?QL:zl)(this,this.l),this.l+=2,s;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(s=(e>0?Ci:HL)(this,this.l),this.l+=4,s):(a=as(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=Ou(this,this.l):a=Ou([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=eb(this,this.l,e);break}}return this.l+=e,t}var GL=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},YL=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},KL=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function XL(e,r,t){var s=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)KL(this,r.charCodeAt(a),this.l+2*a);s=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;s=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var c=r.charCodeAt(a);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:s=1,this[this.l]=r&255;break;case 2:s=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:s=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:s=4,GL(this,r,this.l);break;case 8:if(s=8,t==="f"){VL(this,r,this.l);break}case 16:break;case-4:s=4,YL(this,r,this.l);break}return this.l+=s,this}function fb(e,r){var t=eb(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function rs(e,r){e.l=r,e.read_shift=Vl,e.chk=fb,e.write_shift=XL}function na(e,r){e.l+=r}function Pe(e){var r=Ii(e);return rs(r,0),r}function $n(){var e=[],r=Xt?256:2048,t=function(h){var x=Pe(h);return rs(x,0),x},s=t(r),a=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&e.push(s),s=null)},o=function(h){return s&&h<s.length-s.l?s:(a(),s=t(Math.max(h+1,r)))},c=function(){return a(),sn(e)},u=function(h){a(),s=h,s.l==null&&(s.l=s.length),o(r)};return{next:o,push:u,end:c,_bufs:e}}function Ie(e,r,t,s){var a=+r,o;if(!isNaN(a)){s||(s=qB[a].p||(t||[]).length||0),o=1+(a>=128?1:0)+1,s>=128&&++o,s>=16384&&++o,s>=2097152&&++o;var c=e.next(o);a<=127?c.write_shift(1,a):(c.write_shift(1,(a&127)+128),c.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(s>=128)c.write_shift(1,(s&127)+128),s>>=7;else{c.write_shift(1,s);break}s>0&&jm(t)&&e.push(t)}}function Ql(e,r,t){var s=zn(e);if(r.s?(s.cRel&&(s.c+=r.s.c),s.rRel&&(s.r+=r.s.r)):(s.cRel&&(s.c+=r.c),s.rRel&&(s.r+=r.r)),!t||t.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Xv(e,r,t){var s=zn(e);return s.s=Ql(s.s,r.s,t),s.e=Ql(s.e,r.s,t),s}function Hl(e,r){if(e.cRel&&e.c<0)for(e=zn(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=zn(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=ir(e);return!e.cRel&&e.cRel!=null&&(t=e9(t)),!e.rRel&&e.rRel!=null&&(t=JL(t)),t}function Rh(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+yn(e.s.c)+":"+(e.e.cRel?"":"$")+yn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+on(e.s.r)+":"+(e.e.rRel?"":"$")+on(e.e.r):Hl(e.s,r.biff)+":"+Hl(e.e,r.biff)}function km(e){return parseInt(ZL(e),10)-1}function on(e){return""+(e+1)}function JL(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function ZL(e){return e.replace(/\$(\d+)$/,"$1")}function _m(e){for(var r=t9(e),t=0,s=0;s!==r.length;++s)t=26*t+r.charCodeAt(s)-64;return t-1}function yn(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function e9(e){return e.replace(/^([A-Z])/,"$$$1")}function t9(e){return e.replace(/^\$([A-Z])/,"$1")}function r9(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Xr(e){for(var r=0,t=0,s=0;s<e.length;++s){var a=e.charCodeAt(s);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function ir(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function ls(e){var r=e.indexOf(":");return r==-1?{s:Xr(e),e:Xr(e)}:{s:Xr(e.slice(0,r)),e:Xr(e.slice(r+1))}}function Ir(e,r){return typeof r>"u"||typeof r=="number"?Ir(e.s,e.e):(typeof e!="string"&&(e=ir(e)),typeof r!="string"&&(r=ir(r)),e==r?e:e+":"+r)}function wr(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,s=0,a=0,o=e.length;for(t=0;s<o&&!((a=e.charCodeAt(s)-64)<1||a>26);++s)t=26*t+a;for(r.s.c=--t,t=0;s<o&&!((a=e.charCodeAt(s)-48)<0||a>9);++s)t=10*t+a;if(r.s.r=--t,s===o||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++s,t=0;s!=o&&!((a=e.charCodeAt(s)-64)<1||a>26);++s)t=26*t+a;for(r.e.c=--t,t=0;s!=o&&!((a=e.charCodeAt(s)-48)<0||a>9);++s)t=10*t+a;return r.e.r=--t,r}function Jv(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=si(e.z,t?Un(r):r)}catch{}try{return e.w=si((e.XF||{}).numFmtId||(t?14:0),t?Un(r):r)}catch{return""+r}}function ka(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Oc[e.v]||e.v:r==null?Jv(e,e.v):Jv(e,r))}function Wi(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",s={};return s[t]=e,{SheetNames:[t],Sheets:s}}function hb(e,r,t){var s=t||{},a=e?Array.isArray(e):s.dense,o=e||(a?[]:{}),c=0,u=0;if(o&&s.origin!=null){if(typeof s.origin=="number")c=s.origin;else{var p=typeof s.origin=="string"?Xr(s.origin):s.origin;c=p.r,u=p.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var x=wr(o["!ref"]);h.s.c=x.s.c,h.s.r=x.s.r,h.e.c=Math.max(h.e.c,x.e.c),h.e.r=Math.max(h.e.r,x.e.r),c==-1&&(h.e.r=c=x.e.r+1)}for(var y=0;y!=r.length;++y)if(r[y]){if(!Array.isArray(r[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=r[y].length;++v)if(!(typeof r[y][v]>"u")){var k={v:r[y][v]},b=c+y,w=u+v;if(h.s.r>b&&(h.s.r=b),h.s.c>w&&(h.s.c=w),h.e.r<b&&(h.e.r=b),h.e.c<w&&(h.e.c=w),r[y][v]&&typeof r[y][v]=="object"&&!Array.isArray(r[y][v])&&!(r[y][v]instanceof Date))k=r[y][v];else if(Array.isArray(k.v)&&(k.f=r[y][v][1],k.v=k.v[0]),k.v===null)if(k.f)k.t="n";else if(s.nullError)k.t="e",k.v=0;else if(s.sheetStubs)k.t="z";else continue;else typeof k.v=="number"?k.t="n":typeof k.v=="boolean"?k.t="b":k.v instanceof Date?(k.z=s.dateNF||Or[14],s.cellDates?(k.t="d",k.w=si(k.z,Un(k.v))):(k.t="n",k.v=Un(k.v),k.w=si(k.z,k.v))):k.t="s";if(a)o[b]||(o[b]=[]),o[b][w]&&o[b][w].z&&(k.z=o[b][w].z),o[b][w]=k;else{var j=ir({c:w,r:b});o[j]&&o[j].z&&(k.z=o[j].z),o[j]=k}}}return h.s.c<1e7&&(o["!ref"]=Ir(h)),o}function Ko(e,r){return hb(null,e,r)}function n9(e){return e.read_shift(4,"i")}function Os(e,r){return r||(r=Pe(4)),r.write_shift(4,e),r}function vn(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function Jr(e,r){var t=!1;return r==null&&(t=!0,r=Pe(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function s9(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function a9(e,r){return r||(r=Pe(4)),r.write_shift(2,0),r.write_shift(2,0),r}function Cm(e,r){var t=e.l,s=e.read_shift(1),a=vn(e),o=[],c={t:a,h:a};if((s&1)!==0){for(var u=e.read_shift(4),p=0;p!=u;++p)o.push(s9(e));c.r=o}else c.r=[{ich:0,ifnt:0}];return e.l=t+r,c}function i9(e,r){var t=!1;return r==null&&(t=!0,r=Pe(15+4*e.t.length)),r.write_shift(1,0),Jr(e.t,r),t?r.slice(0,r.l):r}var o9=Cm;function l9(e,r){var t=!1;return r==null&&(t=!0,r=Pe(23+4*e.t.length)),r.write_shift(1,1),Jr(e.t,r),r.write_shift(4,1),a9({},r),t?r.slice(0,r.l):r}function ys(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function qi(e,r){return r==null&&(r=Pe(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Vi(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Qi(e,r){return r==null&&(r=Pe(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var c9=vn,pb=Jr;function Em(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}function Pu(e,r){var t=!1;return r==null&&(t=!0,r=Pe(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var d9=vn,hp=Em,Am=Pu;function mb(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,s=r[0]&2;e.l+=4;var a=s===0?Ou([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Ci(r,0)>>2;return t?a/100:a}function xb(e,r){r==null&&(r=Pe(4));var t=0,s=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?s=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(s=1,t=1),s)r.write_shift(-4,((t?a:e)<<2)+(t+2));else throw new Error("unsupported RkNumber "+e)}function gb(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}function u9(e,r){return r||(r=Pe(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r}var Hi=gb,Xo=u9;function Jo(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Bi(e,r){return(r||Pe(8)).write_shift(8,e,"f")}function f9(e){var r={},t=e.read_shift(1),s=t>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),c=e.read_shift(1),u=e.read_shift(1),p=e.read_shift(1);switch(e.l++,s){case 0:r.auto=1;break;case 1:r.index=a;var h=N9[a];h&&(r.rgb=c1(h));break;case 2:r.rgb=c1([c,u,p]);break;case 3:r.theme=a;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function Ru(e,r){if(r||(r=Pe(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;e.index!=null?(r.write_shift(1,2),r.write_shift(1,e.index)):e.theme!=null?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),!e.rgb||e.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var s=e.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),r.write_shift(1,parseInt(s.slice(0,2),16)),r.write_shift(1,parseInt(s.slice(2,4),16)),r.write_shift(1,parseInt(s.slice(4,6),16)),r.write_shift(1,255)}return r}function h9(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function p9(e,r){r||(r=Pe(2));var t=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return r.write_shift(1,t),r.write_shift(1,0),r}var yb=2,ts=3,Jd=11,Du=19,Zd=64,m9=65,x9=71,g9=4108,y9=4126,nn=80,Zv={1:{n:"CodePage",t:yb},2:{n:"Category",t:nn},3:{n:"PresentationFormat",t:nn},4:{n:"ByteCount",t:ts},5:{n:"LineCount",t:ts},6:{n:"ParagraphCount",t:ts},7:{n:"SlideCount",t:ts},8:{n:"NoteCount",t:ts},9:{n:"HiddenCount",t:ts},10:{n:"MultimediaClipCount",t:ts},11:{n:"ScaleCrop",t:Jd},12:{n:"HeadingPairs",t:g9},13:{n:"TitlesOfParts",t:y9},14:{n:"Manager",t:nn},15:{n:"Company",t:nn},16:{n:"LinksUpToDate",t:Jd},17:{n:"CharacterCount",t:ts},19:{n:"SharedDoc",t:Jd},22:{n:"HyperlinksChanged",t:Jd},23:{n:"AppVersion",t:ts,p:"version"},24:{n:"DigSig",t:m9},26:{n:"ContentType",t:nn},27:{n:"ContentStatus",t:nn},28:{n:"Language",t:nn},29:{n:"Version",t:nn},255:{},2147483648:{n:"Locale",t:Du},2147483651:{n:"Behavior",t:Du},1919054434:{}},e1={1:{n:"CodePage",t:yb},2:{n:"Title",t:nn},3:{n:"Subject",t:nn},4:{n:"Author",t:nn},5:{n:"Keywords",t:nn},6:{n:"Comments",t:nn},7:{n:"Template",t:nn},8:{n:"LastAuthor",t:nn},9:{n:"RevNumber",t:nn},10:{n:"EditTime",t:Zd},11:{n:"LastPrinted",t:Zd},12:{n:"CreatedDate",t:Zd},13:{n:"ModifiedDate",t:Zd},14:{n:"PageCount",t:ts},15:{n:"WordCount",t:ts},16:{n:"CharCount",t:ts},17:{n:"Thumbnail",t:x9},18:{n:"Application",t:nn},19:{n:"DocSecurity",t:ts},255:{},2147483648:{n:"Locale",t:Du},2147483651:{n:"Behavior",t:Du},1919054434:{}};function v9(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var w9=v9([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),N9=zn(w9),Oc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},S9={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},eu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function vb(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function wb(e,r){var t=PL(S9),s=[],a;s[s.length]=Br,s[s.length]=Ye("Types",null,{xmlns:Kr.CT,"xmlns:xsd":Kr.xsd,"xmlns:xsi":Kr.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(p){return Ye("Default",null,{Extension:p[0],ContentType:p[1]})}));var o=function(p){e[p]&&e[p].length>0&&(a=e[p][0],s[s.length]=Ye("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:eu[p][r.bookType]||eu[p].xlsx}))},c=function(p){(e[p]||[]).forEach(function(h){s[s.length]=Ye("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:eu[p][r.bookType]||eu[p].xlsx})})},u=function(p){(e[p]||[]).forEach(function(h){s[s.length]=Ye("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:t[p][0]})})};return o("workbooks"),c("sheets"),c("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),c("metadata"),u("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var Kt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Nb(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function To(e){var r=[Br,Ye("Relationships",null,{xmlns:Kr.RELS})];return ln(e["!id"]).forEach(function(t){r[r.length]=Ye("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function nr(e,r,t,s,a,o){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,a.Id="rId"+r,a.Type=s,a.Target=t,[Kt.HLINK,Kt.XPATH,Kt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,r}function b9(e){var r=[Br];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function t1(e,r,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function j9(e,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function k9(e){var r=[Br];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=e.length;++t)r.push(t1(e[t][0],e[t][1])),r.push(j9("",e[t][0]));return r.push(t1("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function Sb(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ku.version+"</meta:generator></office:meta></office:document-meta>"}var Ti=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Dh(e,r,t,s,a){a[e]!=null||r==null||r===""||(a[e]=r,r=ar(r),s[s.length]=t?Ye(e,r,t):an(e,r))}function bb(e,r){var t=r||{},s=[Br,Ye("cp:coreProperties",null,{"xmlns:cp":Kr.CORE_PROPS,"xmlns:dc":Kr.dc,"xmlns:dcterms":Kr.dcterms,"xmlns:dcmitype":Kr.dcmitype,"xmlns:xsi":Kr.xsi})],a={};if(!e&&!t.Props)return s.join("");e&&(e.CreatedDate!=null&&Dh("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:fp(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,a),e.ModifiedDate!=null&&Dh("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:fp(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},s,a));for(var o=0;o!=Ti.length;++o){var c=Ti[o],u=t.Props&&t.Props[c[1]]!=null?t.Props[c[1]]:e?e[c[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Dh(c[0],u,null,s,a)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Oo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],jb=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function kb(e){var r=[],t=Ye;return e||(e={}),e.Application="SheetJS",r[r.length]=Br,r[r.length]=Ye("Properties",null,{xmlns:Kr.EXT_PROPS,"xmlns:vt":Kr.vt}),Oo.forEach(function(s){if(e[s[1]]!==void 0){var a;switch(s[2]){case"string":a=ar(String(e[s[1]]));break;case"bool":a=e[s[1]]?"true":"false";break}a!==void 0&&(r[r.length]=t(s[0],a))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(s){return"<vt:lpstr>"+ar(s)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function _b(e){var r=[Br,Ye("Properties",null,{xmlns:Kr.CUST_PROPS,"xmlns:vt":Kr.vt})];if(!e)return r.join("");var t=1;return ln(e).forEach(function(a){++t,r[r.length]=Ye("property",WL(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:ar(a)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var r1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function _9(e,r){var t=[];return ln(r1).map(function(s){for(var a=0;a<Ti.length;++a)if(Ti[a][1]==s)return Ti[a];for(a=0;a<Oo.length;++a)if(Oo[a][1]==s)return Oo[a];throw s}).forEach(function(s){if(e[s[1]]!=null){var a=r&&r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e[s[1]];switch(s[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),t.push(an(r1[s[1]]||s[1],a))}}),Ye("DocumentProperties",t.join(""),{xmlns:ss.o})}function C9(e,r){var t=["Worksheets","SheetNames"],s="CustomDocumentProperties",a=[];return e&&ln(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var c=0;c<Ti.length;++c)if(o==Ti[c][1])return;for(c=0;c<Oo.length;++c)if(o==Oo[c][1])return;for(c=0;c<t.length;++c)if(o==t[c])return;var u=e[o],p="string";typeof u=="number"?(p="float",u=String(u)):u===!0||u===!1?(p="boolean",u=u?"1":"0"):u=String(u),a.push(Ye(Wv(o),u,{"dt:dt":p}))}}),r&&ln(r).forEach(function(o){if(Object.prototype.hasOwnProperty.call(r,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var c=r[o],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c instanceof Date?(u="dateTime.tz",c=c.toISOString()):c=String(c),a.push(Ye(Wv(o),c,{"dt:dt":u}))}}),"<"+s+' xmlns="'+ss.o+'">'+a.join("")+"</"+s+">"}function E9(e){var r=typeof e=="string"?new Date(Date.parse(e)):e,t=r.getTime()/1e3+11644473600,s=t%Math.pow(2,32),a=(t-s)/Math.pow(2,32);s*=1e7,a*=1e7;var o=s/Math.pow(2,32)|0;o>0&&(s=s%Math.pow(2,32),a+=o);var c=Pe(8);return c.write_shift(4,s),c.write_shift(4,a),c}function n1(e,r){var t=Pe(4),s=Pe(4);switch(t.write_shift(4,e==80?31:e),e){case 3:s.write_shift(-4,r);break;case 5:s=Pe(8),s.write_shift(8,r,"f");break;case 11:s.write_shift(4,r?1:0);break;case 64:s=E9(r);break;case 31:case 80:for(s=Pe(4+2*(r.length+1)+(r.length%2?0:2)),s.write_shift(4,r.length+1),s.write_shift(0,r,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return sn([t,s])}var Cb=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function A9(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function s1(e,r,t){var s=Pe(8),a=[],o=[],c=8,u=0,p=Pe(8),h=Pe(8);if(p.write_shift(4,2),p.write_shift(4,1200),h.write_shift(4,1),o.push(p),a.push(h),c+=8+p.length,!r){h=Pe(8),h.write_shift(4,0),a.unshift(h);var x=[Pe(4)];for(x[0].write_shift(4,e.length),u=0;u<e.length;++u){var y=e[u][0];for(p=Pe(8+2*(y.length+1)+(y.length%2?0:2)),p.write_shift(4,u+2),p.write_shift(4,y.length+1),p.write_shift(0,y,"dbcs");p.l!=p.length;)p.write_shift(1,0);x.push(p)}p=sn(x),o.unshift(p),c+=8+p.length}for(u=0;u<e.length;++u)if(!(r&&!r[e[u][0]])&&!(Cb.indexOf(e[u][0])>-1||jb.indexOf(e[u][0])>-1)&&e[u][1]!=null){var v=e[u][1],k=0;if(r){k=+r[e[u][0]];var b=t[k];if(b.p=="version"&&typeof v=="string"){var w=v.split(".");v=(+w[0]<<16)+(+w[1]||0)}p=n1(b.t,v)}else{var j=A9(v);j==-1&&(j=31,v=String(v)),p=n1(j,v)}o.push(p),h=Pe(8),h.write_shift(4,r?k:2+u),a.push(h),c+=8+p.length}var O=8*(o.length+1);for(u=0;u<o.length;++u)a[u].write_shift(4,O),O+=o[u].length;return s.write_shift(4,c),s.write_shift(4,o.length),sn([s].concat(a).concat(o))}function a1(e,r,t,s,a,o){var c=Pe(a?68:48),u=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,dr.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,a?2:1),c.write_shift(16,r,"hex"),c.write_shift(4,a?68:48);var p=s1(e,t,s);if(u.push(p),a){var h=s1(a,null,null);c.write_shift(16,o,"hex"),c.write_shift(4,68+p.length),u.push(h)}return sn(u)}function T9(e,r){r||(r=Pe(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}function O9(e,r){return e.read_shift(r)===1}function jn(e,r){return r||(r=Pe(2)),r.write_shift(2,+!!e),r}function Eb(e){return e.read_shift(2,"u")}function xs(e,r){return r||(r=Pe(2)),r.write_shift(2,e),r}function Ab(e,r,t){return t||(t=Pe(2)),t.write_shift(1,r=="e"?+e:+!!e),t.write_shift(1,r=="e"?1:0),t}function Tb(e,r,t){var s=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var c=s?e.read_shift(s,a):"";return c}function P9(e){var r=e.t||"",t=Pe(3);t.write_shift(2,r.length),t.write_shift(1,1);var s=Pe(2*r.length);s.write_shift(2*r.length,r,"utf16le");var a=[t,s];return sn(a)}function R9(e,r,t){var s;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?s=e.read_shift(r,"sbcs-cont"):s=e.read_shift(r,"dbcs-cont"),s}function D9(e,r,t){var s=e.read_shift(t&&t.biff==2?1:2);return s===0?(e.l++,""):R9(e,s,t)}function F9(e,r,t){if(t.biff>5)return D9(e,r,t);var s=e.read_shift(1);return s===0?(e.l++,""):e.read_shift(s,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ob(e,r,t){return t||(t=Pe(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function i1(e,r){r||(r=Pe(6+e.length*2)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function M9(e){var r=Pe(512),t=0,s=e.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var a=s.indexOf("#"),o=a>-1?31:23;switch(s.charAt(0)){case"#":o=28;break;case".":o&=-3;break}r.write_shift(4,2),r.write_shift(4,o);var c=[8,6815827,6619237,4849780,83];for(t=0;t<c.length;++t)r.write_shift(4,c[t]);if(o==28)s=s.slice(1),i1(s,r);else if(o&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<c.length;++t)r.write_shift(1,parseInt(c[t],16));var u=a>-1?s.slice(0,a):s;for(r.write_shift(4,2*(u.length+1)),t=0;t<u.length;++t)r.write_shift(2,u.charCodeAt(t));r.write_shift(2,0),o&8&&i1(a>-1?s.slice(a+1):"",r)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<c.length;++t)r.write_shift(1,parseInt(c[t],16));for(var p=0;s.slice(p*3,p*3+3)=="../"||s.slice(p*3,p*3+3)=="..\\";)++p;for(r.write_shift(2,p),r.write_shift(4,s.length-3*p+1),t=0;t<s.length-3*p;++t)r.write_shift(1,s.charCodeAt(t+3*p)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function $i(e,r,t,s){return s||(s=Pe(6)),s.write_shift(2,e),s.write_shift(2,r),s.write_shift(2,t||0),s}function L9(e,r,t){var s=t.biff>8?4:2,a=e.read_shift(s),o=e.read_shift(s,"i"),c=e.read_shift(s,"i");return[a,o,c]}function I9(e){var r=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);return{s:{c:s,r},e:{c:a,r:t}}}function Pb(e,r){return r||(r=Pe(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function Tm(e,r,t){var s=1536,a=16;switch(t.bookType){case"biff8":break;case"biff5":s=1280,a=8;break;case"biff4":s=4,a=6;break;case"biff3":s=3,a=6;break;case"biff2":s=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=Pe(a);return o.write_shift(2,s),o.write_shift(2,r),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function B9(e,r){var t=!r||r.biff==8,s=Pe(t?112:54);for(s.write_shift(r.biff==8?2:1,7),t&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(t?0:536870912));s.l<s.length;)s.write_shift(1,t?0:32);return s}function $9(e,r){var t=!r||r.biff>=8?2:1,s=Pe(8+t*e.name.length);s.write_shift(4,e.pos),s.write_shift(1,e.hs||0),s.write_shift(1,e.dt),s.write_shift(1,e.name.length),r.biff>=8&&s.write_shift(1,1),s.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var a=s.slice(0,s.l);return a.l=s.l,a}function U9(e,r){var t=Pe(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var s=[],a=0;a<e.length;++a)s[a]=P9(e[a]);var o=sn([t].concat(s));return o.parts=[t.length].concat(s.map(function(c){return c.length})),o}function z9(){var e=Pe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function W9(e){var r=Pe(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function q9(e,r){var t=e.name||"Arial",s=r&&r.biff==5,a=s?15+t.length:16+2*t.length,o=Pe(a);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,t.length),s||o.write_shift(1,1),o.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le"),o}function V9(e,r,t,s){var a=Pe(10);return $i(e,r,s,a),a.write_shift(4,t),a}function Q9(e,r,t,s,a){var o=!a||a.biff==8,c=Pe(8+ +o+(1+o)*t.length);return $i(e,r,s,c),c.write_shift(2,t.length),o&&c.write_shift(1,1),c.write_shift((1+o)*t.length,t,o?"utf16le":"sbcs"),c}function H9(e,r,t,s){var a=t&&t.biff==5;s||(s=Pe(a?3+r.length:5+2*r.length)),s.write_shift(2,e),s.write_shift(a?1:2,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le");var o=s.length>s.l?s.slice(0,s.l):s;return o.l==null&&(o.l=o.length),o}function G9(e,r){var t=r.biff==8||!r.biff?4:2,s=Pe(2*t+6);return s.write_shift(t,e.s.r),s.write_shift(t,e.e.r+1),s.write_shift(2,e.s.c),s.write_shift(2,e.e.c+1),s.write_shift(2,0),s}function o1(e,r,t,s){var a=t&&t.biff==5;s||(s=Pe(a?16:20)),s.write_shift(2,0),e.style?(s.write_shift(2,e.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,e.numFmtId||0),s.write_shift(2,r<<4));var o=0;return e.numFmtId>0&&a&&(o|=1024),s.write_shift(4,o),s.write_shift(4,0),a||s.write_shift(4,0),s.write_shift(2,0),s}function Y9(e){var r=Pe(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function K9(e,r,t,s,a,o){var c=Pe(8);return $i(e,r,s,c),Ab(t,o,c),c}function X9(e,r,t,s){var a=Pe(14);return $i(e,r,s,a),Bi(t,a),a}function J9(e,r,t){if(t.biff<8)return Z9(e,r,t);for(var s=[],a=e.l+r,o=e.read_shift(t.biff>8?4:2);o--!==0;)s.push(L9(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return s}function Z9(e,r,t){e[e.l+1]==3&&e[e.l]++;var s=Tb(e,r,t);return s.charCodeAt(0)==3?s.slice(1):s}function e6(e){var r=Pe(2+e.length*8);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)Pb(e[t],r);return r}function t6(e){var r=Pe(24),t=Xr(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)r.write_shift(1,parseInt(s[a],16));return sn([r,M9(e[1])])}function r6(e){var r=e[1].Tooltip,t=Pe(10+2*(r.length+1));t.write_shift(2,2048);var s=Xr(e[0]);t.write_shift(2,s.r),t.write_shift(2,s.r),t.write_shift(2,s.c),t.write_shift(2,s.c);for(var a=0;a<r.length;++a)t.write_shift(2,r.charCodeAt(a));return t.write_shift(2,0),t}function n6(e){return e||(e=Pe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function s6(e,r,t){if(!t.cellStyles)return na(e,r);var s=t&&t.biff>=12?4:2,a=e.read_shift(s),o=e.read_shift(s),c=e.read_shift(s),u=e.read_shift(s),p=e.read_shift(2);s==2&&(e.l+=2);var h={s:a,e:o,w:c,ixfe:u,flags:p};return(t.biff>=5||!t.biff)&&(h.level=p>>8&7),h}function a6(e,r){var t=Pe(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,e.width*256),t.write_shift(2,0);var s=0;return e.hidden&&(s|=1),t.write_shift(1,s),s=e.level||0,t.write_shift(1,s),t.write_shift(2,0),t}function i6(e){for(var r=Pe(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}function o6(e,r,t){var s=Pe(15);return Rc(s,e,r),s.write_shift(8,t,"f"),s}function l6(e,r,t){var s=Pe(9);return Rc(s,e,r),s.write_shift(2,t),s}var c6=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=vm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(u,p){var h=[],x=Ii(1);switch(p.type){case"base64":x=As(ja(u));break;case"binary":x=As(u);break;case"buffer":case"array":x=u;break}rs(x,0);var y=x.read_shift(1),v=!!(y&136),k=!1,b=!1;switch(y){case 2:break;case 3:break;case 48:k=!0,v=!0;break;case 49:k=!0,v=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var w=0,j=521;y==2&&(w=x.read_shift(2)),x.l+=3,y!=2&&(w=x.read_shift(4)),w>1048576&&(w=1e6),y!=2&&(j=x.read_shift(2));var O=x.read_shift(2),T=p.codepage||1252;y!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(T=e[x[x.l]]),x.l+=1,x.l+=2),b&&(x.l+=36);for(var F=[],I={},G=Math.min(x.length,y==2?521:j-10-(k?264:0)),B=b?32:11;x.l<G&&x[x.l]!=13;)switch(I={},I.name=_u.utils.decode(T,x.slice(x.l,x.l+B)).replace(/[\u0000\r\n].*$/g,""),x.l+=B,I.type=String.fromCharCode(x.read_shift(1)),y!=2&&!b&&(I.offset=x.read_shift(4)),I.len=x.read_shift(1),y==2&&(I.offset=x.read_shift(2)),I.dec=x.read_shift(1),I.name.length&&F.push(I),y!=2&&(x.l+=b?13:14),I.type){case"B":(!k||I.len!=8)&&p.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":p.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(x[x.l]!==13&&(x.l=j-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=j;var Q=0,z=0;for(h[0]=[],z=0;z!=F.length;++z)h[0][z]=F[z].name;for(;w-- >0;){if(x[x.l]===42){x.l+=O;continue}for(++x.l,h[++Q]=[],z=0,z=0;z!=F.length;++z){var J=x.slice(x.l,x.l+F[z].len);x.l+=F[z].len,rs(J,0);var ne=_u.utils.decode(T,J);switch(F[z].type){case"C":ne.trim().length&&(h[Q][z]=ne.replace(/\s+$/,""));break;case"D":ne.length===8?h[Q][z]=new Date(+ne.slice(0,4),+ne.slice(4,6)-1,+ne.slice(6,8)):h[Q][z]=ne;break;case"F":h[Q][z]=parseFloat(ne.trim());break;case"+":case"I":h[Q][z]=b?J.read_shift(-4,"i")^2147483648:J.read_shift(4,"i");break;case"L":switch(ne.trim().toUpperCase()){case"Y":case"T":h[Q][z]=!0;break;case"N":case"F":h[Q][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ne+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));h[Q][z]="##MEMO##"+(b?parseInt(ne.trim(),10):J.read_shift(4));break;case"N":ne=ne.replace(/\u0000/g,"").trim(),ne&&ne!="."&&(h[Q][z]=+ne||0);break;case"@":h[Q][z]=new Date(J.read_shift(-8,"f")-621356832e5);break;case"T":h[Q][z]=new Date((J.read_shift(4)-2440588)*864e5+J.read_shift(4));break;case"Y":h[Q][z]=J.read_shift(4,"i")/1e4+J.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[Q][z]=-J.read_shift(-8,"f");break;case"B":if(k&&F[z].len==8){h[Q][z]=J.read_shift(8,"f");break}case"G":case"P":J.l+=F[z].len;break;case"0":if(F[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+F[z].type)}}}if(y!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return p&&p.sheetRows&&(h=h.slice(0,p.sheetRows)),p.DBF=F,h}function s(u,p){var h=p||{};h.dateNF||(h.dateNF="yyyymmdd");var x=Ko(t(u,h),h);return x["!cols"]=h.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete h.DBF,x}function a(u,p){try{return Wi(s(u,p),p)}catch(h){if(p&&p.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,p){var h=p||{};if(+h.codepage>=0&&tc(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var x=$n(),y=Bu(u,{header:1,raw:!0,cellDates:!0}),v=y[0],k=y.slice(1),b=u["!cols"]||[],w=0,j=0,O=0,T=1;for(w=0;w<v.length;++w){if(((b[w]||{}).DBF||{}).name){v[w]=b[w].DBF.name,++O;continue}if(v[w]!=null){if(++O,typeof v[w]=="number"&&(v[w]=v[w].toString(10)),typeof v[w]!="string")throw new Error("DBF Invalid column name "+v[w]+" |"+typeof v[w]+"|");if(v.indexOf(v[w])!==w){for(j=0;j<1024;++j)if(v.indexOf(v[w]+"_"+j)==-1){v[w]+="_"+j;break}}}}var F=wr(u["!ref"]),I=[],G=[],B=[];for(w=0;w<=F.e.c-F.s.c;++w){var Q="",z="",J=0,ne=[];for(j=0;j<k.length;++j)k[j][w]!=null&&ne.push(k[j][w]);if(ne.length==0||v[w]==null){I[w]="?";continue}for(j=0;j<ne.length;++j){switch(typeof ne[j]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=ne[j]instanceof Date?"D":"C";break;default:z="C"}J=Math.max(J,String(ne[j]).length),Q=Q&&Q!=z?"C":z}J>250&&(J=250),z=((b[w]||{}).DBF||{}).type,z=="C"&&b[w].DBF.len>J&&(J=b[w].DBF.len),Q=="B"&&z=="N"&&(Q="N",B[w]=b[w].DBF.dec,J=b[w].DBF.len),G[w]=Q=="C"||z=="N"?J:o[Q]||0,T+=G[w],I[w]=Q}var fe=x.next(32);for(fe.write_shift(4,318902576),fe.write_shift(4,k.length),fe.write_shift(2,296+32*O),fe.write_shift(2,T),w=0;w<4;++w)fe.write_shift(4,0);for(fe.write_shift(4,0|(+r[DS]||3)<<8),w=0,j=0;w<v.length;++w)if(v[w]!=null){var me=x.next(32),le=(v[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);me.write_shift(1,le,"sbcs"),me.write_shift(1,I[w]=="?"?"C":I[w],"sbcs"),me.write_shift(4,j),me.write_shift(1,G[w]||o[I[w]]||0),me.write_shift(1,B[w]||0),me.write_shift(1,2),me.write_shift(4,0),me.write_shift(1,0),me.write_shift(4,0),me.write_shift(4,0),j+=G[w]||o[I[w]]||0}var K=x.next(264);for(K.write_shift(4,13),w=0;w<65;++w)K.write_shift(4,0);for(w=0;w<k.length;++w){var Fe=x.next(T);for(Fe.write_shift(1,0),j=0;j<v.length;++j)if(v[j]!=null)switch(I[j]){case"L":Fe.write_shift(1,k[w][j]==null?63:k[w][j]?84:70);break;case"B":Fe.write_shift(8,k[w][j]||0,"f");break;case"N":var we="0";for(typeof k[w][j]=="number"&&(we=k[w][j].toFixed(B[j]||0)),O=0;O<G[j]-we.length;++O)Fe.write_shift(1,32);Fe.write_shift(1,we,"sbcs");break;case"D":k[w][j]?(Fe.write_shift(4,("0000"+k[w][j].getFullYear()).slice(-4),"sbcs"),Fe.write_shift(2,("00"+(k[w][j].getMonth()+1)).slice(-2),"sbcs"),Fe.write_shift(2,("00"+k[w][j].getDate()).slice(-2),"sbcs")):Fe.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(k[w][j]!=null?k[w][j]:"").slice(0,G[j]);for(Fe.write_shift(1,oe,"sbcs"),O=0;O<G[j]-oe.length;++O)Fe.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:a,to_sheet:s,from_sheet:c}})(),d6=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+ln(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(v,k){var b=e[k];return typeof b=="number"?Ov(b):b},s=function(v,k,b){var w=k.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return w==59?v:Ov(w)};e["|"]=254;function a(v,k){switch(k.type){case"base64":return o(ja(v),k);case"binary":return o(v,k);case"buffer":return o(Xt&&Buffer.isBuffer(v)?v.toString("binary"):Ec(v),k);case"array":return o(x0(v),k)}throw new Error("Unrecognized type "+k.type)}function o(v,k){var b=v.split(/[\n\r]+/),w=-1,j=-1,O=0,T=0,F=[],I=[],G=null,B={},Q=[],z=[],J=[],ne=0,fe;for(+k.codepage>=0&&tc(+k.codepage);O!==b.length;++O){ne=0;var me=b[O].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(r,t),le=me.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),K=le[0],Fe;if(me.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":le[1].charAt(0)=="P"&&I.push(me.slice(3).replace(/;;/g,";"));break;case"C":var we=!1,oe=!1,V=!1,de=!1,Ne=-1,ee=-1;for(T=1;T<le.length;++T)switch(le[T].charAt(0)){case"A":break;case"X":j=parseInt(le[T].slice(1))-1,oe=!0;break;case"Y":for(w=parseInt(le[T].slice(1))-1,oe||(j=0),fe=F.length;fe<=w;++fe)F[fe]=[];break;case"K":Fe=le[T].slice(1),Fe.charAt(0)==='"'?Fe=Fe.slice(1,Fe.length-1):Fe==="TRUE"?Fe=!0:Fe==="FALSE"?Fe=!1:isNaN(va(Fe))?isNaN(nc(Fe).getDate())||(Fe=kn(Fe)):(Fe=va(Fe),G!==null&&QS(G)&&(Fe=KS(Fe))),we=!0;break;case"E":de=!0;var U=lI(le[T].slice(1),{r:w,c:j});F[w][j]=[F[w][j],U];break;case"S":V=!0,F[w][j]=[F[w][j],"S5S"];break;case"G":break;case"R":Ne=parseInt(le[T].slice(1))-1;break;case"C":ee=parseInt(le[T].slice(1))-1;break;default:if(k&&k.WTF)throw new Error("SYLK bad record "+me)}if(we&&(F[w][j]&&F[w][j].length==2?F[w][j][0]=Fe:F[w][j]=Fe,G=null),V){if(de)throw new Error("SYLK shared formula cannot have own formula");var re=Ne>-1&&F[Ne][ee];if(!re||!re[1])throw new Error("SYLK shared formula cannot find base");F[w][j][1]=cI(re[1],{r:w-Ne,c:j-ee})}break;case"F":var Y=0;for(T=1;T<le.length;++T)switch(le[T].charAt(0)){case"X":j=parseInt(le[T].slice(1))-1,++Y;break;case"Y":for(w=parseInt(le[T].slice(1))-1,fe=F.length;fe<=w;++fe)F[fe]=[];break;case"M":ne=parseInt(le[T].slice(1))/20;break;case"F":break;case"G":break;case"P":G=I[parseInt(le[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(J=le[T].slice(1).split(" "),fe=parseInt(J[0],10);fe<=parseInt(J[1],10);++fe)ne=parseInt(J[2],10),z[fe-1]=ne===0?{hidden:!0}:{wch:ne},Om(z[fe-1]);break;case"C":j=parseInt(le[T].slice(1))-1,z[j]||(z[j]={});break;case"R":w=parseInt(le[T].slice(1))-1,Q[w]||(Q[w]={}),ne>0?(Q[w].hpt=ne,Q[w].hpx=Lb(ne)):ne===0&&(Q[w].hidden=!0);break;default:if(k&&k.WTF)throw new Error("SYLK bad record "+me)}Y<1&&(G=null);break;default:if(k&&k.WTF)throw new Error("SYLK bad record "+me)}}return Q.length>0&&(B["!rows"]=Q),z.length>0&&(B["!cols"]=z),k&&k.sheetRows&&(F=F.slice(0,k.sheetRows)),[F,B]}function c(v,k){var b=a(v,k),w=b[0],j=b[1],O=Ko(w,k);return ln(j).forEach(function(T){O[T]=j[T]}),O}function u(v,k){return Wi(c(v,k),k)}function p(v,k,b,w){var j="C;Y"+(b+1)+";X"+(w+1)+";K";switch(v.t){case"n":j+=v.v||0,v.f&&!v.F&&(j+=";E"+Rm(v.f,{r:b,c:w}));break;case"b":j+=v.v?"TRUE":"FALSE";break;case"e":j+=v.w||v.v;break;case"d":j+='"'+(v.w||v.v)+'"';break;case"s":j+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return j}function h(v,k){k.forEach(function(b,w){var j="F;W"+(w+1)+" "+(w+1)+" ";b.hidden?j+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=Fu(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=Mu(b.wpx)),typeof b.wch=="number"&&(j+=Math.round(b.wch))),j.charAt(j.length-1)!=" "&&v.push(j)})}function x(v,k){k.forEach(function(b,w){var j="F;";b.hidden?j+="M0;":b.hpt?j+="M"+20*b.hpt+";":b.hpx&&(j+="M"+20*Lu(b.hpx)+";"),j.length>2&&v.push(j+"R"+(w+1))})}function y(v,k){var b=["ID;PWXL;N;E"],w=[],j=wr(v["!ref"]),O,T=Array.isArray(v),F=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),v["!cols"]&&h(b,v["!cols"]),v["!rows"]&&x(b,v["!rows"]),b.push("B;Y"+(j.e.r-j.s.r+1)+";X"+(j.e.c-j.s.c+1)+";D"+[j.s.c,j.s.r,j.e.c,j.e.r].join(" "));for(var I=j.s.r;I<=j.e.r;++I)for(var G=j.s.c;G<=j.e.c;++G){var B=ir({r:I,c:G});O=T?(v[I]||[])[G]:v[B],!(!O||O.v==null&&(!O.f||O.F))&&w.push(p(O,v,I,G))}return b.join(F)+F+w.join(F)+F+"E"+F}return{to_workbook:u,to_sheet:c,from_sheet:y}})(),u6=(function(){function e(o,c){switch(c.type){case"base64":return r(ja(o),c);case"binary":return r(o,c);case"buffer":return r(Xt&&Buffer.isBuffer(o)?o.toString("binary"):Ec(o),c);case"array":return r(x0(o),c)}throw new Error("Unrecognized type "+c.type)}function r(o,c){for(var u=o.split(`
`),p=-1,h=-1,x=0,y=[];x!==u.length;++x){if(u[x].trim()==="BOT"){y[++p]=[],h=0;continue}if(!(p<0)){var v=u[x].trim().split(","),k=v[0],b=v[1];++x;for(var w=u[x]||"";(w.match(/["]/g)||[]).length&1&&x<u.length-1;)w+=`
`+u[++x];switch(w=w.trim(),+k){case-1:if(w==="BOT"){y[++p]=[],h=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?y[p][h]=!0:w==="FALSE"?y[p][h]=!1:isNaN(va(b))?isNaN(nc(b).getDate())?y[p][h]=b:y[p][h]=kn(b):y[p][h]=va(b),++h;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),y[p][h++]=w!==""?w:null;break}if(w==="EOD")break}}return c&&c.sheetRows&&(y=y.slice(0,c.sheetRows)),y}function t(o,c){return Ko(e(o,c),c)}function s(o,c){return Wi(t(o,c),c)}var a=(function(){var o=function(p,h,x,y,v){p.push(h),p.push(x+","+y),p.push('"'+v.replace(/"/g,'""')+'"')},c=function(p,h,x,y){p.push(h+","+x),p.push(h==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(p){var h=[],x=wr(p["!ref"]),y,v=Array.isArray(p);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,x.e.r-x.s.r+1,""),o(h,"TUPLES",0,x.e.c-x.s.c+1,""),o(h,"DATA",0,0,"");for(var k=x.s.r;k<=x.e.r;++k){c(h,-1,0,"BOT");for(var b=x.s.c;b<=x.e.c;++b){var w=ir({r:k,c:b});if(y=v?(p[k]||[])[b]:p[w],!y){c(h,1,0,"");continue}switch(y.t){case"n":var j=y.w;!j&&y.v!=null&&(j=y.v),j==null?y.f&&!y.F?c(h,1,0,"="+y.f):c(h,1,0,""):c(h,0,j,"V");break;case"b":c(h,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":c(h,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=si(y.z||Or[14],Un(kn(y.v)))),c(h,0,y.w,"V");break;default:c(h,1,0,"")}}}c(h,-1,0,"EOD");var O=`\r
`,T=h.join(O);return T}})();return{to_workbook:s,to_sheet:t,from_sheet:a}})(),Rb=(function(){function e(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(y,v){for(var k=y.split(`
`),b=-1,w=-1,j=0,O=[];j!==k.length;++j){var T=k[j].trim().split(":");if(T[0]==="cell"){var F=Xr(T[1]);if(O.length<=F.r)for(b=O.length;b<=F.r;++b)O[b]||(O[b]=[]);switch(b=F.r,w=F.c,T[2]){case"t":O[b][w]=e(T[3]);break;case"v":O[b][w]=+T[3];break;case"vtf":var I=T[T.length-1];case"vtc":switch(T[3]){case"nl":O[b][w]=!!+T[4];break;default:O[b][w]=+T[4];break}T[2]=="vtf"&&(O[b][w]=[O[b][w],I])}}}return v&&v.sheetRows&&(O=O.slice(0,v.sheetRows)),O}function s(y,v){return Ko(t(y,v),v)}function a(y,v){return Wi(s(y,v),v)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),p="--SocialCalcSpreadsheetControlSave--";function h(y){if(!y||!y["!ref"])return"";for(var v=[],k=[],b,w="",j=ls(y["!ref"]),O=Array.isArray(y),T=j.s.r;T<=j.e.r;++T)for(var F=j.s.c;F<=j.e.c;++F)if(w=ir({r:T,c:F}),b=O?(y[T]||[])[F]:y[w],!(!b||b.v==null||b.t==="z")){switch(k=["cell",w,"t"],b.t){case"s":case"str":k.push(r(b.v));break;case"n":b.f?(k[2]="vtf",k[3]="n",k[4]=b.v,k[5]=r(b.f)):(k[2]="v",k[3]=b.v);break;case"b":k[2]="vt"+(b.f?"f":"c"),k[3]="nl",k[4]=b.v?"1":"0",k[5]=r(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var I=Un(kn(b.v));k[2]="vtc",k[3]="nd",k[4]=""+I,k[5]=b.w||si(b.z||Or[14],I);break;case"e":continue}v.push(k.join(":"))}return v.push("sheet:c:"+(j.e.c-j.s.c+1)+":r:"+(j.e.r-j.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function x(y){return[o,c,u,c,h(y),p].join(`
`)}return{to_workbook:a,to_sheet:s,from_sheet:x}})(),f6=(function(){function e(x,y,v,k,b){b.raw?y[v][k]=x:x===""||(x==="TRUE"?y[v][k]=!0:x==="FALSE"?y[v][k]=!1:isNaN(va(x))?isNaN(nc(x).getDate())?y[v][k]=x:y[v][k]=kn(x):y[v][k]=va(x))}function r(x,y){var v=y||{},k=[];if(!x||x.length===0)return k;for(var b=x.split(/[\r\n]/),w=b.length-1;w>=0&&b[w].length===0;)--w;for(var j=10,O=0,T=0;T<=w;++T)O=b[T].indexOf(" "),O==-1?O=b[T].length:O++,j=Math.max(j,O);for(T=0;T<=w;++T){k[T]=[];var F=0;for(e(b[T].slice(0,j).trim(),k,T,F,v),F=1;F<=(b[T].length-j)/10+1;++F)e(b[T].slice(j+(F-1)*10,j+F*10).trim(),k,T,F,v)}return v.sheetRows&&(k=k.slice(0,v.sheetRows)),k}var t={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function a(x){for(var y={},v=!1,k=0,b=0;k<x.length;++k)(b=x.charCodeAt(k))==34?v=!v:!v&&b in t&&(y[b]=(y[b]||0)+1);b=[];for(k in y)Object.prototype.hasOwnProperty.call(y,k)&&b.push([y[k],k]);if(!b.length){y=s;for(k in y)Object.prototype.hasOwnProperty.call(y,k)&&b.push([y[k],k])}return b.sort(function(w,j){return w[0]-j[0]||s[w[1]]-s[j[1]]}),t[b.pop()[1]]||44}function o(x,y){var v=y||{},k="",b=v.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(k=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(k=x.charAt(4),x=x.slice(6)):k=a(x.slice(0,1024)):v&&v.FS?k=v.FS:k=a(x.slice(0,1024));var j=0,O=0,T=0,F=0,I=0,G=k.charCodeAt(0),B=!1,Q=0,z=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var J=v.dateNF!=null?EL(v.dateNF):null;function ne(){var fe=x.slice(F,I),me={};if(fe.charAt(0)=='"'&&fe.charAt(fe.length-1)=='"'&&(fe=fe.slice(1,-1).replace(/""/g,'"')),fe.length===0)me.t="z";else if(v.raw)me.t="s",me.v=fe;else if(fe.trim().length===0)me.t="s",me.v=fe;else if(fe.charCodeAt(0)==61)fe.charCodeAt(1)==34&&fe.charCodeAt(fe.length-1)==34?(me.t="s",me.v=fe.slice(2,-1).replace(/""/g,'"')):dI(fe)?(me.t="n",me.f=fe.slice(1)):(me.t="s",me.v=fe);else if(fe=="TRUE")me.t="b",me.v=!0;else if(fe=="FALSE")me.t="b",me.v=!1;else if(!isNaN(T=va(fe)))me.t="n",v.cellText!==!1&&(me.w=fe),me.v=T;else if(!isNaN(nc(fe).getDate())||J&&fe.match(J)){me.z=v.dateNF||Or[14];var le=0;J&&fe.match(J)&&(fe=AL(fe,v.dateNF,fe.match(J)||[]),le=1),v.cellDates?(me.t="d",me.v=kn(fe,le)):(me.t="n",me.v=Un(kn(fe,le))),v.cellText!==!1&&(me.w=si(me.z,me.v instanceof Date?Un(me.v):me.v)),v.cellNF||delete me.z}else me.t="s",me.v=fe;if(me.t=="z"||(v.dense?(b[j]||(b[j]=[]),b[j][O]=me):b[ir({c:O,r:j})]=me),F=I+1,z=x.charCodeAt(F),w.e.c<O&&(w.e.c=O),w.e.r<j&&(w.e.r=j),Q==G)++O;else if(O=0,++j,v.sheetRows&&v.sheetRows<=j)return!0}e:for(;I<x.length;++I)switch(Q=x.charCodeAt(I)){case 34:z===34&&(B=!B);break;case G:case 10:case 13:if(!B&&ne())break e;break}return I-F>0&&ne(),b["!ref"]=Ir(w),b}function c(x,y){return!(y&&y.PRN)||y.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?o(x,y):Ko(r(x,y),y)}function u(x,y){var v="",k=y.type=="string"?[0,0,0,0]:j$(x,y);switch(y.type){case"base64":v=ja(x);break;case"binary":v=x;break;case"buffer":y.codepage==65001?v=x.toString("utf8"):y.codepage&&typeof _u<"u"||(v=Xt&&Buffer.isBuffer(x)?x.toString("binary"):Ec(x));break;case"array":v=x0(x);break;case"string":v=x;break;default:throw new Error("Unrecognized type "+y.type)}return k[0]==239&&k[1]==187&&k[2]==191?v=ql(v.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?v=ql(v):y.type=="binary"&&typeof _u<"u",v.slice(0,19)=="socialcalc:version:"?Rb.to_sheet(y.type=="string"?v:ql(v),y):c(v,y)}function p(x,y){return Wi(u(x,y),y)}function h(x){for(var y=[],v=wr(x["!ref"]),k,b=Array.isArray(x),w=v.s.r;w<=v.e.r;++w){for(var j=[],O=v.s.c;O<=v.e.c;++O){var T=ir({r:w,c:O});if(k=b?(x[w]||[])[O]:x[T],!k||k.v==null){j.push("          ");continue}for(var F=(k.w||(ka(k),k.w)||"").slice(0,10);F.length<10;)F+=" ";j.push(F+(O===0?" ":""))}y.push(j.join(""))}return y.join(`
`)}return{to_workbook:p,to_sheet:u,from_sheet:h}})(),l1=(function(){function e(U,re,Y){if(U){rs(U,U.l||0);for(var Z=Y.Enum||Ne;U.l<U.length;){var xe=U.read_shift(2),ie=Z[xe]||Z[65535],Te=U.read_shift(2),ve=U.l+Te,Ee=ie.f&&ie.f(U,Te,Y);if(U.l=ve,re(Ee,ie,xe))return}}}function r(U,re){switch(re.type){case"base64":return t(As(ja(U)),re);case"binary":return t(As(U),re);case"buffer":case"array":return t(U,re)}throw"Unsupported type "+re.type}function t(U,re){if(!U)return U;var Y=re||{},Z=Y.dense?[]:{},xe="Sheet1",ie="",Te=0,ve={},Ee=[],Me=[],D={s:{r:0,c:0},e:{r:0,c:0}},ut=Y.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)Y.Enum=Ne,e(U,function(Le,ft,rt){switch(rt){case 0:Y.vers=Le,Le>=4096&&(Y.qpro=!0);break;case 6:D=Le;break;case 204:Le&&(ie=Le);break;case 222:ie=Le;break;case 15:case 51:Y.qpro||(Le[1].v=Le[1].v.slice(1));case 13:case 14:case 16:rt==14&&(Le[2]&112)==112&&(Le[2]&15)>1&&(Le[2]&15)<15&&(Le[1].z=Y.dateNF||Or[14],Y.cellDates&&(Le[1].t="d",Le[1].v=KS(Le[1].v))),Y.qpro&&Le[3]>Te&&(Z["!ref"]=Ir(D),ve[xe]=Z,Ee.push(xe),Z=Y.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},Te=Le[3],xe=ie||"Sheet"+(Te+1),ie="");var hr=Y.dense?(Z[Le[0].r]||[])[Le[0].c]:Z[ir(Le[0])];if(hr){hr.t=Le[1].t,hr.v=Le[1].v,Le[1].z!=null&&(hr.z=Le[1].z),Le[1].f!=null&&(hr.f=Le[1].f);break}Y.dense?(Z[Le[0].r]||(Z[Le[0].r]=[]),Z[Le[0].r][Le[0].c]=Le[1]):Z[ir(Le[0])]=Le[1];break}},Y);else if(U[2]==26||U[2]==14)Y.Enum=ee,U[2]==14&&(Y.qpro=!0,U.l=0),e(U,function(Le,ft,rt){switch(rt){case 204:xe=Le;break;case 22:Le[1].v=Le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Le[3]>Te&&(Z["!ref"]=Ir(D),ve[xe]=Z,Ee.push(xe),Z=Y.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},Te=Le[3],xe="Sheet"+(Te+1)),ut>0&&Le[0].r>=ut)break;Y.dense?(Z[Le[0].r]||(Z[Le[0].r]=[]),Z[Le[0].r][Le[0].c]=Le[1]):Z[ir(Le[0])]=Le[1],D.e.c<Le[0].c&&(D.e.c=Le[0].c),D.e.r<Le[0].r&&(D.e.r=Le[0].r);break;case 27:Le[14e3]&&(Me[Le[14e3][0]]=Le[14e3][1]);break;case 1537:Me[Le[0]]=Le[1],Le[0]==Te&&(xe=Le[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(Z["!ref"]=Ir(D),ve[ie||xe]=Z,Ee.push(ie||xe),!Me.length)return{SheetNames:Ee,Sheets:ve};for(var et={},Ge=[],Be=0;Be<Me.length;++Be)ve[Ee[Be]]?(Ge.push(Me[Be]||Ee[Be]),et[Me[Be]]=ve[Me[Be]]||ve[Ee[Be]]):(Ge.push(Me[Be]),et[Me[Be]]={"!ref":"A1"});return{SheetNames:Ge,Sheets:et}}function s(U,re){var Y=re||{};if(+Y.codepage>=0&&tc(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=$n(),xe=wr(U["!ref"]),ie=Array.isArray(U),Te=[];Ke(Z,0,o(1030)),Ke(Z,6,p(xe));for(var ve=Math.min(xe.e.r,8191),Ee=xe.s.r;Ee<=ve;++Ee)for(var Me=on(Ee),D=xe.s.c;D<=xe.e.c;++D){Ee===xe.s.r&&(Te[D]=yn(D));var ut=Te[D]+Me,et=ie?(U[Ee]||[])[D]:U[ut];if(!(!et||et.t=="z"))if(et.t=="n")(et.v|0)==et.v&&et.v>=-32768&&et.v<=32767?Ke(Z,13,k(Ee,D,et.v)):Ke(Z,14,w(Ee,D,et.v));else{var Ge=ka(et);Ke(Z,15,y(Ee,D,Ge.slice(0,239)))}}return Ke(Z,1),Z.end()}function a(U,re){var Y=re||{};if(+Y.codepage>=0&&tc(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=$n();Ke(Z,0,c(U));for(var xe=0,ie=0;xe<U.SheetNames.length;++xe)(U.Sheets[U.SheetNames[xe]]||{})["!ref"]&&Ke(Z,27,de(U.SheetNames[xe],ie++));var Te=0;for(xe=0;xe<U.SheetNames.length;++xe){var ve=U.Sheets[U.SheetNames[xe]];if(!(!ve||!ve["!ref"])){for(var Ee=wr(ve["!ref"]),Me=Array.isArray(ve),D=[],ut=Math.min(Ee.e.r,8191),et=Ee.s.r;et<=ut;++et)for(var Ge=on(et),Be=Ee.s.c;Be<=Ee.e.c;++Be){et===Ee.s.r&&(D[Be]=yn(Be));var Le=D[Be]+Ge,ft=Me?(ve[et]||[])[Be]:ve[Le];if(!(!ft||ft.t=="z"))if(ft.t=="n")Ke(Z,23,ne(et,Be,Te,ft.v));else{var rt=ka(ft);Ke(Z,22,Q(et,Be,Te,rt.slice(0,239)))}}++Te}}return Ke(Z,1),Z.end()}function o(U){var re=Pe(2);return re.write_shift(2,U),re}function c(U){var re=Pe(26);re.write_shift(2,4096),re.write_shift(2,4),re.write_shift(4,0);for(var Y=0,Z=0,xe=0,ie=0;ie<U.SheetNames.length;++ie){var Te=U.SheetNames[ie],ve=U.Sheets[Te];if(!(!ve||!ve["!ref"])){++xe;var Ee=ls(ve["!ref"]);Y<Ee.e.r&&(Y=Ee.e.r),Z<Ee.e.c&&(Z=Ee.e.c)}}return Y>8191&&(Y=8191),re.write_shift(2,Y),re.write_shift(1,xe),re.write_shift(1,Z),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(1,1),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(4,0),re}function u(U,re,Y){var Z={s:{c:0,r:0},e:{c:0,r:0}};return re==8&&Y.qpro?(Z.s.c=U.read_shift(1),U.l++,Z.s.r=U.read_shift(2),Z.e.c=U.read_shift(1),U.l++,Z.e.r=U.read_shift(2),Z):(Z.s.c=U.read_shift(2),Z.s.r=U.read_shift(2),re==12&&Y.qpro&&(U.l+=2),Z.e.c=U.read_shift(2),Z.e.r=U.read_shift(2),re==12&&Y.qpro&&(U.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function p(U){var re=Pe(8);return re.write_shift(2,U.s.c),re.write_shift(2,U.s.r),re.write_shift(2,U.e.c),re.write_shift(2,U.e.r),re}function h(U,re,Y){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(Z[0].c=U.read_shift(1),Z[3]=U.read_shift(1),Z[0].r=U.read_shift(2),U.l+=2):(Z[2]=U.read_shift(1),Z[0].c=U.read_shift(2),Z[0].r=U.read_shift(2)),Z}function x(U,re,Y){var Z=U.l+re,xe=h(U,re,Y);if(xe[1].t="s",Y.vers==20768){U.l++;var ie=U.read_shift(1);return xe[1].v=U.read_shift(ie,"utf8"),xe}return Y.qpro&&U.l++,xe[1].v=U.read_shift(Z-U.l,"cstr"),xe}function y(U,re,Y){var Z=Pe(7+Y.length);Z.write_shift(1,255),Z.write_shift(2,re),Z.write_shift(2,U),Z.write_shift(1,39);for(var xe=0;xe<Z.length;++xe){var ie=Y.charCodeAt(xe);Z.write_shift(1,ie>=128?95:ie)}return Z.write_shift(1,0),Z}function v(U,re,Y){var Z=h(U,re,Y);return Z[1].v=U.read_shift(2,"i"),Z}function k(U,re,Y){var Z=Pe(7);return Z.write_shift(1,255),Z.write_shift(2,re),Z.write_shift(2,U),Z.write_shift(2,Y,"i"),Z}function b(U,re,Y){var Z=h(U,re,Y);return Z[1].v=U.read_shift(8,"f"),Z}function w(U,re,Y){var Z=Pe(13);return Z.write_shift(1,255),Z.write_shift(2,re),Z.write_shift(2,U),Z.write_shift(8,Y,"f"),Z}function j(U,re,Y){var Z=U.l+re,xe=h(U,re,Y);if(xe[1].v=U.read_shift(8,"f"),Y.qpro)U.l=Z;else{var ie=U.read_shift(2);I(U.slice(U.l,U.l+ie),xe),U.l+=ie}return xe}function O(U,re,Y){var Z=re&32768;return re&=-32769,re=(Z?U:0)+(re>=8192?re-16384:re),(Z?"":"$")+(Y?yn(re):on(re))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},F=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function I(U,re){rs(U,0);for(var Y=[],Z=0,xe="",ie="",Te="",ve="";U.l<U.length;){var Ee=U[U.l++];switch(Ee){case 0:Y.push(U.read_shift(8,"f"));break;case 1:ie=O(re[0].c,U.read_shift(2),!0),xe=O(re[0].r,U.read_shift(2),!1),Y.push(ie+xe);break;case 2:{var Me=O(re[0].c,U.read_shift(2),!0),D=O(re[0].r,U.read_shift(2),!1);ie=O(re[0].c,U.read_shift(2),!0),xe=O(re[0].r,U.read_shift(2),!1),Y.push(Me+D+":"+ie+xe)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(U.read_shift(2));break;case 6:{for(var ut="";Ee=U[U.l++];)ut+=String.fromCharCode(Ee);Y.push('"'+ut.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:ve=Y.pop(),Te=Y.pop(),Y.push(["AND","OR"][Ee-20]+"("+Te+","+ve+")");break;default:if(Ee<32&&F[Ee])ve=Y.pop(),Te=Y.pop(),Y.push(Te+F[Ee]+ve);else if(T[Ee]){if(Z=T[Ee][1],Z==69&&(Z=U[U.l++]),Z>Y.length){console.error("WK1 bad formula parse 0x"+Ee.toString(16)+":|"+Y.join("|")+"|");return}var et=Y.slice(-Z);Y.length-=Z,Y.push(T[Ee][0]+"("+et.join(",")+")")}else return Ee<=7?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=24?console.error("WK1 unsupported op "+Ee.toString(16)):Ee<=30?console.error("WK1 invalid opcode "+Ee.toString(16)):Ee<=115?console.error("WK1 unsupported function opcode "+Ee.toString(16)):console.error("WK1 unrecognized opcode "+Ee.toString(16))}}Y.length==1?re[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function G(U){var re=[{c:0,r:0},{t:"n",v:0},0];return re[0].r=U.read_shift(2),re[3]=U[U.l++],re[0].c=U[U.l++],re}function B(U,re){var Y=G(U);return Y[1].t="s",Y[1].v=U.read_shift(re-4,"cstr"),Y}function Q(U,re,Y,Z){var xe=Pe(6+Z.length);xe.write_shift(2,U),xe.write_shift(1,Y),xe.write_shift(1,re),xe.write_shift(1,39);for(var ie=0;ie<Z.length;++ie){var Te=Z.charCodeAt(ie);xe.write_shift(1,Te>=128?95:Te)}return xe.write_shift(1,0),xe}function z(U,re){var Y=G(U);Y[1].v=U.read_shift(2);var Z=Y[1].v>>1;if(Y[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return Y[1].v=Z,Y}function J(U,re){var Y=G(U),Z=U.read_shift(4),xe=U.read_shift(4),ie=U.read_shift(2);if(ie==65535)return Z===0&&xe===3221225472?(Y[1].t="e",Y[1].v=15):Z===0&&xe===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var Te=ie&32768;return ie=(ie&32767)-16446,Y[1].v=(1-Te*2)*(xe*Math.pow(2,ie+32)+Z*Math.pow(2,ie)),Y}function ne(U,re,Y,Z){var xe=Pe(14);if(xe.write_shift(2,U),xe.write_shift(1,Y),xe.write_shift(1,re),Z==0)return xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(2,65535),xe;var ie=0,Te=0,ve=0,Ee=0;return Z<0&&(ie=1,Z=-Z),Te=Math.log2(Z)|0,Z/=Math.pow(2,Te-31),Ee=Z>>>0,(Ee&2147483648)==0&&(Z/=2,++Te,Ee=Z>>>0),Z-=Ee,Ee|=2147483648,Ee>>>=0,Z*=Math.pow(2,32),ve=Z>>>0,xe.write_shift(4,ve),xe.write_shift(4,Ee),Te+=16383+(ie?32768:0),xe.write_shift(2,Te),xe}function fe(U,re){var Y=J(U);return U.l+=re-14,Y}function me(U,re){var Y=G(U),Z=U.read_shift(4);return Y[1].v=Z>>6,Y}function le(U,re){var Y=G(U),Z=U.read_shift(8,"f");return Y[1].v=Z,Y}function K(U,re){var Y=le(U);return U.l+=re-10,Y}function Fe(U,re){return U[U.l+re-1]==0?U.read_shift(re,"cstr"):""}function we(U,re){var Y=U[U.l++];Y>re-1&&(Y=re-1);for(var Z="";Z.length<Y;)Z+=String.fromCharCode(U[U.l++]);return Z}function oe(U,re,Y){if(!(!Y.qpro||re<21)){var Z=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var xe=U.read_shift(re-21,"cstr");return[Z,xe]}}function V(U,re){for(var Y={},Z=U.l+re;U.l<Z;){var xe=U.read_shift(2);if(xe==14e3){for(Y[xe]=[0,""],Y[xe][0]=U.read_shift(2);U[U.l];)Y[xe][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return Y}function de(U,re){var Y=Pe(5+U.length);Y.write_shift(2,14e3),Y.write_shift(2,re);for(var Z=0;Z<U.length;++Z){var xe=U.charCodeAt(Z);Y[Y.l++]=xe>127?95:xe}return Y[Y.l++]=0,Y}var Ne={0:{n:"BOF",f:Eb},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:j},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Fe},222:{n:"SHEETNAMELP",f:we},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:J},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:fe},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:V},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:me},38:{n:"??"},39:{n:"NUMBER27",f:le},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Fe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:a,to_workbook:r}})(),h6=/^\s|\s$|[\t\n\r]/;function Db(e,r){if(!r.bookSST)return"";var t=[Br];t[t.length]=Ye("sst",null,{xmlns:Yo[0],count:e.Count,uniqueCount:e.Unique});for(var s=0;s!=e.length;++s)if(e[s]!=null){var a=e[s],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(h6)&&(o+=' xml:space="preserve"'),o+=">"+ar(a.t)+"</t>"),o+="</si>",t[t.length]=o}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function p6(e){return[e.read_shift(4),e.read_shift(4)]}function m6(e,r){return r||(r=Pe(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}var x6=i9;function g6(e){var r=$n();Ie(r,159,m6(e));for(var t=0;t<e.length;++t)Ie(r,19,x6(e[t]));return Ie(r,160),r.end()}function y6(e){for(var r=[],t=e.split(""),s=0;s<t.length;++s)r[s]=t[s].charCodeAt(0);return r}function Fb(e){var r=0,t,s=y6(e),a=s.length+1,o,c,u,p,h;for(t=Ii(a),t[0]=s.length,o=1;o!=a;++o)t[o]=s[o-1];for(o=a-1;o>=0;--o)c=t[o],u=(r&16384)===0?0:1,p=r<<1&32767,h=u|p,r=h^c;return r^52811}var v6=(function(){function e(a,o){switch(o.type){case"base64":return r(ja(a),o);case"binary":return r(a,o);case"buffer":return r(Xt&&Buffer.isBuffer(a)?a.toString("binary"):Ec(a),o);case"array":return r(x0(a),o)}throw new Error("Unrecognized type "+o.type)}function r(a,o){var c=o||{},u=c.dense?[]:{},p=a.match(/\\trowd.*?\\row\b/g);if(!p.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:p.length-1}};return p.forEach(function(x,y){Array.isArray(u)&&(u[y]=[]);for(var v=/\\\w+\b/g,k=0,b,w=-1;b=v.exec(x);){switch(b[0]){case"\\cell":var j=x.slice(k,v.lastIndex-b[0].length);if(j[0]==" "&&(j=j.slice(1)),++w,j.length){var O={v:j,t:"s"};Array.isArray(u)?u[y][w]=O:u[ir({r:y,c:w})]=O}break}k=v.lastIndex}w>h.e.c&&(h.e.c=w)}),u["!ref"]=Ir(h),u}function t(a,o){return Wi(e(a,o),o)}function s(a){for(var o=["{\\rtf1\\ansi"],c=wr(a["!ref"]),u,p=Array.isArray(a),h=c.s.r;h<=c.e.r;++h){o.push("\\trowd\\trautofit1");for(var x=c.s.c;x<=c.e.c;++x)o.push("\\cellx"+(x+1));for(o.push("\\pard\\intbl"),x=c.s.c;x<=c.e.c;++x){var y=ir({r:h,c:x});u=p?(a[h]||[])[x]:a[y],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(ka(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:s}})();function c1(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}var w6=6,wa=w6;function Fu(e){return Math.floor((e+Math.round(128/wa)/256)*wa)}function Mu(e){return Math.floor((e-5)/wa*100+.5)/100}function pp(e){return Math.round((e*wa+5)/wa*256)/256}function Om(e){e.width?(e.wpx=Fu(e.width),e.wch=Mu(e.wpx),e.MDW=wa):e.wpx?(e.wch=Mu(e.wpx),e.width=pp(e.wch),e.MDW=wa):typeof e.wch=="number"&&(e.width=pp(e.wch),e.wpx=Fu(e.width),e.MDW=wa),e.customWidth&&delete e.customWidth}var N6=96,Mb=N6;function Lu(e){return e*96/Mb}function Lb(e){return e*Mb/96}function S6(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var s=t[0];s<=t[1];++s)e[s]!=null&&(r[r.length]=Ye("numFmt",null,{numFmtId:s,formatCode:ar(e[s])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=Ye("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function b6(e){var r=[];return r[r.length]=Ye("cellXfs",null),e.forEach(function(t){r[r.length]=Ye("xf",null,t)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=Ye("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function Ib(e,r){var t=[Br,Ye("styleSheet",null,{xmlns:Yo[0],"xmlns:vt":Kr.vt})],s;return e.SSF&&(s=S6(e.SSF))!=null&&(t[t.length]=s),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=b6(r.cellXfs))&&(t[t.length]=s),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function j6(e,r){var t=e.read_shift(2),s=vn(e);return[t,s]}function k6(e,r,t){t||(t=Pe(6+4*r.length)),t.write_shift(2,e),Jr(r,t);var s=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),s}function _6(e,r,t){var s={};s.sz=e.read_shift(2)/20;var a=h9(e);a.fItalic&&(s.italic=1),a.fCondense&&(s.condense=1),a.fExtend&&(s.extend=1),a.fShadow&&(s.shadow=1),a.fOutline&&(s.outline=1),a.fStrikeout&&(s.strike=1);var o=e.read_shift(2);switch(o===700&&(s.bold=1),e.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(s.underline=c);var u=e.read_shift(1);u>0&&(s.family=u);var p=e.read_shift(1);switch(p>0&&(s.charset=p),e.l++,s.color=f9(e),e.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=vn(e),s}function C6(e,r){r||(r=Pe(153)),r.write_shift(2,e.sz*20),p9(e,r),r.write_shift(2,e.bold?700:400);var t=0;e.vertAlign=="superscript"?t=1:e.vertAlign=="subscript"&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),Ru(e.color,r);var s=0;return s=2,r.write_shift(1,s),Jr(e.name,r),r.length>r.l?r.slice(0,r.l):r}var E6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Fh,A6=na;function d1(e,r){r||(r=Pe(84)),Fh||(Fh=vm(E6));var t=Fh[e.patternType];t==null&&(t=40),r.write_shift(4,t);var s=0;if(t!=40)for(Ru({auto:1},r),Ru({auto:1},r);s<12;++s)r.write_shift(4,0);else{for(;s<4;++s)r.write_shift(4,0);for(;s<12;++s)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function T6(e,r){var t=e.l+r,s=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:s,numFmtId:a}}function Bb(e,r,t){t||(t=Pe(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var s=0;return t.write_shift(1,s),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Bl(e,r){return r||(r=Pe(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var O6=na;function P6(e,r){return r||(r=Pe(51)),r.write_shift(1,0),Bl(null,r),Bl(null,r),Bl(null,r),Bl(null,r),Bl(null,r),r.length>r.l?r.slice(0,r.l):r}function R6(e,r){return r||(r=Pe(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),Pu(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}function D6(e,r,t){var s=Pe(2052);return s.write_shift(4,e),Pu(r,s),Pu(t,s),s.length>s.l?s.slice(0,s.l):s}function F6(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)r[a]!=null&&++t}),t!=0&&(Ie(e,615,Os(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)r[a]!=null&&Ie(e,44,k6(a,r[a]))}),Ie(e,616))}}function M6(e){var r=1;Ie(e,611,Os(r)),Ie(e,43,C6({sz:12,color:{theme:1},name:"Calibri",family:2})),Ie(e,612)}function L6(e){var r=2;Ie(e,603,Os(r)),Ie(e,45,d1({patternType:"none"})),Ie(e,45,d1({patternType:"gray125"})),Ie(e,604)}function I6(e){var r=1;Ie(e,613,Os(r)),Ie(e,46,P6()),Ie(e,614)}function B6(e){var r=1;Ie(e,626,Os(r)),Ie(e,47,Bb({numFmtId:0},65535)),Ie(e,627)}function $6(e,r){Ie(e,617,Os(r.length)),r.forEach(function(t){Ie(e,47,Bb(t,0))}),Ie(e,618)}function U6(e){var r=1;Ie(e,619,Os(r)),Ie(e,48,R6({xfId:0,name:"Normal"})),Ie(e,620)}function z6(e){var r=0;Ie(e,505,Os(r)),Ie(e,506)}function W6(e){var r=0;Ie(e,508,D6(r,"TableStyleMedium9","PivotStyleMedium4")),Ie(e,509)}function q6(e,r){var t=$n();return Ie(t,278),F6(t,e.SSF),M6(t),L6(t),I6(t),B6(t),$6(t,r.cellXfs),U6(t),z6(t),W6(t),Ie(t,279),t.end()}function $b(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Br];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function V6(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:vn(e)}}function Q6(e){var r=Pe(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),Jr(e.name,r),r.slice(0,r.l)}function H6(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function G6(e){var r=Pe(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}function Y6(e,r){var t=Pe(8+2*r.length);return t.write_shift(4,e),Jr(r,t),t.slice(0,t.l)}function K6(e){return e.l+=4,e.read_shift(4)!=0}function X6(e,r){var t=Pe(8);return t.write_shift(4,e),t.write_shift(4,1),t}function J6(){var e=$n();return Ie(e,332),Ie(e,334,Os(1)),Ie(e,335,Q6({name:"XLDAPR",version:12e4,flags:3496657072})),Ie(e,336),Ie(e,339,Y6(1,"XLDAPR")),Ie(e,52),Ie(e,35,Os(514)),Ie(e,4096,Os(0)),Ie(e,4097,xs(1)),Ie(e,36),Ie(e,53),Ie(e,340),Ie(e,337,X6(1)),Ie(e,51,G6([[1,0]])),Ie(e,338),Ie(e,333),e.end()}function Ub(){var e=[Br];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Z6(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=ir(t);var s=e.read_shift(1);return s&2&&(r.l="1"),s&8&&(r.a="1"),r}var _o=1024;function zb(e,r){for(var t=[21600,21600],s=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),a=[Ye("xml",null,{"xmlns:v":ss.v,"xmlns:o":ss.o,"xmlns:x":ss.x,"xmlns:mv":ss.mv}).replace(/\/>/,">"),Ye("o:shapelayout",Ye("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ye("v:shapetype",[Ye("v:stroke",null,{joinstyle:"miter"}),Ye("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:s})];_o<e*1e3;)_o+=1e3;return r.forEach(function(o){var c=Xr(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var p=u.type=="gradient"?Ye("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ye("v:fill",p,u),x={on:"t",obscured:"t"};++_o,a=a.concat(["<v:shape"+ac({id:"_x0000_s"+_o,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ye("v:shadow",null,x),Ye("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",an("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),an("x:AutoFill","False"),an("x:Row",String(c.r)),an("x:Column",String(c.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Wb(e){var r=[Br,Ye("comments",null,{xmlns:Yo[0]})],t=[];return r.push("<authors>"),e.forEach(function(s){s[1].forEach(function(a){var o=ar(a.a);t.indexOf(o)==-1&&(t.push(o),r.push("<author>"+o+"</author>")),a.T&&a.ID&&t.indexOf("tc="+a.ID)==-1&&(t.push("tc="+a.ID),r.push("<author>tc="+a.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(s){var a=0,o=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?a=t.indexOf("tc="+s[1][0].ID):s[1].forEach(function(p){p.a&&(a=t.indexOf(ar(p.a))),o.push(p.t||"")}),r.push('<comment ref="'+s[0]+'" authorId="'+a+'"><text>'),o.length<=1)r.push(an("t",ar(o[0]||"")));else{for(var c=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)c+=`Reply:
    `+o[u]+`
`;r.push(an("t",ar(c)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function eI(e,r,t){var s=[Br,Ye("ThreadedComments",null,{xmlns:Kr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var o="";(a[1]||[]).forEach(function(c,u){if(!c.T){delete c.ID;return}c.a&&r.indexOf(c.a)==-1&&r.push(c.a);var p={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};u==0?o=p.id:p.parentId=o,c.ID=p.id,c.a&&(p.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(c.a)).slice(-12)+"}"),s.push(Ye("threadedComment",an("text",c.t||""),p))})}),s.push("</ThreadedComments>"),s.join("")}function tI(e){var r=[Br,Ye("personList",null,{xmlns:Kr.TCMNT,"xmlns:x":Yo[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,s){r.push(Ye("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}function rI(e){var r={};r.iauthor=e.read_shift(4);var t=Hi(e);return r.rfx=t.s,r.ref=ir(t.s),e.l+=16,r}function nI(e,r){return r==null&&(r=Pe(36)),r.write_shift(4,e[1].iauthor),Xo(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var sI=vn;function aI(e){return Jr(e.slice(0,54))}function iI(e){var r=$n(),t=[];return Ie(r,628),Ie(r,630),e.forEach(function(s){s[1].forEach(function(a){t.indexOf(a.a)>-1||(t.push(a.a.slice(0,54)),Ie(r,632,aI(a.a)))})}),Ie(r,631),Ie(r,633),e.forEach(function(s){s[1].forEach(function(a){a.iauthor=t.indexOf(a.a);var o={s:Xr(s[0]),e:Xr(s[0])};Ie(r,635,nI([o,a])),a.t&&a.t.length>0&&Ie(r,637,l9(a)),Ie(r,636),delete a.iauthor})}),Ie(r,634),Ie(r,629),r.end()}function oI(e,r){r.FullPaths.forEach(function(t,s){if(s!=0){var a=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&dr.utils.cfb_add(e,a,r.FileIndex[s].content)}})}var qb=["xlsb","xlsm","xlam","biff8","xla"],lI=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(s,a,o,c){var u=!1,p=!1;o.length==0?p=!0:o.charAt(0)=="["&&(p=!0,o=o.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,x=c.length>0?parseInt(c,10)|0:0;return u?x+=r.c:--x,p?h+=r.r:--h,a+(u?"":"$")+yn(x)+(p?"":"$")+on(h)}return function(a,o){return r=o,a.replace(e,t)}})(),Pm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Rm=(function(){return function(r,t){return r.replace(Pm,function(s,a,o,c,u,p){var h=_m(c)-(o?0:t.c),x=km(p)-(u?0:t.r),y=x==0?"":u?x+1:"["+x+"]",v=h==0?"":o?h+1:"["+h+"]";return a+"R"+y+"C"+v})}})();function cI(e,r){return e.replace(Pm,function(t,s,a,o,c,u){return s+(a=="$"?a+o:yn(_m(o)+r.c))+(c=="$"?c+u:on(km(u)+r.r))})}function dI(e){return e.length!=1}function Lr(e){e.l+=1}function ai(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function Vb(e,r,t){var s=2;if(t){if(t.biff>=2&&t.biff<=5)return Qb(e);t.biff==12&&(s=4)}var a=e.read_shift(s),o=e.read_shift(s),c=ai(e),u=ai(e);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function Qb(e){var r=ai(e),t=ai(e),s=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:s,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function uI(e,r,t){if(t.biff<8)return Qb(e);var s=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),o=ai(e),c=ai(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function Hb(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return fI(e);var s=e.read_shift(t&&t.biff==12?4:2),a=ai(e);return{r:s,c:a[0],cRel:a[1],rRel:a[2]}}function fI(e){var r=ai(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function hI(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function pI(e,r,t){var s=t&&t.biff?t.biff:8;if(s>=2&&s<=5)return mI(e);var a=e.read_shift(s>=12?4:2),o=e.read_shift(2),c=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(c==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:c,rRel:u}}function mI(e){var r=e.read_shift(2),t=e.read_shift(1),s=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,s==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:s}}function xI(e,r,t){var s=(e[e.l++]&96)>>5,a=Vb(e,t.biff>=2&&t.biff<=5?6:8,t);return[s,a]}function gI(e,r,t){var s=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var c=Vb(e,o,t);return[s,a,c]}function yI(e,r,t){var s=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[s]}function vI(e,r,t){var s=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[s,a]}function wI(e,r,t){var s=(e[e.l++]&96)>>5,a=uI(e,r-1,t);return[s,a]}function NI(e,r,t){var s=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[s]}function u1(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function SI(e,r,t){e.l+=2;for(var s=e.read_shift(t&&t.biff==2?1:2),a=[],o=0;o<=s;++o)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function bI(e,r,t){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(t&&t.biff==2?1:2)]}function jI(e,r,t){var s=e[e.l+1]&255?1:0;return e.l+=2,[s,e.read_shift(t&&t.biff==2?1:2)]}function kI(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function _I(e,r,t){var s=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[s]}function Gb(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function CI(e){return e.read_shift(2),Gb(e)}function EI(e){return e.read_shift(2),Gb(e)}function AI(e,r,t){var s=(e[e.l]&96)>>5;e.l+=1;var a=Hb(e,0,t);return[s,a]}function TI(e,r,t){var s=(e[e.l]&96)>>5;e.l+=1;var a=pI(e,0,t);return[s,a]}function OI(e,r,t){var s=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=Hb(e,0,t);return[s,a,o]}function PI(e,r,t){var s=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[P8[a],Xb[a],s]}function RI(e,r,t){var s=e[e.l++],a=e.read_shift(1),o=t&&t.biff<=3?[s==88?-1:0,e.read_shift(1)]:DI(e);return[a,(o[0]===0?Xb:O8)[o[1]]]}function DI(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function FI(e,r,t){e.l+=t&&t.biff==2?3:4}function MI(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var s=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[s,a]}function LI(e){return e.l++,Oc[e.read_shift(1)]}function II(e){return e.l++,e.read_shift(2)}function BI(e){return e.l++,e.read_shift(1)!==0}function $I(e){return e.l++,Jo(e)}function UI(e,r,t){return e.l++,Tb(e,r-1,t)}function zI(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=O9(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=Oc[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Jo(e);break;case 2:t[1]=F9(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function WI(e,r,t){for(var s=e.read_shift(t.biff==12?4:2),a=[],o=0;o!=s;++o)a.push((t.biff==12?Hi:I9)(e));return a}function qI(e,r,t){var s=0,a=0;t.biff==12?(s=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),s=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--s,--a==0&&(a=256));for(var o=0,c=[];o!=s&&(c[o]=[]);++o)for(var u=0;u!=a;++u)c[o][u]=zI(e,t.biff);return c}function VI(e,r,t){var s=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,o=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[s,0,o]}function QI(e,r,t){if(t.biff==5)return HI(e);var s=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[s,a,o]}function HI(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var s=e.read_shift(2);return e.l+=12,[r,t,s]}function GI(e,r,t){var s=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[s,a]}function YI(e,r,t){var s=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[s,a]}function KI(e,r,t){var s=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[s]}function XI(e,r,t){var s=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[s,a]}var JI=na,ZI=na,e8=na;function Pc(e,r,t){return e.l+=2,[hI(e)]}function Dm(e){return e.l+=6,[]}var t8=Pc,r8=Dm,n8=Dm,s8=Pc;function Yb(e){return e.l+=2,[Eb(e),e.read_shift(2)&1]}var a8=Pc,i8=Yb,o8=Dm,l8=Pc,c8=Pc,d8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function u8(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),s=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),c=d8[t>>2&31];return{ixti:r,coltype:t&3,rt:c,idx:s,c:a,C:o}}function f8(e){return e.l+=2,[e.read_shift(4)]}function h8(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function p8(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function m8(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function x8(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function g8(e){return e.l+=4,[0,0]}var f1={1:{n:"PtgExp",f:MI},2:{n:"PtgTbl",f:e8},3:{n:"PtgAdd",f:Lr},4:{n:"PtgSub",f:Lr},5:{n:"PtgMul",f:Lr},6:{n:"PtgDiv",f:Lr},7:{n:"PtgPower",f:Lr},8:{n:"PtgConcat",f:Lr},9:{n:"PtgLt",f:Lr},10:{n:"PtgLe",f:Lr},11:{n:"PtgEq",f:Lr},12:{n:"PtgGe",f:Lr},13:{n:"PtgGt",f:Lr},14:{n:"PtgNe",f:Lr},15:{n:"PtgIsect",f:Lr},16:{n:"PtgUnion",f:Lr},17:{n:"PtgRange",f:Lr},18:{n:"PtgUplus",f:Lr},19:{n:"PtgUminus",f:Lr},20:{n:"PtgPercent",f:Lr},21:{n:"PtgParen",f:Lr},22:{n:"PtgMissArg",f:Lr},23:{n:"PtgStr",f:UI},26:{n:"PtgSheet",f:h8},27:{n:"PtgEndSheet",f:p8},28:{n:"PtgErr",f:LI},29:{n:"PtgBool",f:BI},30:{n:"PtgInt",f:II},31:{n:"PtgNum",f:$I},32:{n:"PtgArray",f:NI},33:{n:"PtgFunc",f:PI},34:{n:"PtgFuncVar",f:RI},35:{n:"PtgName",f:VI},36:{n:"PtgRef",f:AI},37:{n:"PtgArea",f:xI},38:{n:"PtgMemArea",f:GI},39:{n:"PtgMemErr",f:JI},40:{n:"PtgMemNoMem",f:ZI},41:{n:"PtgMemFunc",f:YI},42:{n:"PtgRefErr",f:KI},43:{n:"PtgAreaErr",f:yI},44:{n:"PtgRefN",f:TI},45:{n:"PtgAreaN",f:wI},46:{n:"PtgMemAreaN",f:m8},47:{n:"PtgMemNoMemN",f:x8},57:{n:"PtgNameX",f:QI},58:{n:"PtgRef3d",f:OI},59:{n:"PtgArea3d",f:gI},60:{n:"PtgRefErr3d",f:XI},61:{n:"PtgAreaErr3d",f:vI},255:{}},y8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},v8={1:{n:"PtgElfLel",f:Yb},2:{n:"PtgElfRw",f:l8},3:{n:"PtgElfCol",f:t8},6:{n:"PtgElfRwV",f:c8},7:{n:"PtgElfColV",f:s8},10:{n:"PtgElfRadical",f:a8},11:{n:"PtgElfRadicalS",f:o8},13:{n:"PtgElfColS",f:r8},15:{n:"PtgElfColSV",f:n8},16:{n:"PtgElfRadicalLel",f:i8},25:{n:"PtgList",f:u8},29:{n:"PtgSxName",f:f8},255:{}},w8={0:{n:"PtgAttrNoop",f:g8},1:{n:"PtgAttrSemi",f:_I},2:{n:"PtgAttrIf",f:jI},4:{n:"PtgAttrChoose",f:SI},8:{n:"PtgAttrGoto",f:bI},16:{n:"PtgAttrSum",f:FI},32:{n:"PtgAttrBaxcel",f:u1},33:{n:"PtgAttrBaxcel",f:u1},64:{n:"PtgAttrSpace",f:CI},65:{n:"PtgAttrSpaceSemi",f:EI},128:{n:"PtgAttrIfError",f:kI},255:{}};function N8(e,r,t,s){if(s.biff<8)return na(e,r);for(var a=e.l+r,o=[],c=0;c!==t.length;++c)switch(t[c][0]){case"PtgArray":t[c][1]=qI(e,0,s),o.push(t[c][1]);break;case"PtgMemArea":t[c][2]=WI(e,t[c][1],s),o.push(t[c][2]);break;case"PtgExp":s&&s.biff==12&&(t[c][1][1]=e.read_shift(4),o.push(t[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[c][0]}return r=a-e.l,r!==0&&o.push(na(e,r)),o}function S8(e,r,t){for(var s=e.l+r,a,o,c=[];s!=e.l;)r=s-e.l,o=e[e.l],a=f1[o]||f1[y8[o]],(o===24||o===25)&&(a=(o===24?v8:w8)[e[e.l+1]]),!a||!a.f?na(e,r):c.push([a.n,a.f(e,r,t)]);return c}function b8(e){for(var r=[],t=0;t<e.length;++t){for(var s=e[t],a=[],o=0;o<s.length;++o){var c=s[o];if(c)switch(c[0]){case 2:a.push('"'+c[1].replace(/"/g,'""')+'"');break;default:a.push(c[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var j8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function k8(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Kb(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var s=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!s)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[s[0]][0]){case 357:return a=s[1]==-1?"#REF":e.SheetNames[s[1]],s[1]==s[2]?a:a+":"+e.SheetNames[s[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[s[0]][0];case 355:default:return"SH33TJSSRC"+e[s[0]][0]}switch(e[s[0]][0][0]){case 1025:return a=s[1]==-1?"#REF":e.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?a:a+":"+e.SheetNames[s[2]];case 14849:return e[s[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[s[0]][0][3]?(a=s[1]==-1?"#REF":e[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?a:a+":"+e[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function h1(e,r,t){var s=Kb(e,r,t);return s=="#REF"?s:k8(s,t)}function Lo(e,r,t,s,a){var o=a&&a.biff||8,c={s:{c:0,r:0}},u=[],p,h,x,y=0,v=0,k,b="";if(!e[0]||!e[0][0])return"";for(var w=-1,j="",O=0,T=e[0].length;O<T;++O){var F=e[0][O];switch(F[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(p=u.pop(),h=u.pop(),w>=0){switch(e[0][w][1][0]){case 0:j=Tr(" ",e[0][w][1][1]);break;case 1:j=Tr("\r",e[0][w][1][1]);break;default:if(j="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}h=h+j,w=-1}u.push(h+j8[F[0]]+p);break;case"PtgIsect":p=u.pop(),h=u.pop(),u.push(h+" "+p);break;case"PtgUnion":p=u.pop(),h=u.pop(),u.push(h+","+p);break;case"PtgRange":p=u.pop(),h=u.pop(),u.push(h+":"+p);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=Ql(F[1][1],c,a),u.push(Hl(x,o));break;case"PtgRefN":x=t?Ql(F[1][1],t,a):F[1][1],u.push(Hl(x,o));break;case"PtgRef3d":y=F[1][1],x=Ql(F[1][2],c,a),b=h1(s,y,a),u.push(b+"!"+Hl(x,o));break;case"PtgFunc":case"PtgFuncVar":var I=F[1][0],G=F[1][1];I||(I=0),I&=127;var B=I==0?[]:u.slice(-I);u.length-=I,G==="User"&&(G=B.shift()),u.push(G+"("+B.join(",")+")");break;case"PtgBool":u.push(F[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(F[1]);break;case"PtgNum":u.push(String(F[1]));break;case"PtgStr":u.push('"'+F[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(F[1]);break;case"PtgAreaN":k=Xv(F[1][1],t?{s:t}:c,a),u.push(Rh(k,a));break;case"PtgArea":k=Xv(F[1][1],c,a),u.push(Rh(k,a));break;case"PtgArea3d":y=F[1][1],k=F[1][2],b=h1(s,y,a),u.push(b+"!"+Rh(k,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=F[1][2];var Q=(s.names||[])[v-1]||(s[0]||[])[v],z=Q?Q.Name:"SH33TJSNAME"+String(v);z&&z.slice(0,6)=="_xlfn."&&!a.xlfn&&(z=z.slice(6)),u.push(z);break;case"PtgNameX":var J=F[1][1];v=F[1][2];var ne;if(a.biff<=5)J<0&&(J=-J),s[J]&&(ne=s[J][v]);else{var fe="";if(((s[J]||[])[0]||[])[0]==14849||(((s[J]||[])[0]||[])[0]==1025?s[J][v]&&s[J][v].itab>0&&(fe=s.SheetNames[s[J][v].itab-1]+"!"):fe=s.SheetNames[v-1]+"!"),s[J]&&s[J][v])fe+=s[J][v].Name;else if(s[0]&&s[0][v])fe+=s[0][v].Name;else{var me=(Kb(s,J,a)||"").split(";;");me[v-1]?fe=me[v-1]:fe+="SH33TJSERRX"}u.push(fe);break}ne||(ne={Name:"SH33TJSERRY"}),u.push(ne.Name);break;case"PtgParen":var le="(",K=")";if(w>=0){switch(j="",e[0][w][1][0]){case 2:le=Tr(" ",e[0][w][1][1])+le;break;case 3:le=Tr("\r",e[0][w][1][1])+le;break;case 4:K=Tr(" ",e[0][w][1][1])+K;break;case 5:K=Tr("\r",e[0][w][1][1])+K;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}u.push(le+u.pop()+K);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":x={c:F[1][1],r:F[1][0]};var Fe={c:t.c,r:t.r};if(s.sharedf[ir(x)]){var we=s.sharedf[ir(x)];u.push(Lo(we,c,Fe,s,a))}else{var oe=!1;for(p=0;p!=s.arrayf.length;++p)if(h=s.arrayf[p],!(x.c<h[0].s.c||x.c>h[0].e.c)&&!(x.r<h[0].s.r||x.r>h[0].e.r)){u.push(Lo(h[1],c,Fe,s,a)),oe=!0;break}oe||u.push(F[1])}break;case"PtgArray":u.push("{"+b8(F[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=O;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+F[1].idx+"[#"+F[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(F));default:throw new Error("Unrecognized Formula Token: "+String(F))}var V=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&V.indexOf(e[0][O][0])==-1){F=e[0][w];var de=!0;switch(F[1][0]){case 4:de=!1;case 0:j=Tr(" ",F[1][1]);break;case 5:de=!1;case 1:j=Tr("\r",F[1][1]);break;default:if(j="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+F[1][0])}u.push((de?j:"")+u.pop()+(de?"":j)),w=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function _8(e){if(e==null){var r=Pe(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof e=="number")return Bi(e);return Bi(0)}function C8(e,r,t,s,a){var o=$i(r,t,a),c=_8(e.v),u=Pe(6),p=33;u.write_shift(2,p),u.write_shift(4,0);for(var h=Pe(e.bf.length),x=0;x<e.bf.length;++x)h[x]=e.bf[x];var y=sn([o,c,u,h]);return y}function g0(e,r,t){var s=e.read_shift(4),a=S8(e,s,t),o=e.read_shift(4),c=o>0?N8(e,o,a,t):null;return[a,c]}var E8=g0,y0=g0,A8=g0,T8=g0,O8={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Xb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},P8={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function R8(e){var r="of:="+e.replace(Pm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function D8(e){return e.replace(/\./,"!")}var Gl=typeof Map<"u";function Fm(e,r,t){var s=0,a=e.length;if(t){if(Gl?t.has(r):Object.prototype.hasOwnProperty.call(t,r)){for(var o=Gl?t.get(r):t[r];s<o.length;++s)if(e[o[s]].t===r)return e.Count++,o[s]}}else for(;s<a;++s)if(e[s].t===r)return e.Count++,s;return e[a]={t:r},e.Count++,e.Unique++,t&&(Gl?(t.has(r)||t.set(r,[]),t.get(r).push(a)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(a))),a}function v0(e,r){var t={min:e+1,max:e+1},s=-1;return r.MDW&&(wa=r.MDW),r.width!=null?t.customWidth=1:r.wpx!=null?s=Mu(r.wpx):r.wch!=null&&(s=r.wch),s>-1?(t.width=pp(s),t.customWidth=1):r.width!=null&&(t.width=r.width),r.hidden&&(t.hidden=!0),r.level!=null&&(t.outlineLevel=t.level=r.level),t}function Jb(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function ui(e,r,t){var s=t.revssf[r.z!=null?r.z:"General"],a=60,o=e.length;if(s==null&&t.ssf){for(;a<392;++a)if(t.ssf[a]==null){HS(r.z,a),t.ssf[a]=r.z,t.revssf[r.z]=s=a;break}}for(a=0;a!=o;++a)if(e[a].numFmtId===s)return a;return e[o]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function F8(e,r,t){if(e&&e["!ref"]){var s=wr(e["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}function M8(e){if(e.length===0)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+Ir(e[t])+'"/>';return r+"</mergeCells>"}function L8(e,r,t,s,a){var o=!1,c={},u=null;if(s.bookType!=="xlsx"&&r.vbaraw){var p=r.SheetNames[t];try{r.Workbook&&(p=r.Workbook.Sheets[t].CodeName||p)}catch{}o=!0,c.codeName=sc(ar(p))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),u=(u||"")+Ye("outlinePr",null,h)}!o&&!u||(a[a.length]=Ye("sheetPr",u,c))}var I8=["objects","scenarios","selectLockedCells","selectUnlockedCells"],B8=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function $8(e){var r={sheet:1};return I8.forEach(function(t){e[t]!=null&&e[t]&&(r[t]="1")}),B8.forEach(function(t){e[t]!=null&&!e[t]&&(r[t]="0")}),e.password&&(r.password=Fb(e.password).toString(16).toUpperCase()),Ye("sheetProtection",null,r)}function U8(e){return Jb(e),Ye("pageMargins",null,e)}function z8(e,r){for(var t=["<cols>"],s,a=0;a!=r.length;++a)(s=r[a])&&(t[t.length]=Ye("col",null,v0(a,s)));return t[t.length]="</cols>",t.join("")}function W8(e,r,t,s){var a=typeof e.ref=="string"?e.ref:Ir(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,c=ls(a);c.s.r==c.e.r&&(c.e.r=ls(r["!ref"]).e.r,a=Ir(c));for(var u=0;u<o.length;++u){var p=o[u];if(p.Name=="_xlnm._FilterDatabase"&&p.Sheet==s){p.Ref="'"+t.SheetNames[s]+"'!"+a;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+a}),Ye("autoFilter",null,{ref:a})}function q8(e,r,t,s){var a={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Ye("sheetViews",Ye("sheetView",null,a),{})}function V8(e,r,t,s){if(e.c&&t["!comments"].push([r,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",o=e.t,c=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Oc[e.v];break;case"d":s&&s.cellDates?a=kn(e.v,-1).toISOString():(e=zn(e),e.t="n",a=""+(e.v=Un(kn(e.v)))),typeof e.z>"u"&&(e.z=Or[14]);break;default:a=e.v;break}var u=an("v",ar(a)),p={r},h=ui(s.cellXfs,e,s);switch(h!==0&&(p.s=h),e.t){case"n":break;case"d":p.t="d";break;case"b":p.t="b";break;case"e":p.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){u=an("v",""+Fm(s.Strings,e.v,s.revStrings)),p.t="s";break}p.t="str";break}if(e.t!=o&&(e.t=o,e.v=c),typeof e.f=="string"&&e.f){var x=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;u=Ye("f",ar(e.f),x)+(e.v!=null?u:"")}return e.l&&t["!links"].push([r,e.l]),e.D&&(p.cm=1),Ye("c",u,p)}function Q8(e,r,t,s){var a=[],o=[],c=wr(e["!ref"]),u="",p,h="",x=[],y=0,v=0,k=e["!rows"],b=Array.isArray(e),w={r:h},j,O=-1;for(v=c.s.c;v<=c.e.c;++v)x[v]=yn(v);for(y=c.s.r;y<=c.e.r;++y){for(o=[],h=on(y),v=c.s.c;v<=c.e.c;++v){p=x[v]+h;var T=b?(e[y]||[])[v]:e[p];T!==void 0&&(u=V8(T,p,e,r))!=null&&o.push(u)}(o.length>0||k&&k[y])&&(w={r:h},k&&k[y]&&(j=k[y],j.hidden&&(w.hidden=1),O=-1,j.hpx?O=Lu(j.hpx):j.hpt&&(O=j.hpt),O>-1&&(w.ht=O,w.customHeight=1),j.level&&(w.outlineLevel=j.level)),a[a.length]=Ye("row",o.join(""),w))}if(k)for(;y<k.length;++y)k&&k[y]&&(w={r:y+1},j=k[y],j.hidden&&(w.hidden=1),O=-1,j.hpx?O=Lu(j.hpx):j.hpt&&(O=j.hpt),O>-1&&(w.ht=O,w.customHeight=1),j.level&&(w.outlineLevel=j.level),a[a.length]=Ye("row","",w));return a.join("")}function Zb(e,r,t,s){var a=[Br,Ye("worksheet",null,{xmlns:Yo[0],"xmlns:r":Kr.r})],o=t.SheetNames[e],c=0,u="",p=t.Sheets[o];p==null&&(p={});var h=p["!ref"]||"A1",x=wr(h);if(x.e.c>16383||x.e.r>1048575){if(r.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575),h=Ir(x)}s||(s={}),p["!comments"]=[];var y=[];L8(p,t,e,r,a),a[a.length]=Ye("dimension",null,{ref:h}),a[a.length]=q8(p,r,e,t),r.sheetFormat&&(a[a.length]=Ye("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),p["!cols"]!=null&&p["!cols"].length>0&&(a[a.length]=z8(p,p["!cols"])),a[c=a.length]="<sheetData/>",p["!links"]=[],p["!ref"]!=null&&(u=Q8(p,r),u.length>0&&(a[a.length]=u)),a.length>c+1&&(a[a.length]="</sheetData>",a[c]=a[c].replace("/>",">")),p["!protect"]&&(a[a.length]=$8(p["!protect"])),p["!autofilter"]!=null&&(a[a.length]=W8(p["!autofilter"],p,t,e)),p["!merges"]!=null&&p["!merges"].length>0&&(a[a.length]=M8(p["!merges"]));var v=-1,k,b=-1;return p["!links"].length>0&&(a[a.length]="<hyperlinks>",p["!links"].forEach(function(w){w[1].Target&&(k={ref:w[0]},w[1].Target.charAt(0)!="#"&&(b=nr(s,-1,ar(w[1].Target).replace(/#.*$/,""),Kt.HLINK),k["r:id"]="rId"+b),(v=w[1].Target.indexOf("#"))>-1&&(k.location=ar(w[1].Target.slice(v+1))),w[1].Tooltip&&(k.tooltip=ar(w[1].Tooltip)),a[a.length]=Ye("hyperlink",null,k))}),a[a.length]="</hyperlinks>"),delete p["!links"],p["!margins"]!=null&&(a[a.length]=U8(p["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(a[a.length]=an("ignoredErrors",Ye("ignoredError",null,{numberStoredAsText:1,sqref:h}))),y.length>0&&(b=nr(s,-1,"../drawings/drawing"+(e+1)+".xml",Kt.DRAW),a[a.length]=Ye("drawing",null,{"r:id":"rId"+b}),p["!drawing"]=y),p["!comments"].length>0&&(b=nr(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Kt.VML),a[a.length]=Ye("legacyDrawing",null,{"r:id":"rId"+b}),p["!legacy"]=b),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function H8(e,r){var t={},s=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=s,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=a/20),t}function G8(e,r,t){var s=Pe(145),a=(t["!rows"]||[])[e]||{};s.write_shift(4,e),s.write_shift(4,0);var o=320;a.hpx?o=Lu(a.hpx)*20:a.hpt&&(o=a.hpt*20),s.write_shift(2,o),s.write_shift(1,0);var c=0;a.level&&(c|=a.level),a.hidden&&(c|=16),(a.hpx||a.hpt)&&(c|=32),s.write_shift(1,c),s.write_shift(1,0);var u=0,p=s.l;s.l+=4;for(var h={r:e,c:0},x=0;x<16;++x)if(!(r.s.c>x+1<<10||r.e.c<x<<10)){for(var y=-1,v=-1,k=x<<10;k<x+1<<10;++k){h.c=k;var b=Array.isArray(t)?(t[h.r]||[])[h.c]:t[ir(h)];b&&(y<0&&(y=k),v=k)}y<0||(++u,s.write_shift(4,y),s.write_shift(4,v))}var w=s.l;return s.l=p,s.write_shift(4,u),s.l=w,s.length>s.l?s.slice(0,s.l):s}function Y8(e,r,t,s){var a=G8(s,t,r);(a.length>17||(r["!rows"]||[])[s])&&Ie(e,0,a)}var K8=Hi,X8=Xo;function J8(){}function Z8(e,r){var t={},s=e[e.l];return++e.l,t.above=!(s&64),t.left=!(s&128),e.l+=18,t.name=c9(e),t}function e7(e,r,t){t==null&&(t=Pe(84+4*e.length));var s=192;r&&(r.above&&(s&=-65),r.left&&(s&=-129)),t.write_shift(1,s);for(var a=1;a<3;++a)t.write_shift(1,0);return Ru({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),pb(e,t),t.slice(0,t.l)}function t7(e){var r=ys(e);return[r]}function r7(e,r,t){return t==null&&(t=Pe(8)),qi(r,t)}function n7(e){var r=Vi(e);return[r]}function s7(e,r,t){return t==null&&(t=Pe(4)),Qi(r,t)}function a7(e){var r=ys(e),t=e.read_shift(1);return[r,t,"b"]}function i7(e,r,t){return t==null&&(t=Pe(9)),qi(r,t),t.write_shift(1,e.v?1:0),t}function o7(e){var r=Vi(e),t=e.read_shift(1);return[r,t,"b"]}function l7(e,r,t){return t==null&&(t=Pe(5)),Qi(r,t),t.write_shift(1,e.v?1:0),t}function c7(e){var r=ys(e),t=e.read_shift(1);return[r,t,"e"]}function d7(e,r,t){return t==null&&(t=Pe(9)),qi(r,t),t.write_shift(1,e.v),t}function u7(e){var r=Vi(e),t=e.read_shift(1);return[r,t,"e"]}function f7(e,r,t){return t==null&&(t=Pe(8)),Qi(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function h7(e){var r=ys(e),t=e.read_shift(4);return[r,t,"s"]}function p7(e,r,t){return t==null&&(t=Pe(12)),qi(r,t),t.write_shift(4,r.v),t}function m7(e){var r=Vi(e),t=e.read_shift(4);return[r,t,"s"]}function x7(e,r,t){return t==null&&(t=Pe(8)),Qi(r,t),t.write_shift(4,r.v),t}function g7(e){var r=ys(e),t=Jo(e);return[r,t,"n"]}function y7(e,r,t){return t==null&&(t=Pe(16)),qi(r,t),Bi(e.v,t),t}function v7(e){var r=Vi(e),t=Jo(e);return[r,t,"n"]}function w7(e,r,t){return t==null&&(t=Pe(12)),Qi(r,t),Bi(e.v,t),t}function N7(e){var r=ys(e),t=mb(e);return[r,t,"n"]}function S7(e,r,t){return t==null&&(t=Pe(12)),qi(r,t),xb(e.v,t),t}function b7(e){var r=Vi(e),t=mb(e);return[r,t,"n"]}function j7(e,r,t){return t==null&&(t=Pe(8)),Qi(r,t),xb(e.v,t),t}function k7(e){var r=ys(e),t=Cm(e);return[r,t,"is"]}function _7(e){var r=ys(e),t=vn(e);return[r,t,"str"]}function C7(e,r,t){return t==null&&(t=Pe(12+4*e.v.length)),qi(r,t),Jr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function E7(e){var r=Vi(e),t=vn(e);return[r,t,"str"]}function A7(e,r,t){return t==null&&(t=Pe(8+4*e.v.length)),Qi(r,t),Jr(e.v,t),t.length>t.l?t.slice(0,t.l):t}function T7(e,r,t){var s=e.l+r,a=ys(e);a.r=t["!row"];var o=e.read_shift(1),c=[a,o,"b"];if(t.cellFormula){e.l+=2;var u=y0(e,s-e.l,t);c[3]=Lo(u,null,a,t.supbooks,t)}else e.l=s;return c}function O7(e,r,t){var s=e.l+r,a=ys(e);a.r=t["!row"];var o=e.read_shift(1),c=[a,o,"e"];if(t.cellFormula){e.l+=2;var u=y0(e,s-e.l,t);c[3]=Lo(u,null,a,t.supbooks,t)}else e.l=s;return c}function P7(e,r,t){var s=e.l+r,a=ys(e);a.r=t["!row"];var o=Jo(e),c=[a,o,"n"];if(t.cellFormula){e.l+=2;var u=y0(e,s-e.l,t);c[3]=Lo(u,null,a,t.supbooks,t)}else e.l=s;return c}function R7(e,r,t){var s=e.l+r,a=ys(e);a.r=t["!row"];var o=vn(e),c=[a,o,"str"];if(t.cellFormula){e.l+=2;var u=y0(e,s-e.l,t);c[3]=Lo(u,null,a,t.supbooks,t)}else e.l=s;return c}var D7=Hi,F7=Xo;function M7(e,r){return r==null&&(r=Pe(4)),r.write_shift(4,e),r}function L7(e,r){var t=e.l+r,s=Hi(e),a=Em(e),o=vn(e),c=vn(e),u=vn(e);e.l=t;var p={rfx:s,relId:a,loc:o,display:u};return c&&(p.Tooltip=c),p}function I7(e,r){var t=Pe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Xo({s:Xr(e[0]),e:Xr(e[0])},t),Am("rId"+r,t);var s=e[1].Target.indexOf("#"),a=s==-1?"":e[1].Target.slice(s+1);return Jr(a||"",t),Jr(e[1].Tooltip||"",t),Jr("",t),t.slice(0,t.l)}function B7(){}function $7(e,r,t){var s=e.l+r,a=gb(e),o=e.read_shift(1),c=[a];if(c[2]=o,t.cellFormula){var u=E8(e,s-e.l,t);c[1]=u}else e.l=s;return c}function U7(e,r,t){var s=e.l+r,a=Hi(e),o=[a];if(t.cellFormula){var c=T8(e,s-e.l,t);o[1]=c,e.l=s}else e.l=s;return o}function z7(e,r,t){t==null&&(t=Pe(18));var s=v0(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,(s.width||10)*256),t.write_shift(4,0);var a=0;return r.hidden&&(a|=1),typeof s.width=="number"&&(a|=2),r.level&&(a|=r.level<<8),t.write_shift(2,a),t}var ej=["left","right","top","bottom","header","footer"];function W7(e){var r={};return ej.forEach(function(t){r[t]=Jo(e)}),r}function q7(e,r){return r==null&&(r=Pe(48)),Jb(e),ej.forEach(function(t){Bi(e[t],r)}),r}function V7(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function Q7(e,r,t){t==null&&(t=Pe(30));var s=924;return(((r||{}).Views||[])[0]||{}).RTL&&(s|=32),t.write_shift(2,s),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function H7(e){var r=Pe(24);return r.write_shift(4,4),r.write_shift(4,1),Xo(e,r),r}function G7(e,r){return r==null&&(r=Pe(66)),r.write_shift(2,e.password?Fb(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?r.write_shift(4,e[t[0]]!=null&&!e[t[0]]?1:0):r.write_shift(4,e[t[0]]!=null&&e[t[0]]?0:1)}),r}function Y7(){}function K7(){}function X7(e,r,t,s,a,o,c){if(r.v===void 0)return!1;var u="";switch(r.t){case"b":u=r.v?"1":"0";break;case"d":r=zn(r),r.z=r.z||Or[14],r.v=Un(kn(r.v)),r.t="n";break;case"n":case"e":u=""+r.v;break;default:u=r.v;break}var p={r:t,c:s};switch(p.s=ui(a.cellXfs,r,a),r.l&&o["!links"].push([ir(p),r.l]),r.c&&o["!comments"].push([ir(p),r.c]),r.t){case"s":case"str":return a.bookSST?(u=Fm(a.Strings,r.v,a.revStrings),p.t="s",p.v=u,c?Ie(e,18,x7(r,p)):Ie(e,7,p7(r,p))):(p.t="str",c?Ie(e,17,A7(r,p)):Ie(e,6,C7(r,p))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?c?Ie(e,13,j7(r,p)):Ie(e,2,S7(r,p)):c?Ie(e,16,w7(r,p)):Ie(e,5,y7(r,p)),!0;case"b":return p.t="b",c?Ie(e,15,l7(r,p)):Ie(e,4,i7(r,p)),!0;case"e":return p.t="e",c?Ie(e,14,f7(r,p)):Ie(e,3,d7(r,p)),!0}return c?Ie(e,12,s7(r,p)):Ie(e,1,r7(r,p)),!0}function J7(e,r,t,s){var a=wr(r["!ref"]||"A1"),o,c="",u=[];Ie(e,145);var p=Array.isArray(r),h=a.e.r;r["!rows"]&&(h=Math.max(a.e.r,r["!rows"].length-1));for(var x=a.s.r;x<=h;++x){c=on(x),Y8(e,r,a,x);var y=!1;if(x<=a.e.r)for(var v=a.s.c;v<=a.e.c;++v){x===a.s.r&&(u[v]=yn(v)),o=u[v]+c;var k=p?(r[x]||[])[v]:r[o];if(!k){y=!1;continue}y=X7(e,k,x,v,s,r,y)}}Ie(e,146)}function Z7(e,r){!r||!r["!merges"]||(Ie(e,177,M7(r["!merges"].length)),r["!merges"].forEach(function(t){Ie(e,176,F7(t))}),Ie(e,178))}function eB(e,r){!r||!r["!cols"]||(Ie(e,390),r["!cols"].forEach(function(t,s){t&&Ie(e,60,z7(s,t))}),Ie(e,391))}function tB(e,r){!r||!r["!ref"]||(Ie(e,648),Ie(e,649,H7(wr(r["!ref"]))),Ie(e,650))}function rB(e,r,t){r["!links"].forEach(function(s){if(s[1].Target){var a=nr(t,-1,s[1].Target.replace(/#.*$/,""),Kt.HLINK);Ie(e,494,I7(s,a))}}),delete r["!links"]}function nB(e,r,t,s){if(r["!comments"].length>0){var a=nr(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Kt.VML);Ie(e,551,Am("rId"+a)),r["!legacy"]=a}}function sB(e,r,t,s){if(r["!autofilter"]){var a=r["!autofilter"],o=typeof a.ref=="string"?a.ref:Ir(a.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var c=t.Workbook.Names,u=ls(o);u.s.r==u.e.r&&(u.e.r=ls(r["!ref"]).e.r,o=Ir(u));for(var p=0;p<c.length;++p){var h=c[p];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==s){h.Ref="'"+t.SheetNames[s]+"'!"+o;break}}p==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+t.SheetNames[s]+"'!"+o}),Ie(e,161,Xo(wr(o))),Ie(e,162)}}function aB(e,r,t){Ie(e,133),Ie(e,137,Q7(r,t)),Ie(e,138),Ie(e,134)}function iB(e,r){r["!protect"]&&Ie(e,535,G7(r["!protect"]))}function oB(e,r,t,s){var a=$n(),o=t.SheetNames[e],c=t.Sheets[o]||{},u=o;try{t&&t.Workbook&&(u=t.Workbook.Sheets[e].CodeName||u)}catch{}var p=wr(c["!ref"]||"A1");if(p.e.c>16383||p.e.r>1048575){if(r.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],Ie(a,129),(t.vbaraw||c["!outline"])&&Ie(a,147,e7(u,c["!outline"])),Ie(a,148,X8(p)),aB(a,c,t.Workbook),eB(a,c),J7(a,c,e,r),iB(a,c),sB(a,c,t,e),Z7(a,c),rB(a,c,s),c["!margins"]&&Ie(a,476,q7(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&tB(a,c),nB(a,c,e,s),Ie(a,130),a.end()}function lB(e,r){e.l+=10;var t=vn(e);return{name:t}}var cB=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function dB(e){return!e.Workbook||!e.Workbook.WBProps?"false":UL(e.Workbook.WBProps.date1904)?"true":"false"}var uB="][*?/\\".split("");function tj(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return uB.forEach(function(s){if(e.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function fB(e,r,t){e.forEach(function(s,a){tj(s);for(var o=0;o<a;++o)if(s==e[o])throw new Error("Duplicate Sheet Name: "+s);if(t){var c=r&&r[a]&&r[a].CodeName||s;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function hB(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var r=e.Workbook&&e.Workbook.Sheets||[];fB(e.SheetNames,r,!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)F8(e.Sheets[e.SheetNames[t]],e.SheetNames[t],t)}function rj(e){var r=[Br];r[r.length]=Ye("workbook",null,{xmlns:Yo[0],"xmlns:r":Kr.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(cB.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(s[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(s.codeName=e.Workbook.WBProps.CodeName,delete s.CodeName)),r[r.length]=Ye("workbookPr",null,s);var a=e.Workbook&&e.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(r[r.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==e.SheetNames.length&&(o=0),r[r.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var c={name:ar(e.SheetNames[o].slice(0,31))};if(c.sheetId=""+(o+1),c["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}r[r.length]=Ye("sheet",null,c)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var p={name:u.Name};u.Comment&&(p.comment=u.Comment),u.Sheet!=null&&(p.localSheetId=""+u.Sheet),u.Hidden&&(p.hidden="1"),u.Ref&&(r[r.length]=Ye("definedName",ar(u.Ref),p))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function pB(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=hp(e),t.name=vn(e),t}function mB(e,r){return r||(r=Pe(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),Am(e.strRelID,r),Jr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function xB(e,r){var t={},s=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?vn(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(s&65536),t.backupFile=!!(s&64),t.checkCompatibility=!!(s&4096),t.date1904=!!(s&1),t.filterPrivacy=!!(s&8),t.hidePivotFieldList=!!(s&1024),t.promptedSolutions=!!(s&16),t.publishItems=!!(s&2048),t.refreshAllConnections=!!(s&262144),t.saveExternalLinkValues=!!(s&128),t.showBorderUnselectedTables=!!(s&4),t.showInkAnnotation=!!(s&32),t.showObjects=["all","placeholders","none"][s>>13&3],t.showPivotChartFilter=!!(s&32768),t.updateLinks=["userSet","never","always"][s>>8&3],t}function gB(e,r){r||(r=Pe(72));var t=0;return e&&e.filterPrivacy&&(t|=8),r.write_shift(4,t),r.write_shift(4,0),pb(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function yB(e,r,t){var s=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),o=d9(e),c=A8(e,0,t),u=Em(e);e.l=s;var p={Name:o,Ptg:c};return a<268435455&&(p.Sheet=a),u&&(p.Comment=u),p}function vB(e,r){Ie(e,143);for(var t=0;t!=r.SheetNames.length;++t){var s=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,a={Hidden:s,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]};Ie(e,156,mB(a))}Ie(e,144)}function wB(e,r){r||(r=Pe(127));for(var t=0;t!=4;++t)r.write_shift(4,0);return Jr("SheetJS",r),Jr(ku.version,r),Jr(ku.version,r),Jr("7262",r),r.length>r.l?r.slice(0,r.l):r}function NB(e,r){r||(r=Pe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e);var t=120;return r.write_shift(1,t),r.length>r.l?r.slice(0,r.l):r}function SB(e,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var t=r.Workbook.Sheets,s=0,a=-1,o=-1;s<t.length;++s)!t[s]||!t[s].Hidden&&a==-1?a=s:t[s].Hidden==1&&o==-1&&(o=s);o>a||(Ie(e,135),Ie(e,158,NB(a)),Ie(e,136))}}function bB(e,r){var t=$n();return Ie(t,131),Ie(t,128,wB()),Ie(t,153,gB(e.Workbook&&e.Workbook.WBProps||null)),SB(t,e),vB(t,e),Ie(t,132),t.end()}function jB(e,r,t){return(r.slice(-4)===".bin"?bB:rj)(e)}function kB(e,r,t,s,a){return(r.slice(-4)===".bin"?oB:Zb)(e,t,s,a)}function _B(e,r,t){return(r.slice(-4)===".bin"?q6:Ib)(e,t)}function CB(e,r,t){return(r.slice(-4)===".bin"?g6:Db)(e,t)}function EB(e,r,t){return(r.slice(-4)===".bin"?iI:Wb)(e)}function AB(e){return(e.slice(-4)===".bin"?J6:Ub)()}function TB(e,r){var t=[];return e.Props&&t.push(_9(e.Props,r)),e.Custprops&&t.push(C9(e.Props,e.Custprops)),t.join("")}function OB(){return""}function PB(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(s,a){var o=[];o.push(Ye("NumberFormat",null,{"ss:Format":ar(Or[s.numFmtId])}));var c={"ss:ID":"s"+(21+a)};t.push(Ye("Style",o.join(""),c))}),Ye("Styles",t.join(""))}function nj(e){return Ye("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Rm(e.Ref,{r:0,c:0})})}function RB(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],s=0;s<r.length;++s){var a=r[s];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||t.push(nj(a)))}return Ye("Names",t.join(""))}function DB(e,r,t,s){if(!e||!((s||{}).Workbook||{}).Names)return"";for(var a=s.Workbook.Names,o=[],c=0;c<a.length;++c){var u=a[c];u.Sheet==t&&(u.Name.match(/^_xlfn\./)||o.push(nj(u)))}return o.join("")}function FB(e,r,t,s){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ye("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ye("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ye("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[t])if(s.Workbook.Sheets[t].Hidden)a.push(Ye("Visible",s.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<t&&!(s.Workbook.Sheets[o]&&!s.Workbook.Sheets[o].Hidden);++o);o==t&&a.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(an("ProtectContents","True")),e["!protect"].objects&&a.push(an("ProtectObjects","True")),e["!protect"].scenarios&&a.push(an("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(an("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(an("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){e["!protect"][c[0]]&&a.push("<"+c[1]+"/>")})),a.length==0?"":Ye("WorksheetOptions",a.join(""),{xmlns:ss.x})}function MB(e){return e.map(function(r){var t=$L(r.t||""),s=Ye("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ye("Comment",s,{"ss:Author":r.a})}).join("")}function LB(e,r,t,s,a,o,c){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+ar(Rm(e.f,c))),e.F&&e.F.slice(0,r.length)==r){var p=Xr(e.F.slice(r.length+1));u["ss:ArrayRange"]="RC:R"+(p.r==c.r?"":"["+(p.r-c.r)+"]")+"C"+(p.c==c.c?"":"["+(p.c-c.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=ar(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=ar(e.l.Tooltip))),t["!merges"])for(var h=t["!merges"],x=0;x!=h.length;++x)h[x].s.c!=c.c||h[x].s.r!=c.r||(h[x].e.c>h[x].s.c&&(u["ss:MergeAcross"]=h[x].e.c-h[x].s.c),h[x].e.r>h[x].s.r&&(u["ss:MergeDown"]=h[x].e.r-h[x].s.r));var y="",v="";switch(e.t){case"z":if(!s.sheetStubs)return"";break;case"n":y="Number",v=String(e.v);break;case"b":y="Boolean",v=e.v?"1":"0";break;case"e":y="Error",v=Oc[e.v];break;case"d":y="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Or[14]);break;case"s":y="String",v=BL(e.v||"");break}var k=ui(s.cellXfs,e,s);u["ss:StyleID"]="s"+(21+k),u["ss:Index"]=c.c+1;var b=e.v!=null?v:"",w=e.t=="z"?"":'<Data ss:Type="'+y+'">'+b+"</Data>";return(e.c||[]).length>0&&(w+=MB(e.c)),Ye("Cell",w,u)}function IB(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Lb(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function BB(e,r,t,s){if(!e["!ref"])return"";var a=wr(e["!ref"]),o=e["!merges"]||[],c=0,u=[];e["!cols"]&&e["!cols"].forEach(function(j,O){Om(j);var T=!!j.width,F=v0(O,j),I={"ss:Index":O+1};T&&(I["ss:Width"]=Fu(F.width)),j.hidden&&(I["ss:Hidden"]="1"),u.push(Ye("Column",null,I))});for(var p=Array.isArray(e),h=a.s.r;h<=a.e.r;++h){for(var x=[IB(h,(e["!rows"]||[])[h])],y=a.s.c;y<=a.e.c;++y){var v=!1;for(c=0;c!=o.length;++c)if(!(o[c].s.c>y)&&!(o[c].s.r>h)&&!(o[c].e.c<y)&&!(o[c].e.r<h)){(o[c].s.c!=y||o[c].s.r!=h)&&(v=!0);break}if(!v){var k={r:h,c:y},b=ir(k),w=p?(e[h]||[])[y]:e[b];x.push(LB(w,b,e,r,t,s,k))}}x.push("</Row>"),x.length>2&&u.push(x.join(""))}return u.join("")}function $B(e,r,t){var s=[],a=t.SheetNames[e],o=t.Sheets[a],c=o?DB(o,r,e,t):"";return c.length>0&&s.push("<Names>"+c+"</Names>"),c=o?BB(o,r,e,t):"",c.length>0&&s.push("<Table>"+c+"</Table>"),s.push(FB(o,r,e,t)),s.join("")}function UB(e,r){r||(r={}),e.SSF||(e.SSF=zn(Or)),e.SSF&&(p0(),h0(e.SSF),r.revssf=m0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],ui(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(TB(e,r)),t.push(OB()),t.push(""),t.push("");for(var s=0;s<e.SheetNames.length;++s)t.push(Ye("Worksheet",$B(s,r,e),{"ss:Name":ar(e.SheetNames[s])}));return t[2]=PB(e,r),t[3]=RB(e),Br+Ye("Workbook",t.join(""),{xmlns:ss.ss,"xmlns:o":ss.o,"xmlns:x":ss.x,"xmlns:ss":ss.ss,"xmlns:dt":ss.dt,"xmlns:html":ss.html})}var Mh={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function zB(e,r){var t=[],s=[],a=[],o=0,c,u=$v(Zv,"n"),p=$v(e1,"n");if(e.Props)for(c=ln(e.Props),o=0;o<c.length;++o)(Object.prototype.hasOwnProperty.call(u,c[o])?t:Object.prototype.hasOwnProperty.call(p,c[o])?s:a).push([c[o],e.Props[c[o]]]);if(e.Custprops)for(c=ln(e.Custprops),o=0;o<c.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},c[o])||(Object.prototype.hasOwnProperty.call(u,c[o])?t:Object.prototype.hasOwnProperty.call(p,c[o])?s:a).push([c[o],e.Custprops[c[o]]]);var h=[];for(o=0;o<a.length;++o)Cb.indexOf(a[o][0])>-1||jb.indexOf(a[o][0])>-1||a[o][1]!=null&&h.push(a[o]);s.length&&dr.utils.cfb_add(r,"/SummaryInformation",a1(s,Mh.SI,p,e1)),(t.length||h.length)&&dr.utils.cfb_add(r,"/DocumentSummaryInformation",a1(t,Mh.DSI,u,Zv,h.length?h:null,Mh.UDI))}function WB(e,r){var t=r||{},s=dr.utils.cfb_new({root:"R"}),a="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":a="/Workbook",t.biff=8;break;case"biff5":a="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return dr.utils.cfb_add(s,a,sj(e,t)),t.biff==8&&(e.Props||e.Custprops)&&zB(e,s),t.biff==8&&e.vbaraw&&oI(s,dr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),s}var qB={0:{f:H8},1:{f:t7},2:{f:N7},3:{f:c7},4:{f:a7},5:{f:g7},6:{f:_7},7:{f:h7},8:{f:R7},9:{f:P7},10:{f:T7},11:{f:O7},12:{f:n7},13:{f:b7},14:{f:u7},15:{f:o7},16:{f:v7},17:{f:E7},18:{f:m7},19:{f:Cm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yB},40:{},42:{},43:{f:_6},44:{f:j6},45:{f:A6},46:{f:O6},47:{f:T6},48:{},49:{f:n9},50:{},51:{f:H6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:s6},62:{f:k7},63:{f:Z6},64:{f:Y7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:na,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:V7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Z8},148:{f:K8,p:16},151:{f:B7},152:{},153:{f:xB},154:{},155:{},156:{f:pB},157:{},158:{},159:{T:1,f:p6},160:{T:-1},161:{T:1,f:Hi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:D7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:V6},336:{T:-1},337:{f:K6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:J9},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$7},427:{f:U7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:W7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:J8},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:L7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:sI},633:{T:1},634:{T:-1},635:{T:1,f:rI},636:{T:-1},637:{f:o9},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:lB},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:K7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Ke(e,r,t,s){var a=r;if(!isNaN(a)){var o=s||(t||[]).length||0,c=e.next(4);c.write_shift(2,a),c.write_shift(2,o),o>0&&jm(t)&&e.push(t)}}function VB(e,r,t,s){var a=(t||[]).length||0;if(a<=8224)return Ke(e,r,t,a);var o=r;if(!isNaN(o)){for(var c=t.parts||[],u=0,p=0,h=0;h+(c[u]||8224)<=8224;)h+=c[u]||8224,u++;var x=e.next(4);for(x.write_shift(2,o),x.write_shift(2,h),e.push(t.slice(p,p+h)),p+=h;p<a;){for(x=e.next(4),x.write_shift(2,60),h=0;h+(c[u]||8224)<=8224;)h+=c[u]||8224,u++;x.write_shift(2,h),e.push(t.slice(p,p+h)),p+=h}}}function Rc(e,r,t){return e||(e=Pe(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(2,0),e.write_shift(1,0),e}function QB(e,r,t,s){var a=Pe(9);return Rc(a,e,r),Ab(t,s||"b",a),a}function HB(e,r,t){var s=Pe(8+2*t.length);return Rc(s,e,r),s.write_shift(1,t.length),s.write_shift(t.length,t,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function GB(e,r,t,s){if(r.v!=null)switch(r.t){case"d":case"n":var a=r.t=="d"?Un(kn(r.v)):r.v;a==(a|0)&&a>=0&&a<65536?Ke(e,2,l6(t,s,a)):Ke(e,3,o6(t,s,a));return;case"b":case"e":Ke(e,5,QB(t,s,r.v,r.t));return;case"s":case"str":Ke(e,4,HB(t,s,(r.v||"").slice(0,255)));return}Ke(e,1,Rc(null,t,s))}function YB(e,r,t,s){var a=Array.isArray(r),o=wr(r["!ref"]||"A1"),c,u="",p=[];if(o.e.c>255||o.e.r>16383){if(s.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),c=Ir(o)}for(var h=o.s.r;h<=o.e.r;++h){u=on(h);for(var x=o.s.c;x<=o.e.c;++x){h===o.s.r&&(p[x]=yn(x)),c=p[x]+u;var y=a?(r[h]||[])[x]:r[c];y&&GB(e,y,h,x)}}}function KB(e,r){for(var t=r||{},s=$n(),a=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==t.sheet&&(a=o);if(a==0&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Ke(s,t.biff==4?1033:t.biff==3?521:9,Tm(e,16,t)),YB(s,e.Sheets[e.SheetNames[a]],a,t),Ke(s,10),s.end()}function XB(e,r,t){Ke(e,49,q9({sz:12,name:"Arial"},t))}function JB(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)r[a]!=null&&Ke(e,1054,H9(a,r[a],t))})}function ZB(e,r){var t=Pe(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Ke(e,2151,t),t=Pe(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),Pb(wr(r["!ref"]||"A1"),t),t.write_shift(4,4),Ke(e,2152,t)}function e$(e,r){for(var t=0;t<16;++t)Ke(e,224,o1({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(s){Ke(e,224,o1(s,0,r))})}function t$(e,r){for(var t=0;t<r["!links"].length;++t){var s=r["!links"][t];Ke(e,440,t6(s)),s[1].Tooltip&&Ke(e,2048,r6(s))}delete r["!links"]}function r$(e,r){if(r){var t=0;r.forEach(function(s,a){++t<=256&&s&&Ke(e,125,a6(v0(a,s),a))})}}function n$(e,r,t,s,a){var o=16+ui(a.cellXfs,r,a);if(r.v==null&&!r.bf){Ke(e,513,$i(t,s,o));return}if(r.bf)Ke(e,6,C8(r,t,s,a,o));else switch(r.t){case"d":case"n":var c=r.t=="d"?Un(kn(r.v)):r.v;Ke(e,515,X9(t,s,c,o));break;case"b":case"e":Ke(e,517,K9(t,s,r.v,o,a,r.t));break;case"s":case"str":if(a.bookSST){var u=Fm(a.Strings,r.v,a.revStrings);Ke(e,253,V9(t,s,u,o))}else Ke(e,516,Q9(t,s,(r.v||"").slice(0,255),o,a));break;default:Ke(e,513,$i(t,s,o))}}function s$(e,r,t){var s=$n(),a=t.SheetNames[e],o=t.Sheets[a]||{},c=(t||{}).Workbook||{},u=(c.Sheets||[])[e]||{},p=Array.isArray(o),h=r.biff==8,x,y="",v=[],k=wr(o["!ref"]||"A1"),b=h?65536:16384;if(k.e.c>255||k.e.r>=b){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");k.e.c=Math.min(k.e.c,255),k.e.r=Math.min(k.e.c,b-1)}Ke(s,2057,Tm(t,16,r)),Ke(s,13,xs(1)),Ke(s,12,xs(100)),Ke(s,15,jn(!0)),Ke(s,17,jn(!1)),Ke(s,16,Bi(.001)),Ke(s,95,jn(!0)),Ke(s,42,jn(!1)),Ke(s,43,jn(!1)),Ke(s,130,xs(1)),Ke(s,128,Y9()),Ke(s,131,jn(!1)),Ke(s,132,jn(!1)),h&&r$(s,o["!cols"]),Ke(s,512,G9(k,r)),h&&(o["!links"]=[]);for(var w=k.s.r;w<=k.e.r;++w){y=on(w);for(var j=k.s.c;j<=k.e.c;++j){w===k.s.r&&(v[j]=yn(j)),x=v[j]+y;var O=p?(o[w]||[])[j]:o[x];O&&(n$(s,O,w,j,r),h&&O.l&&o["!links"].push([x,O.l]))}}var T=u.CodeName||u.name||a;return h&&Ke(s,574,W9((c.Views||[])[0])),h&&(o["!merges"]||[]).length&&Ke(s,229,e6(o["!merges"])),h&&t$(s,o),Ke(s,442,Ob(T)),h&&ZB(s,o),Ke(s,10),s.end()}function a$(e,r,t){var s=$n(),a=(e||{}).Workbook||{},o=a.Sheets||[],c=a.WBProps||{},u=t.biff==8,p=t.biff==5;if(Ke(s,2057,Tm(e,5,t)),t.bookType=="xla"&&Ke(s,135),Ke(s,225,u?xs(1200):null),Ke(s,193,T9(2)),p&&Ke(s,191),p&&Ke(s,192),Ke(s,226),Ke(s,92,B9("SheetJS",t)),Ke(s,66,xs(u?1200:1252)),u&&Ke(s,353,xs(0)),u&&Ke(s,448),Ke(s,317,i6(e.SheetNames.length)),u&&e.vbaraw&&Ke(s,211),u&&e.vbaraw){var h=c.CodeName||"ThisWorkbook";Ke(s,442,Ob(h))}Ke(s,156,xs(17)),Ke(s,25,jn(!1)),Ke(s,18,jn(!1)),Ke(s,19,xs(0)),u&&Ke(s,431,jn(!1)),u&&Ke(s,444,xs(0)),Ke(s,61,z9()),Ke(s,64,jn(!1)),Ke(s,141,xs(0)),Ke(s,34,jn(dB(e)=="true")),Ke(s,14,jn(!0)),u&&Ke(s,439,jn(!1)),Ke(s,218,xs(0)),XB(s,e,t),JB(s,e.SSF,t),e$(s,t),u&&Ke(s,352,jn(!1));var x=s.end(),y=$n();u&&Ke(y,140,n6()),u&&t.Strings&&VB(y,252,U9(t.Strings)),Ke(y,10);var v=y.end(),k=$n(),b=0,w=0;for(w=0;w<e.SheetNames.length;++w)b+=(u?12:11)+(u?2:1)*e.SheetNames[w].length;var j=x.length+b+v.length;for(w=0;w<e.SheetNames.length;++w){var O=o[w]||{};Ke(k,133,$9({pos:j,hs:O.Hidden||0,dt:0,name:e.SheetNames[w]},t)),j+=r[w].length}var T=k.end();if(b!=T.length)throw new Error("BS8 "+b+" != "+T.length);var F=[];return x.length&&F.push(x),T.length&&F.push(T),v.length&&F.push(v),sn(F)}function i$(e,r){var t=r||{},s=[];e&&!e.SSF&&(e.SSF=zn(Or)),e&&e.SSF&&(p0(),h0(e.SSF),t.revssf=m0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Mm(t),t.cellXfs=[],ui(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)s[s.length]=s$(a,t,e);return s.unshift(a$(e,s,t)),sn(s)}function sj(e,r){for(var t=0;t<=e.SheetNames.length;++t){var s=e.Sheets[e.SheetNames[t]];if(!(!s||!s["!ref"])){var a=ls(s["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var o=r||{};switch(o.biff||2){case 8:case 5:return i$(e,r);case 4:case 3:case 2:return KB(e,r)}throw new Error("invalid type "+o.bookType+" for BIFF")}function o$(e,r,t,s){for(var a=e["!merges"]||[],o=[],c=r.s.c;c<=r.e.c;++c){for(var u=0,p=0,h=0;h<a.length;++h)if(!(a[h].s.r>t||a[h].s.c>c)&&!(a[h].e.r<t||a[h].e.c<c)){if(a[h].s.r<t||a[h].s.c<c){u=-1;break}u=a[h].e.r-a[h].s.r+1,p=a[h].e.c-a[h].s.c+1;break}if(!(u<0)){var x=ir({r:t,c}),y=s.dense?(e[t]||[])[c]:e[x],v=y&&y.v!=null&&(y.h||IL(y.w||(ka(y),y.w)||""))||"",k={};u>1&&(k.rowspan=u),p>1&&(k.colspan=p),s.editable?v='<span contenteditable="true">'+v+"</span>":y&&(k["data-t"]=y&&y.t||"z",y.v!=null&&(k["data-v"]=y.v),y.z!=null&&(k["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+y.l.Target+'">'+v+"</a>")),k.id=(s.id||"sjs")+"-"+x,o.push(Ye("td",v,k))}}var b="<tr>";return b+o.join("")+"</tr>"}var l$='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',c$="</body></html>";function d$(e,r,t){var s=[];return s.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function aj(e,r){var t=r||{},s=t.header!=null?t.header:l$,a=t.footer!=null?t.footer:c$,o=[s],c=ls(e["!ref"]);t.dense=Array.isArray(e),o.push(d$(e,c,t));for(var u=c.s.r;u<=c.e.r;++u)o.push(o$(e,c,u,t));return o.push("</table>"+a),o.join("")}function ij(e,r,t){var s=t||{},a=0,o=0;if(s.origin!=null)if(typeof s.origin=="number")a=s.origin;else{var c=typeof s.origin=="string"?Xr(s.origin):s.origin;a=c.r,o=c.c}var u=r.getElementsByTagName("tr"),p=Math.min(s.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var x=ls(e["!ref"]);h.s.r=Math.min(h.s.r,x.s.r),h.s.c=Math.min(h.s.c,x.s.c),h.e.r=Math.max(h.e.r,x.e.r),h.e.c=Math.max(h.e.c,x.e.c),a==-1&&(h.e.r=a=x.e.r+1)}var y=[],v=0,k=e["!rows"]||(e["!rows"]=[]),b=0,w=0,j=0,O=0,T=0,F=0;for(e["!cols"]||(e["!cols"]=[]);b<u.length&&w<p;++b){var I=u[b];if(p1(I)){if(s.display)continue;k[w]={hidden:!0}}var G=I.children;for(j=O=0;j<G.length;++j){var B=G[j];if(!(s.display&&p1(B))){var Q=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):zL(B.innerHTML),z=B.getAttribute("data-z")||B.getAttribute("z");for(v=0;v<y.length;++v){var J=y[v];J.s.c==O+o&&J.s.r<w+a&&w+a<=J.e.r&&(O=J.e.c+1-o,v=-1)}F=+B.getAttribute("colspan")||1,((T=+B.getAttribute("rowspan")||1)>1||F>1)&&y.push({s:{r:w+a,c:O+o},e:{r:w+a+(T||1)-1,c:O+o+(F||1)-1}});var ne={t:"s",v:Q},fe=B.getAttribute("data-t")||B.getAttribute("t")||"";Q!=null&&(Q.length==0?ne.t=fe||"z":s.raw||Q.trim().length==0||fe=="s"||(Q==="TRUE"?ne={t:"b",v:!0}:Q==="FALSE"?ne={t:"b",v:!1}:isNaN(va(Q))?isNaN(nc(Q).getDate())||(ne={t:"d",v:kn(Q)},s.cellDates||(ne={t:"n",v:Un(ne.v)}),ne.z=s.dateNF||Or[14]):ne={t:"n",v:va(Q)})),ne.z===void 0&&z!=null&&(ne.z=z);var me="",le=B.getElementsByTagName("A");if(le&&le.length)for(var K=0;K<le.length&&!(le[K].hasAttribute("href")&&(me=le[K].getAttribute("href"),me.charAt(0)!="#"));++K);me&&me.charAt(0)!="#"&&(ne.l={Target:me}),s.dense?(e[w+a]||(e[w+a]=[]),e[w+a][O+o]=ne):e[ir({c:O+o,r:w+a})]=ne,h.e.c<O+o&&(h.e.c=O+o),O+=F}}++w}return y.length&&(e["!merges"]=(e["!merges"]||[]).concat(y)),h.e.r=Math.max(h.e.r,w-1+a),e["!ref"]=Ir(h),w>=p&&(e["!fullref"]=Ir((h.e.r=u.length-b+w-1+a,h))),e}function oj(e,r){var t=r||{},s=t.dense?[]:{};return ij(s,e,r)}function u$(e,r){return Wi(oj(e,r),r)}function p1(e){var r="",t=f$(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function f$(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var h$=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+ac({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Br+r}})(),m1=(function(){var e=function(o){return ar(o).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,s=function(o,c,u){var p=[];p.push('      <table:table table:name="'+ar(c.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,x=0,y=ls(o["!ref"]||"A1"),v=o["!merges"]||[],k=0,b=Array.isArray(o);if(o["!cols"])for(x=0;x<=y.e.c;++x)p.push("        <table:table-column"+(o["!cols"][x]?' table:style-name="co'+o["!cols"][x].ods+'"':"")+`></table:table-column>
`);var w="",j=o["!rows"]||[];for(h=0;h<y.s.r;++h)w=j[h]?' table:style-name="ro'+j[h].ods+'"':"",p.push("        <table:table-row"+w+`></table:table-row>
`);for(;h<=y.e.r;++h){for(w=j[h]?' table:style-name="ro'+j[h].ods+'"':"",p.push("        <table:table-row"+w+`>
`),x=0;x<y.s.c;++x)p.push(r);for(;x<=y.e.c;++x){var O=!1,T={},F="";for(k=0;k!=v.length;++k)if(!(v[k].s.c>x)&&!(v[k].s.r>h)&&!(v[k].e.c<x)&&!(v[k].e.r<h)){(v[k].s.c!=x||v[k].s.r!=h)&&(O=!0),T["table:number-columns-spanned"]=v[k].e.c-v[k].s.c+1,T["table:number-rows-spanned"]=v[k].e.r-v[k].s.r+1;break}if(O){p.push(t);continue}var I=ir({r:h,c:x}),G=b?(o[h]||[])[x]:o[I];if(G&&G.f&&(T["table:formula"]=ar(R8(G.f)),G.F&&G.F.slice(0,I.length)==I)){var B=ls(G.F);T["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,T["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!G){p.push(r);continue}switch(G.t){case"b":F=G.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=G.v?"true":"false";break;case"n":F=G.w||String(G.v||0),T["office:value-type"]="float",T["office:value"]=G.v||0;break;case"s":case"str":F=G.v==null?"":G.v,T["office:value-type"]="string";break;case"d":F=G.w||kn(G.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=kn(G.v).toISOString(),T["table:style-name"]="ce1";break;default:p.push(r);continue}var Q=e(F);if(G.l&&G.l.Target){var z=G.l.Target;z=z.charAt(0)=="#"?"#"+D8(z.slice(1)):z,z.charAt(0)!="#"&&!z.match(/^\w+:/)&&(z="../"+z),Q=Ye("text:a",Q,{"xlink:href":z.replace(/&/g,"&amp;")})}p.push("          "+Ye("table:table-cell",Ye("text:p",Q,{}),T)+`
`)}p.push(`        </table:table-row>
`)}return p.push(`      </table:table>
`),p.join("")},a=function(o,c){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;c.SheetNames.map(function(h){return c.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var x=0;x<h["!cols"].length;++x)if(h["!cols"][x]){var y=h["!cols"][x];if(y.width==null&&y.wpx==null&&y.wch==null)continue;Om(y),y.ods=u;var v=h["!cols"][x].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),o.push(`  </style:style>
`),++u}}});var p=0;c.SheetNames.map(function(h){return c.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var x=0;x<h["!rows"].length;++x)if(h["!rows"][x]){h["!rows"][x].ods=p;var y=h["!rows"][x].hpx+"px";o.push('  <style:style style:name="ro'+p+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+y+`"/>
`),o.push(`  </style:style>
`),++p}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(c,u){var p=[Br],h=ac({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),x=ac({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(p.push("<office:document"+h+x+`>
`),p.push(Sb().replace(/office:document-meta/g,"office:meta"))):p.push("<office:document-content"+h+`>
`),a(p,c),p.push(`  <office:body>
`),p.push(`    <office:spreadsheet>
`);for(var y=0;y!=c.SheetNames.length;++y)p.push(s(c.Sheets[c.SheetNames[y]],c,y));return p.push(`    </office:spreadsheet>
`),p.push(`  </office:body>
`),u.bookType=="fods"?p.push("</office:document>"):p.push("</office:document-content>"),p.join("")}})();function lj(e,r){if(r.bookType=="fods")return m1(e,r);var t=wm(),s="",a=[],o=[];return s="mimetype",Tt(t,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Tt(t,s,m1(e,r)),a.push([s,"text/xml"]),o.push([s,"ContentFile"]),s="styles.xml",Tt(t,s,h$(e,r)),a.push([s,"text/xml"]),o.push([s,"StylesFile"]),s="meta.xml",Tt(t,s,Br+Sb()),a.push([s,"text/xml"]),o.push([s,"MetadataFile"]),s="manifest.rdf",Tt(t,s,k9(o)),a.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Tt(t,s,b9(a)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Iu(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function p$(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):As(sc(e))}function m$(e,r){e:for(var t=0;t<=e.length-r.length;++t){for(var s=0;s<r.length;++s)if(e[t+s]!=r[s])continue e;return!0}return!1}function ii(e){var r=e.reduce(function(a,o){return a+o.length},0),t=new Uint8Array(r),s=0;return e.forEach(function(a){t.set(a,s),s+=a.length}),t}function x$(e,r,t){var s=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,a=t/Math.pow(10,s-6176);e[r+15]|=s>>7,e[r+14]|=(s&127)<<1;for(var o=0;a>=1;++o,a/=256)e[r+o]=a&255;e[r+15]|=t>=0?0:128}function ic(e,r){var t=r?r[0]:0,s=e[t]&127;e:if(e[t++]>=128&&(s|=(e[t]&127)<<7,e[t++]<128||(s|=(e[t]&127)<<14,e[t++]<128)||(s|=(e[t]&127)<<21,e[t++]<128)||(s+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(s+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(s+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),s}function tr(e){var r=new Uint8Array(7);r[0]=e&127;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r.slice(0,t)}function Po(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function Wr(e){for(var r=[],t=[0];t[0]<e.length;){var s=t[0],a=ic(e,t),o=a&7;a=Math.floor(a/8);var c=0,u;if(a==0)break;switch(o){case 0:{for(var p=t[0];e[t[0]++]>=128;);u=e.slice(p,t[0])}break;case 5:c=4,u=e.slice(t[0],t[0]+c),t[0]+=c;break;case 1:c=8,u=e.slice(t[0],t[0]+c),t[0]+=c;break;case 2:c=ic(e,t),u=e.slice(t[0],t[0]+c),t[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(s))}var h={data:u,type:o};r[a]==null?r[a]=[h]:r[a].push(h)}return r}function rn(e){var r=[];return e.forEach(function(t,s){t.forEach(function(a){a.data&&(r.push(tr(s*8+a.type)),a.type==2&&r.push(tr(a.data.length)),r.push(a.data))})}),ii(r)}function _s(e){for(var r,t=[],s=[0];s[0]<e.length;){var a=ic(e,s),o=Wr(e.slice(s[0],s[0]+a));s[0]+=a;var c={id:Po(o[1][0].data),messages:[]};o[2].forEach(function(u){var p=Wr(u.data),h=Po(p[3][0].data);c.messages.push({meta:p,data:e.slice(s[0],s[0]+h)}),s[0]+=h}),(r=o[3])!=null&&r[0]&&(c.merge=Po(o[3][0].data)>>>0>0),t.push(c)}return t}function bo(e){var r=[];return e.forEach(function(t){var s=[];s[1]=[{data:tr(t.id),type:0}],s[2]=[],t.merge!=null&&(s[3]=[{data:tr(+!!t.merge),type:0}]);var a=[];t.messages.forEach(function(c){a.push(c.data),c.meta[3]=[{type:0,data:tr(c.data.length)}],s[2].push({data:rn(c.meta),type:2})});var o=rn(s);r.push(tr(o.length)),r.push(o),a.forEach(function(c){return r.push(c)})}),ii(r)}function g$(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],s=ic(r,t),a=[];t[0]<r.length;){var o=r[t[0]]&3;if(o==0){var c=r[t[0]++]>>2;if(c<60)++c;else{var u=c-59;c=r[t[0]],u>1&&(c|=r[t[0]+1]<<8),u>2&&(c|=r[t[0]+2]<<16),u>3&&(c|=r[t[0]+3]<<24),c>>>=0,c++,t[0]+=u}a.push(r.slice(t[0],t[0]+c)),t[0]+=c;continue}else{var p=0,h=0;if(o==1?(h=(r[t[0]]>>2&7)+4,p=(r[t[0]++]&224)<<3,p|=r[t[0]++]):(h=(r[t[0]++]>>2)+1,o==2?(p=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(p=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[ii(a)],p==0)throw new Error("Invalid offset 0");if(p>a[0].length)throw new Error("Invalid offset beyond length");if(h>=p)for(a.push(a[0].slice(-p)),h-=p;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-p,-p+h))}}var x=ii(a);if(x.length!=s)throw new Error("Unexpected length: ".concat(x.length," != ").concat(s));return x}function Cs(e){for(var r=[],t=0;t<e.length;){var s=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(g$(s,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return ii(r)}function jo(e){for(var r=[],t=0;t<e.length;){var s=Math.min(e.length-t,268435455),a=new Uint8Array(4);r.push(a);var o=tr(s),c=o.length;r.push(o),s<=60?(c++,r.push(new Uint8Array([s-1<<2]))):s<=256?(c+=2,r.push(new Uint8Array([240,s-1&255]))):s<=65536?(c+=3,r.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(c+=4,r.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(c+=5,r.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),r.push(e.slice(t,t+s)),c+=s,a[0]=0,a[1]=c&255,a[2]=c>>8&255,a[3]=c>>16&255,t+=s}return ii(r)}function Lh(e,r){var t=new Uint8Array(32),s=Iu(t),a=12,o=0;switch(t[0]=5,e.t){case"n":t[1]=2,x$(t,a,e.v),o|=1,a+=16;break;case"b":t[1]=6,s.setFloat64(a,e.v?1:0,!0),o|=2,a+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[1]=3,s.setUint32(a,r.indexOf(e.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(8,o,!0),t.slice(0,a)}function Ih(e,r){var t=new Uint8Array(32),s=Iu(t),a=12,o=0;switch(t[0]=3,e.t){case"n":t[2]=2,s.setFloat64(a,e.v,!0),o|=32,a+=8;break;case"b":t[2]=6,s.setFloat64(a,e.v?1:0,!0),o|=32,a+=8;break;case"s":if(r.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));t[2]=3,s.setUint32(a,r.indexOf(e.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return s.setUint32(4,o,!0),t.slice(0,a)}function Ka(e){var r=Wr(e);return ic(r[1][0].data)}function y$(e,r,t){var s,a,o,c;if(!((s=e[6])!=null&&s[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((c=(o=e[8])==null?void 0:o[0])==null?void 0:c.data)&&Po(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var p=0,h=Iu(e[7][0].data),x=0,y=[],v=Iu(e[4][0].data),k=0,b=[],w=0;w<r.length;++w){if(r[w]==null){h.setUint16(w*2,65535,!0),v.setUint16(w*2,65535);continue}h.setUint16(w*2,x,!0),v.setUint16(w*2,k,!0);var j,O;switch(typeof r[w]){case"string":j=Lh({t:"s",v:r[w]},t),O=Ih({t:"s",v:r[w]},t);break;case"number":j=Lh({t:"n",v:r[w]},t),O=Ih({t:"n",v:r[w]},t);break;case"boolean":j=Lh({t:"b",v:r[w]},t),O=Ih({t:"b",v:r[w]},t);break;default:throw new Error("Unsupported value "+r[w])}y.push(j),x+=j.length,b.push(O),k+=O.length,++p}for(e[2][0].data=tr(p);w<e[7][0].data.length/2;++w)h.setUint16(w*2,65535,!0),v.setUint16(w*2,65535,!0);return e[6][0].data=ii(y),e[3][0].data=ii(b),p}function v$(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=ls(t["!ref"]);s.s.r=s.s.c=0;var a=!1;s.e.c>9&&(a=!0,s.e.c=9),s.e.r>49&&(a=!0,s.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ir(s)));var o=Bu(t,{range:s,header:1}),c=["~Sh33tJ5~"];o.forEach(function(re){return re.forEach(function(Y){typeof Y=="string"&&c.push(Y)})});var u={},p=[],h=dr.read(r.numbers,{type:"base64"});h.FileIndex.map(function(re,Y){return[re,h.FullPaths[Y]]}).forEach(function(re){var Y=re[0],Z=re[1];if(Y.type==2&&Y.name.match(/\.iwa/)){var xe=Y.content,ie=Cs(xe),Te=_s(ie);Te.forEach(function(ve){p.push(ve.id),u[ve.id]={deps:[],location:Z,type:Po(ve.messages[0].meta[1][0].data)}})}}),p.sort(function(re,Y){return re-Y});var x=p.filter(function(re){return re>1}).map(function(re){return[re,tr(re)]});h.FileIndex.map(function(re,Y){return[re,h.FullPaths[Y]]}).forEach(function(re){var Y=re[0];if(re[1],!!Y.name.match(/\.iwa/)){var Z=_s(Cs(Y.content));Z.forEach(function(xe){xe.messages.forEach(function(ie){x.forEach(function(Te){xe.messages.some(function(ve){return Po(ve.meta[1][0].data)!=11006&&m$(ve.data,Te[1])})&&u[Te[0]].deps.push(xe.id)})})})}});for(var y=dr.find(h,u[1].location),v=_s(Cs(y.content)),k,b=0;b<v.length;++b){var w=v[b];w.id==1&&(k=w)}var j=Ka(Wr(k.messages[0].data)[1][0].data);for(y=dr.find(h,u[j].location),v=_s(Cs(y.content)),b=0;b<v.length;++b)w=v[b],w.id==j&&(k=w);for(j=Ka(Wr(k.messages[0].data)[2][0].data),y=dr.find(h,u[j].location),v=_s(Cs(y.content)),b=0;b<v.length;++b)w=v[b],w.id==j&&(k=w);for(j=Ka(Wr(k.messages[0].data)[2][0].data),y=dr.find(h,u[j].location),v=_s(Cs(y.content)),b=0;b<v.length;++b)w=v[b],w.id==j&&(k=w);var O=Wr(k.messages[0].data);{O[6][0].data=tr(s.e.r+1),O[7][0].data=tr(s.e.c+1);var T=Ka(O[46][0].data),F=dr.find(h,u[T].location),I=_s(Cs(F.content));{for(var G=0;G<I.length&&I[G].id!=T;++G);if(I[G].id!=T)throw"Bad ColumnRowUIDMapArchive";var B=Wr(I[G].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var Q=0;Q<=s.e.c;++Q){var z=[];z[1]=z[2]=[{type:0,data:tr(Q+420690)}],B[1].push({type:2,data:rn(z)}),B[2].push({type:0,data:tr(Q)}),B[3].push({type:0,data:tr(Q)})}B[4]=[],B[5]=[],B[6]=[];for(var J=0;J<=s.e.r;++J)z=[],z[1]=z[2]=[{type:0,data:tr(J+726270)}],B[4].push({type:2,data:rn(z)}),B[5].push({type:0,data:tr(J)}),B[6].push({type:0,data:tr(J)});I[G].messages[0].data=rn(B)}F.content=jo(bo(I)),F.size=F.content.length,delete O[46];var ne=Wr(O[4][0].data);{ne[7][0].data=tr(s.e.r+1);var fe=Wr(ne[1][0].data),me=Ka(fe[2][0].data);F=dr.find(h,u[me].location),I=_s(Cs(F.content));{if(I[0].id!=me)throw"Bad HeaderStorageBucket";var le=Wr(I[0].messages[0].data);for(J=0;J<o.length;++J){var K=Wr(le[2][0].data);K[1][0].data=tr(J),K[4][0].data=tr(o[J].length),le[2][J]={type:le[2][0].type,data:rn(K)}}I[0].messages[0].data=rn(le)}F.content=jo(bo(I)),F.size=F.content.length;var Fe=Ka(ne[2][0].data);F=dr.find(h,u[Fe].location),I=_s(Cs(F.content));{if(I[0].id!=Fe)throw"Bad HeaderStorageBucket";for(le=Wr(I[0].messages[0].data),Q=0;Q<=s.e.c;++Q)K=Wr(le[2][0].data),K[1][0].data=tr(Q),K[4][0].data=tr(s.e.r+1),le[2][Q]={type:le[2][0].type,data:rn(K)};I[0].messages[0].data=rn(le)}F.content=jo(bo(I)),F.size=F.content.length;var we=Ka(ne[4][0].data);(function(){for(var re=dr.find(h,u[we].location),Y=_s(Cs(re.content)),Z,xe=0;xe<Y.length;++xe){var ie=Y[xe];ie.id==we&&(Z=ie)}var Te=Wr(Z.messages[0].data);{Te[3]=[];var ve=[];c.forEach(function(D,ut){ve[1]=[{type:0,data:tr(ut)}],ve[2]=[{type:0,data:tr(1)}],ve[3]=[{type:2,data:p$(D)}],Te[3].push({type:2,data:rn(ve)})})}Z.messages[0].data=rn(Te);var Ee=bo(Y),Me=jo(Ee);re.content=Me,re.size=re.content.length})();var oe=Wr(ne[3][0].data);{var V=oe[1][0];delete oe[2];var de=Wr(V.data);{var Ne=Ka(de[2][0].data);(function(){for(var re=dr.find(h,u[Ne].location),Y=_s(Cs(re.content)),Z,xe=0;xe<Y.length;++xe){var ie=Y[xe];ie.id==Ne&&(Z=ie)}var Te=Wr(Z.messages[0].data);{delete Te[6],delete oe[7];var ve=new Uint8Array(Te[5][0].data);Te[5]=[];for(var Ee=0,Me=0;Me<=s.e.r;++Me){var D=Wr(ve);Ee+=y$(D,o[Me],c),D[1][0].data=tr(Me),Te[5].push({data:rn(D),type:2})}Te[1]=[{type:0,data:tr(s.e.c+1)}],Te[2]=[{type:0,data:tr(s.e.r+1)}],Te[3]=[{type:0,data:tr(Ee)}],Te[4]=[{type:0,data:tr(s.e.r+1)}]}Z.messages[0].data=rn(Te);var ut=bo(Y),et=jo(ut);re.content=et,re.size=re.content.length})()}V.data=rn(de)}ne[3][0].data=rn(oe)}O[4][0].data=rn(ne)}k.messages[0].data=rn(O);var ee=bo(v),U=jo(ee);return y.content=U,y.size=y.content.length,h}function w$(e){return function(t){for(var s=0;s!=e.length;++s){var a=e[s];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function Mm(e){w$([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function N$(e,r){return r.bookType=="ods"?lj(e,r):r.bookType=="numbers"?v$(e,r):r.bookType=="xlsb"?S$(e,r):b$(e,r)}function S$(e,r){_o=1024,e&&!e.SSF&&(e.SSF=zn(Or)),e&&e.SSF&&(p0(),h0(e.SSF),r.revssf=m0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Gl?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t=r.bookType=="xlsb"?"bin":"xml",s=qb.indexOf(r.bookType)>-1,a=vb();Mm(r=r||{});var o=wm(),c="",u=0;if(r.cellXfs=[],ui(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",Tt(o,c,bb(e.Props,r)),a.coreprops.push(c),nr(r.rels,2,c,Kt.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var p=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&p.push(e.SheetNames[h]);e.Props.SheetNames=p}for(e.Props.Worksheets=e.Props.SheetNames.length,Tt(o,c,kb(e.Props)),a.extprops.push(c),nr(r.rels,3,c,Kt.EXT_PROPS),e.Custprops!==e.Props&&ln(e.Custprops||{}).length>0&&(c="docProps/custom.xml",Tt(o,c,_b(e.Custprops)),a.custprops.push(c),nr(r.rels,4,c,Kt.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var x={"!id":{}},y=e.Sheets[e.SheetNames[u-1]],v=(y||{})["!type"]||"sheet";switch(v){case"chart":default:c="xl/worksheets/sheet"+u+"."+t,Tt(o,c,kB(u-1,c,r,e,x)),a.sheets.push(c),nr(r.wbrels,-1,"worksheets/sheet"+u+"."+t,Kt.WS[0])}if(y){var k=y["!comments"],b=!1,w="";k&&k.length>0&&(w="xl/comments"+u+"."+t,Tt(o,w,EB(k,w)),a.comments.push(w),nr(x,-1,"../comments"+u+"."+t,Kt.CMNT),b=!0),y["!legacy"]&&b&&Tt(o,"xl/drawings/vmlDrawing"+u+".vml",zb(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}x["!id"].rId1&&Tt(o,Nb(c),To(x))}return r.Strings!=null&&r.Strings.length>0&&(c="xl/sharedStrings."+t,Tt(o,c,CB(r.Strings,c,r)),a.strs.push(c),nr(r.wbrels,-1,"sharedStrings."+t,Kt.SST)),c="xl/workbook."+t,Tt(o,c,jB(e,c)),a.workbooks.push(c),nr(r.rels,1,c,Kt.WB),c="xl/theme/theme1.xml",Tt(o,c,$b(e.Themes,r)),a.themes.push(c),nr(r.wbrels,-1,"theme/theme1.xml",Kt.THEME),c="xl/styles."+t,Tt(o,c,_B(e,c,r)),a.styles.push(c),nr(r.wbrels,-1,"styles."+t,Kt.STY),e.vbaraw&&s&&(c="xl/vbaProject.bin",Tt(o,c,e.vbaraw),a.vba.push(c),nr(r.wbrels,-1,"vbaProject.bin",Kt.VBA)),c="xl/metadata."+t,Tt(o,c,AB(c)),a.metadata.push(c),nr(r.wbrels,-1,"metadata."+t,Kt.XLMETA),Tt(o,"[Content_Types].xml",wb(a,r)),Tt(o,"_rels/.rels",To(r.rels)),Tt(o,"xl/_rels/workbook."+t+".rels",To(r.wbrels)),delete r.revssf,delete r.ssf,o}function b$(e,r){_o=1024,e&&!e.SSF&&(e.SSF=zn(Or)),e&&e.SSF&&(p0(),h0(e.SSF),r.revssf=m0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Gl?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",s=qb.indexOf(r.bookType)>-1,a=vb();Mm(r=r||{});var o=wm(),c="",u=0;if(r.cellXfs=[],ui(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),c="docProps/core.xml",Tt(o,c,bb(e.Props,r)),a.coreprops.push(c),nr(r.rels,2,c,Kt.CORE_PROPS),c="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var p=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&p.push(e.SheetNames[h]);e.Props.SheetNames=p}e.Props.Worksheets=e.Props.SheetNames.length,Tt(o,c,kb(e.Props)),a.extprops.push(c),nr(r.rels,3,c,Kt.EXT_PROPS),e.Custprops!==e.Props&&ln(e.Custprops||{}).length>0&&(c="docProps/custom.xml",Tt(o,c,_b(e.Custprops)),a.custprops.push(c),nr(r.rels,4,c,Kt.CUST_PROPS));var x=["SheetJ5"];for(r.tcid=0,u=1;u<=e.SheetNames.length;++u){var y={"!id":{}},v=e.Sheets[e.SheetNames[u-1]],k=(v||{})["!type"]||"sheet";switch(k){case"chart":default:c="xl/worksheets/sheet"+u+"."+t,Tt(o,c,Zb(u-1,r,e,y)),a.sheets.push(c),nr(r.wbrels,-1,"worksheets/sheet"+u+"."+t,Kt.WS[0])}if(v){var b=v["!comments"],w=!1,j="";if(b&&b.length>0){var O=!1;b.forEach(function(T){T[1].forEach(function(F){F.T==!0&&(O=!0)})}),O&&(j="xl/threadedComments/threadedComment"+u+"."+t,Tt(o,j,eI(b,x,r)),a.threadedcomments.push(j),nr(y,-1,"../threadedComments/threadedComment"+u+"."+t,Kt.TCMNT)),j="xl/comments"+u+"."+t,Tt(o,j,Wb(b)),a.comments.push(j),nr(y,-1,"../comments"+u+"."+t,Kt.CMNT),w=!0}v["!legacy"]&&w&&Tt(o,"xl/drawings/vmlDrawing"+u+".vml",zb(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}y["!id"].rId1&&Tt(o,Nb(c),To(y))}return r.Strings!=null&&r.Strings.length>0&&(c="xl/sharedStrings."+t,Tt(o,c,Db(r.Strings,r)),a.strs.push(c),nr(r.wbrels,-1,"sharedStrings."+t,Kt.SST)),c="xl/workbook."+t,Tt(o,c,rj(e)),a.workbooks.push(c),nr(r.rels,1,c,Kt.WB),c="xl/theme/theme1.xml",Tt(o,c,$b(e.Themes,r)),a.themes.push(c),nr(r.wbrels,-1,"theme/theme1.xml",Kt.THEME),c="xl/styles."+t,Tt(o,c,Ib(e,r)),a.styles.push(c),nr(r.wbrels,-1,"styles."+t,Kt.STY),e.vbaraw&&s&&(c="xl/vbaProject.bin",Tt(o,c,e.vbaraw),a.vba.push(c),nr(r.wbrels,-1,"vbaProject.bin",Kt.VBA)),c="xl/metadata."+t,Tt(o,c,Ub()),a.metadata.push(c),nr(r.wbrels,-1,"metadata."+t,Kt.XLMETA),x.length>1&&(c="xl/persons/person.xml",Tt(o,c,tI(x)),a.people.push(c),nr(r.wbrels,-1,"persons/person.xml",Kt.PEOPLE)),Tt(o,"[Content_Types].xml",wb(a,r)),Tt(o,"_rels/.rels",To(r.rels)),Tt(o,"xl/_rels/workbook."+t+".rels",To(r.wbrels)),delete r.revssf,delete r.ssf,o}function j$(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=ja(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function cj(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Ac(r.file,dr.write(e,{type:Xt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return dr.write(e,r)}function k$(e,r){var t=zn(r||{}),s=N$(e,t);return _$(s,t)}function _$(e,r){var t={},s=Xt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=s;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=s;break;default:throw new Error("Unrecognized type "+r.type)}var a=e.FullPaths?dr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&typeof a=="string"){if(r.type=="binary"||r.type=="base64")return a;a=new Uint8Array(f0(a))}return r.password&&typeof encrypt_agile<"u"?cj(encrypt_agile(a,r.password),r):r.type==="file"?Ac(r.file,a):r.type=="string"?ql(a):a}function C$(e,r){var t=r||{},s=WB(e,t);return cj(s,t)}function Ys(e,r,t){t||(t="");var s=t+e;switch(r.type){case"base64":return rc(sc(s));case"binary":return sc(s);case"string":return e;case"file":return Ac(r.file,s,"utf8");case"buffer":return Xt?Ca(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Ys(s,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function E$(e,r){switch(r.type){case"base64":return rc(e);case"binary":return e;case"string":return e;case"file":return Ac(r.file,e,"binary");case"buffer":return Xt?Ca(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function tu(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",s=0;s<e.length;++s)t+=String.fromCharCode(e[s]);return r.type=="base64"?rc(t):r.type=="string"?ql(t):t;case"file":return Ac(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function dj(e,r){rL(),hB(e);var t=zn(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var s=dj(e,t);return t.type="array",f0(s)}var a=0;if(t.sheet&&(typeof t.sheet=="number"?a=t.sheet:a=e.SheetNames.indexOf(t.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return Ys(UB(e,t),t);case"slk":case"sylk":return Ys(d6.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"htm":case"html":return Ys(aj(e.Sheets[e.SheetNames[a]],t),t);case"txt":return E$(uj(e.Sheets[e.SheetNames[a]],t),t);case"csv":return Ys(Lm(e.Sheets[e.SheetNames[a]],t),t,"\uFEFF");case"dif":return Ys(u6.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"dbf":return tu(c6.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"prn":return Ys(f6.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"rtf":return Ys(v6.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"eth":return Ys(Rb.from_sheet(e.Sheets[e.SheetNames[a]],t),t);case"fods":return Ys(lj(e,t),t);case"wk1":return tu(l1.sheet_to_wk1(e.Sheets[e.SheetNames[a]],t),t);case"wk3":return tu(l1.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),tu(sj(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),C$(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return k$(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function A$(e){if(!e.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType=r[e.bookType]||e.bookType}}function T$(e,r,t){var s={};return s.type="file",s.file=r,A$(s),dj(e,s)}function O$(e,r,t,s,a,o,c,u){var p=on(t),h=u.defval,x=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),y=!0,v=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:t,enumerable:!1})}catch{v.__rowNum__=t}else v.__rowNum__=t;if(!c||e[t])for(var k=r.s.c;k<=r.e.c;++k){var b=c?e[t][k]:e[s[k]+p];if(b===void 0||b.t===void 0){if(h===void 0)continue;o[k]!=null&&(v[o[k]]=h);continue}var w=b.v;switch(b.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(o[k]!=null){if(w==null)if(b.t=="e"&&w===null)v[o[k]]=null;else if(h!==void 0)v[o[k]]=h;else if(x&&w===null)v[o[k]]=null;else continue;else v[o[k]]=x&&(b.t!=="n"||b.t==="n"&&u.rawNumbers!==!1)?w:ka(b,w,u);w!=null&&(y=!1)}}return{row:v,isempty:y}}function Bu(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},s=0,a=1,o=[],c=0,u="",p={s:{r:0,c:0},e:{r:0,c:0}},h=r||{},x=h.range!=null?h.range:e["!ref"];switch(h.header===1?s=1:h.header==="A"?s=2:Array.isArray(h.header)?s=3:h.header==null&&(s=0),typeof x){case"string":p=wr(x);break;case"number":p=wr(e["!ref"]),p.s.r=x;break;default:p=x}s>0&&(a=0);var y=on(p.s.r),v=[],k=[],b=0,w=0,j=Array.isArray(e),O=p.s.r,T=0,F={};j&&!e[O]&&(e[O]=[]);var I=h.skipHidden&&e["!cols"]||[],G=h.skipHidden&&e["!rows"]||[];for(T=p.s.c;T<=p.e.c;++T)if(!(I[T]||{}).hidden)switch(v[T]=yn(T),t=j?e[O][T]:e[v[T]+y],s){case 1:o[T]=T-p.s.c;break;case 2:o[T]=v[T];break;case 3:o[T]=h.header[T-p.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),u=c=ka(t,null,h),w=F[c]||0,!w)F[c]=1;else{do u=c+"_"+w++;while(F[u]);F[c]=w,F[u]=1}o[T]=u}for(O=p.s.r+a;O<=p.e.r;++O)if(!(G[O]||{}).hidden){var B=O$(e,p,O,v,s,o,j,h);(B.isempty===!1||(s===1?h.blankrows!==!1:h.blankrows))&&(k[b++]=B.row)}return k.length=b,k}var x1=/"/g;function P$(e,r,t,s,a,o,c,u){for(var p=!0,h=[],x="",y=on(t),v=r.s.c;v<=r.e.c;++v)if(s[v]){var k=u.dense?(e[t]||[])[v]:e[s[v]+y];if(k==null)x="";else if(k.v!=null){p=!1,x=""+(u.rawNumbers&&k.t=="n"?k.v:ka(k,null,u));for(var b=0,w=0;b!==x.length;++b)if((w=x.charCodeAt(b))===a||w===o||w===34||u.forceQuotes){x='"'+x.replace(x1,'""')+'"';break}x=="ID"&&(x='"ID"')}else k.f!=null&&!k.F?(p=!1,x="="+k.f,x.indexOf(",")>=0&&(x='"'+x.replace(x1,'""')+'"')):x="";h.push(x)}return u.blankrows===!1&&p?null:h.join(c)}function Lm(e,r){var t=[],s=r??{};if(e==null||e["!ref"]==null)return"";var a=wr(e["!ref"]),o=s.FS!==void 0?s.FS:",",c=o.charCodeAt(0),u=s.RS!==void 0?s.RS:`
`,p=u.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),x="",y=[];s.dense=Array.isArray(e);for(var v=s.skipHidden&&e["!cols"]||[],k=s.skipHidden&&e["!rows"]||[],b=a.s.c;b<=a.e.c;++b)(v[b]||{}).hidden||(y[b]=yn(b));for(var w=0,j=a.s.r;j<=a.e.r;++j)(k[j]||{}).hidden||(x=P$(e,a,j,y,c,p,o,s),x!=null&&(s.strip&&(x=x.replace(h,"")),(x||s.blankrows!==!1)&&t.push((w++?u:"")+x)));return delete s.dense,t.join("")}function uj(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=Lm(e,r);return t}function R$(e){var r="",t,s="";if(e==null||e["!ref"]==null)return[];var a=wr(e["!ref"]),o="",c=[],u,p=[],h=Array.isArray(e);for(u=a.s.c;u<=a.e.c;++u)c[u]=yn(u);for(var x=a.s.r;x<=a.e.r;++x)for(o=on(x),u=a.s.c;u<=a.e.c;++u)if(r=c[u]+o,t=h?(e[x]||[])[u]:e[r],s="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;s=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)s=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)s=""+t.v;else if(t.t=="b")s=t.v?"TRUE":"FALSE";else if(t.w!==void 0)s="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?s="'"+t.v:s=""+t.v}}p[p.length]=r+"="+s}return p}function fj(e,r,t){var s=t||{},a=+!s.skipHeader,o=e||{},c=0,u=0;if(o&&s.origin!=null)if(typeof s.origin=="number")c=s.origin;else{var p=typeof s.origin=="string"?Xr(s.origin):s.origin;c=p.r,u=p.c}var h,x={s:{c:0,r:0},e:{c:u,r:c+r.length-1+a}};if(o["!ref"]){var y=wr(o["!ref"]);x.e.c=Math.max(x.e.c,y.e.c),x.e.r=Math.max(x.e.r,y.e.r),c==-1&&(c=y.e.r+1,x.e.r=c+r.length-1+a)}else c==-1&&(c=0,x.e.r=r.length-1+a);var v=s.header||[],k=0;r.forEach(function(w,j){ln(w).forEach(function(O){(k=v.indexOf(O))==-1&&(v[k=v.length]=O);var T=w[O],F="z",I="",G=ir({c:u+k,r:c+j+a});h=oc(o,G),T&&typeof T=="object"&&!(T instanceof Date)?o[G]=T:(typeof T=="number"?F="n":typeof T=="boolean"?F="b":typeof T=="string"?F="s":T instanceof Date?(F="d",s.cellDates||(F="n",T=Un(T)),I=s.dateNF||Or[14]):T===null&&s.nullError&&(F="e",T=0),h?(h.t=F,h.v=T,delete h.w,delete h.R,I&&(h.z=I)):o[G]=h={t:F,v:T},I&&(h.z=I))})}),x.e.c=Math.max(x.e.c,u+v.length-1);var b=on(c);if(a)for(k=0;k<v.length;++k)o[yn(k+u)+b]={t:"s",v:v[k]};return o["!ref"]=Ir(x),o}function D$(e,r){return fj(null,e,r)}function oc(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var s=Xr(r);return e[s.r]||(e[s.r]=[]),e[s.r][s.c]||(e[s.r][s.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?oc(e,ir(r)):oc(e,ir({r,c:t||0}))}function F$(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function M$(){return{SheetNames:[],Sheets:{}}}function L$(e,r,t,s){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var c=o&&o[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=c+a)!=-1;++a);}if(tj(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function I$(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var s=F$(e,r);switch(e.Workbook.Sheets[s]||(e.Workbook.Sheets[s]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[s].Hidden=t}function B$(e,r){return e.z=r,e}function hj(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function $$(e,r,t){return hj(e,"#"+r,t)}function U$(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function z$(e,r,t,s){for(var a=typeof r!="string"?r:wr(r),o=typeof r=="string"?r:Ir(r),c=a.s.r;c<=a.e.r;++c)for(var u=a.s.c;u<=a.e.c;++u){var p=oc(e,c,u);p.t="n",p.F=o,delete p.v,c==a.s.r&&u==a.s.c&&(p.f=t,s&&(p.D=!0))}return e}var Bh={encode_col:yn,encode_row:on,encode_cell:ir,encode_range:Ir,decode_col:_m,decode_row:km,split_cell:r9,decode_cell:Xr,decode_range:ls,format_cell:ka,sheet_add_aoa:hb,sheet_add_json:fj,sheet_add_dom:ij,aoa_to_sheet:Ko,json_to_sheet:D$,table_to_sheet:oj,table_to_book:u$,sheet_to_csv:Lm,sheet_to_txt:uj,sheet_to_json:Bu,sheet_to_html:aj,sheet_to_formulae:R$,sheet_to_row_object_array:Bu,sheet_get_cell:oc,book_new:M$,book_append_sheet:L$,book_set_sheet_visibility:I$,cell_set_number_format:B$,cell_set_hyperlink:hj,cell_set_internal_link:$$,cell_add_comment:U$,sheet_set_array_formula:z$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Kn=({onLogout:e,currentPage:r="Dashboard",onNavigate:t,onUploadSuccess:s,role:a})=>{const[o,c]=m.useState(!1),[u,p]=m.useState(null),[h,x]=m.useState(!1),[y,v]=m.useState(!1),[k,b]=m.useState(null),[w,j]=m.useState(null),O=m.useRef(null),T=localStorage.getItem("token"),[F,I]=m.useState(null),[G,B]=m.useState(null),Q=async oe=>{if(oe.preventDefault(),!u){b("warning"),j(" Please select a file first.");return}const V=new FormData;V.append("file",u);try{v(!0),I(null),j("Uploading..."),b(null);const de=await Ze.post("https://gmvalve.lvpro.live/api/upload-order-file",V,{headers:{Authorization:`Bearer ${T}`}}),{Resp_code:Ne,Resp_desc:ee,file_url:U}=de.data;console.log("Upload Response:",de.data),Ne==="true"?(b("success"),j(" File imported successfully!"),I(null),B(null),p(null),O.current&&(O.current.value=""),s?.(),setTimeout(()=>c(!1),1200)):ee?.toLowerCase().includes("header mismatch")?(b("error"),j(" Header mismatch found in your Excel file."),I(U||null),B("header")):ee?.toLowerCase().includes("validation errors")?(b("error"),j(" Validation errors found in uploaded data."),I(U||null),B("validation")):(b("error"),j(` ${ee||"Error uploading file."}`),I(null),B(null))}catch(de){console.error("Upload Error:",de),b("error"),j(" Error uploading file.")}finally{v(!1)}},z=oe=>{const V=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"],Ne=[".xlsx",".xls",".csv"].some(ee=>oe.name.toLowerCase().endsWith(ee));V.includes(oe.type)||Ne?(p(oe),j(null)):(b("error"),j(" Please select a valid Excel (.xlsx, .xls) or CSV (.csv) file."))},J=oe=>{oe.preventDefault(),x(!1);const V=oe.dataTransfer.files[0];V&&z(V)},ne=oe=>{oe.preventDefault(),x(!0)},fe=oe=>{oe.preventDefault(),x(!1)},me=()=>O.current?.click(),le=oe=>{const V=oe.target.files?.[0];V&&z(V)},K=()=>{p(null),O.current&&(O.current.value="")},Fe=[{id:"Dashboard",label:"Dashboard"},{id:"Planning",label:"Planning"},{id:"MaterialIssue",label:"Material Issue"},{id:"SemiQC",label:"Semi QC"},{id:"PhosphatingQC",label:"After Phosphating QC"},{id:"Assembly",label:"Assembly"},{id:"Testing",label:"Testing"},{id:"SVS",label:"SVS"},{id:"Marking",label:"Marking"},{id:"PDI",label:"PDI"},{id:"TPI",label:"TPI"},{id:"Dispatch",label:"Dispatch"}],we={planning:["Planning"],"material-issue":["MaterialIssue"],"semi-qc":["SemiQC"],"phosphating-qc":["PhosphatingQC"],assembly:["Assembly"],testing:["Testing"],marking:["Marking"],svs:["SVS"],pdi:["PDI"],tpi:["TPI"],dispatch:["Dispatch"],admin:Fe.map(oe=>oe.id)};return a&&we[a]&&Fe.filter(oe=>we[a].includes(oe.id)),n.jsxs(n.Fragment,{children:[n.jsx("header",{className:"glass-header relative z-50",children:n.jsx("div",{className:"mx-auto px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"flex items-center justify-between h-16",children:[n.jsx("div",{className:"flex items-center space-x-8",children:n.jsx("img",{src:dw,alt:"GM Logo",className:"h-8 w-auto object-contain"})}),n.jsxs("div",{className:"flex items-center space-x-3",children:[a==="planning"&&n.jsxs(n.Fragment,{children:[n.jsxs(ce,{variant:"outline",onClick:()=>{const oe=["Assembly Line","GMSOA NO.","SOA Sr. No.","Assembly Date","Unique Code","Splitted Code","Party","Customer PO No.","Code No","Product","Qty","Qty Exe.","Qty Pending","finished valve","GM LOGO","NAME PLATE","PRODUCT SPCL1","PRODUCT SPCL2","PRODUCT SPCL3","INSPECTION","PAINTING","remarks"],V={};oe.forEach(ee=>V[ee]="");const de=Bh.json_to_sheet([V]),Ne=Bh.book_new();Bh.book_append_sheet(Ne,de,"Order Format"),T$(Ne,"GMV_Order_Format.xlsx")},className:"flex items-center gap-2 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[n.jsx(c4,{className:"h-4 w-4"}),"Demo Excel"]}),n.jsxs(ce,{onClick:()=>c(!0),className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md transition-all",children:[n.jsx(x4,{className:"h-4 w-4"}),"Add New Order"]})]}),n.jsxs(ce,{variant:"ghost",size:"sm",className:"h-9 w-9 p-0 rounded-lg hover:bg-gray-100 relative",children:[n.jsx(QE,{className:"h-4 w-4 text-gray-500"}),n.jsx("div",{className:"absolute -top-1 -right-1 h-2 w-2 bg-red-500 rounded-full"})]}),n.jsxs(KM,{children:[n.jsx(XM,{asChild:!0,children:n.jsxs(GN,{className:"h-9 w-9 cursor-pointer ring-2 ring-transparent hover:ring-[#a3c4e7] transition-all duration-300 hover:scale-110",children:[n.jsx(YN,{src:"/api/placeholder/36/36"}),n.jsx(KN,{className:"bg-gradient-to-br from-[#2461c7] to-[#174a9f] text-white text-sm font-medium",children:"GM"})]})}),n.jsx(JM,{align:"end",className:"w-48 mt-2",children:n.jsxs(ZM,{onClick:e,className:"text-red-600 cursor-pointer focus:bg-red-50",children:[n.jsx(h4,{className:"h-4 w-4 mr-2"}),"Sign Out"]})})]})]})]})})}),n.jsx(xt,{open:o,onOpenChange:c,children:n.jsxs(mt,{className:"max-w-lg mx-auto bg-white rounded-2xl shadow-2xl border-0",children:[n.jsxs(gt,{children:[n.jsx(yt,{className:"text-2xl font-semibold text-gray-900 text-center",children:"Add New Order"}),n.jsx(vt,{className:"text-gray-600 text-center",children:"Upload an Excel or CSV file to add new orders to your system."})]}),n.jsxs("div",{className:"p-6 space-y-6",children:[n.jsx("div",{className:`
          relative border-2 border-dashed rounded-xl p-8 text-center transition-all duration-200
          ${h?"border-[#174a9f] bg-[#e8f0f9]":"border-gray-300 hover:border-gray-400"}
          ${u?"bg-green-50 border-green-300":""}
        `,onDrop:J,onDragOver:ne,onDragLeave:fe,children:u?n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:n.jsx(u4,{className:"w-6 h-6 text-green-600"})}),n.jsx("p",{className:"font-medium text-gray-900",children:u.name}),n.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[(u.size/1024).toFixed(1)," KB"]}),n.jsxs(ce,{variant:"outline",size:"sm",onClick:K,className:"text-red-600 border-red-200 hover:bg-red-50",children:[n.jsx(hu,{className:"w-4 h-4 mr-2"}),"Remove File"]})]}):n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"mx-auto w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:n.jsx(k4,{className:"w-6 h-6 text-gray-600"})}),n.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Drag and drop your file here"}),n.jsx("p",{className:"text-gray-500 mb-4",children:"or"}),n.jsx(ce,{variant:"outline",onClick:me,className:"border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9]",children:"Choose File"}),n.jsx("p",{className:"text-xs text-gray-400",children:"Supports Excel files (.xlsx, .xls) and CSV files (.csv)"})]})}),w&&n.jsxs("div",{className:`flex flex-col gap-2 text-sm p-3 rounded-md ${k==="success"?"bg-green-50 text-green-700 border border-green-200":k==="warning"?"bg-yellow-50 text-yellow-700 border border-yellow-200":k==="error"?"bg-red-50 text-red-700 border border-red-200":"text-gray-600"}`,children:[n.jsxs("div",{className:"flex items-center gap-2",children:[k==="success"&&n.jsx(r4,{className:"h-4 w-4"}),k==="warning"&&n.jsx(b4,{className:"h-4 w-4"}),k==="error"&&n.jsx(s4,{className:"h-4 w-4"}),n.jsx("span",{children:w})]}),F&&n.jsxs("div",{className:"mt-2",children:[n.jsx("p",{className:"text-sm font-medium text-gray-700",children:G==="header"?"Your uploaded Excel headers dont match the required format.":"Validation errors found in uploaded Excel data."}),n.jsx("a",{href:F,download:"Error_Report.xlsx",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline hover:text-blue-800 text-sm",children:"Download error report"})]})]}),n.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>c(!1),className:"px-6",children:"Cancel"}),n.jsx(ce,{onClick:Q,disabled:!u||y,className:"px-6 bg-[#1457f6] hover:bg-[#1145d4] text-white shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:y?"Uploading...":"Submit"})]})]}),n.jsx("input",{type:"file",ref:O,onChange:le,accept:".xlsx,.xls,.csv",className:"hidden"})]})})]})};function W$(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const he=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((he?.data?.Resp_code==="true"||he?.data?.Resp_code===!0||he?.data?.Resp_code==="RCS")&&Array.isArray(he.data.data)){const pe=he.data.data.map(_e=>({id:String(_e.id),assemblyLine:_e.assembly_no||"",gmsoaNo:_e.soa_no||"",soaSrNo:_e.soa_sr_no||"",assemblyDate:_e.assembly_date||"",uniqueCode:_e.unique_code||_e.order_no||"",splittedCode:_e.splitted_code||"",party:_e.party_name||_e.party||"",customerPoNo:_e.customer_po_no||"",codeNo:_e.code_no||"",product:_e.product||"",qty:Number(_e.qty||0),qtyExe:Number(_e.qty_executed||0),qtyPending:Number(_e.qty_pending||0),finishedValve:_e.finished_valve||"",gmLogo:_e.gm_logo||"",namePlate:_e.name_plate||"",productSpcl1:_e.product_spc1||"",productSpcl2:_e.product_spc2||"",productSpcl3:_e.product_spc3||"",inspection:_e.inspection||"",painting:_e.painting||"",remarks:_e.remarks||"",alertStatus:_e.is_urgent===!0||_e.is_urgent==="true"||_e.alert_status===!0||_e.alert_status==="true"||_e.urgent===1||_e.urgent==="1"}));console.log(" Orders fetched:",pe.length,"records"),o(pe),h(null),Mt(null)}else console.warn(" No valid order data received",he.data),o([]),h(he?.data?.Resp_desc||"Failed to fetch orders")}catch(he){console.error("Error fetching orders:",he),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(he=>he.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(he=>he.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(he=>he.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let he=a.slice();if(v&&(he=he.filter(Re=>s(String(Re.id))||Re.alertStatus)),b!=="all"&&(he=he.filter(Re=>Re.assemblyLine===b)),j!=="all"&&(he=he.filter(Re=>Re.gmsoaNo===j)),T!=="all"&&(he=he.filter(Re=>Re.party===T)),(B||z)&&(he=he.filter(Re=>{if(!Re.assemblyDate||Re.assemblyDate==="HOLD")return!1;const _e=(at=>{if(!at)return null;const d=at.trim().match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if(!d)return null;const[,A,E,S]=d,P=Number(A),se=Number(E),C=Number(S),M=new Date(C,se-1,P);return M.getFullYear()!==C||M.getMonth()!==se-1||M.getDate()!==P?null:M})(Re.assemblyDate);if(!_e)return!1;if(I==="year"&&B)return _e.getFullYear()===B.getFullYear();if(I==="month"&&B)return _e.getFullYear()===B.getFullYear()&&_e.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return _e>=B&&_e<=z;if(B)return _e>=B;if(z)return _e<=z}return!0})),x.trim()){const Re=x.toLowerCase();he=he.filter(pe=>String(pe.uniqueCode).toLowerCase().includes(Re)||String(pe.party).toLowerCase().includes(Re)||String(pe.gmsoaNo).toLowerCase().includes(Re))}return he},[a,x,v,b,j,T,I,B,z,s]),Ft=he=>{fe(Re=>{const pe=new Set(Re);return pe.has(he)?pe.delete(he):pe.add(he),pe})},Gt=()=>{fe(he=>he.size===Ue.length?new Set:new Set(Ue.map(Re=>Re.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t=he=>{Fe(he),le(!0),oe(""),de(String(he.qtyPending??he.qty??0)),ee(!1),re(""),Z(""),ie({})},Ct=a.filter(he=>ne.has(he.id)),Wt=()=>ve(!0),qt=()=>{const he=document.getElementById("printable-bin-card");if(!he)return;let Re="";Ct.forEach(pe=>{Re+=`
      <div style="
        border:1px solid #ccc;
        padding:20px;
        border-radius:10px;
        margin-bottom:30px;
        page-break-inside: avoid;
      ">
        <h2 style="text-align:center; font-size:20px; font-weight:bold; margin-bottom:15px;">
          Assembly Line: ${pe.assemblyLine}
        </h2>

        <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
          <div><strong>Assembly Date:</strong> ${pe.assemblyDate}</div>
          <div><strong>GMSOA No - SR. NO:</strong> ${pe.gmsoaNo} - ${pe.soaSrNo}</div>
        </div>

        <div style="margin-bottom:15px;">
          <strong>Item Description:</strong><br>
          ${pe.product}
        </div>

        <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
          <div><strong>QTY:</strong> ${pe.qty}</div>
          <div><strong>GM Logo:</strong> ${pe.gmLogo}</div>
        </div>

        <div style="margin-top:20px; border-top:1px solid #aaa; padding-top:15px;">
          <strong>Inspected by:</strong>
          <div style="height:30px; border-bottom:1px solid #555;"></div>
        </div>
      </div>`}),he.innerHTML=Re,he.style.display="block",setTimeout(()=>{window.print(),he.style.display="none"},200)},Bt=he=>{ut(he),Me(!0)},$t=he=>{Le(he),rt(t(he.id)||he.remarks||""),Ge(!0)},Ut=async()=>{if(!Be)return;const he=new FormData;he.append("orderId",String(Be.id)),he.append("remarks",ft);try{const Re=await Ze.post(`${pt}/add-remarks`,he,{headers:{Authorization:`Bearer ${St}`}});if(console.log("Add Remarks Response:",Re.data),Re.data?.Resp_code==="true"||Re.data?.Resp_code===!0){o(_e=>_e.map(at=>at.id===Be.id?{...at,remarks:ft}:at));try{e(Be.id,ft)}catch{}Ge(!1),Le(null),rt("")}else console.warn("Backend rejected remarks:",Re.data)}catch(Re){console.error("Error saving remarks:",Re)}},Lt=async he=>{console.log("----"),console.log("TOGGLE CALLED for:",he);try{const pe=a.find(S=>S.id===he)?.alertStatus===!0,_e=!pe,at=_e?"1":"0";console.log("CURRENT:",pe,"  NEW:",_e),o(S=>{const P=S.map(se=>se.id===he?{...se,alertStatus:_e}:se);return P.sort((se,C)=>(C.alertStatus===!0)-(se.alertStatus===!0)),P});const d={orderId:String(he),urgent:at};console.log("SENDING PAYLOAD:",d);const A=await Ze.post(`${pt}/mark-urgent`,d,{headers:{Authorization:`Bearer ${St}`}});if(console.log("BACKEND RESPONSE:",A.data),!(A.data?.Resp_code==="true"||A.data?.Resp_code===!0||A.data?.status===!0)){console.log("BACKEND FAILED, REVERTING"),o(S=>{const P=S.map(se=>se.id===he?{...se,alertStatus:pe}:se);return P.sort((se,C)=>(C.alertStatus===!0)-(se.alertStatus===!0)),P});return}console.log("TOGGLE SUCCESSFUL ")}catch(Re){console.error("ERROR:",Re),o(pe=>{const _e=pe.map(at=>at.id===he?{...at,alertStatus:order?.alertStatus}:at);return _e.sort((at,d)=>(d.alertStatus===!0)-(at.alertStatus===!0)),_e})}},[It,zt]=m.useState(null),ge=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx("div",{id:"printable-bin-card",style:{display:"none"}}),n.jsx(Kn,{role:"planning",currentPage:"Planning",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:he=>{window.location.href=`/${he.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Orders Management"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:he=>y(he.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Wt,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:ge,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(he=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(he.id),onCheckedChange:()=>Ft(he.id),"aria-label":`Select row ${he.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:he.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:he.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:he.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:he.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:he.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:he.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:he.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:he.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:he.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${he.remarks&&he.remarks.trim()!==""?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>$t(he),children:n.jsx(qn,{className:`h-4 w-4 ${he.remarks&&he.remarks.trim()!==""?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>Bt(he),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>_t(he),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${he.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:he.alertStatus?"Click to unmark urgent":"Click to mark as urgent",onClick:()=>{console.clear(),console.log("BUTTON CLICKED  orderId:",he.id),console.log("BEFORE CLICK  alertStatus:",he.alertStatus),Lt(he.id)},children:n.jsx(fr,{className:`h-4 w-4 ${he.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},he.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"!max-w-[1000px] max-h-[90vh] overflow-y-auto print-bin-card",children:[n.jsxs(gt,{children:[n.jsx(yt,{className:"text-xl font-semibold text-gray-900",children:"Bin Card Preview"}),n.jsx(vt,{children:"Review the bin card details before printing."})]}),n.jsx("div",{className:"space-y-6 py-4",children:Ct.map(he=>n.jsxs("div",{className:"border border-gray-300 rounded-xl p-6 bg-white shadow-sm",style:{marginBottom:"30px"},children:[n.jsxs("h2",{className:"text-lg font-bold text-center mb-4",children:["Assembly Line: ",he.assemblyLine]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[n.jsxs("div",{children:[n.jsx("strong",{children:"Assembly Date:"})," ",he.assemblyDate]}),n.jsxs("div",{children:[n.jsx("strong",{children:"GMSOA No - SR. NO:"})," ",he.gmsoaNo," -"," ",he.soaSrNo]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("strong",{children:"Item Description:"}),n.jsx("p",{children:he.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[n.jsxs("div",{children:[n.jsx("strong",{children:"QTY:"})," ",he.qty]}),n.jsxs("div",{children:[n.jsx("strong",{children:"GM Logo:"})," ",he.gmLogo]})]}),n.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-300",children:[n.jsx("strong",{children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 h-8"})]})]},he.id))}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:qt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"})," Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:he=>rt(he.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:Ut,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}const pj={planning:["material-issue"],"material-issue":["semi-qc"],"semi-qc":["phosphating"],phosphating:["assembly"],assembly:["testing1","testing2"],testing1:["marking1"],testing2:["marking2"],marking1:["pdi1"],marking2:["pdi2"],pdi1:["tpi","dispatch"],pdi2:["tpi","dispatch"],svs:["marking1"],dispatch:[],tpi:[]},g1={planning:"Planning","material-issue":"Material Issue","semi-qc":"Semi QC",phosphating:"Phosphating",assembly:"Assembly",testing1:"Testing 1",testing2:"Testing 2",marking1:"Marking 1",marking2:"Marking 2",svs:"Stock Valve Store (SVS)",pdi1:"PDI 1",pdi2:"PDI 2",dispatch:"Dispatch",tpi:"TPI"},jr=e=>{if(!e)return[];const r=e.trim().toLowerCase().replace(/\s+/g,"-");return pj[r]||[]},kr=e=>{if(!e)return"";const r=e.trim().toLowerCase();return g1[r]?g1[r]:r.replace(/-/g," ").replace(/\b\w/g,t=>t.toUpperCase())},vs=e=>{const r=e.trim().toLowerCase().replace(/\s+/g,"-");return(pj[r]?.length??0)===0};function q$(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const d=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((d?.data?.Resp_code==="true"||d?.data?.Resp_code===!0||d?.data?.Resp_code==="RCS")&&Array.isArray(d.data.data)){const E=d.data.data.map(S=>({id:String(S.id),assemblyLine:S.assembly_no||"",gmsoaNo:S.soa_no||"",soaSrNo:S.soa_sr_no||"",assemblyDate:S.assembly_date||"",uniqueCode:S.unique_code||S.order_no||"",splittedCode:S.splitted_code||"",party:S.party_name||S.party||"",customerPoNo:S.customer_po_no||"",codeNo:S.code_no||"",product:S.product||"",qty:Number(S.qty||0),qtyExe:Number(S.qty_executed||0),qtyPending:Number(S.qty_pending||0),finishedValve:S.finished_valve||"",gmLogo:S.gm_logo||"",namePlate:S.name_plate||"",productSpcl1:S.product_spc1||"",productSpcl2:S.product_spc2||"",productSpcl3:S.product_spc3||"",inspection:S.inspection||"",painting:S.painting||"",remarks:S.remarks||"",alertStatus:S.is_urgent===!0||S.is_urgent==="true"||S.alert_status===!0||S.alert_status==="true"||S.urgent===1||S.urgent==="1"}));console.log(" Orders fetched:",E.length,"records"),o(E),h(null),Mt(null)}else console.warn(" No valid order data received",d.data),o([]),h(d?.data?.Resp_desc||"Failed to fetch orders")}catch(d){console.error("Error fetching orders:",d),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(d=>d.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(d=>d.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(d=>d.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let d=a.slice();if(v&&(d=d.filter(A=>s(String(A.id))||A.alertStatus)),b!=="all"&&(d=d.filter(A=>A.assemblyLine===b)),j!=="all"&&(d=d.filter(A=>A.gmsoaNo===j)),T!=="all"&&(d=d.filter(A=>A.party===T)),(B||z)&&(d=d.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const S=A.assemblyDate.split(/[\/-]/).map(se=>se.trim()).map(se=>Number(se));if(S.some(se=>isNaN(se)))return!1;let P=null;if(S.length>=3){const[se,C,M]=S;P=new Date(M,C-1,se)}else if(S.length===2){const[se,C]=S;P=new Date(C,se-1,1)}else if(S.length===1){const[se]=S;P=new Date(se,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(I==="year"&&B)return P.getFullYear()===B.getFullYear();if(I==="month"&&B)return P.getFullYear()===B.getFullYear()&&P.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return P>=B&&P<=z;if(B)return P>=B;if(z)return P<=z}return!0})),x.trim()){const A=x.toLowerCase();d=d.filter(E=>String(E.uniqueCode).toLowerCase().includes(A)||String(E.party).toLowerCase().includes(A)||String(E.gmsoaNo).toLowerCase().includes(A))}return d},[a,x,v,b,j,T,I,B,z,s]),Ft=d=>{fe(A=>{const E=new Set(A);return E.has(d)?E.delete(d):E.add(d),E})},Gt=()=>{fe(d=>d.size===Ue.length?new Set:new Set(Ue.map(A=>A.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t="material-issue",Ct=jr(_t);console.log("Next step(s):",Ct.map(kr)),console.log("Is final step?",vs(_t));const Wt=d=>{const E=jr("material-issue");Fe(d),le(!0),oe(E[0]||""),de(String(d.qtyPending??d.qty??0)),ee(!1),re(""),Z(""),ie({})},qt=()=>{const d={},A=Number(K?.qtyPending??0),E=Number(V||0),S=Number(Y||0);if(we||(d.quickAssignStep="Please select a workflow step."),(!V||E<=0)&&(d.quickAssignQty="Quantity must be greater than 0."),E>A&&(d.quickAssignQty=`Cannot exceed available (${A})`),Ne){U||(d.splitAssignStep="Choose split step."),(!Y||S<=0)&&(d.splitAssignQty="Split quantity is required."),we===U&&(d.sameEngineer="Split step cannot be the same as main step.");const P=E+S;P!==A&&(d.totalQtyMismatch=`Total quantity (${P}) must equal available (${A}).`)}return ie(d),Object.keys(d).length===0},Bt=()=>{le(!1)},$t=a.filter(d=>ne.has(d.id)),Ut=()=>ve(!0),Lt=()=>window.print(),It=d=>{ut(d),Me(!0)},zt=d=>{Le(d),rt(d.remarks||""),Ge(!0)},ge=async()=>{if(!Be)return;const d=new FormData;d.append("orderId",String(Be.id)),d.append("remarks",ft);try{const A=await Ze.post(`${pt}/add-remarks`,d,{headers:{Authorization:`Bearer ${St}`}});A.data?.Resp_code==="true"?(o(E=>E.map(S=>S.id===Be.id?{...S,remarks:ft}:S)),Ge(!1),Le(null),rt("")):console.warn("Remarks failed:",A.data)}catch(A){console.error("Error saving remark:",A)}},he=async d=>{console.log("----"),console.log("TOGGLE CALLED for:",d);try{const E=a.find(W=>W.id===d)?.alertStatus===!0,S=!E,P=S?"1":"0";console.log("CURRENT:",E,"  NEW:",S),o(W=>{const q=W.map(H=>H.id===d?{...H,alertStatus:S}:H);return q.sort((H,X)=>(X.alertStatus===!0)-(H.alertStatus===!0)),q});const se={orderId:String(d),urgent:P};console.log("SENDING PAYLOAD:",se);const C=await Ze.post(`${pt}/mark-urgent`,se,{headers:{Authorization:`Bearer ${St}`}});if(console.log("BACKEND RESPONSE:",C.data),!(C.data?.Resp_code==="true"||C.data?.Resp_code===!0||C.data?.status===!0)){console.log("BACKEND FAILED, REVERTING"),o(W=>{const q=W.map(H=>H.id===d?{...H,alertStatus:E}:H);return q.sort((H,X)=>(X.alertStatus===!0)-(H.alertStatus===!0)),q});return}console.log("TOGGLE SUCCESSFUL ")}catch(A){console.error("ERROR:",A),o(E=>{const S=E.map(P=>P.id===d?{...P,alertStatus:order?.alertStatus}:P);return S.sort((P,se)=>(se.alertStatus===!0)-(P.alertStatus===!0)),S})}},[Re,pe]=m.useState(null),_e=async()=>{if(K&&qt()){pe({type:"info",message:"Assigning order, please wait..."});try{const d=localStorage.getItem("token");if(!d){pe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(V||0),E=Number(Y||0),S=new FormData;S.append("orderId",String(K.id)),S.append("totalQty",String(K.qty)),S.append("executedQty",String(A)),S.append("from_stage","material-issue"),S.append("to_stage","semi-qc"),console.log(" Assign main payload:",{orderId:K.id,totalQty:K.qty,executedQty:A,from_stage:"material-issue",to_stage:"semi-qc"});const P=await Ze.post(`${pt}/assign-order`,S,{headers:{Authorization:`Bearer ${d}`}});if((P.data?.Resp_code===!0||P.data?.Resp_code==="true"||P.data?.status===!0)&&Ne&&E>0){const C=new FormData;C.append("orderId",String(K.id)),C.append("totalQty",String(K.qty)),C.append("executedQty",String(E)),C.append("splitOrder","true"),C.append("from_stage","material-issue"),C.append("to_stage","semi-qc"),await Ze.post(`${pt}/assign-order`,C,{headers:{Authorization:`Bearer ${d}`}})}await Je(),setTimeout(()=>{le(!1),pe(null)},2e3)}catch(d){console.error(" Error assigning order:",d)}}},at=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:d=>{window.location.href=`/${d.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:d=>y(d.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Ut,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:at,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(d=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(d.id),onCheckedChange:()=>Ft(d.id),"aria-label":`Select row ${d.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:d.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:d.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:d.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:d.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:d.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:d.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:d.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:d.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${d.remarks&&d.remarks.trim()!==""?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>zt(d),children:n.jsx(qn,{className:`h-4 w-4 ${d.remarks&&d.remarks.trim()!==""?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>It(d),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Wt(d),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${d.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:d.alertStatus?"Click to unmark urgent":"Click to mark as urgent",onClick:()=>{console.clear(),console.log("BUTTON CLICKED  orderId:",d.id),console.log("BEFORE CLICK  alertStatus:",d.alertStatus),he(d.id)},children:n.jsx(fr,{className:`h-4 w-4 ${d.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},d.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsx("div",{className:"space-y-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select next step"})}),n.jsx(gn,{children:Ct.map(d=>n.jsx(qr,{value:d,children:kr(d)},d))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:d=>de(d.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]})}),Re&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Re.type==="success"?"bg-green-50 text-green-700 border border-green-200":Re.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Re.message.split(`
`).map((d,A)=>n.jsx("div",{children:d},A))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:Bt,children:"Cancel"}),n.jsx(ce,{onClick:()=>_e(Number(K.id),Number(K.qty)),className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:$t.map(d=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:d.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[d.gmsoaNo," - ",d.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},d.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:Lt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:d=>rt(d.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:ge,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function V$(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const d=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((d?.data?.Resp_code==="true"||d?.data?.Resp_code===!0||d?.data?.Resp_code==="RCS")&&Array.isArray(d.data.data)){const E=d.data.data.map(S=>({id:String(S.id),assemblyLine:S.assembly_no||"",gmsoaNo:S.soa_no||"",soaSrNo:S.soa_sr_no||"",assemblyDate:S.assembly_date||"",uniqueCode:S.unique_code||S.order_no||"",splittedCode:S.splitted_code||"",party:S.party_name||S.party||"",customerPoNo:S.customer_po_no||"",codeNo:S.code_no||"",product:S.product||"",qty:Number(S.qty||0),qtyExe:Number(S.qty_executed||0),qtyPending:Number(S.qty_pending||0),finishedValve:S.finished_valve||"",gmLogo:S.gm_logo||"",namePlate:S.name_plate||"",productSpcl1:S.product_spc1||"",productSpcl2:S.product_spc2||"",productSpcl3:S.product_spc3||"",inspection:S.inspection||"",painting:S.painting||"",remarks:S.remarks||"",alertStatus:S.is_urgent===!0||S.is_urgent==="true"||S.alert_status===!0||S.alert_status==="true"||S.urgent===1||S.urgent==="1"}));console.log(" Orders fetched:",E.length,"records"),o(E),h(null),Mt(null)}else console.warn(" No valid order data received",d.data),o([]),h(d?.data?.Resp_desc||"Failed to fetch orders")}catch(d){console.error("Error fetching orders:",d),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(d=>d.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(d=>d.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(d=>d.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let d=a.slice();if(v&&(d=d.filter(A=>s(String(A.id))||A.alertStatus)),b!=="all"&&(d=d.filter(A=>A.assemblyLine===b)),j!=="all"&&(d=d.filter(A=>A.gmsoaNo===j)),T!=="all"&&(d=d.filter(A=>A.party===T)),(B||z)&&(d=d.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const S=A.assemblyDate.split(/[\/-]/).map(se=>se.trim()).map(se=>Number(se));if(S.some(se=>isNaN(se)))return!1;let P=null;if(S.length>=3){const[se,C,M]=S;P=new Date(M,C-1,se)}else if(S.length===2){const[se,C]=S;P=new Date(C,se-1,1)}else if(S.length===1){const[se]=S;P=new Date(se,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(I==="year"&&B)return P.getFullYear()===B.getFullYear();if(I==="month"&&B)return P.getFullYear()===B.getFullYear()&&P.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return P>=B&&P<=z;if(B)return P>=B;if(z)return P<=z}return!0})),x.trim()){const A=x.toLowerCase();d=d.filter(E=>String(E.uniqueCode).toLowerCase().includes(A)||String(E.party).toLowerCase().includes(A)||String(E.gmsoaNo).toLowerCase().includes(A))}return d},[a,x,v,b,j,T,I,B,z,s]),Ft=d=>{fe(A=>{const E=new Set(A);return E.has(d)?E.delete(d):E.add(d),E})},Gt=()=>{fe(d=>d.size===Ue.length?new Set:new Set(Ue.map(A=>A.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t="semi-qc",Ct=jr(_t);console.log("Next step(s):",Ct.map(kr)),console.log("Is final step?",vs(_t));const Wt=d=>{const E=jr("semi-qc");Fe(d),le(!0),oe(E[0]||""),de(String(d.qtyPending??d.qty??0)),ee(!1),re(""),Z(""),ie({})},qt=()=>{const d={},A=Number(K?.qtyPending??0),E=Number(V||0),S=Number(Y||0);if(we||(d.quickAssignStep="Please select a workflow step."),(!V||E<=0)&&(d.quickAssignQty="Quantity must be greater than 0."),E>A&&(d.quickAssignQty=`Cannot exceed available (${A})`),Ne){U||(d.splitAssignStep="Choose split step."),(!Y||S<=0)&&(d.splitAssignQty="Split quantity is required."),we===U&&(d.sameEngineer="Split step cannot be the same as main step.");const P=E+S;P!==A&&(d.totalQtyMismatch=`Total quantity (${P}) must equal available (${A}).`)}return ie(d),Object.keys(d).length===0},Bt=()=>{le(!1)},$t=a.filter(d=>ne.has(d.id)),Ut=()=>ve(!0),Lt=()=>window.print(),It=d=>{ut(d),Me(!0)},zt=d=>{Le(d),rt(d.remarks||""),Ge(!0)},ge=async()=>{if(!Be)return;const d=new FormData;d.append("orderId",String(Be.id)),d.append("remarks",ft);try{const A=await Ze.post(`${pt}/add-remarks`,d,{headers:{Authorization:`Bearer ${St}`}});A.data?.Resp_code==="true"?(o(E=>E.map(S=>S.id===Be.id?{...S,remarks:ft}:S)),Ge(!1),Le(null),rt("")):console.warn("Remarks failed:",A.data)}catch(A){console.error("Error saving remark:",A)}},he=async d=>{console.log("----"),console.log("TOGGLE CALLED for:",d);try{const E=a.find(W=>W.id===d)?.alertStatus===!0,S=!E,P=S?"1":"0";console.log("CURRENT:",E,"  NEW:",S),o(W=>{const q=W.map(H=>H.id===d?{...H,alertStatus:S}:H);return q.sort((H,X)=>(X.alertStatus===!0)-(H.alertStatus===!0)),q});const se={orderId:String(d),urgent:P};console.log("SENDING PAYLOAD:",se);const C=await Ze.post(`${pt}/mark-urgent`,se,{headers:{Authorization:`Bearer ${St}`}});if(console.log("BACKEND RESPONSE:",C.data),!(C.data?.Resp_code==="true"||C.data?.Resp_code===!0||C.data?.status===!0)){console.log("BACKEND FAILED, REVERTING"),o(W=>{const q=W.map(H=>H.id===d?{...H,alertStatus:E}:H);return q.sort((H,X)=>(X.alertStatus===!0)-(H.alertStatus===!0)),q});return}console.log("TOGGLE SUCCESSFUL ")}catch(A){console.error("ERROR:",A),o(E=>{const S=E.map(P=>P.id===d?{...P,alertStatus:order?.alertStatus}:P);return S.sort((P,se)=>(se.alertStatus===!0)-(P.alertStatus===!0)),S})}},[Re,pe]=m.useState(null),_e=async()=>{if(K&&qt()){pe({type:"info",message:"Assigning order, please wait..."});try{const d=localStorage.getItem("token");if(!d){pe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(V||0),E=Number(Y||0),S=new FormData;S.append("orderId",String(K.id)),S.append("totalQty",String(K.qty)),S.append("executedQty",String(A)),console.log(" Assign main payload (FormData):",{orderId:K.id,totalQty:K.qty,executedQty:A});const P=await Ze.post(`${pt}/assign-order`,S,{headers:{Authorization:`Bearer ${d}`}});if(console.log(" Main assign response:",P.data),P.data?.Resp_code===!0||P.data?.Resp_code==="true"||P.data?.status===!0){if(Ne&&E>0){const C=new FormData;C.append("orderId",String(K.id)),C.append("totalQty",String(K.qty)),C.append("executedQty",String(E)),C.append("splitOrder","true");const M=await Ze.post(`${pt}/assign-order`,C,{headers:{Authorization:`Bearer ${d}`}});if(M.data?.Resp_code===!0||M.data?.Resp_code==="true"||M.data?.status===!0){const q=P.data?.data?.to_stage||"next stage",H=M.data?.data?.to_stage||"next stage";pe({type:"success",message:` Order assigned successfully! 
Main: ${A} units to ${q} 
Split: ${E} units to ${H}`})}else pe({type:"error",message:` Main assigned, but split failed: ${M.data?.Resp_desc||"Unknown error"}`})}else{const C=P.data?.data?.to_stage||"next stage",M=P.data?.data?.from_stage||"current stage";pe({type:"success",message:` Order assigned successfully! 
${A} units moved from ${M}  ${C}`})}await Je(),setTimeout(()=>{le(!1),pe(null)},2e3)}else pe({type:"error",message:` ${P.data?.Resp_desc||"Order assignment failed."}`})}catch(d){if(console.error(" Error assigning order:",d),d.response){const A=d.response.data?.message||d.response.data?.Resp_desc||"Validation failed.",E=d.response.data?.errors&&Object.entries(d.response.data.errors).map(([S,P])=>`${S}: ${P}`).join(`
`);pe({type:"error",message:` ${A}
${E||""}`})}else d.request?pe({type:"error",message:" No response from server. Please check your connection."}):pe({type:"error",message:` ${d.message}`})}}},at=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:d=>{window.location.href=`/${d.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Semi QC"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:d=>y(d.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Ut,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:at,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(d=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(d.id),onCheckedChange:()=>Ft(d.id),"aria-label":`Select row ${d.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:d.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:d.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:d.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:d.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:d.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:d.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:d.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:d.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${d.remarks&&d.remarks.trim()!==""?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>zt(d),children:n.jsx(qn,{className:`h-4 w-4 ${d.remarks&&d.remarks.trim()!==""?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>It(d),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Wt(d),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${d.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:d.alertStatus?"Click to unmark urgent":"Click to mark as urgent",onClick:()=>{console.clear(),console.log("BUTTON CLICKED  orderId:",d.id),console.log("BEFORE CLICK  alertStatus:",d.alertStatus),he(d.id)},children:n.jsx(fr,{className:`h-4 w-4 ${d.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},d.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsx("div",{className:"space-y-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select next step"})}),n.jsx(gn,{children:Ct.map(d=>n.jsx(qr,{value:d,children:kr(d)},d))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:d=>de(d.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]})}),Re&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Re.type==="success"?"bg-green-50 text-green-700 border border-green-200":Re.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Re.message.split(`
`).map((d,A)=>n.jsx("div",{children:d},A))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:Bt,children:"Cancel"}),n.jsx(ce,{onClick:()=>_e(Number(K.id),Number(K.qty)),className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:$t.map(d=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:d.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[d.gmsoaNo," - ",d.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},d.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:Lt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:d=>rt(d.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:ge,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function Q$(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const d=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((d?.data?.Resp_code==="true"||d?.data?.Resp_code===!0||d?.data?.Resp_code==="RCS")&&Array.isArray(d.data.data)){const E=d.data.data.map(S=>({id:String(S.id),assemblyLine:S.assembly_no||"",gmsoaNo:S.soa_no||"",soaSrNo:S.soa_sr_no||"",assemblyDate:S.assembly_date||"",uniqueCode:S.unique_code||S.order_no||"",splittedCode:S.splitted_code||"",party:S.party_name||S.party||"",customerPoNo:S.customer_po_no||"",codeNo:S.code_no||"",product:S.product||"",qty:Number(S.qty||0),qtyExe:Number(S.qty_executed||0),qtyPending:Number(S.qty_pending||0),finishedValve:S.finished_valve||"",gmLogo:S.gm_logo||"",namePlate:S.name_plate||"",productSpcl1:S.product_spc1||"",productSpcl2:S.product_spc2||"",productSpcl3:S.product_spc3||"",inspection:S.inspection||"",painting:S.painting||"",remarks:S.remarks||"",alertStatus:S.is_urgent===!0||S.is_urgent==="true"||S.alert_status===!0||S.alert_status==="true"||S.urgent===1||S.urgent==="1"}));console.log(" Orders fetched:",E.length,"records"),o(E),h(null),Mt(null)}else console.warn(" No valid order data received",d.data),o([]),h(d?.data?.Resp_desc||"Failed to fetch orders")}catch(d){console.error("Error fetching orders:",d),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(d=>d.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(d=>d.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(d=>d.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let d=a.slice();if(v&&(d=d.filter(A=>s(String(A.id))||A.alertStatus)),b!=="all"&&(d=d.filter(A=>A.assemblyLine===b)),j!=="all"&&(d=d.filter(A=>A.gmsoaNo===j)),T!=="all"&&(d=d.filter(A=>A.party===T)),(B||z)&&(d=d.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const S=A.assemblyDate.split(/[\/-]/).map(se=>se.trim()).map(se=>Number(se));if(S.some(se=>isNaN(se)))return!1;let P=null;if(S.length>=3){const[se,C,M]=S;P=new Date(M,C-1,se)}else if(S.length===2){const[se,C]=S;P=new Date(C,se-1,1)}else if(S.length===1){const[se]=S;P=new Date(se,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(I==="year"&&B)return P.getFullYear()===B.getFullYear();if(I==="month"&&B)return P.getFullYear()===B.getFullYear()&&P.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return P>=B&&P<=z;if(B)return P>=B;if(z)return P<=z}return!0})),x.trim()){const A=x.toLowerCase();d=d.filter(E=>String(E.uniqueCode).toLowerCase().includes(A)||String(E.party).toLowerCase().includes(A)||String(E.gmsoaNo).toLowerCase().includes(A))}return d},[a,x,v,b,j,T,I,B,z,s]),Ft=d=>{fe(A=>{const E=new Set(A);return E.has(d)?E.delete(d):E.add(d),E})},Gt=()=>{fe(d=>d.size===Ue.length?new Set:new Set(Ue.map(A=>A.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t="phosphating",Ct=jr(_t);console.log("Next step(s):",Ct.map(kr)),console.log("Is final step?",vs(_t));const Wt=d=>{const E=jr("phosphating");Fe(d),le(!0),oe(E[0]||""),de(String(d.qtyPending??d.qty??0)),ee(!1),re(""),Z(""),ie({})},qt=()=>{const d={},A=Number(K?.qtyPending??0),E=Number(V||0),S=Number(Y||0);if(we||(d.quickAssignStep="Please select a workflow step."),(!V||E<=0)&&(d.quickAssignQty="Quantity must be greater than 0."),E>A&&(d.quickAssignQty=`Cannot exceed available (${A})`),Ne){U||(d.splitAssignStep="Choose split step."),(!Y||S<=0)&&(d.splitAssignQty="Split quantity is required."),we===U&&(d.sameEngineer="Split step cannot be the same as main step.");const P=E+S;P!==A&&(d.totalQtyMismatch=`Total quantity (${P}) must equal available (${A}).`)}return ie(d),Object.keys(d).length===0},Bt=()=>{le(!1)},$t=a.filter(d=>ne.has(d.id)),Ut=()=>ve(!0),Lt=()=>window.print(),It=d=>{ut(d),Me(!0)},zt=d=>{Le(d),rt(t(d.id)||d.remarks||""),Ge(!0)},ge=()=>{Be&&(e(Be.id,ft),Ge(!1),Le(null),rt(""))},he=async d=>{try{if(s(d)){console.log("Already marked urgent, skipping:",d);return}o(S=>S.map(P=>P.id===d?{...P,alertStatus:!0}:P));try{r(d)}catch{}const A={orderId:String(d),urgent:"1"};console.log("Payload sent:",A);const E=await Ze.post(`${pt}/mark-urgent`,A,{headers:{Authorization:`Bearer ${St}`}});console.log("Mark urgent response:",E.data),E.data?.Resp_code==="true"||E.data?.Resp_code===!0||E.data?.status===!0?await Je():(o(S=>S.map(P=>P.id===d?{...P,alertStatus:!1}:P)),console.warn("Backend did not confirm urgent update:",E.data))}catch(A){console.error("Error marking urgent:",A),o(E=>E.map(S=>S.id===d?{...S,alertStatus:!1}:S))}},[Re,pe]=m.useState(null),_e=async()=>{if(K&&qt()){pe({type:"info",message:"Assigning order, please wait..."});try{const d=localStorage.getItem("token");if(!d){pe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(V||0),E=Number(Y||0),S=new FormData;S.append("orderId",String(K.id)),S.append("totalQty",String(K.qty)),S.append("executedQty",String(A)),S.append("from_stage","material-issue"),S.append("to_stage","semi-qc"),console.log(" Assign main payload (FormData):",{orderId:K.id,totalQty:K.qty,executedQty:A,from_stage:"material-issue",to_stage:"semi-qc"});const P=await Ze.post(`${pt}/assign-order`,S,{headers:{Authorization:`Bearer ${d}`}});if(console.log(" Main assign response:",P.data),P.data?.Resp_code===!0||P.data?.Resp_code==="true"||P.data?.status===!0){if(Ne&&E>0){const C=new FormData;C.append("orderId",String(K.id)),C.append("totalQty",String(K.qty)),C.append("executedQty",String(E)),C.append("splitOrder","true"),C.append("from_stage","material-issue"),C.append("to_stage","semi-qc");const M=await Ze.post(`${pt}/assign-order`,C,{headers:{Authorization:`Bearer ${d}`}});if(!(M.data?.Resp_code===!0||M.data?.Resp_code==="true"||M.data?.status===!0)){pe({type:"error",message:` Main assigned, but split failed: ${M.data?.Resp_desc||"Unknown error"}`});return}const q=P.data?.data?.to_stage||"semi-qc",H=M.data?.data?.to_stage||"semi-qc";pe({type:"success",message:` Order assigned successfully!
Main: ${A}  ${q}
Split: ${E}  ${H}`})}else{const C=P.data?.data?.to_stage||"semi-qc",M=P.data?.data?.from_stage||"material-issue";pe({type:"success",message:` Order assigned successfully!
${A} units moved from ${M}  ${C}`})}await Je(),setTimeout(()=>{le(!1),pe(null)},2e3)}else pe({type:"error",message:` ${P.data?.Resp_desc||"Order assignment failed."}`})}catch(d){if(console.error(" Error assigning order:",d),d.response){const A=d.response.data?.message||d.response.data?.Resp_desc||"Validation failed.",E=d.response.data?.errors&&Object.entries(d.response.data.errors).map(([S,P])=>`${S}: ${P}`).join(`
`);pe({type:"error",message:` ${A}
${E||""}`})}else d.request?pe({type:"error",message:" No response from server. Please check your connection."}):pe({type:"error",message:` ${d.message}`})}}},at=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:d=>{window.location.href=`/${d.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:d=>y(d.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Ut,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:at,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(d=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(d.id),onCheckedChange:()=>Ft(d.id),"aria-label":`Select row ${d.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:d.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:d.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:d.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:d.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:d.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:d.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:d.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:d.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${t(d.id)?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>zt(d),children:n.jsx(qn,{className:`h-4 w-4 ${t(d.id)?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>It(d),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Wt(d),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${s(d.id)||d.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:s(d.id)||d.alertStatus?"Marked as urgent":"Click to mark as urgent",onClick:()=>{!s(d.id)&&!d.alertStatus&&he(d.id)},children:n.jsx(fr,{className:`h-4 w-4 ${s(d.id)||d.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},d.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsx("div",{className:"space-y-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select next step"})}),n.jsx(gn,{children:Ct.map(d=>n.jsx(qr,{value:d,children:kr(d)},d))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:d=>de(d.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]})}),Re&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Re.type==="success"?"bg-green-50 text-green-700 border border-green-200":Re.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Re.message.split(`
`).map((d,A)=>n.jsx("div",{children:d},A))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:Bt,children:"Cancel"}),n.jsx(ce,{onClick:()=>_e(Number(K.id),Number(K.qty)),className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:$t.map(d=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:d.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[d.gmsoaNo," - ",d.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},d.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:Lt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:d=>rt(d.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:ge,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function H$(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const E=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((E?.data?.Resp_code==="true"||E?.data?.Resp_code===!0||E?.data?.Resp_code==="RCS")&&Array.isArray(E.data.data)){const P=E.data.data.map(se=>({id:String(se.id),assemblyLine:se.assembly_no||"",gmsoaNo:se.soa_no||"",soaSrNo:se.soa_sr_no||"",assemblyDate:se.assembly_date||"",uniqueCode:se.unique_code||se.order_no||"",splittedCode:se.splitted_code||"",party:se.party_name||se.party||"",customerPoNo:se.customer_po_no||"",codeNo:se.code_no||"",product:se.product||"",qty:Number(se.qty||0),qtyExe:Number(se.qty_executed||0),qtyPending:Number(se.qty_pending||0),finishedValve:se.finished_valve||"",gmLogo:se.gm_logo||"",namePlate:se.name_plate||"",productSpcl1:se.product_spc1||"",productSpcl2:se.product_spc2||"",productSpcl3:se.product_spc3||"",inspection:se.inspection||"",painting:se.painting||"",remarks:se.remarks||"",alertStatus:se.is_urgent===!0||se.is_urgent==="true"||se.alert_status===!0||se.alert_status==="true"||se.urgent===1||se.urgent==="1"}));console.log(" Orders fetched:",P.length,"records"),o(P),h(null),Mt(null)}else console.warn(" No valid order data received",E.data),o([]),h(E?.data?.Resp_desc||"Failed to fetch orders")}catch(E){console.error("Error fetching orders:",E),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(E=>E.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(E=>E.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(E=>E.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let E=a.slice();if(v&&(E=E.filter(S=>s(String(S.id))||S.alertStatus)),b!=="all"&&(E=E.filter(S=>S.assemblyLine===b)),j!=="all"&&(E=E.filter(S=>S.gmsoaNo===j)),T!=="all"&&(E=E.filter(S=>S.party===T)),(B||z)&&(E=E.filter(S=>{if(!S.assemblyDate||S.assemblyDate==="HOLD")return!1;const se=S.assemblyDate.split(/[\/-]/).map(M=>M.trim()).map(M=>Number(M));if(se.some(M=>isNaN(M)))return!1;let C=null;if(se.length>=3){const[M,W,q]=se;C=new Date(q,W-1,M)}else if(se.length===2){const[M,W]=se;C=new Date(W,M-1,1)}else if(se.length===1){const[M]=se;C=new Date(M,0,1)}else return!1;if(!C||isNaN(C.getTime()))return!1;if(I==="year"&&B)return C.getFullYear()===B.getFullYear();if(I==="month"&&B)return C.getFullYear()===B.getFullYear()&&C.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return C>=B&&C<=z;if(B)return C>=B;if(z)return C<=z}return!0})),x.trim()){const S=x.toLowerCase();E=E.filter(P=>String(P.uniqueCode).toLowerCase().includes(S)||String(P.party).toLowerCase().includes(S)||String(P.gmsoaNo).toLowerCase().includes(S))}return E},[a,x,v,b,j,T,I,B,z,s]),Ft=E=>{fe(S=>{const P=new Set(S);return P.has(E)?P.delete(E):P.add(E),P})},Gt=()=>{fe(E=>E.size===Ue.length?new Set:new Set(Ue.map(S=>S.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t="assembly",Ct=jr(_t),Wt=(K?.assemblyLine||"").toUpperCase().includes("D"),qt=Ct.filter(E=>E==="testing1"||E==="testing2"?Wt?E==="testing2":E==="testing1":!0);console.log("Next step(s):",Ct.map(kr)),console.log("Is final step?",vs(_t));const Bt=E=>{const P=jr("assembly");Fe(E),le(!0);const se=(E.assemblyLine||"").toUpperCase().includes("D"),C=P.filter(M=>M==="testing1"||M==="testing2"?se?M==="testing2":M==="testing1":!0);oe(C[0]||P[0]||""),de(String(E.qtyPending??E.qty??0)),ee(!1),re(""),Z(""),ie({})},$t=()=>{const E={},S=Number(K?.qtyPending??0),P=Number(V||0),se=Number(Y||0);if(we||(E.quickAssignStep="Please select a workflow step."),(!V||P<=0)&&(E.quickAssignQty="Quantity must be greater than 0."),P>S&&(E.quickAssignQty=`Cannot exceed available (${S})`),Ne){U||(E.splitAssignStep="Choose split step."),(!Y||se<=0)&&(E.splitAssignQty="Split quantity is required."),we===U&&(E.sameEngineer="Split step cannot be the same as main step.");const C=P+se;C!==S&&(E.totalQtyMismatch=`Total quantity (${C}) must equal available (${S}).`)}return ie(E),Object.keys(E).length===0},Ut=()=>{le(!1)},Lt=a.filter(E=>ne.has(E.id)),It=()=>ve(!0),zt=()=>window.print(),ge=E=>{ut(E),Me(!0)},he=E=>{Le(E),rt(t(E.id)||E.remarks||""),Ge(!0)},Re=()=>{Be&&(e(Be.id,ft),Ge(!1),Le(null),rt(""))},pe=async E=>{try{if(s(E)){console.log("Already marked urgent, skipping:",E);return}o(se=>se.map(C=>C.id===E?{...C,alertStatus:!0}:C));try{r(E)}catch{}const S={orderId:String(E),urgent:"1"};console.log("Payload sent:",S);const P=await Ze.post(`${pt}/mark-urgent`,S,{headers:{Authorization:`Bearer ${St}`}});console.log("Mark urgent response:",P.data),P.data?.Resp_code==="true"||P.data?.Resp_code===!0||P.data?.status===!0?await Je():(o(se=>se.map(C=>C.id===E?{...C,alertStatus:!1}:C)),console.warn("Backend did not confirm urgent update:",P.data))}catch(S){console.error("Error marking urgent:",S),o(P=>P.map(se=>se.id===E?{...se,alertStatus:!1}:se))}},[_e,at]=m.useState(null),d=async()=>{if(K&&$t()){at({type:"info",message:"Assigning order, please wait..."});try{const E=localStorage.getItem("token");if(!E){at({type:"error",message:"Token missing. Please log in again."});return}const S=Number(V||0),P=Number(Y||0),se=new FormData;se.append("orderId",String(K.id)),se.append("totalQty",String(K.qty)),se.append("executedQty",String(S)),console.log(" Assign main payload (FormData):",{orderId:K.id,totalQty:K.qty,executedQty:S});const C=await Ze.post(`${pt}/assign-order`,se,{headers:{Authorization:`Bearer ${E}`}});if(console.log(" Main assign response:",C.data),C.data?.Resp_code===!0||C.data?.Resp_code==="true"||C.data?.status===!0){if(Ne&&P>0){const W=new FormData;W.append("orderId",String(K.id)),W.append("totalQty",String(K.qty)),W.append("executedQty",String(P)),W.append("splitOrder","true");const q=await Ze.post(`${pt}/assign-order`,W,{headers:{Authorization:`Bearer ${E}`}});if(q.data?.Resp_code===!0||q.data?.Resp_code==="true"||q.data?.status===!0){const X=C.data?.data?.to_stage||"next stage",Se=q.data?.data?.to_stage||"next stage";at({type:"success",message:` Order assigned successfully! 
Main: ${S} units to ${X} 
Split: ${P} units to ${Se}`})}else at({type:"error",message:` Main assigned, but split failed: ${q.data?.Resp_desc||"Unknown error"}`})}else{const W=C.data?.data?.to_stage||"next stage",q=C.data?.data?.from_stage||"current stage";at({type:"success",message:` Order assigned successfully! 
${S} units moved from ${q}  ${W}`})}await Je(),setTimeout(()=>{le(!1),at(null)},2e3)}else at({type:"error",message:` ${C.data?.Resp_desc||"Order assignment failed."}`})}catch(E){if(console.error(" Error assigning order:",E),E.response){const S=E.response.data?.message||E.response.data?.Resp_desc||"Validation failed.",P=E.response.data?.errors&&Object.entries(E.response.data.errors).map(([se,C])=>`${se}: ${C}`).join(`
`);at({type:"error",message:` ${S}
${P||""}`})}else E.request?at({type:"error",message:" No response from server. Please check your connection."}):at({type:"error",message:` ${E.message}`})}}},A=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:E=>{window.location.href=`/${E.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:E=>y(E.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:It,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:A,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(E=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(E.id),onCheckedChange:()=>Ft(E.id),"aria-label":`Select row ${E.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:E.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:E.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:E.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:E.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:E.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:E.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:E.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:E.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:E.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${t(E.id)?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>he(E),children:n.jsx(qn,{className:`h-4 w-4 ${t(E.id)?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>ge(E),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Bt(E),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${s(E.id)||E.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:s(E.id)||E.alertStatus?"Marked as urgent":"Click to mark as urgent",onClick:()=>{!s(E.id)&&!E.alertStatus&&pe(E.id)},children:n.jsx(fr,{className:`h-4 w-4 ${s(E.id)||E.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},E.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsx("div",{className:"space-y-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select next step"})}),n.jsx(gn,{children:qt.map(E=>n.jsx(qr,{value:E,children:kr(E)},E))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:E=>de(E.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]})}),_e&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${_e.type==="success"?"bg-green-50 text-green-700 border border-green-200":_e.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:_e.message.split(`
`).map((E,S)=>n.jsx("div",{children:E},S))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:Ut,children:"Cancel"}),n.jsx(ce,{onClick:()=>d(Number(K.id),Number(K.qty)),className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:Lt.map(E=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:E.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:E.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[E.gmsoaNo," - ",E.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:E.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:E.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:E.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},E.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:zt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:E=>rt(E.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:Re,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function G$(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const d=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((d?.data?.Resp_code==="true"||d?.data?.Resp_code===!0||d?.data?.Resp_code==="RCS")&&Array.isArray(d.data.data)){const E=d.data.data.map(S=>({id:String(S.id),assemblyLine:S.assembly_no||"",gmsoaNo:S.soa_no||"",soaSrNo:S.soa_sr_no||"",assemblyDate:S.assembly_date||"",uniqueCode:S.unique_code||S.order_no||"",splittedCode:S.splitted_code||"",party:S.party_name||S.party||"",customerPoNo:S.customer_po_no||"",codeNo:S.code_no||"",product:S.product||"",qty:Number(S.qty||0),qtyExe:Number(S.qty_executed||0),qtyPending:Number(S.qty_pending||0),finishedValve:S.finished_valve||"",gmLogo:S.gm_logo||"",namePlate:S.name_plate||"",productSpcl1:S.product_spc1||"",productSpcl2:S.product_spc2||"",productSpcl3:S.product_spc3||"",inspection:S.inspection||"",painting:S.painting||"",remarks:S.remarks||"",alertStatus:S.is_urgent===!0||S.is_urgent==="true"||S.alert_status===!0||S.alert_status==="true"||S.urgent===1||S.urgent==="1"}));console.log(" Orders fetched:",E.length,"records"),o(E),h(null),Mt(null)}else console.warn(" No valid order data received",d.data),o([]),h(d?.data?.Resp_desc||"Failed to fetch orders")}catch(d){console.error("Error fetching orders:",d),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(d=>d.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(d=>d.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(d=>d.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let d=a.slice();if(v&&(d=d.filter(A=>s(String(A.id))||A.alertStatus)),b!=="all"&&(d=d.filter(A=>A.assemblyLine===b)),j!=="all"&&(d=d.filter(A=>A.gmsoaNo===j)),T!=="all"&&(d=d.filter(A=>A.party===T)),(B||z)&&(d=d.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const S=A.assemblyDate.split(/[\/-]/).map(se=>se.trim()).map(se=>Number(se));if(S.some(se=>isNaN(se)))return!1;let P=null;if(S.length>=3){const[se,C,M]=S;P=new Date(M,C-1,se)}else if(S.length===2){const[se,C]=S;P=new Date(C,se-1,1)}else if(S.length===1){const[se]=S;P=new Date(se,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(I==="year"&&B)return P.getFullYear()===B.getFullYear();if(I==="month"&&B)return P.getFullYear()===B.getFullYear()&&P.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return P>=B&&P<=z;if(B)return P>=B;if(z)return P<=z}return!0})),x.trim()){const A=x.toLowerCase();d=d.filter(E=>String(E.uniqueCode).toLowerCase().includes(A)||String(E.party).toLowerCase().includes(A)||String(E.gmsoaNo).toLowerCase().includes(A))}return d},[a,x,v,b,j,T,I,B,z,s]),Ft=d=>{fe(A=>{const E=new Set(A);return E.has(d)?E.delete(d):E.add(d),E})},Gt=()=>{fe(d=>d.size===Ue.length?new Set:new Set(Ue.map(A=>A.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t="testing1",Ct=jr(_t);console.log("Next step(s):",Ct.map(kr)),console.log("Is final step?",vs(_t));const Wt=d=>{const E=jr("testing1");Fe(d),le(!0),oe(E[0]||""),de(String(d.qtyPending??d.qty??0)),ee(!1),re(""),Z(""),ie({})},qt=()=>{const d={},A=Number(K?.qtyPending??0),E=Number(V||0),S=Number(Y||0);if(we||(d.quickAssignStep="Please select a workflow step."),(!V||E<=0)&&(d.quickAssignQty="Quantity must be greater than 0."),E>A&&(d.quickAssignQty=`Cannot exceed available (${A})`),Ne){U||(d.splitAssignStep="Choose split step."),(!Y||S<=0)&&(d.splitAssignQty="Split quantity is required."),we===U&&(d.sameEngineer="Split step cannot be the same as main step.");const P=E+S;P!==A&&(d.totalQtyMismatch=`Total quantity (${P}) must equal available (${A}).`)}return ie(d),Object.keys(d).length===0},Bt=()=>{le(!1)},$t=a.filter(d=>ne.has(d.id)),Ut=()=>ve(!0),Lt=()=>window.print(),It=d=>{ut(d),Me(!0)},zt=d=>{Le(d),rt(t(d.id)||d.remarks||""),Ge(!0)},ge=()=>{Be&&(e(Be.id,ft),Ge(!1),Le(null),rt(""))},he=async d=>{try{if(s(d)){console.log("Already marked urgent, skipping:",d);return}o(S=>S.map(P=>P.id===d?{...P,alertStatus:!0}:P));try{r(d)}catch{}const A={orderId:String(d),urgent:"1"};console.log("Payload sent:",A);const E=await Ze.post(`${pt}/mark-urgent`,A,{headers:{Authorization:`Bearer ${St}`}});console.log("Mark urgent response:",E.data),E.data?.Resp_code==="true"||E.data?.Resp_code===!0||E.data?.status===!0?await Je():(o(S=>S.map(P=>P.id===d?{...P,alertStatus:!1}:P)),console.warn("Backend did not confirm urgent update:",E.data))}catch(A){console.error("Error marking urgent:",A),o(E=>E.map(S=>S.id===d?{...S,alertStatus:!1}:S))}},[Re,pe]=m.useState(null),_e=async()=>{if(K&&qt()){pe({type:"info",message:"Assigning order, please wait..."});try{const d=localStorage.getItem("token");if(!d){pe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(V||0),E=Number(Y||0),S=new FormData;S.append("orderId",String(K.id)),S.append("totalQty",String(K.qty)),S.append("executedQty",String(A)),console.log(" Assign main payload (FormData):",{orderId:K.id,totalQty:K.qty,executedQty:A});const P=await Ze.post(`${pt}/assign-order`,S,{headers:{Authorization:`Bearer ${d}`}});if(console.log(" Main assign response:",P.data),P.data?.Resp_code===!0||P.data?.Resp_code==="true"||P.data?.status===!0){if(Ne&&E>0){const C=new FormData;C.append("orderId",String(K.id)),C.append("totalQty",String(K.qty)),C.append("executedQty",String(E)),C.append("splitOrder","true");const M=await Ze.post(`${pt}/assign-order`,C,{headers:{Authorization:`Bearer ${d}`}});if(M.data?.Resp_code===!0||M.data?.Resp_code==="true"||M.data?.status===!0){const q=P.data?.data?.to_stage||"next stage",H=M.data?.data?.to_stage||"next stage";pe({type:"success",message:` Order assigned successfully! 
Main: ${A} units to ${q} 
Split: ${E} units to ${H}`})}else pe({type:"error",message:` Main assigned, but split failed: ${M.data?.Resp_desc||"Unknown error"}`})}else{const C=P.data?.data?.to_stage||"next stage",M=P.data?.data?.from_stage||"current stage";pe({type:"success",message:` Order assigned successfully! 
${A} units moved from ${M}  ${C}`})}await Je(),setTimeout(()=>{le(!1),pe(null)},2e3)}else pe({type:"error",message:` ${P.data?.Resp_desc||"Order assignment failed."}`})}catch(d){if(console.error(" Error assigning order:",d),d.response){const A=d.response.data?.message||d.response.data?.Resp_desc||"Validation failed.",E=d.response.data?.errors&&Object.entries(d.response.data.errors).map(([S,P])=>`${S}: ${P}`).join(`
`);pe({type:"error",message:` ${A}
${E||""}`})}else d.request?pe({type:"error",message:" No response from server. Please check your connection."}):pe({type:"error",message:` ${d.message}`})}}},at=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:d=>{window.location.href=`/${d.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:d=>y(d.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Ut,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:at,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(d=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(d.id),onCheckedChange:()=>Ft(d.id),"aria-label":`Select row ${d.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:d.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:d.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:d.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:d.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:d.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:d.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:d.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:d.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${t(d.id)?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>zt(d),children:n.jsx(qn,{className:`h-4 w-4 ${t(d.id)?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>It(d),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Wt(d),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${s(d.id)||d.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:s(d.id)||d.alertStatus?"Marked as urgent":"Click to mark as urgent",onClick:()=>{!s(d.id)&&!d.alertStatus&&he(d.id)},children:n.jsx(fr,{className:`h-4 w-4 ${s(d.id)||d.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},d.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsx("div",{className:"space-y-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select next step"})}),n.jsx(gn,{children:Ct.map(d=>n.jsx(qr,{value:d,children:kr(d)},d))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:d=>de(d.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]})}),Re&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Re.type==="success"?"bg-green-50 text-green-700 border border-green-200":Re.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Re.message.split(`
`).map((d,A)=>n.jsx("div",{children:d},A))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:Bt,children:"Cancel"}),n.jsx(ce,{onClick:()=>_e(Number(K.id),Number(K.qty)),className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:$t.map(d=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:d.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[d.gmsoaNo," - ",d.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},d.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:Lt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:d=>rt(d.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:ge,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function Y$(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const d=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((d?.data?.Resp_code==="true"||d?.data?.Resp_code===!0||d?.data?.Resp_code==="RCS")&&Array.isArray(d.data.data)){const E=d.data.data.map(S=>({id:String(S.id),assemblyLine:S.assembly_no||"",gmsoaNo:S.soa_no||"",soaSrNo:S.soa_sr_no||"",assemblyDate:S.assembly_date||"",uniqueCode:S.unique_code||S.order_no||"",splittedCode:S.splitted_code||"",party:S.party_name||S.party||"",customerPoNo:S.customer_po_no||"",codeNo:S.code_no||"",product:S.product||"",qty:Number(S.qty||0),qtyExe:Number(S.qty_executed||0),qtyPending:Number(S.qty_pending||0),finishedValve:S.finished_valve||"",gmLogo:S.gm_logo||"",namePlate:S.name_plate||"",productSpcl1:S.product_spc1||"",productSpcl2:S.product_spc2||"",productSpcl3:S.product_spc3||"",inspection:S.inspection||"",painting:S.painting||"",remarks:S.remarks||"",alertStatus:S.is_urgent===!0||S.is_urgent==="true"||S.alert_status===!0||S.alert_status==="true"||S.urgent===1||S.urgent==="1"}));console.log(" Orders fetched:",E.length,"records"),o(E),h(null),Mt(null)}else console.warn(" No valid order data received",d.data),o([]),h(d?.data?.Resp_desc||"Failed to fetch orders")}catch(d){console.error("Error fetching orders:",d),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(d=>d.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(d=>d.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(d=>d.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let d=a.slice();if(v&&(d=d.filter(A=>s(String(A.id))||A.alertStatus)),b!=="all"&&(d=d.filter(A=>A.assemblyLine===b)),j!=="all"&&(d=d.filter(A=>A.gmsoaNo===j)),T!=="all"&&(d=d.filter(A=>A.party===T)),(B||z)&&(d=d.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const S=A.assemblyDate.split(/[\/-]/).map(se=>se.trim()).map(se=>Number(se));if(S.some(se=>isNaN(se)))return!1;let P=null;if(S.length>=3){const[se,C,M]=S;P=new Date(M,C-1,se)}else if(S.length===2){const[se,C]=S;P=new Date(C,se-1,1)}else if(S.length===1){const[se]=S;P=new Date(se,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(I==="year"&&B)return P.getFullYear()===B.getFullYear();if(I==="month"&&B)return P.getFullYear()===B.getFullYear()&&P.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return P>=B&&P<=z;if(B)return P>=B;if(z)return P<=z}return!0})),x.trim()){const A=x.toLowerCase();d=d.filter(E=>String(E.uniqueCode).toLowerCase().includes(A)||String(E.party).toLowerCase().includes(A)||String(E.gmsoaNo).toLowerCase().includes(A))}return d},[a,x,v,b,j,T,I,B,z,s]),Ft=d=>{fe(A=>{const E=new Set(A);return E.has(d)?E.delete(d):E.add(d),E})},Gt=()=>{fe(d=>d.size===Ue.length?new Set:new Set(Ue.map(A=>A.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t="testing2",Ct=jr(_t);console.log("Next step(s):",Ct.map(kr)),console.log("Is final step?",vs(_t));const Wt=d=>{const E=jr("testing2");Fe(d),le(!0),oe(E[0]||""),de(String(d.qtyPending??d.qty??0)),ee(!1),re(""),Z(""),ie({})},qt=()=>{const d={},A=Number(K?.qtyPending??0),E=Number(V||0),S=Number(Y||0);if(we||(d.quickAssignStep="Please select a workflow step."),(!V||E<=0)&&(d.quickAssignQty="Quantity must be greater than 0."),E>A&&(d.quickAssignQty=`Cannot exceed available (${A})`),Ne){U||(d.splitAssignStep="Choose split step."),(!Y||S<=0)&&(d.splitAssignQty="Split quantity is required."),we===U&&(d.sameEngineer="Split step cannot be the same as main step.");const P=E+S;P!==A&&(d.totalQtyMismatch=`Total quantity (${P}) must equal available (${A}).`)}return ie(d),Object.keys(d).length===0},Bt=()=>{le(!1)},$t=a.filter(d=>ne.has(d.id)),Ut=()=>ve(!0),Lt=()=>window.print(),It=d=>{ut(d),Me(!0)},zt=d=>{Le(d),rt(t(d.id)||d.remarks||""),Ge(!0)},ge=()=>{Be&&(e(Be.id,ft),Ge(!1),Le(null),rt(""))},he=async d=>{try{if(s(d)){console.log("Already marked urgent, skipping:",d);return}o(S=>S.map(P=>P.id===d?{...P,alertStatus:!0}:P));try{r(d)}catch{}const A={orderId:String(d),urgent:"1"};console.log("Payload sent:",A);const E=await Ze.post(`${pt}/mark-urgent`,A,{headers:{Authorization:`Bearer ${St}`}});console.log("Mark urgent response:",E.data),E.data?.Resp_code==="true"||E.data?.Resp_code===!0||E.data?.status===!0?await Je():(o(S=>S.map(P=>P.id===d?{...P,alertStatus:!1}:P)),console.warn("Backend did not confirm urgent update:",E.data))}catch(A){console.error("Error marking urgent:",A),o(E=>E.map(S=>S.id===d?{...S,alertStatus:!1}:S))}},[Re,pe]=m.useState(null),_e=async()=>{if(K&&qt()){pe({type:"info",message:"Assigning order, please wait..."});try{const d=localStorage.getItem("token");if(!d){pe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(V||0),E=Number(Y||0),S=new FormData;S.append("orderId",String(K.id)),S.append("totalQty",String(K.qty)),S.append("executedQty",String(A)),console.log(" Assign main payload (FormData):",{orderId:K.id,totalQty:K.qty,executedQty:A});const P=await Ze.post(`${pt}/assign-order`,S,{headers:{Authorization:`Bearer ${d}`}});if(console.log(" Main assign response:",P.data),P.data?.Resp_code===!0||P.data?.Resp_code==="true"||P.data?.status===!0){if(Ne&&E>0){const C=new FormData;C.append("orderId",String(K.id)),C.append("totalQty",String(K.qty)),C.append("executedQty",String(E)),C.append("splitOrder","true");const M=await Ze.post(`${pt}/assign-order`,C,{headers:{Authorization:`Bearer ${d}`}});if(M.data?.Resp_code===!0||M.data?.Resp_code==="true"||M.data?.status===!0){const q=P.data?.data?.to_stage||"next stage",H=M.data?.data?.to_stage||"next stage";pe({type:"success",message:` Order assigned successfully! 
Main: ${A} units to ${q} 
Split: ${E} units to ${H}`})}else pe({type:"error",message:` Main assigned, but split failed: ${M.data?.Resp_desc||"Unknown error"}`})}else{const C=P.data?.data?.to_stage||"next stage",M=P.data?.data?.from_stage||"current stage";pe({type:"success",message:` Order assigned successfully! 
${A} units moved from ${M}  ${C}`})}await Je(),setTimeout(()=>{le(!1),pe(null)},2e3)}else pe({type:"error",message:` ${P.data?.Resp_desc||"Order assignment failed."}`})}catch(d){if(console.error(" Error assigning order:",d),d.response){const A=d.response.data?.message||d.response.data?.Resp_desc||"Validation failed.",E=d.response.data?.errors&&Object.entries(d.response.data.errors).map(([S,P])=>`${S}: ${P}`).join(`
`);pe({type:"error",message:` ${A}
${E||""}`})}else d.request?pe({type:"error",message:" No response from server. Please check your connection."}):pe({type:"error",message:` ${d.message}`})}}},at=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:d=>{window.location.href=`/${d.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:d=>y(d.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Ut,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:at,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(d=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(d.id),onCheckedChange:()=>Ft(d.id),"aria-label":`Select row ${d.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:d.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:d.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:d.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:d.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:d.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:d.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:d.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:d.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${t(d.id)?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>zt(d),children:n.jsx(qn,{className:`h-4 w-4 ${t(d.id)?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>It(d),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Wt(d),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${s(d.id)||d.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:s(d.id)||d.alertStatus?"Marked as urgent":"Click to mark as urgent",onClick:()=>{!s(d.id)&&!d.alertStatus&&he(d.id)},children:n.jsx(fr,{className:`h-4 w-4 ${s(d.id)||d.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},d.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsx("div",{className:"space-y-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select next step"})}),n.jsx(gn,{children:Ct.map(d=>n.jsx(qr,{value:d,children:kr(d)},d))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:d=>de(d.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]})}),Re&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Re.type==="success"?"bg-green-50 text-green-700 border border-green-200":Re.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Re.message.split(`
`).map((d,A)=>n.jsx("div",{children:d},A))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:Bt,children:"Cancel"}),n.jsx(ce,{onClick:()=>_e(Number(K.id),Number(K.qty)),className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:$t.map(d=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:d.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[d.gmsoaNo," - ",d.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},d.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:Lt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:d=>rt(d.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:ge,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function K$(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const d=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((d?.data?.Resp_code==="true"||d?.data?.Resp_code===!0||d?.data?.Resp_code==="RCS")&&Array.isArray(d.data.data)){const E=d.data.data.map(S=>({id:String(S.id),assemblyLine:S.assembly_no||"",gmsoaNo:S.soa_no||"",soaSrNo:S.soa_sr_no||"",assemblyDate:S.assembly_date||"",uniqueCode:S.unique_code||S.order_no||"",splittedCode:S.splitted_code||"",party:S.party_name||S.party||"",customerPoNo:S.customer_po_no||"",codeNo:S.code_no||"",product:S.product||"",qty:Number(S.qty||0),qtyExe:Number(S.qty_executed||0),qtyPending:Number(S.qty_pending||0),finishedValve:S.finished_valve||"",gmLogo:S.gm_logo||"",namePlate:S.name_plate||"",productSpcl1:S.product_spc1||"",productSpcl2:S.product_spc2||"",productSpcl3:S.product_spc3||"",inspection:S.inspection||"",painting:S.painting||"",remarks:S.remarks||"",alertStatus:S.is_urgent===!0||S.is_urgent==="true"||S.alert_status===!0||S.alert_status==="true"||S.urgent===1||S.urgent==="1"}));console.log(" Orders fetched:",E.length,"records"),o(E),h(null),Mt(null)}else console.warn(" No valid order data received",d.data),o([]),h(d?.data?.Resp_desc||"Failed to fetch orders")}catch(d){console.error("Error fetching orders:",d),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(d=>d.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(d=>d.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(d=>d.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let d=a.slice();if(v&&(d=d.filter(A=>s(String(A.id))||A.alertStatus)),b!=="all"&&(d=d.filter(A=>A.assemblyLine===b)),j!=="all"&&(d=d.filter(A=>A.gmsoaNo===j)),T!=="all"&&(d=d.filter(A=>A.party===T)),(B||z)&&(d=d.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const S=A.assemblyDate.split(/[\/-]/).map(se=>se.trim()).map(se=>Number(se));if(S.some(se=>isNaN(se)))return!1;let P=null;if(S.length>=3){const[se,C,M]=S;P=new Date(M,C-1,se)}else if(S.length===2){const[se,C]=S;P=new Date(C,se-1,1)}else if(S.length===1){const[se]=S;P=new Date(se,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(I==="year"&&B)return P.getFullYear()===B.getFullYear();if(I==="month"&&B)return P.getFullYear()===B.getFullYear()&&P.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return P>=B&&P<=z;if(B)return P>=B;if(z)return P<=z}return!0})),x.trim()){const A=x.toLowerCase();d=d.filter(E=>String(E.uniqueCode).toLowerCase().includes(A)||String(E.party).toLowerCase().includes(A)||String(E.gmsoaNo).toLowerCase().includes(A))}return d},[a,x,v,b,j,T,I,B,z,s]),Ft=d=>{fe(A=>{const E=new Set(A);return E.has(d)?E.delete(d):E.add(d),E})},Gt=()=>{fe(d=>d.size===Ue.length?new Set:new Set(Ue.map(A=>A.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t="marking1",Ct=jr(_t);console.log("Next step(s):",Ct.map(kr)),console.log("Is final step?",vs(_t));const Wt=d=>{const E=jr("marking1");Fe(d),le(!0),oe(E[0]||""),de(String(d.qtyPending??d.qty??0)),ee(!1),re(""),Z(""),ie({})},qt=()=>{const d={},A=Number(K?.qtyPending??0),E=Number(V||0),S=Number(Y||0);if(we||(d.quickAssignStep="Please select a workflow step."),(!V||E<=0)&&(d.quickAssignQty="Quantity must be greater than 0."),E>A&&(d.quickAssignQty=`Cannot exceed available (${A})`),Ne){U||(d.splitAssignStep="Choose split step."),(!Y||S<=0)&&(d.splitAssignQty="Split quantity is required."),we===U&&(d.sameEngineer="Split step cannot be the same as main step.");const P=E+S;P!==A&&(d.totalQtyMismatch=`Total quantity (${P}) must equal available (${A}).`)}return ie(d),Object.keys(d).length===0},Bt=()=>{le(!1)},$t=a.filter(d=>ne.has(d.id)),Ut=()=>ve(!0),Lt=()=>window.print(),It=d=>{ut(d),Me(!0)},zt=d=>{Le(d),rt(t(d.id)||d.remarks||""),Ge(!0)},ge=()=>{Be&&(e(Be.id,ft),Ge(!1),Le(null),rt(""))},he=async d=>{try{if(s(d)){console.log("Already marked urgent, skipping:",d);return}o(S=>S.map(P=>P.id===d?{...P,alertStatus:!0}:P));try{r(d)}catch{}const A={orderId:String(d),urgent:"1"};console.log("Payload sent:",A);const E=await Ze.post(`${pt}/mark-urgent`,A,{headers:{Authorization:`Bearer ${St}`}});console.log("Mark urgent response:",E.data),E.data?.Resp_code==="true"||E.data?.Resp_code===!0||E.data?.status===!0?await Je():(o(S=>S.map(P=>P.id===d?{...P,alertStatus:!1}:P)),console.warn("Backend did not confirm urgent update:",E.data))}catch(A){console.error("Error marking urgent:",A),o(E=>E.map(S=>S.id===d?{...S,alertStatus:!1}:S))}},[Re,pe]=m.useState(null),_e=async()=>{if(K&&qt()){pe({type:"info",message:"Assigning order, please wait..."});try{const d=localStorage.getItem("token");if(!d){pe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(V||0),E=Number(Y||0),S=new FormData;S.append("orderId",String(K.id)),S.append("totalQty",String(K.qty)),S.append("executedQty",String(A)),console.log(" Assign main payload (FormData):",{orderId:K.id,totalQty:K.qty,executedQty:A});const P=await Ze.post(`${pt}/assign-order`,S,{headers:{Authorization:`Bearer ${d}`}});if(console.log(" Main assign response:",P.data),P.data?.Resp_code===!0||P.data?.Resp_code==="true"||P.data?.status===!0){if(Ne&&E>0){const C=new FormData;C.append("orderId",String(K.id)),C.append("totalQty",String(K.qty)),C.append("executedQty",String(E)),C.append("splitOrder","true");const M=await Ze.post(`${pt}/assign-order`,C,{headers:{Authorization:`Bearer ${d}`}});if(M.data?.Resp_code===!0||M.data?.Resp_code==="true"||M.data?.status===!0){const q=P.data?.data?.to_stage||"next stage",H=M.data?.data?.to_stage||"next stage";pe({type:"success",message:` Order assigned successfully! 
Main: ${A} units to ${q} 
Split: ${E} units to ${H}`})}else pe({type:"error",message:` Main assigned, but split failed: ${M.data?.Resp_desc||"Unknown error"}`})}else{const C=P.data?.data?.to_stage||"next stage",M=P.data?.data?.from_stage||"current stage";pe({type:"success",message:` Order assigned successfully! 
${A} units moved from ${M}  ${C}`})}await Je(),setTimeout(()=>{le(!1),pe(null)},2e3)}else pe({type:"error",message:` ${P.data?.Resp_desc||"Order assignment failed."}`})}catch(d){if(console.error(" Error assigning order:",d),d.response){const A=d.response.data?.message||d.response.data?.Resp_desc||"Validation failed.",E=d.response.data?.errors&&Object.entries(d.response.data.errors).map(([S,P])=>`${S}: ${P}`).join(`
`);pe({type:"error",message:` ${A}
${E||""}`})}else d.request?pe({type:"error",message:" No response from server. Please check your connection."}):pe({type:"error",message:` ${d.message}`})}}},at=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:d=>{window.location.href=`/${d.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:d=>y(d.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Ut,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:at,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(d=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(d.id),onCheckedChange:()=>Ft(d.id),"aria-label":`Select row ${d.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:d.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:d.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:d.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:d.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:d.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:d.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:d.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:d.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${t(d.id)?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>zt(d),children:n.jsx(qn,{className:`h-4 w-4 ${t(d.id)?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>It(d),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Wt(d),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${s(d.id)||d.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:s(d.id)||d.alertStatus?"Marked as urgent":"Click to mark as urgent",onClick:()=>{!s(d.id)&&!d.alertStatus&&he(d.id)},children:n.jsx(fr,{className:`h-4 w-4 ${s(d.id)||d.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},d.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsx("div",{className:"space-y-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select next step"})}),n.jsx(gn,{children:Ct.map(d=>n.jsx(qr,{value:d,children:kr(d)},d))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:d=>de(d.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]})}),Re&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Re.type==="success"?"bg-green-50 text-green-700 border border-green-200":Re.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Re.message.split(`
`).map((d,A)=>n.jsx("div",{children:d},A))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:Bt,children:"Cancel"}),n.jsx(ce,{onClick:()=>_e(Number(K.id),Number(K.qty)),className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:$t.map(d=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:d.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[d.gmsoaNo," - ",d.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},d.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:Lt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:d=>rt(d.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:ge,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function X$(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const d=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((d?.data?.Resp_code==="true"||d?.data?.Resp_code===!0||d?.data?.Resp_code==="RCS")&&Array.isArray(d.data.data)){const E=d.data.data.map(S=>({id:String(S.id),assemblyLine:S.assembly_no||"",gmsoaNo:S.soa_no||"",soaSrNo:S.soa_sr_no||"",assemblyDate:S.assembly_date||"",uniqueCode:S.unique_code||S.order_no||"",splittedCode:S.splitted_code||"",party:S.party_name||S.party||"",customerPoNo:S.customer_po_no||"",codeNo:S.code_no||"",product:S.product||"",qty:Number(S.qty||0),qtyExe:Number(S.qty_executed||0),qtyPending:Number(S.qty_pending||0),finishedValve:S.finished_valve||"",gmLogo:S.gm_logo||"",namePlate:S.name_plate||"",productSpcl1:S.product_spc1||"",productSpcl2:S.product_spc2||"",productSpcl3:S.product_spc3||"",inspection:S.inspection||"",painting:S.painting||"",remarks:S.remarks||"",alertStatus:S.is_urgent===!0||S.is_urgent==="true"||S.alert_status===!0||S.alert_status==="true"||S.urgent===1||S.urgent==="1"}));console.log(" Orders fetched:",E.length,"records"),o(E),h(null),Mt(null)}else console.warn(" No valid order data received",d.data),o([]),h(d?.data?.Resp_desc||"Failed to fetch orders")}catch(d){console.error("Error fetching orders:",d),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(d=>d.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(d=>d.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(d=>d.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let d=a.slice();if(v&&(d=d.filter(A=>s(String(A.id))||A.alertStatus)),b!=="all"&&(d=d.filter(A=>A.assemblyLine===b)),j!=="all"&&(d=d.filter(A=>A.gmsoaNo===j)),T!=="all"&&(d=d.filter(A=>A.party===T)),(B||z)&&(d=d.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const S=A.assemblyDate.split(/[\/-]/).map(se=>se.trim()).map(se=>Number(se));if(S.some(se=>isNaN(se)))return!1;let P=null;if(S.length>=3){const[se,C,M]=S;P=new Date(M,C-1,se)}else if(S.length===2){const[se,C]=S;P=new Date(C,se-1,1)}else if(S.length===1){const[se]=S;P=new Date(se,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(I==="year"&&B)return P.getFullYear()===B.getFullYear();if(I==="month"&&B)return P.getFullYear()===B.getFullYear()&&P.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return P>=B&&P<=z;if(B)return P>=B;if(z)return P<=z}return!0})),x.trim()){const A=x.toLowerCase();d=d.filter(E=>String(E.uniqueCode).toLowerCase().includes(A)||String(E.party).toLowerCase().includes(A)||String(E.gmsoaNo).toLowerCase().includes(A))}return d},[a,x,v,b,j,T,I,B,z,s]),Ft=d=>{fe(A=>{const E=new Set(A);return E.has(d)?E.delete(d):E.add(d),E})},Gt=()=>{fe(d=>d.size===Ue.length?new Set:new Set(Ue.map(A=>A.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t="marking2",Ct=jr(_t);console.log("Next step(s):",Ct.map(kr)),console.log("Is final step?",vs(_t));const Wt=d=>{const E=jr("marking2");Fe(d),le(!0),oe(E[0]||""),de(String(d.qtyPending??d.qty??0)),ee(!1),re(""),Z(""),ie({})},qt=()=>{const d={},A=Number(K?.qtyPending??0),E=Number(V||0),S=Number(Y||0);if(we||(d.quickAssignStep="Please select a workflow step."),(!V||E<=0)&&(d.quickAssignQty="Quantity must be greater than 0."),E>A&&(d.quickAssignQty=`Cannot exceed available (${A})`),Ne){U||(d.splitAssignStep="Choose split step."),(!Y||S<=0)&&(d.splitAssignQty="Split quantity is required."),we===U&&(d.sameEngineer="Split step cannot be the same as main step.");const P=E+S;P!==A&&(d.totalQtyMismatch=`Total quantity (${P}) must equal available (${A}).`)}return ie(d),Object.keys(d).length===0},Bt=()=>{le(!1)},$t=a.filter(d=>ne.has(d.id)),Ut=()=>ve(!0),Lt=()=>window.print(),It=d=>{ut(d),Me(!0)},zt=d=>{Le(d),rt(t(d.id)||d.remarks||""),Ge(!0)},ge=()=>{Be&&(e(Be.id,ft),Ge(!1),Le(null),rt(""))},he=async d=>{try{if(s(d)){console.log("Already marked urgent, skipping:",d);return}o(S=>S.map(P=>P.id===d?{...P,alertStatus:!0}:P));try{r(d)}catch{}const A={orderId:String(d),urgent:"1"};console.log("Payload sent:",A);const E=await Ze.post(`${pt}/mark-urgent`,A,{headers:{Authorization:`Bearer ${St}`}});console.log("Mark urgent response:",E.data),E.data?.Resp_code==="true"||E.data?.Resp_code===!0||E.data?.status===!0?await Je():(o(S=>S.map(P=>P.id===d?{...P,alertStatus:!1}:P)),console.warn("Backend did not confirm urgent update:",E.data))}catch(A){console.error("Error marking urgent:",A),o(E=>E.map(S=>S.id===d?{...S,alertStatus:!1}:S))}},[Re,pe]=m.useState(null),_e=async()=>{if(K&&qt()){pe({type:"info",message:"Assigning order, please wait..."});try{const d=localStorage.getItem("token");if(!d){pe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(V||0),E=Number(Y||0),S=new FormData;S.append("orderId",String(K.id)),S.append("totalQty",String(K.qty)),S.append("executedQty",String(A)),console.log(" Assign main payload (FormData):",{orderId:K.id,totalQty:K.qty,executedQty:A});const P=await Ze.post(`${pt}/assign-order`,S,{headers:{Authorization:`Bearer ${d}`}});if(console.log(" Main assign response:",P.data),P.data?.Resp_code===!0||P.data?.Resp_code==="true"||P.data?.status===!0){if(Ne&&E>0){const C=new FormData;C.append("orderId",String(K.id)),C.append("totalQty",String(K.qty)),C.append("executedQty",String(E)),C.append("splitOrder","true");const M=await Ze.post(`${pt}/assign-order`,C,{headers:{Authorization:`Bearer ${d}`}});if(M.data?.Resp_code===!0||M.data?.Resp_code==="true"||M.data?.status===!0){const q=P.data?.data?.to_stage||"next stage",H=M.data?.data?.to_stage||"next stage";pe({type:"success",message:` Order assigned successfully! 
Main: ${A} units to ${q} 
Split: ${E} units to ${H}`})}else pe({type:"error",message:` Main assigned, but split failed: ${M.data?.Resp_desc||"Unknown error"}`})}else{const C=P.data?.data?.to_stage||"next stage",M=P.data?.data?.from_stage||"current stage";pe({type:"success",message:` Order assigned successfully! 
${A} units moved from ${M}  ${C}`})}await Je(),setTimeout(()=>{le(!1),pe(null)},2e3)}else pe({type:"error",message:` ${P.data?.Resp_desc||"Order assignment failed."}`})}catch(d){if(console.error(" Error assigning order:",d),d.response){const A=d.response.data?.message||d.response.data?.Resp_desc||"Validation failed.",E=d.response.data?.errors&&Object.entries(d.response.data.errors).map(([S,P])=>`${S}: ${P}`).join(`
`);pe({type:"error",message:` ${A}
${E||""}`})}else d.request?pe({type:"error",message:" No response from server. Please check your connection."}):pe({type:"error",message:` ${d.message}`})}}},at=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:d=>{window.location.href=`/${d.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:d=>y(d.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Ut,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:at,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(d=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(d.id),onCheckedChange:()=>Ft(d.id),"aria-label":`Select row ${d.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:d.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:d.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:d.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:d.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:d.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:d.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:d.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:d.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${t(d.id)?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>zt(d),children:n.jsx(qn,{className:`h-4 w-4 ${t(d.id)?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>It(d),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Wt(d),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${s(d.id)||d.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:s(d.id)||d.alertStatus?"Marked as urgent":"Click to mark as urgent",onClick:()=>{!s(d.id)&&!d.alertStatus&&he(d.id)},children:n.jsx(fr,{className:`h-4 w-4 ${s(d.id)||d.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},d.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsx("div",{className:"space-y-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select next step"})}),n.jsx(gn,{children:Ct.map(d=>n.jsx(qr,{value:d,children:kr(d)},d))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:d=>de(d.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]})}),Re&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Re.type==="success"?"bg-green-50 text-green-700 border border-green-200":Re.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Re.message.split(`
`).map((d,A)=>n.jsx("div",{children:d},A))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:Bt,children:"Cancel"}),n.jsx(ce,{onClick:()=>_e(Number(K.id),Number(K.qty)),className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:$t.map(d=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:d.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[d.gmsoaNo," - ",d.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},d.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:Lt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:d=>rt(d.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:ge,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function J$(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(null),cr=m.useRef(null),Mt=localStorage.getItem("token"),Dt=async()=>{try{u(!0),h(null);const ge=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${Mt}`}});if((ge?.data?.Resp_code==="true"||ge?.data?.Resp_code===!0||ge?.data?.Resp_code==="RCS")&&Array.isArray(ge.data.data)){const pe=ge.data.data.map(_e=>({id:String(_e.id),assemblyLine:_e.assembly_no||"",gmsoaNo:_e.soa_no||"",soaSrNo:_e.soa_sr_no||"",assemblyDate:_e.assembly_date||"",uniqueCode:_e.unique_code||_e.order_no||"",splittedCode:_e.splitted_code||"",party:_e.party_name||_e.party||"",customerPoNo:_e.customer_po_no||"",codeNo:_e.code_no||"",product:_e.product||"",qty:Number(_e.qty||0),qtyExe:Number(_e.qty_executed||0),qtyPending:Number(_e.qty_pending||0),finishedValve:_e.finished_valve||"",gmLogo:_e.gm_logo||"",namePlate:_e.name_plate||"",productSpcl1:_e.product_spc1||"",productSpcl2:_e.product_spc2||"",productSpcl3:_e.product_spc3||"",inspection:_e.inspection||"",painting:_e.painting||"",remarks:_e.remarks||"",alertStatus:_e.is_urgent===!0||_e.is_urgent==="true"||_e.alert_status===!0||_e.alert_status==="true"||_e.urgent===1||_e.urgent==="1"})).filter(_e=>String(_e.finishedValve).trim().toLowerCase()==="yes");console.log(" SVS Orders fetched:",pe.length,"records"),o(pe),h(null),lr(null)}else console.warn(" No valid order data received",ge.data),o([]),h(ge?.data?.Resp_desc||"Failed to fetch orders")}catch(ge){console.error("Error fetching orders:",ge),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Dt()},[]);const St=m.useMemo(()=>Array.from(new Set(a.map(ge=>ge.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(ge=>ge.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(ge=>ge.party))).filter(Boolean).sort(),[a]);const Je=m.useMemo(()=>{let ge=a.slice();if(v&&(ge=ge.filter(he=>s(String(he.id))||he.alertStatus)),b!=="all"&&(ge=ge.filter(he=>he.assemblyLine===b)),j!=="all"&&(ge=ge.filter(he=>he.gmsoaNo===j)),T!=="all"&&(ge=ge.filter(he=>he.party===T)),(B||z)&&(ge=ge.filter(he=>{if(!he.assemblyDate||he.assemblyDate==="HOLD")return!1;const pe=he.assemblyDate.split(/[\/-]/).map(at=>at.trim()).map(at=>Number(at));if(pe.some(at=>isNaN(at)))return!1;let _e=null;if(pe.length>=3){const[at,d,A]=pe;_e=new Date(A,d-1,at)}else if(pe.length===2){const[at,d]=pe;_e=new Date(d,at-1,1)}else if(pe.length===1){const[at]=pe;_e=new Date(at,0,1)}else return!1;if(!_e||isNaN(_e.getTime()))return!1;if(I==="year"&&B)return _e.getFullYear()===B.getFullYear();if(I==="month"&&B)return _e.getFullYear()===B.getFullYear()&&_e.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return _e>=B&&_e<=z;if(B)return _e>=B;if(z)return _e<=z}return!0})),x.trim()){const he=x.toLowerCase();ge=ge.filter(Re=>String(Re.uniqueCode).toLowerCase().includes(he)||String(Re.party).toLowerCase().includes(he)||String(Re.gmsoaNo).toLowerCase().includes(he))}return ge},[a,x,v,b,j,T,I,B,z,s]),Ht=ge=>{fe(he=>{const Re=new Set(he);return Re.has(ge)?Re.delete(ge):Re.add(ge),Re})},Ue=()=>{fe(ge=>ge.size===Je.length?new Set:new Set(Je.map(he=>he.id)))},Ft=Je.length>0&&ne.size===Je.length,Gt=ge=>{Fe(ge),le(!0),oe("marking1"),de(String(ge.qtyPending??ge.qty??0)),ee(!1),re(""),Z(""),ie({})},kt=()=>{const ge={},he=Number(K?.qtyPending??0),Re=Number(V||0),pe=Number(Y||0);if((!V||Re<=0)&&(ge.quickAssignQty="Quantity is required and must be > 0"),Re>he&&(ge.quickAssignQty=`Cannot exceed available (${he})`),Ne){U||(ge.splitAssignStep="Choose second step"),(!Y||pe<=0)&&(ge.splitAssignQty="Split qty required"),we&&U&&we===U&&(ge.sameEngineer="Choose different steps");const _e=Re+pe;_e!==he&&(ge.totalQtyMismatch=`Split total must equal ${he} (current ${_e})`)}return ie(ge),Object.keys(ge).length===0},_t=()=>{le(!1)},Ct=a.filter(ge=>ne.has(ge.id)),Wt=()=>ve(!0),qt=()=>window.print(),Bt=ge=>{ut(ge),Me(!0)},$t=ge=>{Le(ge),rt(t(ge.id)||ge.remarks||""),Ge(!0)},Ut=()=>{Be&&(e(Be.id,ft),Ge(!1),Le(null),rt(""))},Lt=async ge=>{try{if(s(ge)){console.log("Already marked urgent, skipping:",ge);return}o(pe=>pe.map(_e=>_e.id===ge?{..._e,alertStatus:!0}:_e));try{r(ge)}catch{}const he={orderId:String(ge),urgent:"1"};console.log("Payload sent:",he);const Re=await Ze.post(`${pt}/mark-urgent`,he,{headers:{Authorization:`Bearer ${Mt}`}});console.log("Mark urgent response:",Re.data),Re.data?.Resp_code==="true"||Re.data?.Resp_code===!0||Re.data?.status===!0?await Dt():(o(pe=>pe.map(_e=>_e.id===ge?{..._e,alertStatus:!1}:_e)),console.warn("Backend did not confirm urgent update:",Re.data))}catch(he){console.error("Error marking urgent:",he),o(Re=>Re.map(pe=>pe.id===ge?{...pe,alertStatus:!1}:pe))}},It=async()=>{if(K&&kt()){Zt({type:"info",message:"Assigning order, please wait..."});try{const ge=localStorage.getItem("token");if(!ge){Zt({type:"error",message:"Token missing. Please log in again."});return}const he=Number(V||0),Re=Number(Y||0),pe=new FormData;pe.append("orderId",String(K.id)),pe.append("totalQty",String(K.qty)),pe.append("executedQty",String(he)),console.log(" Assign main payload (FormData):",{orderId:K.id,totalQty:K.qty,executedQty:he});const _e=await Ze.post(`${pt}/assign-order`,pe,{headers:{Authorization:`Bearer ${ge}`}});if(console.log(" Main assign response:",_e.data),_e.data?.Resp_code===!0||_e.data?.Resp_code==="true"||_e.data?.status===!0){if(Ne&&Re>0){const d=new FormData;d.append("orderId",String(K.id)),d.append("totalQty",String(K.qty)),d.append("executedQty",String(Re)),d.append("splitOrder","true");const A=await Ze.post(`${pt}/assign-order`,d,{headers:{Authorization:`Bearer ${ge}`}});if(A.data?.Resp_code===!0||A.data?.Resp_code==="true"||A.data?.status===!0){const S=_e.data?.data?.to_stage||"next stage",P=A.data?.data?.to_stage||"next stage";Zt({type:"success",message:` Order assigned successfully! 
Main: ${he} units to ${S} 
Split: ${Re} units to ${P}`})}else Zt({type:"error",message:` Main assigned, but split failed: ${A.data?.Resp_desc||"Unknown error"}`})}else{const d=_e.data?.data?.to_stage||"next stage",A=_e.data?.data?.from_stage||"current stage";Zt({type:"success",message:` Order assigned successfully! 
${he} units moved from ${A}  ${d}`})}await Dt(),setTimeout(()=>{le(!1),Zt(null)},2e3)}else Zt({type:"error",message:` ${_e.data?.Resp_desc||"Order assignment failed."}`})}catch(ge){if(console.error(" Error assigning order:",ge),ge.response){const he=ge.response.data?.message||ge.response.data?.Resp_desc||"Validation failed.",Re=ge.response.data?.errors&&Object.entries(ge.response.data.errors).map(([pe,_e])=>`${pe}: ${_e}`).join(`
`);Zt({type:"error",message:` ${he}
${Re||""}`})}else ge.request?Zt({type:"error",message:" No response from server. Please check your connection."}):Zt({type:"error",message:` ${ge.message}`})}}},zt=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:ge=>{window.location.href=`/${ge.toLowerCase()}`},onUploadSuccess:()=>Dt()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Stock Valve Store (SVS) Management"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage stock valve store orders and manufacturing workflow (Finished Valve = Yes)"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:ge=>y(ge.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Wt,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:St,onClearFilters:zt,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:cr,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ft),onClick:Ue,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${Ft?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Je.map(ge=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(ge.id),onCheckedChange:()=>Ht(ge.id),"aria-label":`Select row ${ge.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:ge.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:ge.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:ge.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:ge.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:ge.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:ge.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:ge.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:ge.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${t(ge.id)?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>$t(ge),children:n.jsx(qn,{className:`h-4 w-4 ${t(ge.id)?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>Bt(ge),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Gt(ge),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${s(ge.id)||ge.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:s(ge.id)||ge.alertStatus?"Marked as urgent":"Click to mark as urgent",onClick:()=>{!s(ge.id)&&!ge.alertStatus&&Lt(ge.id)},children:n.jsx(fr,{className:`h-4 w-4 ${s(ge.id)||ge.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},ge.id))})]}),Je.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No SVS orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select step"})}),n.jsx(gn,{children:n.jsx(qr,{value:"marking1",children:"Marking 1"})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:ge=>de(ge.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]}),n.jsx("div",{className:"space-y-4 border-t pt-4",children:n.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-700",children:["SVS orders can only move to ",n.jsx("span",{className:"font-medium",children:"Marking 1"}),". Splitting across different steps is disabled."]})})]}),Nr&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Nr.type==="success"?"bg-green-50 text-green-700 border border-green-200":Nr.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Nr.message.split(`
`).map((ge,he)=>n.jsx("div",{children:ge},he))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:_t,children:"Cancel"}),n.jsx(ce,{onClick:It,className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:Ct.map(ge=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:ge.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:ge.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[ge.gmsoaNo," - ",ge.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:ge.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:ge.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:ge.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},ge.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:qt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:ge=>rt(ge.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:Ut,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function Z$(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const d=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((d?.data?.Resp_code==="true"||d?.data?.Resp_code===!0||d?.data?.Resp_code==="RCS")&&Array.isArray(d.data.data)){const E=d.data.data.map(S=>({id:String(S.id),assemblyLine:S.assembly_no||"",gmsoaNo:S.soa_no||"",soaSrNo:S.soa_sr_no||"",assemblyDate:S.assembly_date||"",uniqueCode:S.unique_code||S.order_no||"",splittedCode:S.splitted_code||"",party:S.party_name||S.party||"",customerPoNo:S.customer_po_no||"",codeNo:S.code_no||"",product:S.product||"",qty:Number(S.qty||0),qtyExe:Number(S.qty_executed||0),qtyPending:Number(S.qty_pending||0),finishedValve:S.finished_valve||"",gmLogo:S.gm_logo||"",namePlate:S.name_plate||"",productSpcl1:S.product_spc1||"",productSpcl2:S.product_spc2||"",productSpcl3:S.product_spc3||"",inspection:S.inspection||"",painting:S.painting||"",remarks:S.remarks||"",alertStatus:S.is_urgent===!0||S.is_urgent==="true"||S.alert_status===!0||S.alert_status==="true"||S.urgent===1||S.urgent==="1"}));console.log(" Orders fetched:",E.length,"records"),o(E),h(null),Mt(null)}else console.warn(" No valid order data received",d.data),o([]),h(d?.data?.Resp_desc||"Failed to fetch orders")}catch(d){console.error("Error fetching orders:",d),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(d=>d.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(d=>d.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(d=>d.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let d=a.slice();if(v&&(d=d.filter(A=>s(String(A.id))||A.alertStatus)),b!=="all"&&(d=d.filter(A=>A.assemblyLine===b)),j!=="all"&&(d=d.filter(A=>A.gmsoaNo===j)),T!=="all"&&(d=d.filter(A=>A.party===T)),(B||z)&&(d=d.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const S=A.assemblyDate.split(/[\/-]/).map(se=>se.trim()).map(se=>Number(se));if(S.some(se=>isNaN(se)))return!1;let P=null;if(S.length>=3){const[se,C,M]=S;P=new Date(M,C-1,se)}else if(S.length===2){const[se,C]=S;P=new Date(C,se-1,1)}else if(S.length===1){const[se]=S;P=new Date(se,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(I==="year"&&B)return P.getFullYear()===B.getFullYear();if(I==="month"&&B)return P.getFullYear()===B.getFullYear()&&P.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return P>=B&&P<=z;if(B)return P>=B;if(z)return P<=z}return!0})),x.trim()){const A=x.toLowerCase();d=d.filter(E=>String(E.uniqueCode).toLowerCase().includes(A)||String(E.party).toLowerCase().includes(A)||String(E.gmsoaNo).toLowerCase().includes(A))}return d},[a,x,v,b,j,T,I,B,z,s]),Ft=d=>{fe(A=>{const E=new Set(A);return E.has(d)?E.delete(d):E.add(d),E})},Gt=()=>{fe(d=>d.size===Ue.length?new Set:new Set(Ue.map(A=>A.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t="pdi1",Ct=jr(_t);console.log("Next step(s):",Ct.map(kr)),console.log("Is final step?",vs(_t));const Wt=d=>{const E=jr("pdi1");Fe(d),le(!0),oe(E[0]||""),de(String(d.qtyPending??d.qty??0)),ee(!1),re(""),Z(""),ie({})},qt=()=>{const d={},A=Number(K?.qtyPending??0),E=Number(V||0),S=Number(Y||0);if(we||(d.quickAssignStep="Please select a workflow step."),(!V||E<=0)&&(d.quickAssignQty="Quantity must be greater than 0."),E>A&&(d.quickAssignQty=`Cannot exceed available (${A})`),Ne){U||(d.splitAssignStep="Choose split step."),(!Y||S<=0)&&(d.splitAssignQty="Split quantity is required."),we===U&&(d.sameEngineer="Split step cannot be the same as main step.");const P=E+S;P!==A&&(d.totalQtyMismatch=`Total quantity (${P}) must equal available (${A}).`)}return ie(d),Object.keys(d).length===0},Bt=()=>{le(!1)},$t=a.filter(d=>ne.has(d.id)),Ut=()=>ve(!0),Lt=()=>window.print(),It=d=>{ut(d),Me(!0)},zt=d=>{Le(d),rt(t(d.id)||d.remarks||""),Ge(!0)},ge=()=>{Be&&(e(Be.id,ft),Ge(!1),Le(null),rt(""))},he=async d=>{try{if(s(d)){console.log("Already marked urgent, skipping:",d);return}o(S=>S.map(P=>P.id===d?{...P,alertStatus:!0}:P));try{r(d)}catch{}const A={orderId:String(d),urgent:"1"};console.log("Payload sent:",A);const E=await Ze.post(`${pt}/mark-urgent`,A,{headers:{Authorization:`Bearer ${St}`}});console.log("Mark urgent response:",E.data),E.data?.Resp_code==="true"||E.data?.Resp_code===!0||E.data?.status===!0?await Je():(o(S=>S.map(P=>P.id===d?{...P,alertStatus:!1}:P)),console.warn("Backend did not confirm urgent update:",E.data))}catch(A){console.error("Error marking urgent:",A),o(E=>E.map(S=>S.id===d?{...S,alertStatus:!1}:S))}},[Re,pe]=m.useState(null),_e=async()=>{if(K&&qt()){pe({type:"info",message:"Assigning order, please wait..."});try{const d=localStorage.getItem("token");if(!d){pe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(V||0),E=Number(Y||0),S=new FormData;S.append("orderId",String(K.id)),S.append("totalQty",String(K.qty)),S.append("executedQty",String(A)),console.log(" Assign main payload (FormData):",{orderId:K.id,totalQty:K.qty,executedQty:A});const P=await Ze.post(`${pt}/assign-order`,S,{headers:{Authorization:`Bearer ${d}`}});if(console.log(" Main assign response:",P.data),P.data?.Resp_code===!0||P.data?.Resp_code==="true"||P.data?.status===!0){if(Ne&&E>0){const C=new FormData;C.append("orderId",String(K.id)),C.append("totalQty",String(K.qty)),C.append("executedQty",String(E)),C.append("splitOrder","true");const M=await Ze.post(`${pt}/assign-order`,C,{headers:{Authorization:`Bearer ${d}`}});if(M.data?.Resp_code===!0||M.data?.Resp_code==="true"||M.data?.status===!0){const q=P.data?.data?.to_stage||"next stage",H=M.data?.data?.to_stage||"next stage";pe({type:"success",message:` Order assigned successfully! 
Main: ${A} units to ${q} 
Split: ${E} units to ${H}`})}else pe({type:"error",message:` Main assigned, but split failed: ${M.data?.Resp_desc||"Unknown error"}`})}else{const C=P.data?.data?.to_stage||"next stage",M=P.data?.data?.from_stage||"current stage";pe({type:"success",message:` Order assigned successfully! 
${A} units moved from ${M}  ${C}`})}await Je(),setTimeout(()=>{le(!1),pe(null)},2e3)}else pe({type:"error",message:` ${P.data?.Resp_desc||"Order assignment failed."}`})}catch(d){if(console.error(" Error assigning order:",d),d.response){const A=d.response.data?.message||d.response.data?.Resp_desc||"Validation failed.",E=d.response.data?.errors&&Object.entries(d.response.data.errors).map(([S,P])=>`${S}: ${P}`).join(`
`);pe({type:"error",message:` ${A}
${E||""}`})}else d.request?pe({type:"error",message:" No response from server. Please check your connection."}):pe({type:"error",message:` ${d.message}`})}}},at=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:d=>{window.location.href=`/${d.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:d=>y(d.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Ut,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:at,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(d=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(d.id),onCheckedChange:()=>Ft(d.id),"aria-label":`Select row ${d.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:d.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:d.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:d.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:d.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:d.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:d.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:d.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:d.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${t(d.id)?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>zt(d),children:n.jsx(qn,{className:`h-4 w-4 ${t(d.id)?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>It(d),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Wt(d),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${s(d.id)||d.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:s(d.id)||d.alertStatus?"Marked as urgent":"Click to mark as urgent",onClick:()=>{!s(d.id)&&!d.alertStatus&&he(d.id)},children:n.jsx(fr,{className:`h-4 w-4 ${s(d.id)||d.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},d.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsx("div",{className:"space-y-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select next step"})}),n.jsx(gn,{children:Ct.map(d=>n.jsx(qr,{value:d,children:kr(d)},d))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:d=>de(d.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]})}),Re&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Re.type==="success"?"bg-green-50 text-green-700 border border-green-200":Re.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Re.message.split(`
`).map((d,A)=>n.jsx("div",{children:d},A))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:Bt,children:"Cancel"}),n.jsx(ce,{onClick:()=>_e(Number(K.id),Number(K.qty)),className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:$t.map(d=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:d.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[d.gmsoaNo," - ",d.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},d.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:Lt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:d=>rt(d.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:ge,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function eU(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const d=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((d?.data?.Resp_code==="true"||d?.data?.Resp_code===!0||d?.data?.Resp_code==="RCS")&&Array.isArray(d.data.data)){const E=d.data.data.map(S=>({id:String(S.id),assemblyLine:S.assembly_no||"",gmsoaNo:S.soa_no||"",soaSrNo:S.soa_sr_no||"",assemblyDate:S.assembly_date||"",uniqueCode:S.unique_code||S.order_no||"",splittedCode:S.splitted_code||"",party:S.party_name||S.party||"",customerPoNo:S.customer_po_no||"",codeNo:S.code_no||"",product:S.product||"",qty:Number(S.qty||0),qtyExe:Number(S.qty_executed||0),qtyPending:Number(S.qty_pending||0),finishedValve:S.finished_valve||"",gmLogo:S.gm_logo||"",namePlate:S.name_plate||"",productSpcl1:S.product_spc1||"",productSpcl2:S.product_spc2||"",productSpcl3:S.product_spc3||"",inspection:S.inspection||"",painting:S.painting||"",remarks:S.remarks||"",alertStatus:S.is_urgent===!0||S.is_urgent==="true"||S.alert_status===!0||S.alert_status==="true"||S.urgent===1||S.urgent==="1"}));console.log(" Orders fetched:",E.length,"records"),o(E),h(null),Mt(null)}else console.warn(" No valid order data received",d.data),o([]),h(d?.data?.Resp_desc||"Failed to fetch orders")}catch(d){console.error("Error fetching orders:",d),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(d=>d.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(d=>d.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(d=>d.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let d=a.slice();if(v&&(d=d.filter(A=>s(String(A.id))||A.alertStatus)),b!=="all"&&(d=d.filter(A=>A.assemblyLine===b)),j!=="all"&&(d=d.filter(A=>A.gmsoaNo===j)),T!=="all"&&(d=d.filter(A=>A.party===T)),(B||z)&&(d=d.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const S=A.assemblyDate.split(/[\/-]/).map(se=>se.trim()).map(se=>Number(se));if(S.some(se=>isNaN(se)))return!1;let P=null;if(S.length>=3){const[se,C,M]=S;P=new Date(M,C-1,se)}else if(S.length===2){const[se,C]=S;P=new Date(C,se-1,1)}else if(S.length===1){const[se]=S;P=new Date(se,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(I==="year"&&B)return P.getFullYear()===B.getFullYear();if(I==="month"&&B)return P.getFullYear()===B.getFullYear()&&P.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return P>=B&&P<=z;if(B)return P>=B;if(z)return P<=z}return!0})),x.trim()){const A=x.toLowerCase();d=d.filter(E=>String(E.uniqueCode).toLowerCase().includes(A)||String(E.party).toLowerCase().includes(A)||String(E.gmsoaNo).toLowerCase().includes(A))}return d},[a,x,v,b,j,T,I,B,z,s]),Ft=d=>{fe(A=>{const E=new Set(A);return E.has(d)?E.delete(d):E.add(d),E})},Gt=()=>{fe(d=>d.size===Ue.length?new Set:new Set(Ue.map(A=>A.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t="pdi2",Ct=jr(_t);console.log("Next step(s):",Ct.map(kr)),console.log("Is final step?",vs(_t));const Wt=d=>{const E=jr("pdi2");Fe(d),le(!0),oe(E[0]||""),de(String(d.qtyPending??d.qty??0)),ee(!1),re(""),Z(""),ie({})},qt=()=>{const d={},A=Number(K?.qtyPending??0),E=Number(V||0),S=Number(Y||0);if(we||(d.quickAssignStep="Please select a workflow step."),(!V||E<=0)&&(d.quickAssignQty="Quantity must be greater than 0."),E>A&&(d.quickAssignQty=`Cannot exceed available (${A})`),Ne){U||(d.splitAssignStep="Choose split step."),(!Y||S<=0)&&(d.splitAssignQty="Split quantity is required."),we===U&&(d.sameEngineer="Split step cannot be the same as main step.");const P=E+S;P!==A&&(d.totalQtyMismatch=`Total quantity (${P}) must equal available (${A}).`)}return ie(d),Object.keys(d).length===0},Bt=()=>{le(!1)},$t=a.filter(d=>ne.has(d.id)),Ut=()=>ve(!0),Lt=()=>window.print(),It=d=>{ut(d),Me(!0)},zt=d=>{Le(d),rt(t(d.id)||d.remarks||""),Ge(!0)},ge=()=>{Be&&(e(Be.id,ft),Ge(!1),Le(null),rt(""))},he=async d=>{try{if(s(d)){console.log("Already marked urgent, skipping:",d);return}o(S=>S.map(P=>P.id===d?{...P,alertStatus:!0}:P));try{r(d)}catch{}const A={orderId:String(d),urgent:"1"};console.log("Payload sent:",A);const E=await Ze.post(`${pt}/mark-urgent`,A,{headers:{Authorization:`Bearer ${St}`}});console.log("Mark urgent response:",E.data),E.data?.Resp_code==="true"||E.data?.Resp_code===!0||E.data?.status===!0?await Je():(o(S=>S.map(P=>P.id===d?{...P,alertStatus:!1}:P)),console.warn("Backend did not confirm urgent update:",E.data))}catch(A){console.error("Error marking urgent:",A),o(E=>E.map(S=>S.id===d?{...S,alertStatus:!1}:S))}},[Re,pe]=m.useState(null),_e=async()=>{if(K&&qt()){pe({type:"info",message:"Assigning order, please wait..."});try{const d=localStorage.getItem("token");if(!d){pe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(V||0),E=Number(Y||0),S=new FormData;S.append("orderId",String(K.id)),S.append("totalQty",String(K.qty)),S.append("executedQty",String(A)),console.log(" Assign main payload (FormData):",{orderId:K.id,totalQty:K.qty,executedQty:A});const P=await Ze.post(`${pt}/assign-order`,S,{headers:{Authorization:`Bearer ${d}`}});if(console.log(" Main assign response:",P.data),P.data?.Resp_code===!0||P.data?.Resp_code==="true"||P.data?.status===!0){if(Ne&&E>0){const C=new FormData;C.append("orderId",String(K.id)),C.append("totalQty",String(K.qty)),C.append("executedQty",String(E)),C.append("splitOrder","true");const M=await Ze.post(`${pt}/assign-order`,C,{headers:{Authorization:`Bearer ${d}`}});if(M.data?.Resp_code===!0||M.data?.Resp_code==="true"||M.data?.status===!0){const q=P.data?.data?.to_stage||"next stage",H=M.data?.data?.to_stage||"next stage";pe({type:"success",message:` Order assigned successfully! 
Main: ${A} units to ${q} 
Split: ${E} units to ${H}`})}else pe({type:"error",message:` Main assigned, but split failed: ${M.data?.Resp_desc||"Unknown error"}`})}else{const C=P.data?.data?.to_stage||"next stage",M=P.data?.data?.from_stage||"current stage";pe({type:"success",message:` Order assigned successfully! 
${A} units moved from ${M}  ${C}`})}await Je(),setTimeout(()=>{le(!1),pe(null)},2e3)}else pe({type:"error",message:` ${P.data?.Resp_desc||"Order assignment failed."}`})}catch(d){if(console.error(" Error assigning order:",d),d.response){const A=d.response.data?.message||d.response.data?.Resp_desc||"Validation failed.",E=d.response.data?.errors&&Object.entries(d.response.data.errors).map(([S,P])=>`${S}: ${P}`).join(`
`);pe({type:"error",message:` ${A}
${E||""}`})}else d.request?pe({type:"error",message:" No response from server. Please check your connection."}):pe({type:"error",message:` ${d.message}`})}}},at=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:d=>{window.location.href=`/${d.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:d=>y(d.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Ut,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:at,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(d=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(d.id),onCheckedChange:()=>Ft(d.id),"aria-label":`Select row ${d.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:d.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:d.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:d.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:d.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:d.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:d.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:d.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:d.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${t(d.id)?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>zt(d),children:n.jsx(qn,{className:`h-4 w-4 ${t(d.id)?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>It(d),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Wt(d),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${s(d.id)||d.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:s(d.id)||d.alertStatus?"Marked as urgent":"Click to mark as urgent",onClick:()=>{!s(d.id)&&!d.alertStatus&&he(d.id)},children:n.jsx(fr,{className:`h-4 w-4 ${s(d.id)||d.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},d.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsx("div",{className:"space-y-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select next step"})}),n.jsx(gn,{children:Ct.map(d=>n.jsx(qr,{value:d,children:kr(d)},d))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:d=>de(d.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]})}),Re&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Re.type==="success"?"bg-green-50 text-green-700 border border-green-200":Re.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Re.message.split(`
`).map((d,A)=>n.jsx("div",{children:d},A))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:Bt,children:"Cancel"}),n.jsx(ce,{onClick:()=>_e(Number(K.id),Number(K.qty)),className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:$t.map(d=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:d.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[d.gmsoaNo," - ",d.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},d.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:Lt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:d=>rt(d.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:ge,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function tU(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const d=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((d?.data?.Resp_code==="true"||d?.data?.Resp_code===!0||d?.data?.Resp_code==="RCS")&&Array.isArray(d.data.data)){const E=d.data.data.map(S=>({id:String(S.id),assemblyLine:S.assembly_no||"",gmsoaNo:S.soa_no||"",soaSrNo:S.soa_sr_no||"",assemblyDate:S.assembly_date||"",uniqueCode:S.unique_code||S.order_no||"",splittedCode:S.splitted_code||"",party:S.party_name||S.party||"",customerPoNo:S.customer_po_no||"",codeNo:S.code_no||"",product:S.product||"",qty:Number(S.qty||0),qtyExe:Number(S.qty_executed||0),qtyPending:Number(S.qty_pending||0),finishedValve:S.finished_valve||"",gmLogo:S.gm_logo||"",namePlate:S.name_plate||"",productSpcl1:S.product_spc1||"",productSpcl2:S.product_spc2||"",productSpcl3:S.product_spc3||"",inspection:S.inspection||"",painting:S.painting||"",remarks:S.remarks||"",alertStatus:S.is_urgent===!0||S.is_urgent==="true"||S.alert_status===!0||S.alert_status==="true"||S.urgent===1||S.urgent==="1"}));console.log(" Orders fetched:",E.length,"records"),o(E),h(null),Mt(null)}else console.warn(" No valid order data received",d.data),o([]),h(d?.data?.Resp_desc||"Failed to fetch orders")}catch(d){console.error("Error fetching orders:",d),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(d=>d.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(d=>d.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(d=>d.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let d=a.slice();if(v&&(d=d.filter(A=>s(String(A.id))||A.alertStatus)),b!=="all"&&(d=d.filter(A=>A.assemblyLine===b)),j!=="all"&&(d=d.filter(A=>A.gmsoaNo===j)),T!=="all"&&(d=d.filter(A=>A.party===T)),(B||z)&&(d=d.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const S=A.assemblyDate.split(/[\/-]/).map(se=>se.trim()).map(se=>Number(se));if(S.some(se=>isNaN(se)))return!1;let P=null;if(S.length>=3){const[se,C,M]=S;P=new Date(M,C-1,se)}else if(S.length===2){const[se,C]=S;P=new Date(C,se-1,1)}else if(S.length===1){const[se]=S;P=new Date(se,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(I==="year"&&B)return P.getFullYear()===B.getFullYear();if(I==="month"&&B)return P.getFullYear()===B.getFullYear()&&P.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return P>=B&&P<=z;if(B)return P>=B;if(z)return P<=z}return!0})),x.trim()){const A=x.toLowerCase();d=d.filter(E=>String(E.uniqueCode).toLowerCase().includes(A)||String(E.party).toLowerCase().includes(A)||String(E.gmsoaNo).toLowerCase().includes(A))}return d},[a,x,v,b,j,T,I,B,z,s]),Ft=d=>{fe(A=>{const E=new Set(A);return E.has(d)?E.delete(d):E.add(d),E})},Gt=()=>{fe(d=>d.size===Ue.length?new Set:new Set(Ue.map(A=>A.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t="tpi",Ct=jr(_t);console.log("Next step(s):",Ct.map(kr)),console.log("Is final step?",vs(_t));const Wt=d=>{const E=jr("tpi");Fe(d),le(!0),oe(E[0]||""),de(String(d.qtyPending??d.qty??0)),ee(!1),re(""),Z(""),ie({})},qt=()=>{const d={},A=Number(K?.qtyPending??0),E=Number(V||0),S=Number(Y||0);if(we||(d.quickAssignStep="Please select a workflow step."),(!V||E<=0)&&(d.quickAssignQty="Quantity must be greater than 0."),E>A&&(d.quickAssignQty=`Cannot exceed available (${A})`),Ne){U||(d.splitAssignStep="Choose split step."),(!Y||S<=0)&&(d.splitAssignQty="Split quantity is required."),we===U&&(d.sameEngineer="Split step cannot be the same as main step.");const P=E+S;P!==A&&(d.totalQtyMismatch=`Total quantity (${P}) must equal available (${A}).`)}return ie(d),Object.keys(d).length===0},Bt=()=>{le(!1)},$t=a.filter(d=>ne.has(d.id)),Ut=()=>ve(!0),Lt=()=>window.print(),It=d=>{ut(d),Me(!0)},zt=d=>{Le(d),rt(t(d.id)||d.remarks||""),Ge(!0)},ge=()=>{Be&&(e(Be.id,ft),Ge(!1),Le(null),rt(""))},he=async d=>{try{if(s(d)){console.log("Already marked urgent, skipping:",d);return}o(S=>S.map(P=>P.id===d?{...P,alertStatus:!0}:P));try{r(d)}catch{}const A={orderId:String(d),urgent:"1"};console.log("Payload sent:",A);const E=await Ze.post(`${pt}/mark-urgent`,A,{headers:{Authorization:`Bearer ${St}`}});console.log("Mark urgent response:",E.data),E.data?.Resp_code==="true"||E.data?.Resp_code===!0||E.data?.status===!0?await Je():(o(S=>S.map(P=>P.id===d?{...P,alertStatus:!1}:P)),console.warn("Backend did not confirm urgent update:",E.data))}catch(A){console.error("Error marking urgent:",A),o(E=>E.map(S=>S.id===d?{...S,alertStatus:!1}:S))}},[Re,pe]=m.useState(null),_e=async()=>{if(K&&qt()){pe({type:"info",message:"Assigning order, please wait..."});try{const d=localStorage.getItem("token");if(!d){pe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(V||0),E=Number(Y||0),S=new FormData;S.append("orderId",String(K.id)),S.append("totalQty",String(K.qty)),S.append("executedQty",String(A)),console.log(" Assign main payload (FormData):",{orderId:K.id,totalQty:K.qty,executedQty:A});const P=await Ze.post(`${pt}/assign-order`,S,{headers:{Authorization:`Bearer ${d}`}});if(console.log(" Main assign response:",P.data),P.data?.Resp_code===!0||P.data?.Resp_code==="true"||P.data?.status===!0){if(Ne&&E>0){const C=new FormData;C.append("orderId",String(K.id)),C.append("totalQty",String(K.qty)),C.append("executedQty",String(E)),C.append("splitOrder","true");const M=await Ze.post(`${pt}/assign-order`,C,{headers:{Authorization:`Bearer ${d}`}});if(M.data?.Resp_code===!0||M.data?.Resp_code==="true"||M.data?.status===!0){const q=P.data?.data?.to_stage||"next stage",H=M.data?.data?.to_stage||"next stage";pe({type:"success",message:` Order assigned successfully! 
Main: ${A} units to ${q} 
Split: ${E} units to ${H}`})}else pe({type:"error",message:` Main assigned, but split failed: ${M.data?.Resp_desc||"Unknown error"}`})}else{const C=P.data?.data?.to_stage||"next stage",M=P.data?.data?.from_stage||"current stage";pe({type:"success",message:` Order assigned successfully! 
${A} units moved from ${M}  ${C}`})}await Je(),setTimeout(()=>{le(!1),pe(null)},2e3)}else pe({type:"error",message:` ${P.data?.Resp_desc||"Order assignment failed."}`})}catch(d){if(console.error(" Error assigning order:",d),d.response){const A=d.response.data?.message||d.response.data?.Resp_desc||"Validation failed.",E=d.response.data?.errors&&Object.entries(d.response.data.errors).map(([S,P])=>`${S}: ${P}`).join(`
`);pe({type:"error",message:` ${A}
${E||""}`})}else d.request?pe({type:"error",message:" No response from server. Please check your connection."}):pe({type:"error",message:` ${d.message}`})}}},at=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:d=>{window.location.href=`/${d.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:d=>y(d.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Ut,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:at,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(d=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(d.id),onCheckedChange:()=>Ft(d.id),"aria-label":`Select row ${d.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:d.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:d.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:d.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:d.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:d.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:d.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:d.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:d.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${t(d.id)?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>zt(d),children:n.jsx(qn,{className:`h-4 w-4 ${t(d.id)?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>It(d),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Wt(d),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${s(d.id)||d.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:s(d.id)||d.alertStatus?"Marked as urgent":"Click to mark as urgent",onClick:()=>{!s(d.id)&&!d.alertStatus&&he(d.id)},children:n.jsx(fr,{className:`h-4 w-4 ${s(d.id)||d.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},d.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsx("div",{className:"space-y-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select next step"})}),n.jsx(gn,{children:Ct.map(d=>n.jsx(qr,{value:d,children:kr(d)},d))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:d=>de(d.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]})}),Re&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Re.type==="success"?"bg-green-50 text-green-700 border border-green-200":Re.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Re.message.split(`
`).map((d,A)=>n.jsx("div",{children:d},A))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:Bt,children:"Cancel"}),n.jsx(ce,{onClick:()=>_e(Number(K.id),Number(K.qty)),className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:$t.map(d=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:d.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[d.gmsoaNo," - ",d.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},d.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:Lt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:d=>rt(d.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:ge,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function rU(){const{updateRemark:e,toggleAlertStatus:r,getRemark:t,getAlertStatus:s}=Qn(),[a,o]=m.useState([]),[c,u]=m.useState(!1),[p,h]=m.useState(null),[x,y]=m.useState(""),[v,k]=m.useState(!1),[b,w]=m.useState("all"),[j,O]=m.useState("all"),[T,F]=m.useState("all"),[I,G]=m.useState("range"),[B,Q]=m.useState(void 0),[z,J]=m.useState(void 0),[ne,fe]=m.useState(new Set),[me,le]=m.useState(!1),[K,Fe]=m.useState(null),[we,oe]=m.useState(""),[V,de]=m.useState(""),[Ne,ee]=m.useState(!1),[U,re]=m.useState(""),[Y,Z]=m.useState(""),[xe,ie]=m.useState({}),[Te,ve]=m.useState(!1),[Ee,Me]=m.useState(!1),[D,ut]=m.useState(null),[et,Ge]=m.useState(!1),[Be,Le]=m.useState(null),[ft,rt]=m.useState(""),[hr,lr]=m.useState(null),[Nr,Zt]=m.useState(!1),[cr,Mt]=m.useState(null);m.useRef(null);const Dt=m.useRef(null),St=localStorage.getItem("token"),Je=async()=>{try{u(!0),h(null);const d=await Ze.post(`${pt}/order-list`,{},{headers:{Authorization:`Bearer ${St}`}});if((d?.data?.Resp_code==="true"||d?.data?.Resp_code===!0||d?.data?.Resp_code==="RCS")&&Array.isArray(d.data.data)){const E=d.data.data.map(S=>({id:String(S.id),assemblyLine:S.assembly_no||"",gmsoaNo:S.soa_no||"",soaSrNo:S.soa_sr_no||"",assemblyDate:S.assembly_date||"",uniqueCode:S.unique_code||S.order_no||"",splittedCode:S.splitted_code||"",party:S.party_name||S.party||"",customerPoNo:S.customer_po_no||"",codeNo:S.code_no||"",product:S.product||"",qty:Number(S.qty||0),qtyExe:Number(S.qty_executed||0),qtyPending:Number(S.qty_pending||0),finishedValve:S.finished_valve||"",gmLogo:S.gm_logo||"",namePlate:S.name_plate||"",productSpcl1:S.product_spc1||"",productSpcl2:S.product_spc2||"",productSpcl3:S.product_spc3||"",inspection:S.inspection||"",painting:S.painting||"",remarks:S.remarks||"",alertStatus:S.is_urgent===!0||S.is_urgent==="true"||S.alert_status===!0||S.alert_status==="true"||S.urgent===1||S.urgent==="1"}));console.log(" Orders fetched:",E.length,"records"),o(E),h(null),Mt(null)}else console.warn(" No valid order data received",d.data),o([]),h(d?.data?.Resp_desc||"Failed to fetch orders")}catch(d){console.error("Error fetching orders:",d),h("Error fetching order list. Please check your token or server.")}finally{u(!1)}};m.useEffect(()=>{Je()},[]);const Ht=m.useMemo(()=>Array.from(new Set(a.map(d=>d.assemblyLine))).filter(Boolean).sort(),[a]);m.useMemo(()=>Array.from(new Set(a.map(d=>d.gmsoaNo))).filter(Boolean).sort(),[a]),m.useMemo(()=>Array.from(new Set(a.map(d=>d.party))).filter(Boolean).sort(),[a]);const Ue=m.useMemo(()=>{let d=a.slice();if(v&&(d=d.filter(A=>s(String(A.id))||A.alertStatus)),b!=="all"&&(d=d.filter(A=>A.assemblyLine===b)),j!=="all"&&(d=d.filter(A=>A.gmsoaNo===j)),T!=="all"&&(d=d.filter(A=>A.party===T)),(B||z)&&(d=d.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const S=A.assemblyDate.split(/[\/-]/).map(se=>se.trim()).map(se=>Number(se));if(S.some(se=>isNaN(se)))return!1;let P=null;if(S.length>=3){const[se,C,M]=S;P=new Date(M,C-1,se)}else if(S.length===2){const[se,C]=S;P=new Date(C,se-1,1)}else if(S.length===1){const[se]=S;P=new Date(se,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(I==="year"&&B)return P.getFullYear()===B.getFullYear();if(I==="month"&&B)return P.getFullYear()===B.getFullYear()&&P.getMonth()===B.getMonth();if(I==="range"){if(B&&z)return P>=B&&P<=z;if(B)return P>=B;if(z)return P<=z}return!0})),x.trim()){const A=x.toLowerCase();d=d.filter(E=>String(E.uniqueCode).toLowerCase().includes(A)||String(E.party).toLowerCase().includes(A)||String(E.gmsoaNo).toLowerCase().includes(A))}return d},[a,x,v,b,j,T,I,B,z,s]),Ft=d=>{fe(A=>{const E=new Set(A);return E.has(d)?E.delete(d):E.add(d),E})},Gt=()=>{fe(d=>d.size===Ue.length?new Set:new Set(Ue.map(A=>A.id)))},kt=Ue.length>0&&ne.size===Ue.length,_t="dispatch",Ct=jr(_t);console.log("Next step(s):",Ct.map(kr)),console.log("Is final step?",vs(_t));const Wt=d=>{const E=jr("dispatch");Fe(d),le(!0),oe(E[0]||""),de(String(d.qtyPending??d.qty??0)),ee(!1),re(""),Z(""),ie({})},qt=()=>{const d={},A=Number(K?.qtyPending??0),E=Number(V||0),S=Number(Y||0);if(we||(d.quickAssignStep="Please select a workflow step."),(!V||E<=0)&&(d.quickAssignQty="Quantity must be greater than 0."),E>A&&(d.quickAssignQty=`Cannot exceed available (${A})`),Ne){U||(d.splitAssignStep="Choose split step."),(!Y||S<=0)&&(d.splitAssignQty="Split quantity is required."),we===U&&(d.sameEngineer="Split step cannot be the same as main step.");const P=E+S;P!==A&&(d.totalQtyMismatch=`Total quantity (${P}) must equal available (${A}).`)}return ie(d),Object.keys(d).length===0},Bt=()=>{le(!1)},$t=a.filter(d=>ne.has(d.id)),Ut=()=>ve(!0),Lt=()=>window.print(),It=d=>{ut(d),Me(!0)},zt=d=>{Le(d),rt(t(d.id)||d.remarks||""),Ge(!0)},ge=()=>{Be&&(e(Be.id,ft),Ge(!1),Le(null),rt(""))},he=async d=>{try{if(s(d)){console.log("Already marked urgent, skipping:",d);return}o(S=>S.map(P=>P.id===d?{...P,alertStatus:!0}:P));try{r(d)}catch{}const A={orderId:String(d),urgent:"1"};console.log("Payload sent:",A);const E=await Ze.post(`${pt}/mark-urgent`,A,{headers:{Authorization:`Bearer ${St}`}});console.log("Mark urgent response:",E.data),E.data?.Resp_code==="true"||E.data?.Resp_code===!0||E.data?.status===!0?await Je():(o(S=>S.map(P=>P.id===d?{...P,alertStatus:!1}:P)),console.warn("Backend did not confirm urgent update:",E.data))}catch(A){console.error("Error marking urgent:",A),o(E=>E.map(S=>S.id===d?{...S,alertStatus:!1}:S))}},[Re,pe]=m.useState(null),_e=async()=>{if(K&&qt()){pe({type:"info",message:"Assigning order, please wait..."});try{const d=localStorage.getItem("token");if(!d){pe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(V||0),E=Number(Y||0),S=new FormData;S.append("orderId",String(K.id)),S.append("totalQty",String(K.qty)),S.append("executedQty",String(A)),console.log(" Assign main payload (FormData):",{orderId:K.id,totalQty:K.qty,executedQty:A});const P=await Ze.post(`${pt}/assign-order`,S,{headers:{Authorization:`Bearer ${d}`}});if(console.log(" Main assign response:",P.data),P.data?.Resp_code===!0||P.data?.Resp_code==="true"||P.data?.status===!0){if(Ne&&E>0){const C=new FormData;C.append("orderId",String(K.id)),C.append("totalQty",String(K.qty)),C.append("executedQty",String(E)),C.append("splitOrder","true");const M=await Ze.post(`${pt}/assign-order`,C,{headers:{Authorization:`Bearer ${d}`}});if(M.data?.Resp_code===!0||M.data?.Resp_code==="true"||M.data?.status===!0){const q=P.data?.data?.to_stage||"next stage",H=M.data?.data?.to_stage||"next stage";pe({type:"success",message:` Order assigned successfully! 
Main: ${A} units to ${q} 
Split: ${E} units to ${H}`})}else pe({type:"error",message:` Main assigned, but split failed: ${M.data?.Resp_desc||"Unknown error"}`})}else{const C=P.data?.data?.to_stage||"next stage",M=P.data?.data?.from_stage||"current stage";pe({type:"success",message:` Order assigned successfully! 
${A} units moved from ${M}  ${C}`})}await Je(),setTimeout(()=>{le(!1),pe(null)},2e3)}else pe({type:"error",message:` ${P.data?.Resp_desc||"Order assignment failed."}`})}catch(d){if(console.error(" Error assigning order:",d),d.response){const A=d.response.data?.message||d.response.data?.Resp_desc||"Validation failed.",E=d.response.data?.errors&&Object.entries(d.response.data.errors).map(([S,P])=>`${S}: ${P}`).join(`
`);pe({type:"error",message:` ${A}
${E||""}`})}else d.request?pe({type:"error",message:" No response from server. Please check your connection."}):pe({type:"error",message:` ${d.message}`})}}},at=()=>{w("all"),O("all"),F("all"),G("range"),Q(void 0),J(void 0)};return n.jsxs(n.Fragment,{children:[n.jsx(Kn,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:d=>{window.location.href=`/${d.toLowerCase()}`},onUploadSuccess:()=>Je()}),n.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[n.jsxs("div",{className:"mb-8",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),n.jsx("p",{className:"text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),n.jsx(or,{type:"text",placeholder:"Search by Unique Code, GMSOA NO., or Party...",value:x,onChange:d=>y(d.target.value),className:"pl-10 w-full sm:w-80 bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(ce,{onClick:Ut,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print Bin Card"]}),n.jsxs(ce,{onClick:()=>k(!v),className:`flex items-center gap-2 ${v?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[n.jsx(fr,{className:"h-4 w-4"}),v?"Show All Projects":"Urgent Projects Only"]})]})]})})]}),n.jsx("div",{className:"mt-4",children:n.jsx(Yn,{assemblyLineFilter:b,setAssemblyLineFilter:w,dateFilterMode:I,setDateFilterMode:G,dateFrom:B,setDateFrom:Q,dateTo:z,setDateTo:J,assemblyLines:Ht,onClearFilters:at,hasActiveFilters:b!=="all"||j!=="all"||T!=="all"||!!B||!!z})})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:n.jsx("div",{ref:Dt,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:n.jsxs("div",{className:"inline-block min-w-full align-middle",children:[n.jsxs("table",{className:"min-w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx("button",{type:"button",role:"checkbox","aria-checked":String(kt),onClick:Gt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:n.jsx("div",{className:`w-4 h-4 ${kt?"bg-blue-600":"bg-white border"}`})})}),n.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),n.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"GMSOA NO."}),n.jsx("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24",children:"SOA Sr. No."}),n.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),n.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),n.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:Ue.map(d=>n.jsxs("tr",{className:"group hover:bg-gray-50",children:[n.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:n.jsx(Cn,{checked:ne.has(d.id),onCheckedChange:()=>Ft(d.id),"aria-label":`Select row ${d.id}`})}),n.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 min-w-32",children:n.jsx(Hn,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:d.assemblyLine})}),n.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:d.gmsoaNo}),n.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:d.soaSrNo}),n.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:d.assemblyDate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:d.uniqueCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.splittedCode}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 max-w-xs truncate",children:d.party}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.customerPoNo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.codeNo}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:n.jsx("div",{className:"line-clamp-2",children:d.product})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qty}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyExe}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.qtyPending}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.finishedValve}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.gmLogo}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.namePlate}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl1}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.productSpcl2}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:n.jsx("div",{className:"line-clamp-2",children:d.productSpcl3})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.inspection}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:d.painting}),n.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 ${t(d.id)?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,title:"Add/Edit Remarks",onClick:()=>zt(d),children:n.jsx(qn,{className:`h-4 w-4 ${t(d.id)?"text-white":"text-blue-600"}`})})}),n.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>It(d),children:n.jsx(_n,{className:"h-4 w-4 text-blue-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Wt(d),children:n.jsx(Wn,{className:"h-4 w-4 text-green-600"})}),n.jsx(ce,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${s(d.id)||d.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:s(d.id)||d.alertStatus?"Marked as urgent":"Click to mark as urgent",onClick:()=>{!s(d.id)&&!d.alertStatus&&he(d.id)},children:n.jsx(fr,{className:`h-4 w-4 ${s(d.id)||d.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},d.id))})]}),Ue.length===0&&n.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})}),n.jsx(xt,{open:me,onOpenChange:le,children:n.jsxs(mt,{className:"sm:max-w-[500px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Quick Assign Order"}),n.jsxs(vt,{children:["Assign ",K?.uniqueCode," to the next workflow step"]})]}),n.jsx("div",{className:"space-y-6 py-4",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),n.jsxs(pn,{value:we,onValueChange:oe,children:[n.jsx(xn,{id:"assignStep",children:n.jsx(mn,{placeholder:"Select next step"})}),n.jsx(gn,{children:Ct.map(d=>n.jsx(qr,{value:d,children:kr(d)},d))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(R,{htmlFor:"assignQty",children:"Quantity"}),n.jsx(or,{id:"assignQty",type:"number",value:V,onChange:d=>de(d.target.value),max:K?.qtyPending})]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",n.jsx("span",{className:"font-medium text-gray-900",children:K?.qtyPending})]})]})}),Re&&n.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Re.type==="success"?"bg-green-50 text-green-700 border border-green-200":Re.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Re.message.split(`
`).map((d,A)=>n.jsx("div",{children:d},A))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:Bt,children:"Cancel"}),n.jsx(ce,{onClick:()=>_e(Number(K.id),Number(K.qty)),className:"bg-black hover:bg-gray-800 text-white",children:"Assign"})]})]})}),n.jsx(xt,{open:Te,onOpenChange:ve,children:n.jsxs(mt,{className:"sm:max-w-[800px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Bin Card - Selected Orders"}),n.jsx(vt,{children:"Review selected orders and print bin card"})]}),n.jsx("div",{className:"space-y-6 py-4",children:$t.map(d=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 space-y-4 bg-white",children:[n.jsx("div",{className:"text-center pb-2 border-b border-gray-200",children:n.jsxs("p",{className:"text-lg",children:[n.jsx("span",{className:"text-gray-600",children:"Assembly Line:"})," ",n.jsx("span",{className:"text-gray-900 font-bold text-xl",children:d.assemblyLine})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No - SR. NO."}),n.jsxs("p",{className:"text-gray-900 mt-1",children:[d.gmsoaNo," - ",d.soaSrNo]})]})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Item Description"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.product})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"QTY"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:d.gmLogo})]})]}),n.jsx("div",{className:"pt-4 mt-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(R,{className:"text-gray-500 text-sm whitespace-nowrap",children:"Inspected by:"}),n.jsx("div",{className:"border-b border-gray-400 flex-1 h-8"})]})})]},d.id))}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>ve(!1),children:"Cancel"}),n.jsxs(ce,{onClick:Lt,className:"bg-blue-600 text-white",children:[n.jsx(ur,{className:"h-4 w-4"}),"Print"]})]})]})}),n.jsx(xt,{open:Ee,onOpenChange:Me,children:n.jsxs(mt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Order Details"}),n.jsxs(vt,{children:["Complete information for ",D?.uniqueCode]})]}),D&&n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Line"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyLine})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GMSOA No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmsoaNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"SOA Sr. No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.soaSrNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Assembly Date"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.assemblyDate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Unique Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.uniqueCode})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Splitted Code"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.splittedCode||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Party"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.party})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Customer PO No."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.customerPoNo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Code No"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.codeNo})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.product})]})]})]}),n.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qty})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Exe."}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyExe})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Qty Pending"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.qtyPending})]})]})]}),n.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Finished Valve"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.finishedValve})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"GM Logo"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.gmLogo})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Name Plate"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.namePlate})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl1||"N/A"})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl2||"N/A"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.productSpcl3||"N/A"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[n.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Inspection"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.inspection})]}),n.jsxs("div",{children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Painting"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.painting})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx(R,{className:"text-gray-500 text-sm",children:"Remarks"}),n.jsx("p",{className:"text-gray-900 mt-1",children:D.remarks||"No remarks"})]})]})]})]}),n.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:n.jsx(ce,{variant:"outline",onClick:()=>Me(!1),children:"Close"})})]})}),n.jsx(xt,{open:et,onOpenChange:Ge,children:n.jsxs(mt,{className:"sm:max-w-[600px]",children:[n.jsxs(gt,{children:[n.jsx(yt,{children:"Add/Edit Remarks"}),n.jsx(vt,{children:Be?`Order: ${Be.uniqueCode}`:""})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(R,{htmlFor:"remarks",children:"Remarks"}),n.jsx(Gn,{id:"remarks",placeholder:"Enter remarks...",value:ft,onChange:d=>rt(d.target.value),rows:6,className:"resize-none"})]}),n.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[n.jsx(ce,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),n.jsx(ce,{onClick:ge,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function nU(){return n.jsx(O4,{children:n.jsx(wC,{children:n.jsxs("div",{className:"relative min-h-screen",children:[n.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-slate-50 via-blue-50/30 to-indigo-100/40 -z-10",children:[n.jsx("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-gradient-to-bl from-[#174a9f]/10 via-indigo-300/5 to-transparent rounded-full blur-3xl animate-pulse-soft"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-[500px] h-[500px] bg-gradient-to-tr from-purple-300/5 via-blue-300/5 to-transparent rounded-full blur-3xl animate-pulse-soft",style:{animationDelay:"1s"}})]}),n.jsxs(X_,{children:[n.jsx(tn,{path:"/login",element:n.jsx(T4,{})}),n.jsx(tn,{path:"/planning",element:n.jsx(Fn,{allowedRole:"planning",children:n.jsx(W$,{})})}),n.jsx(tn,{path:"/material-issue",element:n.jsx(Fn,{allowedRole:"material-issue",children:n.jsx(q$,{})})}),n.jsx(tn,{path:"/semi-qc",element:n.jsx(Fn,{allowedRole:"semi-qc",children:n.jsx(V$,{})})}),n.jsx(tn,{path:"/phosphating",element:n.jsx(Fn,{allowedRole:"phosphating",children:n.jsx(Q$,{})})}),n.jsx(tn,{path:"/assembly",element:n.jsx(Fn,{allowedRole:"assembly",children:n.jsx(H$,{})})}),n.jsx(tn,{path:"/testing1",element:n.jsx(Fn,{allowedRole:"testing1",children:n.jsx(G$,{})})}),n.jsx(tn,{path:"/testing2",element:n.jsx(Fn,{allowedRole:"testing2",children:n.jsx(Y$,{})})}),n.jsx(tn,{path:"/marking1",element:n.jsx(Fn,{allowedRole:"marking1",children:n.jsx(K$,{})})}),n.jsx(tn,{path:"/marking2",element:n.jsx(Fn,{allowedRole:"marking2",children:n.jsx(X$,{})})}),n.jsx(tn,{path:"/svs",element:n.jsx(Fn,{allowedRole:"svs",children:n.jsx(J$,{})})}),n.jsx(tn,{path:"/pdi1",element:n.jsx(Fn,{allowedRole:"pdi1",children:n.jsx(Z$,{})})}),n.jsx(tn,{path:"/pdi2",element:n.jsx(Fn,{allowedRole:"pdi2",children:n.jsx(eU,{})})}),n.jsx(tn,{path:"/tpi",element:n.jsx(Fn,{allowedRole:"tpi",children:n.jsx(tU,{})})}),n.jsx(tn,{path:"/dispatch",element:n.jsx(Fn,{allowedRole:"dispatch",children:n.jsx(rU,{})})}),n.jsx(tn,{path:"*",element:n.jsx(Uh,{to:"/login",replace:!0})})]})]})})})}o_.createRoot(document.getElementById("root")).render(n.jsx(nU,{}));
