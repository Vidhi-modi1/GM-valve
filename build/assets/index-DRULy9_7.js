function $C(t,s){for(var r=0;r<s.length;r++){const n=s[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const l=Object.getOwnPropertyDescriptor(n,a);l&&Object.defineProperty(t,a,l.get?l:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();var Jd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function a1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var g0={exports:{}},Xo={},y0={exports:{}},ws={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $y;function QC(){if($y)return ws;$y=1;var t=Symbol.for("react.element"),s=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),w=Symbol.iterator;function j(ne){return ne===null||typeof ne!="object"?null:(ne=w&&ne[w]||ne["@@iterator"],typeof ne=="function"?ne:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,S={};function _(ne,U,ce){this.props=ne,this.context=U,this.refs=S,this.updater=ce||C}_.prototype.isReactComponent={},_.prototype.setState=function(ne,U){if(typeof ne!="object"&&typeof ne!="function"&&ne!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ne,U,"setState")},_.prototype.forceUpdate=function(ne){this.updater.enqueueForceUpdate(this,ne,"forceUpdate")};function I(){}I.prototype=_.prototype;function F(ne,U,ce){this.props=ne,this.context=U,this.refs=S,this.updater=ce||C}var B=F.prototype=new I;B.constructor=F,k(B,_.prototype),B.isPureReactComponent=!0;var q=Array.isArray,me=Object.prototype.hasOwnProperty,re={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function W(ne,U,ce){var z,ae={},ye=null,fe=null;if(U!=null)for(z in U.ref!==void 0&&(fe=U.ref),U.key!==void 0&&(ye=""+U.key),U)me.call(U,z)&&!M.hasOwnProperty(z)&&(ae[z]=U[z]);var Ee=arguments.length-2;if(Ee===1)ae.children=ce;else if(1<Ee){for(var Le=Array(Ee),De=0;De<Ee;De++)Le[De]=arguments[De+2];ae.children=Le}if(ne&&ne.defaultProps)for(z in Ee=ne.defaultProps,Ee)ae[z]===void 0&&(ae[z]=Ee[z]);return{$$typeof:t,type:ne,key:ye,ref:fe,props:ae,_owner:re.current}}function oe(ne,U){return{$$typeof:t,type:ne.type,key:U,ref:ne.ref,props:ne.props,_owner:ne._owner}}function X(ne){return typeof ne=="object"&&ne!==null&&ne.$$typeof===t}function he(ne){var U={"=":"=0",":":"=2"};return"$"+ne.replace(/[=:]/g,function(ce){return U[ce]})}var ue=/\/+/g;function _e(ne,U){return typeof ne=="object"&&ne!==null&&ne.key!=null?he(""+ne.key):U.toString(36)}function ke(ne,U,ce,z,ae){var ye=typeof ne;(ye==="undefined"||ye==="boolean")&&(ne=null);var fe=!1;if(ne===null)fe=!0;else switch(ye){case"string":case"number":fe=!0;break;case"object":switch(ne.$$typeof){case t:case s:fe=!0}}if(fe)return fe=ne,ae=ae(fe),ne=z===""?"."+_e(fe,0):z,q(ae)?(ce="",ne!=null&&(ce=ne.replace(ue,"$&/")+"/"),ke(ae,U,ce,"",function(De){return De})):ae!=null&&(X(ae)&&(ae=oe(ae,ce+(!ae.key||fe&&fe.key===ae.key?"":(""+ae.key).replace(ue,"$&/")+"/")+ne)),U.push(ae)),1;if(fe=0,z=z===""?".":z+":",q(ne))for(var Ee=0;Ee<ne.length;Ee++){ye=ne[Ee];var Le=z+_e(ye,Ee);fe+=ke(ye,U,ce,Le,ae)}else if(Le=j(ne),typeof Le=="function")for(ne=Le.call(ne),Ee=0;!(ye=ne.next()).done;)ye=ye.value,Le=z+_e(ye,Ee++),fe+=ke(ye,U,ce,Le,ae);else if(ye==="object")throw U=String(ne),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(ne).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return fe}function Re(ne,U,ce){if(ne==null)return ne;var z=[],ae=0;return ke(ne,z,"","",function(ye){return U.call(ce,ye,ae++)}),z}function Y(ne){if(ne._status===-1){var U=ne._result;U=U(),U.then(function(ce){(ne._status===0||ne._status===-1)&&(ne._status=1,ne._result=ce)},function(ce){(ne._status===0||ne._status===-1)&&(ne._status=2,ne._result=ce)}),ne._status===-1&&(ne._status=0,ne._result=U)}if(ne._status===1)return ne._result.default;throw ne._result}var ve={current:null},Q={transition:null},be={ReactCurrentDispatcher:ve,ReactCurrentBatchConfig:Q,ReactCurrentOwner:re};function pe(){throw Error("act(...) is not supported in production builds of React.")}return ws.Children={map:Re,forEach:function(ne,U,ce){Re(ne,function(){U.apply(this,arguments)},ce)},count:function(ne){var U=0;return Re(ne,function(){U++}),U},toArray:function(ne){return Re(ne,function(U){return U})||[]},only:function(ne){if(!X(ne))throw Error("React.Children.only expected to receive a single React element child.");return ne}},ws.Component=_,ws.Fragment=r,ws.Profiler=a,ws.PureComponent=F,ws.StrictMode=n,ws.Suspense=f,ws.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=be,ws.act=pe,ws.cloneElement=function(ne,U,ce){if(ne==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+ne+".");var z=k({},ne.props),ae=ne.key,ye=ne.ref,fe=ne._owner;if(U!=null){if(U.ref!==void 0&&(ye=U.ref,fe=re.current),U.key!==void 0&&(ae=""+U.key),ne.type&&ne.type.defaultProps)var Ee=ne.type.defaultProps;for(Le in U)me.call(U,Le)&&!M.hasOwnProperty(Le)&&(z[Le]=U[Le]===void 0&&Ee!==void 0?Ee[Le]:U[Le])}var Le=arguments.length-2;if(Le===1)z.children=ce;else if(1<Le){Ee=Array(Le);for(var De=0;De<Le;De++)Ee[De]=arguments[De+2];z.children=Ee}return{$$typeof:t,type:ne.type,key:ae,ref:ye,props:z,_owner:fe}},ws.createContext=function(ne){return ne={$$typeof:c,_currentValue:ne,_currentValue2:ne,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},ne.Provider={$$typeof:l,_context:ne},ne.Consumer=ne},ws.createElement=W,ws.createFactory=function(ne){var U=W.bind(null,ne);return U.type=ne,U},ws.createRef=function(){return{current:null}},ws.forwardRef=function(ne){return{$$typeof:u,render:ne}},ws.isValidElement=X,ws.lazy=function(ne){return{$$typeof:v,_payload:{_status:-1,_result:ne},_init:Y}},ws.memo=function(ne,U){return{$$typeof:h,type:ne,compare:U===void 0?null:U}},ws.startTransition=function(ne){var U=Q.transition;Q.transition={};try{ne()}finally{Q.transition=U}},ws.unstable_act=pe,ws.useCallback=function(ne,U){return ve.current.useCallback(ne,U)},ws.useContext=function(ne){return ve.current.useContext(ne)},ws.useDebugValue=function(){},ws.useDeferredValue=function(ne){return ve.current.useDeferredValue(ne)},ws.useEffect=function(ne,U){return ve.current.useEffect(ne,U)},ws.useId=function(){return ve.current.useId()},ws.useImperativeHandle=function(ne,U,ce){return ve.current.useImperativeHandle(ne,U,ce)},ws.useInsertionEffect=function(ne,U){return ve.current.useInsertionEffect(ne,U)},ws.useLayoutEffect=function(ne,U){return ve.current.useLayoutEffect(ne,U)},ws.useMemo=function(ne,U){return ve.current.useMemo(ne,U)},ws.useReducer=function(ne,U,ce){return ve.current.useReducer(ne,U,ce)},ws.useRef=function(ne){return ve.current.useRef(ne)},ws.useState=function(ne){return ve.current.useState(ne)},ws.useSyncExternalStore=function(ne,U,ce){return ve.current.useSyncExternalStore(ne,U,ce)},ws.useTransition=function(){return ve.current.useTransition()},ws.version="18.3.1",ws}var Qy;function am(){return Qy||(Qy=1,y0.exports=QC()),y0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uy;function UC(){if(Uy)return Xo;Uy=1;var t=am(),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(u,f,h){var v,w={},j=null,C=null;h!==void 0&&(j=""+h),f.key!==void 0&&(j=""+f.key),f.ref!==void 0&&(C=f.ref);for(v in f)n.call(f,v)&&!l.hasOwnProperty(v)&&(w[v]=f[v]);if(u&&u.defaultProps)for(v in f=u.defaultProps,f)w[v]===void 0&&(w[v]=f[v]);return{$$typeof:s,type:u,key:j,ref:C,props:w,_owner:a.current}}return Xo.Fragment=r,Xo.jsx=c,Xo.jsxs=c,Xo}var Vy;function VC(){return Vy||(Vy=1,g0.exports=UC()),g0.exports}var e=VC(),Zd={},v0={exports:{}},on={},b0={exports:{}},w0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wy;function WC(){return Wy||(Wy=1,(function(t){function s(Q,be){var pe=Q.length;Q.push(be);e:for(;0<pe;){var ne=pe-1>>>1,U=Q[ne];if(0<a(U,be))Q[ne]=be,Q[pe]=U,pe=ne;else break e}}function r(Q){return Q.length===0?null:Q[0]}function n(Q){if(Q.length===0)return null;var be=Q[0],pe=Q.pop();if(pe!==be){Q[0]=pe;e:for(var ne=0,U=Q.length,ce=U>>>1;ne<ce;){var z=2*(ne+1)-1,ae=Q[z],ye=z+1,fe=Q[ye];if(0>a(ae,pe))ye<U&&0>a(fe,ae)?(Q[ne]=fe,Q[ye]=pe,ne=ye):(Q[ne]=ae,Q[z]=pe,ne=z);else if(ye<U&&0>a(fe,pe))Q[ne]=fe,Q[ye]=pe,ne=ye;else break e}}return be}function a(Q,be){var pe=Q.sortIndex-be.sortIndex;return pe!==0?pe:Q.id-be.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var f=[],h=[],v=1,w=null,j=3,C=!1,k=!1,S=!1,_=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(Q){for(var be=r(h);be!==null;){if(be.callback===null)n(h);else if(be.startTime<=Q)n(h),be.sortIndex=be.expirationTime,s(f,be);else break;be=r(h)}}function q(Q){if(S=!1,B(Q),!k)if(r(f)!==null)k=!0,Y(me);else{var be=r(h);be!==null&&ve(q,be.startTime-Q)}}function me(Q,be){k=!1,S&&(S=!1,I(W),W=-1),C=!0;var pe=j;try{for(B(be),w=r(f);w!==null&&(!(w.expirationTime>be)||Q&&!he());){var ne=w.callback;if(typeof ne=="function"){w.callback=null,j=w.priorityLevel;var U=ne(w.expirationTime<=be);be=t.unstable_now(),typeof U=="function"?w.callback=U:w===r(f)&&n(f),B(be)}else n(f);w=r(f)}if(w!==null)var ce=!0;else{var z=r(h);z!==null&&ve(q,z.startTime-be),ce=!1}return ce}finally{w=null,j=pe,C=!1}}var re=!1,M=null,W=-1,oe=5,X=-1;function he(){return!(t.unstable_now()-X<oe)}function ue(){if(M!==null){var Q=t.unstable_now();X=Q;var be=!0;try{be=M(!0,Q)}finally{be?_e():(re=!1,M=null)}}else re=!1}var _e;if(typeof F=="function")_e=function(){F(ue)};else if(typeof MessageChannel<"u"){var ke=new MessageChannel,Re=ke.port2;ke.port1.onmessage=ue,_e=function(){Re.postMessage(null)}}else _e=function(){_(ue,0)};function Y(Q){M=Q,re||(re=!0,_e())}function ve(Q,be){W=_(function(){Q(t.unstable_now())},be)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){k||C||(k=!0,Y(me))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):oe=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return j},t.unstable_getFirstCallbackNode=function(){return r(f)},t.unstable_next=function(Q){switch(j){case 1:case 2:case 3:var be=3;break;default:be=j}var pe=j;j=be;try{return Q()}finally{j=pe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,be){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var pe=j;j=Q;try{return be()}finally{j=pe}},t.unstable_scheduleCallback=function(Q,be,pe){var ne=t.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?ne+pe:ne):pe=ne,Q){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=pe+U,Q={id:v++,callback:be,priorityLevel:Q,startTime:pe,expirationTime:U,sortIndex:-1},pe>ne?(Q.sortIndex=pe,s(h,Q),r(f)===null&&Q===r(h)&&(S?(I(W),W=-1):S=!0,ve(q,pe-ne))):(Q.sortIndex=U,s(f,Q),k||C||(k=!0,Y(me))),Q},t.unstable_shouldYield=he,t.unstable_wrapCallback=function(Q){var be=j;return function(){var pe=j;j=be;try{return Q.apply(this,arguments)}finally{j=pe}}}})(w0)),w0}var Gy;function GC(){return Gy||(Gy=1,b0.exports=WC()),b0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hy;function HC(){if(Hy)return on;Hy=1;var t=am(),s=GC();function r(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,m=1;m<arguments.length;m++)o+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function l(i,o){c(i,o),c(i+"Capture",o)}function c(i,o){for(a[i]=o,i=0;i<o.length;i++)n.add(o[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},w={};function j(i){return f.call(w,i)?!0:f.call(v,i)?!1:h.test(i)?w[i]=!0:(v[i]=!0,!1)}function C(i,o,m,b){if(m!==null&&m.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return b?!1:m!==null?!m.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function k(i,o,m,b){if(o===null||typeof o>"u"||C(i,o,m,b))return!0;if(b)return!1;if(m!==null)switch(m.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function S(i,o,m,b,E,O,H){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=b,this.attributeNamespace=E,this.mustUseProperty=m,this.propertyName=i,this.type=o,this.sanitizeURL=O,this.removeEmptyString=H}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){_[i]=new S(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];_[o]=new S(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){_[i]=new S(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){_[i]=new S(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){_[i]=new S(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){_[i]=new S(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){_[i]=new S(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){_[i]=new S(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){_[i]=new S(i,5,!1,i.toLowerCase(),null,!1,!1)});var I=/[\-:]([a-z])/g;function F(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(I,F);_[o]=new S(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(I,F);_[o]=new S(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(I,F);_[o]=new S(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){_[i]=new S(i,1,!1,i.toLowerCase(),null,!1,!1)}),_.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){_[i]=new S(i,1,!1,i.toLowerCase(),null,!0,!0)});function B(i,o,m,b){var E=_.hasOwnProperty(o)?_[o]:null;(E!==null?E.type!==0:b||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(k(o,m,E,b)&&(m=null),b||E===null?j(o)&&(m===null?i.removeAttribute(o):i.setAttribute(o,""+m)):E.mustUseProperty?i[E.propertyName]=m===null?E.type===3?!1:"":m:(o=E.attributeName,b=E.attributeNamespace,m===null?i.removeAttribute(o):(E=E.type,m=E===3||E===4&&m===!0?"":""+m,b?i.setAttributeNS(b,o,m):i.setAttribute(o,m))))}var q=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,me=Symbol.for("react.element"),re=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),oe=Symbol.for("react.profiler"),X=Symbol.for("react.provider"),he=Symbol.for("react.context"),ue=Symbol.for("react.forward_ref"),_e=Symbol.for("react.suspense"),ke=Symbol.for("react.suspense_list"),Re=Symbol.for("react.memo"),Y=Symbol.for("react.lazy"),ve=Symbol.for("react.offscreen"),Q=Symbol.iterator;function be(i){return i===null||typeof i!="object"?null:(i=Q&&i[Q]||i["@@iterator"],typeof i=="function"?i:null)}var pe=Object.assign,ne;function U(i){if(ne===void 0)try{throw Error()}catch(m){var o=m.stack.trim().match(/\n( *(at )?)/);ne=o&&o[1]||""}return`
`+ne+i}var ce=!1;function z(i,o){if(!i||ce)return"";ce=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Ye){var b=Ye}Reflect.construct(i,[],o)}else{try{o.call()}catch(Ye){b=Ye}i.call(o.prototype)}else{try{throw Error()}catch(Ye){b=Ye}i()}}catch(Ye){if(Ye&&b&&typeof Ye.stack=="string"){for(var E=Ye.stack.split(`
`),O=b.stack.split(`
`),H=E.length-1,we=O.length-1;1<=H&&0<=we&&E[H]!==O[we];)we--;for(;1<=H&&0<=we;H--,we--)if(E[H]!==O[we]){if(H!==1||we!==1)do if(H--,we--,0>we||E[H]!==O[we]){var Ae=`
`+E[H].replace(" at new "," at ");return i.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",i.displayName)),Ae}while(1<=H&&0<=we);break}}}finally{ce=!1,Error.prepareStackTrace=m}return(i=i?i.displayName||i.name:"")?U(i):""}function ae(i){switch(i.tag){case 5:return U(i.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return i=z(i.type,!1),i;case 11:return i=z(i.type.render,!1),i;case 1:return i=z(i.type,!0),i;default:return""}}function ye(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case M:return"Fragment";case re:return"Portal";case oe:return"Profiler";case W:return"StrictMode";case _e:return"Suspense";case ke:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case he:return(i.displayName||"Context")+".Consumer";case X:return(i._context.displayName||"Context")+".Provider";case ue:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Re:return o=i.displayName||null,o!==null?o:ye(i.type)||"Memo";case Y:o=i._payload,i=i._init;try{return ye(i(o))}catch{}}return null}function fe(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ye(o);case 8:return o===W?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Ee(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Le(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function De(i){var o=Le(i)?"checked":"value",m=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),b=""+i[o];if(!i.hasOwnProperty(o)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var E=m.get,O=m.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return E.call(this)},set:function(H){b=""+H,O.call(this,H)}}),Object.defineProperty(i,o,{enumerable:m.enumerable}),{getValue:function(){return b},setValue:function(H){b=""+H},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Ve(i){i._valueTracker||(i._valueTracker=De(i))}function et(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var m=o.getValue(),b="";return i&&(b=Le(i)?i.checked?"true":"false":i.value),i=b,i!==m?(o.setValue(i),!0):!1}function Nt(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function ot(i,o){var m=o.checked;return pe({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??i._wrapperState.initialChecked})}function Qt(i,o){var m=o.defaultValue==null?"":o.defaultValue,b=o.checked!=null?o.checked:o.defaultChecked;m=Ee(o.value!=null?o.value:m),i._wrapperState={initialChecked:b,initialValue:m,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function qe(i,o){o=o.checked,o!=null&&B(i,"checked",o,!1)}function Me(i,o){qe(i,o);var m=Ee(o.value),b=o.type;if(m!=null)b==="number"?(m===0&&i.value===""||i.value!=m)&&(i.value=""+m):i.value!==""+m&&(i.value=""+m);else if(b==="submit"||b==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?it(i,o.type,m):o.hasOwnProperty("defaultValue")&&it(i,o.type,Ee(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function mt(i,o,m){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var b=o.type;if(!(b!=="submit"&&b!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,m||o===i.value||(i.value=o),i.defaultValue=o}m=i.name,m!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,m!==""&&(i.name=m)}function it(i,o,m){(o!=="number"||Nt(i.ownerDocument)!==i)&&(m==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+m&&(i.defaultValue=""+m))}var Et=Array.isArray;function pt(i,o,m,b){if(i=i.options,o){o={};for(var E=0;E<m.length;E++)o["$"+m[E]]=!0;for(m=0;m<i.length;m++)E=o.hasOwnProperty("$"+i[m].value),i[m].selected!==E&&(i[m].selected=E),E&&b&&(i[m].defaultSelected=!0)}else{for(m=""+Ee(m),o=null,E=0;E<i.length;E++){if(i[E].value===m){i[E].selected=!0,b&&(i[E].defaultSelected=!0);return}o!==null||i[E].disabled||(o=i[E])}o!==null&&(o.selected=!0)}}function xe(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(r(91));return pe({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function tt(i,o){var m=o.value;if(m==null){if(m=o.children,o=o.defaultValue,m!=null){if(o!=null)throw Error(r(92));if(Et(m)){if(1<m.length)throw Error(r(93));m=m[0]}o=m}o==null&&(o=""),m=o}i._wrapperState={initialValue:Ee(m)}}function lt(i,o){var m=Ee(o.value),b=Ee(o.defaultValue);m!=null&&(m=""+m,m!==i.value&&(i.value=m),o.defaultValue==null&&i.defaultValue!==m&&(i.defaultValue=m)),b!=null&&(i.defaultValue=""+b)}function Ue(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function He(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zt(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?He(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var gt,jt=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,m,b,E){MSApp.execUnsafeLocalFunction(function(){return i(o,m,b,E)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(gt=gt||document.createElement("div"),gt.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=gt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function ct(i,o){if(o){var m=i.firstChild;if(m&&m===i.lastChild&&m.nodeType===3){m.nodeValue=o;return}}i.textContent=o}var Yt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Z=["Webkit","ms","Moz","O"];Object.keys(Yt).forEach(function(i){Z.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Yt[o]=Yt[i]})});function Ze(i,o,m){return o==null||typeof o=="boolean"||o===""?"":m||typeof o!="number"||o===0||Yt.hasOwnProperty(i)&&Yt[i]?(""+o).trim():o+"px"}function nt(i,o){i=i.style;for(var m in o)if(o.hasOwnProperty(m)){var b=m.indexOf("--")===0,E=Ze(m,o[m],b);m==="float"&&(m="cssFloat"),b?i.setProperty(m,E):i[m]=E}}var Ke=pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kt(i,o){if(o){if(Ke[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(r(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(r(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(r(61))}if(o.style!=null&&typeof o.style!="object")throw Error(r(62))}}function wt(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $t=null;function At(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Vt=null,Ot=null,yt=null;function Ge(i){if(i=Fo(i)){if(typeof Vt!="function")throw Error(r(280));var o=i.stateNode;o&&(o=pd(o),Vt(i.stateNode,i.type,o))}}function St(i){Ot?yt?yt.push(i):yt=[i]:Ot=i}function Ct(){if(Ot){var i=Ot,o=yt;if(yt=Ot=null,Ge(i),o)for(i=0;i<o.length;i++)Ge(o[i])}}function Zt(i,o){return i(o)}function _t(){}var Ut=!1;function Kt(i,o,m){if(Ut)return i(o,m);Ut=!0;try{return Zt(i,o,m)}finally{Ut=!1,(Ot!==null||yt!==null)&&(_t(),Ct())}}function Bt(i,o){var m=i.stateNode;if(m===null)return null;var b=pd(m);if(b===null)return null;m=b[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(i=i.type,b=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!b;break e;default:i=!1}if(i)return null;if(m&&typeof m!="function")throw Error(r(231,o,typeof m));return m}var Xt=!1;if(u)try{var as={};Object.defineProperty(as,"passive",{get:function(){Xt=!0}}),window.addEventListener("test",as,as),window.removeEventListener("test",as,as)}catch{Xt=!1}function ds(i,o,m,b,E,O,H,we,Ae){var Ye=Array.prototype.slice.call(arguments,3);try{o.apply(m,Ye)}catch(ft){this.onError(ft)}}var ls=!1,us=null,V=!1,ie=null,K={onError:function(i){ls=!0,us=i}};function ee(i,o,m,b,E,O,H,we,Ae){ls=!1,us=null,ds.apply(K,arguments)}function de(i,o,m,b,E,O,H,we,Ae){if(ee.apply(this,arguments),ls){if(ls){var Ye=us;ls=!1,us=null}else throw Error(r(198));V||(V=!0,ie=Ye)}}function le(i){var o=i,m=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(m=o.return),i=o.return;while(i)}return o.tag===3?m:null}function Pe(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function Be(i){if(le(i)!==i)throw Error(r(188))}function Te(i){var o=i.alternate;if(!o){if(o=le(i),o===null)throw Error(r(188));return o!==i?null:i}for(var m=i,b=o;;){var E=m.return;if(E===null)break;var O=E.alternate;if(O===null){if(b=E.return,b!==null){m=b;continue}break}if(E.child===O.child){for(O=E.child;O;){if(O===m)return Be(E),i;if(O===b)return Be(E),o;O=O.sibling}throw Error(r(188))}if(m.return!==b.return)m=E,b=O;else{for(var H=!1,we=E.child;we;){if(we===m){H=!0,m=E,b=O;break}if(we===b){H=!0,b=E,m=O;break}we=we.sibling}if(!H){for(we=O.child;we;){if(we===m){H=!0,m=O,b=E;break}if(we===b){H=!0,b=O,m=E;break}we=we.sibling}if(!H)throw Error(r(189))}}if(m.alternate!==b)throw Error(r(190))}if(m.tag!==3)throw Error(r(188));return m.stateNode.current===m?i:o}function je(i){return i=Te(i),i!==null?Ce(i):null}function Ce(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=Ce(i);if(o!==null)return o;i=i.sibling}return null}var Fe=s.unstable_scheduleCallback,We=s.unstable_cancelCallback,ge=s.unstable_shouldYield,G=s.unstable_requestPaint,T=s.unstable_now,x=s.unstable_getCurrentPriorityLevel,A=s.unstable_ImmediatePriority,g=s.unstable_UserBlockingPriority,p=s.unstable_NormalPriority,y=s.unstable_LowPriority,N=s.unstable_IdlePriority,P=null,R=null;function L(i){if(R&&typeof R.onCommitFiberRoot=="function")try{R.onCommitFiberRoot(P,i,void 0,(i.current.flags&128)===128)}catch{}}var Ne=Math.clz32?Math.clz32:Ie,Je=Math.log,se=Math.LN2;function Ie(i){return i>>>=0,i===0?32:31-(Je(i)/se|0)|0}var $e=64,te=4194304;function Se(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function at(i,o){var m=i.pendingLanes;if(m===0)return 0;var b=0,E=i.suspendedLanes,O=i.pingedLanes,H=m&268435455;if(H!==0){var we=H&~E;we!==0?b=Se(we):(O&=H,O!==0&&(b=Se(O)))}else H=m&~E,H!==0?b=Se(H):O!==0&&(b=Se(O));if(b===0)return 0;if(o!==0&&o!==b&&(o&E)===0&&(E=b&-b,O=o&-o,E>=O||E===16&&(O&4194240)!==0))return o;if((b&4)!==0&&(b|=m&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=b;0<o;)m=31-Ne(o),E=1<<m,b|=i[m],o&=~E;return b}function ut(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Wt(i,o){for(var m=i.suspendedLanes,b=i.pingedLanes,E=i.expirationTimes,O=i.pendingLanes;0<O;){var H=31-Ne(O),we=1<<H,Ae=E[H];Ae===-1?((we&m)===0||(we&b)!==0)&&(E[H]=ut(we,o)):Ae<=o&&(i.expiredLanes|=we),O&=~we}}function vt(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Hr(){var i=$e;return $e<<=1,($e&4194240)===0&&($e=64),i}function yo(i){for(var o=[],m=0;31>m;m++)o.push(i);return o}function vo(i,o,m){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-Ne(o),i[o]=m}function ck(i,o){var m=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var b=i.eventTimes;for(i=i.expirationTimes;0<m;){var E=31-Ne(m),O=1<<E;o[E]=0,b[E]=-1,i[E]=-1,m&=~O}}function Bm(i,o){var m=i.entangledLanes|=o;for(i=i.entanglements;m;){var b=31-Ne(m),E=1<<b;E&o|i[b]&o&&(i[b]|=o),m&=~E}}var Os=0;function bf(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var wf,zm,Nf,jf,Sf,$m=!1,Jc=[],Ya=null,Ka=null,Xa=null,bo=new Map,wo=new Map,Ja=[],dk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kf(i,o){switch(i){case"focusin":case"focusout":Ya=null;break;case"dragenter":case"dragleave":Ka=null;break;case"mouseover":case"mouseout":Xa=null;break;case"pointerover":case"pointerout":bo.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":wo.delete(o.pointerId)}}function No(i,o,m,b,E,O){return i===null||i.nativeEvent!==O?(i={blockedOn:o,domEventName:m,eventSystemFlags:b,nativeEvent:O,targetContainers:[E]},o!==null&&(o=Fo(o),o!==null&&zm(o)),i):(i.eventSystemFlags|=b,o=i.targetContainers,E!==null&&o.indexOf(E)===-1&&o.push(E),i)}function uk(i,o,m,b,E){switch(o){case"focusin":return Ya=No(Ya,i,o,m,b,E),!0;case"dragenter":return Ka=No(Ka,i,o,m,b,E),!0;case"mouseover":return Xa=No(Xa,i,o,m,b,E),!0;case"pointerover":var O=E.pointerId;return bo.set(O,No(bo.get(O)||null,i,o,m,b,E)),!0;case"gotpointercapture":return O=E.pointerId,wo.set(O,No(wo.get(O)||null,i,o,m,b,E)),!0}return!1}function Cf(i){var o=Ti(i.target);if(o!==null){var m=le(o);if(m!==null){if(o=m.tag,o===13){if(o=Pe(m),o!==null){i.blockedOn=o,Sf(i.priority,function(){Nf(m)});return}}else if(o===3&&m.stateNode.current.memoizedState.isDehydrated){i.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Zc(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var m=Um(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(m===null){m=i.nativeEvent;var b=new m.constructor(m.type,m);$t=b,m.target.dispatchEvent(b),$t=null}else return o=Fo(m),o!==null&&zm(o),i.blockedOn=m,!1;o.shift()}return!0}function _f(i,o,m){Zc(i)&&m.delete(o)}function mk(){$m=!1,Ya!==null&&Zc(Ya)&&(Ya=null),Ka!==null&&Zc(Ka)&&(Ka=null),Xa!==null&&Zc(Xa)&&(Xa=null),bo.forEach(_f),wo.forEach(_f)}function jo(i,o){i.blockedOn===o&&(i.blockedOn=null,$m||($m=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,mk)))}function So(i){function o(E){return jo(E,i)}if(0<Jc.length){jo(Jc[0],i);for(var m=1;m<Jc.length;m++){var b=Jc[m];b.blockedOn===i&&(b.blockedOn=null)}}for(Ya!==null&&jo(Ya,i),Ka!==null&&jo(Ka,i),Xa!==null&&jo(Xa,i),bo.forEach(o),wo.forEach(o),m=0;m<Ja.length;m++)b=Ja[m],b.blockedOn===i&&(b.blockedOn=null);for(;0<Ja.length&&(m=Ja[0],m.blockedOn===null);)Cf(m),m.blockedOn===null&&Ja.shift()}var pl=q.ReactCurrentBatchConfig,ed=!0;function pk(i,o,m,b){var E=Os,O=pl.transition;pl.transition=null;try{Os=1,Qm(i,o,m,b)}finally{Os=E,pl.transition=O}}function xk(i,o,m,b){var E=Os,O=pl.transition;pl.transition=null;try{Os=4,Qm(i,o,m,b)}finally{Os=E,pl.transition=O}}function Qm(i,o,m,b){if(ed){var E=Um(i,o,m,b);if(E===null)lp(i,o,b,td,m),kf(i,b);else if(uk(E,i,o,m,b))b.stopPropagation();else if(kf(i,b),o&4&&-1<dk.indexOf(i)){for(;E!==null;){var O=Fo(E);if(O!==null&&wf(O),O=Um(i,o,m,b),O===null&&lp(i,o,b,td,m),O===E)break;E=O}E!==null&&b.stopPropagation()}else lp(i,o,b,null,m)}}var td=null;function Um(i,o,m,b){if(td=null,i=At(b),i=Ti(i),i!==null)if(o=le(i),o===null)i=null;else if(m=o.tag,m===13){if(i=Pe(o),i!==null)return i;i=null}else if(m===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return td=i,null}function Ef(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(x()){case A:return 1;case g:return 4;case p:case y:return 16;case N:return 536870912;default:return 16}default:return 16}}var Za=null,Vm=null,sd=null;function Pf(){if(sd)return sd;var i,o=Vm,m=o.length,b,E="value"in Za?Za.value:Za.textContent,O=E.length;for(i=0;i<m&&o[i]===E[i];i++);var H=m-i;for(b=1;b<=H&&o[m-b]===E[O-b];b++);return sd=E.slice(i,1<b?1-b:void 0)}function rd(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function nd(){return!0}function Af(){return!1}function gn(i){function o(m,b,E,O,H){this._reactName=m,this._targetInst=E,this.type=b,this.nativeEvent=O,this.target=H,this.currentTarget=null;for(var we in i)i.hasOwnProperty(we)&&(m=i[we],this[we]=m?m(O):O[we]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?nd:Af,this.isPropagationStopped=Af,this}return pe(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=nd)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=nd)},persist:function(){},isPersistent:nd}),o}var xl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wm=gn(xl),ko=pe({},xl,{view:0,detail:0}),hk=gn(ko),Gm,Hm,Co,ad=pe({},ko,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Km,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Co&&(Co&&i.type==="mousemove"?(Gm=i.screenX-Co.screenX,Hm=i.screenY-Co.screenY):Hm=Gm=0,Co=i),Gm)},movementY:function(i){return"movementY"in i?i.movementY:Hm}}),Tf=gn(ad),fk=pe({},ad,{dataTransfer:0}),gk=gn(fk),yk=pe({},ko,{relatedTarget:0}),Ym=gn(yk),vk=pe({},xl,{animationName:0,elapsedTime:0,pseudoElement:0}),bk=gn(vk),wk=pe({},xl,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Nk=gn(wk),jk=pe({},xl,{data:0}),Of=gn(jk),Sk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ck={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _k(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Ck[i])?!!o[i]:!1}function Km(){return _k}var Ek=pe({},ko,{key:function(i){if(i.key){var o=Sk[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=rd(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?kk[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Km,charCode:function(i){return i.type==="keypress"?rd(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?rd(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Pk=gn(Ek),Ak=pe({},ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rf=gn(Ak),Tk=pe({},ko,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Km}),Ok=gn(Tk),Rk=pe({},xl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dk=gn(Rk),Lk=pe({},ad,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Fk=gn(Lk),Mk=[9,13,27,32],Xm=u&&"CompositionEvent"in window,_o=null;u&&"documentMode"in document&&(_o=document.documentMode);var Ik=u&&"TextEvent"in window&&!_o,Df=u&&(!Xm||_o&&8<_o&&11>=_o),Lf=" ",Ff=!1;function Mf(i,o){switch(i){case"keyup":return Mk.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function If(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var hl=!1;function qk(i,o){switch(i){case"compositionend":return If(o);case"keypress":return o.which!==32?null:(Ff=!0,Lf);case"textInput":return i=o.data,i===Lf&&Ff?null:i;default:return null}}function Bk(i,o){if(hl)return i==="compositionend"||!Xm&&Mf(i,o)?(i=Pf(),sd=Vm=Za=null,hl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Df&&o.locale!=="ko"?null:o.data;default:return null}}var zk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qf(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!zk[i.type]:o==="textarea"}function Bf(i,o,m,b){St(b),o=dd(o,"onChange"),0<o.length&&(m=new Wm("onChange","change",null,m,b),i.push({event:m,listeners:o}))}var Eo=null,Po=null;function $k(i){ng(i,0)}function id(i){var o=bl(i);if(et(o))return i}function Qk(i,o){if(i==="change")return o}var zf=!1;if(u){var Jm;if(u){var Zm="oninput"in document;if(!Zm){var $f=document.createElement("div");$f.setAttribute("oninput","return;"),Zm=typeof $f.oninput=="function"}Jm=Zm}else Jm=!1;zf=Jm&&(!document.documentMode||9<document.documentMode)}function Qf(){Eo&&(Eo.detachEvent("onpropertychange",Uf),Po=Eo=null)}function Uf(i){if(i.propertyName==="value"&&id(Po)){var o=[];Bf(o,Po,i,At(i)),Kt($k,o)}}function Uk(i,o,m){i==="focusin"?(Qf(),Eo=o,Po=m,Eo.attachEvent("onpropertychange",Uf)):i==="focusout"&&Qf()}function Vk(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return id(Po)}function Wk(i,o){if(i==="click")return id(o)}function Gk(i,o){if(i==="input"||i==="change")return id(o)}function Hk(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Bn=typeof Object.is=="function"?Object.is:Hk;function Ao(i,o){if(Bn(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var m=Object.keys(i),b=Object.keys(o);if(m.length!==b.length)return!1;for(b=0;b<m.length;b++){var E=m[b];if(!f.call(o,E)||!Bn(i[E],o[E]))return!1}return!0}function Vf(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Wf(i,o){var m=Vf(i);i=0;for(var b;m;){if(m.nodeType===3){if(b=i+m.textContent.length,i<=o&&b>=o)return{node:m,offset:o-i};i=b}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=Vf(m)}}function Gf(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Gf(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Hf(){for(var i=window,o=Nt();o instanceof i.HTMLIFrameElement;){try{var m=typeof o.contentWindow.location.href=="string"}catch{m=!1}if(m)i=o.contentWindow;else break;o=Nt(i.document)}return o}function ep(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function Yk(i){var o=Hf(),m=i.focusedElem,b=i.selectionRange;if(o!==m&&m&&m.ownerDocument&&Gf(m.ownerDocument.documentElement,m)){if(b!==null&&ep(m)){if(o=b.start,i=b.end,i===void 0&&(i=o),"selectionStart"in m)m.selectionStart=o,m.selectionEnd=Math.min(i,m.value.length);else if(i=(o=m.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var E=m.textContent.length,O=Math.min(b.start,E);b=b.end===void 0?O:Math.min(b.end,E),!i.extend&&O>b&&(E=b,b=O,O=E),E=Wf(m,O);var H=Wf(m,b);E&&H&&(i.rangeCount!==1||i.anchorNode!==E.node||i.anchorOffset!==E.offset||i.focusNode!==H.node||i.focusOffset!==H.offset)&&(o=o.createRange(),o.setStart(E.node,E.offset),i.removeAllRanges(),O>b?(i.addRange(o),i.extend(H.node,H.offset)):(o.setEnd(H.node,H.offset),i.addRange(o)))}}for(o=[],i=m;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<o.length;m++)i=o[m],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Kk=u&&"documentMode"in document&&11>=document.documentMode,fl=null,tp=null,To=null,sp=!1;function Yf(i,o,m){var b=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;sp||fl==null||fl!==Nt(b)||(b=fl,"selectionStart"in b&&ep(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),To&&Ao(To,b)||(To=b,b=dd(tp,"onSelect"),0<b.length&&(o=new Wm("onSelect","select",null,o,m),i.push({event:o,listeners:b}),o.target=fl)))}function ld(i,o){var m={};return m[i.toLowerCase()]=o.toLowerCase(),m["Webkit"+i]="webkit"+o,m["Moz"+i]="moz"+o,m}var gl={animationend:ld("Animation","AnimationEnd"),animationiteration:ld("Animation","AnimationIteration"),animationstart:ld("Animation","AnimationStart"),transitionend:ld("Transition","TransitionEnd")},rp={},Kf={};u&&(Kf=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function od(i){if(rp[i])return rp[i];if(!gl[i])return i;var o=gl[i],m;for(m in o)if(o.hasOwnProperty(m)&&m in Kf)return rp[i]=o[m];return i}var Xf=od("animationend"),Jf=od("animationiteration"),Zf=od("animationstart"),eg=od("transitionend"),tg=new Map,sg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ei(i,o){tg.set(i,o),l(o,[i])}for(var np=0;np<sg.length;np++){var ap=sg[np],Xk=ap.toLowerCase(),Jk=ap[0].toUpperCase()+ap.slice(1);ei(Xk,"on"+Jk)}ei(Xf,"onAnimationEnd"),ei(Jf,"onAnimationIteration"),ei(Zf,"onAnimationStart"),ei("dblclick","onDoubleClick"),ei("focusin","onFocus"),ei("focusout","onBlur"),ei(eg,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oo));function rg(i,o,m){var b=i.type||"unknown-event";i.currentTarget=m,de(b,o,void 0,i),i.currentTarget=null}function ng(i,o){o=(o&4)!==0;for(var m=0;m<i.length;m++){var b=i[m],E=b.event;b=b.listeners;e:{var O=void 0;if(o)for(var H=b.length-1;0<=H;H--){var we=b[H],Ae=we.instance,Ye=we.currentTarget;if(we=we.listener,Ae!==O&&E.isPropagationStopped())break e;rg(E,we,Ye),O=Ae}else for(H=0;H<b.length;H++){if(we=b[H],Ae=we.instance,Ye=we.currentTarget,we=we.listener,Ae!==O&&E.isPropagationStopped())break e;rg(E,we,Ye),O=Ae}}}if(V)throw i=ie,V=!1,ie=null,i}function Qs(i,o){var m=o[pp];m===void 0&&(m=o[pp]=new Set);var b=i+"__bubble";m.has(b)||(ag(o,i,2,!1),m.add(b))}function ip(i,o,m){var b=0;o&&(b|=4),ag(m,i,b,o)}var cd="_reactListening"+Math.random().toString(36).slice(2);function Ro(i){if(!i[cd]){i[cd]=!0,n.forEach(function(m){m!=="selectionchange"&&(Zk.has(m)||ip(m,!1,i),ip(m,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[cd]||(o[cd]=!0,ip("selectionchange",!1,o))}}function ag(i,o,m,b){switch(Ef(o)){case 1:var E=pk;break;case 4:E=xk;break;default:E=Qm}m=E.bind(null,o,m,i),E=void 0,!Xt||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(E=!0),b?E!==void 0?i.addEventListener(o,m,{capture:!0,passive:E}):i.addEventListener(o,m,!0):E!==void 0?i.addEventListener(o,m,{passive:E}):i.addEventListener(o,m,!1)}function lp(i,o,m,b,E){var O=b;if((o&1)===0&&(o&2)===0&&b!==null)e:for(;;){if(b===null)return;var H=b.tag;if(H===3||H===4){var we=b.stateNode.containerInfo;if(we===E||we.nodeType===8&&we.parentNode===E)break;if(H===4)for(H=b.return;H!==null;){var Ae=H.tag;if((Ae===3||Ae===4)&&(Ae=H.stateNode.containerInfo,Ae===E||Ae.nodeType===8&&Ae.parentNode===E))return;H=H.return}for(;we!==null;){if(H=Ti(we),H===null)return;if(Ae=H.tag,Ae===5||Ae===6){b=O=H;continue e}we=we.parentNode}}b=b.return}Kt(function(){var Ye=O,ft=At(m),bt=[];e:{var xt=tg.get(i);if(xt!==void 0){var Gt=Wm,es=i;switch(i){case"keypress":if(rd(m)===0)break e;case"keydown":case"keyup":Gt=Pk;break;case"focusin":es="focus",Gt=Ym;break;case"focusout":es="blur",Gt=Ym;break;case"beforeblur":case"afterblur":Gt=Ym;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Gt=Tf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Gt=gk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Gt=Ok;break;case Xf:case Jf:case Zf:Gt=bk;break;case eg:Gt=Dk;break;case"scroll":Gt=hk;break;case"wheel":Gt=Fk;break;case"copy":case"cut":case"paste":Gt=Nk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Gt=Rf}var ns=(o&4)!==0,dr=!ns&&i==="scroll",ze=ns?xt!==null?xt+"Capture":null:xt;ns=[];for(var Oe=Ye,Qe;Oe!==null;){Qe=Oe;var Pt=Qe.stateNode;if(Qe.tag===5&&Pt!==null&&(Qe=Pt,ze!==null&&(Pt=Bt(Oe,ze),Pt!=null&&ns.push(Do(Oe,Pt,Qe)))),dr)break;Oe=Oe.return}0<ns.length&&(xt=new Gt(xt,es,null,m,ft),bt.push({event:xt,listeners:ns}))}}if((o&7)===0){e:{if(xt=i==="mouseover"||i==="pointerover",Gt=i==="mouseout"||i==="pointerout",xt&&m!==$t&&(es=m.relatedTarget||m.fromElement)&&(Ti(es)||es[_a]))break e;if((Gt||xt)&&(xt=ft.window===ft?ft:(xt=ft.ownerDocument)?xt.defaultView||xt.parentWindow:window,Gt?(es=m.relatedTarget||m.toElement,Gt=Ye,es=es?Ti(es):null,es!==null&&(dr=le(es),es!==dr||es.tag!==5&&es.tag!==6)&&(es=null)):(Gt=null,es=Ye),Gt!==es)){if(ns=Tf,Pt="onMouseLeave",ze="onMouseEnter",Oe="mouse",(i==="pointerout"||i==="pointerover")&&(ns=Rf,Pt="onPointerLeave",ze="onPointerEnter",Oe="pointer"),dr=Gt==null?xt:bl(Gt),Qe=es==null?xt:bl(es),xt=new ns(Pt,Oe+"leave",Gt,m,ft),xt.target=dr,xt.relatedTarget=Qe,Pt=null,Ti(ft)===Ye&&(ns=new ns(ze,Oe+"enter",es,m,ft),ns.target=Qe,ns.relatedTarget=dr,Pt=ns),dr=Pt,Gt&&es)t:{for(ns=Gt,ze=es,Oe=0,Qe=ns;Qe;Qe=yl(Qe))Oe++;for(Qe=0,Pt=ze;Pt;Pt=yl(Pt))Qe++;for(;0<Oe-Qe;)ns=yl(ns),Oe--;for(;0<Qe-Oe;)ze=yl(ze),Qe--;for(;Oe--;){if(ns===ze||ze!==null&&ns===ze.alternate)break t;ns=yl(ns),ze=yl(ze)}ns=null}else ns=null;Gt!==null&&ig(bt,xt,Gt,ns,!1),es!==null&&dr!==null&&ig(bt,dr,es,ns,!0)}}e:{if(xt=Ye?bl(Ye):window,Gt=xt.nodeName&&xt.nodeName.toLowerCase(),Gt==="select"||Gt==="input"&&xt.type==="file")var is=Qk;else if(qf(xt))if(zf)is=Gk;else{is=Vk;var os=Uk}else(Gt=xt.nodeName)&&Gt.toLowerCase()==="input"&&(xt.type==="checkbox"||xt.type==="radio")&&(is=Wk);if(is&&(is=is(i,Ye))){Bf(bt,is,m,ft);break e}os&&os(i,xt,Ye),i==="focusout"&&(os=xt._wrapperState)&&os.controlled&&xt.type==="number"&&it(xt,"number",xt.value)}switch(os=Ye?bl(Ye):window,i){case"focusin":(qf(os)||os.contentEditable==="true")&&(fl=os,tp=Ye,To=null);break;case"focusout":To=tp=fl=null;break;case"mousedown":sp=!0;break;case"contextmenu":case"mouseup":case"dragend":sp=!1,Yf(bt,m,ft);break;case"selectionchange":if(Kk)break;case"keydown":case"keyup":Yf(bt,m,ft)}var cs;if(Xm)e:{switch(i){case"compositionstart":var ps="onCompositionStart";break e;case"compositionend":ps="onCompositionEnd";break e;case"compositionupdate":ps="onCompositionUpdate";break e}ps=void 0}else hl?Mf(i,m)&&(ps="onCompositionEnd"):i==="keydown"&&m.keyCode===229&&(ps="onCompositionStart");ps&&(Df&&m.locale!=="ko"&&(hl||ps!=="onCompositionStart"?ps==="onCompositionEnd"&&hl&&(cs=Pf()):(Za=ft,Vm="value"in Za?Za.value:Za.textContent,hl=!0)),os=dd(Ye,ps),0<os.length&&(ps=new Of(ps,i,null,m,ft),bt.push({event:ps,listeners:os}),cs?ps.data=cs:(cs=If(m),cs!==null&&(ps.data=cs)))),(cs=Ik?qk(i,m):Bk(i,m))&&(Ye=dd(Ye,"onBeforeInput"),0<Ye.length&&(ft=new Of("onBeforeInput","beforeinput",null,m,ft),bt.push({event:ft,listeners:Ye}),ft.data=cs))}ng(bt,o)})}function Do(i,o,m){return{instance:i,listener:o,currentTarget:m}}function dd(i,o){for(var m=o+"Capture",b=[];i!==null;){var E=i,O=E.stateNode;E.tag===5&&O!==null&&(E=O,O=Bt(i,m),O!=null&&b.unshift(Do(i,O,E)),O=Bt(i,o),O!=null&&b.push(Do(i,O,E))),i=i.return}return b}function yl(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function ig(i,o,m,b,E){for(var O=o._reactName,H=[];m!==null&&m!==b;){var we=m,Ae=we.alternate,Ye=we.stateNode;if(Ae!==null&&Ae===b)break;we.tag===5&&Ye!==null&&(we=Ye,E?(Ae=Bt(m,O),Ae!=null&&H.unshift(Do(m,Ae,we))):E||(Ae=Bt(m,O),Ae!=null&&H.push(Do(m,Ae,we)))),m=m.return}H.length!==0&&i.push({event:o,listeners:H})}var eC=/\r\n?/g,tC=/\u0000|\uFFFD/g;function lg(i){return(typeof i=="string"?i:""+i).replace(eC,`
`).replace(tC,"")}function ud(i,o,m){if(o=lg(o),lg(i)!==o&&m)throw Error(r(425))}function md(){}var op=null,cp=null;function dp(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var up=typeof setTimeout=="function"?setTimeout:void 0,sC=typeof clearTimeout=="function"?clearTimeout:void 0,og=typeof Promise=="function"?Promise:void 0,rC=typeof queueMicrotask=="function"?queueMicrotask:typeof og<"u"?function(i){return og.resolve(null).then(i).catch(nC)}:up;function nC(i){setTimeout(function(){throw i})}function mp(i,o){var m=o,b=0;do{var E=m.nextSibling;if(i.removeChild(m),E&&E.nodeType===8)if(m=E.data,m==="/$"){if(b===0){i.removeChild(E),So(o);return}b--}else m!=="$"&&m!=="$?"&&m!=="$!"||b++;m=E}while(m);So(o)}function ti(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function cg(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var m=i.data;if(m==="$"||m==="$!"||m==="$?"){if(o===0)return i;o--}else m==="/$"&&o++}i=i.previousSibling}return null}var vl=Math.random().toString(36).slice(2),oa="__reactFiber$"+vl,Lo="__reactProps$"+vl,_a="__reactContainer$"+vl,pp="__reactEvents$"+vl,aC="__reactListeners$"+vl,iC="__reactHandles$"+vl;function Ti(i){var o=i[oa];if(o)return o;for(var m=i.parentNode;m;){if(o=m[_a]||m[oa]){if(m=o.alternate,o.child!==null||m!==null&&m.child!==null)for(i=cg(i);i!==null;){if(m=i[oa])return m;i=cg(i)}return o}i=m,m=i.parentNode}return null}function Fo(i){return i=i[oa]||i[_a],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function bl(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(r(33))}function pd(i){return i[Lo]||null}var xp=[],wl=-1;function si(i){return{current:i}}function Us(i){0>wl||(i.current=xp[wl],xp[wl]=null,wl--)}function Bs(i,o){wl++,xp[wl]=i.current,i.current=o}var ri={},Br=si(ri),sn=si(!1),Oi=ri;function Nl(i,o){var m=i.type.contextTypes;if(!m)return ri;var b=i.stateNode;if(b&&b.__reactInternalMemoizedUnmaskedChildContext===o)return b.__reactInternalMemoizedMaskedChildContext;var E={},O;for(O in m)E[O]=o[O];return b&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=E),E}function rn(i){return i=i.childContextTypes,i!=null}function xd(){Us(sn),Us(Br)}function dg(i,o,m){if(Br.current!==ri)throw Error(r(168));Bs(Br,o),Bs(sn,m)}function ug(i,o,m){var b=i.stateNode;if(o=o.childContextTypes,typeof b.getChildContext!="function")return m;b=b.getChildContext();for(var E in b)if(!(E in o))throw Error(r(108,fe(i)||"Unknown",E));return pe({},m,b)}function hd(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||ri,Oi=Br.current,Bs(Br,i),Bs(sn,sn.current),!0}function mg(i,o,m){var b=i.stateNode;if(!b)throw Error(r(169));m?(i=ug(i,o,Oi),b.__reactInternalMemoizedMergedChildContext=i,Us(sn),Us(Br),Bs(Br,i)):Us(sn),Bs(sn,m)}var Ea=null,fd=!1,hp=!1;function pg(i){Ea===null?Ea=[i]:Ea.push(i)}function lC(i){fd=!0,pg(i)}function ni(){if(!hp&&Ea!==null){hp=!0;var i=0,o=Os;try{var m=Ea;for(Os=1;i<m.length;i++){var b=m[i];do b=b(!0);while(b!==null)}Ea=null,fd=!1}catch(E){throw Ea!==null&&(Ea=Ea.slice(i+1)),Fe(A,ni),E}finally{Os=o,hp=!1}}return null}var jl=[],Sl=0,gd=null,yd=0,An=[],Tn=0,Ri=null,Pa=1,Aa="";function Di(i,o){jl[Sl++]=yd,jl[Sl++]=gd,gd=i,yd=o}function xg(i,o,m){An[Tn++]=Pa,An[Tn++]=Aa,An[Tn++]=Ri,Ri=i;var b=Pa;i=Aa;var E=32-Ne(b)-1;b&=~(1<<E),m+=1;var O=32-Ne(o)+E;if(30<O){var H=E-E%5;O=(b&(1<<H)-1).toString(32),b>>=H,E-=H,Pa=1<<32-Ne(o)+E|m<<E|b,Aa=O+i}else Pa=1<<O|m<<E|b,Aa=i}function fp(i){i.return!==null&&(Di(i,1),xg(i,1,0))}function gp(i){for(;i===gd;)gd=jl[--Sl],jl[Sl]=null,yd=jl[--Sl],jl[Sl]=null;for(;i===Ri;)Ri=An[--Tn],An[Tn]=null,Aa=An[--Tn],An[Tn]=null,Pa=An[--Tn],An[Tn]=null}var yn=null,vn=null,Gs=!1,zn=null;function hg(i,o){var m=Ln(5,null,null,0);m.elementType="DELETED",m.stateNode=o,m.return=i,o=i.deletions,o===null?(i.deletions=[m],i.flags|=16):o.push(m)}function fg(i,o){switch(i.tag){case 5:var m=i.type;return o=o.nodeType!==1||m.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,yn=i,vn=ti(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,yn=i,vn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(m=Ri!==null?{id:Pa,overflow:Aa}:null,i.memoizedState={dehydrated:o,treeContext:m,retryLane:1073741824},m=Ln(18,null,null,0),m.stateNode=o,m.return=i,i.child=m,yn=i,vn=null,!0):!1;default:return!1}}function yp(i){return(i.mode&1)!==0&&(i.flags&128)===0}function vp(i){if(Gs){var o=vn;if(o){var m=o;if(!fg(i,o)){if(yp(i))throw Error(r(418));o=ti(m.nextSibling);var b=yn;o&&fg(i,o)?hg(b,m):(i.flags=i.flags&-4097|2,Gs=!1,yn=i)}}else{if(yp(i))throw Error(r(418));i.flags=i.flags&-4097|2,Gs=!1,yn=i}}}function gg(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;yn=i}function vd(i){if(i!==yn)return!1;if(!Gs)return gg(i),Gs=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!dp(i.type,i.memoizedProps)),o&&(o=vn)){if(yp(i))throw yg(),Error(r(418));for(;o;)hg(i,o),o=ti(o.nextSibling)}if(gg(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var m=i.data;if(m==="/$"){if(o===0){vn=ti(i.nextSibling);break e}o--}else m!=="$"&&m!=="$!"&&m!=="$?"||o++}i=i.nextSibling}vn=null}}else vn=yn?ti(i.stateNode.nextSibling):null;return!0}function yg(){for(var i=vn;i;)i=ti(i.nextSibling)}function kl(){vn=yn=null,Gs=!1}function bp(i){zn===null?zn=[i]:zn.push(i)}var oC=q.ReactCurrentBatchConfig;function Mo(i,o,m){if(i=m.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(r(309));var b=m.stateNode}if(!b)throw Error(r(147,i));var E=b,O=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===O?o.ref:(o=function(H){var we=E.refs;H===null?delete we[O]:we[O]=H},o._stringRef=O,o)}if(typeof i!="string")throw Error(r(284));if(!m._owner)throw Error(r(290,i))}return i}function bd(i,o){throw i=Object.prototype.toString.call(o),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function vg(i){var o=i._init;return o(i._payload)}function bg(i){function o(ze,Oe){if(i){var Qe=ze.deletions;Qe===null?(ze.deletions=[Oe],ze.flags|=16):Qe.push(Oe)}}function m(ze,Oe){if(!i)return null;for(;Oe!==null;)o(ze,Oe),Oe=Oe.sibling;return null}function b(ze,Oe){for(ze=new Map;Oe!==null;)Oe.key!==null?ze.set(Oe.key,Oe):ze.set(Oe.index,Oe),Oe=Oe.sibling;return ze}function E(ze,Oe){return ze=mi(ze,Oe),ze.index=0,ze.sibling=null,ze}function O(ze,Oe,Qe){return ze.index=Qe,i?(Qe=ze.alternate,Qe!==null?(Qe=Qe.index,Qe<Oe?(ze.flags|=2,Oe):Qe):(ze.flags|=2,Oe)):(ze.flags|=1048576,Oe)}function H(ze){return i&&ze.alternate===null&&(ze.flags|=2),ze}function we(ze,Oe,Qe,Pt){return Oe===null||Oe.tag!==6?(Oe=u0(Qe,ze.mode,Pt),Oe.return=ze,Oe):(Oe=E(Oe,Qe),Oe.return=ze,Oe)}function Ae(ze,Oe,Qe,Pt){var is=Qe.type;return is===M?ft(ze,Oe,Qe.props.children,Pt,Qe.key):Oe!==null&&(Oe.elementType===is||typeof is=="object"&&is!==null&&is.$$typeof===Y&&vg(is)===Oe.type)?(Pt=E(Oe,Qe.props),Pt.ref=Mo(ze,Oe,Qe),Pt.return=ze,Pt):(Pt=Ud(Qe.type,Qe.key,Qe.props,null,ze.mode,Pt),Pt.ref=Mo(ze,Oe,Qe),Pt.return=ze,Pt)}function Ye(ze,Oe,Qe,Pt){return Oe===null||Oe.tag!==4||Oe.stateNode.containerInfo!==Qe.containerInfo||Oe.stateNode.implementation!==Qe.implementation?(Oe=m0(Qe,ze.mode,Pt),Oe.return=ze,Oe):(Oe=E(Oe,Qe.children||[]),Oe.return=ze,Oe)}function ft(ze,Oe,Qe,Pt,is){return Oe===null||Oe.tag!==7?(Oe=$i(Qe,ze.mode,Pt,is),Oe.return=ze,Oe):(Oe=E(Oe,Qe),Oe.return=ze,Oe)}function bt(ze,Oe,Qe){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number")return Oe=u0(""+Oe,ze.mode,Qe),Oe.return=ze,Oe;if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case me:return Qe=Ud(Oe.type,Oe.key,Oe.props,null,ze.mode,Qe),Qe.ref=Mo(ze,null,Oe),Qe.return=ze,Qe;case re:return Oe=m0(Oe,ze.mode,Qe),Oe.return=ze,Oe;case Y:var Pt=Oe._init;return bt(ze,Pt(Oe._payload),Qe)}if(Et(Oe)||be(Oe))return Oe=$i(Oe,ze.mode,Qe,null),Oe.return=ze,Oe;bd(ze,Oe)}return null}function xt(ze,Oe,Qe,Pt){var is=Oe!==null?Oe.key:null;if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number")return is!==null?null:we(ze,Oe,""+Qe,Pt);if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case me:return Qe.key===is?Ae(ze,Oe,Qe,Pt):null;case re:return Qe.key===is?Ye(ze,Oe,Qe,Pt):null;case Y:return is=Qe._init,xt(ze,Oe,is(Qe._payload),Pt)}if(Et(Qe)||be(Qe))return is!==null?null:ft(ze,Oe,Qe,Pt,null);bd(ze,Qe)}return null}function Gt(ze,Oe,Qe,Pt,is){if(typeof Pt=="string"&&Pt!==""||typeof Pt=="number")return ze=ze.get(Qe)||null,we(Oe,ze,""+Pt,is);if(typeof Pt=="object"&&Pt!==null){switch(Pt.$$typeof){case me:return ze=ze.get(Pt.key===null?Qe:Pt.key)||null,Ae(Oe,ze,Pt,is);case re:return ze=ze.get(Pt.key===null?Qe:Pt.key)||null,Ye(Oe,ze,Pt,is);case Y:var os=Pt._init;return Gt(ze,Oe,Qe,os(Pt._payload),is)}if(Et(Pt)||be(Pt))return ze=ze.get(Qe)||null,ft(Oe,ze,Pt,is,null);bd(Oe,Pt)}return null}function es(ze,Oe,Qe,Pt){for(var is=null,os=null,cs=Oe,ps=Oe=0,_r=null;cs!==null&&ps<Qe.length;ps++){cs.index>ps?(_r=cs,cs=null):_r=cs.sibling;var Cs=xt(ze,cs,Qe[ps],Pt);if(Cs===null){cs===null&&(cs=_r);break}i&&cs&&Cs.alternate===null&&o(ze,cs),Oe=O(Cs,Oe,ps),os===null?is=Cs:os.sibling=Cs,os=Cs,cs=_r}if(ps===Qe.length)return m(ze,cs),Gs&&Di(ze,ps),is;if(cs===null){for(;ps<Qe.length;ps++)cs=bt(ze,Qe[ps],Pt),cs!==null&&(Oe=O(cs,Oe,ps),os===null?is=cs:os.sibling=cs,os=cs);return Gs&&Di(ze,ps),is}for(cs=b(ze,cs);ps<Qe.length;ps++)_r=Gt(cs,ze,ps,Qe[ps],Pt),_r!==null&&(i&&_r.alternate!==null&&cs.delete(_r.key===null?ps:_r.key),Oe=O(_r,Oe,ps),os===null?is=_r:os.sibling=_r,os=_r);return i&&cs.forEach(function(pi){return o(ze,pi)}),Gs&&Di(ze,ps),is}function ns(ze,Oe,Qe,Pt){var is=be(Qe);if(typeof is!="function")throw Error(r(150));if(Qe=is.call(Qe),Qe==null)throw Error(r(151));for(var os=is=null,cs=Oe,ps=Oe=0,_r=null,Cs=Qe.next();cs!==null&&!Cs.done;ps++,Cs=Qe.next()){cs.index>ps?(_r=cs,cs=null):_r=cs.sibling;var pi=xt(ze,cs,Cs.value,Pt);if(pi===null){cs===null&&(cs=_r);break}i&&cs&&pi.alternate===null&&o(ze,cs),Oe=O(pi,Oe,ps),os===null?is=pi:os.sibling=pi,os=pi,cs=_r}if(Cs.done)return m(ze,cs),Gs&&Di(ze,ps),is;if(cs===null){for(;!Cs.done;ps++,Cs=Qe.next())Cs=bt(ze,Cs.value,Pt),Cs!==null&&(Oe=O(Cs,Oe,ps),os===null?is=Cs:os.sibling=Cs,os=Cs);return Gs&&Di(ze,ps),is}for(cs=b(ze,cs);!Cs.done;ps++,Cs=Qe.next())Cs=Gt(cs,ze,ps,Cs.value,Pt),Cs!==null&&(i&&Cs.alternate!==null&&cs.delete(Cs.key===null?ps:Cs.key),Oe=O(Cs,Oe,ps),os===null?is=Cs:os.sibling=Cs,os=Cs);return i&&cs.forEach(function(zC){return o(ze,zC)}),Gs&&Di(ze,ps),is}function dr(ze,Oe,Qe,Pt){if(typeof Qe=="object"&&Qe!==null&&Qe.type===M&&Qe.key===null&&(Qe=Qe.props.children),typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case me:e:{for(var is=Qe.key,os=Oe;os!==null;){if(os.key===is){if(is=Qe.type,is===M){if(os.tag===7){m(ze,os.sibling),Oe=E(os,Qe.props.children),Oe.return=ze,ze=Oe;break e}}else if(os.elementType===is||typeof is=="object"&&is!==null&&is.$$typeof===Y&&vg(is)===os.type){m(ze,os.sibling),Oe=E(os,Qe.props),Oe.ref=Mo(ze,os,Qe),Oe.return=ze,ze=Oe;break e}m(ze,os);break}else o(ze,os);os=os.sibling}Qe.type===M?(Oe=$i(Qe.props.children,ze.mode,Pt,Qe.key),Oe.return=ze,ze=Oe):(Pt=Ud(Qe.type,Qe.key,Qe.props,null,ze.mode,Pt),Pt.ref=Mo(ze,Oe,Qe),Pt.return=ze,ze=Pt)}return H(ze);case re:e:{for(os=Qe.key;Oe!==null;){if(Oe.key===os)if(Oe.tag===4&&Oe.stateNode.containerInfo===Qe.containerInfo&&Oe.stateNode.implementation===Qe.implementation){m(ze,Oe.sibling),Oe=E(Oe,Qe.children||[]),Oe.return=ze,ze=Oe;break e}else{m(ze,Oe);break}else o(ze,Oe);Oe=Oe.sibling}Oe=m0(Qe,ze.mode,Pt),Oe.return=ze,ze=Oe}return H(ze);case Y:return os=Qe._init,dr(ze,Oe,os(Qe._payload),Pt)}if(Et(Qe))return es(ze,Oe,Qe,Pt);if(be(Qe))return ns(ze,Oe,Qe,Pt);bd(ze,Qe)}return typeof Qe=="string"&&Qe!==""||typeof Qe=="number"?(Qe=""+Qe,Oe!==null&&Oe.tag===6?(m(ze,Oe.sibling),Oe=E(Oe,Qe),Oe.return=ze,ze=Oe):(m(ze,Oe),Oe=u0(Qe,ze.mode,Pt),Oe.return=ze,ze=Oe),H(ze)):m(ze,Oe)}return dr}var Cl=bg(!0),wg=bg(!1),wd=si(null),Nd=null,_l=null,wp=null;function Np(){wp=_l=Nd=null}function jp(i){var o=wd.current;Us(wd),i._currentValue=o}function Sp(i,o,m){for(;i!==null;){var b=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,b!==null&&(b.childLanes|=o)):b!==null&&(b.childLanes&o)!==o&&(b.childLanes|=o),i===m)break;i=i.return}}function El(i,o){Nd=i,wp=_l=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(nn=!0),i.firstContext=null)}function On(i){var o=i._currentValue;if(wp!==i)if(i={context:i,memoizedValue:o,next:null},_l===null){if(Nd===null)throw Error(r(308));_l=i,Nd.dependencies={lanes:0,firstContext:i}}else _l=_l.next=i;return o}var Li=null;function kp(i){Li===null?Li=[i]:Li.push(i)}function Ng(i,o,m,b){var E=o.interleaved;return E===null?(m.next=m,kp(o)):(m.next=E.next,E.next=m),o.interleaved=m,Ta(i,b)}function Ta(i,o){i.lanes|=o;var m=i.alternate;for(m!==null&&(m.lanes|=o),m=i,i=i.return;i!==null;)i.childLanes|=o,m=i.alternate,m!==null&&(m.childLanes|=o),m=i,i=i.return;return m.tag===3?m.stateNode:null}var ai=!1;function Cp(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jg(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Oa(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function ii(i,o,m){var b=i.updateQueue;if(b===null)return null;if(b=b.shared,(Ss&2)!==0){var E=b.pending;return E===null?o.next=o:(o.next=E.next,E.next=o),b.pending=o,Ta(i,m)}return E=b.interleaved,E===null?(o.next=o,kp(b)):(o.next=E.next,E.next=o),b.interleaved=o,Ta(i,m)}function jd(i,o,m){if(o=o.updateQueue,o!==null&&(o=o.shared,(m&4194240)!==0)){var b=o.lanes;b&=i.pendingLanes,m|=b,o.lanes=m,Bm(i,m)}}function Sg(i,o){var m=i.updateQueue,b=i.alternate;if(b!==null&&(b=b.updateQueue,m===b)){var E=null,O=null;if(m=m.firstBaseUpdate,m!==null){do{var H={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};O===null?E=O=H:O=O.next=H,m=m.next}while(m!==null);O===null?E=O=o:O=O.next=o}else E=O=o;m={baseState:b.baseState,firstBaseUpdate:E,lastBaseUpdate:O,shared:b.shared,effects:b.effects},i.updateQueue=m;return}i=m.lastBaseUpdate,i===null?m.firstBaseUpdate=o:i.next=o,m.lastBaseUpdate=o}function Sd(i,o,m,b){var E=i.updateQueue;ai=!1;var O=E.firstBaseUpdate,H=E.lastBaseUpdate,we=E.shared.pending;if(we!==null){E.shared.pending=null;var Ae=we,Ye=Ae.next;Ae.next=null,H===null?O=Ye:H.next=Ye,H=Ae;var ft=i.alternate;ft!==null&&(ft=ft.updateQueue,we=ft.lastBaseUpdate,we!==H&&(we===null?ft.firstBaseUpdate=Ye:we.next=Ye,ft.lastBaseUpdate=Ae))}if(O!==null){var bt=E.baseState;H=0,ft=Ye=Ae=null,we=O;do{var xt=we.lane,Gt=we.eventTime;if((b&xt)===xt){ft!==null&&(ft=ft.next={eventTime:Gt,lane:0,tag:we.tag,payload:we.payload,callback:we.callback,next:null});e:{var es=i,ns=we;switch(xt=o,Gt=m,ns.tag){case 1:if(es=ns.payload,typeof es=="function"){bt=es.call(Gt,bt,xt);break e}bt=es;break e;case 3:es.flags=es.flags&-65537|128;case 0:if(es=ns.payload,xt=typeof es=="function"?es.call(Gt,bt,xt):es,xt==null)break e;bt=pe({},bt,xt);break e;case 2:ai=!0}}we.callback!==null&&we.lane!==0&&(i.flags|=64,xt=E.effects,xt===null?E.effects=[we]:xt.push(we))}else Gt={eventTime:Gt,lane:xt,tag:we.tag,payload:we.payload,callback:we.callback,next:null},ft===null?(Ye=ft=Gt,Ae=bt):ft=ft.next=Gt,H|=xt;if(we=we.next,we===null){if(we=E.shared.pending,we===null)break;xt=we,we=xt.next,xt.next=null,E.lastBaseUpdate=xt,E.shared.pending=null}}while(!0);if(ft===null&&(Ae=bt),E.baseState=Ae,E.firstBaseUpdate=Ye,E.lastBaseUpdate=ft,o=E.shared.interleaved,o!==null){E=o;do H|=E.lane,E=E.next;while(E!==o)}else O===null&&(E.shared.lanes=0);Ii|=H,i.lanes=H,i.memoizedState=bt}}function kg(i,o,m){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var b=i[o],E=b.callback;if(E!==null){if(b.callback=null,b=m,typeof E!="function")throw Error(r(191,E));E.call(b)}}}var Io={},ca=si(Io),qo=si(Io),Bo=si(Io);function Fi(i){if(i===Io)throw Error(r(174));return i}function _p(i,o){switch(Bs(Bo,o),Bs(qo,i),Bs(ca,Io),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:zt(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=zt(o,i)}Us(ca),Bs(ca,o)}function Pl(){Us(ca),Us(qo),Us(Bo)}function Cg(i){Fi(Bo.current);var o=Fi(ca.current),m=zt(o,i.type);o!==m&&(Bs(qo,i),Bs(ca,m))}function Ep(i){qo.current===i&&(Us(ca),Us(qo))}var Ks=si(0);function kd(i){for(var o=i;o!==null;){if(o.tag===13){var m=o.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Pp=[];function Ap(){for(var i=0;i<Pp.length;i++)Pp[i]._workInProgressVersionPrimary=null;Pp.length=0}var Cd=q.ReactCurrentDispatcher,Tp=q.ReactCurrentBatchConfig,Mi=0,Xs=null,br=null,kr=null,_d=!1,zo=!1,$o=0,cC=0;function zr(){throw Error(r(321))}function Op(i,o){if(o===null)return!1;for(var m=0;m<o.length&&m<i.length;m++)if(!Bn(i[m],o[m]))return!1;return!0}function Rp(i,o,m,b,E,O){if(Mi=O,Xs=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Cd.current=i===null||i.memoizedState===null?pC:xC,i=m(b,E),zo){O=0;do{if(zo=!1,$o=0,25<=O)throw Error(r(301));O+=1,kr=br=null,o.updateQueue=null,Cd.current=hC,i=m(b,E)}while(zo)}if(Cd.current=Ad,o=br!==null&&br.next!==null,Mi=0,kr=br=Xs=null,_d=!1,o)throw Error(r(300));return i}function Dp(){var i=$o!==0;return $o=0,i}function da(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kr===null?Xs.memoizedState=kr=i:kr=kr.next=i,kr}function Rn(){if(br===null){var i=Xs.alternate;i=i!==null?i.memoizedState:null}else i=br.next;var o=kr===null?Xs.memoizedState:kr.next;if(o!==null)kr=o,br=i;else{if(i===null)throw Error(r(310));br=i,i={memoizedState:br.memoizedState,baseState:br.baseState,baseQueue:br.baseQueue,queue:br.queue,next:null},kr===null?Xs.memoizedState=kr=i:kr=kr.next=i}return kr}function Qo(i,o){return typeof o=="function"?o(i):o}function Lp(i){var o=Rn(),m=o.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=i;var b=br,E=b.baseQueue,O=m.pending;if(O!==null){if(E!==null){var H=E.next;E.next=O.next,O.next=H}b.baseQueue=E=O,m.pending=null}if(E!==null){O=E.next,b=b.baseState;var we=H=null,Ae=null,Ye=O;do{var ft=Ye.lane;if((Mi&ft)===ft)Ae!==null&&(Ae=Ae.next={lane:0,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null}),b=Ye.hasEagerState?Ye.eagerState:i(b,Ye.action);else{var bt={lane:ft,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null};Ae===null?(we=Ae=bt,H=b):Ae=Ae.next=bt,Xs.lanes|=ft,Ii|=ft}Ye=Ye.next}while(Ye!==null&&Ye!==O);Ae===null?H=b:Ae.next=we,Bn(b,o.memoizedState)||(nn=!0),o.memoizedState=b,o.baseState=H,o.baseQueue=Ae,m.lastRenderedState=b}if(i=m.interleaved,i!==null){E=i;do O=E.lane,Xs.lanes|=O,Ii|=O,E=E.next;while(E!==i)}else E===null&&(m.lanes=0);return[o.memoizedState,m.dispatch]}function Fp(i){var o=Rn(),m=o.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=i;var b=m.dispatch,E=m.pending,O=o.memoizedState;if(E!==null){m.pending=null;var H=E=E.next;do O=i(O,H.action),H=H.next;while(H!==E);Bn(O,o.memoizedState)||(nn=!0),o.memoizedState=O,o.baseQueue===null&&(o.baseState=O),m.lastRenderedState=O}return[O,b]}function _g(){}function Eg(i,o){var m=Xs,b=Rn(),E=o(),O=!Bn(b.memoizedState,E);if(O&&(b.memoizedState=E,nn=!0),b=b.queue,Mp(Tg.bind(null,m,b,i),[i]),b.getSnapshot!==o||O||kr!==null&&kr.memoizedState.tag&1){if(m.flags|=2048,Uo(9,Ag.bind(null,m,b,E,o),void 0,null),Cr===null)throw Error(r(349));(Mi&30)!==0||Pg(m,o,E)}return E}function Pg(i,o,m){i.flags|=16384,i={getSnapshot:o,value:m},o=Xs.updateQueue,o===null?(o={lastEffect:null,stores:null},Xs.updateQueue=o,o.stores=[i]):(m=o.stores,m===null?o.stores=[i]:m.push(i))}function Ag(i,o,m,b){o.value=m,o.getSnapshot=b,Og(o)&&Rg(i)}function Tg(i,o,m){return m(function(){Og(o)&&Rg(i)})}function Og(i){var o=i.getSnapshot;i=i.value;try{var m=o();return!Bn(i,m)}catch{return!0}}function Rg(i){var o=Ta(i,1);o!==null&&Vn(o,i,1,-1)}function Dg(i){var o=da();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qo,lastRenderedState:i},o.queue=i,i=i.dispatch=mC.bind(null,Xs,i),[o.memoizedState,i]}function Uo(i,o,m,b){return i={tag:i,create:o,destroy:m,deps:b,next:null},o=Xs.updateQueue,o===null?(o={lastEffect:null,stores:null},Xs.updateQueue=o,o.lastEffect=i.next=i):(m=o.lastEffect,m===null?o.lastEffect=i.next=i:(b=m.next,m.next=i,i.next=b,o.lastEffect=i)),i}function Lg(){return Rn().memoizedState}function Ed(i,o,m,b){var E=da();Xs.flags|=i,E.memoizedState=Uo(1|o,m,void 0,b===void 0?null:b)}function Pd(i,o,m,b){var E=Rn();b=b===void 0?null:b;var O=void 0;if(br!==null){var H=br.memoizedState;if(O=H.destroy,b!==null&&Op(b,H.deps)){E.memoizedState=Uo(o,m,O,b);return}}Xs.flags|=i,E.memoizedState=Uo(1|o,m,O,b)}function Fg(i,o){return Ed(8390656,8,i,o)}function Mp(i,o){return Pd(2048,8,i,o)}function Mg(i,o){return Pd(4,2,i,o)}function Ig(i,o){return Pd(4,4,i,o)}function qg(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Bg(i,o,m){return m=m!=null?m.concat([i]):null,Pd(4,4,qg.bind(null,o,i),m)}function Ip(){}function zg(i,o){var m=Rn();o=o===void 0?null:o;var b=m.memoizedState;return b!==null&&o!==null&&Op(o,b[1])?b[0]:(m.memoizedState=[i,o],i)}function $g(i,o){var m=Rn();o=o===void 0?null:o;var b=m.memoizedState;return b!==null&&o!==null&&Op(o,b[1])?b[0]:(i=i(),m.memoizedState=[i,o],i)}function Qg(i,o,m){return(Mi&21)===0?(i.baseState&&(i.baseState=!1,nn=!0),i.memoizedState=m):(Bn(m,o)||(m=Hr(),Xs.lanes|=m,Ii|=m,i.baseState=!0),o)}function dC(i,o){var m=Os;Os=m!==0&&4>m?m:4,i(!0);var b=Tp.transition;Tp.transition={};try{i(!1),o()}finally{Os=m,Tp.transition=b}}function Ug(){return Rn().memoizedState}function uC(i,o,m){var b=di(i);if(m={lane:b,action:m,hasEagerState:!1,eagerState:null,next:null},Vg(i))Wg(o,m);else if(m=Ng(i,o,m,b),m!==null){var E=Kr();Vn(m,i,b,E),Gg(m,o,b)}}function mC(i,o,m){var b=di(i),E={lane:b,action:m,hasEagerState:!1,eagerState:null,next:null};if(Vg(i))Wg(o,E);else{var O=i.alternate;if(i.lanes===0&&(O===null||O.lanes===0)&&(O=o.lastRenderedReducer,O!==null))try{var H=o.lastRenderedState,we=O(H,m);if(E.hasEagerState=!0,E.eagerState=we,Bn(we,H)){var Ae=o.interleaved;Ae===null?(E.next=E,kp(o)):(E.next=Ae.next,Ae.next=E),o.interleaved=E;return}}catch{}finally{}m=Ng(i,o,E,b),m!==null&&(E=Kr(),Vn(m,i,b,E),Gg(m,o,b))}}function Vg(i){var o=i.alternate;return i===Xs||o!==null&&o===Xs}function Wg(i,o){zo=_d=!0;var m=i.pending;m===null?o.next=o:(o.next=m.next,m.next=o),i.pending=o}function Gg(i,o,m){if((m&4194240)!==0){var b=o.lanes;b&=i.pendingLanes,m|=b,o.lanes=m,Bm(i,m)}}var Ad={readContext:On,useCallback:zr,useContext:zr,useEffect:zr,useImperativeHandle:zr,useInsertionEffect:zr,useLayoutEffect:zr,useMemo:zr,useReducer:zr,useRef:zr,useState:zr,useDebugValue:zr,useDeferredValue:zr,useTransition:zr,useMutableSource:zr,useSyncExternalStore:zr,useId:zr,unstable_isNewReconciler:!1},pC={readContext:On,useCallback:function(i,o){return da().memoizedState=[i,o===void 0?null:o],i},useContext:On,useEffect:Fg,useImperativeHandle:function(i,o,m){return m=m!=null?m.concat([i]):null,Ed(4194308,4,qg.bind(null,o,i),m)},useLayoutEffect:function(i,o){return Ed(4194308,4,i,o)},useInsertionEffect:function(i,o){return Ed(4,2,i,o)},useMemo:function(i,o){var m=da();return o=o===void 0?null:o,i=i(),m.memoizedState=[i,o],i},useReducer:function(i,o,m){var b=da();return o=m!==void 0?m(o):o,b.memoizedState=b.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},b.queue=i,i=i.dispatch=uC.bind(null,Xs,i),[b.memoizedState,i]},useRef:function(i){var o=da();return i={current:i},o.memoizedState=i},useState:Dg,useDebugValue:Ip,useDeferredValue:function(i){return da().memoizedState=i},useTransition:function(){var i=Dg(!1),o=i[0];return i=dC.bind(null,i[1]),da().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,m){var b=Xs,E=da();if(Gs){if(m===void 0)throw Error(r(407));m=m()}else{if(m=o(),Cr===null)throw Error(r(349));(Mi&30)!==0||Pg(b,o,m)}E.memoizedState=m;var O={value:m,getSnapshot:o};return E.queue=O,Fg(Tg.bind(null,b,O,i),[i]),b.flags|=2048,Uo(9,Ag.bind(null,b,O,m,o),void 0,null),m},useId:function(){var i=da(),o=Cr.identifierPrefix;if(Gs){var m=Aa,b=Pa;m=(b&~(1<<32-Ne(b)-1)).toString(32)+m,o=":"+o+"R"+m,m=$o++,0<m&&(o+="H"+m.toString(32)),o+=":"}else m=cC++,o=":"+o+"r"+m.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},xC={readContext:On,useCallback:zg,useContext:On,useEffect:Mp,useImperativeHandle:Bg,useInsertionEffect:Mg,useLayoutEffect:Ig,useMemo:$g,useReducer:Lp,useRef:Lg,useState:function(){return Lp(Qo)},useDebugValue:Ip,useDeferredValue:function(i){var o=Rn();return Qg(o,br.memoizedState,i)},useTransition:function(){var i=Lp(Qo)[0],o=Rn().memoizedState;return[i,o]},useMutableSource:_g,useSyncExternalStore:Eg,useId:Ug,unstable_isNewReconciler:!1},hC={readContext:On,useCallback:zg,useContext:On,useEffect:Mp,useImperativeHandle:Bg,useInsertionEffect:Mg,useLayoutEffect:Ig,useMemo:$g,useReducer:Fp,useRef:Lg,useState:function(){return Fp(Qo)},useDebugValue:Ip,useDeferredValue:function(i){var o=Rn();return br===null?o.memoizedState=i:Qg(o,br.memoizedState,i)},useTransition:function(){var i=Fp(Qo)[0],o=Rn().memoizedState;return[i,o]},useMutableSource:_g,useSyncExternalStore:Eg,useId:Ug,unstable_isNewReconciler:!1};function $n(i,o){if(i&&i.defaultProps){o=pe({},o),i=i.defaultProps;for(var m in i)o[m]===void 0&&(o[m]=i[m]);return o}return o}function qp(i,o,m,b){o=i.memoizedState,m=m(b,o),m=m==null?o:pe({},o,m),i.memoizedState=m,i.lanes===0&&(i.updateQueue.baseState=m)}var Td={isMounted:function(i){return(i=i._reactInternals)?le(i)===i:!1},enqueueSetState:function(i,o,m){i=i._reactInternals;var b=Kr(),E=di(i),O=Oa(b,E);O.payload=o,m!=null&&(O.callback=m),o=ii(i,O,E),o!==null&&(Vn(o,i,E,b),jd(o,i,E))},enqueueReplaceState:function(i,o,m){i=i._reactInternals;var b=Kr(),E=di(i),O=Oa(b,E);O.tag=1,O.payload=o,m!=null&&(O.callback=m),o=ii(i,O,E),o!==null&&(Vn(o,i,E,b),jd(o,i,E))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var m=Kr(),b=di(i),E=Oa(m,b);E.tag=2,o!=null&&(E.callback=o),o=ii(i,E,b),o!==null&&(Vn(o,i,b,m),jd(o,i,b))}};function Hg(i,o,m,b,E,O,H){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(b,O,H):o.prototype&&o.prototype.isPureReactComponent?!Ao(m,b)||!Ao(E,O):!0}function Yg(i,o,m){var b=!1,E=ri,O=o.contextType;return typeof O=="object"&&O!==null?O=On(O):(E=rn(o)?Oi:Br.current,b=o.contextTypes,O=(b=b!=null)?Nl(i,E):ri),o=new o(m,O),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Td,i.stateNode=o,o._reactInternals=i,b&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=E,i.__reactInternalMemoizedMaskedChildContext=O),o}function Kg(i,o,m,b){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(m,b),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(m,b),o.state!==i&&Td.enqueueReplaceState(o,o.state,null)}function Bp(i,o,m,b){var E=i.stateNode;E.props=m,E.state=i.memoizedState,E.refs={},Cp(i);var O=o.contextType;typeof O=="object"&&O!==null?E.context=On(O):(O=rn(o)?Oi:Br.current,E.context=Nl(i,O)),E.state=i.memoizedState,O=o.getDerivedStateFromProps,typeof O=="function"&&(qp(i,o,O,m),E.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(o=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),o!==E.state&&Td.enqueueReplaceState(E,E.state,null),Sd(i,m,E,b),E.state=i.memoizedState),typeof E.componentDidMount=="function"&&(i.flags|=4194308)}function Al(i,o){try{var m="",b=o;do m+=ae(b),b=b.return;while(b);var E=m}catch(O){E=`
Error generating stack: `+O.message+`
`+O.stack}return{value:i,source:o,stack:E,digest:null}}function zp(i,o,m){return{value:i,source:null,stack:m??null,digest:o??null}}function $p(i,o){try{console.error(o.value)}catch(m){setTimeout(function(){throw m})}}var fC=typeof WeakMap=="function"?WeakMap:Map;function Xg(i,o,m){m=Oa(-1,m),m.tag=3,m.payload={element:null};var b=o.value;return m.callback=function(){Id||(Id=!0,r0=b),$p(i,o)},m}function Jg(i,o,m){m=Oa(-1,m),m.tag=3;var b=i.type.getDerivedStateFromError;if(typeof b=="function"){var E=o.value;m.payload=function(){return b(E)},m.callback=function(){$p(i,o)}}var O=i.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(m.callback=function(){$p(i,o),typeof b!="function"&&(oi===null?oi=new Set([this]):oi.add(this));var H=o.stack;this.componentDidCatch(o.value,{componentStack:H!==null?H:""})}),m}function Zg(i,o,m){var b=i.pingCache;if(b===null){b=i.pingCache=new fC;var E=new Set;b.set(o,E)}else E=b.get(o),E===void 0&&(E=new Set,b.set(o,E));E.has(m)||(E.add(m),i=AC.bind(null,i,o,m),o.then(i,i))}function ey(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function ty(i,o,m,b,E){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(o=Oa(-1,1),o.tag=2,ii(m,o,1))),m.lanes|=1),i):(i.flags|=65536,i.lanes=E,i)}var gC=q.ReactCurrentOwner,nn=!1;function Yr(i,o,m,b){o.child=i===null?wg(o,null,m,b):Cl(o,i.child,m,b)}function sy(i,o,m,b,E){m=m.render;var O=o.ref;return El(o,E),b=Rp(i,o,m,b,O,E),m=Dp(),i!==null&&!nn?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~E,Ra(i,o,E)):(Gs&&m&&fp(o),o.flags|=1,Yr(i,o,b,E),o.child)}function ry(i,o,m,b,E){if(i===null){var O=m.type;return typeof O=="function"&&!d0(O)&&O.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(o.tag=15,o.type=O,ny(i,o,O,b,E)):(i=Ud(m.type,null,b,o,o.mode,E),i.ref=o.ref,i.return=o,o.child=i)}if(O=i.child,(i.lanes&E)===0){var H=O.memoizedProps;if(m=m.compare,m=m!==null?m:Ao,m(H,b)&&i.ref===o.ref)return Ra(i,o,E)}return o.flags|=1,i=mi(O,b),i.ref=o.ref,i.return=o,o.child=i}function ny(i,o,m,b,E){if(i!==null){var O=i.memoizedProps;if(Ao(O,b)&&i.ref===o.ref)if(nn=!1,o.pendingProps=b=O,(i.lanes&E)!==0)(i.flags&131072)!==0&&(nn=!0);else return o.lanes=i.lanes,Ra(i,o,E)}return Qp(i,o,m,b,E)}function ay(i,o,m){var b=o.pendingProps,E=b.children,O=i!==null?i.memoizedState:null;if(b.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bs(Ol,bn),bn|=m;else{if((m&1073741824)===0)return i=O!==null?O.baseLanes|m:m,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Bs(Ol,bn),bn|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},b=O!==null?O.baseLanes:m,Bs(Ol,bn),bn|=b}else O!==null?(b=O.baseLanes|m,o.memoizedState=null):b=m,Bs(Ol,bn),bn|=b;return Yr(i,o,E,m),o.child}function iy(i,o){var m=o.ref;(i===null&&m!==null||i!==null&&i.ref!==m)&&(o.flags|=512,o.flags|=2097152)}function Qp(i,o,m,b,E){var O=rn(m)?Oi:Br.current;return O=Nl(o,O),El(o,E),m=Rp(i,o,m,b,O,E),b=Dp(),i!==null&&!nn?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~E,Ra(i,o,E)):(Gs&&b&&fp(o),o.flags|=1,Yr(i,o,m,E),o.child)}function ly(i,o,m,b,E){if(rn(m)){var O=!0;hd(o)}else O=!1;if(El(o,E),o.stateNode===null)Rd(i,o),Yg(o,m,b),Bp(o,m,b,E),b=!0;else if(i===null){var H=o.stateNode,we=o.memoizedProps;H.props=we;var Ae=H.context,Ye=m.contextType;typeof Ye=="object"&&Ye!==null?Ye=On(Ye):(Ye=rn(m)?Oi:Br.current,Ye=Nl(o,Ye));var ft=m.getDerivedStateFromProps,bt=typeof ft=="function"||typeof H.getSnapshotBeforeUpdate=="function";bt||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(we!==b||Ae!==Ye)&&Kg(o,H,b,Ye),ai=!1;var xt=o.memoizedState;H.state=xt,Sd(o,b,H,E),Ae=o.memoizedState,we!==b||xt!==Ae||sn.current||ai?(typeof ft=="function"&&(qp(o,m,ft,b),Ae=o.memoizedState),(we=ai||Hg(o,m,we,b,xt,Ae,Ye))?(bt||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount()),typeof H.componentDidMount=="function"&&(o.flags|=4194308)):(typeof H.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=b,o.memoizedState=Ae),H.props=b,H.state=Ae,H.context=Ye,b=we):(typeof H.componentDidMount=="function"&&(o.flags|=4194308),b=!1)}else{H=o.stateNode,jg(i,o),we=o.memoizedProps,Ye=o.type===o.elementType?we:$n(o.type,we),H.props=Ye,bt=o.pendingProps,xt=H.context,Ae=m.contextType,typeof Ae=="object"&&Ae!==null?Ae=On(Ae):(Ae=rn(m)?Oi:Br.current,Ae=Nl(o,Ae));var Gt=m.getDerivedStateFromProps;(ft=typeof Gt=="function"||typeof H.getSnapshotBeforeUpdate=="function")||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(we!==bt||xt!==Ae)&&Kg(o,H,b,Ae),ai=!1,xt=o.memoizedState,H.state=xt,Sd(o,b,H,E);var es=o.memoizedState;we!==bt||xt!==es||sn.current||ai?(typeof Gt=="function"&&(qp(o,m,Gt,b),es=o.memoizedState),(Ye=ai||Hg(o,m,Ye,b,xt,es,Ae)||!1)?(ft||typeof H.UNSAFE_componentWillUpdate!="function"&&typeof H.componentWillUpdate!="function"||(typeof H.componentWillUpdate=="function"&&H.componentWillUpdate(b,es,Ae),typeof H.UNSAFE_componentWillUpdate=="function"&&H.UNSAFE_componentWillUpdate(b,es,Ae)),typeof H.componentDidUpdate=="function"&&(o.flags|=4),typeof H.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof H.componentDidUpdate!="function"||we===i.memoizedProps&&xt===i.memoizedState||(o.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||we===i.memoizedProps&&xt===i.memoizedState||(o.flags|=1024),o.memoizedProps=b,o.memoizedState=es),H.props=b,H.state=es,H.context=Ae,b=Ye):(typeof H.componentDidUpdate!="function"||we===i.memoizedProps&&xt===i.memoizedState||(o.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||we===i.memoizedProps&&xt===i.memoizedState||(o.flags|=1024),b=!1)}return Up(i,o,m,b,O,E)}function Up(i,o,m,b,E,O){iy(i,o);var H=(o.flags&128)!==0;if(!b&&!H)return E&&mg(o,m,!1),Ra(i,o,O);b=o.stateNode,gC.current=o;var we=H&&typeof m.getDerivedStateFromError!="function"?null:b.render();return o.flags|=1,i!==null&&H?(o.child=Cl(o,i.child,null,O),o.child=Cl(o,null,we,O)):Yr(i,o,we,O),o.memoizedState=b.state,E&&mg(o,m,!0),o.child}function oy(i){var o=i.stateNode;o.pendingContext?dg(i,o.pendingContext,o.pendingContext!==o.context):o.context&&dg(i,o.context,!1),_p(i,o.containerInfo)}function cy(i,o,m,b,E){return kl(),bp(E),o.flags|=256,Yr(i,o,m,b),o.child}var Vp={dehydrated:null,treeContext:null,retryLane:0};function Wp(i){return{baseLanes:i,cachePool:null,transitions:null}}function dy(i,o,m){var b=o.pendingProps,E=Ks.current,O=!1,H=(o.flags&128)!==0,we;if((we=H)||(we=i!==null&&i.memoizedState===null?!1:(E&2)!==0),we?(O=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(E|=1),Bs(Ks,E&1),i===null)return vp(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(H=b.children,i=b.fallback,O?(b=o.mode,O=o.child,H={mode:"hidden",children:H},(b&1)===0&&O!==null?(O.childLanes=0,O.pendingProps=H):O=Vd(H,b,0,null),i=$i(i,b,m,null),O.return=o,i.return=o,O.sibling=i,o.child=O,o.child.memoizedState=Wp(m),o.memoizedState=Vp,i):Gp(o,H));if(E=i.memoizedState,E!==null&&(we=E.dehydrated,we!==null))return yC(i,o,H,b,we,E,m);if(O){O=b.fallback,H=o.mode,E=i.child,we=E.sibling;var Ae={mode:"hidden",children:b.children};return(H&1)===0&&o.child!==E?(b=o.child,b.childLanes=0,b.pendingProps=Ae,o.deletions=null):(b=mi(E,Ae),b.subtreeFlags=E.subtreeFlags&14680064),we!==null?O=mi(we,O):(O=$i(O,H,m,null),O.flags|=2),O.return=o,b.return=o,b.sibling=O,o.child=b,b=O,O=o.child,H=i.child.memoizedState,H=H===null?Wp(m):{baseLanes:H.baseLanes|m,cachePool:null,transitions:H.transitions},O.memoizedState=H,O.childLanes=i.childLanes&~m,o.memoizedState=Vp,b}return O=i.child,i=O.sibling,b=mi(O,{mode:"visible",children:b.children}),(o.mode&1)===0&&(b.lanes=m),b.return=o,b.sibling=null,i!==null&&(m=o.deletions,m===null?(o.deletions=[i],o.flags|=16):m.push(i)),o.child=b,o.memoizedState=null,b}function Gp(i,o){return o=Vd({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Od(i,o,m,b){return b!==null&&bp(b),Cl(o,i.child,null,m),i=Gp(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function yC(i,o,m,b,E,O,H){if(m)return o.flags&256?(o.flags&=-257,b=zp(Error(r(422))),Od(i,o,H,b)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(O=b.fallback,E=o.mode,b=Vd({mode:"visible",children:b.children},E,0,null),O=$i(O,E,H,null),O.flags|=2,b.return=o,O.return=o,b.sibling=O,o.child=b,(o.mode&1)!==0&&Cl(o,i.child,null,H),o.child.memoizedState=Wp(H),o.memoizedState=Vp,O);if((o.mode&1)===0)return Od(i,o,H,null);if(E.data==="$!"){if(b=E.nextSibling&&E.nextSibling.dataset,b)var we=b.dgst;return b=we,O=Error(r(419)),b=zp(O,b,void 0),Od(i,o,H,b)}if(we=(H&i.childLanes)!==0,nn||we){if(b=Cr,b!==null){switch(H&-H){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(b.suspendedLanes|H))!==0?0:E,E!==0&&E!==O.retryLane&&(O.retryLane=E,Ta(i,E),Vn(b,i,E,-1))}return c0(),b=zp(Error(r(421))),Od(i,o,H,b)}return E.data==="$?"?(o.flags|=128,o.child=i.child,o=TC.bind(null,i),E._reactRetry=o,null):(i=O.treeContext,vn=ti(E.nextSibling),yn=o,Gs=!0,zn=null,i!==null&&(An[Tn++]=Pa,An[Tn++]=Aa,An[Tn++]=Ri,Pa=i.id,Aa=i.overflow,Ri=o),o=Gp(o,b.children),o.flags|=4096,o)}function uy(i,o,m){i.lanes|=o;var b=i.alternate;b!==null&&(b.lanes|=o),Sp(i.return,o,m)}function Hp(i,o,m,b,E){var O=i.memoizedState;O===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:b,tail:m,tailMode:E}:(O.isBackwards=o,O.rendering=null,O.renderingStartTime=0,O.last=b,O.tail=m,O.tailMode=E)}function my(i,o,m){var b=o.pendingProps,E=b.revealOrder,O=b.tail;if(Yr(i,o,b.children,m),b=Ks.current,(b&2)!==0)b=b&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&uy(i,m,o);else if(i.tag===19)uy(i,m,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}b&=1}if(Bs(Ks,b),(o.mode&1)===0)o.memoizedState=null;else switch(E){case"forwards":for(m=o.child,E=null;m!==null;)i=m.alternate,i!==null&&kd(i)===null&&(E=m),m=m.sibling;m=E,m===null?(E=o.child,o.child=null):(E=m.sibling,m.sibling=null),Hp(o,!1,E,m,O);break;case"backwards":for(m=null,E=o.child,o.child=null;E!==null;){if(i=E.alternate,i!==null&&kd(i)===null){o.child=E;break}i=E.sibling,E.sibling=m,m=E,E=i}Hp(o,!0,m,null,O);break;case"together":Hp(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Rd(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function Ra(i,o,m){if(i!==null&&(o.dependencies=i.dependencies),Ii|=o.lanes,(m&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(r(153));if(o.child!==null){for(i=o.child,m=mi(i,i.pendingProps),o.child=m,m.return=o;i.sibling!==null;)i=i.sibling,m=m.sibling=mi(i,i.pendingProps),m.return=o;m.sibling=null}return o.child}function vC(i,o,m){switch(o.tag){case 3:oy(o),kl();break;case 5:Cg(o);break;case 1:rn(o.type)&&hd(o);break;case 4:_p(o,o.stateNode.containerInfo);break;case 10:var b=o.type._context,E=o.memoizedProps.value;Bs(wd,b._currentValue),b._currentValue=E;break;case 13:if(b=o.memoizedState,b!==null)return b.dehydrated!==null?(Bs(Ks,Ks.current&1),o.flags|=128,null):(m&o.child.childLanes)!==0?dy(i,o,m):(Bs(Ks,Ks.current&1),i=Ra(i,o,m),i!==null?i.sibling:null);Bs(Ks,Ks.current&1);break;case 19:if(b=(m&o.childLanes)!==0,(i.flags&128)!==0){if(b)return my(i,o,m);o.flags|=128}if(E=o.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Bs(Ks,Ks.current),b)break;return null;case 22:case 23:return o.lanes=0,ay(i,o,m)}return Ra(i,o,m)}var py,Yp,xy,hy;py=function(i,o){for(var m=o.child;m!==null;){if(m.tag===5||m.tag===6)i.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===o)break;for(;m.sibling===null;){if(m.return===null||m.return===o)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},Yp=function(){},xy=function(i,o,m,b){var E=i.memoizedProps;if(E!==b){i=o.stateNode,Fi(ca.current);var O=null;switch(m){case"input":E=ot(i,E),b=ot(i,b),O=[];break;case"select":E=pe({},E,{value:void 0}),b=pe({},b,{value:void 0}),O=[];break;case"textarea":E=xe(i,E),b=xe(i,b),O=[];break;default:typeof E.onClick!="function"&&typeof b.onClick=="function"&&(i.onclick=md)}kt(m,b);var H;m=null;for(Ye in E)if(!b.hasOwnProperty(Ye)&&E.hasOwnProperty(Ye)&&E[Ye]!=null)if(Ye==="style"){var we=E[Ye];for(H in we)we.hasOwnProperty(H)&&(m||(m={}),m[H]="")}else Ye!=="dangerouslySetInnerHTML"&&Ye!=="children"&&Ye!=="suppressContentEditableWarning"&&Ye!=="suppressHydrationWarning"&&Ye!=="autoFocus"&&(a.hasOwnProperty(Ye)?O||(O=[]):(O=O||[]).push(Ye,null));for(Ye in b){var Ae=b[Ye];if(we=E?.[Ye],b.hasOwnProperty(Ye)&&Ae!==we&&(Ae!=null||we!=null))if(Ye==="style")if(we){for(H in we)!we.hasOwnProperty(H)||Ae&&Ae.hasOwnProperty(H)||(m||(m={}),m[H]="");for(H in Ae)Ae.hasOwnProperty(H)&&we[H]!==Ae[H]&&(m||(m={}),m[H]=Ae[H])}else m||(O||(O=[]),O.push(Ye,m)),m=Ae;else Ye==="dangerouslySetInnerHTML"?(Ae=Ae?Ae.__html:void 0,we=we?we.__html:void 0,Ae!=null&&we!==Ae&&(O=O||[]).push(Ye,Ae)):Ye==="children"?typeof Ae!="string"&&typeof Ae!="number"||(O=O||[]).push(Ye,""+Ae):Ye!=="suppressContentEditableWarning"&&Ye!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ye)?(Ae!=null&&Ye==="onScroll"&&Qs("scroll",i),O||we===Ae||(O=[])):(O=O||[]).push(Ye,Ae))}m&&(O=O||[]).push("style",m);var Ye=O;(o.updateQueue=Ye)&&(o.flags|=4)}},hy=function(i,o,m,b){m!==b&&(o.flags|=4)};function Vo(i,o){if(!Gs)switch(i.tailMode){case"hidden":o=i.tail;for(var m=null;o!==null;)o.alternate!==null&&(m=o),o=o.sibling;m===null?i.tail=null:m.sibling=null;break;case"collapsed":m=i.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:b.sibling=null}}function $r(i){var o=i.alternate!==null&&i.alternate.child===i.child,m=0,b=0;if(o)for(var E=i.child;E!==null;)m|=E.lanes|E.childLanes,b|=E.subtreeFlags&14680064,b|=E.flags&14680064,E.return=i,E=E.sibling;else for(E=i.child;E!==null;)m|=E.lanes|E.childLanes,b|=E.subtreeFlags,b|=E.flags,E.return=i,E=E.sibling;return i.subtreeFlags|=b,i.childLanes=m,o}function bC(i,o,m){var b=o.pendingProps;switch(gp(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $r(o),null;case 1:return rn(o.type)&&xd(),$r(o),null;case 3:return b=o.stateNode,Pl(),Us(sn),Us(Br),Ap(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(i===null||i.child===null)&&(vd(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,zn!==null&&(i0(zn),zn=null))),Yp(i,o),$r(o),null;case 5:Ep(o);var E=Fi(Bo.current);if(m=o.type,i!==null&&o.stateNode!=null)xy(i,o,m,b,E),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!b){if(o.stateNode===null)throw Error(r(166));return $r(o),null}if(i=Fi(ca.current),vd(o)){b=o.stateNode,m=o.type;var O=o.memoizedProps;switch(b[oa]=o,b[Lo]=O,i=(o.mode&1)!==0,m){case"dialog":Qs("cancel",b),Qs("close",b);break;case"iframe":case"object":case"embed":Qs("load",b);break;case"video":case"audio":for(E=0;E<Oo.length;E++)Qs(Oo[E],b);break;case"source":Qs("error",b);break;case"img":case"image":case"link":Qs("error",b),Qs("load",b);break;case"details":Qs("toggle",b);break;case"input":Qt(b,O),Qs("invalid",b);break;case"select":b._wrapperState={wasMultiple:!!O.multiple},Qs("invalid",b);break;case"textarea":tt(b,O),Qs("invalid",b)}kt(m,O),E=null;for(var H in O)if(O.hasOwnProperty(H)){var we=O[H];H==="children"?typeof we=="string"?b.textContent!==we&&(O.suppressHydrationWarning!==!0&&ud(b.textContent,we,i),E=["children",we]):typeof we=="number"&&b.textContent!==""+we&&(O.suppressHydrationWarning!==!0&&ud(b.textContent,we,i),E=["children",""+we]):a.hasOwnProperty(H)&&we!=null&&H==="onScroll"&&Qs("scroll",b)}switch(m){case"input":Ve(b),mt(b,O,!0);break;case"textarea":Ve(b),Ue(b);break;case"select":case"option":break;default:typeof O.onClick=="function"&&(b.onclick=md)}b=E,o.updateQueue=b,b!==null&&(o.flags|=4)}else{H=E.nodeType===9?E:E.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=He(m)),i==="http://www.w3.org/1999/xhtml"?m==="script"?(i=H.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof b.is=="string"?i=H.createElement(m,{is:b.is}):(i=H.createElement(m),m==="select"&&(H=i,b.multiple?H.multiple=!0:b.size&&(H.size=b.size))):i=H.createElementNS(i,m),i[oa]=o,i[Lo]=b,py(i,o,!1,!1),o.stateNode=i;e:{switch(H=wt(m,b),m){case"dialog":Qs("cancel",i),Qs("close",i),E=b;break;case"iframe":case"object":case"embed":Qs("load",i),E=b;break;case"video":case"audio":for(E=0;E<Oo.length;E++)Qs(Oo[E],i);E=b;break;case"source":Qs("error",i),E=b;break;case"img":case"image":case"link":Qs("error",i),Qs("load",i),E=b;break;case"details":Qs("toggle",i),E=b;break;case"input":Qt(i,b),E=ot(i,b),Qs("invalid",i);break;case"option":E=b;break;case"select":i._wrapperState={wasMultiple:!!b.multiple},E=pe({},b,{value:void 0}),Qs("invalid",i);break;case"textarea":tt(i,b),E=xe(i,b),Qs("invalid",i);break;default:E=b}kt(m,E),we=E;for(O in we)if(we.hasOwnProperty(O)){var Ae=we[O];O==="style"?nt(i,Ae):O==="dangerouslySetInnerHTML"?(Ae=Ae?Ae.__html:void 0,Ae!=null&&jt(i,Ae)):O==="children"?typeof Ae=="string"?(m!=="textarea"||Ae!=="")&&ct(i,Ae):typeof Ae=="number"&&ct(i,""+Ae):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(a.hasOwnProperty(O)?Ae!=null&&O==="onScroll"&&Qs("scroll",i):Ae!=null&&B(i,O,Ae,H))}switch(m){case"input":Ve(i),mt(i,b,!1);break;case"textarea":Ve(i),Ue(i);break;case"option":b.value!=null&&i.setAttribute("value",""+Ee(b.value));break;case"select":i.multiple=!!b.multiple,O=b.value,O!=null?pt(i,!!b.multiple,O,!1):b.defaultValue!=null&&pt(i,!!b.multiple,b.defaultValue,!0);break;default:typeof E.onClick=="function"&&(i.onclick=md)}switch(m){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}}b&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return $r(o),null;case 6:if(i&&o.stateNode!=null)hy(i,o,i.memoizedProps,b);else{if(typeof b!="string"&&o.stateNode===null)throw Error(r(166));if(m=Fi(Bo.current),Fi(ca.current),vd(o)){if(b=o.stateNode,m=o.memoizedProps,b[oa]=o,(O=b.nodeValue!==m)&&(i=yn,i!==null))switch(i.tag){case 3:ud(b.nodeValue,m,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&ud(b.nodeValue,m,(i.mode&1)!==0)}O&&(o.flags|=4)}else b=(m.nodeType===9?m:m.ownerDocument).createTextNode(b),b[oa]=o,o.stateNode=b}return $r(o),null;case 13:if(Us(Ks),b=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Gs&&vn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)yg(),kl(),o.flags|=98560,O=!1;else if(O=vd(o),b!==null&&b.dehydrated!==null){if(i===null){if(!O)throw Error(r(318));if(O=o.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(r(317));O[oa]=o}else kl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;$r(o),O=!1}else zn!==null&&(i0(zn),zn=null),O=!0;if(!O)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=m,o):(b=b!==null,b!==(i!==null&&i.memoizedState!==null)&&b&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(Ks.current&1)!==0?wr===0&&(wr=3):c0())),o.updateQueue!==null&&(o.flags|=4),$r(o),null);case 4:return Pl(),Yp(i,o),i===null&&Ro(o.stateNode.containerInfo),$r(o),null;case 10:return jp(o.type._context),$r(o),null;case 17:return rn(o.type)&&xd(),$r(o),null;case 19:if(Us(Ks),O=o.memoizedState,O===null)return $r(o),null;if(b=(o.flags&128)!==0,H=O.rendering,H===null)if(b)Vo(O,!1);else{if(wr!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(H=kd(i),H!==null){for(o.flags|=128,Vo(O,!1),b=H.updateQueue,b!==null&&(o.updateQueue=b,o.flags|=4),o.subtreeFlags=0,b=m,m=o.child;m!==null;)O=m,i=b,O.flags&=14680066,H=O.alternate,H===null?(O.childLanes=0,O.lanes=i,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=H.childLanes,O.lanes=H.lanes,O.child=H.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=H.memoizedProps,O.memoizedState=H.memoizedState,O.updateQueue=H.updateQueue,O.type=H.type,i=H.dependencies,O.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),m=m.sibling;return Bs(Ks,Ks.current&1|2),o.child}i=i.sibling}O.tail!==null&&T()>Rl&&(o.flags|=128,b=!0,Vo(O,!1),o.lanes=4194304)}else{if(!b)if(i=kd(H),i!==null){if(o.flags|=128,b=!0,m=i.updateQueue,m!==null&&(o.updateQueue=m,o.flags|=4),Vo(O,!0),O.tail===null&&O.tailMode==="hidden"&&!H.alternate&&!Gs)return $r(o),null}else 2*T()-O.renderingStartTime>Rl&&m!==1073741824&&(o.flags|=128,b=!0,Vo(O,!1),o.lanes=4194304);O.isBackwards?(H.sibling=o.child,o.child=H):(m=O.last,m!==null?m.sibling=H:o.child=H,O.last=H)}return O.tail!==null?(o=O.tail,O.rendering=o,O.tail=o.sibling,O.renderingStartTime=T(),o.sibling=null,m=Ks.current,Bs(Ks,b?m&1|2:m&1),o):($r(o),null);case 22:case 23:return o0(),b=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==b&&(o.flags|=8192),b&&(o.mode&1)!==0?(bn&1073741824)!==0&&($r(o),o.subtreeFlags&6&&(o.flags|=8192)):$r(o),null;case 24:return null;case 25:return null}throw Error(r(156,o.tag))}function wC(i,o){switch(gp(o),o.tag){case 1:return rn(o.type)&&xd(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Pl(),Us(sn),Us(Br),Ap(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return Ep(o),null;case 13:if(Us(Ks),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(r(340));kl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Us(Ks),null;case 4:return Pl(),null;case 10:return jp(o.type._context),null;case 22:case 23:return o0(),null;case 24:return null;default:return null}}var Dd=!1,Qr=!1,NC=typeof WeakSet=="function"?WeakSet:Set,Jt=null;function Tl(i,o){var m=i.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(b){er(i,o,b)}else m.current=null}function Kp(i,o,m){try{m()}catch(b){er(i,o,b)}}var fy=!1;function jC(i,o){if(op=ed,i=Hf(),ep(i)){if("selectionStart"in i)var m={start:i.selectionStart,end:i.selectionEnd};else e:{m=(m=i.ownerDocument)&&m.defaultView||window;var b=m.getSelection&&m.getSelection();if(b&&b.rangeCount!==0){m=b.anchorNode;var E=b.anchorOffset,O=b.focusNode;b=b.focusOffset;try{m.nodeType,O.nodeType}catch{m=null;break e}var H=0,we=-1,Ae=-1,Ye=0,ft=0,bt=i,xt=null;t:for(;;){for(var Gt;bt!==m||E!==0&&bt.nodeType!==3||(we=H+E),bt!==O||b!==0&&bt.nodeType!==3||(Ae=H+b),bt.nodeType===3&&(H+=bt.nodeValue.length),(Gt=bt.firstChild)!==null;)xt=bt,bt=Gt;for(;;){if(bt===i)break t;if(xt===m&&++Ye===E&&(we=H),xt===O&&++ft===b&&(Ae=H),(Gt=bt.nextSibling)!==null)break;bt=xt,xt=bt.parentNode}bt=Gt}m=we===-1||Ae===-1?null:{start:we,end:Ae}}else m=null}m=m||{start:0,end:0}}else m=null;for(cp={focusedElem:i,selectionRange:m},ed=!1,Jt=o;Jt!==null;)if(o=Jt,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,Jt=i;else for(;Jt!==null;){o=Jt;try{var es=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(es!==null){var ns=es.memoizedProps,dr=es.memoizedState,ze=o.stateNode,Oe=ze.getSnapshotBeforeUpdate(o.elementType===o.type?ns:$n(o.type,ns),dr);ze.__reactInternalSnapshotBeforeUpdate=Oe}break;case 3:var Qe=o.stateNode.containerInfo;Qe.nodeType===1?Qe.textContent="":Qe.nodeType===9&&Qe.documentElement&&Qe.removeChild(Qe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Pt){er(o,o.return,Pt)}if(i=o.sibling,i!==null){i.return=o.return,Jt=i;break}Jt=o.return}return es=fy,fy=!1,es}function Wo(i,o,m){var b=o.updateQueue;if(b=b!==null?b.lastEffect:null,b!==null){var E=b=b.next;do{if((E.tag&i)===i){var O=E.destroy;E.destroy=void 0,O!==void 0&&Kp(o,m,O)}E=E.next}while(E!==b)}}function Ld(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var m=o=o.next;do{if((m.tag&i)===i){var b=m.create;m.destroy=b()}m=m.next}while(m!==o)}}function Xp(i){var o=i.ref;if(o!==null){var m=i.stateNode;switch(i.tag){case 5:i=m;break;default:i=m}typeof o=="function"?o(i):o.current=i}}function gy(i){var o=i.alternate;o!==null&&(i.alternate=null,gy(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[oa],delete o[Lo],delete o[pp],delete o[aC],delete o[iC])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function yy(i){return i.tag===5||i.tag===3||i.tag===4}function vy(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||yy(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Jp(i,o,m){var b=i.tag;if(b===5||b===6)i=i.stateNode,o?m.nodeType===8?m.parentNode.insertBefore(i,o):m.insertBefore(i,o):(m.nodeType===8?(o=m.parentNode,o.insertBefore(i,m)):(o=m,o.appendChild(i)),m=m._reactRootContainer,m!=null||o.onclick!==null||(o.onclick=md));else if(b!==4&&(i=i.child,i!==null))for(Jp(i,o,m),i=i.sibling;i!==null;)Jp(i,o,m),i=i.sibling}function Zp(i,o,m){var b=i.tag;if(b===5||b===6)i=i.stateNode,o?m.insertBefore(i,o):m.appendChild(i);else if(b!==4&&(i=i.child,i!==null))for(Zp(i,o,m),i=i.sibling;i!==null;)Zp(i,o,m),i=i.sibling}var Tr=null,Qn=!1;function li(i,o,m){for(m=m.child;m!==null;)by(i,o,m),m=m.sibling}function by(i,o,m){if(R&&typeof R.onCommitFiberUnmount=="function")try{R.onCommitFiberUnmount(P,m)}catch{}switch(m.tag){case 5:Qr||Tl(m,o);case 6:var b=Tr,E=Qn;Tr=null,li(i,o,m),Tr=b,Qn=E,Tr!==null&&(Qn?(i=Tr,m=m.stateNode,i.nodeType===8?i.parentNode.removeChild(m):i.removeChild(m)):Tr.removeChild(m.stateNode));break;case 18:Tr!==null&&(Qn?(i=Tr,m=m.stateNode,i.nodeType===8?mp(i.parentNode,m):i.nodeType===1&&mp(i,m),So(i)):mp(Tr,m.stateNode));break;case 4:b=Tr,E=Qn,Tr=m.stateNode.containerInfo,Qn=!0,li(i,o,m),Tr=b,Qn=E;break;case 0:case 11:case 14:case 15:if(!Qr&&(b=m.updateQueue,b!==null&&(b=b.lastEffect,b!==null))){E=b=b.next;do{var O=E,H=O.destroy;O=O.tag,H!==void 0&&((O&2)!==0||(O&4)!==0)&&Kp(m,o,H),E=E.next}while(E!==b)}li(i,o,m);break;case 1:if(!Qr&&(Tl(m,o),b=m.stateNode,typeof b.componentWillUnmount=="function"))try{b.props=m.memoizedProps,b.state=m.memoizedState,b.componentWillUnmount()}catch(we){er(m,o,we)}li(i,o,m);break;case 21:li(i,o,m);break;case 22:m.mode&1?(Qr=(b=Qr)||m.memoizedState!==null,li(i,o,m),Qr=b):li(i,o,m);break;default:li(i,o,m)}}function wy(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var m=i.stateNode;m===null&&(m=i.stateNode=new NC),o.forEach(function(b){var E=OC.bind(null,i,b);m.has(b)||(m.add(b),b.then(E,E))})}}function Un(i,o){var m=o.deletions;if(m!==null)for(var b=0;b<m.length;b++){var E=m[b];try{var O=i,H=o,we=H;e:for(;we!==null;){switch(we.tag){case 5:Tr=we.stateNode,Qn=!1;break e;case 3:Tr=we.stateNode.containerInfo,Qn=!0;break e;case 4:Tr=we.stateNode.containerInfo,Qn=!0;break e}we=we.return}if(Tr===null)throw Error(r(160));by(O,H,E),Tr=null,Qn=!1;var Ae=E.alternate;Ae!==null&&(Ae.return=null),E.return=null}catch(Ye){er(E,o,Ye)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Ny(o,i),o=o.sibling}function Ny(i,o){var m=i.alternate,b=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Un(o,i),ua(i),b&4){try{Wo(3,i,i.return),Ld(3,i)}catch(ns){er(i,i.return,ns)}try{Wo(5,i,i.return)}catch(ns){er(i,i.return,ns)}}break;case 1:Un(o,i),ua(i),b&512&&m!==null&&Tl(m,m.return);break;case 5:if(Un(o,i),ua(i),b&512&&m!==null&&Tl(m,m.return),i.flags&32){var E=i.stateNode;try{ct(E,"")}catch(ns){er(i,i.return,ns)}}if(b&4&&(E=i.stateNode,E!=null)){var O=i.memoizedProps,H=m!==null?m.memoizedProps:O,we=i.type,Ae=i.updateQueue;if(i.updateQueue=null,Ae!==null)try{we==="input"&&O.type==="radio"&&O.name!=null&&qe(E,O),wt(we,H);var Ye=wt(we,O);for(H=0;H<Ae.length;H+=2){var ft=Ae[H],bt=Ae[H+1];ft==="style"?nt(E,bt):ft==="dangerouslySetInnerHTML"?jt(E,bt):ft==="children"?ct(E,bt):B(E,ft,bt,Ye)}switch(we){case"input":Me(E,O);break;case"textarea":lt(E,O);break;case"select":var xt=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!O.multiple;var Gt=O.value;Gt!=null?pt(E,!!O.multiple,Gt,!1):xt!==!!O.multiple&&(O.defaultValue!=null?pt(E,!!O.multiple,O.defaultValue,!0):pt(E,!!O.multiple,O.multiple?[]:"",!1))}E[Lo]=O}catch(ns){er(i,i.return,ns)}}break;case 6:if(Un(o,i),ua(i),b&4){if(i.stateNode===null)throw Error(r(162));E=i.stateNode,O=i.memoizedProps;try{E.nodeValue=O}catch(ns){er(i,i.return,ns)}}break;case 3:if(Un(o,i),ua(i),b&4&&m!==null&&m.memoizedState.isDehydrated)try{So(o.containerInfo)}catch(ns){er(i,i.return,ns)}break;case 4:Un(o,i),ua(i);break;case 13:Un(o,i),ua(i),E=i.child,E.flags&8192&&(O=E.memoizedState!==null,E.stateNode.isHidden=O,!O||E.alternate!==null&&E.alternate.memoizedState!==null||(s0=T())),b&4&&wy(i);break;case 22:if(ft=m!==null&&m.memoizedState!==null,i.mode&1?(Qr=(Ye=Qr)||ft,Un(o,i),Qr=Ye):Un(o,i),ua(i),b&8192){if(Ye=i.memoizedState!==null,(i.stateNode.isHidden=Ye)&&!ft&&(i.mode&1)!==0)for(Jt=i,ft=i.child;ft!==null;){for(bt=Jt=ft;Jt!==null;){switch(xt=Jt,Gt=xt.child,xt.tag){case 0:case 11:case 14:case 15:Wo(4,xt,xt.return);break;case 1:Tl(xt,xt.return);var es=xt.stateNode;if(typeof es.componentWillUnmount=="function"){b=xt,m=xt.return;try{o=b,es.props=o.memoizedProps,es.state=o.memoizedState,es.componentWillUnmount()}catch(ns){er(b,m,ns)}}break;case 5:Tl(xt,xt.return);break;case 22:if(xt.memoizedState!==null){ky(bt);continue}}Gt!==null?(Gt.return=xt,Jt=Gt):ky(bt)}ft=ft.sibling}e:for(ft=null,bt=i;;){if(bt.tag===5){if(ft===null){ft=bt;try{E=bt.stateNode,Ye?(O=E.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none"):(we=bt.stateNode,Ae=bt.memoizedProps.style,H=Ae!=null&&Ae.hasOwnProperty("display")?Ae.display:null,we.style.display=Ze("display",H))}catch(ns){er(i,i.return,ns)}}}else if(bt.tag===6){if(ft===null)try{bt.stateNode.nodeValue=Ye?"":bt.memoizedProps}catch(ns){er(i,i.return,ns)}}else if((bt.tag!==22&&bt.tag!==23||bt.memoizedState===null||bt===i)&&bt.child!==null){bt.child.return=bt,bt=bt.child;continue}if(bt===i)break e;for(;bt.sibling===null;){if(bt.return===null||bt.return===i)break e;ft===bt&&(ft=null),bt=bt.return}ft===bt&&(ft=null),bt.sibling.return=bt.return,bt=bt.sibling}}break;case 19:Un(o,i),ua(i),b&4&&wy(i);break;case 21:break;default:Un(o,i),ua(i)}}function ua(i){var o=i.flags;if(o&2){try{e:{for(var m=i.return;m!==null;){if(yy(m)){var b=m;break e}m=m.return}throw Error(r(160))}switch(b.tag){case 5:var E=b.stateNode;b.flags&32&&(ct(E,""),b.flags&=-33);var O=vy(i);Zp(i,O,E);break;case 3:case 4:var H=b.stateNode.containerInfo,we=vy(i);Jp(i,we,H);break;default:throw Error(r(161))}}catch(Ae){er(i,i.return,Ae)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function SC(i,o,m){Jt=i,jy(i)}function jy(i,o,m){for(var b=(i.mode&1)!==0;Jt!==null;){var E=Jt,O=E.child;if(E.tag===22&&b){var H=E.memoizedState!==null||Dd;if(!H){var we=E.alternate,Ae=we!==null&&we.memoizedState!==null||Qr;we=Dd;var Ye=Qr;if(Dd=H,(Qr=Ae)&&!Ye)for(Jt=E;Jt!==null;)H=Jt,Ae=H.child,H.tag===22&&H.memoizedState!==null?Cy(E):Ae!==null?(Ae.return=H,Jt=Ae):Cy(E);for(;O!==null;)Jt=O,jy(O),O=O.sibling;Jt=E,Dd=we,Qr=Ye}Sy(i)}else(E.subtreeFlags&8772)!==0&&O!==null?(O.return=E,Jt=O):Sy(i)}}function Sy(i){for(;Jt!==null;){var o=Jt;if((o.flags&8772)!==0){var m=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Qr||Ld(5,o);break;case 1:var b=o.stateNode;if(o.flags&4&&!Qr)if(m===null)b.componentDidMount();else{var E=o.elementType===o.type?m.memoizedProps:$n(o.type,m.memoizedProps);b.componentDidUpdate(E,m.memoizedState,b.__reactInternalSnapshotBeforeUpdate)}var O=o.updateQueue;O!==null&&kg(o,O,b);break;case 3:var H=o.updateQueue;if(H!==null){if(m=null,o.child!==null)switch(o.child.tag){case 5:m=o.child.stateNode;break;case 1:m=o.child.stateNode}kg(o,H,m)}break;case 5:var we=o.stateNode;if(m===null&&o.flags&4){m=we;var Ae=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":Ae.autoFocus&&m.focus();break;case"img":Ae.src&&(m.src=Ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Ye=o.alternate;if(Ye!==null){var ft=Ye.memoizedState;if(ft!==null){var bt=ft.dehydrated;bt!==null&&So(bt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Qr||o.flags&512&&Xp(o)}catch(xt){er(o,o.return,xt)}}if(o===i){Jt=null;break}if(m=o.sibling,m!==null){m.return=o.return,Jt=m;break}Jt=o.return}}function ky(i){for(;Jt!==null;){var o=Jt;if(o===i){Jt=null;break}var m=o.sibling;if(m!==null){m.return=o.return,Jt=m;break}Jt=o.return}}function Cy(i){for(;Jt!==null;){var o=Jt;try{switch(o.tag){case 0:case 11:case 15:var m=o.return;try{Ld(4,o)}catch(Ae){er(o,m,Ae)}break;case 1:var b=o.stateNode;if(typeof b.componentDidMount=="function"){var E=o.return;try{b.componentDidMount()}catch(Ae){er(o,E,Ae)}}var O=o.return;try{Xp(o)}catch(Ae){er(o,O,Ae)}break;case 5:var H=o.return;try{Xp(o)}catch(Ae){er(o,H,Ae)}}}catch(Ae){er(o,o.return,Ae)}if(o===i){Jt=null;break}var we=o.sibling;if(we!==null){we.return=o.return,Jt=we;break}Jt=o.return}}var kC=Math.ceil,Fd=q.ReactCurrentDispatcher,e0=q.ReactCurrentOwner,Dn=q.ReactCurrentBatchConfig,Ss=0,Cr=null,xr=null,Or=0,bn=0,Ol=si(0),wr=0,Go=null,Ii=0,Md=0,t0=0,Ho=null,an=null,s0=0,Rl=1/0,Da=null,Id=!1,r0=null,oi=null,qd=!1,ci=null,Bd=0,Yo=0,n0=null,zd=-1,$d=0;function Kr(){return(Ss&6)!==0?T():zd!==-1?zd:zd=T()}function di(i){return(i.mode&1)===0?1:(Ss&2)!==0&&Or!==0?Or&-Or:oC.transition!==null?($d===0&&($d=Hr()),$d):(i=Os,i!==0||(i=window.event,i=i===void 0?16:Ef(i.type)),i)}function Vn(i,o,m,b){if(50<Yo)throw Yo=0,n0=null,Error(r(185));vo(i,m,b),((Ss&2)===0||i!==Cr)&&(i===Cr&&((Ss&2)===0&&(Md|=m),wr===4&&ui(i,Or)),ln(i,b),m===1&&Ss===0&&(o.mode&1)===0&&(Rl=T()+500,fd&&ni()))}function ln(i,o){var m=i.callbackNode;Wt(i,o);var b=at(i,i===Cr?Or:0);if(b===0)m!==null&&We(m),i.callbackNode=null,i.callbackPriority=0;else if(o=b&-b,i.callbackPriority!==o){if(m!=null&&We(m),o===1)i.tag===0?lC(Ey.bind(null,i)):pg(Ey.bind(null,i)),rC(function(){(Ss&6)===0&&ni()}),m=null;else{switch(bf(b)){case 1:m=A;break;case 4:m=g;break;case 16:m=p;break;case 536870912:m=N;break;default:m=p}m=Fy(m,_y.bind(null,i))}i.callbackPriority=o,i.callbackNode=m}}function _y(i,o){if(zd=-1,$d=0,(Ss&6)!==0)throw Error(r(327));var m=i.callbackNode;if(Dl()&&i.callbackNode!==m)return null;var b=at(i,i===Cr?Or:0);if(b===0)return null;if((b&30)!==0||(b&i.expiredLanes)!==0||o)o=Qd(i,b);else{o=b;var E=Ss;Ss|=2;var O=Ay();(Cr!==i||Or!==o)&&(Da=null,Rl=T()+500,Bi(i,o));do try{EC();break}catch(we){Py(i,we)}while(!0);Np(),Fd.current=O,Ss=E,xr!==null?o=0:(Cr=null,Or=0,o=wr)}if(o!==0){if(o===2&&(E=vt(i),E!==0&&(b=E,o=a0(i,E))),o===1)throw m=Go,Bi(i,0),ui(i,b),ln(i,T()),m;if(o===6)ui(i,b);else{if(E=i.current.alternate,(b&30)===0&&!CC(E)&&(o=Qd(i,b),o===2&&(O=vt(i),O!==0&&(b=O,o=a0(i,O))),o===1))throw m=Go,Bi(i,0),ui(i,b),ln(i,T()),m;switch(i.finishedWork=E,i.finishedLanes=b,o){case 0:case 1:throw Error(r(345));case 2:zi(i,an,Da);break;case 3:if(ui(i,b),(b&130023424)===b&&(o=s0+500-T(),10<o)){if(at(i,0)!==0)break;if(E=i.suspendedLanes,(E&b)!==b){Kr(),i.pingedLanes|=i.suspendedLanes&E;break}i.timeoutHandle=up(zi.bind(null,i,an,Da),o);break}zi(i,an,Da);break;case 4:if(ui(i,b),(b&4194240)===b)break;for(o=i.eventTimes,E=-1;0<b;){var H=31-Ne(b);O=1<<H,H=o[H],H>E&&(E=H),b&=~O}if(b=E,b=T()-b,b=(120>b?120:480>b?480:1080>b?1080:1920>b?1920:3e3>b?3e3:4320>b?4320:1960*kC(b/1960))-b,10<b){i.timeoutHandle=up(zi.bind(null,i,an,Da),b);break}zi(i,an,Da);break;case 5:zi(i,an,Da);break;default:throw Error(r(329))}}}return ln(i,T()),i.callbackNode===m?_y.bind(null,i):null}function a0(i,o){var m=Ho;return i.current.memoizedState.isDehydrated&&(Bi(i,o).flags|=256),i=Qd(i,o),i!==2&&(o=an,an=m,o!==null&&i0(o)),i}function i0(i){an===null?an=i:an.push.apply(an,i)}function CC(i){for(var o=i;;){if(o.flags&16384){var m=o.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var b=0;b<m.length;b++){var E=m[b],O=E.getSnapshot;E=E.value;try{if(!Bn(O(),E))return!1}catch{return!1}}}if(m=o.child,o.subtreeFlags&16384&&m!==null)m.return=o,o=m;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ui(i,o){for(o&=~t0,o&=~Md,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var m=31-Ne(o),b=1<<m;i[m]=-1,o&=~b}}function Ey(i){if((Ss&6)!==0)throw Error(r(327));Dl();var o=at(i,0);if((o&1)===0)return ln(i,T()),null;var m=Qd(i,o);if(i.tag!==0&&m===2){var b=vt(i);b!==0&&(o=b,m=a0(i,b))}if(m===1)throw m=Go,Bi(i,0),ui(i,o),ln(i,T()),m;if(m===6)throw Error(r(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,zi(i,an,Da),ln(i,T()),null}function l0(i,o){var m=Ss;Ss|=1;try{return i(o)}finally{Ss=m,Ss===0&&(Rl=T()+500,fd&&ni())}}function qi(i){ci!==null&&ci.tag===0&&(Ss&6)===0&&Dl();var o=Ss;Ss|=1;var m=Dn.transition,b=Os;try{if(Dn.transition=null,Os=1,i)return i()}finally{Os=b,Dn.transition=m,Ss=o,(Ss&6)===0&&ni()}}function o0(){bn=Ol.current,Us(Ol)}function Bi(i,o){i.finishedWork=null,i.finishedLanes=0;var m=i.timeoutHandle;if(m!==-1&&(i.timeoutHandle=-1,sC(m)),xr!==null)for(m=xr.return;m!==null;){var b=m;switch(gp(b),b.tag){case 1:b=b.type.childContextTypes,b!=null&&xd();break;case 3:Pl(),Us(sn),Us(Br),Ap();break;case 5:Ep(b);break;case 4:Pl();break;case 13:Us(Ks);break;case 19:Us(Ks);break;case 10:jp(b.type._context);break;case 22:case 23:o0()}m=m.return}if(Cr=i,xr=i=mi(i.current,null),Or=bn=o,wr=0,Go=null,t0=Md=Ii=0,an=Ho=null,Li!==null){for(o=0;o<Li.length;o++)if(m=Li[o],b=m.interleaved,b!==null){m.interleaved=null;var E=b.next,O=m.pending;if(O!==null){var H=O.next;O.next=E,b.next=H}m.pending=b}Li=null}return i}function Py(i,o){do{var m=xr;try{if(Np(),Cd.current=Ad,_d){for(var b=Xs.memoizedState;b!==null;){var E=b.queue;E!==null&&(E.pending=null),b=b.next}_d=!1}if(Mi=0,kr=br=Xs=null,zo=!1,$o=0,e0.current=null,m===null||m.return===null){wr=1,Go=o,xr=null;break}e:{var O=i,H=m.return,we=m,Ae=o;if(o=Or,we.flags|=32768,Ae!==null&&typeof Ae=="object"&&typeof Ae.then=="function"){var Ye=Ae,ft=we,bt=ft.tag;if((ft.mode&1)===0&&(bt===0||bt===11||bt===15)){var xt=ft.alternate;xt?(ft.updateQueue=xt.updateQueue,ft.memoizedState=xt.memoizedState,ft.lanes=xt.lanes):(ft.updateQueue=null,ft.memoizedState=null)}var Gt=ey(H);if(Gt!==null){Gt.flags&=-257,ty(Gt,H,we,O,o),Gt.mode&1&&Zg(O,Ye,o),o=Gt,Ae=Ye;var es=o.updateQueue;if(es===null){var ns=new Set;ns.add(Ae),o.updateQueue=ns}else es.add(Ae);break e}else{if((o&1)===0){Zg(O,Ye,o),c0();break e}Ae=Error(r(426))}}else if(Gs&&we.mode&1){var dr=ey(H);if(dr!==null){(dr.flags&65536)===0&&(dr.flags|=256),ty(dr,H,we,O,o),bp(Al(Ae,we));break e}}O=Ae=Al(Ae,we),wr!==4&&(wr=2),Ho===null?Ho=[O]:Ho.push(O),O=H;do{switch(O.tag){case 3:O.flags|=65536,o&=-o,O.lanes|=o;var ze=Xg(O,Ae,o);Sg(O,ze);break e;case 1:we=Ae;var Oe=O.type,Qe=O.stateNode;if((O.flags&128)===0&&(typeof Oe.getDerivedStateFromError=="function"||Qe!==null&&typeof Qe.componentDidCatch=="function"&&(oi===null||!oi.has(Qe)))){O.flags|=65536,o&=-o,O.lanes|=o;var Pt=Jg(O,we,o);Sg(O,Pt);break e}}O=O.return}while(O!==null)}Oy(m)}catch(is){o=is,xr===m&&m!==null&&(xr=m=m.return);continue}break}while(!0)}function Ay(){var i=Fd.current;return Fd.current=Ad,i===null?Ad:i}function c0(){(wr===0||wr===3||wr===2)&&(wr=4),Cr===null||(Ii&268435455)===0&&(Md&268435455)===0||ui(Cr,Or)}function Qd(i,o){var m=Ss;Ss|=2;var b=Ay();(Cr!==i||Or!==o)&&(Da=null,Bi(i,o));do try{_C();break}catch(E){Py(i,E)}while(!0);if(Np(),Ss=m,Fd.current=b,xr!==null)throw Error(r(261));return Cr=null,Or=0,wr}function _C(){for(;xr!==null;)Ty(xr)}function EC(){for(;xr!==null&&!ge();)Ty(xr)}function Ty(i){var o=Ly(i.alternate,i,bn);i.memoizedProps=i.pendingProps,o===null?Oy(i):xr=o,e0.current=null}function Oy(i){var o=i;do{var m=o.alternate;if(i=o.return,(o.flags&32768)===0){if(m=bC(m,o,bn),m!==null){xr=m;return}}else{if(m=wC(m,o),m!==null){m.flags&=32767,xr=m;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{wr=6,xr=null;return}}if(o=o.sibling,o!==null){xr=o;return}xr=o=i}while(o!==null);wr===0&&(wr=5)}function zi(i,o,m){var b=Os,E=Dn.transition;try{Dn.transition=null,Os=1,PC(i,o,m,b)}finally{Dn.transition=E,Os=b}return null}function PC(i,o,m,b){do Dl();while(ci!==null);if((Ss&6)!==0)throw Error(r(327));m=i.finishedWork;var E=i.finishedLanes;if(m===null)return null;if(i.finishedWork=null,i.finishedLanes=0,m===i.current)throw Error(r(177));i.callbackNode=null,i.callbackPriority=0;var O=m.lanes|m.childLanes;if(ck(i,O),i===Cr&&(xr=Cr=null,Or=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||qd||(qd=!0,Fy(p,function(){return Dl(),null})),O=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||O){O=Dn.transition,Dn.transition=null;var H=Os;Os=1;var we=Ss;Ss|=4,e0.current=null,jC(i,m),Ny(m,i),Yk(cp),ed=!!op,cp=op=null,i.current=m,SC(m),G(),Ss=we,Os=H,Dn.transition=O}else i.current=m;if(qd&&(qd=!1,ci=i,Bd=E),O=i.pendingLanes,O===0&&(oi=null),L(m.stateNode),ln(i,T()),o!==null)for(b=i.onRecoverableError,m=0;m<o.length;m++)E=o[m],b(E.value,{componentStack:E.stack,digest:E.digest});if(Id)throw Id=!1,i=r0,r0=null,i;return(Bd&1)!==0&&i.tag!==0&&Dl(),O=i.pendingLanes,(O&1)!==0?i===n0?Yo++:(Yo=0,n0=i):Yo=0,ni(),null}function Dl(){if(ci!==null){var i=bf(Bd),o=Dn.transition,m=Os;try{if(Dn.transition=null,Os=16>i?16:i,ci===null)var b=!1;else{if(i=ci,ci=null,Bd=0,(Ss&6)!==0)throw Error(r(331));var E=Ss;for(Ss|=4,Jt=i.current;Jt!==null;){var O=Jt,H=O.child;if((Jt.flags&16)!==0){var we=O.deletions;if(we!==null){for(var Ae=0;Ae<we.length;Ae++){var Ye=we[Ae];for(Jt=Ye;Jt!==null;){var ft=Jt;switch(ft.tag){case 0:case 11:case 15:Wo(8,ft,O)}var bt=ft.child;if(bt!==null)bt.return=ft,Jt=bt;else for(;Jt!==null;){ft=Jt;var xt=ft.sibling,Gt=ft.return;if(gy(ft),ft===Ye){Jt=null;break}if(xt!==null){xt.return=Gt,Jt=xt;break}Jt=Gt}}}var es=O.alternate;if(es!==null){var ns=es.child;if(ns!==null){es.child=null;do{var dr=ns.sibling;ns.sibling=null,ns=dr}while(ns!==null)}}Jt=O}}if((O.subtreeFlags&2064)!==0&&H!==null)H.return=O,Jt=H;else e:for(;Jt!==null;){if(O=Jt,(O.flags&2048)!==0)switch(O.tag){case 0:case 11:case 15:Wo(9,O,O.return)}var ze=O.sibling;if(ze!==null){ze.return=O.return,Jt=ze;break e}Jt=O.return}}var Oe=i.current;for(Jt=Oe;Jt!==null;){H=Jt;var Qe=H.child;if((H.subtreeFlags&2064)!==0&&Qe!==null)Qe.return=H,Jt=Qe;else e:for(H=Oe;Jt!==null;){if(we=Jt,(we.flags&2048)!==0)try{switch(we.tag){case 0:case 11:case 15:Ld(9,we)}}catch(is){er(we,we.return,is)}if(we===H){Jt=null;break e}var Pt=we.sibling;if(Pt!==null){Pt.return=we.return,Jt=Pt;break e}Jt=we.return}}if(Ss=E,ni(),R&&typeof R.onPostCommitFiberRoot=="function")try{R.onPostCommitFiberRoot(P,i)}catch{}b=!0}return b}finally{Os=m,Dn.transition=o}}return!1}function Ry(i,o,m){o=Al(m,o),o=Xg(i,o,1),i=ii(i,o,1),o=Kr(),i!==null&&(vo(i,1,o),ln(i,o))}function er(i,o,m){if(i.tag===3)Ry(i,i,m);else for(;o!==null;){if(o.tag===3){Ry(o,i,m);break}else if(o.tag===1){var b=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(oi===null||!oi.has(b))){i=Al(m,i),i=Jg(o,i,1),o=ii(o,i,1),i=Kr(),o!==null&&(vo(o,1,i),ln(o,i));break}}o=o.return}}function AC(i,o,m){var b=i.pingCache;b!==null&&b.delete(o),o=Kr(),i.pingedLanes|=i.suspendedLanes&m,Cr===i&&(Or&m)===m&&(wr===4||wr===3&&(Or&130023424)===Or&&500>T()-s0?Bi(i,0):t0|=m),ln(i,o)}function Dy(i,o){o===0&&((i.mode&1)===0?o=1:(o=te,te<<=1,(te&130023424)===0&&(te=4194304)));var m=Kr();i=Ta(i,o),i!==null&&(vo(i,o,m),ln(i,m))}function TC(i){var o=i.memoizedState,m=0;o!==null&&(m=o.retryLane),Dy(i,m)}function OC(i,o){var m=0;switch(i.tag){case 13:var b=i.stateNode,E=i.memoizedState;E!==null&&(m=E.retryLane);break;case 19:b=i.stateNode;break;default:throw Error(r(314))}b!==null&&b.delete(o),Dy(i,m)}var Ly;Ly=function(i,o,m){if(i!==null)if(i.memoizedProps!==o.pendingProps||sn.current)nn=!0;else{if((i.lanes&m)===0&&(o.flags&128)===0)return nn=!1,vC(i,o,m);nn=(i.flags&131072)!==0}else nn=!1,Gs&&(o.flags&1048576)!==0&&xg(o,yd,o.index);switch(o.lanes=0,o.tag){case 2:var b=o.type;Rd(i,o),i=o.pendingProps;var E=Nl(o,Br.current);El(o,m),E=Rp(null,o,b,i,E,m);var O=Dp();return o.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,rn(b)?(O=!0,hd(o)):O=!1,o.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,Cp(o),E.updater=Td,o.stateNode=E,E._reactInternals=o,Bp(o,b,i,m),o=Up(null,o,b,!0,O,m)):(o.tag=0,Gs&&O&&fp(o),Yr(null,o,E,m),o=o.child),o;case 16:b=o.elementType;e:{switch(Rd(i,o),i=o.pendingProps,E=b._init,b=E(b._payload),o.type=b,E=o.tag=DC(b),i=$n(b,i),E){case 0:o=Qp(null,o,b,i,m);break e;case 1:o=ly(null,o,b,i,m);break e;case 11:o=sy(null,o,b,i,m);break e;case 14:o=ry(null,o,b,$n(b.type,i),m);break e}throw Error(r(306,b,""))}return o;case 0:return b=o.type,E=o.pendingProps,E=o.elementType===b?E:$n(b,E),Qp(i,o,b,E,m);case 1:return b=o.type,E=o.pendingProps,E=o.elementType===b?E:$n(b,E),ly(i,o,b,E,m);case 3:e:{if(oy(o),i===null)throw Error(r(387));b=o.pendingProps,O=o.memoizedState,E=O.element,jg(i,o),Sd(o,b,null,m);var H=o.memoizedState;if(b=H.element,O.isDehydrated)if(O={element:b,isDehydrated:!1,cache:H.cache,pendingSuspenseBoundaries:H.pendingSuspenseBoundaries,transitions:H.transitions},o.updateQueue.baseState=O,o.memoizedState=O,o.flags&256){E=Al(Error(r(423)),o),o=cy(i,o,b,m,E);break e}else if(b!==E){E=Al(Error(r(424)),o),o=cy(i,o,b,m,E);break e}else for(vn=ti(o.stateNode.containerInfo.firstChild),yn=o,Gs=!0,zn=null,m=wg(o,null,b,m),o.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(kl(),b===E){o=Ra(i,o,m);break e}Yr(i,o,b,m)}o=o.child}return o;case 5:return Cg(o),i===null&&vp(o),b=o.type,E=o.pendingProps,O=i!==null?i.memoizedProps:null,H=E.children,dp(b,E)?H=null:O!==null&&dp(b,O)&&(o.flags|=32),iy(i,o),Yr(i,o,H,m),o.child;case 6:return i===null&&vp(o),null;case 13:return dy(i,o,m);case 4:return _p(o,o.stateNode.containerInfo),b=o.pendingProps,i===null?o.child=Cl(o,null,b,m):Yr(i,o,b,m),o.child;case 11:return b=o.type,E=o.pendingProps,E=o.elementType===b?E:$n(b,E),sy(i,o,b,E,m);case 7:return Yr(i,o,o.pendingProps,m),o.child;case 8:return Yr(i,o,o.pendingProps.children,m),o.child;case 12:return Yr(i,o,o.pendingProps.children,m),o.child;case 10:e:{if(b=o.type._context,E=o.pendingProps,O=o.memoizedProps,H=E.value,Bs(wd,b._currentValue),b._currentValue=H,O!==null)if(Bn(O.value,H)){if(O.children===E.children&&!sn.current){o=Ra(i,o,m);break e}}else for(O=o.child,O!==null&&(O.return=o);O!==null;){var we=O.dependencies;if(we!==null){H=O.child;for(var Ae=we.firstContext;Ae!==null;){if(Ae.context===b){if(O.tag===1){Ae=Oa(-1,m&-m),Ae.tag=2;var Ye=O.updateQueue;if(Ye!==null){Ye=Ye.shared;var ft=Ye.pending;ft===null?Ae.next=Ae:(Ae.next=ft.next,ft.next=Ae),Ye.pending=Ae}}O.lanes|=m,Ae=O.alternate,Ae!==null&&(Ae.lanes|=m),Sp(O.return,m,o),we.lanes|=m;break}Ae=Ae.next}}else if(O.tag===10)H=O.type===o.type?null:O.child;else if(O.tag===18){if(H=O.return,H===null)throw Error(r(341));H.lanes|=m,we=H.alternate,we!==null&&(we.lanes|=m),Sp(H,m,o),H=O.sibling}else H=O.child;if(H!==null)H.return=O;else for(H=O;H!==null;){if(H===o){H=null;break}if(O=H.sibling,O!==null){O.return=H.return,H=O;break}H=H.return}O=H}Yr(i,o,E.children,m),o=o.child}return o;case 9:return E=o.type,b=o.pendingProps.children,El(o,m),E=On(E),b=b(E),o.flags|=1,Yr(i,o,b,m),o.child;case 14:return b=o.type,E=$n(b,o.pendingProps),E=$n(b.type,E),ry(i,o,b,E,m);case 15:return ny(i,o,o.type,o.pendingProps,m);case 17:return b=o.type,E=o.pendingProps,E=o.elementType===b?E:$n(b,E),Rd(i,o),o.tag=1,rn(b)?(i=!0,hd(o)):i=!1,El(o,m),Yg(o,b,E),Bp(o,b,E,m),Up(null,o,b,!0,i,m);case 19:return my(i,o,m);case 22:return ay(i,o,m)}throw Error(r(156,o.tag))};function Fy(i,o){return Fe(i,o)}function RC(i,o,m,b){this.tag=i,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(i,o,m,b){return new RC(i,o,m,b)}function d0(i){return i=i.prototype,!(!i||!i.isReactComponent)}function DC(i){if(typeof i=="function")return d0(i)?1:0;if(i!=null){if(i=i.$$typeof,i===ue)return 11;if(i===Re)return 14}return 2}function mi(i,o){var m=i.alternate;return m===null?(m=Ln(i.tag,o,i.key,i.mode),m.elementType=i.elementType,m.type=i.type,m.stateNode=i.stateNode,m.alternate=i,i.alternate=m):(m.pendingProps=o,m.type=i.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=i.flags&14680064,m.childLanes=i.childLanes,m.lanes=i.lanes,m.child=i.child,m.memoizedProps=i.memoizedProps,m.memoizedState=i.memoizedState,m.updateQueue=i.updateQueue,o=i.dependencies,m.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},m.sibling=i.sibling,m.index=i.index,m.ref=i.ref,m}function Ud(i,o,m,b,E,O){var H=2;if(b=i,typeof i=="function")d0(i)&&(H=1);else if(typeof i=="string")H=5;else e:switch(i){case M:return $i(m.children,E,O,o);case W:H=8,E|=8;break;case oe:return i=Ln(12,m,o,E|2),i.elementType=oe,i.lanes=O,i;case _e:return i=Ln(13,m,o,E),i.elementType=_e,i.lanes=O,i;case ke:return i=Ln(19,m,o,E),i.elementType=ke,i.lanes=O,i;case ve:return Vd(m,E,O,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case X:H=10;break e;case he:H=9;break e;case ue:H=11;break e;case Re:H=14;break e;case Y:H=16,b=null;break e}throw Error(r(130,i==null?i:typeof i,""))}return o=Ln(H,m,o,E),o.elementType=i,o.type=b,o.lanes=O,o}function $i(i,o,m,b){return i=Ln(7,i,b,o),i.lanes=m,i}function Vd(i,o,m,b){return i=Ln(22,i,b,o),i.elementType=ve,i.lanes=m,i.stateNode={isHidden:!1},i}function u0(i,o,m){return i=Ln(6,i,null,o),i.lanes=m,i}function m0(i,o,m){return o=Ln(4,i.children!==null?i.children:[],i.key,o),o.lanes=m,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function LC(i,o,m,b,E){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yo(0),this.expirationTimes=yo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yo(0),this.identifierPrefix=b,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function p0(i,o,m,b,E,O,H,we,Ae){return i=new LC(i,o,m,we,Ae),o===1?(o=1,O===!0&&(o|=8)):o=0,O=Ln(3,null,null,o),i.current=O,O.stateNode=i,O.memoizedState={element:b,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cp(O),i}function FC(i,o,m){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:re,key:b==null?null:""+b,children:i,containerInfo:o,implementation:m}}function My(i){if(!i)return ri;i=i._reactInternals;e:{if(le(i)!==i||i.tag!==1)throw Error(r(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(rn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(r(171))}if(i.tag===1){var m=i.type;if(rn(m))return ug(i,m,o)}return o}function Iy(i,o,m,b,E,O,H,we,Ae){return i=p0(m,b,!0,i,E,O,H,we,Ae),i.context=My(null),m=i.current,b=Kr(),E=di(m),O=Oa(b,E),O.callback=o??null,ii(m,O,E),i.current.lanes=E,vo(i,E,b),ln(i,b),i}function Wd(i,o,m,b){var E=o.current,O=Kr(),H=di(E);return m=My(m),o.context===null?o.context=m:o.pendingContext=m,o=Oa(O,H),o.payload={element:i},b=b===void 0?null:b,b!==null&&(o.callback=b),i=ii(E,o,H),i!==null&&(Vn(i,E,H,O),jd(i,E,H)),H}function Gd(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function qy(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var m=i.retryLane;i.retryLane=m!==0&&m<o?m:o}}function x0(i,o){qy(i,o),(i=i.alternate)&&qy(i,o)}function MC(){return null}var By=typeof reportError=="function"?reportError:function(i){console.error(i)};function h0(i){this._internalRoot=i}Hd.prototype.render=h0.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(r(409));Wd(i,o,null,null)},Hd.prototype.unmount=h0.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;qi(function(){Wd(null,i,null,null)}),o[_a]=null}};function Hd(i){this._internalRoot=i}Hd.prototype.unstable_scheduleHydration=function(i){if(i){var o=jf();i={blockedOn:null,target:i,priority:o};for(var m=0;m<Ja.length&&o!==0&&o<Ja[m].priority;m++);Ja.splice(m,0,i),m===0&&Cf(i)}};function f0(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Yd(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function zy(){}function IC(i,o,m,b,E){if(E){if(typeof b=="function"){var O=b;b=function(){var Ye=Gd(H);O.call(Ye)}}var H=Iy(o,b,i,0,null,!1,!1,"",zy);return i._reactRootContainer=H,i[_a]=H.current,Ro(i.nodeType===8?i.parentNode:i),qi(),H}for(;E=i.lastChild;)i.removeChild(E);if(typeof b=="function"){var we=b;b=function(){var Ye=Gd(Ae);we.call(Ye)}}var Ae=p0(i,0,!1,null,null,!1,!1,"",zy);return i._reactRootContainer=Ae,i[_a]=Ae.current,Ro(i.nodeType===8?i.parentNode:i),qi(function(){Wd(o,Ae,m,b)}),Ae}function Kd(i,o,m,b,E){var O=m._reactRootContainer;if(O){var H=O;if(typeof E=="function"){var we=E;E=function(){var Ae=Gd(H);we.call(Ae)}}Wd(o,H,i,E)}else H=IC(m,o,i,E,b);return Gd(H)}wf=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var m=Se(o.pendingLanes);m!==0&&(Bm(o,m|1),ln(o,T()),(Ss&6)===0&&(Rl=T()+500,ni()))}break;case 13:qi(function(){var b=Ta(i,1);if(b!==null){var E=Kr();Vn(b,i,1,E)}}),x0(i,1)}},zm=function(i){if(i.tag===13){var o=Ta(i,134217728);if(o!==null){var m=Kr();Vn(o,i,134217728,m)}x0(i,134217728)}},Nf=function(i){if(i.tag===13){var o=di(i),m=Ta(i,o);if(m!==null){var b=Kr();Vn(m,i,o,b)}x0(i,o)}},jf=function(){return Os},Sf=function(i,o){var m=Os;try{return Os=i,o()}finally{Os=m}},Vt=function(i,o,m){switch(o){case"input":if(Me(i,m),o=m.name,m.type==="radio"&&o!=null){for(m=i;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<m.length;o++){var b=m[o];if(b!==i&&b.form===i.form){var E=pd(b);if(!E)throw Error(r(90));et(b),Me(b,E)}}}break;case"textarea":lt(i,m);break;case"select":o=m.value,o!=null&&pt(i,!!m.multiple,o,!1)}},Zt=l0,_t=qi;var qC={usingClientEntryPoint:!1,Events:[Fo,bl,pd,St,Ct,l0]},Ko={findFiberByHostInstance:Ti,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},BC={bundleType:Ko.bundleType,version:Ko.version,rendererPackageName:Ko.rendererPackageName,rendererConfig:Ko.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:q.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=je(i),i===null?null:i.stateNode},findFiberByHostInstance:Ko.findFiberByHostInstance||MC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xd.isDisabled&&Xd.supportsFiber)try{P=Xd.inject(BC),R=Xd}catch{}}return on.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qC,on.createPortal=function(i,o){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f0(o))throw Error(r(200));return FC(i,o,null,m)},on.createRoot=function(i,o){if(!f0(i))throw Error(r(299));var m=!1,b="",E=By;return o!=null&&(o.unstable_strictMode===!0&&(m=!0),o.identifierPrefix!==void 0&&(b=o.identifierPrefix),o.onRecoverableError!==void 0&&(E=o.onRecoverableError)),o=p0(i,1,!1,null,null,m,!1,b,E),i[_a]=o.current,Ro(i.nodeType===8?i.parentNode:i),new h0(o)},on.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=je(o),i=i===null?null:i.stateNode,i},on.flushSync=function(i){return qi(i)},on.hydrate=function(i,o,m){if(!Yd(o))throw Error(r(200));return Kd(null,i,o,!0,m)},on.hydrateRoot=function(i,o,m){if(!f0(i))throw Error(r(405));var b=m!=null&&m.hydratedSources||null,E=!1,O="",H=By;if(m!=null&&(m.unstable_strictMode===!0&&(E=!0),m.identifierPrefix!==void 0&&(O=m.identifierPrefix),m.onRecoverableError!==void 0&&(H=m.onRecoverableError)),o=Iy(o,null,i,1,m??null,E,!1,O,H),i[_a]=o.current,Ro(i),b)for(i=0;i<b.length;i++)m=b[i],E=m._getVersion,E=E(m._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[m,E]:o.mutableSourceEagerHydrationData.push(m,E);return new Hd(o)},on.render=function(i,o,m){if(!Yd(o))throw Error(r(200));return Kd(null,i,o,!1,m)},on.unmountComponentAtNode=function(i){if(!Yd(i))throw Error(r(40));return i._reactRootContainer?(qi(function(){Kd(null,null,i,!1,function(){i._reactRootContainer=null,i[_a]=null})}),!0):!1},on.unstable_batchedUpdates=l0,on.unstable_renderSubtreeIntoContainer=function(i,o,m,b){if(!Yd(m))throw Error(r(200));if(i==null||i._reactInternals===void 0)throw Error(r(38));return Kd(i,o,m,!1,b)},on.version="18.3.1-next-f1338f8080-20240426",on}var Yy;function i1(){if(Yy)return v0.exports;Yy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),v0.exports=HC(),v0.exports}var Ky;function YC(){if(Ky)return Zd;Ky=1;var t=i1();return Zd.createRoot=t.createRoot,Zd.hydrateRoot=t.hydrateRoot,Zd}var KC=YC(),d=am();const gi=a1(d),Ox=$C({__proto__:null,default:gi},[d]);/**
 * react-router v7.9.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Xy="popstate";function XC(t={}){function s(n,a){let{pathname:l,search:c,hash:u}=n.location;return ax("",{pathname:l,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:pc(a)}return ZC(s,r,null,t)}function Hs(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function Jn(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function JC(){return Math.random().toString(36).substring(2,10)}function Jy(t,s){return{usr:t.state,key:t.key,idx:s}}function ax(t,s,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof s=="string"?so(s):s,state:r,key:s&&s.key||n||JC()}}function pc({pathname:t="/",search:s="",hash:r=""}){return s&&s!=="?"&&(t+=s.charAt(0)==="?"?s:"?"+s),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function so(t){let s={};if(t){let r=t.indexOf("#");r>=0&&(s.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(s.search=t.substring(n),t=t.substring(0,n)),t&&(s.pathname=t)}return s}function ZC(t,s,r,n={}){let{window:a=document.defaultView,v5Compat:l=!1}=n,c=a.history,u="POP",f=null,h=v();h==null&&(h=0,c.replaceState({...c.state,idx:h},""));function v(){return(c.state||{idx:null}).idx}function w(){u="POP";let _=v(),I=_==null?null:_-h;h=_,f&&f({action:u,location:S.location,delta:I})}function j(_,I){u="PUSH";let F=ax(S.location,_,I);h=v()+1;let B=Jy(F,h),q=S.createHref(F);try{c.pushState(B,"",q)}catch(me){if(me instanceof DOMException&&me.name==="DataCloneError")throw me;a.location.assign(q)}l&&f&&f({action:u,location:S.location,delta:1})}function C(_,I){u="REPLACE";let F=ax(S.location,_,I);h=v();let B=Jy(F,h),q=S.createHref(F);c.replaceState(B,"",q),l&&f&&f({action:u,location:S.location,delta:0})}function k(_){return e_(_)}let S={get action(){return u},get location(){return t(a,c)},listen(_){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(Xy,w),f=_,()=>{a.removeEventListener(Xy,w),f=null}},createHref(_){return s(a,_)},createURL:k,encodeLocation(_){let I=k(_);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:j,replace:C,go(_){return c.go(_)}};return S}function e_(t,s=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Hs(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:pc(t);return n=n.replace(/ $/,"%20"),!s&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function l1(t,s,r="/"){return t_(t,s,r,!1)}function t_(t,s,r,n){let a=typeof s=="string"?so(s):s,l=$a(a.pathname||"/",r);if(l==null)return null;let c=o1(t);s_(c);let u=null;for(let f=0;u==null&&f<c.length;++f){let h=p_(l);u=u_(c[f],h,n)}return u}function o1(t,s=[],r=[],n="",a=!1){let l=(c,u,f=a,h)=>{let v={relativePath:h===void 0?c.path||"":h,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(n)&&f)return;Hs(v.relativePath.startsWith(n),`Absolute route path "${v.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(n.length)}let w=Ia([n,v.relativePath]),j=r.concat(v);c.children&&c.children.length>0&&(Hs(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${w}".`),o1(c.children,s,j,w,f)),!(c.path==null&&!c.index)&&s.push({path:w,score:c_(w,c.index),routesMeta:j})};return t.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))l(c,u);else for(let f of c1(c.path))l(c,u,!0,f)}),s}function c1(t){let s=t.split("/");if(s.length===0)return[];let[r,...n]=s,a=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return a?[l,""]:[l];let c=c1(n.join("/")),u=[];return u.push(...c.map(f=>f===""?l:[l,f].join("/"))),a&&u.push(...c),u.map(f=>t.startsWith("/")&&f===""?"/":f)}function s_(t){t.sort((s,r)=>s.score!==r.score?r.score-s.score:d_(s.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var r_=/^:[\w-]+$/,n_=3,a_=2,i_=1,l_=10,o_=-2,Zy=t=>t==="*";function c_(t,s){let r=t.split("/"),n=r.length;return r.some(Zy)&&(n+=o_),s&&(n+=a_),r.filter(a=>!Zy(a)).reduce((a,l)=>a+(r_.test(l)?n_:l===""?i_:l_),n)}function d_(t,s){return t.length===s.length&&t.slice(0,-1).every((n,a)=>n===s[a])?t[t.length-1]-s[s.length-1]:0}function u_(t,s,r=!1){let{routesMeta:n}=t,a={},l="/",c=[];for(let u=0;u<n.length;++u){let f=n[u],h=u===n.length-1,v=l==="/"?s:s.slice(l.length)||"/",w=Pu({path:f.relativePath,caseSensitive:f.caseSensitive,end:h},v),j=f.route;if(!w&&h&&r&&!n[n.length-1].route.index&&(w=Pu({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},v)),!w)return null;Object.assign(a,w.params),c.push({params:a,pathname:Ia([l,w.pathname]),pathnameBase:g_(Ia([l,w.pathnameBase])),route:j}),w.pathnameBase!=="/"&&(l=Ia([l,w.pathnameBase]))}return c}function Pu(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=m_(t.path,t.caseSensitive,t.end),a=s.match(r);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((h,{paramName:v,isOptional:w},j)=>{if(v==="*"){let k=u[j]||"";c=l.slice(0,l.length-k.length).replace(/(.)\/+$/,"$1")}const C=u[j];return w&&!C?h[v]=void 0:h[v]=(C||"").replace(/%2F/g,"/"),h},{}),pathname:l,pathnameBase:c,pattern:t}}function m_(t,s=!1,r=!0){Jn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,f)=>(n.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,s?void 0:"i"),n]}function p_(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return Jn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${s}).`),t}}function $a(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let r=s.endsWith("/")?s.length-1:s.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function x_(t,s="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?so(t):t;return{pathname:r?r.startsWith("/")?r:h_(r,s):s,search:y_(n),hash:v_(a)}}function h_(t,s){let r=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function N0(t,s,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${s}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function f_(t){return t.filter((s,r)=>r===0||s.route.path&&s.route.path.length>0)}function Rx(t){let s=f_(t);return s.map((r,n)=>n===s.length-1?r.pathname:r.pathnameBase)}function Dx(t,s,r,n=!1){let a;typeof t=="string"?a=so(t):(a={...t},Hs(!a.pathname||!a.pathname.includes("?"),N0("?","pathname","search",a)),Hs(!a.pathname||!a.pathname.includes("#"),N0("#","pathname","hash",a)),Hs(!a.search||!a.search.includes("#"),N0("#","search","hash",a)));let l=t===""||a.pathname==="",c=l?"/":a.pathname,u;if(c==null)u=r;else{let w=s.length-1;if(!n&&c.startsWith("..")){let j=c.split("/");for(;j[0]==="..";)j.shift(),w-=1;a.pathname=j.join("/")}u=w>=0?s[w]:"/"}let f=x_(a,u),h=c&&c!=="/"&&c.endsWith("/"),v=(l||c===".")&&r.endsWith("/");return!f.pathname.endsWith("/")&&(h||v)&&(f.pathname+="/"),f}var Ia=t=>t.join("/").replace(/\/\/+/g,"/"),g_=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),y_=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,v_=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function b_(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var d1=["POST","PUT","PATCH","DELETE"];new Set(d1);var w_=["GET",...d1];new Set(w_);var ro=d.createContext(null);ro.displayName="DataRouter";var im=d.createContext(null);im.displayName="DataRouterState";d.createContext(!1);var u1=d.createContext({isTransitioning:!1});u1.displayName="ViewTransition";var N_=d.createContext(new Map);N_.displayName="Fetchers";var j_=d.createContext(null);j_.displayName="Await";var na=d.createContext(null);na.displayName="Navigation";var Cc=d.createContext(null);Cc.displayName="Location";var ja=d.createContext({outlet:null,matches:[],isDataRoute:!1});ja.displayName="Route";var Lx=d.createContext(null);Lx.displayName="RouteError";function S_(t,{relative:s}={}){Hs(no(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=d.useContext(na),{hash:a,pathname:l,search:c}=_c(t,{relative:s}),u=l;return r!=="/"&&(u=l==="/"?r:Ia([r,l])),n.createHref({pathname:u,search:c,hash:a})}function no(){return d.useContext(Cc)!=null}function Sa(){return Hs(no(),"useLocation() may be used only in the context of a <Router> component."),d.useContext(Cc).location}var m1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function p1(t){d.useContext(na).static||d.useLayoutEffect(t)}function Pn(){let{isDataRoute:t}=d.useContext(ja);return t?M_():k_()}function k_(){Hs(no(),"useNavigate() may be used only in the context of a <Router> component.");let t=d.useContext(ro),{basename:s,navigator:r}=d.useContext(na),{matches:n}=d.useContext(ja),{pathname:a}=Sa(),l=JSON.stringify(Rx(n)),c=d.useRef(!1);return p1(()=>{c.current=!0}),d.useCallback((f,h={})=>{if(Jn(c.current,m1),!c.current)return;if(typeof f=="number"){r.go(f);return}let v=Dx(f,JSON.parse(l),a,h.relative==="path");t==null&&s!=="/"&&(v.pathname=v.pathname==="/"?s:Ia([s,v.pathname])),(h.replace?r.replace:r.push)(v,h.state,h)},[s,r,l,a,t])}d.createContext(null);function _c(t,{relative:s}={}){let{matches:r}=d.useContext(ja),{pathname:n}=Sa(),a=JSON.stringify(Rx(r));return d.useMemo(()=>Dx(t,JSON.parse(a),n,s==="path"),[t,a,n,s])}function C_(t,s){return x1(t,s)}function x1(t,s,r,n,a){Hs(no(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=d.useContext(na),{matches:c}=d.useContext(ja),u=c[c.length-1],f=u?u.params:{},h=u?u.pathname:"/",v=u?u.pathnameBase:"/",w=u&&u.route;{let F=w&&w.path||"";h1(h,!w||F.endsWith("*")||F.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${F}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${F}"> to <Route path="${F==="/"?"*":`${F}/*`}">.`)}let j=Sa(),C;if(s){let F=typeof s=="string"?so(s):s;Hs(v==="/"||F.pathname?.startsWith(v),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${v}" but pathname "${F.pathname}" was given in the \`location\` prop.`),C=F}else C=j;let k=C.pathname||"/",S=k;if(v!=="/"){let F=v.replace(/^\//,"").split("/");S="/"+k.replace(/^\//,"").split("/").slice(F.length).join("/")}let _=l1(t,{pathname:S});Jn(w||_!=null,`No routes matched location "${C.pathname}${C.search}${C.hash}" `),Jn(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${C.pathname}${C.search}${C.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let I=T_(_&&_.map(F=>Object.assign({},F,{params:Object.assign({},f,F.params),pathname:Ia([v,l.encodeLocation?l.encodeLocation(F.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:F.pathname]),pathnameBase:F.pathnameBase==="/"?v:Ia([v,l.encodeLocation?l.encodeLocation(F.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:F.pathnameBase])})),c,r,n,a);return s&&I?d.createElement(Cc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...C},navigationType:"POP"}},I):I}function __(){let t=F_(),s=b_(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},l={padding:"2px 4px",backgroundColor:n},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=d.createElement(d.Fragment,null,d.createElement("p",null," Hey developer "),d.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",d.createElement("code",{style:l},"ErrorBoundary")," or"," ",d.createElement("code",{style:l},"errorElement")," prop on your route.")),d.createElement(d.Fragment,null,d.createElement("h2",null,"Unexpected Application Error!"),d.createElement("h3",{style:{fontStyle:"italic"}},s),r?d.createElement("pre",{style:a},r):null,c)}var E_=d.createElement(__,null),P_=class extends d.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,s){return s.location!==t.location||s.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:s.error,location:s.location,revalidation:t.revalidation||s.revalidation}}componentDidCatch(t,s){this.props.unstable_onError?this.props.unstable_onError(t,s):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?d.createElement(ja.Provider,{value:this.props.routeContext},d.createElement(Lx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function A_({routeContext:t,match:s,children:r}){let n=d.useContext(ro);return n&&n.static&&n.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=s.route.id),d.createElement(ja.Provider,{value:t},r)}function T_(t,s=[],r=null,n=null,a=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(s.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let l=t,c=r?.errors;if(c!=null){let h=l.findIndex(v=>v.route.id&&c?.[v.route.id]!==void 0);Hs(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,h+1))}let u=!1,f=-1;if(r)for(let h=0;h<l.length;h++){let v=l[h];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(f=h),v.route.id){let{loaderData:w,errors:j}=r,C=v.route.loader&&!w.hasOwnProperty(v.route.id)&&(!j||j[v.route.id]===void 0);if(v.route.lazy||C){u=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}return l.reduceRight((h,v,w)=>{let j,C=!1,k=null,S=null;r&&(j=c&&v.route.id?c[v.route.id]:void 0,k=v.route.errorElement||E_,u&&(f<0&&w===0?(h1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),C=!0,S=null):f===w&&(C=!0,S=v.route.hydrateFallbackElement||null)));let _=s.concat(l.slice(0,w+1)),I=()=>{let F;return j?F=k:C?F=S:v.route.Component?F=d.createElement(v.route.Component,null):v.route.element?F=v.route.element:F=h,d.createElement(A_,{match:v,routeContext:{outlet:h,matches:_,isDataRoute:r!=null},children:F})};return r&&(v.route.ErrorBoundary||v.route.errorElement||w===0)?d.createElement(P_,{location:r.location,revalidation:r.revalidation,component:k,error:j,children:I(),routeContext:{outlet:null,matches:_,isDataRoute:!0},unstable_onError:n}):I()},null)}function Fx(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function O_(t){let s=d.useContext(ro);return Hs(s,Fx(t)),s}function R_(t){let s=d.useContext(im);return Hs(s,Fx(t)),s}function D_(t){let s=d.useContext(ja);return Hs(s,Fx(t)),s}function Mx(t){let s=D_(t),r=s.matches[s.matches.length-1];return Hs(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function L_(){return Mx("useRouteId")}function F_(){let t=d.useContext(Lx),s=R_("useRouteError"),r=Mx("useRouteError");return t!==void 0?t:s.errors?.[r]}function M_(){let{router:t}=O_("useNavigate"),s=Mx("useNavigate"),r=d.useRef(!1);return p1(()=>{r.current=!0}),d.useCallback(async(a,l={})=>{Jn(r.current,m1),r.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:s,...l}))},[t,s])}var ev={};function h1(t,s,r){!s&&!ev[t]&&(ev[t]=!0,Jn(!1,r))}d.memo(I_);function I_({routes:t,future:s,state:r,unstable_onError:n}){return x1(t,void 0,r,n,s)}function Au({to:t,replace:s,state:r,relative:n}){Hs(no(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=d.useContext(na);Jn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=d.useContext(ja),{pathname:c}=Sa(),u=Pn(),f=Dx(t,Rx(l),c,n==="path"),h=JSON.stringify(f);return d.useEffect(()=>{u(JSON.parse(h),{replace:s,state:r,relative:n})},[u,h,n,s,r]),null}function zs(t){Hs(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function q_({basename:t="/",children:s=null,location:r,navigationType:n="POP",navigator:a,static:l=!1}){Hs(!no(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),u=d.useMemo(()=>({basename:c,navigator:a,static:l,future:{}}),[c,a,l]);typeof r=="string"&&(r=so(r));let{pathname:f="/",search:h="",hash:v="",state:w=null,key:j="default"}=r,C=d.useMemo(()=>{let k=$a(f,c);return k==null?null:{location:{pathname:k,search:h,hash:v,state:w,key:j},navigationType:n}},[c,f,h,v,w,j,n]);return Jn(C!=null,`<Router basename="${c}"> is not able to match the URL "${f}${h}${v}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:d.createElement(na.Provider,{value:u},d.createElement(Cc.Provider,{children:s,value:C}))}function B_({children:t,location:s}){return C_(ix(t),s)}function ix(t,s=[]){let r=[];return d.Children.forEach(t,(n,a)=>{if(!d.isValidElement(n))return;let l=[...s,a];if(n.type===d.Fragment){r.push.apply(r,ix(n.props.children,l));return}Hs(n.type===zs,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Hs(!n.props.index||!n.props.children,"An index route cannot have child routes.");let c={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=ix(n.props.children,l)),r.push(c)}),r}var yu="get",vu="application/x-www-form-urlencoded";function lm(t){return t!=null&&typeof t.tagName=="string"}function z_(t){return lm(t)&&t.tagName.toLowerCase()==="button"}function $_(t){return lm(t)&&t.tagName.toLowerCase()==="form"}function Q_(t){return lm(t)&&t.tagName.toLowerCase()==="input"}function U_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function V_(t,s){return t.button===0&&(!s||s==="_self")&&!U_(t)}var eu=null;function W_(){if(eu===null)try{new FormData(document.createElement("form"),0),eu=!1}catch{eu=!0}return eu}var G_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function j0(t){return t!=null&&!G_.has(t)?(Jn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${vu}"`),null):t}function H_(t,s){let r,n,a,l,c;if($_(t)){let u=t.getAttribute("action");n=u?$a(u,s):null,r=t.getAttribute("method")||yu,a=j0(t.getAttribute("enctype"))||vu,l=new FormData(t)}else if(z_(t)||Q_(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||u.getAttribute("action");if(n=f?$a(f,s):null,r=t.getAttribute("formmethod")||u.getAttribute("method")||yu,a=j0(t.getAttribute("formenctype"))||j0(u.getAttribute("enctype"))||vu,l=new FormData(u,t),!W_()){let{name:h,type:v,value:w}=t;if(v==="image"){let j=h?`${h}.`:"";l.append(`${j}x`,"0"),l.append(`${j}y`,"0")}else h&&l.append(h,w)}}else{if(lm(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=yu,n=null,a=vu,c=t}return l&&a==="text/plain"&&(c=l,l=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ix(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function Y_(t,s,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:s&&$a(n.pathname,s)==="/"?n.pathname=`${s.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function K_(t,s){if(t.id in s)return s[t.id];try{let r=await import(t.module);return s[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function X_(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function J_(t,s,r){let n=await Promise.all(t.map(async a=>{let l=s.routes[a.route.id];if(l){let c=await K_(l,r);return c.links?c.links():[]}return[]}));return s3(n.flat(1).filter(X_).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function tv(t,s,r,n,a,l){let c=(f,h)=>r[h]?f.route.id!==r[h].route.id:!0,u=(f,h)=>r[h].pathname!==f.pathname||r[h].route.path?.endsWith("*")&&r[h].params["*"]!==f.params["*"];return l==="assets"?s.filter((f,h)=>c(f,h)||u(f,h)):l==="data"?s.filter((f,h)=>{let v=n.routes[f.route.id];if(!v||!v.hasLoader)return!1;if(c(f,h)||u(f,h))return!0;if(f.route.shouldRevalidate){let w=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function Z_(t,s,{includeHydrateFallback:r}={}){return e3(t.map(n=>{let a=s.routes[n.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function e3(t){return[...new Set(t)]}function t3(t){let s={},r=Object.keys(t).sort();for(let n of r)s[n]=t[n];return s}function s3(t,s){let r=new Set;return new Set(s),t.reduce((n,a)=>{let l=JSON.stringify(t3(a));return r.has(l)||(r.add(l),n.push({key:l,link:a})),n},[])}function f1(){let t=d.useContext(ro);return Ix(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function r3(){let t=d.useContext(im);return Ix(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var qx=d.createContext(void 0);qx.displayName="FrameworkContext";function g1(){let t=d.useContext(qx);return Ix(t,"You must render this element inside a <HydratedRouter> element"),t}function n3(t,s){let r=d.useContext(qx),[n,a]=d.useState(!1),[l,c]=d.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:h,onMouseLeave:v,onTouchStart:w}=s,j=d.useRef(null);d.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let S=I=>{I.forEach(F=>{c(F.isIntersecting)})},_=new IntersectionObserver(S,{threshold:.5});return j.current&&_.observe(j.current),()=>{_.disconnect()}}},[t]),d.useEffect(()=>{if(n){let S=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(S)}}},[n]);let C=()=>{a(!0)},k=()=>{a(!1),c(!1)};return r?t!=="intent"?[l,j,{}]:[l,j,{onFocus:Jo(u,C),onBlur:Jo(f,k),onMouseEnter:Jo(h,C),onMouseLeave:Jo(v,k),onTouchStart:Jo(w,C)}]:[!1,j,{}]}function Jo(t,s){return r=>{t&&t(r),r.defaultPrevented||s(r)}}function a3({page:t,...s}){let{router:r}=f1(),n=d.useMemo(()=>l1(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?d.createElement(l3,{page:t,matches:n,...s}):null}function i3(t){let{manifest:s,routeModules:r}=g1(),[n,a]=d.useState([]);return d.useEffect(()=>{let l=!1;return J_(t,s,r).then(c=>{l||a(c)}),()=>{l=!0}},[t,s,r]),n}function l3({page:t,matches:s,...r}){let n=Sa(),{manifest:a,routeModules:l}=g1(),{basename:c}=f1(),{loaderData:u,matches:f}=r3(),h=d.useMemo(()=>tv(t,s,f,a,n,"data"),[t,s,f,a,n]),v=d.useMemo(()=>tv(t,s,f,a,n,"assets"),[t,s,f,a,n]),w=d.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let k=new Set,S=!1;if(s.forEach(I=>{let F=a.routes[I.route.id];!F||!F.hasLoader||(!h.some(B=>B.route.id===I.route.id)&&I.route.id in u&&l[I.route.id]?.shouldRevalidate||F.hasClientLoader?S=!0:k.add(I.route.id))}),k.size===0)return[];let _=Y_(t,c,"data");return S&&k.size>0&&_.searchParams.set("_routes",s.filter(I=>k.has(I.route.id)).map(I=>I.route.id).join(",")),[_.pathname+_.search]},[c,u,n,a,h,s,t,l]),j=d.useMemo(()=>Z_(v,a),[v,a]),C=i3(v);return d.createElement(d.Fragment,null,w.map(k=>d.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...r})),j.map(k=>d.createElement("link",{key:k,rel:"modulepreload",href:k,...r})),C.map(({key:k,link:S})=>d.createElement("link",{key:k,nonce:r.nonce,...S})))}function o3(...t){return s=>{t.forEach(r=>{typeof r=="function"?r(s):r!=null&&(r.current=s)})}}var y1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{y1&&(window.__reactRouterVersion="7.9.5")}catch{}function c3({basename:t,children:s,window:r}){let n=d.useRef();n.current==null&&(n.current=XC({window:r,v5Compat:!0}));let a=n.current,[l,c]=d.useState({action:a.action,location:a.location}),u=d.useCallback(f=>{d.startTransition(()=>c(f))},[c]);return d.useLayoutEffect(()=>a.listen(u),[a,u]),d.createElement(q_,{basename:t,children:s,location:l.location,navigationType:l.action,navigator:a})}var v1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,b1=d.forwardRef(function({onClick:s,discover:r="render",prefetch:n="none",relative:a,reloadDocument:l,replace:c,state:u,target:f,to:h,preventScrollReset:v,viewTransition:w,...j},C){let{basename:k}=d.useContext(na),S=typeof h=="string"&&v1.test(h),_,I=!1;if(typeof h=="string"&&S&&(_=h,y1))try{let oe=new URL(window.location.href),X=h.startsWith("//")?new URL(oe.protocol+h):new URL(h),he=$a(X.pathname,k);X.origin===oe.origin&&he!=null?h=he+X.search+X.hash:I=!0}catch{Jn(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let F=S_(h,{relative:a}),[B,q,me]=n3(n,j),re=p3(h,{replace:c,state:u,target:f,preventScrollReset:v,relative:a,viewTransition:w});function M(oe){s&&s(oe),oe.defaultPrevented||re(oe)}let W=d.createElement("a",{...j,...me,href:_||F,onClick:I||l?s:M,ref:o3(C,q),target:f,"data-discover":!S&&r==="render"?"true":void 0});return B&&!S?d.createElement(d.Fragment,null,W,d.createElement(a3,{page:F})):W});b1.displayName="Link";var d3=d.forwardRef(function({"aria-current":s="page",caseSensitive:r=!1,className:n="",end:a=!1,style:l,to:c,viewTransition:u,children:f,...h},v){let w=_c(c,{relative:h.relative}),j=Sa(),C=d.useContext(im),{navigator:k,basename:S}=d.useContext(na),_=C!=null&&y3(w)&&u===!0,I=k.encodeLocation?k.encodeLocation(w).pathname:w.pathname,F=j.pathname,B=C&&C.navigation&&C.navigation.location?C.navigation.location.pathname:null;r||(F=F.toLowerCase(),B=B?B.toLowerCase():null,I=I.toLowerCase()),B&&S&&(B=$a(B,S)||B);const q=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let me=F===I||!a&&F.startsWith(I)&&F.charAt(q)==="/",re=B!=null&&(B===I||!a&&B.startsWith(I)&&B.charAt(I.length)==="/"),M={isActive:me,isPending:re,isTransitioning:_},W=me?s:void 0,oe;typeof n=="function"?oe=n(M):oe=[n,me?"active":null,re?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let X=typeof l=="function"?l(M):l;return d.createElement(b1,{...h,"aria-current":W,className:oe,ref:v,style:X,to:c,viewTransition:u},typeof f=="function"?f(M):f)});d3.displayName="NavLink";var u3=d.forwardRef(({discover:t="render",fetcherKey:s,navigate:r,reloadDocument:n,replace:a,state:l,method:c=yu,action:u,onSubmit:f,relative:h,preventScrollReset:v,viewTransition:w,...j},C)=>{let k=f3(),S=g3(u,{relative:h}),_=c.toLowerCase()==="get"?"get":"post",I=typeof u=="string"&&v1.test(u),F=B=>{if(f&&f(B),B.defaultPrevented)return;B.preventDefault();let q=B.nativeEvent.submitter,me=q?.getAttribute("formmethod")||c;k(q||B.currentTarget,{fetcherKey:s,method:me,navigate:r,replace:a,state:l,relative:h,preventScrollReset:v,viewTransition:w})};return d.createElement("form",{ref:C,method:_,action:S,onSubmit:n?f:F,...j,"data-discover":!I&&t==="render"?"true":void 0})});u3.displayName="Form";function m3(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function w1(t){let s=d.useContext(ro);return Hs(s,m3(t)),s}function p3(t,{target:s,replace:r,state:n,preventScrollReset:a,relative:l,viewTransition:c}={}){let u=Pn(),f=Sa(),h=_c(t,{relative:l});return d.useCallback(v=>{if(V_(v,s)){v.preventDefault();let w=r!==void 0?r:pc(f)===pc(h);u(t,{replace:w,state:n,preventScrollReset:a,relative:l,viewTransition:c})}},[f,u,h,r,n,s,t,a,l,c])}var x3=0,h3=()=>`__${String(++x3)}__`;function f3(){let{router:t}=w1("useSubmit"),{basename:s}=d.useContext(na),r=L_();return d.useCallback(async(n,a={})=>{let{action:l,method:c,encType:u,formData:f,body:h}=H_(n,s);if(a.navigate===!1){let v=a.fetcherKey||h3();await t.fetch(v,r,a.action||l,{preventScrollReset:a.preventScrollReset,formData:f,body:h,formMethod:a.method||c,formEncType:a.encType||u,flushSync:a.flushSync})}else await t.navigate(a.action||l,{preventScrollReset:a.preventScrollReset,formData:f,body:h,formMethod:a.method||c,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,s,r])}function g3(t,{relative:s}={}){let{basename:r}=d.useContext(na),n=d.useContext(ja);Hs(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),l={..._c(t||".",{relative:s})},c=Sa();if(t==null){l.search=c.search;let u=new URLSearchParams(l.search),f=u.getAll("index");if(f.some(v=>v==="")){u.delete("index"),f.filter(w=>w).forEach(w=>u.append("index",w));let v=u.toString();l.search=v?`?${v}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(l.pathname=l.pathname==="/"?r:Ia([r,l.pathname])),pc(l)}function y3(t,{relative:s}={}){let r=d.useContext(u1);Hs(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=w1("useViewTransitionState"),a=_c(t,{relative:s});if(!r.isTransitioning)return!1;let l=$a(r.currentLocation.pathname,n)||r.currentLocation.pathname,c=$a(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Pu(a.pathname,c)!=null||Pu(a.pathname,l)!=null}var Ec=i1();const v3=a1(Ec),b3="https://plan.gmvalve.in/backend/api";async function w3(t,s){const r=await fetch(`${b3}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:s})});if(!r.ok)throw new Error("Login failed");return r.json()}const qt="https://plan.gmvalve.in/backend/api";function N3(t){const s=t.toLowerCase();return s.startsWith("planning")?"planning":s.startsWith("materialissue")?"material-issue":s.startsWith("semiqc")?"semi-qc":s.startsWith("phospatingqc")?"phosphating-qc":s.startsWith("assembly")?"assembly":s.startsWith("testing")?"testing":s.startsWith("marking")?"marking":s.startsWith("svs")?"svs":s.startsWith("pdi")?"pdi":s.startsWith("tpi")?"tpi":s.startsWith("dispatch")?"dispatch":s.startsWith("admin")?"admin":"user"}function sv(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function ka(...t){return s=>{let r=!1;const n=t.map(a=>{const l=sv(a,s);return!r&&typeof l=="function"&&(r=!0),l});if(r)return()=>{for(let a=0;a<n.length;a++){const l=n[a];typeof l=="function"?l():sv(t[a],null)}}}}function Ts(...t){return d.useCallback(ka(...t),t)}var j3=Symbol.for("react.lazy"),Tu=Ox[" use ".trim().toString()];function S3(t){return typeof t=="object"&&t!==null&&"then"in t}function N1(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===j3&&"_payload"in t&&S3(t._payload)}function Bx(t){const s=k3(t),r=d.forwardRef((n,a)=>{let{children:l,...c}=n;N1(l)&&typeof Tu=="function"&&(l=Tu(l._payload));const u=d.Children.toArray(l),f=u.find(_3);if(f){const h=f.props.children,v=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(s,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,v):null})}return e.jsx(s,{...c,ref:a,children:l})});return r.displayName=`${t}.Slot`,r}var j1=Bx("Slot");function k3(t){const s=d.forwardRef((r,n)=>{let{children:a,...l}=r;if(N1(a)&&typeof Tu=="function"&&(a=Tu(a._payload)),d.isValidElement(a)){const c=P3(a),u=E3(l,a.props);return a.type!==d.Fragment&&(u.ref=n?ka(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var C3=Symbol("radix.slottable");function _3(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===C3}function E3(t,s){const r={...s};for(const n in s){const a=t[n],l=s[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(r[n]=a):n==="style"?r[n]={...a,...l}:n==="className"&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...t,...r}}function P3(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function S1(t){var s,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(s=0;s<a;s++)t[s]&&(r=S1(t[s]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function k1(){for(var t,s,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(s=S1(t))&&(n&&(n+=" "),n+=s);return n}const rv=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,nv=k1,C1=(t,s)=>r=>{var n;if(s?.variants==null)return nv(t,r?.class,r?.className);const{variants:a,defaultVariants:l}=s,c=Object.keys(a).map(h=>{const v=r?.[h],w=l?.[h];if(v===null)return null;const j=rv(v)||rv(w);return a[h][j]}),u=r&&Object.entries(r).reduce((h,v)=>{let[w,j]=v;return j===void 0||(h[w]=j),h},{}),f=s==null||(n=s.compoundVariants)===null||n===void 0?void 0:n.reduce((h,v)=>{let{class:w,className:j,...C}=v;return Object.entries(C).every(k=>{let[S,_]=k;return Array.isArray(_)?_.includes({...l,...u}[S]):{...l,...u}[S]===_})?[...h,w,j]:h},[]);return nv(t,c,f,r?.class,r?.className)},zx="-",A3=t=>{const s=O3(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:c=>{const u=c.split(zx);return u[0]===""&&u.length!==1&&u.shift(),_1(u,s)||T3(c)},getConflictingClassGroupIds:(c,u)=>{const f=r[c]||[];return u&&n[c]?[...f,...n[c]]:f}}},_1=(t,s)=>{if(t.length===0)return s.classGroupId;const r=t[0],n=s.nextPart.get(r),a=n?_1(t.slice(1),n):void 0;if(a)return a;if(s.validators.length===0)return;const l=t.join(zx);return s.validators.find(({validator:c})=>c(l))?.classGroupId},av=/^\[(.+)\]$/,T3=t=>{if(av.test(t)){const s=av.exec(t)[1],r=s?.substring(0,s.indexOf(":"));if(r)return"arbitrary.."+r}},O3=t=>{const{theme:s,classGroups:r}=t,n={nextPart:new Map,validators:[]};for(const a in r)lx(r[a],n,a,s);return n},lx=(t,s,r,n)=>{t.forEach(a=>{if(typeof a=="string"){const l=a===""?s:iv(s,a);l.classGroupId=r;return}if(typeof a=="function"){if(R3(a)){lx(a(n),s,r,n);return}s.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([l,c])=>{lx(c,iv(s,l),r,n)})})},iv=(t,s)=>{let r=t;return s.split(zx).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},R3=t=>t.isThemeGetter,D3=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,r=new Map,n=new Map;const a=(l,c)=>{r.set(l,c),s++,s>t&&(s=0,n=r,r=new Map)};return{get(l){let c=r.get(l);if(c!==void 0)return c;if((c=n.get(l))!==void 0)return a(l,c),c},set(l,c){r.has(l)?r.set(l,c):a(l,c)}}},ox="!",cx=":",L3=cx.length,F3=t=>{const{prefix:s,experimentalParseClassName:r}=t;let n=a=>{const l=[];let c=0,u=0,f=0,h;for(let k=0;k<a.length;k++){let S=a[k];if(c===0&&u===0){if(S===cx){l.push(a.slice(f,k)),f=k+L3;continue}if(S==="/"){h=k;continue}}S==="["?c++:S==="]"?c--:S==="("?u++:S===")"&&u--}const v=l.length===0?a:a.substring(f),w=M3(v),j=w!==v,C=h&&h>f?h-f:void 0;return{modifiers:l,hasImportantModifier:j,baseClassName:w,maybePostfixModifierPosition:C}};if(s){const a=s+cx,l=n;n=c=>c.startsWith(a)?l(c.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:c,maybePostfixModifierPosition:void 0}}if(r){const a=n;n=l=>r({className:l,parseClassName:a})}return n},M3=t=>t.endsWith(ox)?t.substring(0,t.length-1):t.startsWith(ox)?t.substring(1):t,I3=t=>{const s=Object.fromEntries(t.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const a=[];let l=[];return n.forEach(c=>{c[0]==="["||s[c]?(a.push(...l.sort(),c),l=[]):l.push(c)}),a.push(...l.sort()),a}},q3=t=>({cache:D3(t.cacheSize),parseClassName:F3(t),sortModifiers:I3(t),...A3(t)}),B3=/\s+/,z3=(t,s)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:l}=s,c=[],u=t.trim().split(B3);let f="";for(let h=u.length-1;h>=0;h-=1){const v=u[h],{isExternal:w,modifiers:j,hasImportantModifier:C,baseClassName:k,maybePostfixModifierPosition:S}=r(v);if(w){f=v+(f.length>0?" "+f:f);continue}let _=!!S,I=n(_?k.substring(0,S):k);if(!I){if(!_){f=v+(f.length>0?" "+f:f);continue}if(I=n(k),!I){f=v+(f.length>0?" "+f:f);continue}_=!1}const F=l(j).join(":"),B=C?F+ox:F,q=B+I;if(c.includes(q))continue;c.push(q);const me=a(I,_);for(let re=0;re<me.length;++re){const M=me[re];c.push(B+M)}f=v+(f.length>0?" "+f:f)}return f};function $3(){let t=0,s,r,n="";for(;t<arguments.length;)(s=arguments[t++])&&(r=E1(s))&&(n&&(n+=" "),n+=r);return n}const E1=t=>{if(typeof t=="string")return t;let s,r="";for(let n=0;n<t.length;n++)t[n]&&(s=E1(t[n]))&&(r&&(r+=" "),r+=s);return r};function Q3(t,...s){let r,n,a,l=c;function c(f){const h=s.reduce((v,w)=>w(v),t());return r=q3(h),n=r.cache.get,a=r.cache.set,l=u,u(f)}function u(f){const h=n(f);if(h)return h;const v=z3(f,r);return a(f,v),v}return function(){return l($3.apply(null,arguments))}}const Nr=t=>{const s=r=>r[t]||[];return s.isThemeGetter=!0,s},P1=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,A1=/^\((?:(\w[\w-]*):)?(.+)\)$/i,U3=/^\d+\/\d+$/,V3=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,W3=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,G3=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,H3=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Y3=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ll=t=>U3.test(t),vs=t=>!!t&&!Number.isNaN(Number(t)),xi=t=>!!t&&Number.isInteger(Number(t)),S0=t=>t.endsWith("%")&&vs(t.slice(0,-1)),La=t=>V3.test(t),K3=()=>!0,X3=t=>W3.test(t)&&!G3.test(t),T1=()=>!1,J3=t=>H3.test(t),Z3=t=>Y3.test(t),eE=t=>!ts(t)&&!ss(t),tE=t=>ao(t,D1,T1),ts=t=>P1.test(t),Qi=t=>ao(t,L1,X3),k0=t=>ao(t,iE,vs),lv=t=>ao(t,O1,T1),sE=t=>ao(t,R1,Z3),tu=t=>ao(t,F1,J3),ss=t=>A1.test(t),Zo=t=>io(t,L1),rE=t=>io(t,lE),ov=t=>io(t,O1),nE=t=>io(t,D1),aE=t=>io(t,R1),su=t=>io(t,F1,!0),ao=(t,s,r)=>{const n=P1.exec(t);return n?n[1]?s(n[1]):r(n[2]):!1},io=(t,s,r=!1)=>{const n=A1.exec(t);return n?n[1]?s(n[1]):r:!1},O1=t=>t==="position"||t==="percentage",R1=t=>t==="image"||t==="url",D1=t=>t==="length"||t==="size"||t==="bg-size",L1=t=>t==="length",iE=t=>t==="number",lE=t=>t==="family-name",F1=t=>t==="shadow",oE=()=>{const t=Nr("color"),s=Nr("font"),r=Nr("text"),n=Nr("font-weight"),a=Nr("tracking"),l=Nr("leading"),c=Nr("breakpoint"),u=Nr("container"),f=Nr("spacing"),h=Nr("radius"),v=Nr("shadow"),w=Nr("inset-shadow"),j=Nr("text-shadow"),C=Nr("drop-shadow"),k=Nr("blur"),S=Nr("perspective"),_=Nr("aspect"),I=Nr("ease"),F=Nr("animate"),B=()=>["auto","avoid","all","avoid-page","page","left","right","column"],q=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],me=()=>[...q(),ss,ts],re=()=>["auto","hidden","clip","visible","scroll"],M=()=>["auto","contain","none"],W=()=>[ss,ts,f],oe=()=>[Ll,"full","auto",...W()],X=()=>[xi,"none","subgrid",ss,ts],he=()=>["auto",{span:["full",xi,ss,ts]},xi,ss,ts],ue=()=>[xi,"auto",ss,ts],_e=()=>["auto","min","max","fr",ss,ts],ke=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Re=()=>["start","end","center","stretch","center-safe","end-safe"],Y=()=>["auto",...W()],ve=()=>[Ll,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...W()],Q=()=>[t,ss,ts],be=()=>[...q(),ov,lv,{position:[ss,ts]}],pe=()=>["no-repeat",{repeat:["","x","y","space","round"]}],ne=()=>["auto","cover","contain",nE,tE,{size:[ss,ts]}],U=()=>[S0,Zo,Qi],ce=()=>["","none","full",h,ss,ts],z=()=>["",vs,Zo,Qi],ae=()=>["solid","dashed","dotted","double"],ye=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],fe=()=>[vs,S0,ov,lv],Ee=()=>["","none",k,ss,ts],Le=()=>["none",vs,ss,ts],De=()=>["none",vs,ss,ts],Ve=()=>[vs,ss,ts],et=()=>[Ll,"full",...W()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[La],breakpoint:[La],color:[K3],container:[La],"drop-shadow":[La],ease:["in","out","in-out"],font:[eE],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[La],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[La],shadow:[La],spacing:["px",vs],text:[La],"text-shadow":[La],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ll,ts,ss,_]}],container:["container"],columns:[{columns:[vs,ts,ss,u]}],"break-after":[{"break-after":B()}],"break-before":[{"break-before":B()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:me()}],overflow:[{overflow:re()}],"overflow-x":[{"overflow-x":re()}],"overflow-y":[{"overflow-y":re()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:oe()}],"inset-x":[{"inset-x":oe()}],"inset-y":[{"inset-y":oe()}],start:[{start:oe()}],end:[{end:oe()}],top:[{top:oe()}],right:[{right:oe()}],bottom:[{bottom:oe()}],left:[{left:oe()}],visibility:["visible","invisible","collapse"],z:[{z:[xi,"auto",ss,ts]}],basis:[{basis:[Ll,"full","auto",u,...W()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[vs,Ll,"auto","initial","none",ts]}],grow:[{grow:["",vs,ss,ts]}],shrink:[{shrink:["",vs,ss,ts]}],order:[{order:[xi,"first","last","none",ss,ts]}],"grid-cols":[{"grid-cols":X()}],"col-start-end":[{col:he()}],"col-start":[{"col-start":ue()}],"col-end":[{"col-end":ue()}],"grid-rows":[{"grid-rows":X()}],"row-start-end":[{row:he()}],"row-start":[{"row-start":ue()}],"row-end":[{"row-end":ue()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":_e()}],"auto-rows":[{"auto-rows":_e()}],gap:[{gap:W()}],"gap-x":[{"gap-x":W()}],"gap-y":[{"gap-y":W()}],"justify-content":[{justify:[...ke(),"normal"]}],"justify-items":[{"justify-items":[...Re(),"normal"]}],"justify-self":[{"justify-self":["auto",...Re()]}],"align-content":[{content:["normal",...ke()]}],"align-items":[{items:[...Re(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Re(),{baseline:["","last"]}]}],"place-content":[{"place-content":ke()}],"place-items":[{"place-items":[...Re(),"baseline"]}],"place-self":[{"place-self":["auto",...Re()]}],p:[{p:W()}],px:[{px:W()}],py:[{py:W()}],ps:[{ps:W()}],pe:[{pe:W()}],pt:[{pt:W()}],pr:[{pr:W()}],pb:[{pb:W()}],pl:[{pl:W()}],m:[{m:Y()}],mx:[{mx:Y()}],my:[{my:Y()}],ms:[{ms:Y()}],me:[{me:Y()}],mt:[{mt:Y()}],mr:[{mr:Y()}],mb:[{mb:Y()}],ml:[{ml:Y()}],"space-x":[{"space-x":W()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":W()}],"space-y-reverse":["space-y-reverse"],size:[{size:ve()}],w:[{w:[u,"screen",...ve()]}],"min-w":[{"min-w":[u,"screen","none",...ve()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[c]},...ve()]}],h:[{h:["screen","lh",...ve()]}],"min-h":[{"min-h":["screen","lh","none",...ve()]}],"max-h":[{"max-h":["screen","lh",...ve()]}],"font-size":[{text:["base",r,Zo,Qi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,ss,k0]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",S0,ts]}],"font-family":[{font:[rE,ts,s]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,ss,ts]}],"line-clamp":[{"line-clamp":[vs,"none",ss,k0]}],leading:[{leading:[l,...W()]}],"list-image":[{"list-image":["none",ss,ts]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",ss,ts]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Q()}],"text-color":[{text:Q()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ae(),"wavy"]}],"text-decoration-thickness":[{decoration:[vs,"from-font","auto",ss,Qi]}],"text-decoration-color":[{decoration:Q()}],"underline-offset":[{"underline-offset":[vs,"auto",ss,ts]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:W()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ss,ts]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ss,ts]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:be()}],"bg-repeat":[{bg:pe()}],"bg-size":[{bg:ne()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},xi,ss,ts],radial:["",ss,ts],conic:[xi,ss,ts]},aE,sE]}],"bg-color":[{bg:Q()}],"gradient-from-pos":[{from:U()}],"gradient-via-pos":[{via:U()}],"gradient-to-pos":[{to:U()}],"gradient-from":[{from:Q()}],"gradient-via":[{via:Q()}],"gradient-to":[{to:Q()}],rounded:[{rounded:ce()}],"rounded-s":[{"rounded-s":ce()}],"rounded-e":[{"rounded-e":ce()}],"rounded-t":[{"rounded-t":ce()}],"rounded-r":[{"rounded-r":ce()}],"rounded-b":[{"rounded-b":ce()}],"rounded-l":[{"rounded-l":ce()}],"rounded-ss":[{"rounded-ss":ce()}],"rounded-se":[{"rounded-se":ce()}],"rounded-ee":[{"rounded-ee":ce()}],"rounded-es":[{"rounded-es":ce()}],"rounded-tl":[{"rounded-tl":ce()}],"rounded-tr":[{"rounded-tr":ce()}],"rounded-br":[{"rounded-br":ce()}],"rounded-bl":[{"rounded-bl":ce()}],"border-w":[{border:z()}],"border-w-x":[{"border-x":z()}],"border-w-y":[{"border-y":z()}],"border-w-s":[{"border-s":z()}],"border-w-e":[{"border-e":z()}],"border-w-t":[{"border-t":z()}],"border-w-r":[{"border-r":z()}],"border-w-b":[{"border-b":z()}],"border-w-l":[{"border-l":z()}],"divide-x":[{"divide-x":z()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":z()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ae(),"hidden","none"]}],"divide-style":[{divide:[...ae(),"hidden","none"]}],"border-color":[{border:Q()}],"border-color-x":[{"border-x":Q()}],"border-color-y":[{"border-y":Q()}],"border-color-s":[{"border-s":Q()}],"border-color-e":[{"border-e":Q()}],"border-color-t":[{"border-t":Q()}],"border-color-r":[{"border-r":Q()}],"border-color-b":[{"border-b":Q()}],"border-color-l":[{"border-l":Q()}],"divide-color":[{divide:Q()}],"outline-style":[{outline:[...ae(),"none","hidden"]}],"outline-offset":[{"outline-offset":[vs,ss,ts]}],"outline-w":[{outline:["",vs,Zo,Qi]}],"outline-color":[{outline:Q()}],shadow:[{shadow:["","none",v,su,tu]}],"shadow-color":[{shadow:Q()}],"inset-shadow":[{"inset-shadow":["none",w,su,tu]}],"inset-shadow-color":[{"inset-shadow":Q()}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Q()}],"ring-offset-w":[{"ring-offset":[vs,Qi]}],"ring-offset-color":[{"ring-offset":Q()}],"inset-ring-w":[{"inset-ring":z()}],"inset-ring-color":[{"inset-ring":Q()}],"text-shadow":[{"text-shadow":["none",j,su,tu]}],"text-shadow-color":[{"text-shadow":Q()}],opacity:[{opacity:[vs,ss,ts]}],"mix-blend":[{"mix-blend":[...ye(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ye()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[vs]}],"mask-image-linear-from-pos":[{"mask-linear-from":fe()}],"mask-image-linear-to-pos":[{"mask-linear-to":fe()}],"mask-image-linear-from-color":[{"mask-linear-from":Q()}],"mask-image-linear-to-color":[{"mask-linear-to":Q()}],"mask-image-t-from-pos":[{"mask-t-from":fe()}],"mask-image-t-to-pos":[{"mask-t-to":fe()}],"mask-image-t-from-color":[{"mask-t-from":Q()}],"mask-image-t-to-color":[{"mask-t-to":Q()}],"mask-image-r-from-pos":[{"mask-r-from":fe()}],"mask-image-r-to-pos":[{"mask-r-to":fe()}],"mask-image-r-from-color":[{"mask-r-from":Q()}],"mask-image-r-to-color":[{"mask-r-to":Q()}],"mask-image-b-from-pos":[{"mask-b-from":fe()}],"mask-image-b-to-pos":[{"mask-b-to":fe()}],"mask-image-b-from-color":[{"mask-b-from":Q()}],"mask-image-b-to-color":[{"mask-b-to":Q()}],"mask-image-l-from-pos":[{"mask-l-from":fe()}],"mask-image-l-to-pos":[{"mask-l-to":fe()}],"mask-image-l-from-color":[{"mask-l-from":Q()}],"mask-image-l-to-color":[{"mask-l-to":Q()}],"mask-image-x-from-pos":[{"mask-x-from":fe()}],"mask-image-x-to-pos":[{"mask-x-to":fe()}],"mask-image-x-from-color":[{"mask-x-from":Q()}],"mask-image-x-to-color":[{"mask-x-to":Q()}],"mask-image-y-from-pos":[{"mask-y-from":fe()}],"mask-image-y-to-pos":[{"mask-y-to":fe()}],"mask-image-y-from-color":[{"mask-y-from":Q()}],"mask-image-y-to-color":[{"mask-y-to":Q()}],"mask-image-radial":[{"mask-radial":[ss,ts]}],"mask-image-radial-from-pos":[{"mask-radial-from":fe()}],"mask-image-radial-to-pos":[{"mask-radial-to":fe()}],"mask-image-radial-from-color":[{"mask-radial-from":Q()}],"mask-image-radial-to-color":[{"mask-radial-to":Q()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":q()}],"mask-image-conic-pos":[{"mask-conic":[vs]}],"mask-image-conic-from-pos":[{"mask-conic-from":fe()}],"mask-image-conic-to-pos":[{"mask-conic-to":fe()}],"mask-image-conic-from-color":[{"mask-conic-from":Q()}],"mask-image-conic-to-color":[{"mask-conic-to":Q()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:be()}],"mask-repeat":[{mask:pe()}],"mask-size":[{mask:ne()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",ss,ts]}],filter:[{filter:["","none",ss,ts]}],blur:[{blur:Ee()}],brightness:[{brightness:[vs,ss,ts]}],contrast:[{contrast:[vs,ss,ts]}],"drop-shadow":[{"drop-shadow":["","none",C,su,tu]}],"drop-shadow-color":[{"drop-shadow":Q()}],grayscale:[{grayscale:["",vs,ss,ts]}],"hue-rotate":[{"hue-rotate":[vs,ss,ts]}],invert:[{invert:["",vs,ss,ts]}],saturate:[{saturate:[vs,ss,ts]}],sepia:[{sepia:["",vs,ss,ts]}],"backdrop-filter":[{"backdrop-filter":["","none",ss,ts]}],"backdrop-blur":[{"backdrop-blur":Ee()}],"backdrop-brightness":[{"backdrop-brightness":[vs,ss,ts]}],"backdrop-contrast":[{"backdrop-contrast":[vs,ss,ts]}],"backdrop-grayscale":[{"backdrop-grayscale":["",vs,ss,ts]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[vs,ss,ts]}],"backdrop-invert":[{"backdrop-invert":["",vs,ss,ts]}],"backdrop-opacity":[{"backdrop-opacity":[vs,ss,ts]}],"backdrop-saturate":[{"backdrop-saturate":[vs,ss,ts]}],"backdrop-sepia":[{"backdrop-sepia":["",vs,ss,ts]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":W()}],"border-spacing-x":[{"border-spacing-x":W()}],"border-spacing-y":[{"border-spacing-y":W()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",ss,ts]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[vs,"initial",ss,ts]}],ease:[{ease:["linear","initial",I,ss,ts]}],delay:[{delay:[vs,ss,ts]}],animate:[{animate:["none",F,ss,ts]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[S,ss,ts]}],"perspective-origin":[{"perspective-origin":me()}],rotate:[{rotate:Le()}],"rotate-x":[{"rotate-x":Le()}],"rotate-y":[{"rotate-y":Le()}],"rotate-z":[{"rotate-z":Le()}],scale:[{scale:De()}],"scale-x":[{"scale-x":De()}],"scale-y":[{"scale-y":De()}],"scale-z":[{"scale-z":De()}],"scale-3d":["scale-3d"],skew:[{skew:Ve()}],"skew-x":[{"skew-x":Ve()}],"skew-y":[{"skew-y":Ve()}],transform:[{transform:[ss,ts,"","none","gpu","cpu"]}],"transform-origin":[{origin:me()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:et()}],"translate-x":[{"translate-x":et()}],"translate-y":[{"translate-y":et()}],"translate-z":[{"translate-z":et()}],"translate-none":["translate-none"],accent:[{accent:Q()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Q()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ss,ts]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":W()}],"scroll-mx":[{"scroll-mx":W()}],"scroll-my":[{"scroll-my":W()}],"scroll-ms":[{"scroll-ms":W()}],"scroll-me":[{"scroll-me":W()}],"scroll-mt":[{"scroll-mt":W()}],"scroll-mr":[{"scroll-mr":W()}],"scroll-mb":[{"scroll-mb":W()}],"scroll-ml":[{"scroll-ml":W()}],"scroll-p":[{"scroll-p":W()}],"scroll-px":[{"scroll-px":W()}],"scroll-py":[{"scroll-py":W()}],"scroll-ps":[{"scroll-ps":W()}],"scroll-pe":[{"scroll-pe":W()}],"scroll-pt":[{"scroll-pt":W()}],"scroll-pr":[{"scroll-pr":W()}],"scroll-pb":[{"scroll-pb":W()}],"scroll-pl":[{"scroll-pl":W()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ss,ts]}],fill:[{fill:["none",...Q()]}],"stroke-w":[{stroke:[vs,Zo,Qi,k0]}],stroke:[{stroke:["none",...Q()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},cE=Q3(oE);function js(...t){return cE(k1(t))}const Ou=C1("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all duration-200 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive relative overflow-hidden active:scale-95",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm hover:shadow-md",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60 shadow-sm hover:shadow-md",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 hover:border-accent-foreground/20",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm hover:shadow-md",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),J=d.forwardRef(({className:t,variant:s,size:r,asChild:n=!1,...a},l)=>{const c=n?j1:"button";return e.jsx(c,{"data-slot":"button",className:js(Ou({variant:s,size:r,className:t})),ref:l,...a})});J.displayName="Button";function Js({className:t,type:s,...r}){return e.jsx("input",{type:s,"data-slot":"input",className:js("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-all duration-200 outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:shadow-sm","hover:border-ring/50","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...r})}function dE(t,s){const r=d.createContext(s),n=l=>{const{children:c,...u}=l,f=d.useMemo(()=>u,Object.values(u));return e.jsx(r.Provider,{value:f,children:c})};n.displayName=t+"Provider";function a(l){const c=d.useContext(r);if(c)return c;if(s!==void 0)return s;throw new Error(`\`${l}\` must be used within \`${t}\``)}return[n,a]}function Ga(t,s=[]){let r=[];function n(l,c){const u=d.createContext(c),f=r.length;r=[...r,c];const h=w=>{const{scope:j,children:C,...k}=w,S=j?.[t]?.[f]||u,_=d.useMemo(()=>k,Object.values(k));return e.jsx(S.Provider,{value:_,children:C})};h.displayName=l+"Provider";function v(w,j){const C=j?.[t]?.[f]||u,k=d.useContext(C);if(k)return k;if(c!==void 0)return c;throw new Error(`\`${w}\` must be used within \`${l}\``)}return[h,v]}const a=()=>{const l=r.map(c=>d.createContext(c));return function(u){const f=u?.[t]||l;return d.useMemo(()=>({[`__scope${t}`]:{...u,[t]:f}}),[u,f])}};return a.scopeName=t,[n,uE(a,...s)]}function uE(...t){const s=t[0];if(t.length===1)return s;const r=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const c=n.reduce((u,{useScope:f,scopeName:h})=>{const w=f(l)[`__scope${h}`];return{...u,...w}},{});return d.useMemo(()=>({[`__scope${s.scopeName}`]:c}),[c])}};return r.scopeName=s.scopeName,r}function rs(t,s,{checkForDefaultPrevented:r=!0}={}){return function(a){if(t?.(a),r===!1||!a.defaultPrevented)return s?.(a)}}var Sr=globalThis?.document?d.useLayoutEffect:()=>{},mE=Ox[" useInsertionEffect ".trim().toString()]||Sr;function Ki({prop:t,defaultProp:s,onChange:r=()=>{},caller:n}){const[a,l,c]=pE({defaultProp:s,onChange:r}),u=t!==void 0,f=u?t:a;{const v=d.useRef(t!==void 0);d.useEffect(()=>{const w=v.current;w!==u&&console.warn(`${n} is changing from ${w?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),v.current=u},[u,n])}const h=d.useCallback(v=>{if(u){const w=xE(v)?v(t):v;w!==t&&c.current?.(w)}else l(v)},[u,t,l,c]);return[f,h]}function pE({defaultProp:t,onChange:s}){const[r,n]=d.useState(t),a=d.useRef(r),l=d.useRef(s);return mE(()=>{l.current=s},[s]),d.useEffect(()=>{a.current!==r&&(l.current?.(r),a.current=r)},[r,a]),[r,n,l]}function xE(t){return typeof t=="function"}function M1(t){const s=d.useRef({value:t,previous:t});return d.useMemo(()=>(s.current.value!==t&&(s.current.previous=s.current.value,s.current.value=t),s.current.previous),[t])}function I1(t){const[s,r]=d.useState(void 0);return Sr(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const l=a[0];let c,u;if("borderBoxSize"in l){const f=l.borderBoxSize,h=Array.isArray(f)?f[0]:f;c=h.inlineSize,u=h.blockSize}else c=t.offsetWidth,u=t.offsetHeight;r({width:c,height:u})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),s}function hE(t,s){return d.useReducer((r,n)=>s[r][n]??r,t)}var aa=t=>{const{present:s,children:r}=t,n=fE(s),a=typeof r=="function"?r({present:n.isPresent}):d.Children.only(r),l=Ts(n.ref,gE(a));return typeof r=="function"||n.isPresent?d.cloneElement(a,{ref:l}):null};aa.displayName="Presence";function fE(t){const[s,r]=d.useState(),n=d.useRef(null),a=d.useRef(t),l=d.useRef("none"),c=t?"mounted":"unmounted",[u,f]=hE(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return d.useEffect(()=>{const h=ru(n.current);l.current=u==="mounted"?h:"none"},[u]),Sr(()=>{const h=n.current,v=a.current;if(v!==t){const j=l.current,C=ru(h);t?f("MOUNT"):C==="none"||h?.display==="none"?f("UNMOUNT"):f(v&&j!==C?"ANIMATION_OUT":"UNMOUNT"),a.current=t}},[t,f]),Sr(()=>{if(s){let h;const v=s.ownerDocument.defaultView??window,w=C=>{const S=ru(n.current).includes(CSS.escape(C.animationName));if(C.target===s&&S&&(f("ANIMATION_END"),!a.current)){const _=s.style.animationFillMode;s.style.animationFillMode="forwards",h=v.setTimeout(()=>{s.style.animationFillMode==="forwards"&&(s.style.animationFillMode=_)})}},j=C=>{C.target===s&&(l.current=ru(n.current))};return s.addEventListener("animationstart",j),s.addEventListener("animationcancel",w),s.addEventListener("animationend",w),()=>{v.clearTimeout(h),s.removeEventListener("animationstart",j),s.removeEventListener("animationcancel",w),s.removeEventListener("animationend",w)}}else f("ANIMATION_END")},[s,f]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:d.useCallback(h=>{n.current=h?getComputedStyle(h):null,r(h)},[])}}function ru(t){return t?.animationName||"none"}function gE(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function yE(t){const s=vE(t),r=d.forwardRef((n,a)=>{const{children:l,...c}=n,u=d.Children.toArray(l),f=u.find(wE);if(f){const h=f.props.children,v=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(s,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,v):null})}return e.jsx(s,{...c,ref:a,children:l})});return r.displayName=`${t}.Slot`,r}function vE(t){const s=d.forwardRef((r,n)=>{const{children:a,...l}=r;if(d.isValidElement(a)){const c=jE(a),u=NE(l,a.props);return a.type!==d.Fragment&&(u.ref=n?ka(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var bE=Symbol("radix.slottable");function wE(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===bE}function NE(t,s){const r={...s};for(const n in s){const a=t[n],l=s[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(r[n]=a):n==="style"?r[n]={...a,...l}:n==="className"&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...t,...r}}function jE(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var SE=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],bs=SE.reduce((t,s)=>{const r=yE(`Primitive.${s}`),n=d.forwardRef((a,l)=>{const{asChild:c,...u}=a,f=c?r:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(f,{...u,ref:l})});return n.displayName=`Primitive.${s}`,{...t,[s]:n}},{});function q1(t,s){t&&Ec.flushSync(()=>t.dispatchEvent(s))}var om="Checkbox",[kE]=Ga(om),[CE,$x]=kE(om);function _E(t){const{__scopeCheckbox:s,checked:r,children:n,defaultChecked:a,disabled:l,form:c,name:u,onCheckedChange:f,required:h,value:v="on",internal_do_not_use_render:w}=t,[j,C]=Ki({prop:r,defaultProp:a??!1,onChange:f,caller:om}),[k,S]=d.useState(null),[_,I]=d.useState(null),F=d.useRef(!1),B=k?!!c||!!k.closest("form"):!0,q={checked:j,disabled:l,setChecked:C,control:k,setControl:S,name:u,form:c,value:v,hasConsumerStoppedPropagationRef:F,required:h,defaultChecked:wi(a)?!1:a,isFormControl:B,bubbleInput:_,setBubbleInput:I};return e.jsx(CE,{scope:s,...q,children:EE(w)?w(q):n})}var B1="CheckboxTrigger",z1=d.forwardRef(({__scopeCheckbox:t,onKeyDown:s,onClick:r,...n},a)=>{const{control:l,value:c,disabled:u,checked:f,required:h,setControl:v,setChecked:w,hasConsumerStoppedPropagationRef:j,isFormControl:C,bubbleInput:k}=$x(B1,t),S=Ts(a,v),_=d.useRef(f);return d.useEffect(()=>{const I=l?.form;if(I){const F=()=>w(_.current);return I.addEventListener("reset",F),()=>I.removeEventListener("reset",F)}},[l,w]),e.jsx(bs.button,{type:"button",role:"checkbox","aria-checked":wi(f)?"mixed":f,"aria-required":h,"data-state":G1(f),"data-disabled":u?"":void 0,disabled:u,value:c,...n,ref:S,onKeyDown:rs(s,I=>{I.key==="Enter"&&I.preventDefault()}),onClick:rs(r,I=>{w(F=>wi(F)?!0:!F),k&&C&&(j.current=I.isPropagationStopped(),j.current||I.stopPropagation())})})});z1.displayName=B1;var $1=d.forwardRef((t,s)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:l,required:c,disabled:u,value:f,onCheckedChange:h,form:v,...w}=t;return e.jsx(_E,{__scopeCheckbox:r,checked:a,defaultChecked:l,disabled:u,required:c,onCheckedChange:h,name:n,form:v,value:f,internal_do_not_use_render:({isFormControl:j})=>e.jsxs(e.Fragment,{children:[e.jsx(z1,{...w,ref:s,__scopeCheckbox:r}),j&&e.jsx(W1,{__scopeCheckbox:r})]})})});$1.displayName=om;var Q1="CheckboxIndicator",U1=d.forwardRef((t,s)=>{const{__scopeCheckbox:r,forceMount:n,...a}=t,l=$x(Q1,r);return e.jsx(aa,{present:n||wi(l.checked)||l.checked===!0,children:e.jsx(bs.span,{"data-state":G1(l.checked),"data-disabled":l.disabled?"":void 0,...a,ref:s,style:{pointerEvents:"none",...t.style}})})});U1.displayName=Q1;var V1="CheckboxBubbleInput",W1=d.forwardRef(({__scopeCheckbox:t,...s},r)=>{const{control:n,hasConsumerStoppedPropagationRef:a,checked:l,defaultChecked:c,required:u,disabled:f,name:h,value:v,form:w,bubbleInput:j,setBubbleInput:C}=$x(V1,t),k=Ts(r,C),S=M1(l),_=I1(n);d.useEffect(()=>{const F=j;if(!F)return;const B=window.HTMLInputElement.prototype,me=Object.getOwnPropertyDescriptor(B,"checked").set,re=!a.current;if(S!==l&&me){const M=new Event("click",{bubbles:re});F.indeterminate=wi(l),me.call(F,wi(l)?!1:l),F.dispatchEvent(M)}},[j,S,l,a]);const I=d.useRef(wi(l)?!1:l);return e.jsx(bs.input,{type:"checkbox","aria-hidden":!0,defaultChecked:c??I.current,required:u,disabled:f,name:h,value:v,form:w,...s,tabIndex:-1,ref:k,style:{...s.style,..._,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});W1.displayName=V1;function EE(t){return typeof t=="function"}function wi(t){return t==="indeterminate"}function G1(t){return wi(t)?"indeterminate":t?"checked":"unchecked"}/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AE=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,r,n)=>n?n.toUpperCase():r.toLowerCase()),cv=t=>{const s=AE(t);return s.charAt(0).toUpperCase()+s.slice(1)},H1=(...t)=>t.filter((s,r,n)=>!!s&&s.trim()!==""&&n.indexOf(s)===r).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var TE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=d.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:l,iconNode:c,...u},f)=>d.createElement("svg",{ref:f,...TE,width:s,height:s,stroke:t,strokeWidth:n?Number(r)*24/Number(s):r,className:H1("lucide",a),...u},[...c.map(([h,v])=>d.createElement(h,v)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=(t,s)=>{const r=d.forwardRef(({className:n,...a},l)=>d.createElement(OE,{ref:l,iconNode:s,className:H1(`lucide-${PE(cv(t))}`,`lucide-${t}`,n),...a}));return r.displayName=cv(t),r};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],cm=Ps("arrow-left",RE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],qr=Ps("arrow-right",DE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],FE=Ps("bell",LE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],IE=Ps("calendar",ME);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Y1=Ps("check",qE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Qx=Ps("chevron-down",BE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zE=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],K1=Ps("chevron-left",zE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],X1=Ps("chevron-right",$E);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QE=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],J1=Ps("chevron-up",QE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],dv=Ps("circle-alert",UE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],WE=Ps("circle-check-big",VE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Z1=Ps("circle-check",GE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],ew=Ps("circle-x",HE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],bu=Ps("clock",YE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KE=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],fs=Ps("download",KE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XE=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],JE=Ps("eye-off",XE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ys=Ps("eye",ZE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],uv=Ps("file-spreadsheet",e4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],s4=Ps("file-text",t4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r4=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],mv=Ps("history",r4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],a4=Ps("log-out",n4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i4=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],lr=Ps("message-square-plus",i4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Wi=Ps("package",l4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],pv=Ps("plus",o4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],hs=Ps("printer",c4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],tw=Ps("refresh-cw",d4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],sw=Ps("search",u4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4=[["path",{d:"M7 18v-6a5 5 0 1 1 10 0v6",key:"pcx96s"}],["path",{d:"M5 21a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-1a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2z",key:"1b4s83"}],["path",{d:"M21 12h1",key:"jtio3y"}],["path",{d:"M18.5 4.5 18 5",key:"g5sp9y"}],["path",{d:"M2 12h1",key:"1uaihz"}],["path",{d:"M12 2v1",key:"11qlp1"}],["path",{d:"m4.929 4.929.707.707",key:"1i51kw"}],["path",{d:"M12 12v6",key:"3ahymv"}]],ys=Ps("siren",m4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],x4=Ps("sliders-horizontal",p4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],f4=Ps("triangle-alert",h4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g4=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],y4=Ps("upload",g4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v4=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ux=Ps("x",v4);function Vs({className:t,...s}){return e.jsx($1,{"data-slot":"checkbox",className:js("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx(U1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(Y1,{className:"size-3.5"})})})}const rw="/assets/gm-logo-CDaWe3Uk.png",b4=({onLogin:t})=>{const[s,r]=d.useState(!1),[n,a]=d.useState(!1),[l,c]=d.useState(""),[u,f]=d.useState(""),[h,v]=d.useState(""),[w,j]=d.useState(!1),[C,k]=d.useState(""),S=Pn(),_=async F=>{F.preventDefault(),j(!0),k("");try{const B=await w3(u,h);if(B?.status===!0&&B?.data){const{user:q,token:me}=B.data;localStorage.setItem("user",JSON.stringify(q)),localStorage.setItem("token",me);const re=q&&(q.role?.name||q.role)||"",M=I(String(re),l);t&&t(),S(`/${M}`)}else k("Invalid username or password")}catch{k("Invalid username or password")}finally{j(!1)}};function I(F,B){const q=(F||"").toLowerCase().replace(/\s+/g,"-"),me=N3(B),re=[q,me];for(const M of re)if(M){if(M==="admin")return"admin";if(M==="planning"||M.startsWith("planning"))return"planning";if(M==="material-issue"||M.startsWith("materialissue"))return"material-issue";if(M==="semi-qc"||M.startsWith("semiqc"))return"semi-qc";if(M==="phosphating"||M==="phosphating-qc"||M.startsWith("phosp"))return"phosphating";if(M==="assembly-a"||M.startsWith("assembly-a"))return"assembly-a";if(M==="assembly-b"||M.startsWith("assembly-b"))return"assembly-b";if(M==="assembly-c"||M.startsWith("assembly-c"))return"assembly-c";if(M==="assembly-d"||M.startsWith("assembly-d"))return"assembly-d";if(M==="assembly")return"assembly-a";if(M==="svs"||M.startsWith("svs"))return"svs";if(M==="tpi"||M.startsWith("tpi"))return"tpi";if(M==="dispatch"||M.startsWith("dispatch"))return"dispatch";if(M==="testing"||M==="testing1"||M.startsWith("testing1"))return"testing1";if(M==="testing2"||M.startsWith("testing2"))return"testing2";if(M==="marking"||M==="marking1"||M.startsWith("marking1"))return"marking1";if(M==="marking2"||M.startsWith("marking2"))return"marking2";if(M==="pdi"||M==="pdi1"||M.startsWith("pdi1"))return"pdi1";if(M==="pdi2"||M.startsWith("pdi2"))return"pdi2";if(M==="customer-support"||M.startsWith("customersupport"))return"customer-support"}return"planning"}return e.jsxs("form",{onSubmit:_,className:"space-y-6 animate-fade-in",children:[e.jsx("div",{className:"mb-2 animate-fade-in",children:e.jsx("img",{src:rw,alt:"GM Logo",className:"h-16 w-auto object-contain hover:scale-110 transition-transform duration-300"})}),e.jsxs("div",{className:"space-y-2 animate-fade-in-up",style:{animationDelay:"0.1s"},children:[e.jsx("h1",{className:"text-gray-900 font-semibold text-xl",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-600",children:"Log in to continue to your workspace."})]}),C&&e.jsx("p",{className:"text-red-500 bg-red-50 border border-red-200 rounded-lg py-2 text-center animate-fade-in-up",children:C}),e.jsxs("div",{className:"space-y-2 animate-fade-in-up",style:{animationDelay:"0.1s"},children:[e.jsx("label",{htmlFor:"email",className:"text-gray-700 text-sm font-medium",children:"Username or Email"}),e.jsx(Js,{type:"text",placeholder:"Enter username or email",value:u,onChange:F=>f(F.target.value),required:!0,className:"rounded-3xl h-12 px-4 bg-white/80 border-2 border-gray-200 hover:border-[#174a9f]/50 focus:border-[#174a9f] focus:ring-2 focus:ring-[#174a9f]/20 transition-all duration-300 shadow-sm hover:shadow-md"})]}),e.jsxs("div",{className:"space-y-2 animate-fade-in-up",style:{animationDelay:"0.2s"},children:[e.jsx("label",{htmlFor:"password",className:"text-gray-700 text-sm font-medium",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Js,{id:"password",type:s?"text":"password",placeholder:"Enter your password",value:h,onChange:F=>v(F.target.value),required:!0,className:"rounded-3xl h-12 px-4 pr-12 bg-white/80 border-2 border-gray-200 hover:border-[#174a9f]/50 focus:border-[#174a9f] focus:ring-2 focus:ring-[#174a9f]/20 transition-all duration-300 shadow-sm hover:shadow-md"}),e.jsx("button",{type:"button",onClick:()=>r(!s),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-[#174a9f] transition-all duration-300 hover:scale-110",children:s?e.jsx(JE,{size:20}):e.jsx(Ys,{size:20})})]})]}),e.jsx("div",{className:"flex items-center justify-between animate-fade-in-up",style:{animationDelay:"0.25s"},children:e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer group",children:[e.jsx(Vs,{checked:n,onCheckedChange:a,className:"rounded border-2 hover:border-[#174a9f] transition-all duration-300"}),e.jsx("span",{className:"text-gray-600 group-hover:text-[#174a9f] transition-colors duration-300",children:"Remember me"})]})}),e.jsxs(J,{type:"submit",className:"w-full h-12 rounded-3xl bg-gradient-to-r from-[#2461c7] to-[#174a9f] hover:from-[#174a9f] hover:to-[#123a7f] text-white border-0 shadow-lg hover:shadow-2xl transition-all duration-300 relative overflow-hidden group hover:-translate-y-1 active:translate-y-0 animate-fade-in-up",style:{animationDelay:"0.3s"},children:[e.jsx("span",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"}),e.jsxs("span",{className:"relative z-10 flex items-center justify-center gap-2",children:[w?"Logging in...":"Sign In",e.jsx("span",{className:"text-lg group-hover:translate-x-1 transition-transform duration-300",children:""})]})]})]})},w4="/assets/8d0931fbd565c8647b87305fabaa79cd19ae515f-nOF_erTR.png";function N4(){return e.jsxs("div",{className:"relative h-full w-full overflow-hidden bg-gradient-to-br from-[#0d2a5f] via-[#174a9f] to-[#2461c7]",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat transform hover:scale-105 transition-transform duration-700",style:{backgroundImage:`url('${w4}')`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#174a9f]/30 via-[#0d2a5f]/40 to-[#174a9f]/50"}),e.jsx("div",{className:"absolute top-20 right-20 w-64 h-64 bg-white/5 rounded-full blur-3xl animate-pulse-soft"}),e.jsx("div",{className:"absolute bottom-40 left-20 w-96 h-96 bg-indigo-400/10 rounded-full blur-3xl animate-float"}),e.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:`linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px),
                         linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)`,backgroundSize:"50px 50px"}}),e.jsxs("div",{className:"absolute bottom-12 left-12 text-white space-y-6 max-w-lg",children:[e.jsxs("div",{className:"space-y-3 animate-fade-in-up",children:[e.jsx("div",{className:"inline-block px-4 py-2 bg-white/10 backdrop-blur-md rounded-full border border-white/20 text-sm",children:" Manufacturing Excellence"}),e.jsx("h2",{className:"text-5xl mb-3 leading-tight bg-gradient-to-r from-white to-blue-100 bg-clip-text text-transparent",children:"Industrial Excellence"}),e.jsx("p",{className:"text-white/90 text-xl",children:"Precision Engineering Solutions"})]}),e.jsxs("div",{className:"flex gap-3 animate-fade-in-up",style:{animationDelay:"0.2s"},children:[e.jsx("div",{className:"px-4 py-2 bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 text-sm hover:bg-white/20 transition-all duration-300 hover:-translate-y-1",children:" Real-time Tracking"}),e.jsx("div",{className:"px-4 py-2 bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 text-sm hover:bg-white/20 transition-all duration-300 hover:-translate-y-1",children:" Quality Control"})]})]}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-white/10 to-transparent"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-tr from-white/10 to-transparent"})]})}function j4({onLogin:t}){return e.jsxs("div",{className:"min-h-screen flex",children:[e.jsx("div",{className:"flex-1 relative hidden lg:block",children:e.jsx(N4,{})}),e.jsxs("div",{className:"flex-1 flex items-center justify-center px-8 py-12 background-accent-blue relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 background-accent-blue"}),e.jsx("div",{className:"background-glow-top animate-pulse-soft"}),e.jsx("div",{className:"background-glow-bottom animate-pulse-soft",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-32 h-32 bg-[#174a9f]/10 rounded-full blur-3xl animate-float"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-40 h-40 bg-indigo-400/10 rounded-full blur-3xl animate-float",style:{animationDelay:"1.5s"}}),e.jsx("div",{className:"relative w-full max-w-md form-card animate-scale-in hover:shadow-2xl transition-shadow duration-500",children:e.jsx(b4,{onLogin:t})})]})]})}const nw=d.createContext(void 0);function S4({children:t}){const[s,r]=d.useState({}),[n,a]=d.useState({}),l=(h,v)=>{r(w=>({...w,[h]:v}))},c=h=>{a(v=>({...v,[h]:!v[h]}))},u=h=>s[h]||"",f=h=>n[h]||!1;return e.jsx(nw.Provider,{value:{remarks:s,alertStatuses:n,updateRemark:l,toggleAlertStatus:c,getRemark:u,getAlertStatus:f},children:t})}function yr(){const t=d.useContext(nw);if(t===void 0)throw new Error("useOrderContext must be used within an OrderProvider");return t}const hr=({allowedRole:t,children:s})=>{const r=localStorage.getItem("user");if(!r)return e.jsx(Au,{to:"/login",replace:!0});const n=JSON.parse(r),a=typeof n.role=="object"?n.role.name:n.role,l=v=>(v||"").toLowerCase().replace(/\s+/g,"-"),u=(v=>{switch(v){case"phosphating-qc":return"phosphating";case"assemblya":return"assembly-a";case"assemblyb":return"assembly-b";case"assemblyc":return"assembly-c";case"assemblyd":return"assembly-d";default:return v}})(l(a)),f=l(t);return u==="admin"||u==="planning"?e.jsx(e.Fragment,{children:s}):u===f?e.jsx(e.Fragment,{children:s}):((v,w)=>!!(v==="testing"&&(w==="testing1"||w==="testing2")||v==="marking"&&(w==="marking1"||w==="marking2")||v==="pdi"&&(w==="pdi1"||w==="pdi2")||v==="testing1"&&w==="assembly-a"||v==="assembly-a"&&w==="testing1"||v.startsWith("assembly-")&&w==="assembly-shared"))(u,f)?e.jsx(e.Fragment,{children:s}):u!==f?e.jsx(Au,{to:"/login",replace:!0}):e.jsx(e.Fragment,{children:s})},k4=({children:t})=>localStorage.getItem("user")?e.jsx(e.Fragment,{children:t}):e.jsx(Au,{to:"/login",replace:!0});function aw(t,s){return function(){return t.apply(s,arguments)}}const{toString:C4}=Object.prototype,{getPrototypeOf:Vx}=Object,{iterator:dm,toStringTag:iw}=Symbol,um=(t=>s=>{const r=C4.call(s);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ia=t=>(t=t.toLowerCase(),s=>um(s)===t),mm=t=>s=>typeof s===t,{isArray:lo}=Array,Xl=mm("undefined");function Pc(t){return t!==null&&!Xl(t)&&t.constructor!==null&&!Xl(t.constructor)&&dn(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const lw=ia("ArrayBuffer");function _4(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&lw(t.buffer),s}const E4=mm("string"),dn=mm("function"),ow=mm("number"),Ac=t=>t!==null&&typeof t=="object",P4=t=>t===!0||t===!1,wu=t=>{if(um(t)!=="object")return!1;const s=Vx(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(iw in t)&&!(dm in t)},A4=t=>{if(!Ac(t)||Pc(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},T4=ia("Date"),O4=ia("File"),R4=ia("Blob"),D4=ia("FileList"),L4=t=>Ac(t)&&dn(t.pipe),F4=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||dn(t.append)&&((s=um(t))==="formdata"||s==="object"&&dn(t.toString)&&t.toString()==="[object FormData]"))},M4=ia("URLSearchParams"),[I4,q4,B4,z4]=["ReadableStream","Request","Response","Headers"].map(ia),$4=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Tc(t,s,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,a;if(typeof t!="object"&&(t=[t]),lo(t))for(n=0,a=t.length;n<a;n++)s.call(null,t[n],n,t);else{if(Pc(t))return;const l=r?Object.getOwnPropertyNames(t):Object.keys(t),c=l.length;let u;for(n=0;n<c;n++)u=l[n],s.call(null,t[u],u,t)}}function cw(t,s){if(Pc(t))return null;s=s.toLowerCase();const r=Object.keys(t);let n=r.length,a;for(;n-- >0;)if(a=r[n],s===a.toLowerCase())return a;return null}const Gi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,dw=t=>!Xl(t)&&t!==Gi;function dx(){const{caseless:t,skipUndefined:s}=dw(this)&&this||{},r={},n=(a,l)=>{const c=t&&cw(r,l)||l;wu(r[c])&&wu(a)?r[c]=dx(r[c],a):wu(a)?r[c]=dx({},a):lo(a)?r[c]=a.slice():(!s||!Xl(a))&&(r[c]=a)};for(let a=0,l=arguments.length;a<l;a++)arguments[a]&&Tc(arguments[a],n);return r}const Q4=(t,s,r,{allOwnKeys:n}={})=>(Tc(s,(a,l)=>{r&&dn(a)?t[l]=aw(a,r):t[l]=a},{allOwnKeys:n}),t),U4=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),V4=(t,s,r,n)=>{t.prototype=Object.create(s.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),r&&Object.assign(t.prototype,r)},W4=(t,s,r,n)=>{let a,l,c;const u={};if(s=s||{},t==null)return s;do{for(a=Object.getOwnPropertyNames(t),l=a.length;l-- >0;)c=a[l],(!n||n(c,t,s))&&!u[c]&&(s[c]=t[c],u[c]=!0);t=r!==!1&&Vx(t)}while(t&&(!r||r(t,s))&&t!==Object.prototype);return s},G4=(t,s,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=s.length;const n=t.indexOf(s,r);return n!==-1&&n===r},H4=t=>{if(!t)return null;if(lo(t))return t;let s=t.length;if(!ow(s))return null;const r=new Array(s);for(;s-- >0;)r[s]=t[s];return r},Y4=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&Vx(Uint8Array)),K4=(t,s)=>{const n=(t&&t[dm]).call(t);let a;for(;(a=n.next())&&!a.done;){const l=a.value;s.call(t,l[0],l[1])}},X4=(t,s)=>{let r;const n=[];for(;(r=t.exec(s))!==null;)n.push(r);return n},J4=ia("HTMLFormElement"),Z4=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),xv=(({hasOwnProperty:t})=>(s,r)=>t.call(s,r))(Object.prototype),eP=ia("RegExp"),uw=(t,s)=>{const r=Object.getOwnPropertyDescriptors(t),n={};Tc(r,(a,l)=>{let c;(c=s(a,l,t))!==!1&&(n[l]=c||a)}),Object.defineProperties(t,n)},tP=t=>{uw(t,(s,r)=>{if(dn(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(dn(n)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},sP=(t,s)=>{const r={},n=a=>{a.forEach(l=>{r[l]=!0})};return lo(t)?n(t):n(String(t).split(s)),r},rP=()=>{},nP=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s;function aP(t){return!!(t&&dn(t.append)&&t[iw]==="FormData"&&t[dm])}const iP=t=>{const s=new Array(10),r=(n,a)=>{if(Ac(n)){if(s.indexOf(n)>=0)return;if(Pc(n))return n;if(!("toJSON"in n)){s[a]=n;const l=lo(n)?[]:{};return Tc(n,(c,u)=>{const f=r(c,a+1);!Xl(f)&&(l[u]=f)}),s[a]=void 0,l}}return n};return r(t,0)},lP=ia("AsyncFunction"),oP=t=>t&&(Ac(t)||dn(t))&&dn(t.then)&&dn(t.catch),mw=((t,s)=>t?setImmediate:s?((r,n)=>(Gi.addEventListener("message",({source:a,data:l})=>{a===Gi&&l===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Gi.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",dn(Gi.postMessage)),cP=typeof queueMicrotask<"u"?queueMicrotask.bind(Gi):typeof process<"u"&&process.nextTick||mw,dP=t=>t!=null&&dn(t[dm]),Xe={isArray:lo,isArrayBuffer:lw,isBuffer:Pc,isFormData:F4,isArrayBufferView:_4,isString:E4,isNumber:ow,isBoolean:P4,isObject:Ac,isPlainObject:wu,isEmptyObject:A4,isReadableStream:I4,isRequest:q4,isResponse:B4,isHeaders:z4,isUndefined:Xl,isDate:T4,isFile:O4,isBlob:R4,isRegExp:eP,isFunction:dn,isStream:L4,isURLSearchParams:M4,isTypedArray:Y4,isFileList:D4,forEach:Tc,merge:dx,extend:Q4,trim:$4,stripBOM:U4,inherits:V4,toFlatObject:W4,kindOf:um,kindOfTest:ia,endsWith:G4,toArray:H4,forEachEntry:K4,matchAll:X4,isHTMLForm:J4,hasOwnProperty:xv,hasOwnProp:xv,reduceDescriptors:uw,freezeMethods:tP,toObjectSet:sP,toCamelCase:Z4,noop:rP,toFiniteNumber:nP,findKey:cw,global:Gi,isContextDefined:dw,isSpecCompliantForm:aP,toJSONObject:iP,isAsyncFn:lP,isThenable:oP,setImmediate:mw,asap:cP,isIterable:dP};function xs(t,s,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}Xe.inherits(xs,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Xe.toJSONObject(this.config),code:this.code,status:this.status}}});const pw=xs.prototype,xw={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{xw[t]={value:t}});Object.defineProperties(xs,xw);Object.defineProperty(pw,"isAxiosError",{value:!0});xs.from=(t,s,r,n,a,l)=>{const c=Object.create(pw);Xe.toFlatObject(t,c,function(v){return v!==Error.prototype},h=>h!=="isAxiosError");const u=t&&t.message?t.message:"Error",f=s==null&&t?t.code:s;return xs.call(c,u,f,r,n,a),t&&c.cause==null&&Object.defineProperty(c,"cause",{value:t,configurable:!0}),c.name=t&&t.name||"Error",l&&Object.assign(c,l),c};const uP=null;function ux(t){return Xe.isPlainObject(t)||Xe.isArray(t)}function hw(t){return Xe.endsWith(t,"[]")?t.slice(0,-2):t}function hv(t,s,r){return t?t.concat(s).map(function(a,l){return a=hw(a),!r&&l?"["+a+"]":a}).join(r?".":""):s}function mP(t){return Xe.isArray(t)&&!t.some(ux)}const pP=Xe.toFlatObject(Xe,{},null,function(s){return/^is[A-Z]/.test(s)});function pm(t,s,r){if(!Xe.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,r=Xe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,_){return!Xe.isUndefined(_[S])});const n=r.metaTokens,a=r.visitor||v,l=r.dots,c=r.indexes,f=(r.Blob||typeof Blob<"u"&&Blob)&&Xe.isSpecCompliantForm(s);if(!Xe.isFunction(a))throw new TypeError("visitor must be a function");function h(k){if(k===null)return"";if(Xe.isDate(k))return k.toISOString();if(Xe.isBoolean(k))return k.toString();if(!f&&Xe.isBlob(k))throw new xs("Blob is not supported. Use a Buffer instead.");return Xe.isArrayBuffer(k)||Xe.isTypedArray(k)?f&&typeof Blob=="function"?new Blob([k]):Buffer.from(k):k}function v(k,S,_){let I=k;if(k&&!_&&typeof k=="object"){if(Xe.endsWith(S,"{}"))S=n?S:S.slice(0,-2),k=JSON.stringify(k);else if(Xe.isArray(k)&&mP(k)||(Xe.isFileList(k)||Xe.endsWith(S,"[]"))&&(I=Xe.toArray(k)))return S=hw(S),I.forEach(function(B,q){!(Xe.isUndefined(B)||B===null)&&s.append(c===!0?hv([S],q,l):c===null?S:S+"[]",h(B))}),!1}return ux(k)?!0:(s.append(hv(_,S,l),h(k)),!1)}const w=[],j=Object.assign(pP,{defaultVisitor:v,convertValue:h,isVisitable:ux});function C(k,S){if(!Xe.isUndefined(k)){if(w.indexOf(k)!==-1)throw Error("Circular reference detected in "+S.join("."));w.push(k),Xe.forEach(k,function(I,F){(!(Xe.isUndefined(I)||I===null)&&a.call(s,I,Xe.isString(F)?F.trim():F,S,j))===!0&&C(I,S?S.concat(F):[F])}),w.pop()}}if(!Xe.isObject(t))throw new TypeError("data must be an object");return C(t),s}function fv(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return s[n]})}function Wx(t,s){this._pairs=[],t&&pm(t,this,s)}const fw=Wx.prototype;fw.append=function(s,r){this._pairs.push([s,r])};fw.toString=function(s){const r=s?function(n){return s.call(this,n,fv)}:fv;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function xP(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function gw(t,s,r){if(!s)return t;const n=r&&r.encode||xP;Xe.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let l;if(a?l=a(s,r):l=Xe.isURLSearchParams(s)?s.toString():new Wx(s,r).toString(n),l){const c=t.indexOf("#");c!==-1&&(t=t.slice(0,c)),t+=(t.indexOf("?")===-1?"?":"&")+l}return t}class gv{constructor(){this.handlers=[]}use(s,r,n){return this.handlers.push({fulfilled:s,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){Xe.forEach(this.handlers,function(n){n!==null&&s(n)})}}const yw={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},hP=typeof URLSearchParams<"u"?URLSearchParams:Wx,fP=typeof FormData<"u"?FormData:null,gP=typeof Blob<"u"?Blob:null,yP={isBrowser:!0,classes:{URLSearchParams:hP,FormData:fP,Blob:gP},protocols:["http","https","file","blob","url","data"]},Gx=typeof window<"u"&&typeof document<"u",mx=typeof navigator=="object"&&navigator||void 0,vP=Gx&&(!mx||["ReactNative","NativeScript","NS"].indexOf(mx.product)<0),bP=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",wP=Gx&&window.location.href||"http://localhost",NP=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Gx,hasStandardBrowserEnv:vP,hasStandardBrowserWebWorkerEnv:bP,navigator:mx,origin:wP},Symbol.toStringTag,{value:"Module"})),Vr={...NP,...yP};function jP(t,s){return pm(t,new Vr.classes.URLSearchParams,{visitor:function(r,n,a,l){return Vr.isNode&&Xe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...s})}function SP(t){return Xe.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function kP(t){const s={},r=Object.keys(t);let n;const a=r.length;let l;for(n=0;n<a;n++)l=r[n],s[l]=t[l];return s}function vw(t){function s(r,n,a,l){let c=r[l++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),f=l>=r.length;return c=!c&&Xe.isArray(a)?a.length:c,f?(Xe.hasOwnProp(a,c)?a[c]=[a[c],n]:a[c]=n,!u):((!a[c]||!Xe.isObject(a[c]))&&(a[c]=[]),s(r,n,a[c],l)&&Xe.isArray(a[c])&&(a[c]=kP(a[c])),!u)}if(Xe.isFormData(t)&&Xe.isFunction(t.entries)){const r={};return Xe.forEachEntry(t,(n,a)=>{s(SP(n),a,r,0)}),r}return null}function CP(t,s,r){if(Xe.isString(t))try{return(s||JSON.parse)(t),Xe.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const Oc={transitional:yw,adapter:["xhr","http","fetch"],transformRequest:[function(s,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,l=Xe.isObject(s);if(l&&Xe.isHTMLForm(s)&&(s=new FormData(s)),Xe.isFormData(s))return a?JSON.stringify(vw(s)):s;if(Xe.isArrayBuffer(s)||Xe.isBuffer(s)||Xe.isStream(s)||Xe.isFile(s)||Xe.isBlob(s)||Xe.isReadableStream(s))return s;if(Xe.isArrayBufferView(s))return s.buffer;if(Xe.isURLSearchParams(s))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let u;if(l){if(n.indexOf("application/x-www-form-urlencoded")>-1)return jP(s,this.formSerializer).toString();if((u=Xe.isFileList(s))||n.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return pm(u?{"files[]":s}:s,f&&new f,this.formSerializer)}}return l||a?(r.setContentType("application/json",!1),CP(s)):s}],transformResponse:[function(s){const r=this.transitional||Oc.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(Xe.isResponse(s)||Xe.isReadableStream(s))return s;if(s&&Xe.isString(s)&&(n&&!this.responseType||a)){const c=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(s,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?xs.from(u,xs.ERR_BAD_RESPONSE,this,null,this.response):u}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Vr.classes.FormData,Blob:Vr.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Xe.forEach(["delete","get","head","post","put","patch"],t=>{Oc.headers[t]={}});const _P=Xe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),EP=t=>{const s={};let r,n,a;return t&&t.split(`
`).forEach(function(c){a=c.indexOf(":"),r=c.substring(0,a).trim().toLowerCase(),n=c.substring(a+1).trim(),!(!r||s[r]&&_P[r])&&(r==="set-cookie"?s[r]?s[r].push(n):s[r]=[n]:s[r]=s[r]?s[r]+", "+n:n)}),s},yv=Symbol("internals");function ec(t){return t&&String(t).trim().toLowerCase()}function Nu(t){return t===!1||t==null?t:Xe.isArray(t)?t.map(Nu):String(t)}function PP(t){const s=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)s[n[1]]=n[2];return s}const AP=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function C0(t,s,r,n,a){if(Xe.isFunction(n))return n.call(this,s,r);if(a&&(s=r),!!Xe.isString(s)){if(Xe.isString(n))return s.indexOf(n)!==-1;if(Xe.isRegExp(n))return n.test(s)}}function TP(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,r,n)=>r.toUpperCase()+n)}function OP(t,s){const r=Xe.toCamelCase(" "+s);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(a,l,c){return this[n].call(this,s,a,l,c)},configurable:!0})})}let un=class{constructor(s){s&&this.set(s)}set(s,r,n){const a=this;function l(u,f,h){const v=ec(f);if(!v)throw new Error("header name must be a non-empty string");const w=Xe.findKey(a,v);(!w||a[w]===void 0||h===!0||h===void 0&&a[w]!==!1)&&(a[w||f]=Nu(u))}const c=(u,f)=>Xe.forEach(u,(h,v)=>l(h,v,f));if(Xe.isPlainObject(s)||s instanceof this.constructor)c(s,r);else if(Xe.isString(s)&&(s=s.trim())&&!AP(s))c(EP(s),r);else if(Xe.isObject(s)&&Xe.isIterable(s)){let u={},f,h;for(const v of s){if(!Xe.isArray(v))throw TypeError("Object iterator must return a key-value pair");u[h=v[0]]=(f=u[h])?Xe.isArray(f)?[...f,v[1]]:[f,v[1]]:v[1]}c(u,r)}else s!=null&&l(r,s,n);return this}get(s,r){if(s=ec(s),s){const n=Xe.findKey(this,s);if(n){const a=this[n];if(!r)return a;if(r===!0)return PP(a);if(Xe.isFunction(r))return r.call(this,a,n);if(Xe.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,r){if(s=ec(s),s){const n=Xe.findKey(this,s);return!!(n&&this[n]!==void 0&&(!r||C0(this,this[n],n,r)))}return!1}delete(s,r){const n=this;let a=!1;function l(c){if(c=ec(c),c){const u=Xe.findKey(n,c);u&&(!r||C0(n,n[u],u,r))&&(delete n[u],a=!0)}}return Xe.isArray(s)?s.forEach(l):l(s),a}clear(s){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const l=r[n];(!s||C0(this,this[l],l,s,!0))&&(delete this[l],a=!0)}return a}normalize(s){const r=this,n={};return Xe.forEach(this,(a,l)=>{const c=Xe.findKey(n,l);if(c){r[c]=Nu(a),delete r[l];return}const u=s?TP(l):String(l).trim();u!==l&&delete r[l],r[u]=Nu(a),n[u]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const r=Object.create(null);return Xe.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=s&&Xe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,r])=>s+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...r){const n=new this(s);return r.forEach(a=>n.set(a)),n}static accessor(s){const n=(this[yv]=this[yv]={accessors:{}}).accessors,a=this.prototype;function l(c){const u=ec(c);n[u]||(OP(a,c),n[u]=!0)}return Xe.isArray(s)?s.forEach(l):l(s),this}};un.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Xe.reduceDescriptors(un.prototype,({value:t},s)=>{let r=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(n){this[r]=n}}});Xe.freezeMethods(un);function _0(t,s){const r=this||Oc,n=s||r,a=un.from(n.headers);let l=n.data;return Xe.forEach(t,function(u){l=u.call(r,l,a.normalize(),s?s.status:void 0)}),a.normalize(),l}function bw(t){return!!(t&&t.__CANCEL__)}function oo(t,s,r){xs.call(this,t??"canceled",xs.ERR_CANCELED,s,r),this.name="CanceledError"}Xe.inherits(oo,xs,{__CANCEL__:!0});function ww(t,s,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):s(new xs("Request failed with status code "+r.status,[xs.ERR_BAD_REQUEST,xs.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function RP(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function DP(t,s){t=t||10;const r=new Array(t),n=new Array(t);let a=0,l=0,c;return s=s!==void 0?s:1e3,function(f){const h=Date.now(),v=n[l];c||(c=h),r[a]=f,n[a]=h;let w=l,j=0;for(;w!==a;)j+=r[w++],w=w%t;if(a=(a+1)%t,a===l&&(l=(l+1)%t),h-c<s)return;const C=v&&h-v;return C?Math.round(j*1e3/C):void 0}}function LP(t,s){let r=0,n=1e3/s,a,l;const c=(h,v=Date.now())=>{r=v,a=null,l&&(clearTimeout(l),l=null),t(...h)};return[(...h)=>{const v=Date.now(),w=v-r;w>=n?c(h,v):(a=h,l||(l=setTimeout(()=>{l=null,c(a)},n-w)))},()=>a&&c(a)]}const Ru=(t,s,r=3)=>{let n=0;const a=DP(50,250);return LP(l=>{const c=l.loaded,u=l.lengthComputable?l.total:void 0,f=c-n,h=a(f),v=c<=u;n=c;const w={loaded:c,total:u,progress:u?c/u:void 0,bytes:f,rate:h||void 0,estimated:h&&u&&v?(u-c)/h:void 0,event:l,lengthComputable:u!=null,[s?"download":"upload"]:!0};t(w)},r)},vv=(t,s)=>{const r=t!=null;return[n=>s[0]({lengthComputable:r,total:t,loaded:n}),s[1]]},bv=t=>(...s)=>Xe.asap(()=>t(...s)),FP=Vr.hasStandardBrowserEnv?((t,s)=>r=>(r=new URL(r,Vr.origin),t.protocol===r.protocol&&t.host===r.host&&(s||t.port===r.port)))(new URL(Vr.origin),Vr.navigator&&/(msie|trident)/i.test(Vr.navigator.userAgent)):()=>!0,MP=Vr.hasStandardBrowserEnv?{write(t,s,r,n,a,l,c){if(typeof document>"u")return;const u=[`${t}=${encodeURIComponent(s)}`];Xe.isNumber(r)&&u.push(`expires=${new Date(r).toUTCString()}`),Xe.isString(n)&&u.push(`path=${n}`),Xe.isString(a)&&u.push(`domain=${a}`),l===!0&&u.push("secure"),Xe.isString(c)&&u.push(`SameSite=${c}`),document.cookie=u.join("; ")},read(t){if(typeof document>"u")return null;const s=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return s?decodeURIComponent(s[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function IP(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function qP(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function Nw(t,s,r){let n=!IP(s);return t&&(n||r==!1)?qP(t,s):s}const wv=t=>t instanceof un?{...t}:t;function Xi(t,s){s=s||{};const r={};function n(h,v,w,j){return Xe.isPlainObject(h)&&Xe.isPlainObject(v)?Xe.merge.call({caseless:j},h,v):Xe.isPlainObject(v)?Xe.merge({},v):Xe.isArray(v)?v.slice():v}function a(h,v,w,j){if(Xe.isUndefined(v)){if(!Xe.isUndefined(h))return n(void 0,h,w,j)}else return n(h,v,w,j)}function l(h,v){if(!Xe.isUndefined(v))return n(void 0,v)}function c(h,v){if(Xe.isUndefined(v)){if(!Xe.isUndefined(h))return n(void 0,h)}else return n(void 0,v)}function u(h,v,w){if(w in s)return n(h,v);if(w in t)return n(void 0,h)}const f={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(h,v,w)=>a(wv(h),wv(v),w,!0)};return Xe.forEach(Object.keys({...t,...s}),function(v){const w=f[v]||a,j=w(t[v],s[v],v);Xe.isUndefined(j)&&w!==u||(r[v]=j)}),r}const jw=t=>{const s=Xi({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:l,headers:c,auth:u}=s;if(s.headers=c=un.from(c),s.url=gw(Nw(s.baseURL,s.url,s.allowAbsoluteUrls),t.params,t.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),Xe.isFormData(r)){if(Vr.hasStandardBrowserEnv||Vr.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(Xe.isFunction(r.getHeaders)){const f=r.getHeaders(),h=["content-type","content-length"];Object.entries(f).forEach(([v,w])=>{h.includes(v.toLowerCase())&&c.set(v,w)})}}if(Vr.hasStandardBrowserEnv&&(n&&Xe.isFunction(n)&&(n=n(s)),n||n!==!1&&FP(s.url))){const f=a&&l&&MP.read(l);f&&c.set(a,f)}return s},BP=typeof XMLHttpRequest<"u",zP=BP&&function(t){return new Promise(function(r,n){const a=jw(t);let l=a.data;const c=un.from(a.headers).normalize();let{responseType:u,onUploadProgress:f,onDownloadProgress:h}=a,v,w,j,C,k;function S(){C&&C(),k&&k(),a.cancelToken&&a.cancelToken.unsubscribe(v),a.signal&&a.signal.removeEventListener("abort",v)}let _=new XMLHttpRequest;_.open(a.method.toUpperCase(),a.url,!0),_.timeout=a.timeout;function I(){if(!_)return;const B=un.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),me={data:!u||u==="text"||u==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:B,config:t,request:_};ww(function(M){r(M),S()},function(M){n(M),S()},me),_=null}"onloadend"in _?_.onloadend=I:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(I)},_.onabort=function(){_&&(n(new xs("Request aborted",xs.ECONNABORTED,t,_)),_=null)},_.onerror=function(q){const me=q&&q.message?q.message:"Network Error",re=new xs(me,xs.ERR_NETWORK,t,_);re.event=q||null,n(re),_=null},_.ontimeout=function(){let q=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const me=a.transitional||yw;a.timeoutErrorMessage&&(q=a.timeoutErrorMessage),n(new xs(q,me.clarifyTimeoutError?xs.ETIMEDOUT:xs.ECONNABORTED,t,_)),_=null},l===void 0&&c.setContentType(null),"setRequestHeader"in _&&Xe.forEach(c.toJSON(),function(q,me){_.setRequestHeader(me,q)}),Xe.isUndefined(a.withCredentials)||(_.withCredentials=!!a.withCredentials),u&&u!=="json"&&(_.responseType=a.responseType),h&&([j,k]=Ru(h,!0),_.addEventListener("progress",j)),f&&_.upload&&([w,C]=Ru(f),_.upload.addEventListener("progress",w),_.upload.addEventListener("loadend",C)),(a.cancelToken||a.signal)&&(v=B=>{_&&(n(!B||B.type?new oo(null,t,_):B),_.abort(),_=null)},a.cancelToken&&a.cancelToken.subscribe(v),a.signal&&(a.signal.aborted?v():a.signal.addEventListener("abort",v)));const F=RP(a.url);if(F&&Vr.protocols.indexOf(F)===-1){n(new xs("Unsupported protocol "+F+":",xs.ERR_BAD_REQUEST,t));return}_.send(l||null)})},$P=(t,s)=>{const{length:r}=t=t?t.filter(Boolean):[];if(s||r){let n=new AbortController,a;const l=function(h){if(!a){a=!0,u();const v=h instanceof Error?h:this.reason;n.abort(v instanceof xs?v:new oo(v instanceof Error?v.message:v))}};let c=s&&setTimeout(()=>{c=null,l(new xs(`timeout ${s} of ms exceeded`,xs.ETIMEDOUT))},s);const u=()=>{t&&(c&&clearTimeout(c),c=null,t.forEach(h=>{h.unsubscribe?h.unsubscribe(l):h.removeEventListener("abort",l)}),t=null)};t.forEach(h=>h.addEventListener("abort",l));const{signal:f}=n;return f.unsubscribe=()=>Xe.asap(u),f}},QP=function*(t,s){let r=t.byteLength;if(r<s){yield t;return}let n=0,a;for(;n<r;)a=n+s,yield t.slice(n,a),n=a},UP=async function*(t,s){for await(const r of VP(t))yield*QP(r,s)},VP=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:r,value:n}=await s.read();if(r)break;yield n}}finally{await s.cancel()}},Nv=(t,s,r,n)=>{const a=UP(t,s);let l=0,c,u=f=>{c||(c=!0,n&&n(f))};return new ReadableStream({async pull(f){try{const{done:h,value:v}=await a.next();if(h){u(),f.close();return}let w=v.byteLength;if(r){let j=l+=w;r(j)}f.enqueue(new Uint8Array(v))}catch(h){throw u(h),h}},cancel(f){return u(f),a.return()}},{highWaterMark:2})},jv=64*1024,{isFunction:nu}=Xe,WP=(({Request:t,Response:s})=>({Request:t,Response:s}))(Xe.global),{ReadableStream:Sv,TextEncoder:kv}=Xe.global,Cv=(t,...s)=>{try{return!!t(...s)}catch{return!1}},GP=t=>{t=Xe.merge.call({skipUndefined:!0},WP,t);const{fetch:s,Request:r,Response:n}=t,a=s?nu(s):typeof fetch=="function",l=nu(r),c=nu(n);if(!a)return!1;const u=a&&nu(Sv),f=a&&(typeof kv=="function"?(k=>S=>k.encode(S))(new kv):async k=>new Uint8Array(await new r(k).arrayBuffer())),h=l&&u&&Cv(()=>{let k=!1;const S=new r(Vr.origin,{body:new Sv,method:"POST",get duplex(){return k=!0,"half"}}).headers.has("Content-Type");return k&&!S}),v=c&&u&&Cv(()=>Xe.isReadableStream(new n("").body)),w={stream:v&&(k=>k.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(k=>{!w[k]&&(w[k]=(S,_)=>{let I=S&&S[k];if(I)return I.call(S);throw new xs(`Response type '${k}' is not supported`,xs.ERR_NOT_SUPPORT,_)})});const j=async k=>{if(k==null)return 0;if(Xe.isBlob(k))return k.size;if(Xe.isSpecCompliantForm(k))return(await new r(Vr.origin,{method:"POST",body:k}).arrayBuffer()).byteLength;if(Xe.isArrayBufferView(k)||Xe.isArrayBuffer(k))return k.byteLength;if(Xe.isURLSearchParams(k)&&(k=k+""),Xe.isString(k))return(await f(k)).byteLength},C=async(k,S)=>{const _=Xe.toFiniteNumber(k.getContentLength());return _??j(S)};return async k=>{let{url:S,method:_,data:I,signal:F,cancelToken:B,timeout:q,onDownloadProgress:me,onUploadProgress:re,responseType:M,headers:W,withCredentials:oe="same-origin",fetchOptions:X}=jw(k),he=s||fetch;M=M?(M+"").toLowerCase():"text";let ue=$P([F,B&&B.toAbortSignal()],q),_e=null;const ke=ue&&ue.unsubscribe&&(()=>{ue.unsubscribe()});let Re;try{if(re&&h&&_!=="get"&&_!=="head"&&(Re=await C(W,I))!==0){let ne=new r(S,{method:"POST",body:I,duplex:"half"}),U;if(Xe.isFormData(I)&&(U=ne.headers.get("content-type"))&&W.setContentType(U),ne.body){const[ce,z]=vv(Re,Ru(bv(re)));I=Nv(ne.body,jv,ce,z)}}Xe.isString(oe)||(oe=oe?"include":"omit");const Y=l&&"credentials"in r.prototype,ve={...X,signal:ue,method:_.toUpperCase(),headers:W.normalize().toJSON(),body:I,duplex:"half",credentials:Y?oe:void 0};_e=l&&new r(S,ve);let Q=await(l?he(_e,X):he(S,ve));const be=v&&(M==="stream"||M==="response");if(v&&(me||be&&ke)){const ne={};["status","statusText","headers"].forEach(ae=>{ne[ae]=Q[ae]});const U=Xe.toFiniteNumber(Q.headers.get("content-length")),[ce,z]=me&&vv(U,Ru(bv(me),!0))||[];Q=new n(Nv(Q.body,jv,ce,()=>{z&&z(),ke&&ke()}),ne)}M=M||"text";let pe=await w[Xe.findKey(w,M)||"text"](Q,k);return!be&&ke&&ke(),await new Promise((ne,U)=>{ww(ne,U,{data:pe,headers:un.from(Q.headers),status:Q.status,statusText:Q.statusText,config:k,request:_e})})}catch(Y){throw ke&&ke(),Y&&Y.name==="TypeError"&&/Load failed|fetch/i.test(Y.message)?Object.assign(new xs("Network Error",xs.ERR_NETWORK,k,_e),{cause:Y.cause||Y}):xs.from(Y,Y&&Y.code,k,_e)}}},HP=new Map,Sw=t=>{let s=t&&t.env||{};const{fetch:r,Request:n,Response:a}=s,l=[n,a,r];let c=l.length,u=c,f,h,v=HP;for(;u--;)f=l[u],h=v.get(f),h===void 0&&v.set(f,h=u?new Map:GP(s)),v=h;return h};Sw();const Hx={http:uP,xhr:zP,fetch:{get:Sw}};Xe.forEach(Hx,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const _v=t=>`- ${t}`,YP=t=>Xe.isFunction(t)||t===null||t===!1;function KP(t,s){t=Xe.isArray(t)?t:[t];const{length:r}=t;let n,a;const l={};for(let c=0;c<r;c++){n=t[c];let u;if(a=n,!YP(n)&&(a=Hx[(u=String(n)).toLowerCase()],a===void 0))throw new xs(`Unknown adapter '${u}'`);if(a&&(Xe.isFunction(a)||(a=a.get(s))))break;l[u||"#"+c]=a}if(!a){const c=Object.entries(l).map(([f,h])=>`adapter ${f} `+(h===!1?"is not supported by the environment":"is not available in the build"));let u=r?c.length>1?`since :
`+c.map(_v).join(`
`):" "+_v(c[0]):"as no adapter specified";throw new xs("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return a}const kw={getAdapter:KP,adapters:Hx};function E0(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new oo(null,t)}function Ev(t){return E0(t),t.headers=un.from(t.headers),t.data=_0.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),kw.getAdapter(t.adapter||Oc.adapter,t)(t).then(function(n){return E0(t),n.data=_0.call(t,t.transformResponse,n),n.headers=un.from(n.headers),n},function(n){return bw(n)||(E0(t),n&&n.response&&(n.response.data=_0.call(t,t.transformResponse,n.response),n.response.headers=un.from(n.response.headers))),Promise.reject(n)})}const Cw="1.13.2",xm={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{xm[t]=function(n){return typeof n===t||"a"+(s<1?"n ":" ")+t}});const Pv={};xm.transitional=function(s,r,n){function a(l,c){return"[Axios v"+Cw+"] Transitional option '"+l+"'"+c+(n?". "+n:"")}return(l,c,u)=>{if(s===!1)throw new xs(a(c," has been removed"+(r?" in "+r:"")),xs.ERR_DEPRECATED);return r&&!Pv[c]&&(Pv[c]=!0,console.warn(a(c," has been deprecated since v"+r+" and will be removed in the near future"))),s?s(l,c,u):!0}};xm.spelling=function(s){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${s}`),!0)};function XP(t,s,r){if(typeof t!="object")throw new xs("options must be an object",xs.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let a=n.length;for(;a-- >0;){const l=n[a],c=s[l];if(c){const u=t[l],f=u===void 0||c(u,l,t);if(f!==!0)throw new xs("option "+l+" must be "+f,xs.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new xs("Unknown option "+l,xs.ERR_BAD_OPTION)}}const ju={assertOptions:XP,validators:xm},ma=ju.validators;let Hi=class{constructor(s){this.defaults=s||{},this.interceptors={request:new gv,response:new gv}}async request(s,r){try{return await this._request(s,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const l=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?l&&!String(n.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+l):n.stack=l}catch{}}throw n}}_request(s,r){typeof s=="string"?(r=r||{},r.url=s):r=s||{},r=Xi(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:l}=r;n!==void 0&&ju.assertOptions(n,{silentJSONParsing:ma.transitional(ma.boolean),forcedJSONParsing:ma.transitional(ma.boolean),clarifyTimeoutError:ma.transitional(ma.boolean)},!1),a!=null&&(Xe.isFunction(a)?r.paramsSerializer={serialize:a}:ju.assertOptions(a,{encode:ma.function,serialize:ma.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),ju.assertOptions(r,{baseUrl:ma.spelling("baseURL"),withXsrfToken:ma.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let c=l&&Xe.merge(l.common,l[r.method]);l&&Xe.forEach(["delete","get","head","post","put","patch","common"],k=>{delete l[k]}),r.headers=un.concat(c,l);const u=[];let f=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(r)===!1||(f=f&&S.synchronous,u.unshift(S.fulfilled,S.rejected))});const h=[];this.interceptors.response.forEach(function(S){h.push(S.fulfilled,S.rejected)});let v,w=0,j;if(!f){const k=[Ev.bind(this),void 0];for(k.unshift(...u),k.push(...h),j=k.length,v=Promise.resolve(r);w<j;)v=v.then(k[w++],k[w++]);return v}j=u.length;let C=r;for(;w<j;){const k=u[w++],S=u[w++];try{C=k(C)}catch(_){S.call(this,_);break}}try{v=Ev.call(this,C)}catch(k){return Promise.reject(k)}for(w=0,j=h.length;w<j;)v=v.then(h[w++],h[w++]);return v}getUri(s){s=Xi(this.defaults,s);const r=Nw(s.baseURL,s.url,s.allowAbsoluteUrls);return gw(r,s.params,s.paramsSerializer)}};Xe.forEach(["delete","get","head","options"],function(s){Hi.prototype[s]=function(r,n){return this.request(Xi(n||{},{method:s,url:r,data:(n||{}).data}))}});Xe.forEach(["post","put","patch"],function(s){function r(n){return function(l,c,u){return this.request(Xi(u||{},{method:s,headers:n?{"Content-Type":"multipart/form-data"}:{},url:l,data:c}))}}Hi.prototype[s]=r(),Hi.prototype[s+"Form"]=r(!0)});let JP=class _w{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const n=this;this.promise.then(a=>{if(!n._listeners)return;let l=n._listeners.length;for(;l-- >0;)n._listeners[l](a);n._listeners=null}),this.promise.then=a=>{let l;const c=new Promise(u=>{n.subscribe(u),l=u}).then(a);return c.cancel=function(){n.unsubscribe(l)},c},s(function(l,c,u){n.reason||(n.reason=new oo(l,c,u),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const r=this._listeners.indexOf(s);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const s=new AbortController,r=n=>{s.abort(n)};return this.subscribe(r),s.signal.unsubscribe=()=>this.unsubscribe(r),s.signal}static source(){let s;return{token:new _w(function(a){s=a}),cancel:s}}};function ZP(t){return function(r){return t.apply(null,r)}}function eA(t){return Xe.isObject(t)&&t.isAxiosError===!0}const px={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(px).forEach(([t,s])=>{px[s]=t});function Ew(t){const s=new Hi(t),r=aw(Hi.prototype.request,s);return Xe.extend(r,Hi.prototype,s,{allOwnKeys:!0}),Xe.extend(r,s,null,{allOwnKeys:!0}),r.create=function(a){return Ew(Xi(t,a))},r}const ht=Ew(Oc);ht.Axios=Hi;ht.CanceledError=oo;ht.CancelToken=JP;ht.isCancel=bw;ht.VERSION=Cw;ht.toFormData=pm;ht.AxiosError=xs;ht.Cancel=ht.CanceledError;ht.all=function(s){return Promise.all(s)};ht.spread=ZP;ht.isAxiosError=eA;ht.mergeConfig=Xi;ht.AxiosHeaders=un;ht.formToJSON=t=>vw(Xe.isHTMLForm(t)?new FormData(t):t);ht.getAdapter=kw.getAdapter;ht.HttpStatusCode=px;ht.default=ht;const{Axios:r$,AxiosError:n$,CanceledError:a$,isCancel:i$,CancelToken:l$,VERSION:o$,all:c$,Cancel:d$,isAxiosError:u$,spread:m$,toFormData:p$,AxiosHeaders:x$,HttpStatusCode:h$,formToJSON:f$,getAdapter:g$,mergeConfig:y$}=ht,tA=C1("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function qs({className:t,variant:s,asChild:r=!1,...n}){const a=r?j1:"span";return e.jsx(a,{"data-slot":"badge",className:js(tA({variant:s}),t),...n})}var sA=Ox[" useId ".trim().toString()]||(()=>{}),rA=0;function ya(t){const[s,r]=d.useState(sA());return Sr(()=>{r(n=>n??String(rA++))},[t]),t||(s?`radix-${s}`:"")}function Zn(t){const s=d.useRef(t);return d.useEffect(()=>{s.current=t}),d.useMemo(()=>(...r)=>s.current?.(...r),[])}function nA(t,s=globalThis?.document){const r=Zn(t);d.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return s.addEventListener("keydown",n,{capture:!0}),()=>s.removeEventListener("keydown",n,{capture:!0})},[r,s])}var aA="DismissableLayer",xx="dismissableLayer.update",iA="dismissableLayer.pointerDownOutside",lA="dismissableLayer.focusOutside",Av,Pw=d.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Rc=d.forwardRef((t,s)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:l,onInteractOutside:c,onDismiss:u,...f}=t,h=d.useContext(Pw),[v,w]=d.useState(null),j=v?.ownerDocument??globalThis?.document,[,C]=d.useState({}),k=Ts(s,M=>w(M)),S=Array.from(h.layers),[_]=[...h.layersWithOutsidePointerEventsDisabled].slice(-1),I=S.indexOf(_),F=v?S.indexOf(v):-1,B=h.layersWithOutsidePointerEventsDisabled.size>0,q=F>=I,me=dA(M=>{const W=M.target,oe=[...h.branches].some(X=>X.contains(W));!q||oe||(a?.(M),c?.(M),M.defaultPrevented||u?.())},j),re=uA(M=>{const W=M.target;[...h.branches].some(X=>X.contains(W))||(l?.(M),c?.(M),M.defaultPrevented||u?.())},j);return nA(M=>{F===h.layers.size-1&&(n?.(M),!M.defaultPrevented&&u&&(M.preventDefault(),u()))},j),d.useEffect(()=>{if(v)return r&&(h.layersWithOutsidePointerEventsDisabled.size===0&&(Av=j.body.style.pointerEvents,j.body.style.pointerEvents="none"),h.layersWithOutsidePointerEventsDisabled.add(v)),h.layers.add(v),Tv(),()=>{r&&h.layersWithOutsidePointerEventsDisabled.size===1&&(j.body.style.pointerEvents=Av)}},[v,j,r,h]),d.useEffect(()=>()=>{v&&(h.layers.delete(v),h.layersWithOutsidePointerEventsDisabled.delete(v),Tv())},[v,h]),d.useEffect(()=>{const M=()=>C({});return document.addEventListener(xx,M),()=>document.removeEventListener(xx,M)},[]),e.jsx(bs.div,{...f,ref:k,style:{pointerEvents:B?q?"auto":"none":void 0,...t.style},onFocusCapture:rs(t.onFocusCapture,re.onFocusCapture),onBlurCapture:rs(t.onBlurCapture,re.onBlurCapture),onPointerDownCapture:rs(t.onPointerDownCapture,me.onPointerDownCapture)})});Rc.displayName=aA;var oA="DismissableLayerBranch",cA=d.forwardRef((t,s)=>{const r=d.useContext(Pw),n=d.useRef(null),a=Ts(s,n);return d.useEffect(()=>{const l=n.current;if(l)return r.branches.add(l),()=>{r.branches.delete(l)}},[r.branches]),e.jsx(bs.div,{...t,ref:a})});cA.displayName=oA;function dA(t,s=globalThis?.document){const r=Zn(t),n=d.useRef(!1),a=d.useRef(()=>{});return d.useEffect(()=>{const l=u=>{if(u.target&&!n.current){let f=function(){Aw(iA,r,h,{discrete:!0})};const h={originalEvent:u};u.pointerType==="touch"?(s.removeEventListener("click",a.current),a.current=f,s.addEventListener("click",a.current,{once:!0})):f()}else s.removeEventListener("click",a.current);n.current=!1},c=window.setTimeout(()=>{s.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(c),s.removeEventListener("pointerdown",l),s.removeEventListener("click",a.current)}},[s,r]),{onPointerDownCapture:()=>n.current=!0}}function uA(t,s=globalThis?.document){const r=Zn(t),n=d.useRef(!1);return d.useEffect(()=>{const a=l=>{l.target&&!n.current&&Aw(lA,r,{originalEvent:l},{discrete:!1})};return s.addEventListener("focusin",a),()=>s.removeEventListener("focusin",a)},[s,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Tv(){const t=new CustomEvent(xx);document.dispatchEvent(t)}function Aw(t,s,r,{discrete:n}){const a=r.originalEvent.target,l=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});s&&a.addEventListener(t,s,{once:!0}),n?q1(a,l):a.dispatchEvent(l)}var P0="focusScope.autoFocusOnMount",A0="focusScope.autoFocusOnUnmount",Ov={bubbles:!1,cancelable:!0},mA="FocusScope",Dc=d.forwardRef((t,s)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:l,...c}=t,[u,f]=d.useState(null),h=Zn(a),v=Zn(l),w=d.useRef(null),j=Ts(s,S=>f(S)),C=d.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;d.useEffect(()=>{if(n){let S=function(B){if(C.paused||!u)return;const q=B.target;u.contains(q)?w.current=q:yi(w.current,{select:!0})},_=function(B){if(C.paused||!u)return;const q=B.relatedTarget;q!==null&&(u.contains(q)||yi(w.current,{select:!0}))},I=function(B){if(document.activeElement===document.body)for(const me of B)me.removedNodes.length>0&&yi(u)};document.addEventListener("focusin",S),document.addEventListener("focusout",_);const F=new MutationObserver(I);return u&&F.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",S),document.removeEventListener("focusout",_),F.disconnect()}}},[n,u,C.paused]),d.useEffect(()=>{if(u){Dv.add(C);const S=document.activeElement;if(!u.contains(S)){const I=new CustomEvent(P0,Ov);u.addEventListener(P0,h),u.dispatchEvent(I),I.defaultPrevented||(pA(yA(Tw(u)),{select:!0}),document.activeElement===S&&yi(u))}return()=>{u.removeEventListener(P0,h),setTimeout(()=>{const I=new CustomEvent(A0,Ov);u.addEventListener(A0,v),u.dispatchEvent(I),I.defaultPrevented||yi(S??document.body,{select:!0}),u.removeEventListener(A0,v),Dv.remove(C)},0)}}},[u,h,v,C]);const k=d.useCallback(S=>{if(!r&&!n||C.paused)return;const _=S.key==="Tab"&&!S.altKey&&!S.ctrlKey&&!S.metaKey,I=document.activeElement;if(_&&I){const F=S.currentTarget,[B,q]=xA(F);B&&q?!S.shiftKey&&I===q?(S.preventDefault(),r&&yi(B,{select:!0})):S.shiftKey&&I===B&&(S.preventDefault(),r&&yi(q,{select:!0})):I===F&&S.preventDefault()}},[r,n,C.paused]);return e.jsx(bs.div,{tabIndex:-1,...c,ref:j,onKeyDown:k})});Dc.displayName=mA;function pA(t,{select:s=!1}={}){const r=document.activeElement;for(const n of t)if(yi(n,{select:s}),document.activeElement!==r)return}function xA(t){const s=Tw(t),r=Rv(s,t),n=Rv(s.reverse(),t);return[r,n]}function Tw(t){const s=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)s.push(r.currentNode);return s}function Rv(t,s){for(const r of t)if(!hA(r,{upTo:s}))return r}function hA(t,{upTo:s}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(s!==void 0&&t===s)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function fA(t){return t instanceof HTMLInputElement&&"select"in t}function yi(t,{select:s=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&fA(t)&&s&&t.select()}}var Dv=gA();function gA(){let t=[];return{add(s){const r=t[0];s!==r&&r?.pause(),t=Lv(t,s),t.unshift(s)},remove(s){t=Lv(t,s),t[0]?.resume()}}}function Lv(t,s){const r=[...t],n=r.indexOf(s);return n!==-1&&r.splice(n,1),r}function yA(t){return t.filter(s=>s.tagName!=="A")}var vA="Portal",Lc=d.forwardRef((t,s)=>{const{container:r,...n}=t,[a,l]=d.useState(!1);Sr(()=>l(!0),[]);const c=r||a&&globalThis?.document?.body;return c?v3.createPortal(e.jsx(bs.div,{...n,ref:s}),c):null});Lc.displayName=vA;var T0=0;function hm(){d.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Fv()),document.body.insertAdjacentElement("beforeend",t[1]??Fv()),T0++,()=>{T0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(s=>s.remove()),T0--}},[])}function Fv(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var ha=function(){return ha=Object.assign||function(s){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(s[l]=r[l])}return s},ha.apply(this,arguments)};function Ow(t,s){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&s.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)s.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function bA(t,s,r){if(r||arguments.length===2)for(var n=0,a=s.length,l;n<a;n++)(l||!(n in s))&&(l||(l=Array.prototype.slice.call(s,0,n)),l[n]=s[n]);return t.concat(l||Array.prototype.slice.call(s))}var Su="right-scroll-bar-position",ku="width-before-scroll-bar",wA="with-scroll-bars-hidden",NA="--removed-body-scroll-bar-size";function O0(t,s){return typeof t=="function"?t(s):t&&(t.current=s),t}function jA(t,s){var r=d.useState(function(){return{value:t,callback:s,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=s,r.facade}var SA=typeof window<"u"?d.useLayoutEffect:d.useEffect,Mv=new WeakMap;function kA(t,s){var r=jA(null,function(n){return t.forEach(function(a){return O0(a,n)})});return SA(function(){var n=Mv.get(r);if(n){var a=new Set(n),l=new Set(t),c=r.current;a.forEach(function(u){l.has(u)||O0(u,null)}),l.forEach(function(u){a.has(u)||O0(u,c)})}Mv.set(r,t)},[t]),r}function CA(t){return t}function _A(t,s){s===void 0&&(s=CA);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(l){var c=s(l,n);return r.push(c),function(){r=r.filter(function(u){return u!==c})}},assignSyncMedium:function(l){for(n=!0;r.length;){var c=r;r=[],c.forEach(l)}r={push:function(u){return l(u)},filter:function(){return r}}},assignMedium:function(l){n=!0;var c=[];if(r.length){var u=r;r=[],u.forEach(l),c=r}var f=function(){var v=c;c=[],v.forEach(l)},h=function(){return Promise.resolve().then(f)};h(),r={push:function(v){c.push(v),h()},filter:function(v){return c=c.filter(v),r}}}};return a}function EA(t){t===void 0&&(t={});var s=_A(null);return s.options=ha({async:!0,ssr:!1},t),s}var Rw=function(t){var s=t.sideCar,r=Ow(t,["sideCar"]);if(!s)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=s.read();if(!n)throw new Error("Sidecar medium not found");return d.createElement(n,ha({},r))};Rw.isSideCarExport=!0;function PA(t,s){return t.useMedium(s),Rw}var Dw=EA(),R0=function(){},fm=d.forwardRef(function(t,s){var r=d.useRef(null),n=d.useState({onScrollCapture:R0,onWheelCapture:R0,onTouchMoveCapture:R0}),a=n[0],l=n[1],c=t.forwardProps,u=t.children,f=t.className,h=t.removeScrollBar,v=t.enabled,w=t.shards,j=t.sideCar,C=t.noRelative,k=t.noIsolation,S=t.inert,_=t.allowPinchZoom,I=t.as,F=I===void 0?"div":I,B=t.gapMode,q=Ow(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),me=j,re=kA([r,s]),M=ha(ha({},q),a);return d.createElement(d.Fragment,null,v&&d.createElement(me,{sideCar:Dw,removeScrollBar:h,shards:w,noRelative:C,noIsolation:k,inert:S,setCallbacks:l,allowPinchZoom:!!_,lockRef:r,gapMode:B}),c?d.cloneElement(d.Children.only(u),ha(ha({},M),{ref:re})):d.createElement(F,ha({},M,{className:f,ref:re}),u))});fm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};fm.classNames={fullWidth:ku,zeroRight:Su};var AA=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function TA(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var s=AA();return s&&t.setAttribute("nonce",s),t}function OA(t,s){t.styleSheet?t.styleSheet.cssText=s:t.appendChild(document.createTextNode(s))}function RA(t){var s=document.head||document.getElementsByTagName("head")[0];s.appendChild(t)}var DA=function(){var t=0,s=null;return{add:function(r){t==0&&(s=TA())&&(OA(s,r),RA(s)),t++},remove:function(){t--,!t&&s&&(s.parentNode&&s.parentNode.removeChild(s),s=null)}}},LA=function(){var t=DA();return function(s,r){d.useEffect(function(){return t.add(s),function(){t.remove()}},[s&&r])}},Lw=function(){var t=LA(),s=function(r){var n=r.styles,a=r.dynamic;return t(n,a),null};return s},FA={left:0,top:0,right:0,gap:0},D0=function(t){return parseInt(t||"",10)||0},MA=function(t){var s=window.getComputedStyle(document.body),r=s[t==="padding"?"paddingLeft":"marginLeft"],n=s[t==="padding"?"paddingTop":"marginTop"],a=s[t==="padding"?"paddingRight":"marginRight"];return[D0(r),D0(n),D0(a)]},IA=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return FA;var s=MA(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:s[0],top:s[1],right:s[2],gap:Math.max(0,n-r+s[2]-s[0])}},qA=Lw(),Vl="data-scroll-locked",BA=function(t,s,r,n){var a=t.left,l=t.top,c=t.right,u=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(wA,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(u,"px ").concat(n,`;
  }
  body[`).concat(Vl,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([s&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(u,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(u,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Su,` {
    right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(ku,` {
    margin-right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(Su," .").concat(Su,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(ku," .").concat(ku,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Vl,`] {
    `).concat(NA,": ").concat(u,`px;
  }
`)},Iv=function(){var t=parseInt(document.body.getAttribute(Vl)||"0",10);return isFinite(t)?t:0},zA=function(){d.useEffect(function(){return document.body.setAttribute(Vl,(Iv()+1).toString()),function(){var t=Iv()-1;t<=0?document.body.removeAttribute(Vl):document.body.setAttribute(Vl,t.toString())}},[])},$A=function(t){var s=t.noRelative,r=t.noImportant,n=t.gapMode,a=n===void 0?"margin":n;zA();var l=d.useMemo(function(){return IA(a)},[a]);return d.createElement(qA,{styles:BA(l,!s,a,r?"":"!important")})},hx=!1;if(typeof window<"u")try{var au=Object.defineProperty({},"passive",{get:function(){return hx=!0,!0}});window.addEventListener("test",au,au),window.removeEventListener("test",au,au)}catch{hx=!1}var Fl=hx?{passive:!1}:!1,QA=function(t){return t.tagName==="TEXTAREA"},Fw=function(t,s){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[s]!=="hidden"&&!(r.overflowY===r.overflowX&&!QA(t)&&r[s]==="visible")},UA=function(t){return Fw(t,"overflowY")},VA=function(t){return Fw(t,"overflowX")},qv=function(t,s){var r=s.ownerDocument,n=s;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=Mw(t,n);if(a){var l=Iw(t,n),c=l[1],u=l[2];if(c>u)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},WA=function(t){var s=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[s,r,n]},GA=function(t){var s=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[s,r,n]},Mw=function(t,s){return t==="v"?UA(s):VA(s)},Iw=function(t,s){return t==="v"?WA(s):GA(s)},HA=function(t,s){return t==="h"&&s==="rtl"?-1:1},YA=function(t,s,r,n,a){var l=HA(t,window.getComputedStyle(s).direction),c=l*n,u=r.target,f=s.contains(u),h=!1,v=c>0,w=0,j=0;do{if(!u)break;var C=Iw(t,u),k=C[0],S=C[1],_=C[2],I=S-_-l*k;(k||I)&&Mw(t,u)&&(w+=I,j+=k);var F=u.parentNode;u=F&&F.nodeType===Node.DOCUMENT_FRAGMENT_NODE?F.host:F}while(!f&&u!==document.body||f&&(s.contains(u)||s===u));return(v&&Math.abs(w)<1||!v&&Math.abs(j)<1)&&(h=!0),h},iu=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Bv=function(t){return[t.deltaX,t.deltaY]},zv=function(t){return t&&"current"in t?t.current:t},KA=function(t,s){return t[0]===s[0]&&t[1]===s[1]},XA=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},JA=0,Ml=[];function ZA(t){var s=d.useRef([]),r=d.useRef([0,0]),n=d.useRef(),a=d.useState(JA++)[0],l=d.useState(Lw)[0],c=d.useRef(t);d.useEffect(function(){c.current=t},[t]),d.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var S=bA([t.lockRef.current],(t.shards||[]).map(zv),!0).filter(Boolean);return S.forEach(function(_){return _.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),S.forEach(function(_){return _.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var u=d.useCallback(function(S,_){if("touches"in S&&S.touches.length===2||S.type==="wheel"&&S.ctrlKey)return!c.current.allowPinchZoom;var I=iu(S),F=r.current,B="deltaX"in S?S.deltaX:F[0]-I[0],q="deltaY"in S?S.deltaY:F[1]-I[1],me,re=S.target,M=Math.abs(B)>Math.abs(q)?"h":"v";if("touches"in S&&M==="h"&&re.type==="range")return!1;var W=qv(M,re);if(!W)return!0;if(W?me=M:(me=M==="v"?"h":"v",W=qv(M,re)),!W)return!1;if(!n.current&&"changedTouches"in S&&(B||q)&&(n.current=me),!me)return!0;var oe=n.current||me;return YA(oe,_,S,oe==="h"?B:q)},[]),f=d.useCallback(function(S){var _=S;if(!(!Ml.length||Ml[Ml.length-1]!==l)){var I="deltaY"in _?Bv(_):iu(_),F=s.current.filter(function(me){return me.name===_.type&&(me.target===_.target||_.target===me.shadowParent)&&KA(me.delta,I)})[0];if(F&&F.should){_.cancelable&&_.preventDefault();return}if(!F){var B=(c.current.shards||[]).map(zv).filter(Boolean).filter(function(me){return me.contains(_.target)}),q=B.length>0?u(_,B[0]):!c.current.noIsolation;q&&_.cancelable&&_.preventDefault()}}},[]),h=d.useCallback(function(S,_,I,F){var B={name:S,delta:_,target:I,should:F,shadowParent:e5(I)};s.current.push(B),setTimeout(function(){s.current=s.current.filter(function(q){return q!==B})},1)},[]),v=d.useCallback(function(S){r.current=iu(S),n.current=void 0},[]),w=d.useCallback(function(S){h(S.type,Bv(S),S.target,u(S,t.lockRef.current))},[]),j=d.useCallback(function(S){h(S.type,iu(S),S.target,u(S,t.lockRef.current))},[]);d.useEffect(function(){return Ml.push(l),t.setCallbacks({onScrollCapture:w,onWheelCapture:w,onTouchMoveCapture:j}),document.addEventListener("wheel",f,Fl),document.addEventListener("touchmove",f,Fl),document.addEventListener("touchstart",v,Fl),function(){Ml=Ml.filter(function(S){return S!==l}),document.removeEventListener("wheel",f,Fl),document.removeEventListener("touchmove",f,Fl),document.removeEventListener("touchstart",v,Fl)}},[]);var C=t.removeScrollBar,k=t.inert;return d.createElement(d.Fragment,null,k?d.createElement(l,{styles:XA(a)}):null,C?d.createElement($A,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function e5(t){for(var s=null;t!==null;)t instanceof ShadowRoot&&(s=t.host,t=t.host),t=t.parentNode;return s}const t5=PA(Dw,ZA);var Fc=d.forwardRef(function(t,s){return d.createElement(fm,ha({},t,{ref:s,sideCar:t5}))});Fc.classNames=fm.classNames;var s5=function(t){if(typeof document>"u")return null;var s=Array.isArray(t)?t[0]:t;return s.ownerDocument.body},Il=new WeakMap,lu=new WeakMap,ou={},L0=0,qw=function(t){return t&&(t.host||qw(t.parentNode))},r5=function(t,s){return s.map(function(r){if(t.contains(r))return r;var n=qw(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},n5=function(t,s,r,n){var a=r5(s,Array.isArray(t)?t:[t]);ou[r]||(ou[r]=new WeakMap);var l=ou[r],c=[],u=new Set,f=new Set(a),h=function(w){!w||u.has(w)||(u.add(w),h(w.parentNode))};a.forEach(h);var v=function(w){!w||f.has(w)||Array.prototype.forEach.call(w.children,function(j){if(u.has(j))v(j);else try{var C=j.getAttribute(n),k=C!==null&&C!=="false",S=(Il.get(j)||0)+1,_=(l.get(j)||0)+1;Il.set(j,S),l.set(j,_),c.push(j),S===1&&k&&lu.set(j,!0),_===1&&j.setAttribute(r,"true"),k||j.setAttribute(n,"true")}catch(I){console.error("aria-hidden: cannot operate on ",j,I)}})};return v(s),u.clear(),L0++,function(){c.forEach(function(w){var j=Il.get(w)-1,C=l.get(w)-1;Il.set(w,j),l.set(w,C),j||(lu.has(w)||w.removeAttribute(n),lu.delete(w)),C||w.removeAttribute(r)}),L0--,L0||(Il=new WeakMap,Il=new WeakMap,lu=new WeakMap,ou={})}},gm=function(t,s,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),a=s5(t);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),n5(n,a,r,"aria-hidden")):function(){return null}};function a5(t){const s=i5(t),r=d.forwardRef((n,a)=>{const{children:l,...c}=n,u=d.Children.toArray(l),f=u.find(o5);if(f){const h=f.props.children,v=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(s,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,v):null})}return e.jsx(s,{...c,ref:a,children:l})});return r.displayName=`${t}.Slot`,r}function i5(t){const s=d.forwardRef((r,n)=>{const{children:a,...l}=r;if(d.isValidElement(a)){const c=d5(a),u=c5(l,a.props);return a.type!==d.Fragment&&(u.ref=n?ka(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var l5=Symbol("radix.slottable");function o5(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===l5}function c5(t,s){const r={...s};for(const n in s){const a=t[n],l=s[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(r[n]=a):n==="style"?r[n]={...a,...l}:n==="className"&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...t,...r}}function d5(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var ym="Dialog",[Bw]=Ga(ym),[u5,la]=Bw(ym),zw=t=>{const{__scopeDialog:s,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:c=!0}=t,u=d.useRef(null),f=d.useRef(null),[h,v]=Ki({prop:n,defaultProp:a??!1,onChange:l,caller:ym});return e.jsx(u5,{scope:s,triggerRef:u,contentRef:f,contentId:ya(),titleId:ya(),descriptionId:ya(),open:h,onOpenChange:v,onOpenToggle:d.useCallback(()=>v(w=>!w),[v]),modal:c,children:r})};zw.displayName=ym;var $w="DialogTrigger",m5=d.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=la($w,r),l=Ts(s,a.triggerRef);return e.jsx(bs.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Xx(a.open),...n,ref:l,onClick:rs(t.onClick,a.onOpenToggle)})});m5.displayName=$w;var Yx="DialogPortal",[p5,Qw]=Bw(Yx,{forceMount:void 0}),Uw=t=>{const{__scopeDialog:s,forceMount:r,children:n,container:a}=t,l=la(Yx,s);return e.jsx(p5,{scope:s,forceMount:r,children:d.Children.map(n,c=>e.jsx(aa,{present:r||l.open,children:e.jsx(Lc,{asChild:!0,container:a,children:c})}))})};Uw.displayName=Yx;var Du="DialogOverlay",Vw=d.forwardRef((t,s)=>{const r=Qw(Du,t.__scopeDialog),{forceMount:n=r.forceMount,...a}=t,l=la(Du,t.__scopeDialog);return l.modal?e.jsx(aa,{present:n||l.open,children:e.jsx(h5,{...a,ref:s})}):null});Vw.displayName=Du;var x5=a5("DialogOverlay.RemoveScroll"),h5=d.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=la(Du,r);return e.jsx(Fc,{as:x5,allowPinchZoom:!0,shards:[a.contentRef],children:e.jsx(bs.div,{"data-state":Xx(a.open),...n,ref:s,style:{pointerEvents:"auto",...n.style}})})}),Ji="DialogContent",Ww=d.forwardRef((t,s)=>{const r=Qw(Ji,t.__scopeDialog),{forceMount:n=r.forceMount,...a}=t,l=la(Ji,t.__scopeDialog);return e.jsx(aa,{present:n||l.open,children:l.modal?e.jsx(f5,{...a,ref:s}):e.jsx(g5,{...a,ref:s})})});Ww.displayName=Ji;var f5=d.forwardRef((t,s)=>{const r=la(Ji,t.__scopeDialog),n=d.useRef(null),a=Ts(s,r.contentRef,n);return d.useEffect(()=>{const l=n.current;if(l)return gm(l)},[]),e.jsx(Gw,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:rs(t.onCloseAutoFocus,l=>{l.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:rs(t.onPointerDownOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0;(c.button===2||u)&&l.preventDefault()}),onFocusOutside:rs(t.onFocusOutside,l=>l.preventDefault())})}),g5=d.forwardRef((t,s)=>{const r=la(Ji,t.__scopeDialog),n=d.useRef(!1),a=d.useRef(!1);return e.jsx(Gw,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{t.onCloseAutoFocus?.(l),l.defaultPrevented||(n.current||r.triggerRef.current?.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{t.onInteractOutside?.(l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const c=l.target;r.triggerRef.current?.contains(c)&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),Gw=d.forwardRef((t,s)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,...c}=t,u=la(Ji,r),f=d.useRef(null),h=Ts(s,f);return hm(),e.jsxs(e.Fragment,{children:[e.jsx(Dc,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:e.jsx(Rc,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":Xx(u.open),...c,ref:h,onDismiss:()=>u.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(y5,{titleId:u.titleId}),e.jsx(b5,{contentRef:f,descriptionId:u.descriptionId})]})]})}),Kx="DialogTitle",Hw=d.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=la(Kx,r);return e.jsx(bs.h2,{id:a.titleId,...n,ref:s})});Hw.displayName=Kx;var Yw="DialogDescription",Kw=d.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=la(Yw,r);return e.jsx(bs.p,{id:a.descriptionId,...n,ref:s})});Kw.displayName=Yw;var Xw="DialogClose",Jw=d.forwardRef((t,s)=>{const{__scopeDialog:r,...n}=t,a=la(Xw,r);return e.jsx(bs.button,{type:"button",...n,ref:s,onClick:rs(t.onClick,()=>a.onOpenChange(!1))})});Jw.displayName=Xw;function Xx(t){return t?"open":"closed"}var Zw="DialogTitleWarning",[v$,eN]=dE(Zw,{contentName:Ji,titleName:Kx,docsSlug:"dialog"}),y5=({titleId:t})=>{const s=eN(Zw),r=`\`${s.contentName}\` requires a \`${s.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${s.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${s.docsSlug}`;return d.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},v5="DialogDescriptionWarning",b5=({contentRef:t,descriptionId:s})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${eN(v5).contentName}}.`;return d.useEffect(()=>{const a=t.current?.getAttribute("aria-describedby");s&&a&&(document.getElementById(s)||console.warn(n))},[n,t,s]),null},w5=zw,N5=Uw,tN=Vw,sN=Ww,j5=Hw,S5=Kw,k5=Jw;function Rt({...t}){return e.jsx(w5,{"data-slot":"dialog",...t})}function C5({...t}){return e.jsx(N5,{"data-slot":"dialog-portal",...t})}const rN=d.forwardRef(({className:t,...s},r)=>e.jsx(tN,{ref:r,"data-slot":"dialog-overlay",className:js("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s}));rN.displayName=tN.displayName;const Tt=d.forwardRef(({className:t,children:s,...r},n)=>e.jsxs(C5,{"data-slot":"dialog-portal",children:[e.jsx(rN,{}),e.jsxs(sN,{ref:n,"data-slot":"dialog-content",className:js("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...r,children:[s,e.jsxs(k5,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(Ux,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Tt.displayName=sN.displayName;function Dt({className:t,...s}){return e.jsx("div",{"data-slot":"dialog-header",className:js("flex flex-col gap-2 text-center sm:text-left",t),...s})}function Lt({className:t,...s}){return e.jsx(j5,{"data-slot":"dialog-title",className:js("text-lg leading-none font-semibold",t),...s})}function Mt({className:t,...s}){return e.jsx(S5,{"data-slot":"dialog-description",className:js("text-muted-foreground text-sm",t),...s})}function ur({className:t,...s}){return e.jsx("textarea",{"data-slot":"textarea",className:js("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}var _5=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],E5=_5.reduce((t,s)=>{const r=Bx(`Primitive.${s}`),n=d.forwardRef((a,l)=>{const{asChild:c,...u}=a,f=c?r:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(f,{...u,ref:l})});return n.displayName=`Primitive.${s}`,{...t,[s]:n}},{}),P5="Label",nN=d.forwardRef((t,s)=>e.jsx(E5.label,{...t,ref:s,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(t.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));nN.displayName=P5;var A5=nN;function D({className:t,...s}){return e.jsx(A5,{"data-slot":"label",className:js("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}function $v(t,[s,r]){return Math.min(r,Math.max(s,t))}function Qv(t){const s=T5(t),r=d.forwardRef((n,a)=>{const{children:l,...c}=n,u=d.Children.toArray(l),f=u.find(R5);if(f){const h=f.props.children,v=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(s,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,v):null})}return e.jsx(s,{...c,ref:a,children:l})});return r.displayName=`${t}.Slot`,r}function T5(t){const s=d.forwardRef((r,n)=>{const{children:a,...l}=r;if(d.isValidElement(a)){const c=L5(a),u=D5(l,a.props);return a.type!==d.Fragment&&(u.ref=n?ka(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var O5=Symbol("radix.slottable");function R5(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===O5}function D5(t,s){const r={...s};for(const n in s){const a=t[n],l=s[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(r[n]=a):n==="style"?r[n]={...a,...l}:n==="className"&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...t,...r}}function L5(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function Jx(t){const s=t+"CollectionProvider",[r,n]=Ga(s),[a,l]=r(s,{collectionRef:{current:null},itemMap:new Map}),c=S=>{const{scope:_,children:I}=S,F=gi.useRef(null),B=gi.useRef(new Map).current;return e.jsx(a,{scope:_,itemMap:B,collectionRef:F,children:I})};c.displayName=s;const u=t+"CollectionSlot",f=Qv(u),h=gi.forwardRef((S,_)=>{const{scope:I,children:F}=S,B=l(u,I),q=Ts(_,B.collectionRef);return e.jsx(f,{ref:q,children:F})});h.displayName=u;const v=t+"CollectionItemSlot",w="data-radix-collection-item",j=Qv(v),C=gi.forwardRef((S,_)=>{const{scope:I,children:F,...B}=S,q=gi.useRef(null),me=Ts(_,q),re=l(v,I);return gi.useEffect(()=>(re.itemMap.set(q,{ref:q,...B}),()=>void re.itemMap.delete(q))),e.jsx(j,{[w]:"",ref:me,children:F})});C.displayName=v;function k(S){const _=l(t+"CollectionConsumer",S);return gi.useCallback(()=>{const F=_.collectionRef.current;if(!F)return[];const B=Array.from(F.querySelectorAll(`[${w}]`));return Array.from(_.itemMap.values()).sort((re,M)=>B.indexOf(re.ref.current)-B.indexOf(M.ref.current))},[_.collectionRef,_.itemMap])}return[{Provider:c,Slot:h,ItemSlot:C},k,n]}var F5=d.createContext(void 0);function Zx(t){const s=d.useContext(F5);return t||s||"ltr"}const M5=["top","right","bottom","left"],Ni=Math.min,jn=Math.max,Lu=Math.round,cu=Math.floor,va=t=>({x:t,y:t}),I5={left:"right",right:"left",bottom:"top",top:"bottom"},q5={start:"end",end:"start"};function fx(t,s,r){return jn(t,Ni(s,r))}function Qa(t,s){return typeof t=="function"?t(s):t}function Ua(t){return t.split("-")[0]}function co(t){return t.split("-")[1]}function eh(t){return t==="x"?"y":"x"}function th(t){return t==="y"?"height":"width"}const B5=new Set(["top","bottom"]);function fa(t){return B5.has(Ua(t))?"y":"x"}function sh(t){return eh(fa(t))}function z5(t,s,r){r===void 0&&(r=!1);const n=co(t),a=sh(t),l=th(a);let c=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return s.reference[l]>s.floating[l]&&(c=Fu(c)),[c,Fu(c)]}function $5(t){const s=Fu(t);return[gx(t),s,gx(s)]}function gx(t){return t.replace(/start|end/g,s=>q5[s])}const Uv=["left","right"],Vv=["right","left"],Q5=["top","bottom"],U5=["bottom","top"];function V5(t,s,r){switch(t){case"top":case"bottom":return r?s?Vv:Uv:s?Uv:Vv;case"left":case"right":return s?Q5:U5;default:return[]}}function W5(t,s,r,n){const a=co(t);let l=V5(Ua(t),r==="start",n);return a&&(l=l.map(c=>c+"-"+a),s&&(l=l.concat(l.map(gx)))),l}function Fu(t){return t.replace(/left|right|bottom|top/g,s=>I5[s])}function G5(t){return{top:0,right:0,bottom:0,left:0,...t}}function aN(t){return typeof t!="number"?G5(t):{top:t,right:t,bottom:t,left:t}}function Mu(t){const{x:s,y:r,width:n,height:a}=t;return{width:n,height:a,top:r,left:s,right:s+n,bottom:r+a,x:s,y:r}}function Wv(t,s,r){let{reference:n,floating:a}=t;const l=fa(s),c=sh(s),u=th(c),f=Ua(s),h=l==="y",v=n.x+n.width/2-a.width/2,w=n.y+n.height/2-a.height/2,j=n[u]/2-a[u]/2;let C;switch(f){case"top":C={x:v,y:n.y-a.height};break;case"bottom":C={x:v,y:n.y+n.height};break;case"right":C={x:n.x+n.width,y:w};break;case"left":C={x:n.x-a.width,y:w};break;default:C={x:n.x,y:n.y}}switch(co(s)){case"start":C[c]-=j*(r&&h?-1:1);break;case"end":C[c]+=j*(r&&h?-1:1);break}return C}const H5=async(t,s,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:l=[],platform:c}=r,u=l.filter(Boolean),f=await(c.isRTL==null?void 0:c.isRTL(s));let h=await c.getElementRects({reference:t,floating:s,strategy:a}),{x:v,y:w}=Wv(h,n,f),j=n,C={},k=0;for(let S=0;S<u.length;S++){const{name:_,fn:I}=u[S],{x:F,y:B,data:q,reset:me}=await I({x:v,y:w,initialPlacement:n,placement:j,strategy:a,middlewareData:C,rects:h,platform:c,elements:{reference:t,floating:s}});v=F??v,w=B??w,C={...C,[_]:{...C[_],...q}},me&&k<=50&&(k++,typeof me=="object"&&(me.placement&&(j=me.placement),me.rects&&(h=me.rects===!0?await c.getElementRects({reference:t,floating:s,strategy:a}):me.rects),{x:v,y:w}=Wv(h,j,f)),S=-1)}return{x:v,y:w,placement:j,strategy:a,middlewareData:C}};async function xc(t,s){var r;s===void 0&&(s={});const{x:n,y:a,platform:l,rects:c,elements:u,strategy:f}=t,{boundary:h="clippingAncestors",rootBoundary:v="viewport",elementContext:w="floating",altBoundary:j=!1,padding:C=0}=Qa(s,t),k=aN(C),_=u[j?w==="floating"?"reference":"floating":w],I=Mu(await l.getClippingRect({element:(r=await(l.isElement==null?void 0:l.isElement(_)))==null||r?_:_.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(u.floating)),boundary:h,rootBoundary:v,strategy:f})),F=w==="floating"?{x:n,y:a,width:c.floating.width,height:c.floating.height}:c.reference,B=await(l.getOffsetParent==null?void 0:l.getOffsetParent(u.floating)),q=await(l.isElement==null?void 0:l.isElement(B))?await(l.getScale==null?void 0:l.getScale(B))||{x:1,y:1}:{x:1,y:1},me=Mu(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:F,offsetParent:B,strategy:f}):F);return{top:(I.top-me.top+k.top)/q.y,bottom:(me.bottom-I.bottom+k.bottom)/q.y,left:(I.left-me.left+k.left)/q.x,right:(me.right-I.right+k.right)/q.x}}const Y5=t=>({name:"arrow",options:t,async fn(s){const{x:r,y:n,placement:a,rects:l,platform:c,elements:u,middlewareData:f}=s,{element:h,padding:v=0}=Qa(t,s)||{};if(h==null)return{};const w=aN(v),j={x:r,y:n},C=sh(a),k=th(C),S=await c.getDimensions(h),_=C==="y",I=_?"top":"left",F=_?"bottom":"right",B=_?"clientHeight":"clientWidth",q=l.reference[k]+l.reference[C]-j[C]-l.floating[k],me=j[C]-l.reference[C],re=await(c.getOffsetParent==null?void 0:c.getOffsetParent(h));let M=re?re[B]:0;(!M||!await(c.isElement==null?void 0:c.isElement(re)))&&(M=u.floating[B]||l.floating[k]);const W=q/2-me/2,oe=M/2-S[k]/2-1,X=Ni(w[I],oe),he=Ni(w[F],oe),ue=X,_e=M-S[k]-he,ke=M/2-S[k]/2+W,Re=fx(ue,ke,_e),Y=!f.arrow&&co(a)!=null&&ke!==Re&&l.reference[k]/2-(ke<ue?X:he)-S[k]/2<0,ve=Y?ke<ue?ke-ue:ke-_e:0;return{[C]:j[C]+ve,data:{[C]:Re,centerOffset:ke-Re-ve,...Y&&{alignmentOffset:ve}},reset:Y}}}),K5=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(s){var r,n;const{placement:a,middlewareData:l,rects:c,initialPlacement:u,platform:f,elements:h}=s,{mainAxis:v=!0,crossAxis:w=!0,fallbackPlacements:j,fallbackStrategy:C="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:S=!0,..._}=Qa(t,s);if((r=l.arrow)!=null&&r.alignmentOffset)return{};const I=Ua(a),F=fa(u),B=Ua(u)===u,q=await(f.isRTL==null?void 0:f.isRTL(h.floating)),me=j||(B||!S?[Fu(u)]:$5(u)),re=k!=="none";!j&&re&&me.push(...W5(u,S,k,q));const M=[u,...me],W=await xc(s,_),oe=[];let X=((n=l.flip)==null?void 0:n.overflows)||[];if(v&&oe.push(W[I]),w){const ke=z5(a,c,q);oe.push(W[ke[0]],W[ke[1]])}if(X=[...X,{placement:a,overflows:oe}],!oe.every(ke=>ke<=0)){var he,ue;const ke=(((he=l.flip)==null?void 0:he.index)||0)+1,Re=M[ke];if(Re&&(!(w==="alignment"?F!==fa(Re):!1)||X.every(Q=>fa(Q.placement)===F?Q.overflows[0]>0:!0)))return{data:{index:ke,overflows:X},reset:{placement:Re}};let Y=(ue=X.filter(ve=>ve.overflows[0]<=0).sort((ve,Q)=>ve.overflows[1]-Q.overflows[1])[0])==null?void 0:ue.placement;if(!Y)switch(C){case"bestFit":{var _e;const ve=(_e=X.filter(Q=>{if(re){const be=fa(Q.placement);return be===F||be==="y"}return!0}).map(Q=>[Q.placement,Q.overflows.filter(be=>be>0).reduce((be,pe)=>be+pe,0)]).sort((Q,be)=>Q[1]-be[1])[0])==null?void 0:_e[0];ve&&(Y=ve);break}case"initialPlacement":Y=u;break}if(a!==Y)return{reset:{placement:Y}}}return{}}}};function Gv(t,s){return{top:t.top-s.height,right:t.right-s.width,bottom:t.bottom-s.height,left:t.left-s.width}}function Hv(t){return M5.some(s=>t[s]>=0)}const X5=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(s){const{rects:r}=s,{strategy:n="referenceHidden",...a}=Qa(t,s);switch(n){case"referenceHidden":{const l=await xc(s,{...a,elementContext:"reference"}),c=Gv(l,r.reference);return{data:{referenceHiddenOffsets:c,referenceHidden:Hv(c)}}}case"escaped":{const l=await xc(s,{...a,altBoundary:!0}),c=Gv(l,r.floating);return{data:{escapedOffsets:c,escaped:Hv(c)}}}default:return{}}}}},iN=new Set(["left","top"]);async function J5(t,s){const{placement:r,platform:n,elements:a}=t,l=await(n.isRTL==null?void 0:n.isRTL(a.floating)),c=Ua(r),u=co(r),f=fa(r)==="y",h=iN.has(c)?-1:1,v=l&&f?-1:1,w=Qa(s,t);let{mainAxis:j,crossAxis:C,alignmentAxis:k}=typeof w=="number"?{mainAxis:w,crossAxis:0,alignmentAxis:null}:{mainAxis:w.mainAxis||0,crossAxis:w.crossAxis||0,alignmentAxis:w.alignmentAxis};return u&&typeof k=="number"&&(C=u==="end"?k*-1:k),f?{x:C*v,y:j*h}:{x:j*h,y:C*v}}const Z5=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(s){var r,n;const{x:a,y:l,placement:c,middlewareData:u}=s,f=await J5(s,t);return c===((r=u.offset)==null?void 0:r.placement)&&(n=u.arrow)!=null&&n.alignmentOffset?{}:{x:a+f.x,y:l+f.y,data:{...f,placement:c}}}}},eT=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(s){const{x:r,y:n,placement:a}=s,{mainAxis:l=!0,crossAxis:c=!1,limiter:u={fn:_=>{let{x:I,y:F}=_;return{x:I,y:F}}},...f}=Qa(t,s),h={x:r,y:n},v=await xc(s,f),w=fa(Ua(a)),j=eh(w);let C=h[j],k=h[w];if(l){const _=j==="y"?"top":"left",I=j==="y"?"bottom":"right",F=C+v[_],B=C-v[I];C=fx(F,C,B)}if(c){const _=w==="y"?"top":"left",I=w==="y"?"bottom":"right",F=k+v[_],B=k-v[I];k=fx(F,k,B)}const S=u.fn({...s,[j]:C,[w]:k});return{...S,data:{x:S.x-r,y:S.y-n,enabled:{[j]:l,[w]:c}}}}}},tT=function(t){return t===void 0&&(t={}),{options:t,fn(s){const{x:r,y:n,placement:a,rects:l,middlewareData:c}=s,{offset:u=0,mainAxis:f=!0,crossAxis:h=!0}=Qa(t,s),v={x:r,y:n},w=fa(a),j=eh(w);let C=v[j],k=v[w];const S=Qa(u,s),_=typeof S=="number"?{mainAxis:S,crossAxis:0}:{mainAxis:0,crossAxis:0,...S};if(f){const B=j==="y"?"height":"width",q=l.reference[j]-l.floating[B]+_.mainAxis,me=l.reference[j]+l.reference[B]-_.mainAxis;C<q?C=q:C>me&&(C=me)}if(h){var I,F;const B=j==="y"?"width":"height",q=iN.has(Ua(a)),me=l.reference[w]-l.floating[B]+(q&&((I=c.offset)==null?void 0:I[w])||0)+(q?0:_.crossAxis),re=l.reference[w]+l.reference[B]+(q?0:((F=c.offset)==null?void 0:F[w])||0)-(q?_.crossAxis:0);k<me?k=me:k>re&&(k=re)}return{[j]:C,[w]:k}}}},sT=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(s){var r,n;const{placement:a,rects:l,platform:c,elements:u}=s,{apply:f=()=>{},...h}=Qa(t,s),v=await xc(s,h),w=Ua(a),j=co(a),C=fa(a)==="y",{width:k,height:S}=l.floating;let _,I;w==="top"||w==="bottom"?(_=w,I=j===(await(c.isRTL==null?void 0:c.isRTL(u.floating))?"start":"end")?"left":"right"):(I=w,_=j==="end"?"top":"bottom");const F=S-v.top-v.bottom,B=k-v.left-v.right,q=Ni(S-v[_],F),me=Ni(k-v[I],B),re=!s.middlewareData.shift;let M=q,W=me;if((r=s.middlewareData.shift)!=null&&r.enabled.x&&(W=B),(n=s.middlewareData.shift)!=null&&n.enabled.y&&(M=F),re&&!j){const X=jn(v.left,0),he=jn(v.right,0),ue=jn(v.top,0),_e=jn(v.bottom,0);C?W=k-2*(X!==0||he!==0?X+he:jn(v.left,v.right)):M=S-2*(ue!==0||_e!==0?ue+_e:jn(v.top,v.bottom))}await f({...s,availableWidth:W,availableHeight:M});const oe=await c.getDimensions(u.floating);return k!==oe.width||S!==oe.height?{reset:{rects:!0}}:{}}}};function vm(){return typeof window<"u"}function uo(t){return lN(t)?(t.nodeName||"").toLowerCase():"#document"}function Cn(t){var s;return(t==null||(s=t.ownerDocument)==null?void 0:s.defaultView)||window}function Ca(t){var s;return(s=(lN(t)?t.ownerDocument:t.document)||window.document)==null?void 0:s.documentElement}function lN(t){return vm()?t instanceof Node||t instanceof Cn(t).Node:!1}function ea(t){return vm()?t instanceof Element||t instanceof Cn(t).Element:!1}function ba(t){return vm()?t instanceof HTMLElement||t instanceof Cn(t).HTMLElement:!1}function Yv(t){return!vm()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Cn(t).ShadowRoot}const rT=new Set(["inline","contents"]);function Mc(t){const{overflow:s,overflowX:r,overflowY:n,display:a}=ta(t);return/auto|scroll|overlay|hidden|clip/.test(s+n+r)&&!rT.has(a)}const nT=new Set(["table","td","th"]);function aT(t){return nT.has(uo(t))}const iT=[":popover-open",":modal"];function bm(t){return iT.some(s=>{try{return t.matches(s)}catch{return!1}})}const lT=["transform","translate","scale","rotate","perspective"],oT=["transform","translate","scale","rotate","perspective","filter"],cT=["paint","layout","strict","content"];function rh(t){const s=nh(),r=ea(t)?ta(t):t;return lT.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!s&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!s&&(r.filter?r.filter!=="none":!1)||oT.some(n=>(r.willChange||"").includes(n))||cT.some(n=>(r.contain||"").includes(n))}function dT(t){let s=ji(t);for(;ba(s)&&!Jl(s);){if(rh(s))return s;if(bm(s))return null;s=ji(s)}return null}function nh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const uT=new Set(["html","body","#document"]);function Jl(t){return uT.has(uo(t))}function ta(t){return Cn(t).getComputedStyle(t)}function wm(t){return ea(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ji(t){if(uo(t)==="html")return t;const s=t.assignedSlot||t.parentNode||Yv(t)&&t.host||Ca(t);return Yv(s)?s.host:s}function oN(t){const s=ji(t);return Jl(s)?t.ownerDocument?t.ownerDocument.body:t.body:ba(s)&&Mc(s)?s:oN(s)}function hc(t,s,r){var n;s===void 0&&(s=[]),r===void 0&&(r=!0);const a=oN(t),l=a===((n=t.ownerDocument)==null?void 0:n.body),c=Cn(a);if(l){const u=yx(c);return s.concat(c,c.visualViewport||[],Mc(a)?a:[],u&&r?hc(u):[])}return s.concat(a,hc(a,[],r))}function yx(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function cN(t){const s=ta(t);let r=parseFloat(s.width)||0,n=parseFloat(s.height)||0;const a=ba(t),l=a?t.offsetWidth:r,c=a?t.offsetHeight:n,u=Lu(r)!==l||Lu(n)!==c;return u&&(r=l,n=c),{width:r,height:n,$:u}}function ah(t){return ea(t)?t:t.contextElement}function Wl(t){const s=ah(t);if(!ba(s))return va(1);const r=s.getBoundingClientRect(),{width:n,height:a,$:l}=cN(s);let c=(l?Lu(r.width):r.width)/n,u=(l?Lu(r.height):r.height)/a;return(!c||!Number.isFinite(c))&&(c=1),(!u||!Number.isFinite(u))&&(u=1),{x:c,y:u}}const mT=va(0);function dN(t){const s=Cn(t);return!nh()||!s.visualViewport?mT:{x:s.visualViewport.offsetLeft,y:s.visualViewport.offsetTop}}function pT(t,s,r){return s===void 0&&(s=!1),!r||s&&r!==Cn(t)?!1:s}function Zi(t,s,r,n){s===void 0&&(s=!1),r===void 0&&(r=!1);const a=t.getBoundingClientRect(),l=ah(t);let c=va(1);s&&(n?ea(n)&&(c=Wl(n)):c=Wl(t));const u=pT(l,r,n)?dN(l):va(0);let f=(a.left+u.x)/c.x,h=(a.top+u.y)/c.y,v=a.width/c.x,w=a.height/c.y;if(l){const j=Cn(l),C=n&&ea(n)?Cn(n):n;let k=j,S=yx(k);for(;S&&n&&C!==k;){const _=Wl(S),I=S.getBoundingClientRect(),F=ta(S),B=I.left+(S.clientLeft+parseFloat(F.paddingLeft))*_.x,q=I.top+(S.clientTop+parseFloat(F.paddingTop))*_.y;f*=_.x,h*=_.y,v*=_.x,w*=_.y,f+=B,h+=q,k=Cn(S),S=yx(k)}}return Mu({width:v,height:w,x:f,y:h})}function Nm(t,s){const r=wm(t).scrollLeft;return s?s.left+r:Zi(Ca(t)).left+r}function uN(t,s){const r=t.getBoundingClientRect(),n=r.left+s.scrollLeft-Nm(t,r),a=r.top+s.scrollTop;return{x:n,y:a}}function xT(t){let{elements:s,rect:r,offsetParent:n,strategy:a}=t;const l=a==="fixed",c=Ca(n),u=s?bm(s.floating):!1;if(n===c||u&&l)return r;let f={scrollLeft:0,scrollTop:0},h=va(1);const v=va(0),w=ba(n);if((w||!w&&!l)&&((uo(n)!=="body"||Mc(c))&&(f=wm(n)),ba(n))){const C=Zi(n);h=Wl(n),v.x=C.x+n.clientLeft,v.y=C.y+n.clientTop}const j=c&&!w&&!l?uN(c,f):va(0);return{width:r.width*h.x,height:r.height*h.y,x:r.x*h.x-f.scrollLeft*h.x+v.x+j.x,y:r.y*h.y-f.scrollTop*h.y+v.y+j.y}}function hT(t){return Array.from(t.getClientRects())}function fT(t){const s=Ca(t),r=wm(t),n=t.ownerDocument.body,a=jn(s.scrollWidth,s.clientWidth,n.scrollWidth,n.clientWidth),l=jn(s.scrollHeight,s.clientHeight,n.scrollHeight,n.clientHeight);let c=-r.scrollLeft+Nm(t);const u=-r.scrollTop;return ta(n).direction==="rtl"&&(c+=jn(s.clientWidth,n.clientWidth)-a),{width:a,height:l,x:c,y:u}}const Kv=25;function gT(t,s){const r=Cn(t),n=Ca(t),a=r.visualViewport;let l=n.clientWidth,c=n.clientHeight,u=0,f=0;if(a){l=a.width,c=a.height;const v=nh();(!v||v&&s==="fixed")&&(u=a.offsetLeft,f=a.offsetTop)}const h=Nm(n);if(h<=0){const v=n.ownerDocument,w=v.body,j=getComputedStyle(w),C=v.compatMode==="CSS1Compat"&&parseFloat(j.marginLeft)+parseFloat(j.marginRight)||0,k=Math.abs(n.clientWidth-w.clientWidth-C);k<=Kv&&(l-=k)}else h<=Kv&&(l+=h);return{width:l,height:c,x:u,y:f}}const yT=new Set(["absolute","fixed"]);function vT(t,s){const r=Zi(t,!0,s==="fixed"),n=r.top+t.clientTop,a=r.left+t.clientLeft,l=ba(t)?Wl(t):va(1),c=t.clientWidth*l.x,u=t.clientHeight*l.y,f=a*l.x,h=n*l.y;return{width:c,height:u,x:f,y:h}}function Xv(t,s,r){let n;if(s==="viewport")n=gT(t,r);else if(s==="document")n=fT(Ca(t));else if(ea(s))n=vT(s,r);else{const a=dN(t);n={x:s.x-a.x,y:s.y-a.y,width:s.width,height:s.height}}return Mu(n)}function mN(t,s){const r=ji(t);return r===s||!ea(r)||Jl(r)?!1:ta(r).position==="fixed"||mN(r,s)}function bT(t,s){const r=s.get(t);if(r)return r;let n=hc(t,[],!1).filter(u=>ea(u)&&uo(u)!=="body"),a=null;const l=ta(t).position==="fixed";let c=l?ji(t):t;for(;ea(c)&&!Jl(c);){const u=ta(c),f=rh(c);!f&&u.position==="fixed"&&(a=null),(l?!f&&!a:!f&&u.position==="static"&&!!a&&yT.has(a.position)||Mc(c)&&!f&&mN(t,c))?n=n.filter(v=>v!==c):a=u,c=ji(c)}return s.set(t,n),n}function wT(t){let{element:s,boundary:r,rootBoundary:n,strategy:a}=t;const c=[...r==="clippingAncestors"?bm(s)?[]:bT(s,this._c):[].concat(r),n],u=c[0],f=c.reduce((h,v)=>{const w=Xv(s,v,a);return h.top=jn(w.top,h.top),h.right=Ni(w.right,h.right),h.bottom=Ni(w.bottom,h.bottom),h.left=jn(w.left,h.left),h},Xv(s,u,a));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function NT(t){const{width:s,height:r}=cN(t);return{width:s,height:r}}function jT(t,s,r){const n=ba(s),a=Ca(s),l=r==="fixed",c=Zi(t,!0,l,s);let u={scrollLeft:0,scrollTop:0};const f=va(0);function h(){f.x=Nm(a)}if(n||!n&&!l)if((uo(s)!=="body"||Mc(a))&&(u=wm(s)),n){const C=Zi(s,!0,l,s);f.x=C.x+s.clientLeft,f.y=C.y+s.clientTop}else a&&h();l&&!n&&a&&h();const v=a&&!n&&!l?uN(a,u):va(0),w=c.left+u.scrollLeft-f.x-v.x,j=c.top+u.scrollTop-f.y-v.y;return{x:w,y:j,width:c.width,height:c.height}}function F0(t){return ta(t).position==="static"}function Jv(t,s){if(!ba(t)||ta(t).position==="fixed")return null;if(s)return s(t);let r=t.offsetParent;return Ca(t)===r&&(r=r.ownerDocument.body),r}function pN(t,s){const r=Cn(t);if(bm(t))return r;if(!ba(t)){let a=ji(t);for(;a&&!Jl(a);){if(ea(a)&&!F0(a))return a;a=ji(a)}return r}let n=Jv(t,s);for(;n&&aT(n)&&F0(n);)n=Jv(n,s);return n&&Jl(n)&&F0(n)&&!rh(n)?r:n||dT(t)||r}const ST=async function(t){const s=this.getOffsetParent||pN,r=this.getDimensions,n=await r(t.floating);return{reference:jT(t.reference,await s(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function kT(t){return ta(t).direction==="rtl"}const CT={convertOffsetParentRelativeRectToViewportRelativeRect:xT,getDocumentElement:Ca,getClippingRect:wT,getOffsetParent:pN,getElementRects:ST,getClientRects:hT,getDimensions:NT,getScale:Wl,isElement:ea,isRTL:kT};function xN(t,s){return t.x===s.x&&t.y===s.y&&t.width===s.width&&t.height===s.height}function _T(t,s){let r=null,n;const a=Ca(t);function l(){var u;clearTimeout(n),(u=r)==null||u.disconnect(),r=null}function c(u,f){u===void 0&&(u=!1),f===void 0&&(f=1),l();const h=t.getBoundingClientRect(),{left:v,top:w,width:j,height:C}=h;if(u||s(),!j||!C)return;const k=cu(w),S=cu(a.clientWidth-(v+j)),_=cu(a.clientHeight-(w+C)),I=cu(v),B={rootMargin:-k+"px "+-S+"px "+-_+"px "+-I+"px",threshold:jn(0,Ni(1,f))||1};let q=!0;function me(re){const M=re[0].intersectionRatio;if(M!==f){if(!q)return c();M?c(!1,M):n=setTimeout(()=>{c(!1,1e-7)},1e3)}M===1&&!xN(h,t.getBoundingClientRect())&&c(),q=!1}try{r=new IntersectionObserver(me,{...B,root:a.ownerDocument})}catch{r=new IntersectionObserver(me,B)}r.observe(t)}return c(!0),l}function ET(t,s,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:f=!1}=n,h=ah(t),v=a||l?[...h?hc(h):[],...hc(s)]:[];v.forEach(I=>{a&&I.addEventListener("scroll",r,{passive:!0}),l&&I.addEventListener("resize",r)});const w=h&&u?_T(h,r):null;let j=-1,C=null;c&&(C=new ResizeObserver(I=>{let[F]=I;F&&F.target===h&&C&&(C.unobserve(s),cancelAnimationFrame(j),j=requestAnimationFrame(()=>{var B;(B=C)==null||B.observe(s)})),r()}),h&&!f&&C.observe(h),C.observe(s));let k,S=f?Zi(t):null;f&&_();function _(){const I=Zi(t);S&&!xN(S,I)&&r(),S=I,k=requestAnimationFrame(_)}return r(),()=>{var I;v.forEach(F=>{a&&F.removeEventListener("scroll",r),l&&F.removeEventListener("resize",r)}),w?.(),(I=C)==null||I.disconnect(),C=null,f&&cancelAnimationFrame(k)}}const PT=Z5,AT=eT,TT=K5,OT=sT,RT=X5,Zv=Y5,DT=tT,LT=(t,s,r)=>{const n=new Map,a={platform:CT,...r},l={...a.platform,_c:n};return H5(t,s,{...a,platform:l})};var FT=typeof document<"u",MT=function(){},Cu=FT?d.useLayoutEffect:MT;function Iu(t,s){if(t===s)return!0;if(typeof t!=typeof s)return!1;if(typeof t=="function"&&t.toString()===s.toString())return!0;let r,n,a;if(t&&s&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==s.length)return!1;for(n=r;n--!==0;)if(!Iu(t[n],s[n]))return!1;return!0}if(a=Object.keys(t),r=a.length,r!==Object.keys(s).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(s,a[n]))return!1;for(n=r;n--!==0;){const l=a[n];if(!(l==="_owner"&&t.$$typeof)&&!Iu(t[l],s[l]))return!1}return!0}return t!==t&&s!==s}function hN(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function eb(t,s){const r=hN(t);return Math.round(s*r)/r}function M0(t){const s=d.useRef(t);return Cu(()=>{s.current=t}),s}function IT(t){t===void 0&&(t={});const{placement:s="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:l,floating:c}={},transform:u=!0,whileElementsMounted:f,open:h}=t,[v,w]=d.useState({x:0,y:0,strategy:r,placement:s,middlewareData:{},isPositioned:!1}),[j,C]=d.useState(n);Iu(j,n)||C(n);const[k,S]=d.useState(null),[_,I]=d.useState(null),F=d.useCallback(Q=>{Q!==re.current&&(re.current=Q,S(Q))},[]),B=d.useCallback(Q=>{Q!==M.current&&(M.current=Q,I(Q))},[]),q=l||k,me=c||_,re=d.useRef(null),M=d.useRef(null),W=d.useRef(v),oe=f!=null,X=M0(f),he=M0(a),ue=M0(h),_e=d.useCallback(()=>{if(!re.current||!M.current)return;const Q={placement:s,strategy:r,middleware:j};he.current&&(Q.platform=he.current),LT(re.current,M.current,Q).then(be=>{const pe={...be,isPositioned:ue.current!==!1};ke.current&&!Iu(W.current,pe)&&(W.current=pe,Ec.flushSync(()=>{w(pe)}))})},[j,s,r,he,ue]);Cu(()=>{h===!1&&W.current.isPositioned&&(W.current.isPositioned=!1,w(Q=>({...Q,isPositioned:!1})))},[h]);const ke=d.useRef(!1);Cu(()=>(ke.current=!0,()=>{ke.current=!1}),[]),Cu(()=>{if(q&&(re.current=q),me&&(M.current=me),q&&me){if(X.current)return X.current(q,me,_e);_e()}},[q,me,_e,X,oe]);const Re=d.useMemo(()=>({reference:re,floating:M,setReference:F,setFloating:B}),[F,B]),Y=d.useMemo(()=>({reference:q,floating:me}),[q,me]),ve=d.useMemo(()=>{const Q={position:r,left:0,top:0};if(!Y.floating)return Q;const be=eb(Y.floating,v.x),pe=eb(Y.floating,v.y);return u?{...Q,transform:"translate("+be+"px, "+pe+"px)",...hN(Y.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:be,top:pe}},[r,u,Y.floating,v.x,v.y]);return d.useMemo(()=>({...v,update:_e,refs:Re,elements:Y,floatingStyles:ve}),[v,_e,Re,Y,ve])}const qT=t=>{function s(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:a}=typeof t=="function"?t(r):t;return n&&s(n)?n.current!=null?Zv({element:n.current,padding:a}).fn(r):{}:n?Zv({element:n,padding:a}).fn(r):{}}}},BT=(t,s)=>({...PT(t),options:[t,s]}),zT=(t,s)=>({...AT(t),options:[t,s]}),$T=(t,s)=>({...DT(t),options:[t,s]}),QT=(t,s)=>({...TT(t),options:[t,s]}),UT=(t,s)=>({...OT(t),options:[t,s]}),VT=(t,s)=>({...RT(t),options:[t,s]}),WT=(t,s)=>({...qT(t),options:[t,s]});var GT="Arrow",fN=d.forwardRef((t,s)=>{const{children:r,width:n=10,height:a=5,...l}=t;return e.jsx(bs.svg,{...l,ref:s,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});fN.displayName=GT;var HT=fN,ih="Popper",[gN,mo]=Ga(ih),[YT,yN]=gN(ih),vN=t=>{const{__scopePopper:s,children:r}=t,[n,a]=d.useState(null);return e.jsx(YT,{scope:s,anchor:n,onAnchorChange:a,children:r})};vN.displayName=ih;var bN="PopperAnchor",wN=d.forwardRef((t,s)=>{const{__scopePopper:r,virtualRef:n,...a}=t,l=yN(bN,r),c=d.useRef(null),u=Ts(s,c),f=d.useRef(null);return d.useEffect(()=>{const h=f.current;f.current=n?.current||c.current,h!==f.current&&l.onAnchorChange(f.current)}),n?null:e.jsx(bs.div,{...a,ref:u})});wN.displayName=bN;var lh="PopperContent",[KT,XT]=gN(lh),NN=d.forwardRef((t,s)=>{const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:l="center",alignOffset:c=0,arrowPadding:u=0,avoidCollisions:f=!0,collisionBoundary:h=[],collisionPadding:v=0,sticky:w="partial",hideWhenDetached:j=!1,updatePositionStrategy:C="optimized",onPlaced:k,...S}=t,_=yN(lh,r),[I,F]=d.useState(null),B=Ts(s,fe=>F(fe)),[q,me]=d.useState(null),re=I1(q),M=re?.width??0,W=re?.height??0,oe=n+(l!=="center"?"-"+l:""),X=typeof v=="number"?v:{top:0,right:0,bottom:0,left:0,...v},he=Array.isArray(h)?h:[h],ue=he.length>0,_e={padding:X,boundary:he.filter(ZT),altBoundary:ue},{refs:ke,floatingStyles:Re,placement:Y,isPositioned:ve,middlewareData:Q}=IT({strategy:"fixed",placement:oe,whileElementsMounted:(...fe)=>ET(...fe,{animationFrame:C==="always"}),elements:{reference:_.anchor},middleware:[BT({mainAxis:a+W,alignmentAxis:c}),f&&zT({mainAxis:!0,crossAxis:!1,limiter:w==="partial"?$T():void 0,..._e}),f&&QT({..._e}),UT({..._e,apply:({elements:fe,rects:Ee,availableWidth:Le,availableHeight:De})=>{const{width:Ve,height:et}=Ee.reference,Nt=fe.floating.style;Nt.setProperty("--radix-popper-available-width",`${Le}px`),Nt.setProperty("--radix-popper-available-height",`${De}px`),Nt.setProperty("--radix-popper-anchor-width",`${Ve}px`),Nt.setProperty("--radix-popper-anchor-height",`${et}px`)}}),q&&WT({element:q,padding:u}),eO({arrowWidth:M,arrowHeight:W}),j&&VT({strategy:"referenceHidden",..._e})]}),[be,pe]=kN(Y),ne=Zn(k);Sr(()=>{ve&&ne?.()},[ve,ne]);const U=Q.arrow?.x,ce=Q.arrow?.y,z=Q.arrow?.centerOffset!==0,[ae,ye]=d.useState();return Sr(()=>{I&&ye(window.getComputedStyle(I).zIndex)},[I]),e.jsx("div",{ref:ke.setFloating,"data-radix-popper-content-wrapper":"",style:{...Re,transform:ve?Re.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ae,"--radix-popper-transform-origin":[Q.transformOrigin?.x,Q.transformOrigin?.y].join(" "),...Q.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:e.jsx(KT,{scope:r,placedSide:be,onArrowChange:me,arrowX:U,arrowY:ce,shouldHideArrow:z,children:e.jsx(bs.div,{"data-side":be,"data-align":pe,...S,ref:B,style:{...S.style,animation:ve?void 0:"none"}})})})});NN.displayName=lh;var jN="PopperArrow",JT={top:"bottom",right:"left",bottom:"top",left:"right"},SN=d.forwardRef(function(s,r){const{__scopePopper:n,...a}=s,l=XT(jN,n),c=JT[l.placedSide];return e.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:e.jsx(HT,{...a,ref:r,style:{...a.style,display:"block"}})})});SN.displayName=jN;function ZT(t){return t!==null}var eO=t=>({name:"transformOrigin",options:t,fn(s){const{placement:r,rects:n,middlewareData:a}=s,c=a.arrow?.centerOffset!==0,u=c?0:t.arrowWidth,f=c?0:t.arrowHeight,[h,v]=kN(r),w={start:"0%",center:"50%",end:"100%"}[v],j=(a.arrow?.x??0)+u/2,C=(a.arrow?.y??0)+f/2;let k="",S="";return h==="bottom"?(k=c?w:`${j}px`,S=`${-f}px`):h==="top"?(k=c?w:`${j}px`,S=`${n.floating.height+f}px`):h==="right"?(k=`${-f}px`,S=c?w:`${C}px`):h==="left"&&(k=`${n.floating.width+f}px`,S=c?w:`${C}px`),{data:{x:k,y:S}}}});function kN(t){const[s,r="center"]=t.split("-");return[s,r]}var oh=vN,jm=wN,ch=NN,dh=SN;function tO(t){const s=sO(t),r=d.forwardRef((n,a)=>{const{children:l,...c}=n,u=d.Children.toArray(l),f=u.find(nO);if(f){const h=f.props.children,v=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(s,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,v):null})}return e.jsx(s,{...c,ref:a,children:l})});return r.displayName=`${t}.Slot`,r}function sO(t){const s=d.forwardRef((r,n)=>{const{children:a,...l}=r;if(d.isValidElement(a)){const c=iO(a),u=aO(l,a.props);return a.type!==d.Fragment&&(u.ref=n?ka(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var rO=Symbol("radix.slottable");function nO(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===rO}function aO(t,s){const r={...s};for(const n in s){const a=t[n],l=s[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(r[n]=a):n==="style"?r[n]={...a,...l}:n==="className"&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...t,...r}}function iO(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var CN=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),lO="VisuallyHidden",oO=d.forwardRef((t,s)=>e.jsx(bs.span,{...t,ref:s,style:{...CN,...t.style}}));oO.displayName=lO;var cO=[" ","Enter","ArrowUp","ArrowDown"],dO=[" ","Enter"],el="Select",[Sm,km,uO]=Jx(el),[po]=Ga(el,[uO,mo]),Cm=mo(),[mO,_i]=po(el),[pO,xO]=po(el),_N=t=>{const{__scopeSelect:s,children:r,open:n,defaultOpen:a,onOpenChange:l,value:c,defaultValue:u,onValueChange:f,dir:h,name:v,autoComplete:w,disabled:j,required:C,form:k}=t,S=Cm(s),[_,I]=d.useState(null),[F,B]=d.useState(null),[q,me]=d.useState(!1),re=Zx(h),[M,W]=Ki({prop:n,defaultProp:a??!1,onChange:l,caller:el}),[oe,X]=Ki({prop:c,defaultProp:u,onChange:f,caller:el}),he=d.useRef(null),ue=_?k||!!_.closest("form"):!0,[_e,ke]=d.useState(new Set),Re=Array.from(_e).map(Y=>Y.props.value).join(";");return e.jsx(oh,{...S,children:e.jsxs(mO,{required:C,scope:s,trigger:_,onTriggerChange:I,valueNode:F,onValueNodeChange:B,valueNodeHasChildren:q,onValueNodeHasChildrenChange:me,contentId:ya(),value:oe,onValueChange:X,open:M,onOpenChange:W,dir:re,triggerPointerDownPosRef:he,disabled:j,children:[e.jsx(Sm.Provider,{scope:s,children:e.jsx(pO,{scope:t.__scopeSelect,onNativeOptionAdd:d.useCallback(Y=>{ke(ve=>new Set(ve).add(Y))},[]),onNativeOptionRemove:d.useCallback(Y=>{ke(ve=>{const Q=new Set(ve);return Q.delete(Y),Q})},[]),children:r})}),ue?e.jsxs(YN,{"aria-hidden":!0,required:C,tabIndex:-1,name:v,autoComplete:w,value:oe,onChange:Y=>X(Y.target.value),disabled:j,form:k,children:[oe===void 0?e.jsx("option",{value:""}):null,Array.from(_e)]},Re):null]})})};_N.displayName=el;var EN="SelectTrigger",PN=d.forwardRef((t,s)=>{const{__scopeSelect:r,disabled:n=!1,...a}=t,l=Cm(r),c=_i(EN,r),u=c.disabled||n,f=Ts(s,c.onTriggerChange),h=km(r),v=d.useRef("touch"),[w,j,C]=XN(S=>{const _=h().filter(B=>!B.disabled),I=_.find(B=>B.value===c.value),F=JN(_,S,I);F!==void 0&&c.onValueChange(F.value)}),k=S=>{u||(c.onOpenChange(!0),C()),S&&(c.triggerPointerDownPosRef.current={x:Math.round(S.pageX),y:Math.round(S.pageY)})};return e.jsx(jm,{asChild:!0,...l,children:e.jsx(bs.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:u,"data-disabled":u?"":void 0,"data-placeholder":KN(c.value)?"":void 0,...a,ref:f,onClick:rs(a.onClick,S=>{S.currentTarget.focus(),v.current!=="mouse"&&k(S)}),onPointerDown:rs(a.onPointerDown,S=>{v.current=S.pointerType;const _=S.target;_.hasPointerCapture(S.pointerId)&&_.releasePointerCapture(S.pointerId),S.button===0&&S.ctrlKey===!1&&S.pointerType==="mouse"&&(k(S),S.preventDefault())}),onKeyDown:rs(a.onKeyDown,S=>{const _=w.current!=="";!(S.ctrlKey||S.altKey||S.metaKey)&&S.key.length===1&&j(S.key),!(_&&S.key===" ")&&cO.includes(S.key)&&(k(),S.preventDefault())})})})});PN.displayName=EN;var AN="SelectValue",TN=d.forwardRef((t,s)=>{const{__scopeSelect:r,className:n,style:a,children:l,placeholder:c="",...u}=t,f=_i(AN,r),{onValueNodeHasChildrenChange:h}=f,v=l!==void 0,w=Ts(s,f.onValueNodeChange);return Sr(()=>{h(v)},[h,v]),e.jsx(bs.span,{...u,ref:w,style:{pointerEvents:"none"},children:KN(f.value)?e.jsx(e.Fragment,{children:c}):l})});TN.displayName=AN;var hO="SelectIcon",ON=d.forwardRef((t,s)=>{const{__scopeSelect:r,children:n,...a}=t;return e.jsx(bs.span,{"aria-hidden":!0,...a,ref:s,children:n||""})});ON.displayName=hO;var fO="SelectPortal",RN=t=>e.jsx(Lc,{asChild:!0,...t});RN.displayName=fO;var tl="SelectContent",DN=d.forwardRef((t,s)=>{const r=_i(tl,t.__scopeSelect),[n,a]=d.useState();if(Sr(()=>{a(new DocumentFragment)},[]),!r.open){const l=n;return l?Ec.createPortal(e.jsx(LN,{scope:t.__scopeSelect,children:e.jsx(Sm.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),l):null}return e.jsx(FN,{...t,ref:s})});DN.displayName=tl;var Hn=10,[LN,Ei]=po(tl),gO="SelectContentImpl",yO=tO("SelectContent.RemoveScroll"),FN=d.forwardRef((t,s)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:l,onPointerDownOutside:c,side:u,sideOffset:f,align:h,alignOffset:v,arrowPadding:w,collisionBoundary:j,collisionPadding:C,sticky:k,hideWhenDetached:S,avoidCollisions:_,...I}=t,F=_i(tl,r),[B,q]=d.useState(null),[me,re]=d.useState(null),M=Ts(s,fe=>q(fe)),[W,oe]=d.useState(null),[X,he]=d.useState(null),ue=km(r),[_e,ke]=d.useState(!1),Re=d.useRef(!1);d.useEffect(()=>{if(B)return gm(B)},[B]),hm();const Y=d.useCallback(fe=>{const[Ee,...Le]=ue().map(et=>et.ref.current),[De]=Le.slice(-1),Ve=document.activeElement;for(const et of fe)if(et===Ve||(et?.scrollIntoView({block:"nearest"}),et===Ee&&me&&(me.scrollTop=0),et===De&&me&&(me.scrollTop=me.scrollHeight),et?.focus(),document.activeElement!==Ve))return},[ue,me]),ve=d.useCallback(()=>Y([W,B]),[Y,W,B]);d.useEffect(()=>{_e&&ve()},[_e,ve]);const{onOpenChange:Q,triggerPointerDownPosRef:be}=F;d.useEffect(()=>{if(B){let fe={x:0,y:0};const Ee=De=>{fe={x:Math.abs(Math.round(De.pageX)-(be.current?.x??0)),y:Math.abs(Math.round(De.pageY)-(be.current?.y??0))}},Le=De=>{fe.x<=10&&fe.y<=10?De.preventDefault():B.contains(De.target)||Q(!1),document.removeEventListener("pointermove",Ee),be.current=null};return be.current!==null&&(document.addEventListener("pointermove",Ee),document.addEventListener("pointerup",Le,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Ee),document.removeEventListener("pointerup",Le,{capture:!0})}}},[B,Q,be]),d.useEffect(()=>{const fe=()=>Q(!1);return window.addEventListener("blur",fe),window.addEventListener("resize",fe),()=>{window.removeEventListener("blur",fe),window.removeEventListener("resize",fe)}},[Q]);const[pe,ne]=XN(fe=>{const Ee=ue().filter(Ve=>!Ve.disabled),Le=Ee.find(Ve=>Ve.ref.current===document.activeElement),De=JN(Ee,fe,Le);De&&setTimeout(()=>De.ref.current.focus())}),U=d.useCallback((fe,Ee,Le)=>{const De=!Re.current&&!Le;(F.value!==void 0&&F.value===Ee||De)&&(oe(fe),De&&(Re.current=!0))},[F.value]),ce=d.useCallback(()=>B?.focus(),[B]),z=d.useCallback((fe,Ee,Le)=>{const De=!Re.current&&!Le;(F.value!==void 0&&F.value===Ee||De)&&he(fe)},[F.value]),ae=n==="popper"?vx:MN,ye=ae===vx?{side:u,sideOffset:f,align:h,alignOffset:v,arrowPadding:w,collisionBoundary:j,collisionPadding:C,sticky:k,hideWhenDetached:S,avoidCollisions:_}:{};return e.jsx(LN,{scope:r,content:B,viewport:me,onViewportChange:re,itemRefCallback:U,selectedItem:W,onItemLeave:ce,itemTextRefCallback:z,focusSelectedItem:ve,selectedItemText:X,position:n,isPositioned:_e,searchRef:pe,children:e.jsx(Fc,{as:yO,allowPinchZoom:!0,children:e.jsx(Dc,{asChild:!0,trapped:F.open,onMountAutoFocus:fe=>{fe.preventDefault()},onUnmountAutoFocus:rs(a,fe=>{F.trigger?.focus({preventScroll:!0}),fe.preventDefault()}),children:e.jsx(Rc,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:fe=>fe.preventDefault(),onDismiss:()=>F.onOpenChange(!1),children:e.jsx(ae,{role:"listbox",id:F.contentId,"data-state":F.open?"open":"closed",dir:F.dir,onContextMenu:fe=>fe.preventDefault(),...I,...ye,onPlaced:()=>ke(!0),ref:M,style:{display:"flex",flexDirection:"column",outline:"none",...I.style},onKeyDown:rs(I.onKeyDown,fe=>{const Ee=fe.ctrlKey||fe.altKey||fe.metaKey;if(fe.key==="Tab"&&fe.preventDefault(),!Ee&&fe.key.length===1&&ne(fe.key),["ArrowUp","ArrowDown","Home","End"].includes(fe.key)){let De=ue().filter(Ve=>!Ve.disabled).map(Ve=>Ve.ref.current);if(["ArrowUp","End"].includes(fe.key)&&(De=De.slice().reverse()),["ArrowUp","ArrowDown"].includes(fe.key)){const Ve=fe.target,et=De.indexOf(Ve);De=De.slice(et+1)}setTimeout(()=>Y(De)),fe.preventDefault()}})})})})})})});FN.displayName=gO;var vO="SelectItemAlignedPosition",MN=d.forwardRef((t,s)=>{const{__scopeSelect:r,onPlaced:n,...a}=t,l=_i(tl,r),c=Ei(tl,r),[u,f]=d.useState(null),[h,v]=d.useState(null),w=Ts(s,M=>v(M)),j=km(r),C=d.useRef(!1),k=d.useRef(!0),{viewport:S,selectedItem:_,selectedItemText:I,focusSelectedItem:F}=c,B=d.useCallback(()=>{if(l.trigger&&l.valueNode&&u&&h&&S&&_&&I){const M=l.trigger.getBoundingClientRect(),W=h.getBoundingClientRect(),oe=l.valueNode.getBoundingClientRect(),X=I.getBoundingClientRect();if(l.dir!=="rtl"){const Ve=X.left-W.left,et=oe.left-Ve,Nt=M.left-et,ot=M.width+Nt,Qt=Math.max(ot,W.width),qe=window.innerWidth-Hn,Me=$v(et,[Hn,Math.max(Hn,qe-Qt)]);u.style.minWidth=ot+"px",u.style.left=Me+"px"}else{const Ve=W.right-X.right,et=window.innerWidth-oe.right-Ve,Nt=window.innerWidth-M.right-et,ot=M.width+Nt,Qt=Math.max(ot,W.width),qe=window.innerWidth-Hn,Me=$v(et,[Hn,Math.max(Hn,qe-Qt)]);u.style.minWidth=ot+"px",u.style.right=Me+"px"}const he=j(),ue=window.innerHeight-Hn*2,_e=S.scrollHeight,ke=window.getComputedStyle(h),Re=parseInt(ke.borderTopWidth,10),Y=parseInt(ke.paddingTop,10),ve=parseInt(ke.borderBottomWidth,10),Q=parseInt(ke.paddingBottom,10),be=Re+Y+_e+Q+ve,pe=Math.min(_.offsetHeight*5,be),ne=window.getComputedStyle(S),U=parseInt(ne.paddingTop,10),ce=parseInt(ne.paddingBottom,10),z=M.top+M.height/2-Hn,ae=ue-z,ye=_.offsetHeight/2,fe=_.offsetTop+ye,Ee=Re+Y+fe,Le=be-Ee;if(Ee<=z){const Ve=he.length>0&&_===he[he.length-1].ref.current;u.style.bottom="0px";const et=h.clientHeight-S.offsetTop-S.offsetHeight,Nt=Math.max(ae,ye+(Ve?ce:0)+et+ve),ot=Ee+Nt;u.style.height=ot+"px"}else{const Ve=he.length>0&&_===he[0].ref.current;u.style.top="0px";const Nt=Math.max(z,Re+S.offsetTop+(Ve?U:0)+ye)+Le;u.style.height=Nt+"px",S.scrollTop=Ee-z+S.offsetTop}u.style.margin=`${Hn}px 0`,u.style.minHeight=pe+"px",u.style.maxHeight=ue+"px",n?.(),requestAnimationFrame(()=>C.current=!0)}},[j,l.trigger,l.valueNode,u,h,S,_,I,l.dir,n]);Sr(()=>B(),[B]);const[q,me]=d.useState();Sr(()=>{h&&me(window.getComputedStyle(h).zIndex)},[h]);const re=d.useCallback(M=>{M&&k.current===!0&&(B(),F?.(),k.current=!1)},[B,F]);return e.jsx(wO,{scope:r,contentWrapper:u,shouldExpandOnScrollRef:C,onScrollButtonChange:re,children:e.jsx("div",{ref:f,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:q},children:e.jsx(bs.div,{...a,ref:w,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});MN.displayName=vO;var bO="SelectPopperPosition",vx=d.forwardRef((t,s)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=Hn,...l}=t,c=Cm(r);return e.jsx(ch,{...c,...l,ref:s,align:n,collisionPadding:a,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});vx.displayName=bO;var[wO,uh]=po(tl,{}),bx="SelectViewport",IN=d.forwardRef((t,s)=>{const{__scopeSelect:r,nonce:n,...a}=t,l=Ei(bx,r),c=uh(bx,r),u=Ts(s,l.onViewportChange),f=d.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(Sm.Slot,{scope:r,children:e.jsx(bs.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:u,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:rs(a.onScroll,h=>{const v=h.currentTarget,{contentWrapper:w,shouldExpandOnScrollRef:j}=c;if(j?.current&&w){const C=Math.abs(f.current-v.scrollTop);if(C>0){const k=window.innerHeight-Hn*2,S=parseFloat(w.style.minHeight),_=parseFloat(w.style.height),I=Math.max(S,_);if(I<k){const F=I+C,B=Math.min(k,F),q=F-B;w.style.height=B+"px",w.style.bottom==="0px"&&(v.scrollTop=q>0?q:0,w.style.justifyContent="flex-end")}}}f.current=v.scrollTop})})})]})});IN.displayName=bx;var qN="SelectGroup",[NO,jO]=po(qN),SO=d.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t,a=ya();return e.jsx(NO,{scope:r,id:a,children:e.jsx(bs.div,{role:"group","aria-labelledby":a,...n,ref:s})})});SO.displayName=qN;var BN="SelectLabel",kO=d.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t,a=jO(BN,r);return e.jsx(bs.div,{id:a.id,...n,ref:s})});kO.displayName=BN;var qu="SelectItem",[CO,zN]=po(qu),$N=d.forwardRef((t,s)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:l,...c}=t,u=_i(qu,r),f=Ei(qu,r),h=u.value===n,[v,w]=d.useState(l??""),[j,C]=d.useState(!1),k=Ts(s,F=>f.itemRefCallback?.(F,n,a)),S=ya(),_=d.useRef("touch"),I=()=>{a||(u.onValueChange(n),u.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(CO,{scope:r,value:n,disabled:a,textId:S,isSelected:h,onItemTextChange:d.useCallback(F=>{w(B=>B||(F?.textContent??"").trim())},[]),children:e.jsx(Sm.ItemSlot,{scope:r,value:n,disabled:a,textValue:v,children:e.jsx(bs.div,{role:"option","aria-labelledby":S,"data-highlighted":j?"":void 0,"aria-selected":h&&j,"data-state":h?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...c,ref:k,onFocus:rs(c.onFocus,()=>C(!0)),onBlur:rs(c.onBlur,()=>C(!1)),onClick:rs(c.onClick,()=>{_.current!=="mouse"&&I()}),onPointerUp:rs(c.onPointerUp,()=>{_.current==="mouse"&&I()}),onPointerDown:rs(c.onPointerDown,F=>{_.current=F.pointerType}),onPointerMove:rs(c.onPointerMove,F=>{_.current=F.pointerType,a?f.onItemLeave?.():_.current==="mouse"&&F.currentTarget.focus({preventScroll:!0})}),onPointerLeave:rs(c.onPointerLeave,F=>{F.currentTarget===document.activeElement&&f.onItemLeave?.()}),onKeyDown:rs(c.onKeyDown,F=>{f.searchRef?.current!==""&&F.key===" "||(dO.includes(F.key)&&I(),F.key===" "&&F.preventDefault())})})})})});$N.displayName=qu;var nc="SelectItemText",QN=d.forwardRef((t,s)=>{const{__scopeSelect:r,className:n,style:a,...l}=t,c=_i(nc,r),u=Ei(nc,r),f=zN(nc,r),h=xO(nc,r),[v,w]=d.useState(null),j=Ts(s,I=>w(I),f.onItemTextChange,I=>u.itemTextRefCallback?.(I,f.value,f.disabled)),C=v?.textContent,k=d.useMemo(()=>e.jsx("option",{value:f.value,disabled:f.disabled,children:C},f.value),[f.disabled,f.value,C]),{onNativeOptionAdd:S,onNativeOptionRemove:_}=h;return Sr(()=>(S(k),()=>_(k)),[S,_,k]),e.jsxs(e.Fragment,{children:[e.jsx(bs.span,{id:f.textId,...l,ref:j}),f.isSelected&&c.valueNode&&!c.valueNodeHasChildren?Ec.createPortal(l.children,c.valueNode):null]})});QN.displayName=nc;var UN="SelectItemIndicator",VN=d.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t;return zN(UN,r).isSelected?e.jsx(bs.span,{"aria-hidden":!0,...n,ref:s}):null});VN.displayName=UN;var wx="SelectScrollUpButton",WN=d.forwardRef((t,s)=>{const r=Ei(wx,t.__scopeSelect),n=uh(wx,t.__scopeSelect),[a,l]=d.useState(!1),c=Ts(s,n.onScrollButtonChange);return Sr(()=>{if(r.viewport&&r.isPositioned){let u=function(){const h=f.scrollTop>0;l(h)};const f=r.viewport;return u(),f.addEventListener("scroll",u),()=>f.removeEventListener("scroll",u)}},[r.viewport,r.isPositioned]),a?e.jsx(HN,{...t,ref:c,onAutoScroll:()=>{const{viewport:u,selectedItem:f}=r;u&&f&&(u.scrollTop=u.scrollTop-f.offsetHeight)}}):null});WN.displayName=wx;var Nx="SelectScrollDownButton",GN=d.forwardRef((t,s)=>{const r=Ei(Nx,t.__scopeSelect),n=uh(Nx,t.__scopeSelect),[a,l]=d.useState(!1),c=Ts(s,n.onScrollButtonChange);return Sr(()=>{if(r.viewport&&r.isPositioned){let u=function(){const h=f.scrollHeight-f.clientHeight,v=Math.ceil(f.scrollTop)<h;l(v)};const f=r.viewport;return u(),f.addEventListener("scroll",u),()=>f.removeEventListener("scroll",u)}},[r.viewport,r.isPositioned]),a?e.jsx(HN,{...t,ref:c,onAutoScroll:()=>{const{viewport:u,selectedItem:f}=r;u&&f&&(u.scrollTop=u.scrollTop+f.offsetHeight)}}):null});GN.displayName=Nx;var HN=d.forwardRef((t,s)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=t,l=Ei("SelectScrollButton",r),c=d.useRef(null),u=km(r),f=d.useCallback(()=>{c.current!==null&&(window.clearInterval(c.current),c.current=null)},[]);return d.useEffect(()=>()=>f(),[f]),Sr(()=>{u().find(v=>v.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[u]),e.jsx(bs.div,{"aria-hidden":!0,...a,ref:s,style:{flexShrink:0,...a.style},onPointerDown:rs(a.onPointerDown,()=>{c.current===null&&(c.current=window.setInterval(n,50))}),onPointerMove:rs(a.onPointerMove,()=>{l.onItemLeave?.(),c.current===null&&(c.current=window.setInterval(n,50))}),onPointerLeave:rs(a.onPointerLeave,()=>{f()})})}),_O="SelectSeparator",EO=d.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t;return e.jsx(bs.div,{"aria-hidden":!0,...n,ref:s})});EO.displayName=_O;var jx="SelectArrow",PO=d.forwardRef((t,s)=>{const{__scopeSelect:r,...n}=t,a=Cm(r),l=_i(jx,r),c=Ei(jx,r);return l.open&&c.position==="popper"?e.jsx(dh,{...a,...n,ref:s}):null});PO.displayName=jx;var AO="SelectBubbleInput",YN=d.forwardRef(({__scopeSelect:t,value:s,...r},n)=>{const a=d.useRef(null),l=Ts(n,a),c=M1(s);return d.useEffect(()=>{const u=a.current;if(!u)return;const f=window.HTMLSelectElement.prototype,v=Object.getOwnPropertyDescriptor(f,"value").set;if(c!==s&&v){const w=new Event("change",{bubbles:!0});v.call(u,s),u.dispatchEvent(w)}},[c,s]),e.jsx(bs.select,{...r,style:{...CN,...r.style},ref:l,defaultValue:s})});YN.displayName=AO;function KN(t){return t===""||t===void 0}function XN(t){const s=Zn(t),r=d.useRef(""),n=d.useRef(0),a=d.useCallback(c=>{const u=r.current+c;s(u),(function f(h){r.current=h,window.clearTimeout(n.current),h!==""&&(n.current=window.setTimeout(()=>f(""),1e3))})(u)},[s]),l=d.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return d.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,l]}function JN(t,s,r){const a=s.length>1&&Array.from(s).every(h=>h===s[0])?s[0]:s,l=r?t.indexOf(r):-1;let c=TO(t,Math.max(l,0));a.length===1&&(c=c.filter(h=>h!==r));const f=c.find(h=>h.textValue.toLowerCase().startsWith(a.toLowerCase()));return f!==r?f:void 0}function TO(t,s){return t.map((r,n)=>t[(s+n)%t.length])}var OO=_N,RO=PN,DO=TN,LO=ON,FO=RN,MO=DN,IO=IN,qO=$N,BO=QN,zO=VN,$O=WN,QO=GN;function sr({...t}){return e.jsx(OO,{"data-slot":"select",...t})}function rr({...t}){return e.jsx(DO,{"data-slot":"select-value",...t})}function nr({className:t,size:s="default",children:r,...n}){return e.jsxs(RO,{"data-slot":"select-trigger","data-size":s,className:js("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-all duration-200 outline-none focus-visible:ring-[3px] focus-visible:shadow-sm hover:border-ring/50 disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[r,e.jsx(LO,{asChild:!0,children:e.jsx(Qx,{className:"size-4 opacity-50"})})]})}function ar({className:t,children:s,position:r="popper",...n}){return e.jsx(FO,{children:e.jsxs(MO,{"data-slot":"select-content",className:js("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[e.jsx(UO,{}),e.jsx(IO,{className:js("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),e.jsx(VO,{})]})})}function Es({className:t,children:s,...r}){return e.jsxs(qO,{"data-slot":"select-item",className:js("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(zO,{children:e.jsx(Y1,{className:"size-4"})})}),e.jsx(BO,{children:s})]})}function UO({className:t,...s}){return e.jsx($O,{"data-slot":"select-scroll-up-button",className:js("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(J1,{className:"size-4"})})}function VO({className:t,...s}){return e.jsx(QO,{"data-slot":"select-scroll-down-button",className:js("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Qx,{className:"size-4"})})}function ks(t){const s=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&s==="[object Date]"?new t.constructor(+t):typeof t=="number"||s==="[object Number]"||typeof t=="string"||s==="[object String]"?new Date(t):new Date(NaN)}function _n(t,s){return t instanceof Date?new t.constructor(s):new Date(s)}function Xr(t,s){const r=ks(t);return isNaN(s)?_n(t,NaN):(s&&r.setDate(r.getDate()+s),r)}function sa(t,s){const r=ks(t);if(isNaN(s))return _n(t,NaN);if(!s)return r;const n=r.getDate(),a=_n(t,r.getTime());a.setMonth(r.getMonth()+s+1,0);const l=a.getDate();return n>=l?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const mh=6048e5,WO=864e5;let GO={};function Ic(){return GO}function wa(t,s){const r=Ic(),n=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=ks(t),l=a.getDay(),c=(l<n?7:0)+l-n;return a.setDate(a.getDate()-c),a.setHours(0,0,0,0),a}function sl(t){return wa(t,{weekStartsOn:1})}function ZN(t){const s=ks(t),r=s.getFullYear(),n=_n(t,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=sl(n),l=_n(t,0);l.setFullYear(r,0,4),l.setHours(0,0,0,0);const c=sl(l);return s.getTime()>=a.getTime()?r+1:s.getTime()>=c.getTime()?r:r-1}function Zl(t){const s=ks(t);return s.setHours(0,0,0,0),s}function Bu(t){const s=ks(t),r=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return r.setUTCFullYear(s.getFullYear()),+t-+r}function ga(t,s){const r=Zl(t),n=Zl(s),a=+r-Bu(r),l=+n-Bu(n);return Math.round((a-l)/WO)}function HO(t){const s=ZN(t),r=_n(t,0);return r.setFullYear(s,0,4),r.setHours(0,0,0,0),sl(r)}function Sx(t,s){const r=s*7;return Xr(t,r)}function YO(t,s){return sa(t,s*12)}function KO(t){let s;return t.forEach(function(r){const n=ks(r);(s===void 0||s<n||isNaN(Number(n)))&&(s=n)}),s||new Date(NaN)}function XO(t){let s;return t.forEach(r=>{const n=ks(r);(!s||s>n||isNaN(+n))&&(s=n)}),s||new Date(NaN)}function cn(t,s){const r=Zl(t),n=Zl(s);return+r==+n}function ph(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function JO(t){if(!ph(t)&&typeof t!="number")return!1;const s=ks(t);return!isNaN(Number(s))}function fc(t,s){const r=ks(t),n=ks(s),a=r.getFullYear()-n.getFullYear(),l=r.getMonth()-n.getMonth();return a*12+l}function ZO(t,s,r){const n=wa(t,r),a=wa(s,r),l=+n-Bu(n),c=+a-Bu(a);return Math.round((l-c)/mh)}function xh(t){const s=ks(t),r=s.getMonth();return s.setFullYear(s.getFullYear(),r+1,0),s.setHours(23,59,59,999),s}function mn(t){const s=ks(t);return s.setDate(1),s.setHours(0,0,0,0),s}function ej(t){const s=ks(t),r=_n(t,0);return r.setFullYear(s.getFullYear(),0,1),r.setHours(0,0,0,0),r}function hh(t,s){const r=Ic(),n=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=ks(t),l=a.getDay(),c=(l<n?-7:0)+6-(l-n);return a.setDate(a.getDate()+c),a.setHours(23,59,59,999),a}function tj(t){return hh(t,{weekStartsOn:1})}const eR={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},tR=(t,s,r)=>{let n;const a=eR[t];return typeof a=="string"?n=a:s===1?n=a.one:n=a.other.replace("{{count}}",s.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function I0(t){return(s={})=>{const r=s.width?String(s.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const sR={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},rR={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},nR={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},aR={date:I0({formats:sR,defaultWidth:"full"}),time:I0({formats:rR,defaultWidth:"full"}),dateTime:I0({formats:nR,defaultWidth:"full"})},iR={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},lR=(t,s,r,n)=>iR[t];function tc(t){return(s,r)=>{const n=r?.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const c=t.defaultFormattingWidth||t.defaultWidth,u=r?.width?String(r.width):c;a=t.formattingValues[u]||t.formattingValues[c]}else{const c=t.defaultWidth,u=r?.width?String(r.width):t.defaultWidth;a=t.values[u]||t.values[c]}const l=t.argumentCallback?t.argumentCallback(s):s;return a[l]}}const oR={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},cR={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},dR={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},uR={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},mR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},pR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},xR=(t,s)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},hR={ordinalNumber:xR,era:tc({values:oR,defaultWidth:"wide"}),quarter:tc({values:cR,defaultWidth:"wide",argumentCallback:t=>t-1}),month:tc({values:dR,defaultWidth:"wide"}),day:tc({values:uR,defaultWidth:"wide"}),dayPeriod:tc({values:mR,defaultWidth:"wide",formattingValues:pR,defaultFormattingWidth:"wide"})};function sc(t){return(s,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],l=s.match(a);if(!l)return null;const c=l[0],u=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],f=Array.isArray(u)?gR(u,w=>w.test(c)):fR(u,w=>w.test(c));let h;h=t.valueCallback?t.valueCallback(f):f,h=r.valueCallback?r.valueCallback(h):h;const v=s.slice(c.length);return{value:h,rest:v}}}function fR(t,s){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&s(t[r]))return r}function gR(t,s){for(let r=0;r<t.length;r++)if(s(t[r]))return r}function yR(t){return(s,r={})=>{const n=s.match(t.matchPattern);if(!n)return null;const a=n[0],l=s.match(t.parsePattern);if(!l)return null;let c=t.valueCallback?t.valueCallback(l[0]):l[0];c=r.valueCallback?r.valueCallback(c):c;const u=s.slice(a.length);return{value:c,rest:u}}}const vR=/^(\d+)(th|st|nd|rd)?/i,bR=/\d+/i,wR={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},NR={any:[/^b/i,/^(a|c)/i]},jR={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},SR={any:[/1/i,/2/i,/3/i,/4/i]},kR={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},CR={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_R={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ER={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},PR={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},AR={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},TR={ordinalNumber:yR({matchPattern:vR,parsePattern:bR,valueCallback:t=>parseInt(t,10)}),era:sc({matchPatterns:wR,defaultMatchWidth:"wide",parsePatterns:NR,defaultParseWidth:"any"}),quarter:sc({matchPatterns:jR,defaultMatchWidth:"wide",parsePatterns:SR,defaultParseWidth:"any",valueCallback:t=>t+1}),month:sc({matchPatterns:kR,defaultMatchWidth:"wide",parsePatterns:CR,defaultParseWidth:"any"}),day:sc({matchPatterns:_R,defaultMatchWidth:"wide",parsePatterns:ER,defaultParseWidth:"any"}),dayPeriod:sc({matchPatterns:PR,defaultMatchWidth:"any",parsePatterns:AR,defaultParseWidth:"any"})},sj={code:"en-US",formatDistance:tR,formatLong:aR,formatRelative:lR,localize:hR,match:TR,options:{weekStartsOn:0,firstWeekContainsDate:1}};function OR(t){const s=ks(t);return ga(s,ej(s))+1}function rj(t){const s=ks(t),r=+sl(s)-+HO(s);return Math.round(r/mh)+1}function nj(t,s){const r=ks(t),n=r.getFullYear(),a=Ic(),l=s?.firstWeekContainsDate??s?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,c=_n(t,0);c.setFullYear(n+1,0,l),c.setHours(0,0,0,0);const u=wa(c,s),f=_n(t,0);f.setFullYear(n,0,l),f.setHours(0,0,0,0);const h=wa(f,s);return r.getTime()>=u.getTime()?n+1:r.getTime()>=h.getTime()?n:n-1}function RR(t,s){const r=Ic(),n=s?.firstWeekContainsDate??s?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,a=nj(t,s),l=_n(t,0);return l.setFullYear(a,0,n),l.setHours(0,0,0,0),wa(l,s)}function aj(t,s){const r=ks(t),n=+wa(r,s)-+RR(r,s);return Math.round(n/mh)+1}function Ds(t,s){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(s,"0");return r+n}const hi={y(t,s){const r=t.getFullYear(),n=r>0?r:1-r;return Ds(s==="yy"?n%100:n,s.length)},M(t,s){const r=t.getMonth();return s==="M"?String(r+1):Ds(r+1,2)},d(t,s){return Ds(t.getDate(),s.length)},a(t,s){const r=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,s){return Ds(t.getHours()%12||12,s.length)},H(t,s){return Ds(t.getHours(),s.length)},m(t,s){return Ds(t.getMinutes(),s.length)},s(t,s){return Ds(t.getSeconds(),s.length)},S(t,s){const r=s.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Ds(a,s.length)}},ql={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},tb={G:function(t,s,r){const n=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,s,r){if(s==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return hi.y(t,s)},Y:function(t,s,r,n){const a=nj(t,n),l=a>0?a:1-a;if(s==="YY"){const c=l%100;return Ds(c,2)}return s==="Yo"?r.ordinalNumber(l,{unit:"year"}):Ds(l,s.length)},R:function(t,s){const r=ZN(t);return Ds(r,s.length)},u:function(t,s){const r=t.getFullYear();return Ds(r,s.length)},Q:function(t,s,r){const n=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(n);case"QQ":return Ds(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,s,r){const n=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(n);case"qq":return Ds(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,s,r){const n=t.getMonth();switch(s){case"M":case"MM":return hi.M(t,s);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,s,r){const n=t.getMonth();switch(s){case"L":return String(n+1);case"LL":return Ds(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,s,r,n){const a=aj(t,n);return s==="wo"?r.ordinalNumber(a,{unit:"week"}):Ds(a,s.length)},I:function(t,s,r){const n=rj(t);return s==="Io"?r.ordinalNumber(n,{unit:"week"}):Ds(n,s.length)},d:function(t,s,r){return s==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):hi.d(t,s)},D:function(t,s,r){const n=OR(t);return s==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Ds(n,s.length)},E:function(t,s,r){const n=t.getDay();switch(s){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,s,r,n){const a=t.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(s){case"e":return String(l);case"ee":return Ds(l,2);case"eo":return r.ordinalNumber(l,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,s,r,n){const a=t.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(s){case"c":return String(l);case"cc":return Ds(l,s.length);case"co":return r.ordinalNumber(l,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,s,r){const n=t.getDay(),a=n===0?7:n;switch(s){case"i":return String(a);case"ii":return Ds(a,s.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,s,r){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,s,r){const n=t.getHours();let a;switch(n===12?a=ql.noon:n===0?a=ql.midnight:a=n/12>=1?"pm":"am",s){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,s,r){const n=t.getHours();let a;switch(n>=17?a=ql.evening:n>=12?a=ql.afternoon:n>=4?a=ql.morning:a=ql.night,s){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,s,r){if(s==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return hi.h(t,s)},H:function(t,s,r){return s==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):hi.H(t,s)},K:function(t,s,r){const n=t.getHours()%12;return s==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Ds(n,s.length)},k:function(t,s,r){let n=t.getHours();return n===0&&(n=24),s==="ko"?r.ordinalNumber(n,{unit:"hour"}):Ds(n,s.length)},m:function(t,s,r){return s==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):hi.m(t,s)},s:function(t,s,r){return s==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):hi.s(t,s)},S:function(t,s){return hi.S(t,s)},X:function(t,s,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(s){case"X":return rb(n);case"XXXX":case"XX":return Ui(n);case"XXXXX":case"XXX":default:return Ui(n,":")}},x:function(t,s,r){const n=t.getTimezoneOffset();switch(s){case"x":return rb(n);case"xxxx":case"xx":return Ui(n);case"xxxxx":case"xxx":default:return Ui(n,":")}},O:function(t,s,r){const n=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+sb(n,":");case"OOOO":default:return"GMT"+Ui(n,":")}},z:function(t,s,r){const n=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+sb(n,":");case"zzzz":default:return"GMT"+Ui(n,":")}},t:function(t,s,r){const n=Math.trunc(t.getTime()/1e3);return Ds(n,s.length)},T:function(t,s,r){const n=t.getTime();return Ds(n,s.length)}};function sb(t,s=""){const r=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),l=n%60;return l===0?r+String(a):r+String(a)+s+Ds(l,2)}function rb(t,s){return t%60===0?(t>0?"-":"+")+Ds(Math.abs(t)/60,2):Ui(t,s)}function Ui(t,s=""){const r=t>0?"-":"+",n=Math.abs(t),a=Ds(Math.trunc(n/60),2),l=Ds(n%60,2);return r+a+s+l}const nb=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},ij=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},DR=(t,s)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return nb(t,s);let l;switch(n){case"P":l=s.dateTime({width:"short"});break;case"PP":l=s.dateTime({width:"medium"});break;case"PPP":l=s.dateTime({width:"long"});break;case"PPPP":default:l=s.dateTime({width:"full"});break}return l.replace("{{date}}",nb(n,s)).replace("{{time}}",ij(a,s))},LR={p:ij,P:DR},FR=/^D+$/,MR=/^Y+$/,IR=["D","DD","YY","YYYY"];function qR(t){return FR.test(t)}function BR(t){return MR.test(t)}function zR(t,s,r){const n=$R(t,s,r);if(console.warn(n),IR.includes(t))throw new RangeError(n)}function $R(t,s,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const QR=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,UR=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,VR=/^'([^]*?)'?$/,WR=/''/g,GR=/[a-zA-Z]/;function Ur(t,s,r){const n=Ic(),a=r?.locale??n.locale??sj,l=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,c=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,u=ks(t);if(!JO(u))throw new RangeError("Invalid time value");let f=s.match(UR).map(v=>{const w=v[0];if(w==="p"||w==="P"){const j=LR[w];return j(v,a.formatLong)}return v}).join("").match(QR).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const w=v[0];if(w==="'")return{isToken:!1,value:HR(v)};if(tb[w])return{isToken:!0,value:v};if(w.match(GR))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:v}});a.localize.preprocessor&&(f=a.localize.preprocessor(u,f));const h={firstWeekContainsDate:l,weekStartsOn:c,locale:a};return f.map(v=>{if(!v.isToken)return v.value;const w=v.value;(!r?.useAdditionalWeekYearTokens&&BR(w)||!r?.useAdditionalDayOfYearTokens&&qR(w))&&zR(w,s,String(t));const j=tb[w[0]];return j(u,w,a.localize,h)}).join("")}function HR(t){const s=t.match(VR);return s?s[1].replace(WR,"'"):t}function YR(t){const s=ks(t),r=s.getFullYear(),n=s.getMonth(),a=_n(t,0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function KR(t){return Math.trunc(+ks(t)/1e3)}function XR(t){const s=ks(t),r=s.getMonth();return s.setFullYear(s.getFullYear(),r+1,0),s.setHours(0,0,0,0),s}function JR(t,s){return ZO(XR(t),mn(t),s)+1}function kx(t,s){const r=ks(t),n=ks(s);return r.getTime()>n.getTime()}function lj(t,s){const r=ks(t),n=ks(s);return+r<+n}function fh(t,s){const r=ks(t),n=ks(s);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function ZR(t,s){const r=ks(t),n=ks(s);return r.getFullYear()===n.getFullYear()}function q0(t,s){return Xr(t,-s)}function B0(t,s){const r=ks(t),n=r.getFullYear(),a=r.getDate(),l=_n(t,0);l.setFullYear(n,s,15),l.setHours(0,0,0,0);const c=YR(l);return r.setMonth(s,Math.min(a,c)),r}function ab(t,s){const r=ks(t);return isNaN(+r)?_n(t,NaN):(r.setFullYear(s),r)}function eD(t){const s=tD(t),r=d.forwardRef((n,a)=>{const{children:l,...c}=n,u=d.Children.toArray(l),f=u.find(rD);if(f){const h=f.props.children,v=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(s,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,v):null})}return e.jsx(s,{...c,ref:a,children:l})});return r.displayName=`${t}.Slot`,r}function tD(t){const s=d.forwardRef((r,n)=>{const{children:a,...l}=r;if(d.isValidElement(a)){const c=aD(a),u=nD(l,a.props);return a.type!==d.Fragment&&(u.ref=n?ka(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var sD=Symbol("radix.slottable");function rD(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===sD}function nD(t,s){const r={...s};for(const n in s){const a=t[n],l=s[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(r[n]=a):n==="style"?r[n]={...a,...l}:n==="className"&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...t,...r}}function aD(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var _m="Popover",[oj]=Ga(_m,[mo]),qc=mo(),[iD,Pi]=oj(_m),cj=t=>{const{__scopePopover:s,children:r,open:n,defaultOpen:a,onOpenChange:l,modal:c=!1}=t,u=qc(s),f=d.useRef(null),[h,v]=d.useState(!1),[w,j]=Ki({prop:n,defaultProp:a??!1,onChange:l,caller:_m});return e.jsx(oh,{...u,children:e.jsx(iD,{scope:s,contentId:ya(),triggerRef:f,open:w,onOpenChange:j,onOpenToggle:d.useCallback(()=>j(C=>!C),[j]),hasCustomAnchor:h,onCustomAnchorAdd:d.useCallback(()=>v(!0),[]),onCustomAnchorRemove:d.useCallback(()=>v(!1),[]),modal:c,children:r})})};cj.displayName=_m;var dj="PopoverAnchor",lD=d.forwardRef((t,s)=>{const{__scopePopover:r,...n}=t,a=Pi(dj,r),l=qc(r),{onCustomAnchorAdd:c,onCustomAnchorRemove:u}=a;return d.useEffect(()=>(c(),()=>u()),[c,u]),e.jsx(jm,{...l,...n,ref:s})});lD.displayName=dj;var uj="PopoverTrigger",mj=d.forwardRef((t,s)=>{const{__scopePopover:r,...n}=t,a=Pi(uj,r),l=qc(r),c=Ts(s,a.triggerRef),u=e.jsx(bs.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":gj(a.open),...n,ref:c,onClick:rs(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?u:e.jsx(jm,{asChild:!0,...l,children:u})});mj.displayName=uj;var gh="PopoverPortal",[oD,cD]=oj(gh,{forceMount:void 0}),pj=t=>{const{__scopePopover:s,forceMount:r,children:n,container:a}=t,l=Pi(gh,s);return e.jsx(oD,{scope:s,forceMount:r,children:e.jsx(aa,{present:r||l.open,children:e.jsx(Lc,{asChild:!0,container:a,children:n})})})};pj.displayName=gh;var eo="PopoverContent",xj=d.forwardRef((t,s)=>{const r=cD(eo,t.__scopePopover),{forceMount:n=r.forceMount,...a}=t,l=Pi(eo,t.__scopePopover);return e.jsx(aa,{present:n||l.open,children:l.modal?e.jsx(uD,{...a,ref:s}):e.jsx(mD,{...a,ref:s})})});xj.displayName=eo;var dD=eD("PopoverContent.RemoveScroll"),uD=d.forwardRef((t,s)=>{const r=Pi(eo,t.__scopePopover),n=d.useRef(null),a=Ts(s,n),l=d.useRef(!1);return d.useEffect(()=>{const c=n.current;if(c)return gm(c)},[]),e.jsx(Fc,{as:dD,allowPinchZoom:!0,children:e.jsx(hj,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:rs(t.onCloseAutoFocus,c=>{c.preventDefault(),l.current||r.triggerRef.current?.focus()}),onPointerDownOutside:rs(t.onPointerDownOutside,c=>{const u=c.detail.originalEvent,f=u.button===0&&u.ctrlKey===!0,h=u.button===2||f;l.current=h},{checkForDefaultPrevented:!1}),onFocusOutside:rs(t.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1})})})}),mD=d.forwardRef((t,s)=>{const r=Pi(eo,t.__scopePopover),n=d.useRef(!1),a=d.useRef(!1);return e.jsx(hj,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{t.onCloseAutoFocus?.(l),l.defaultPrevented||(n.current||r.triggerRef.current?.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{t.onInteractOutside?.(l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const c=l.target;r.triggerRef.current?.contains(c)&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),hj=d.forwardRef((t,s)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,disableOutsidePointerEvents:c,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:h,onInteractOutside:v,...w}=t,j=Pi(eo,r),C=qc(r);return hm(),e.jsx(Dc,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:e.jsx(Rc,{asChild:!0,disableOutsidePointerEvents:c,onInteractOutside:v,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:h,onDismiss:()=>j.onOpenChange(!1),children:e.jsx(ch,{"data-state":gj(j.open),role:"dialog",id:j.contentId,...C,...w,ref:s,style:{...w.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),fj="PopoverClose",pD=d.forwardRef((t,s)=>{const{__scopePopover:r,...n}=t,a=Pi(fj,r);return e.jsx(bs.button,{type:"button",...n,ref:s,onClick:rs(t.onClick,()=>a.onOpenChange(!1))})});pD.displayName=fj;var xD="PopoverArrow",hD=d.forwardRef((t,s)=>{const{__scopePopover:r,...n}=t,a=qc(r);return e.jsx(dh,{...a,...n,ref:s})});hD.displayName=xD;function gj(t){return t?"open":"closed"}var fD=cj,yj=mj,gD=pj,vj=xj;function yD({...t}){return e.jsx(fD,{"data-slot":"popover",...t})}const bj=d.forwardRef((t,s)=>e.jsx(yj,{ref:s,"data-slot":"popover-trigger",...t}));bj.displayName=yj.displayName;const wj=d.forwardRef(({className:t,align:s="center",sideOffset:r=4,...n},a)=>e.jsx(gD,{children:e.jsx(vj,{ref:a,"data-slot":"popover-content",align:s,sideOffset:r,className:js("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...n})}));wj.displayName=vj.displayName;var ms=function(){return ms=Object.assign||function(s){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(s[l]=r[l])}return s},ms.apply(this,arguments)};function vD(t,s){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&s.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)s.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r}function Nj(t,s,r){for(var n=0,a=s.length,l;n<a;n++)(l||!(n in s))&&(l||(l=Array.prototype.slice.call(s,0,n)),l[n]=s[n]);return t.concat(l||Array.prototype.slice.call(s))}function Bc(t){return t.mode==="multiple"}function zc(t){return t.mode==="range"}function Em(t){return t.mode==="single"}var bD={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function wD(t,s){return Ur(t,"LLLL y",s)}function ND(t,s){return Ur(t,"d",s)}function jD(t,s){return Ur(t,"LLLL",s)}function SD(t){return"".concat(t)}function kD(t,s){return Ur(t,"cccccc",s)}function CD(t,s){return Ur(t,"yyyy",s)}var _D=Object.freeze({__proto__:null,formatCaption:wD,formatDay:ND,formatMonthCaption:jD,formatWeekNumber:SD,formatWeekdayName:kD,formatYearCaption:CD}),ED=function(t,s,r){return Ur(t,"do MMMM (EEEE)",r)},PD=function(){return"Month: "},AD=function(){return"Go to next month"},TD=function(){return"Go to previous month"},OD=function(t,s){return Ur(t,"cccc",s)},RD=function(t){return"Week n. ".concat(t)},DD=function(){return"Year: "},LD=Object.freeze({__proto__:null,labelDay:ED,labelMonthDropdown:PD,labelNext:AD,labelPrevious:TD,labelWeekNumber:RD,labelWeekday:OD,labelYearDropdown:DD});function FD(){var t="buttons",s=bD,r=sj,n={},a={},l=1,c={},u=new Date;return{captionLayout:t,classNames:s,formatters:_D,labels:LD,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:l,styles:c,today:u,mode:"default"}}function MD(t){var s=t.fromYear,r=t.toYear,n=t.fromMonth,a=t.toMonth,l=t.fromDate,c=t.toDate;return n?l=mn(n):s&&(l=new Date(s,0,1)),a?c=xh(a):r&&(c=new Date(r,11,31)),{fromDate:l?Zl(l):void 0,toDate:c?Zl(c):void 0}}var jj=d.createContext(void 0);function ID(t){var s,r=t.initialProps,n=FD(),a=MD(r),l=a.fromDate,c=a.toDate,u=(s=r.captionLayout)!==null&&s!==void 0?s:n.captionLayout;u!=="buttons"&&(!l||!c)&&(u="buttons");var f;(Em(r)||Bc(r)||zc(r))&&(f=r.onSelect);var h=ms(ms(ms({},n),r),{captionLayout:u,classNames:ms(ms({},n.classNames),r.classNames),components:ms({},r.components),formatters:ms(ms({},n.formatters),r.formatters),fromDate:l,labels:ms(ms({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:ms(ms({},n.modifiers),r.modifiers),modifiersClassNames:ms(ms({},n.modifiersClassNames),r.modifiersClassNames),onSelect:f,styles:ms(ms({},n.styles),r.styles),toDate:c});return e.jsx(jj.Provider,{value:h,children:t.children})}function $s(){var t=d.useContext(jj);if(!t)throw new Error("useDayPicker must be used within a DayPickerProvider.");return t}function Sj(t){var s=$s(),r=s.locale,n=s.classNames,a=s.styles,l=s.formatters.formatCaption;return e.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:t.id,children:l(t.displayMonth,{locale:r})})}function qD(t){return e.jsx("svg",ms({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},t,{children:e.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function kj(t){var s,r,n=t.onChange,a=t.value,l=t.children,c=t.caption,u=t.className,f=t.style,h=$s(),v=(r=(s=h.components)===null||s===void 0?void 0:s.IconDropdown)!==null&&r!==void 0?r:qD;return e.jsxs("div",{className:u,style:f,children:[e.jsx("span",{className:h.classNames.vhidden,children:t["aria-label"]}),e.jsx("select",{name:t.name,"aria-label":t["aria-label"],className:h.classNames.dropdown,style:h.styles.dropdown,value:a,onChange:n,children:l}),e.jsxs("div",{className:h.classNames.caption_label,style:h.styles.caption_label,"aria-hidden":"true",children:[c,e.jsx(v,{className:h.classNames.dropdown_icon,style:h.styles.dropdown_icon})]})]})}function BD(t){var s,r=$s(),n=r.fromDate,a=r.toDate,l=r.styles,c=r.locale,u=r.formatters.formatMonthCaption,f=r.classNames,h=r.components,v=r.labels.labelMonthDropdown;if(!n)return e.jsx(e.Fragment,{});if(!a)return e.jsx(e.Fragment,{});var w=[];if(ZR(n,a))for(var j=mn(n),C=n.getMonth();C<=a.getMonth();C++)w.push(B0(j,C));else for(var j=mn(new Date),C=0;C<=11;C++)w.push(B0(j,C));var k=function(_){var I=Number(_.target.value),F=B0(mn(t.displayMonth),I);t.onChange(F)},S=(s=h?.Dropdown)!==null&&s!==void 0?s:kj;return e.jsx(S,{name:"months","aria-label":v(),className:f.dropdown_month,style:l.dropdown_month,onChange:k,value:t.displayMonth.getMonth(),caption:u(t.displayMonth,{locale:c}),children:w.map(function(_){return e.jsx("option",{value:_.getMonth(),children:u(_,{locale:c})},_.getMonth())})})}function zD(t){var s,r=t.displayMonth,n=$s(),a=n.fromDate,l=n.toDate,c=n.locale,u=n.styles,f=n.classNames,h=n.components,v=n.formatters.formatYearCaption,w=n.labels.labelYearDropdown,j=[];if(!a)return e.jsx(e.Fragment,{});if(!l)return e.jsx(e.Fragment,{});for(var C=a.getFullYear(),k=l.getFullYear(),S=C;S<=k;S++)j.push(ab(ej(new Date),S));var _=function(F){var B=ab(mn(r),Number(F.target.value));t.onChange(B)},I=(s=h?.Dropdown)!==null&&s!==void 0?s:kj;return e.jsx(I,{name:"years","aria-label":w(),className:f.dropdown_year,style:u.dropdown_year,onChange:_,value:r.getFullYear(),caption:v(r,{locale:c}),children:j.map(function(F){return e.jsx("option",{value:F.getFullYear(),children:v(F,{locale:c})},F.getFullYear())})})}function $D(t,s){var r=d.useState(t),n=r[0],a=r[1],l=s===void 0?n:s;return[l,a]}function QD(t){var s=t.month,r=t.defaultMonth,n=t.today,a=s||r||n||new Date,l=t.toDate,c=t.fromDate,u=t.numberOfMonths,f=u===void 0?1:u;if(l&&fc(l,a)<0){var h=-1*(f-1);a=sa(l,h)}return c&&fc(a,c)<0&&(a=c),mn(a)}function UD(){var t=$s(),s=QD(t),r=$D(s,t.month),n=r[0],a=r[1],l=function(c){var u;if(!t.disableNavigation){var f=mn(c);a(f),(u=t.onMonthChange)===null||u===void 0||u.call(t,f)}};return[n,l]}function VD(t,s){for(var r=s.reverseMonths,n=s.numberOfMonths,a=mn(t),l=mn(sa(a,n)),c=fc(l,a),u=[],f=0;f<c;f++){var h=sa(a,f);u.push(h)}return r&&(u=u.reverse()),u}function WD(t,s){if(!s.disableNavigation){var r=s.toDate,n=s.pagedNavigation,a=s.numberOfMonths,l=a===void 0?1:a,c=n?l:1,u=mn(t);if(!r)return sa(u,c);var f=fc(r,t);if(!(f<l))return sa(u,c)}}function GD(t,s){if(!s.disableNavigation){var r=s.fromDate,n=s.pagedNavigation,a=s.numberOfMonths,l=a===void 0?1:a,c=n?l:1,u=mn(t);if(!r)return sa(u,-c);var f=fc(u,r);if(!(f<=0))return sa(u,-c)}}var Cj=d.createContext(void 0);function HD(t){var s=$s(),r=UD(),n=r[0],a=r[1],l=VD(n,s),c=WD(n,s),u=GD(n,s),f=function(w){return l.some(function(j){return fh(w,j)})},h=function(w,j){f(w)||(j&&lj(w,j)?a(sa(w,1+s.numberOfMonths*-1)):a(w))},v={currentMonth:n,displayMonths:l,goToMonth:a,goToDate:h,previousMonth:u,nextMonth:c,isDateDisplayed:f};return e.jsx(Cj.Provider,{value:v,children:t.children})}function $c(){var t=d.useContext(Cj);if(!t)throw new Error("useNavigation must be used within a NavigationProvider");return t}function ib(t){var s,r=$s(),n=r.classNames,a=r.styles,l=r.components,c=$c().goToMonth,u=function(v){c(sa(v,t.displayIndex?-t.displayIndex:0))},f=(s=l?.CaptionLabel)!==null&&s!==void 0?s:Sj,h=e.jsx(f,{id:t.id,displayMonth:t.displayMonth});return e.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[e.jsx("div",{className:n.vhidden,children:h}),e.jsx(BD,{onChange:u,displayMonth:t.displayMonth}),e.jsx(zD,{onChange:u,displayMonth:t.displayMonth})]})}function YD(t){return e.jsx("svg",ms({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function KD(t){return e.jsx("svg",ms({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var zu=d.forwardRef(function(t,s){var r=$s(),n=r.classNames,a=r.styles,l=[n.button_reset,n.button];t.className&&l.push(t.className);var c=l.join(" "),u=ms(ms({},a.button_reset),a.button);return t.style&&Object.assign(u,t.style),e.jsx("button",ms({},t,{ref:s,type:"button",className:c,style:u}))});function XD(t){var s,r,n=$s(),a=n.dir,l=n.locale,c=n.classNames,u=n.styles,f=n.labels,h=f.labelPrevious,v=f.labelNext,w=n.components;if(!t.nextMonth&&!t.previousMonth)return e.jsx(e.Fragment,{});var j=h(t.previousMonth,{locale:l}),C=[c.nav_button,c.nav_button_previous].join(" "),k=v(t.nextMonth,{locale:l}),S=[c.nav_button,c.nav_button_next].join(" "),_=(s=w?.IconRight)!==null&&s!==void 0?s:KD,I=(r=w?.IconLeft)!==null&&r!==void 0?r:YD;return e.jsxs("div",{className:c.nav,style:u.nav,children:[!t.hidePrevious&&e.jsx(zu,{name:"previous-month","aria-label":j,className:C,style:u.nav_button_previous,disabled:!t.previousMonth,onClick:t.onPreviousClick,children:a==="rtl"?e.jsx(_,{className:c.nav_icon,style:u.nav_icon}):e.jsx(I,{className:c.nav_icon,style:u.nav_icon})}),!t.hideNext&&e.jsx(zu,{name:"next-month","aria-label":k,className:S,style:u.nav_button_next,disabled:!t.nextMonth,onClick:t.onNextClick,children:a==="rtl"?e.jsx(I,{className:c.nav_icon,style:u.nav_icon}):e.jsx(_,{className:c.nav_icon,style:u.nav_icon})})]})}function lb(t){var s=$s().numberOfMonths,r=$c(),n=r.previousMonth,a=r.nextMonth,l=r.goToMonth,c=r.displayMonths,u=c.findIndex(function(k){return fh(t.displayMonth,k)}),f=u===0,h=u===c.length-1,v=s>1&&(f||!h),w=s>1&&(h||!f),j=function(){n&&l(n)},C=function(){a&&l(a)};return e.jsx(XD,{displayMonth:t.displayMonth,hideNext:v,hidePrevious:w,nextMonth:a,previousMonth:n,onPreviousClick:j,onNextClick:C})}function JD(t){var s,r=$s(),n=r.classNames,a=r.disableNavigation,l=r.styles,c=r.captionLayout,u=r.components,f=(s=u?.CaptionLabel)!==null&&s!==void 0?s:Sj,h;return a?h=e.jsx(f,{id:t.id,displayMonth:t.displayMonth}):c==="dropdown"?h=e.jsx(ib,{displayMonth:t.displayMonth,id:t.id}):c==="dropdown-buttons"?h=e.jsxs(e.Fragment,{children:[e.jsx(ib,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id}),e.jsx(lb,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id})]}):h=e.jsxs(e.Fragment,{children:[e.jsx(f,{id:t.id,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(lb,{displayMonth:t.displayMonth,id:t.id})]}),e.jsx("div",{className:n.caption,style:l.caption,children:h})}function ZD(t){var s=$s(),r=s.footer,n=s.styles,a=s.classNames.tfoot;return r?e.jsx("tfoot",{className:a,style:n.tfoot,children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:r})})}):e.jsx(e.Fragment,{})}function eL(t,s,r){for(var n=r?sl(new Date):wa(new Date,{locale:t,weekStartsOn:s}),a=[],l=0;l<7;l++){var c=Xr(n,l);a.push(c)}return a}function tL(){var t=$s(),s=t.classNames,r=t.styles,n=t.showWeekNumber,a=t.locale,l=t.weekStartsOn,c=t.ISOWeek,u=t.formatters.formatWeekdayName,f=t.labels.labelWeekday,h=eL(a,l,c);return e.jsxs("tr",{style:r.head_row,className:s.head_row,children:[n&&e.jsx("td",{style:r.head_cell,className:s.head_cell}),h.map(function(v,w){return e.jsx("th",{scope:"col",className:s.head_cell,style:r.head_cell,"aria-label":f(v,{locale:a}),children:u(v,{locale:a})},w)})]})}function sL(){var t,s=$s(),r=s.classNames,n=s.styles,a=s.components,l=(t=a?.HeadRow)!==null&&t!==void 0?t:tL;return e.jsx("thead",{style:n.head,className:r.head,children:e.jsx(l,{})})}function rL(t){var s=$s(),r=s.locale,n=s.formatters.formatDay;return e.jsx(e.Fragment,{children:n(t.date,{locale:r})})}var yh=d.createContext(void 0);function nL(t){if(!Bc(t.initialProps)){var s={selected:void 0,modifiers:{disabled:[]}};return e.jsx(yh.Provider,{value:s,children:t.children})}return e.jsx(aL,{initialProps:t.initialProps,children:t.children})}function aL(t){var s=t.initialProps,r=t.children,n=s.selected,a=s.min,l=s.max,c=function(h,v,w){var j,C;(j=s.onDayClick)===null||j===void 0||j.call(s,h,v,w);var k=!!(v.selected&&a&&n?.length===a);if(!k){var S=!!(!v.selected&&l&&n?.length===l);if(!S){var _=n?Nj([],n):[];if(v.selected){var I=_.findIndex(function(F){return cn(h,F)});_.splice(I,1)}else _.push(h);(C=s.onSelect)===null||C===void 0||C.call(s,_,h,v,w)}}},u={disabled:[]};n&&u.disabled.push(function(h){var v=l&&n.length>l-1,w=n.some(function(j){return cn(j,h)});return!!(v&&!w)});var f={selected:n,onDayClick:c,modifiers:u};return e.jsx(yh.Provider,{value:f,children:r})}function vh(){var t=d.useContext(yh);if(!t)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return t}function iL(t,s){var r=s||{},n=r.from,a=r.to;return n&&a?cn(a,t)&&cn(n,t)?void 0:cn(a,t)?{from:a,to:void 0}:cn(n,t)?void 0:kx(n,t)?{from:t,to:a}:{from:n,to:t}:a?kx(t,a)?{from:a,to:t}:{from:t,to:a}:n?lj(t,n)?{from:t,to:n}:{from:n,to:t}:{from:t,to:void 0}}var bh=d.createContext(void 0);function lL(t){if(!zc(t.initialProps)){var s={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return e.jsx(bh.Provider,{value:s,children:t.children})}return e.jsx(oL,{initialProps:t.initialProps,children:t.children})}function oL(t){var s=t.initialProps,r=t.children,n=s.selected,a=n||{},l=a.from,c=a.to,u=s.min,f=s.max,h=function(C,k,S){var _,I;(_=s.onDayClick)===null||_===void 0||_.call(s,C,k,S);var F=iL(C,n);(I=s.onSelect)===null||I===void 0||I.call(s,F,C,k,S)},v={range_start:[],range_end:[],range_middle:[],disabled:[]};if(l?(v.range_start=[l],c?(v.range_end=[c],cn(l,c)||(v.range_middle=[{after:l,before:c}])):v.range_end=[l]):c&&(v.range_start=[c],v.range_end=[c]),u&&(l&&!c&&v.disabled.push({after:q0(l,u-1),before:Xr(l,u-1)}),l&&c&&v.disabled.push({after:l,before:Xr(l,u-1)}),!l&&c&&v.disabled.push({after:q0(c,u-1),before:Xr(c,u-1)})),f){if(l&&!c&&(v.disabled.push({before:Xr(l,-f+1)}),v.disabled.push({after:Xr(l,f-1)})),l&&c){var w=ga(c,l)+1,j=f-w;v.disabled.push({before:q0(l,j)}),v.disabled.push({after:Xr(c,j)})}!l&&c&&(v.disabled.push({before:Xr(c,-f+1)}),v.disabled.push({after:Xr(c,f-1)}))}return e.jsx(bh.Provider,{value:{selected:n,onDayClick:h,modifiers:v},children:r})}function wh(){var t=d.useContext(bh);if(!t)throw new Error("useSelectRange must be used within a SelectRangeProvider");return t}function _u(t){return Array.isArray(t)?Nj([],t):t!==void 0?[t]:[]}function cL(t){var s={};return Object.entries(t).forEach(function(r){var n=r[0],a=r[1];s[n]=_u(a)}),s}var ra;(function(t){t.Outside="outside",t.Disabled="disabled",t.Selected="selected",t.Hidden="hidden",t.Today="today",t.RangeStart="range_start",t.RangeEnd="range_end",t.RangeMiddle="range_middle"})(ra||(ra={}));var dL=ra.Selected,Fa=ra.Disabled,uL=ra.Hidden,mL=ra.Today,z0=ra.RangeEnd,$0=ra.RangeMiddle,Q0=ra.RangeStart,pL=ra.Outside;function xL(t,s,r){var n,a=(n={},n[dL]=_u(t.selected),n[Fa]=_u(t.disabled),n[uL]=_u(t.hidden),n[mL]=[t.today],n[z0]=[],n[$0]=[],n[Q0]=[],n[pL]=[],n);return t.fromDate&&a[Fa].push({before:t.fromDate}),t.toDate&&a[Fa].push({after:t.toDate}),Bc(t)?a[Fa]=a[Fa].concat(s.modifiers[Fa]):zc(t)&&(a[Fa]=a[Fa].concat(r.modifiers[Fa]),a[Q0]=r.modifiers[Q0],a[$0]=r.modifiers[$0],a[z0]=r.modifiers[z0]),a}var _j=d.createContext(void 0);function hL(t){var s=$s(),r=vh(),n=wh(),a=xL(s,r,n),l=cL(s.modifiers),c=ms(ms({},a),l);return e.jsx(_j.Provider,{value:c,children:t.children})}function Ej(){var t=d.useContext(_j);if(!t)throw new Error("useModifiers must be used within a ModifiersProvider");return t}function fL(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function gL(t){return!!(t&&typeof t=="object"&&"from"in t)}function yL(t){return!!(t&&typeof t=="object"&&"after"in t)}function vL(t){return!!(t&&typeof t=="object"&&"before"in t)}function bL(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function wL(t,s){var r,n=s.from,a=s.to;if(n&&a){var l=ga(a,n)<0;l&&(r=[a,n],n=r[0],a=r[1]);var c=ga(t,n)>=0&&ga(a,t)>=0;return c}return a?cn(a,t):n?cn(n,t):!1}function NL(t){return ph(t)}function jL(t){return Array.isArray(t)&&t.every(ph)}function SL(t,s){return s.some(function(r){if(typeof r=="boolean")return r;if(NL(r))return cn(t,r);if(jL(r))return r.includes(t);if(gL(r))return wL(t,r);if(bL(r))return r.dayOfWeek.includes(t.getDay());if(fL(r)){var n=ga(r.before,t),a=ga(r.after,t),l=n>0,c=a<0,u=kx(r.before,r.after);return u?c&&l:l||c}return yL(r)?ga(t,r.after)>0:vL(r)?ga(r.before,t)>0:typeof r=="function"?r(t):!1})}function Nh(t,s,r){var n=Object.keys(s).reduce(function(l,c){var u=s[c];return SL(t,u)&&l.push(c),l},[]),a={};return n.forEach(function(l){return a[l]=!0}),r&&!fh(t,r)&&(a.outside=!0),a}function kL(t,s){for(var r=mn(t[0]),n=xh(t[t.length-1]),a,l,c=r;c<=n;){var u=Nh(c,s),f=!u.disabled&&!u.hidden;if(!f){c=Xr(c,1);continue}if(u.selected)return c;u.today&&!l&&(l=c),a||(a=c),c=Xr(c,1)}return l||a}var CL=365;function Pj(t,s){var r=s.moveBy,n=s.direction,a=s.context,l=s.modifiers,c=s.retry,u=c===void 0?{count:0,lastFocused:t}:c,f=a.weekStartsOn,h=a.fromDate,v=a.toDate,w=a.locale,j={day:Xr,week:Sx,month:sa,year:YO,startOfWeek:function(_){return a.ISOWeek?sl(_):wa(_,{locale:w,weekStartsOn:f})},endOfWeek:function(_){return a.ISOWeek?tj(_):hh(_,{locale:w,weekStartsOn:f})}},C=j[r](t,n==="after"?1:-1);n==="before"&&h?C=KO([h,C]):n==="after"&&v&&(C=XO([v,C]));var k=!0;if(l){var S=Nh(C,l);k=!S.disabled&&!S.hidden}return k?C:u.count>CL?u.lastFocused:Pj(C,{moveBy:r,direction:n,context:a,modifiers:l,retry:ms(ms({},u),{count:u.count+1})})}var Aj=d.createContext(void 0);function _L(t){var s=$c(),r=Ej(),n=d.useState(),a=n[0],l=n[1],c=d.useState(),u=c[0],f=c[1],h=kL(s.displayMonths,r),v=a??(u&&s.isDateDisplayed(u))?u:h,w=function(){f(a),l(void 0)},j=function(_){l(_)},C=$s(),k=function(_,I){if(a){var F=Pj(a,{moveBy:_,direction:I,context:C,modifiers:r});cn(a,F)||(s.goToDate(F,a),j(F))}},S={focusedDay:a,focusTarget:v,blur:w,focus:j,focusDayAfter:function(){return k("day","after")},focusDayBefore:function(){return k("day","before")},focusWeekAfter:function(){return k("week","after")},focusWeekBefore:function(){return k("week","before")},focusMonthBefore:function(){return k("month","before")},focusMonthAfter:function(){return k("month","after")},focusYearBefore:function(){return k("year","before")},focusYearAfter:function(){return k("year","after")},focusStartOfWeek:function(){return k("startOfWeek","before")},focusEndOfWeek:function(){return k("endOfWeek","after")}};return e.jsx(Aj.Provider,{value:S,children:t.children})}function jh(){var t=d.useContext(Aj);if(!t)throw new Error("useFocusContext must be used within a FocusProvider");return t}function EL(t,s){var r=Ej(),n=Nh(t,r,s);return n}var Sh=d.createContext(void 0);function PL(t){if(!Em(t.initialProps)){var s={selected:void 0};return e.jsx(Sh.Provider,{value:s,children:t.children})}return e.jsx(AL,{initialProps:t.initialProps,children:t.children})}function AL(t){var s=t.initialProps,r=t.children,n=function(l,c,u){var f,h,v;if((f=s.onDayClick)===null||f===void 0||f.call(s,l,c,u),c.selected&&!s.required){(h=s.onSelect)===null||h===void 0||h.call(s,void 0,l,c,u);return}(v=s.onSelect)===null||v===void 0||v.call(s,l,l,c,u)},a={selected:s.selected,onDayClick:n};return e.jsx(Sh.Provider,{value:a,children:r})}function Tj(){var t=d.useContext(Sh);if(!t)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return t}function TL(t,s){var r=$s(),n=Tj(),a=vh(),l=wh(),c=jh(),u=c.focusDayAfter,f=c.focusDayBefore,h=c.focusWeekAfter,v=c.focusWeekBefore,w=c.blur,j=c.focus,C=c.focusMonthBefore,k=c.focusMonthAfter,S=c.focusYearBefore,_=c.focusYearAfter,I=c.focusStartOfWeek,F=c.focusEndOfWeek,B=function(ve){var Q,be,pe,ne;Em(r)?(Q=n.onDayClick)===null||Q===void 0||Q.call(n,t,s,ve):Bc(r)?(be=a.onDayClick)===null||be===void 0||be.call(a,t,s,ve):zc(r)?(pe=l.onDayClick)===null||pe===void 0||pe.call(l,t,s,ve):(ne=r.onDayClick)===null||ne===void 0||ne.call(r,t,s,ve)},q=function(ve){var Q;j(t),(Q=r.onDayFocus)===null||Q===void 0||Q.call(r,t,s,ve)},me=function(ve){var Q;w(),(Q=r.onDayBlur)===null||Q===void 0||Q.call(r,t,s,ve)},re=function(ve){var Q;(Q=r.onDayMouseEnter)===null||Q===void 0||Q.call(r,t,s,ve)},M=function(ve){var Q;(Q=r.onDayMouseLeave)===null||Q===void 0||Q.call(r,t,s,ve)},W=function(ve){var Q;(Q=r.onDayPointerEnter)===null||Q===void 0||Q.call(r,t,s,ve)},oe=function(ve){var Q;(Q=r.onDayPointerLeave)===null||Q===void 0||Q.call(r,t,s,ve)},X=function(ve){var Q;(Q=r.onDayTouchCancel)===null||Q===void 0||Q.call(r,t,s,ve)},he=function(ve){var Q;(Q=r.onDayTouchEnd)===null||Q===void 0||Q.call(r,t,s,ve)},ue=function(ve){var Q;(Q=r.onDayTouchMove)===null||Q===void 0||Q.call(r,t,s,ve)},_e=function(ve){var Q;(Q=r.onDayTouchStart)===null||Q===void 0||Q.call(r,t,s,ve)},ke=function(ve){var Q;(Q=r.onDayKeyUp)===null||Q===void 0||Q.call(r,t,s,ve)},Re=function(ve){var Q;switch(ve.key){case"ArrowLeft":ve.preventDefault(),ve.stopPropagation(),r.dir==="rtl"?u():f();break;case"ArrowRight":ve.preventDefault(),ve.stopPropagation(),r.dir==="rtl"?f():u();break;case"ArrowDown":ve.preventDefault(),ve.stopPropagation(),h();break;case"ArrowUp":ve.preventDefault(),ve.stopPropagation(),v();break;case"PageUp":ve.preventDefault(),ve.stopPropagation(),ve.shiftKey?S():C();break;case"PageDown":ve.preventDefault(),ve.stopPropagation(),ve.shiftKey?_():k();break;case"Home":ve.preventDefault(),ve.stopPropagation(),I();break;case"End":ve.preventDefault(),ve.stopPropagation(),F();break}(Q=r.onDayKeyDown)===null||Q===void 0||Q.call(r,t,s,ve)},Y={onClick:B,onFocus:q,onBlur:me,onKeyDown:Re,onKeyUp:ke,onMouseEnter:re,onMouseLeave:M,onPointerEnter:W,onPointerLeave:oe,onTouchCancel:X,onTouchEnd:he,onTouchMove:ue,onTouchStart:_e};return Y}function OL(){var t=$s(),s=Tj(),r=vh(),n=wh(),a=Em(t)?s.selected:Bc(t)?r.selected:zc(t)?n.selected:void 0;return a}function RL(t){return Object.values(ra).includes(t)}function DL(t,s){var r=[t.classNames.day];return Object.keys(s).forEach(function(n){var a=t.modifiersClassNames[n];if(a)r.push(a);else if(RL(n)){var l=t.classNames["day_".concat(n)];l&&r.push(l)}}),r}function LL(t,s){var r=ms({},t.styles.day);return Object.keys(s).forEach(function(n){var a;r=ms(ms({},r),(a=t.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function FL(t,s,r){var n,a,l,c=$s(),u=jh(),f=EL(t,s),h=TL(t,f),v=OL(),w=!!(c.onDayClick||c.mode!=="default");d.useEffect(function(){var re;f.outside||u.focusedDay&&w&&cn(u.focusedDay,t)&&((re=r.current)===null||re===void 0||re.focus())},[u.focusedDay,t,r,w,f.outside]);var j=DL(c,f).join(" "),C=LL(c,f),k=!!(f.outside&&!c.showOutsideDays||f.hidden),S=(l=(a=c.components)===null||a===void 0?void 0:a.DayContent)!==null&&l!==void 0?l:rL,_=e.jsx(S,{date:t,displayMonth:s,activeModifiers:f}),I={style:C,className:j,children:_,role:"gridcell"},F=u.focusTarget&&cn(u.focusTarget,t)&&!f.outside,B=u.focusedDay&&cn(u.focusedDay,t),q=ms(ms(ms({},I),(n={disabled:f.disabled,role:"gridcell"},n["aria-selected"]=f.selected,n.tabIndex=B||F?0:-1,n)),h),me={isButton:w,isHidden:k,activeModifiers:f,selectedDays:v,buttonProps:q,divProps:I};return me}function ML(t){var s=d.useRef(null),r=FL(t.date,t.displayMonth,s);return r.isHidden?e.jsx("div",{role:"gridcell"}):r.isButton?e.jsx(zu,ms({name:"day",ref:s},r.buttonProps)):e.jsx("div",ms({},r.divProps))}function IL(t){var s=t.number,r=t.dates,n=$s(),a=n.onWeekNumberClick,l=n.styles,c=n.classNames,u=n.locale,f=n.labels.labelWeekNumber,h=n.formatters.formatWeekNumber,v=h(Number(s),{locale:u});if(!a)return e.jsx("span",{className:c.weeknumber,style:l.weeknumber,children:v});var w=f(Number(s),{locale:u}),j=function(C){a(s,r,C)};return e.jsx(zu,{name:"week-number","aria-label":w,className:c.weeknumber,style:l.weeknumber,onClick:j,children:v})}function qL(t){var s,r,n=$s(),a=n.styles,l=n.classNames,c=n.showWeekNumber,u=n.components,f=(s=u?.Day)!==null&&s!==void 0?s:ML,h=(r=u?.WeekNumber)!==null&&r!==void 0?r:IL,v;return c&&(v=e.jsx("td",{className:l.cell,style:a.cell,children:e.jsx(h,{number:t.weekNumber,dates:t.dates})})),e.jsxs("tr",{className:l.row,style:a.row,children:[v,t.dates.map(function(w){return e.jsx("td",{className:l.cell,style:a.cell,role:"presentation",children:e.jsx(f,{displayMonth:t.displayMonth,date:w})},KR(w))})]})}function ob(t,s,r){for(var n=r?.ISOWeek?tj(s):hh(s,r),a=r?.ISOWeek?sl(t):wa(t,r),l=ga(n,a),c=[],u=0;u<=l;u++)c.push(Xr(a,u));var f=c.reduce(function(h,v){var w=r?.ISOWeek?rj(v):aj(v,r),j=h.find(function(C){return C.weekNumber===w});return j?(j.dates.push(v),h):(h.push({weekNumber:w,dates:[v]}),h)},[]);return f}function BL(t,s){var r=ob(mn(t),xh(t),s);if(s?.useFixedWeeks){var n=JR(t,s);if(n<6){var a=r[r.length-1],l=a.dates[a.dates.length-1],c=Sx(l,6-n),u=ob(Sx(l,1),c,s);r.push.apply(r,u)}}return r}function zL(t){var s,r,n,a=$s(),l=a.locale,c=a.classNames,u=a.styles,f=a.hideHead,h=a.fixedWeeks,v=a.components,w=a.weekStartsOn,j=a.firstWeekContainsDate,C=a.ISOWeek,k=BL(t.displayMonth,{useFixedWeeks:!!h,ISOWeek:C,locale:l,weekStartsOn:w,firstWeekContainsDate:j}),S=(s=v?.Head)!==null&&s!==void 0?s:sL,_=(r=v?.Row)!==null&&r!==void 0?r:qL,I=(n=v?.Footer)!==null&&n!==void 0?n:ZD;return e.jsxs("table",{id:t.id,className:c.table,style:u.table,role:"grid","aria-labelledby":t["aria-labelledby"],children:[!f&&e.jsx(S,{}),e.jsx("tbody",{className:c.tbody,style:u.tbody,children:k.map(function(F){return e.jsx(_,{displayMonth:t.displayMonth,dates:F.dates,weekNumber:F.weekNumber},F.weekNumber)})}),e.jsx(I,{displayMonth:t.displayMonth})]})}function $L(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var QL=$L()?d.useLayoutEffect:d.useEffect,U0=!1,UL=0;function cb(){return"react-day-picker-".concat(++UL)}function VL(t){var s,r=t??(U0?cb():null),n=d.useState(r),a=n[0],l=n[1];return QL(function(){a===null&&l(cb())},[]),d.useEffect(function(){U0===!1&&(U0=!0)},[]),(s=t??a)!==null&&s!==void 0?s:void 0}function WL(t){var s,r,n=$s(),a=n.dir,l=n.classNames,c=n.styles,u=n.components,f=$c().displayMonths,h=VL(n.id?"".concat(n.id,"-").concat(t.displayIndex):void 0),v=n.id?"".concat(n.id,"-grid-").concat(t.displayIndex):void 0,w=[l.month],j=c.month,C=t.displayIndex===0,k=t.displayIndex===f.length-1,S=!C&&!k;a==="rtl"&&(s=[C,k],k=s[0],C=s[1]),C&&(w.push(l.caption_start),j=ms(ms({},j),c.caption_start)),k&&(w.push(l.caption_end),j=ms(ms({},j),c.caption_end)),S&&(w.push(l.caption_between),j=ms(ms({},j),c.caption_between));var _=(r=u?.Caption)!==null&&r!==void 0?r:JD;return e.jsxs("div",{className:w.join(" "),style:j,children:[e.jsx(_,{id:h,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(zL,{id:v,"aria-labelledby":h,displayMonth:t.displayMonth})]},t.displayIndex)}function GL(t){var s=$s(),r=s.classNames,n=s.styles;return e.jsx("div",{className:r.months,style:n.months,children:t.children})}function HL(t){var s,r,n=t.initialProps,a=$s(),l=jh(),c=$c(),u=d.useState(!1),f=u[0],h=u[1];d.useEffect(function(){a.initialFocus&&l.focusTarget&&(f||(l.focus(l.focusTarget),h(!0)))},[a.initialFocus,f,l.focus,l.focusTarget,l]);var v=[a.classNames.root,a.className];a.numberOfMonths>1&&v.push(a.classNames.multiple_months),a.showWeekNumber&&v.push(a.classNames.with_weeknumber);var w=ms(ms({},a.styles.root),a.style),j=Object.keys(n).filter(function(k){return k.startsWith("data-")}).reduce(function(k,S){var _;return ms(ms({},k),(_={},_[S]=n[S],_))},{}),C=(r=(s=n.components)===null||s===void 0?void 0:s.Months)!==null&&r!==void 0?r:GL;return e.jsx("div",ms({className:v.join(" "),style:w,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},j,{children:e.jsx(C,{children:c.displayMonths.map(function(k,S){return e.jsx(WL,{displayIndex:S,displayMonth:k},S)})})}))}function YL(t){var s=t.children,r=vD(t,["children"]);return e.jsx(ID,{initialProps:r,children:e.jsx(HD,{children:e.jsx(PL,{initialProps:r,children:e.jsx(nL,{initialProps:r,children:e.jsx(lL,{initialProps:r,children:e.jsx(hL,{children:e.jsx(_L,{children:s})})})})})})})}function KL(t){return e.jsx(YL,ms({},t,{children:e.jsx(HL,{initialProps:t})}))}function V0({className:t,classNames:s,showOutsideDays:r=!0,...n}){return e.jsx(KL,{showOutsideDays:r,className:js("p-3",t),classNames:{months:"flex flex-col sm:flex-row gap-2",month:"flex flex-col gap-4",caption:"flex justify-center pt-1 relative items-center w-full",caption_label:"text-sm font-medium",nav:"flex items-center gap-1",nav_button:js(Ou({variant:"outline"}),"size-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-x-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:js("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",n.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:js(Ou({variant:"ghost"}),"size-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",day_range_end:"day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:({className:a,...l})=>e.jsx(K1,{className:js("size-4",a),...l}),IconRight:({className:a,...l})=>e.jsx(X1,{className:js("size-4",a),...l})},...n})}function mr({currentStage:t,searchTerm:s,setSearchTerm:r,assemblyLineFilter:n,setAssemblyLineFilter:a,dateFilterMode:l,setDateFilterMode:c,dateFrom:u,setDateFrom:f,dateTo:h,setDateTo:v,assemblyLines:w,onClearFilters:j,hasActiveFilters:C,disableAssemblyFilter:k}){const[S,_]=d.useState(!1),I=["assembly-a","assembly-b","assembly-c","assembly-d"];d.useEffect(()=>{t&&I.includes(t)&&a(t)},[t,a]);const F=I.includes(t||"")?[t]:w,B=()=>{if(l==="year"&&u)return Ur(u,"yyyy");if(l==="month"&&u)return Ur(u,"MMMM yyyy");if(l==="range"){if(u&&h)return`${Ur(u,"MMM dd, yyyy")}  ${Ur(h,"MMM dd, yyyy")}`;if(u)return`From ${Ur(u,"MMM dd, yyyy")}`;if(h)return`Until ${Ur(h,"MMM dd, yyyy")}`}return l==="single"&&u?Ur(u,"MMM dd, yyyy"):"Select date"},q=new Date().getFullYear(),me=Array.from({length:6},(M,W)=>q-W),re=[{value:0,label:"January"},{value:1,label:"February"},{value:2,label:"March"},{value:3,label:"April"},{value:4,label:"May"},{value:5,label:"June"},{value:6,label:"July"},{value:7,label:"August"},{value:8,label:"September"},{value:9,label:"October"},{value:10,label:"November"},{value:11,label:"December"}];return e.jsxs("div",{className:"bg-white border border-[#174a9f]/20 rounded-xl p-5 shadow-sm",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(sw,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),e.jsx(Js,{type:"text",placeholder:"Search by Unique Code, SOA No, Party, PO No, Code No, Product...",value:s,onChange:M=>r(M.target.value),className:"pl-10 w-full bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0 "})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4 border-b pb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#174a9f]",children:[e.jsx(x4,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Advanced Filters"})]}),e.jsx(J,{variant:"ghost",size:"sm",onClick:()=>_(M=>!M),children:S?e.jsx(J1,{}):e.jsx(Qx,{})})]}),S&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[#174a9f]/70 pl-1",children:"Assembly Line"}),e.jsxs(sr,{value:n,onValueChange:a,disabled:k,children:[e.jsx(nr,{className:"h-10 bg-white/90 backdrop-blur-sm border-2 border-[#174a9f]/20 hover:border-[#174a9f]/40 focus:border-[#174a9f] transition-all duration-200 shadow-sm hover:shadow-md",children:e.jsx(rr,{placeholder:"Select Assembly"})}),e.jsxs(ar,{children:[!I.includes(t||"")&&e.jsx(Es,{value:"all",children:"All"}),F.map(M=>e.jsx(Es,{value:M,children:M.replace("assembly-","").toUpperCase()},M))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[#174a9f]/70 pl-1",children:"Date Filter Type"}),e.jsxs(sr,{value:l,onValueChange:M=>{if(c(M),M==="year"){const W=new Date(q,0,1);f(W),v(new Date(q,11,31))}if(M==="month"){const W=new Date(q,new Date().getMonth(),1);f(W),v(new Date(W.getFullYear(),W.getMonth()+1,0))}M==="range"&&(f(void 0),v(void 0)),M==="single"&&(f(void 0),v(void 0))},children:[e.jsx(nr,{className:"h-10 bg-white/90 backdrop-blur-sm border-2 border-[#174a9f]/20 hover:border-[#174a9f]/40 focus:border-[#174a9f] transition-all duration-200 shadow-sm hover:shadow-md",children:e.jsx(rr,{})}),e.jsxs(ar,{children:[e.jsx(Es,{value:"year",children:"Year"}),e.jsx(Es,{value:"month",children:"Month"}),e.jsx(Es,{value:"range",children:"Range"}),e.jsx(Es,{value:"single",children:"Specific Date"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-xs text-[#174a9f]/70 pl-1",children:[l==="year"&&"Select Year",l==="month"&&"Select Month",l==="range"&&"Select Date Range",l==="single"&&"Select Date"]}),e.jsxs(yD,{children:[e.jsx(bj,{asChild:!0,children:e.jsxs(J,{variant:"outline",className:"h-10 w-full justify-start text-left bg-white/90 backdrop-blur-sm border-2 border-[#174a9f]/20 hover:border-[#174a9f]/40 hover:bg-white transition-all duration-200 shadow-sm hover:shadow-md",children:[e.jsx(IE,{className:"mr-2 h-4 w-4 text-[#174a9f]/70"}),e.jsx("span",{className:!u&&!h?"text-gray-500":"",children:B()})]})}),e.jsxs(wj,{className:"w-auto p-0 border-2 border-[#174a9f]/20",align:"start",children:[l==="year"&&e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("div",{className:"text-sm text-[#174a9f] mb-3",children:"Select Year"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:me.map(M=>e.jsx(J,{variant:"outline",className:`h-10 ${u&&Ur(u,"yyyy")===M.toString()?"bg-[#174a9f] text-white hover:bg-[#174a9f]/90":"hover:bg-[#174a9f]/10"}`,onClick:()=>{const W=new Date(M,0,1);f(W),v(new Date(M,11,31))},children:M},M))})]}),l==="month"&&e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"text-sm text-[#174a9f] mb-2",children:"Select Month & Year"}),e.jsxs(sr,{value:u?Ur(u,"yyyy"):q.toString(),onValueChange:M=>{const W=parseInt(M),oe=u?u.getMonth():0,X=new Date(W,oe,1);f(X);const he=new Date(W,oe+1,0).getDate();v(new Date(W,oe,he))},children:[e.jsx(nr,{className:"w-full",children:e.jsx(rr,{})}),e.jsx(ar,{children:me.map(M=>e.jsx(Es,{value:M.toString(),children:M},M))})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:re.map(({value:M,label:W})=>{const oe=u?u.getFullYear():q,X=u&&u.getMonth()===M&&u.getFullYear()===oe;return e.jsx(J,{variant:"outline",className:`h-9 text-xs ${X?"bg-[#174a9f] text-white hover:bg-[#174a9f]/90":"hover:bg-[#174a9f]/10"}`,onClick:()=>{const he=new Date(oe,M,1);f(he);const ue=new Date(oe,M+1,0).getDate();v(new Date(oe,M,ue))},children:W.slice(0,3)},M)})})]}),l==="range"&&e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"text-sm text-[#174a9f] mb-4",children:"Select Date Range"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-[#174a9f]/70 px-1",children:"Start Date"}),e.jsx(V0,{mode:"single",selected:u,onSelect:f,initialFocus:!0,defaultMonth:u??new Date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-[#174a9f]/70 px-1",children:"End Date"}),e.jsx(V0,{mode:"single",selected:h,onSelect:v,disabled:M=>u?M<u:!1,defaultMonth:h||(u?new Date(u.getFullYear(),u.getMonth()+1,1):new Date(new Date().getFullYear(),new Date().getMonth()+1,1))})]})]})]}),l==="single"&&e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"text-sm text-[#174a9f] mb-3",children:"Select Date"}),e.jsx(V0,{mode:"single",selected:u,onSelect:M=>{if(!M)return;const W=new Date(M);W.setHours(0,0,0,0);const oe=new Date(M);oe.setHours(23,59,59,999),f(W),v(oe)},initialFocus:!0})]})]})]})]})]}),C&&e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs(J,{variant:"ghost",size:"sm",onClick:j,children:[e.jsx(Ux,{className:"h-4 w-4 mr-1"}),"Clear Filters"]})})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var $u={};$u.version="0.18.5";var Oj=1252,XL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Rj=function(t){XL.indexOf(t)!=-1&&(Oj=t)};function JL(){Rj(1252)}var gc=function(t){Rj(t)};function ZL(){gc(1200),JL()}var du=function(s){return String.fromCharCode(s)},db=function(s){return String.fromCharCode(s)},Qu,vi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function yc(t){for(var s="",r=0,n=0,a=0,l=0,c=0,u=0,f=0,h=0;h<t.length;)r=t.charCodeAt(h++),l=r>>2,n=t.charCodeAt(h++),c=(r&3)<<4|n>>4,a=t.charCodeAt(h++),u=(n&15)<<2|a>>6,f=a&63,isNaN(n)?u=f=64:isNaN(a)&&(f=64),s+=vi.charAt(l)+vi.charAt(c)+vi.charAt(u)+vi.charAt(f);return s}function Va(t){var s="",r=0,n=0,a=0,l=0,c=0,u=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)l=vi.indexOf(t.charAt(h++)),c=vi.indexOf(t.charAt(h++)),r=l<<2|c>>4,s+=String.fromCharCode(r),u=vi.indexOf(t.charAt(h++)),n=(c&15)<<4|u>>2,u!==64&&(s+=String.fromCharCode(n)),f=vi.indexOf(t.charAt(h++)),a=(u&3)<<6|f,f!==64&&(s+=String.fromCharCode(a));return s}var As=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ha=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(s,r){return r?new Buffer(s,r):new Buffer(s)}:Buffer.from.bind(Buffer)}return function(){}})();function rl(t){return As?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function ub(t){return As?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Yn=function(s){return As?Ha(s,"binary"):s.split("").map(function(r){return r.charCodeAt(0)&255})};function Pm(t){if(typeof ArrayBuffer>"u")return Yn(t);for(var s=new ArrayBuffer(t.length),r=new Uint8Array(s),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return s}function Qc(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var s=[],r=0;r<t.length;++r)s[r]=String.fromCharCode(t[r]);return s.join("")}function e9(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var Lr=As?function(t){return Buffer.concat(t.map(function(s){return Buffer.isBuffer(s)?s:Ha(s)}))}:function(t){if(typeof Uint8Array<"u"){var s=0,r=0;for(s=0;s<t.length;++s)r+=t[s].length;var n=new Uint8Array(r),a=0;for(s=0,r=0;s<t.length;r+=a,++s)if(a=t[s].length,t[s]instanceof Uint8Array)n.set(t[s],r);else{if(typeof t[s]=="string")throw"wtf";n.set(new Uint8Array(t[s]),r)}return n}return[].concat.apply([],t.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function t9(t){for(var s=[],r=0,n=t.length+250,a=rl(t.length+255),l=0;l<t.length;++l){var c=t.charCodeAt(l);if(c<128)a[r++]=c;else if(c<2048)a[r++]=192|c>>6&31,a[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=t.charCodeAt(++l)&1023;a[r++]=240|c>>8&7,a[r++]=128|c>>2&63,a[r++]=128|u>>6&15|(c&3)<<4,a[r++]=128|u&63}else a[r++]=224|c>>12&15,a[r++]=128|c>>6&63,a[r++]=128|c&63;r>n&&(s.push(a.slice(0,r)),r=0,a=rl(65535),n=65530)}return s.push(a.slice(0,r)),Lr(s)}var lc=/\u0000/g,uu=/[\u0001-\u0006]/g;function Gl(t){for(var s="",r=t.length-1;r>=0;)s+=t.charAt(r--);return s}function Kn(t,s){var r=""+t;return r.length>=s?r:tr("0",s-r.length)+r}function kh(t,s){var r=""+t;return r.length>=s?r:tr(" ",s-r.length)+r}function Uu(t,s){var r=""+t;return r.length>=s?r:r+tr(" ",s-r.length)}function s9(t,s){var r=""+Math.round(t);return r.length>=s?r:tr("0",s-r.length)+r}function r9(t,s){var r=""+t;return r.length>=s?r:tr("0",s-r.length)+r}var mb=Math.pow(2,32);function Bl(t,s){if(t>mb||t<-mb)return s9(t,s);var r=Math.round(t);return r9(r,s)}function Vu(t,s){return s=s||0,t.length>=7+s&&(t.charCodeAt(s)|32)===103&&(t.charCodeAt(s+1)|32)===101&&(t.charCodeAt(s+2)|32)===110&&(t.charCodeAt(s+3)|32)===101&&(t.charCodeAt(s+4)|32)===114&&(t.charCodeAt(s+5)|32)===97&&(t.charCodeAt(s+6)|32)===108}var pb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],W0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function n9(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ir={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},xb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},a9={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Wu(t,s,r){for(var n=t<0?-1:1,a=t*n,l=0,c=1,u=0,f=1,h=0,v=0,w=Math.floor(a);h<s&&(w=Math.floor(a),u=w*c+l,v=w*h+f,!(a-w<5e-8));)a=1/(a-w),l=c,c=u,f=h,h=v;if(v>s&&(h>s?(v=f,u=l):(v=h,u=c)),!r)return[0,n*u,v];var j=Math.floor(n*u/v);return[j,n*u-j*v,v]}function mu(t,s,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),l=0,c=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),s&&s.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)c=r?[1317,10,29]:[1900,2,29],l=3;else if(n===0)c=r?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),c=[f.getFullYear(),f.getMonth()+1,f.getDate()],l=f.getDay(),n<60&&(l=(l+6)%7),r&&(l=m9(f,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=l,u}var Dj=new Date(1899,11,31,0,0,0),i9=Dj.getTime(),l9=new Date(1900,2,1,0,0,0);function Lj(t,s){var r=t.getTime();return s?r-=1461*24*60*60*1e3:t>=l9&&(r+=1440*60*1e3),(r-(i9+(t.getTimezoneOffset()-Dj.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Ch(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function o9(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function c9(t){var s=t<0?12:11,r=Ch(t.toFixed(12));return r.length<=s||(r=t.toPrecision(10),r.length<=s)?r:t.toExponential(5)}function d9(t){var s=Ch(t.toFixed(11));return s.length>(t<0?12:11)||s==="0"||s==="-0"?t.toPrecision(6):s}function u9(t){var s=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return s>=-4&&s<=-1?r=t.toPrecision(10+s):Math.abs(s)<=9?r=c9(t):s===10?r=t.toFixed(10).substr(0,12):r=d9(t),Ch(o9(r.toUpperCase()))}function Cx(t,s){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):u9(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Si(14,Lj(t,s&&s.date1904),s)}throw new Error("unsupported value in General format: "+t)}function m9(t,s){s[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function p9(t,s,r,n){var a="",l=0,c=0,u=r.y,f,h=0;switch(t){case 98:u=r.y+543;case 121:switch(s.length){case 1:case 2:f=u%100,h=2;break;default:f=u%1e4,h=4;break}break;case 109:switch(s.length){case 1:case 2:f=r.m,h=s.length;break;case 3:return W0[r.m-1][1];case 5:return W0[r.m-1][0];default:return W0[r.m-1][2]}break;case 100:switch(s.length){case 1:case 2:f=r.d,h=s.length;break;case 3:return pb[r.q][0];default:return pb[r.q][1]}break;case 104:switch(s.length){case 1:case 2:f=1+(r.H+11)%12,h=s.length;break;default:throw"bad hour format: "+s}break;case 72:switch(s.length){case 1:case 2:f=r.H,h=s.length;break;default:throw"bad hour format: "+s}break;case 77:switch(s.length){case 1:case 2:f=r.M,h=s.length;break;default:throw"bad minute format: "+s}break;case 115:if(s!="s"&&s!="ss"&&s!=".0"&&s!=".00"&&s!=".000")throw"bad second format: "+s;return r.u===0&&(s=="s"||s=="ss")?Kn(r.S,s.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,l=Math.round(c*(r.S+r.u)),l>=60*c&&(l=0),s==="s"?l===0?"0":""+l/c:(a=Kn(l,2+n),s==="ss"?a.substr(0,2):"."+a.substr(2,s.length-1)));case 90:switch(s){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+s}h=s.length===3?1:2;break;case 101:f=u,h=1;break}var v=h>0?Kn(f,h):"";return v}function bi(t){var s=3;if(t.length<=s)return t;for(var r=t.length%s,n=t.substr(0,r);r!=t.length;r+=s)n+=(n.length>0?",":"")+t.substr(r,s);return n}var Fj=/%/g;function x9(t,s,r){var n=s.replace(Fj,""),a=s.length-n.length;return qa(t,n,r*Math.pow(10,2*a))+tr("%",a)}function h9(t,s,r){for(var n=s.length-1;s.charCodeAt(n-1)===44;)--n;return qa(t,s.substr(0,n),r/Math.pow(10,3*(s.length-n)))}function Mj(t,s){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(s==0)return"0.0E+0";if(s<0)return"-"+Mj(t,-s);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var l=Math.floor(Math.log(s)*Math.LOG10E)%a;if(l<0&&(l+=a),r=(s/Math.pow(10,l)).toPrecision(n+1+(a+l)%a),r.indexOf("e")===-1){var c=Math.floor(Math.log(s)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,h,v){return f+h+v.substr(0,(a+l)%a)+"."+v.substr(l)+"E"})}else r=s.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Ij=/# (\?+)( ?)\/( ?)(\d+)/;function f9(t,s,r){var n=parseInt(t[4],10),a=Math.round(s*n),l=Math.floor(a/n),c=a-l*n,u=n;return r+(l===0?"":""+l)+" "+(c===0?tr(" ",t[1].length+1+t[4].length):kh(c,t[1].length)+t[2]+"/"+t[3]+Kn(u,t[4].length))}function g9(t,s,r){return r+(s===0?"":""+s)+tr(" ",t[1].length+2+t[4].length)}var qj=/^#*0*\.([0#]+)/,Bj=/\).*[0#]/,zj=/\(###\) ###\\?-####/;function Jr(t){for(var s="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:s+=" ";break;case 48:s+="0";break;default:s+=String.fromCharCode(r)}return s}function hb(t,s){var r=Math.pow(10,s);return""+Math.round(t*r)/r}function fb(t,s){var r=t-Math.floor(t),n=Math.pow(10,s);return s<(""+Math.round(r*n)).length?0:Math.round(r*n)}function y9(t,s){return s<(""+Math.round((t-Math.floor(t))*Math.pow(10,s))).length?1:0}function v9(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Fn(t,s,r){if(t.charCodeAt(0)===40&&!s.match(Bj)){var n=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Fn("n",n,r):"("+Fn("n",n,-r)+")"}if(s.charCodeAt(s.length-1)===44)return h9(t,s,r);if(s.indexOf("%")!==-1)return x9(t,s,r);if(s.indexOf("E")!==-1)return Mj(s,r);if(s.charCodeAt(0)===36)return"$"+Fn(t,s.substr(s.charAt(1)==" "?2:1),r);var a,l,c,u,f=Math.abs(r),h=r<0?"-":"";if(s.match(/^00+$/))return h+Bl(f,s.length);if(s.match(/^[#?]+$/))return a=Bl(r,0),a==="0"&&(a=""),a.length>s.length?a:Jr(s.substr(0,s.length-a.length))+a;if(l=s.match(Ij))return f9(l,f,h);if(s.match(/^#+0+$/))return h+Bl(f,s.length-s.indexOf("0"));if(l=s.match(qj))return a=hb(r,l[1].length).replace(/^([^\.]+)$/,"$1."+Jr(l[1])).replace(/\.$/,"."+Jr(l[1])).replace(/\.(\d*)$/,function(k,S){return"."+S+tr("0",Jr(l[1]).length-S.length)}),s.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),l=s.match(/^(0*)\.(#*)$/))return h+hb(f,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=s.match(/^#{1,3},##0(\.?)$/))return h+bi(Bl(f,0));if(l=s.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Fn(t,s,-r):bi(""+(Math.floor(r)+y9(r,l[1].length)))+"."+Kn(fb(r,l[1].length),l[1].length);if(l=s.match(/^#,#*,#0/))return Fn(t,s.replace(/^#,#*,/,""),r);if(l=s.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Gl(Fn(t,s.replace(/[\\-]/g,""),r)),c=0,Gl(Gl(s.replace(/\\/g,"")).replace(/[0#]/g,function(k){return c<a.length?a.charAt(c++):k==="0"?"0":""}));if(s.match(zj))return a=Fn(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var v="";if(l=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=Wu(f,Math.pow(10,c)-1,!1),a=""+h,v=qa("n",l[1],u[1]),v.charAt(v.length-1)==" "&&(v=v.substr(0,v.length-1)+"0"),a+=v+l[2]+"/"+l[3],v=Uu(u[2],c),v.length<l[4].length&&(v=Jr(l[4].substr(l[4].length-v.length))+v),a+=v,a;if(l=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=Wu(f,Math.pow(10,c)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?kh(u[1],c)+l[2]+"/"+l[3]+Uu(u[2],c):tr(" ",2*c+1+l[2].length+l[3].length));if(l=s.match(/^[#0?]+$/))return a=Bl(r,0),s.length<=a.length?a:Jr(s.substr(0,s.length-a.length))+a;if(l=s.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var w=s.indexOf(".")-c,j=s.length-a.length-w;return Jr(s.substr(0,w)+a+s.substr(s.length-j))}if(l=s.match(/^00,000\.([#0]*0)$/))return c=fb(r,l[1].length),r<0?"-"+Fn(t,s,-r):bi(v9(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?Kn(0,3-k.length):"")+k})+"."+Kn(c,l[1].length);switch(s){case"###,##0.00":return Fn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var C=bi(Bl(f,0));return C!=="0"?h+C:"";case"###,###.00":return Fn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Fn(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+s+"|")}function b9(t,s,r){for(var n=s.length-1;s.charCodeAt(n-1)===44;)--n;return qa(t,s.substr(0,n),r/Math.pow(10,3*(s.length-n)))}function w9(t,s,r){var n=s.replace(Fj,""),a=s.length-n.length;return qa(t,n,r*Math.pow(10,2*a))+tr("%",a)}function $j(t,s){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(s==0)return"0.0E+0";if(s<0)return"-"+$j(t,-s);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var l=Math.floor(Math.log(s)*Math.LOG10E)%a;if(l<0&&(l+=a),r=(s/Math.pow(10,l)).toPrecision(n+1+(a+l)%a),!r.match(/[Ee]/)){var c=Math.floor(Math.log(s)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+l):r+="E+"+(c-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,h,v){return f+h+v.substr(0,(a+l)%a)+"."+v.substr(l)+"E"})}else r=s.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function pa(t,s,r){if(t.charCodeAt(0)===40&&!s.match(Bj)){var n=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?pa("n",n,r):"("+pa("n",n,-r)+")"}if(s.charCodeAt(s.length-1)===44)return b9(t,s,r);if(s.indexOf("%")!==-1)return w9(t,s,r);if(s.indexOf("E")!==-1)return $j(s,r);if(s.charCodeAt(0)===36)return"$"+pa(t,s.substr(s.charAt(1)==" "?2:1),r);var a,l,c,u,f=Math.abs(r),h=r<0?"-":"";if(s.match(/^00+$/))return h+Kn(f,s.length);if(s.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>s.length?a:Jr(s.substr(0,s.length-a.length))+a;if(l=s.match(Ij))return g9(l,f,h);if(s.match(/^#+0+$/))return h+Kn(f,s.length-s.indexOf("0"));if(l=s.match(qj))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Jr(l[1])).replace(/\.$/,"."+Jr(l[1])),a=a.replace(/\.(\d*)$/,function(k,S){return"."+S+tr("0",Jr(l[1]).length-S.length)}),s.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),l=s.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=s.match(/^#{1,3},##0(\.?)$/))return h+bi(""+f);if(l=s.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+pa(t,s,-r):bi(""+r)+"."+tr("0",l[1].length);if(l=s.match(/^#,#*,#0/))return pa(t,s.replace(/^#,#*,/,""),r);if(l=s.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Gl(pa(t,s.replace(/[\\-]/g,""),r)),c=0,Gl(Gl(s.replace(/\\/g,"")).replace(/[0#]/g,function(k){return c<a.length?a.charAt(c++):k==="0"?"0":""}));if(s.match(zj))return a=pa(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var v="";if(l=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=Wu(f,Math.pow(10,c)-1,!1),a=""+h,v=qa("n",l[1],u[1]),v.charAt(v.length-1)==" "&&(v=v.substr(0,v.length-1)+"0"),a+=v+l[2]+"/"+l[3],v=Uu(u[2],c),v.length<l[4].length&&(v=Jr(l[4].substr(l[4].length-v.length))+v),a+=v,a;if(l=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=Wu(f,Math.pow(10,c)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?kh(u[1],c)+l[2]+"/"+l[3]+Uu(u[2],c):tr(" ",2*c+1+l[2].length+l[3].length));if(l=s.match(/^[#0?]+$/))return a=""+r,s.length<=a.length?a:Jr(s.substr(0,s.length-a.length))+a;if(l=s.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var w=s.indexOf(".")-c,j=s.length-a.length-w;return Jr(s.substr(0,w)+a+s.substr(s.length-j))}if(l=s.match(/^00,000\.([#0]*0)$/))return r<0?"-"+pa(t,s,-r):bi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?Kn(0,3-k.length):"")+k})+"."+Kn(0,l[1].length);switch(s){case"###,###":case"##,###":case"#,###":var C=bi(""+f);return C!=="0"?h+C:"";default:if(s.match(/\.[0#?]*$/))return pa(t,s.slice(0,s.lastIndexOf(".")),r)+Jr(s.slice(s.lastIndexOf(".")))}throw new Error("unsupported format |"+s+"|")}function qa(t,s,r){return(r|0)===r?pa(t,s,r):Fn(t,s,r)}function N9(t){for(var s=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:s[s.length]=t.substr(a,n-a),a=n+1}if(s[s.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return s}var Qj=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Uj(t){for(var s=0,r="",n="";s<t.length;)switch(r=t.charAt(s)){case"G":Vu(t,s)&&(s+=6),s++;break;case'"':for(;t.charCodeAt(++s)!==34&&s<t.length;);++s;break;case"\\":s+=2;break;case"_":s+=2;break;case"@":++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(s,3).toUpperCase()==="A/P"||t.substr(s,5).toUpperCase()==="AM/PM"||t.substr(s,5).toUpperCase()==="/")return!0;++s;break;case"[":for(n=r;t.charAt(s++)!=="]"&&s<t.length;)n+=t.charAt(s);if(n.match(Qj))return!0;break;case".":case"0":case"#":for(;s<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++s))>-1||r=="\\"&&t.charAt(s+1)=="-"&&"0#".indexOf(t.charAt(s+2))>-1););break;case"?":for(;t.charAt(++s)===r;);break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;);break;case" ":++s;break;default:++s;break}return!1}function j9(t,s,r,n){for(var a=[],l="",c=0,u="",f="t",h,v,w,j="H";c<t.length;)switch(u=t.charAt(c)){case"G":if(!Vu(t,c))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(w=t.charCodeAt(++c))!==34&&c<t.length;)l+=String.fromCharCode(w);a[a.length]={t:"t",v:l},++c;break;case"\\":var C=t.charAt(++c),k=C==="("||C===")"?C:"t";a[a.length]={t:k,v:C},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:s},++c;break;case"B":case"b":if(t.charAt(c+1)==="1"||t.charAt(c+1)==="2"){if(h==null&&(h=mu(s,r,t.charAt(c+1)==="2"),h==null))return"";a[a.length]={t:"X",v:t.substr(c,2)},f=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(s<0||h==null&&(h=mu(s,r),h==null))return"";for(l=u;++c<t.length&&t.charAt(c).toLowerCase()===u;)l+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=j),a[a.length]={t:u,v:l},f=u;break;case"A":case"a":case"":var S={t:u,v:u};if(h==null&&(h=mu(s,r)),t.substr(c,3).toUpperCase()==="A/P"?(h!=null&&(S.v=h.H>=12?"P":"A"),S.t="T",j="h",c+=3):t.substr(c,5).toUpperCase()==="AM/PM"?(h!=null&&(S.v=h.H>=12?"PM":"AM"),S.t="T",c+=5,j="h"):t.substr(c,5).toUpperCase()==="/"?(h!=null&&(S.v=h.H>=12?"":""),S.t="T",c+=5,j="h"):(S.t="t",++c),h==null&&S.t==="T")return"";a[a.length]=S,f=u;break;case"[":for(l=u;t.charAt(c++)!=="]"&&c<t.length;)l+=t.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Qj)){if(h==null&&(h=mu(s,r),h==null))return"";a[a.length]={t:"Z",v:l.toLowerCase()},f=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Uj(t)||(a[a.length]={t:"t",v:l}));break;case".":if(h!=null){for(l=u;++c<t.length&&(u=t.charAt(c))==="0";)l+=u;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(c))>-1;)l+=u;a[a.length]={t:"n",v:l};break;case"?":for(l=u;t.charAt(++c)===u;)l+=u;a[a.length]={t:u,v:l},f=u;break;case"*":++c,(t.charAt(c)==" "||t.charAt(c)=="*")&&++c;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<t.length&&"0123456789".indexOf(t.charAt(++c))>-1;)l+=t.charAt(c);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++c;break}var _=0,I=0,F;for(c=a.length-1,f="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=j,f="h",_<1&&(_=1);break;case"s":(F=a[c].v.match(/\.0+$/))&&(I=Math.max(I,F[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":f=a[c].t;break;case"m":f==="s"&&(a[c].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[c].v.match(/[Hh]/)&&(_=1),_<2&&a[c].v.match(/[Mm]/)&&(_=2),_<3&&a[c].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var B="",q;for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=p9(a[c].t.charCodeAt(0),a[c].v,h,I),a[c].t="t";break;case"n":case"?":for(q=c+1;a[q]!=null&&((u=a[q].t)==="?"||u==="D"||(u===" "||u==="t")&&a[q+1]!=null&&(a[q+1].t==="?"||a[q+1].t==="t"&&a[q+1].v==="/")||a[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[q].v==="/"||a[q].v===" "&&a[q+1]!=null&&a[q+1].t=="?"));)a[c].v+=a[q].v,a[q]={v:"",t:";"},++q;B+=a[c].v,c=q-1;break;case"G":a[c].t="t",a[c].v=Cx(s,r);break}var me="",re,M;if(B.length>0){B.charCodeAt(0)==40?(re=s<0&&B.charCodeAt(0)===45?-s:s,M=qa("n",B,re)):(re=s<0&&n>1?-s:s,M=qa("n",B,re),re<0&&a[0]&&a[0].t=="t"&&(M=M.substr(1),a[0].v="-"+a[0].v)),q=M.length-1;var W=a.length;for(c=0;c<a.length;++c)if(a[c]!=null&&a[c].t!="t"&&a[c].v.indexOf(".")>-1){W=c;break}var oe=a.length;if(W===a.length&&M.indexOf("E")===-1){for(c=a.length-1;c>=0;--c)a[c]==null||"n?".indexOf(a[c].t)===-1||(q>=a[c].v.length-1?(q-=a[c].v.length,a[c].v=M.substr(q+1,a[c].v.length)):q<0?a[c].v="":(a[c].v=M.substr(0,q+1),q=-1),a[c].t="t",oe=c);q>=0&&oe<a.length&&(a[oe].v=M.substr(0,q+1)+a[oe].v)}else if(W!==a.length&&M.indexOf("E")===-1){for(q=M.indexOf(".")-1,c=W;c>=0;--c)if(!(a[c]==null||"n?".indexOf(a[c].t)===-1)){for(v=a[c].v.indexOf(".")>-1&&c===W?a[c].v.indexOf(".")-1:a[c].v.length-1,me=a[c].v.substr(v+1);v>=0;--v)q>=0&&(a[c].v.charAt(v)==="0"||a[c].v.charAt(v)==="#")&&(me=M.charAt(q--)+me);a[c].v=me,a[c].t="t",oe=c}for(q>=0&&oe<a.length&&(a[oe].v=M.substr(0,q+1)+a[oe].v),q=M.indexOf(".")+1,c=W;c<a.length;++c)if(!(a[c]==null||"n?(".indexOf(a[c].t)===-1&&c!==W)){for(v=a[c].v.indexOf(".")>-1&&c===W?a[c].v.indexOf(".")+1:0,me=a[c].v.substr(0,v);v<a[c].v.length;++v)q<M.length&&(me+=M.charAt(q++));a[c].v=me,a[c].t="t",oe=c}}}for(c=0;c<a.length;++c)a[c]!=null&&"n?".indexOf(a[c].t)>-1&&(re=n>1&&s<0&&c>0&&a[c-1].v==="-"?-s:s,a[c].v=qa(a[c].t,a[c].v,re),a[c].t="t");var X="";for(c=0;c!==a.length;++c)a[c]!=null&&(X+=a[c].v);return X}var gb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function yb(t,s){if(s==null)return!1;var r=parseFloat(s[2]);switch(s[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function S9(t,s){var r=N9(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof s!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=s>0?r[0]:s<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(gb),u=r[1].match(gb);return yb(s,c)?[n,r[0]]:yb(s,u)?[n,r[1]]:[n,r[c!=null&&u!=null?2:1]]}return[n,l]}function Si(t,s,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ir)[t],n==null&&(n=r.table&&r.table[xb[t]]||ir[xb[t]]),n==null&&(n=a9[t]||"General");break}if(Vu(n,0))return Cx(s,r);s instanceof Date&&(s=Lj(s,r.date1904));var a=S9(n,s);if(Vu(a[1]))return Cx(s,r);if(s===!0)s="TRUE";else if(s===!1)s="FALSE";else if(s===""||s==null)return"";return j9(a[1],s,r,a[0])}function Vj(t,s){if(typeof s!="number"){s=+s||-1;for(var r=0;r<392;++r){if(ir[r]==null){s<0&&(s=r);continue}if(ir[r]==t){s=r;break}}s<0&&(s=391)}return ir[s]=t,s}function Am(t){for(var s=0;s!=392;++s)t[s]!==void 0&&Vj(t[s],s)}function Tm(){ir=n9()}var Wj=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function k9(t){var s=typeof t=="number"?ir[t]:t;return s=s.replace(Wj,"(\\d+)"),new RegExp("^"+s+"$")}function C9(t,s,r){var n=-1,a=-1,l=-1,c=-1,u=-1,f=-1;(s.match(Wj)||[]).forEach(function(w,j){var C=parseInt(r[j+1],10);switch(w.toLowerCase().charAt(0)){case"y":n=C;break;case"d":l=C;break;case"h":c=C;break;case"s":f=C;break;case"m":c>=0?u=C:a=C;break}}),f>=0&&u==-1&&a>=0&&(u=a,a=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var v=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return c==-1&&u==-1&&f==-1?h:n==-1&&a==-1&&l==-1?v:h+"T"+v}var _9=(function(){var t={};t.version="1.2.0";function s(){for(var M=0,W=new Array(256),oe=0;oe!=256;++oe)M=oe,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,W[oe]=M;return typeof Int32Array<"u"?new Int32Array(W):W}var r=s();function n(M){var W=0,oe=0,X=0,he=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)he[X]=M[X];for(X=0;X!=256;++X)for(oe=M[X],W=256+X;W<4096;W+=256)oe=he[W]=oe>>>8^M[oe&255];var ue=[];for(X=1;X!=16;++X)ue[X-1]=typeof Int32Array<"u"?he.subarray(X*256,X*256+256):he.slice(X*256,X*256+256);return ue}var a=n(r),l=a[0],c=a[1],u=a[2],f=a[3],h=a[4],v=a[5],w=a[6],j=a[7],C=a[8],k=a[9],S=a[10],_=a[11],I=a[12],F=a[13],B=a[14];function q(M,W){for(var oe=W^-1,X=0,he=M.length;X<he;)oe=oe>>>8^r[(oe^M.charCodeAt(X++))&255];return~oe}function me(M,W){for(var oe=W^-1,X=M.length-15,he=0;he<X;)oe=B[M[he++]^oe&255]^F[M[he++]^oe>>8&255]^I[M[he++]^oe>>16&255]^_[M[he++]^oe>>>24]^S[M[he++]]^k[M[he++]]^C[M[he++]]^j[M[he++]]^w[M[he++]]^v[M[he++]]^h[M[he++]]^f[M[he++]]^u[M[he++]]^c[M[he++]]^l[M[he++]]^r[M[he++]];for(X+=15;he<X;)oe=oe>>>8^r[(oe^M[he++])&255];return~oe}function re(M,W){for(var oe=W^-1,X=0,he=M.length,ue=0,_e=0;X<he;)ue=M.charCodeAt(X++),ue<128?oe=oe>>>8^r[(oe^ue)&255]:ue<2048?(oe=oe>>>8^r[(oe^(192|ue>>6&31))&255],oe=oe>>>8^r[(oe^(128|ue&63))&255]):ue>=55296&&ue<57344?(ue=(ue&1023)+64,_e=M.charCodeAt(X++)&1023,oe=oe>>>8^r[(oe^(240|ue>>8&7))&255],oe=oe>>>8^r[(oe^(128|ue>>2&63))&255],oe=oe>>>8^r[(oe^(128|_e>>6&15|(ue&3)<<4))&255],oe=oe>>>8^r[(oe^(128|_e&63))&255]):(oe=oe>>>8^r[(oe^(224|ue>>12&15))&255],oe=oe>>>8^r[(oe^(128|ue>>6&63))&255],oe=oe>>>8^r[(oe^(128|ue&63))&255]);return~oe}return t.table=r,t.bstr=q,t.buf=me,t.str=re,t})(),Is=(function(){var s={};s.version="1.2.1";function r(V,ie){for(var K=V.split("/"),ee=ie.split("/"),de=0,le=0,Pe=Math.min(K.length,ee.length);de<Pe;++de){if(le=K[de].length-ee[de].length)return le;if(K[de]!=ee[de])return K[de]<ee[de]?-1:1}return K.length-ee.length}function n(V){if(V.charAt(V.length-1)=="/")return V.slice(0,-1).indexOf("/")===-1?V:n(V.slice(0,-1));var ie=V.lastIndexOf("/");return ie===-1?V:V.slice(0,ie+1)}function a(V){if(V.charAt(V.length-1)=="/")return a(V.slice(0,-1));var ie=V.lastIndexOf("/");return ie===-1?V:V.slice(ie+1)}function l(V,ie){typeof ie=="string"&&(ie=new Date(ie));var K=ie.getHours();K=K<<6|ie.getMinutes(),K=K<<5|ie.getSeconds()>>>1,V.write_shift(2,K);var ee=ie.getFullYear()-1980;ee=ee<<4|ie.getMonth()+1,ee=ee<<5|ie.getDate(),V.write_shift(2,ee)}function c(V){var ie=V.read_shift(2)&65535,K=V.read_shift(2)&65535,ee=new Date,de=K&31;K>>>=5;var le=K&15;K>>>=4,ee.setMilliseconds(0),ee.setFullYear(K+1980),ee.setMonth(le-1),ee.setDate(de);var Pe=ie&31;ie>>>=5;var Be=ie&63;return ie>>>=6,ee.setHours(ie),ee.setMinutes(Be),ee.setSeconds(Pe<<1),ee}function u(V){Nn(V,0);for(var ie={},K=0;V.l<=V.length-4;){var ee=V.read_shift(2),de=V.read_shift(2),le=V.l+de,Pe={};switch(ee){case 21589:K=V.read_shift(1),K&1&&(Pe.mtime=V.read_shift(4)),de>5&&(K&2&&(Pe.atime=V.read_shift(4)),K&4&&(Pe.ctime=V.read_shift(4))),Pe.mtime&&(Pe.mt=new Date(Pe.mtime*1e3));break}V.l=le,ie[ee]=Pe}return ie}var f;function h(){return f||(f={})}function v(V,ie){if(V[0]==80&&V[1]==75)return Vt(V,ie);if((V[0]|32)==109&&(V[1]|32)==105)return Kt(V,ie);if(V.length<512)throw new Error("CFB file size "+V.length+" < 512");var K=3,ee=512,de=0,le=0,Pe=0,Be=0,Te=0,je=[],Ce=V.slice(0,512);Nn(Ce,0);var Fe=w(Ce);switch(K=Fe[0],K){case 3:ee=512;break;case 4:ee=4096;break;case 0:if(Fe[1]==0)return Vt(V,ie);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}ee!==512&&(Ce=V.slice(0,ee),Nn(Ce,28));var We=V.slice(0,ee);j(Ce,K);var ge=Ce.read_shift(4,"i");if(K===3&&ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ge);Ce.l+=4,Pe=Ce.read_shift(4,"i"),Ce.l+=4,Ce.chk("00100000","Mini Stream Cutoff Size: "),Be=Ce.read_shift(4,"i"),de=Ce.read_shift(4,"i"),Te=Ce.read_shift(4,"i"),le=Ce.read_shift(4,"i");for(var G=-1,T=0;T<109&&(G=Ce.read_shift(4,"i"),!(G<0));++T)je[T]=G;var x=C(V,ee);_(Te,le,x,ee,je);var A=F(x,Pe,je,ee);A[Pe].name="!Directory",de>0&&Be!==_e&&(A[Be].name="!MiniFAT"),A[je[0]].name="!FAT",A.fat_addrs=je,A.ssz=ee;var g={},p=[],y=[],N=[];B(Pe,A,x,p,de,g,y,Be),k(y,N,p),p.shift();var P={FileIndex:y,FullPaths:N};return ie&&ie.raw&&(P.raw={header:We,sectors:x}),P}function w(V){if(V[V.l]==80&&V[V.l+1]==75)return[0,0];V.chk(ke,"Header Signature: "),V.l+=16;var ie=V.read_shift(2,"u");return[V.read_shift(2,"u"),ie]}function j(V,ie){var K=9;switch(V.l+=2,K=V.read_shift(2)){case 9:if(ie!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(ie!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}V.chk("0600","Mini Sector Shift: "),V.chk("000000000000","Reserved: ")}function C(V,ie){for(var K=Math.ceil(V.length/ie)-1,ee=[],de=1;de<K;++de)ee[de-1]=V.slice(de*ie,(de+1)*ie);return ee[K-1]=V.slice(K*ie),ee}function k(V,ie,K){for(var ee=0,de=0,le=0,Pe=0,Be=0,Te=K.length,je=[],Ce=[];ee<Te;++ee)je[ee]=Ce[ee]=ee,ie[ee]=K[ee];for(;Be<Ce.length;++Be)ee=Ce[Be],de=V[ee].L,le=V[ee].R,Pe=V[ee].C,je[ee]===ee&&(de!==-1&&je[de]!==de&&(je[ee]=je[de]),le!==-1&&je[le]!==le&&(je[ee]=je[le])),Pe!==-1&&(je[Pe]=ee),de!==-1&&ee!=je[ee]&&(je[de]=je[ee],Ce.lastIndexOf(de)<Be&&Ce.push(de)),le!==-1&&ee!=je[ee]&&(je[le]=je[ee],Ce.lastIndexOf(le)<Be&&Ce.push(le));for(ee=1;ee<Te;++ee)je[ee]===ee&&(le!==-1&&je[le]!==le?je[ee]=je[le]:de!==-1&&je[de]!==de&&(je[ee]=je[de]));for(ee=1;ee<Te;++ee)if(V[ee].type!==0){if(Be=ee,Be!=je[Be])do Be=je[Be],ie[ee]=ie[Be]+"/"+ie[ee];while(Be!==0&&je[Be]!==-1&&Be!=je[Be]);je[ee]=-1}for(ie[0]+="/",ee=1;ee<Te;++ee)V[ee].type!==2&&(ie[ee]+="/")}function S(V,ie,K){for(var ee=V.start,de=V.size,le=[],Pe=ee;K&&de>0&&Pe>=0;)le.push(ie.slice(Pe*ue,Pe*ue+ue)),de-=ue,Pe=Vi(K,Pe*4);return le.length===0?st(0):Lr(le).slice(0,V.size)}function _(V,ie,K,ee,de){var le=_e;if(V===_e){if(ie!==0)throw new Error("DIFAT chain shorter than expected")}else if(V!==-1){var Pe=K[V],Be=(ee>>>2)-1;if(!Pe)return;for(var Te=0;Te<Be&&(le=Vi(Pe,Te*4))!==_e;++Te)de.push(le);_(Vi(Pe,ee-4),ie-1,K,ee,de)}}function I(V,ie,K,ee,de){var le=[],Pe=[];de||(de=[]);var Be=ee-1,Te=0,je=0;for(Te=ie;Te>=0;){de[Te]=!0,le[le.length]=Te,Pe.push(V[Te]);var Ce=K[Math.floor(Te*4/ee)];if(je=Te*4&Be,ee<4+je)throw new Error("FAT boundary crossed: "+Te+" 4 "+ee);if(!V[Ce])break;Te=Vi(V[Ce],je)}return{nodes:le,data:Cb([Pe])}}function F(V,ie,K,ee){var de=V.length,le=[],Pe=[],Be=[],Te=[],je=ee-1,Ce=0,Fe=0,We=0,ge=0;for(Ce=0;Ce<de;++Ce)if(Be=[],We=Ce+ie,We>=de&&(We-=de),!Pe[We]){Te=[];var G=[];for(Fe=We;Fe>=0;){G[Fe]=!0,Pe[Fe]=!0,Be[Be.length]=Fe,Te.push(V[Fe]);var T=K[Math.floor(Fe*4/ee)];if(ge=Fe*4&je,ee<4+ge)throw new Error("FAT boundary crossed: "+Fe+" 4 "+ee);if(!V[T]||(Fe=Vi(V[T],ge),G[Fe]))break}le[We]={nodes:Be,data:Cb([Te])}}return le}function B(V,ie,K,ee,de,le,Pe,Be){for(var Te=0,je=ee.length?2:0,Ce=ie[V].data,Fe=0,We=0,ge;Fe<Ce.length;Fe+=128){var G=Ce.slice(Fe,Fe+128);Nn(G,64),We=G.read_shift(2),ge=Th(G,0,We-je),ee.push(ge);var T={name:ge,type:G.read_shift(1),color:G.read_shift(1),L:G.read_shift(4,"i"),R:G.read_shift(4,"i"),C:G.read_shift(4,"i"),clsid:G.read_shift(16),state:G.read_shift(4,"i"),start:0,size:0},x=G.read_shift(2)+G.read_shift(2)+G.read_shift(2)+G.read_shift(2);x!==0&&(T.ct=q(G,G.l-8));var A=G.read_shift(2)+G.read_shift(2)+G.read_shift(2)+G.read_shift(2);A!==0&&(T.mt=q(G,G.l-8)),T.start=G.read_shift(4,"i"),T.size=G.read_shift(4,"i"),T.size<0&&T.start<0&&(T.size=T.type=0,T.start=_e,T.name=""),T.type===5?(Te=T.start,de>0&&Te!==_e&&(ie[Te].name="!StreamData")):T.size>=4096?(T.storage="fat",ie[T.start]===void 0&&(ie[T.start]=I(K,T.start,ie.fat_addrs,ie.ssz)),ie[T.start].name=T.name,T.content=ie[T.start].data.slice(0,T.size)):(T.storage="minifat",T.size<0?T.size=0:Te!==_e&&T.start!==_e&&ie[Te]&&(T.content=S(T,ie[Te].data,(ie[Be]||{}).data))),T.content&&Nn(T.content,0),le[ge]=T,Pe.push(T)}}function q(V,ie){return new Date((kn(V,ie+4)/1e7*Math.pow(2,32)+kn(V,ie)/1e7-11644473600)*1e3)}function me(V,ie){return h(),v(f.readFileSync(V),ie)}function re(V,ie){var K=ie&&ie.type;switch(K||As&&Buffer.isBuffer(V)&&(K="buffer"),K||"base64"){case"file":return me(V,ie);case"base64":return v(Yn(Va(V)),ie);case"binary":return v(Yn(V),ie)}return v(V,ie)}function M(V,ie){var K=ie||{},ee=K.root||"Root Entry";if(V.FullPaths||(V.FullPaths=[]),V.FileIndex||(V.FileIndex=[]),V.FullPaths.length!==V.FileIndex.length)throw new Error("inconsistent CFB structure");V.FullPaths.length===0&&(V.FullPaths[0]=ee+"/",V.FileIndex[0]={name:ee,type:5}),K.CLSID&&(V.FileIndex[0].clsid=K.CLSID),W(V)}function W(V){var ie="Sh33tJ5";if(!Is.find(V,"/"+ie)){var K=st(4);K[0]=55,K[1]=K[3]=50,K[2]=54,V.FileIndex.push({name:ie,type:2,content:K,size:4,L:69,R:69,C:69}),V.FullPaths.push(V.FullPaths[0]+ie),oe(V)}}function oe(V,ie){M(V);for(var K=!1,ee=!1,de=V.FullPaths.length-1;de>=0;--de){var le=V.FileIndex[de];switch(le.type){case 0:ee?K=!0:(V.FileIndex.pop(),V.FullPaths.pop());break;case 1:case 2:case 5:ee=!0,isNaN(le.R*le.L*le.C)&&(K=!0),le.R>-1&&le.L>-1&&le.R==le.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!ie)){var Pe=new Date(1987,1,19),Be=0,Te=Object.create?Object.create(null):{},je=[];for(de=0;de<V.FullPaths.length;++de)Te[V.FullPaths[de]]=!0,V.FileIndex[de].type!==0&&je.push([V.FullPaths[de],V.FileIndex[de]]);for(de=0;de<je.length;++de){var Ce=n(je[de][0]);ee=Te[Ce],ee||(je.push([Ce,{name:a(Ce).replace("/",""),type:1,clsid:Y,ct:Pe,mt:Pe,content:null}]),Te[Ce]=!0)}for(je.sort(function(ge,G){return r(ge[0],G[0])}),V.FullPaths=[],V.FileIndex=[],de=0;de<je.length;++de)V.FullPaths[de]=je[de][0],V.FileIndex[de]=je[de][1];for(de=0;de<je.length;++de){var Fe=V.FileIndex[de],We=V.FullPaths[de];if(Fe.name=a(We).replace("/",""),Fe.L=Fe.R=Fe.C=-(Fe.color=1),Fe.size=Fe.content?Fe.content.length:0,Fe.start=0,Fe.clsid=Fe.clsid||Y,de===0)Fe.C=je.length>1?1:-1,Fe.size=0,Fe.type=5;else if(We.slice(-1)=="/"){for(Be=de+1;Be<je.length&&n(V.FullPaths[Be])!=We;++Be);for(Fe.C=Be>=je.length?-1:Be,Be=de+1;Be<je.length&&n(V.FullPaths[Be])!=n(We);++Be);Fe.R=Be>=je.length?-1:Be,Fe.type=1}else n(V.FullPaths[de+1]||"")==n(We)&&(Fe.R=de+1),Fe.type=2}}}function X(V,ie){var K=ie||{};if(K.fileType=="mad")return Bt(V,K);switch(oe(V),K.fileType){case"zip":return yt(V,K)}var ee=(function(ge){for(var G=0,T=0,x=0;x<ge.FileIndex.length;++x){var A=ge.FileIndex[x];if(A.content){var g=A.content.length;g>0&&(g<4096?G+=g+63>>6:T+=g+511>>9)}}for(var p=ge.FullPaths.length+3>>2,y=G+7>>3,N=G+127>>7,P=y+T+p+N,R=P+127>>7,L=R<=109?0:Math.ceil((R-109)/127);P+R+L+127>>7>R;)L=++R<=109?0:Math.ceil((R-109)/127);var Ne=[1,L,R,N,p,T,G,0];return ge.FileIndex[0].size=G<<6,Ne[7]=(ge.FileIndex[0].start=Ne[0]+Ne[1]+Ne[2]+Ne[3]+Ne[4]+Ne[5])+(Ne[6]+7>>3),Ne})(V),de=st(ee[7]<<9),le=0,Pe=0;{for(le=0;le<8;++le)de.write_shift(1,Re[le]);for(le=0;le<8;++le)de.write_shift(2,0);for(de.write_shift(2,62),de.write_shift(2,3),de.write_shift(2,65534),de.write_shift(2,9),de.write_shift(2,6),le=0;le<3;++le)de.write_shift(2,0);for(de.write_shift(4,0),de.write_shift(4,ee[2]),de.write_shift(4,ee[0]+ee[1]+ee[2]+ee[3]-1),de.write_shift(4,0),de.write_shift(4,4096),de.write_shift(4,ee[3]?ee[0]+ee[1]+ee[2]-1:_e),de.write_shift(4,ee[3]),de.write_shift(-4,ee[1]?ee[0]-1:_e),de.write_shift(4,ee[1]),le=0;le<109;++le)de.write_shift(-4,le<ee[2]?ee[1]+le:-1)}if(ee[1])for(Pe=0;Pe<ee[1];++Pe){for(;le<236+Pe*127;++le)de.write_shift(-4,le<ee[2]?ee[1]+le:-1);de.write_shift(-4,Pe===ee[1]-1?_e:Pe+1)}var Be=function(ge){for(Pe+=ge;le<Pe-1;++le)de.write_shift(-4,le+1);ge&&(++le,de.write_shift(-4,_e))};for(Pe=le=0,Pe+=ee[1];le<Pe;++le)de.write_shift(-4,ve.DIFSECT);for(Pe+=ee[2];le<Pe;++le)de.write_shift(-4,ve.FATSECT);Be(ee[3]),Be(ee[4]);for(var Te=0,je=0,Ce=V.FileIndex[0];Te<V.FileIndex.length;++Te)Ce=V.FileIndex[Te],Ce.content&&(je=Ce.content.length,!(je<4096)&&(Ce.start=Pe,Be(je+511>>9)));for(Be(ee[6]+7>>3);de.l&511;)de.write_shift(-4,ve.ENDOFCHAIN);for(Pe=le=0,Te=0;Te<V.FileIndex.length;++Te)Ce=V.FileIndex[Te],Ce.content&&(je=Ce.content.length,!(!je||je>=4096)&&(Ce.start=Pe,Be(je+63>>6)));for(;de.l&511;)de.write_shift(-4,ve.ENDOFCHAIN);for(le=0;le<ee[4]<<2;++le){var Fe=V.FullPaths[le];if(!Fe||Fe.length===0){for(Te=0;Te<17;++Te)de.write_shift(4,0);for(Te=0;Te<3;++Te)de.write_shift(4,-1);for(Te=0;Te<12;++Te)de.write_shift(4,0);continue}Ce=V.FileIndex[le],le===0&&(Ce.start=Ce.size?Ce.start-1:_e);var We=le===0&&K.root||Ce.name;if(je=2*(We.length+1),de.write_shift(64,We,"utf16le"),de.write_shift(2,je),de.write_shift(1,Ce.type),de.write_shift(1,Ce.color),de.write_shift(-4,Ce.L),de.write_shift(-4,Ce.R),de.write_shift(-4,Ce.C),Ce.clsid)de.write_shift(16,Ce.clsid,"hex");else for(Te=0;Te<4;++Te)de.write_shift(4,0);de.write_shift(4,Ce.state||0),de.write_shift(4,0),de.write_shift(4,0),de.write_shift(4,0),de.write_shift(4,0),de.write_shift(4,Ce.start),de.write_shift(4,Ce.size),de.write_shift(4,0)}for(le=1;le<V.FileIndex.length;++le)if(Ce=V.FileIndex[le],Ce.size>=4096)if(de.l=Ce.start+1<<9,As&&Buffer.isBuffer(Ce.content))Ce.content.copy(de,de.l,0,Ce.size),de.l+=Ce.size+511&-512;else{for(Te=0;Te<Ce.size;++Te)de.write_shift(1,Ce.content[Te]);for(;Te&511;++Te)de.write_shift(1,0)}for(le=1;le<V.FileIndex.length;++le)if(Ce=V.FileIndex[le],Ce.size>0&&Ce.size<4096)if(As&&Buffer.isBuffer(Ce.content))Ce.content.copy(de,de.l,0,Ce.size),de.l+=Ce.size+63&-64;else{for(Te=0;Te<Ce.size;++Te)de.write_shift(1,Ce.content[Te]);for(;Te&63;++Te)de.write_shift(1,0)}if(As)de.l=de.length;else for(;de.l<de.length;)de.write_shift(1,0);return de}function he(V,ie){var K=V.FullPaths.map(function(Te){return Te.toUpperCase()}),ee=K.map(function(Te){var je=Te.split("/");return je[je.length-(Te.slice(-1)=="/"?2:1)]}),de=!1;ie.charCodeAt(0)===47?(de=!0,ie=K[0].slice(0,-1)+ie):de=ie.indexOf("/")!==-1;var le=ie.toUpperCase(),Pe=de===!0?K.indexOf(le):ee.indexOf(le);if(Pe!==-1)return V.FileIndex[Pe];var Be=!le.match(uu);for(le=le.replace(lc,""),Be&&(le=le.replace(uu,"!")),Pe=0;Pe<K.length;++Pe)if((Be?K[Pe].replace(uu,"!"):K[Pe]).replace(lc,"")==le||(Be?ee[Pe].replace(uu,"!"):ee[Pe]).replace(lc,"")==le)return V.FileIndex[Pe];return null}var ue=64,_e=-2,ke="d0cf11e0a1b11ae1",Re=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",ve={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:_e,FREESECT:-1,HEADER_SIGNATURE:ke,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(V,ie,K){h();var ee=X(V,K);f.writeFileSync(ie,ee)}function be(V){for(var ie=new Array(V.length),K=0;K<V.length;++K)ie[K]=String.fromCharCode(V[K]);return ie.join("")}function pe(V,ie){var K=X(V,ie);switch(ie&&ie.type||"buffer"){case"file":return h(),f.writeFileSync(ie.filename,K),K;case"binary":return typeof K=="string"?K:be(K);case"base64":return yc(typeof K=="string"?K:be(K));case"buffer":if(As)return Buffer.isBuffer(K)?K:Ha(K);case"array":return typeof K=="string"?Yn(K):K}return K}var ne;function U(V){try{var ie=V.InflateRaw,K=new ie;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)ne=V;else throw new Error("zlib does not expose bytesRead")}catch(ee){console.error("cannot use native zlib: "+(ee.message||ee))}}function ce(V,ie){if(!ne)return $t(V,ie);var K=ne.InflateRaw,ee=new K,de=ee._processChunk(V.slice(V.l),ee._finishFlushFlag);return V.l+=ee.bytesRead,de}function z(V){return ne?ne.deflateRawSync(V):ct(V)}var ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ye=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(V){var ie=(V<<1|V<<11)&139536|(V<<5|V<<15)&558144;return(ie>>16|ie>>8|ie)&255}for(var Le=typeof Uint8Array<"u",De=Le?new Uint8Array(256):[],Ve=0;Ve<256;++Ve)De[Ve]=Ee(Ve);function et(V,ie){var K=De[V&255];return ie<=8?K>>>8-ie:(K=K<<8|De[V>>8&255],ie<=16?K>>>16-ie:(K=K<<8|De[V>>16&255],K>>>24-ie))}function Nt(V,ie){var K=ie&7,ee=ie>>>3;return(V[ee]|(K<=6?0:V[ee+1]<<8))>>>K&3}function ot(V,ie){var K=ie&7,ee=ie>>>3;return(V[ee]|(K<=5?0:V[ee+1]<<8))>>>K&7}function Qt(V,ie){var K=ie&7,ee=ie>>>3;return(V[ee]|(K<=4?0:V[ee+1]<<8))>>>K&15}function qe(V,ie){var K=ie&7,ee=ie>>>3;return(V[ee]|(K<=3?0:V[ee+1]<<8))>>>K&31}function Me(V,ie){var K=ie&7,ee=ie>>>3;return(V[ee]|(K<=1?0:V[ee+1]<<8))>>>K&127}function mt(V,ie,K){var ee=ie&7,de=ie>>>3,le=(1<<K)-1,Pe=V[de]>>>ee;return K<8-ee||(Pe|=V[de+1]<<8-ee,K<16-ee)||(Pe|=V[de+2]<<16-ee,K<24-ee)||(Pe|=V[de+3]<<24-ee),Pe&le}function it(V,ie,K){var ee=ie&7,de=ie>>>3;return ee<=5?V[de]|=(K&7)<<ee:(V[de]|=K<<ee&255,V[de+1]=(K&7)>>8-ee),ie+3}function Et(V,ie,K){var ee=ie&7,de=ie>>>3;return K=(K&1)<<ee,V[de]|=K,ie+1}function pt(V,ie,K){var ee=ie&7,de=ie>>>3;return K<<=ee,V[de]|=K&255,K>>>=8,V[de+1]=K,ie+8}function xe(V,ie,K){var ee=ie&7,de=ie>>>3;return K<<=ee,V[de]|=K&255,K>>>=8,V[de+1]=K&255,V[de+2]=K>>>8,ie+16}function tt(V,ie){var K=V.length,ee=2*K>ie?2*K:ie+5,de=0;if(K>=ie)return V;if(As){var le=ub(ee);if(V.copy)V.copy(le);else for(;de<V.length;++de)le[de]=V[de];return le}else if(Le){var Pe=new Uint8Array(ee);if(Pe.set)Pe.set(V);else for(;de<K;++de)Pe[de]=V[de];return Pe}return V.length=ee,V}function lt(V){for(var ie=new Array(V),K=0;K<V;++K)ie[K]=0;return ie}function Ue(V,ie,K){var ee=1,de=0,le=0,Pe=0,Be=0,Te=V.length,je=Le?new Uint16Array(32):lt(32);for(le=0;le<32;++le)je[le]=0;for(le=Te;le<K;++le)V[le]=0;Te=V.length;var Ce=Le?new Uint16Array(Te):lt(Te);for(le=0;le<Te;++le)je[de=V[le]]++,ee<de&&(ee=de),Ce[le]=0;for(je[0]=0,le=1;le<=ee;++le)je[le+16]=Be=Be+je[le-1]<<1;for(le=0;le<Te;++le)Be=V[le],Be!=0&&(Ce[le]=je[Be+16]++);var Fe=0;for(le=0;le<Te;++le)if(Fe=V[le],Fe!=0)for(Be=et(Ce[le],ee)>>ee-Fe,Pe=(1<<ee+4-Fe)-1;Pe>=0;--Pe)ie[Be|Pe<<Fe]=Fe&15|le<<4;return ee}var He=Le?new Uint16Array(512):lt(512),zt=Le?new Uint16Array(32):lt(32);if(!Le){for(var gt=0;gt<512;++gt)He[gt]=0;for(gt=0;gt<32;++gt)zt[gt]=0}(function(){for(var V=[],ie=0;ie<32;ie++)V.push(5);Ue(V,zt,32);var K=[];for(ie=0;ie<=143;ie++)K.push(8);for(;ie<=255;ie++)K.push(9);for(;ie<=279;ie++)K.push(7);for(;ie<=287;ie++)K.push(8);Ue(K,He,288)})();var jt=(function(){for(var ie=Le?new Uint8Array(32768):[],K=0,ee=0;K<fe.length-1;++K)for(;ee<fe[K+1];++ee)ie[ee]=K;for(;ee<32768;++ee)ie[ee]=29;var de=Le?new Uint8Array(259):[];for(K=0,ee=0;K<ye.length-1;++K)for(;ee<ye[K+1];++ee)de[ee]=K;function le(Be,Te){for(var je=0;je<Be.length;){var Ce=Math.min(65535,Be.length-je),Fe=je+Ce==Be.length;for(Te.write_shift(1,+Fe),Te.write_shift(2,Ce),Te.write_shift(2,~Ce&65535);Ce-- >0;)Te[Te.l++]=Be[je++]}return Te.l}function Pe(Be,Te){for(var je=0,Ce=0,Fe=Le?new Uint16Array(32768):[];Ce<Be.length;){var We=Math.min(65535,Be.length-Ce);if(We<10){for(je=it(Te,je,+(Ce+We==Be.length)),je&7&&(je+=8-(je&7)),Te.l=je/8|0,Te.write_shift(2,We),Te.write_shift(2,~We&65535);We-- >0;)Te[Te.l++]=Be[Ce++];je=Te.l*8;continue}je=it(Te,je,+(Ce+We==Be.length)+2);for(var ge=0;We-- >0;){var G=Be[Ce];ge=(ge<<5^G)&32767;var T=-1,x=0;if((T=Fe[ge])&&(T|=Ce&-32768,T>Ce&&(T-=32768),T<Ce))for(;Be[T+x]==Be[Ce+x]&&x<250;)++x;if(x>2){G=de[x],G<=22?je=pt(Te,je,De[G+1]>>1)-1:(pt(Te,je,3),je+=5,pt(Te,je,De[G-23]>>5),je+=3);var A=G<8?0:G-4>>2;A>0&&(xe(Te,je,x-ye[G]),je+=A),G=ie[Ce-T],je=pt(Te,je,De[G]>>3),je-=3;var g=G<4?0:G-2>>1;g>0&&(xe(Te,je,Ce-T-fe[G]),je+=g);for(var p=0;p<x;++p)Fe[ge]=Ce&32767,ge=(ge<<5^Be[Ce])&32767,++Ce;We-=x-1}else G<=143?G=G+48:je=Et(Te,je,1),je=pt(Te,je,De[G]),Fe[ge]=Ce&32767,++Ce}je=pt(Te,je,0)-1}return Te.l=(je+7)/8|0,Te.l}return function(Te,je){return Te.length<8?le(Te,je):Pe(Te,je)}})();function ct(V){var ie=st(50+Math.floor(V.length*1.1)),K=jt(V,ie);return ie.slice(0,K)}var Yt=Le?new Uint16Array(32768):lt(32768),Z=Le?new Uint16Array(32768):lt(32768),Ze=Le?new Uint16Array(128):lt(128),nt=1,Ke=1;function kt(V,ie){var K=qe(V,ie)+257;ie+=5;var ee=qe(V,ie)+1;ie+=5;var de=Qt(V,ie)+4;ie+=4;for(var le=0,Pe=Le?new Uint8Array(19):lt(19),Be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Te=1,je=Le?new Uint8Array(8):lt(8),Ce=Le?new Uint8Array(8):lt(8),Fe=Pe.length,We=0;We<de;++We)Pe[ae[We]]=le=ot(V,ie),Te<le&&(Te=le),je[le]++,ie+=3;var ge=0;for(je[0]=0,We=1;We<=Te;++We)Ce[We]=ge=ge+je[We-1]<<1;for(We=0;We<Fe;++We)(ge=Pe[We])!=0&&(Be[We]=Ce[ge]++);var G=0;for(We=0;We<Fe;++We)if(G=Pe[We],G!=0){ge=De[Be[We]]>>8-G;for(var T=(1<<7-G)-1;T>=0;--T)Ze[ge|T<<G]=G&7|We<<3}var x=[];for(Te=1;x.length<K+ee;)switch(ge=Ze[Me(V,ie)],ie+=ge&7,ge>>>=3){case 16:for(le=3+Nt(V,ie),ie+=2,ge=x[x.length-1];le-- >0;)x.push(ge);break;case 17:for(le=3+ot(V,ie),ie+=3;le-- >0;)x.push(0);break;case 18:for(le=11+Me(V,ie),ie+=7;le-- >0;)x.push(0);break;default:x.push(ge),Te<ge&&(Te=ge);break}var A=x.slice(0,K),g=x.slice(K);for(We=K;We<286;++We)A[We]=0;for(We=ee;We<30;++We)g[We]=0;return nt=Ue(A,Yt,286),Ke=Ue(g,Z,30),ie}function wt(V,ie){if(V[0]==3&&!(V[1]&3))return[rl(ie),2];for(var K=0,ee=0,de=ub(ie||1<<18),le=0,Pe=de.length>>>0,Be=0,Te=0;(ee&1)==0;){if(ee=ot(V,K),K+=3,ee>>>1)ee>>1==1?(Be=9,Te=5):(K=kt(V,K),Be=nt,Te=Ke);else{K&7&&(K+=8-(K&7));var je=V[K>>>3]|V[(K>>>3)+1]<<8;if(K+=32,je>0)for(!ie&&Pe<le+je&&(de=tt(de,le+je),Pe=de.length);je-- >0;)de[le++]=V[K>>>3],K+=8;continue}for(;;){!ie&&Pe<le+32767&&(de=tt(de,le+32767),Pe=de.length);var Ce=mt(V,K,Be),Fe=ee>>>1==1?He[Ce]:Yt[Ce];if(K+=Fe&15,Fe>>>=4,(Fe>>>8&255)===0)de[le++]=Fe;else{if(Fe==256)break;Fe-=257;var We=Fe<8?0:Fe-4>>2;We>5&&(We=0);var ge=le+ye[Fe];We>0&&(ge+=mt(V,K,We),K+=We),Ce=mt(V,K,Te),Fe=ee>>>1==1?zt[Ce]:Z[Ce],K+=Fe&15,Fe>>>=4;var G=Fe<4?0:Fe-2>>1,T=fe[Fe];for(G>0&&(T+=mt(V,K,G),K+=G),!ie&&Pe<ge&&(de=tt(de,ge+100),Pe=de.length);le<ge;)de[le]=de[le-T],++le}}}return ie?[de,K+7>>>3]:[de.slice(0,le),K+7>>>3]}function $t(V,ie){var K=V.slice(V.l||0),ee=wt(K,ie);return V.l+=ee[1],ee[0]}function At(V,ie){if(V)typeof console<"u"&&console.error(ie);else throw new Error(ie)}function Vt(V,ie){var K=V;Nn(K,0);var ee=[],de=[],le={FileIndex:ee,FullPaths:de};M(le,{root:ie.root});for(var Pe=K.length-4;(K[Pe]!=80||K[Pe+1]!=75||K[Pe+2]!=5||K[Pe+3]!=6)&&Pe>=0;)--Pe;K.l=Pe+4,K.l+=4;var Be=K.read_shift(2);K.l+=6;var Te=K.read_shift(4);for(K.l=Te,Pe=0;Pe<Be;++Pe){K.l+=20;var je=K.read_shift(4),Ce=K.read_shift(4),Fe=K.read_shift(2),We=K.read_shift(2),ge=K.read_shift(2);K.l+=8;var G=K.read_shift(4),T=u(K.slice(K.l+Fe,K.l+Fe+We));K.l+=Fe+We+ge;var x=K.l;K.l=G+4,Ot(K,je,Ce,le,T),K.l=x}return le}function Ot(V,ie,K,ee,de){V.l+=2;var le=V.read_shift(2),Pe=V.read_shift(2),Be=c(V);if(le&8257)throw new Error("Unsupported ZIP encryption");for(var Te=V.read_shift(4),je=V.read_shift(4),Ce=V.read_shift(4),Fe=V.read_shift(2),We=V.read_shift(2),ge="",G=0;G<Fe;++G)ge+=String.fromCharCode(V[V.l++]);if(We){var T=u(V.slice(V.l,V.l+We));(T[21589]||{}).mt&&(Be=T[21589].mt),((de||{})[21589]||{}).mt&&(Be=de[21589].mt)}V.l+=We;var x=V.slice(V.l,V.l+je);switch(Pe){case 8:x=ce(V,Ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Pe)}var A=!1;le&8&&(Te=V.read_shift(4),Te==134695760&&(Te=V.read_shift(4),A=!0),je=V.read_shift(4),Ce=V.read_shift(4)),je!=ie&&At(A,"Bad compressed size: "+ie+" != "+je),Ce!=K&&At(A,"Bad uncompressed size: "+K+" != "+Ce),as(ee,ge,x,{unsafe:!0,mt:Be})}function yt(V,ie){var K=ie||{},ee=[],de=[],le=st(1),Pe=K.compression?8:0,Be=0,Te=0,je=0,Ce=0,Fe=0,We=V.FullPaths[0],ge=We,G=V.FileIndex[0],T=[],x=0;for(Te=1;Te<V.FullPaths.length;++Te)if(ge=V.FullPaths[Te].slice(We.length),G=V.FileIndex[Te],!(!G.size||!G.content||ge=="Sh33tJ5")){var A=Ce,g=st(ge.length);for(je=0;je<ge.length;++je)g.write_shift(1,ge.charCodeAt(je)&127);g=g.slice(0,g.l),T[Fe]=_9.buf(G.content,0);var p=G.content;Pe==8&&(p=z(p)),le=st(30),le.write_shift(4,67324752),le.write_shift(2,20),le.write_shift(2,Be),le.write_shift(2,Pe),G.mt?l(le,G.mt):le.write_shift(4,0),le.write_shift(-4,T[Fe]),le.write_shift(4,p.length),le.write_shift(4,G.content.length),le.write_shift(2,g.length),le.write_shift(2,0),Ce+=le.length,ee.push(le),Ce+=g.length,ee.push(g),Ce+=p.length,ee.push(p),le=st(46),le.write_shift(4,33639248),le.write_shift(2,0),le.write_shift(2,20),le.write_shift(2,Be),le.write_shift(2,Pe),le.write_shift(4,0),le.write_shift(-4,T[Fe]),le.write_shift(4,p.length),le.write_shift(4,G.content.length),le.write_shift(2,g.length),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(4,0),le.write_shift(4,A),x+=le.l,de.push(le),x+=g.length,de.push(g),++Fe}return le=st(22),le.write_shift(4,101010256),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,Fe),le.write_shift(2,Fe),le.write_shift(4,x),le.write_shift(4,Ce),le.write_shift(2,0),Lr([Lr(ee),Lr(de),le])}var Ge={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function St(V,ie){if(V.ctype)return V.ctype;var K=V.name||"",ee=K.match(/\.([^\.]+)$/);return ee&&Ge[ee[1]]||ie&&(ee=(K=ie).match(/[\.\\]([^\.\\])+$/),ee&&Ge[ee[1]])?Ge[ee[1]]:"application/octet-stream"}function Ct(V){for(var ie=yc(V),K=[],ee=0;ee<ie.length;ee+=76)K.push(ie.slice(ee,ee+76));return K.join(`\r
`)+`\r
`}function Zt(V){var ie=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(je){var Ce=je.charCodeAt(0).toString(16).toUpperCase();return"="+(Ce.length==1?"0"+Ce:Ce)});ie=ie.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ie.charAt(0)==`
`&&(ie="=0D"+ie.slice(1)),ie=ie.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],ee=ie.split(`\r
`),de=0;de<ee.length;++de){var le=ee[de];if(le.length==0){K.push("");continue}for(var Pe=0;Pe<le.length;){var Be=76,Te=le.slice(Pe,Pe+Be);Te.charAt(Be-1)=="="?Be--:Te.charAt(Be-2)=="="?Be-=2:Te.charAt(Be-3)=="="&&(Be-=3),Te=le.slice(Pe,Pe+Be),Pe+=Be,Pe<le.length&&(Te+="="),K.push(Te)}}return K.join(`\r
`)}function _t(V){for(var ie=[],K=0;K<V.length;++K){for(var ee=V[K];K<=V.length&&ee.charAt(ee.length-1)=="=";)ee=ee.slice(0,ee.length-1)+V[++K];ie.push(ee)}for(var de=0;de<ie.length;++de)ie[de]=ie[de].replace(/[=][0-9A-Fa-f]{2}/g,function(le){return String.fromCharCode(parseInt(le.slice(1),16))});return Yn(ie.join(`\r
`))}function Ut(V,ie,K){for(var ee="",de="",le="",Pe,Be=0;Be<10;++Be){var Te=ie[Be];if(!Te||Te.match(/^\s*$/))break;var je=Te.match(/^(.*?):\s*([^\s].*)$/);if(je)switch(je[1].toLowerCase()){case"content-location":ee=je[2].trim();break;case"content-type":le=je[2].trim();break;case"content-transfer-encoding":de=je[2].trim();break}}switch(++Be,de.toLowerCase()){case"base64":Pe=Yn(Va(ie.slice(Be).join("")));break;case"quoted-printable":Pe=_t(ie.slice(Be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+de)}var Ce=as(V,ee.slice(K.length),Pe,{unsafe:!0});le&&(Ce.ctype=le)}function Kt(V,ie){if(be(V.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=ie&&ie.root||"",ee=(As&&Buffer.isBuffer(V)?V.toString("binary"):be(V)).split(`\r
`),de=0,le="";for(de=0;de<ee.length;++de)if(le=ee[de],!!/^Content-Location:/i.test(le)&&(le=le.slice(le.indexOf("file")),K||(K=le.slice(0,le.lastIndexOf("/")+1)),le.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),le.slice(0,K.length)!=K););var Pe=(ee[1]||"").match(/boundary="(.*?)"/);if(!Pe)throw new Error("MAD cannot find boundary");var Be="--"+(Pe[1]||""),Te=[],je=[],Ce={FileIndex:Te,FullPaths:je};M(Ce);var Fe,We=0;for(de=0;de<ee.length;++de){var ge=ee[de];ge!==Be&&ge!==Be+"--"||(We++&&Ut(Ce,ee.slice(Fe,de),K),Fe=de)}return Ce}function Bt(V,ie){var K=ie||{},ee=K.boundary||"SheetJS";ee="------="+ee;for(var de=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ee.slice(2)+'"',"","",""],le=V.FullPaths[0],Pe=le,Be=V.FileIndex[0],Te=1;Te<V.FullPaths.length;++Te)if(Pe=V.FullPaths[Te].slice(le.length),Be=V.FileIndex[Te],!(!Be.size||!Be.content||Pe=="Sh33tJ5")){Pe=Pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(x){return"_x"+x.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(x){return"_u"+x.charCodeAt(0).toString(16)+"_"});for(var je=Be.content,Ce=As&&Buffer.isBuffer(je)?je.toString("binary"):be(je),Fe=0,We=Math.min(1024,Ce.length),ge=0,G=0;G<=We;++G)(ge=Ce.charCodeAt(G))>=32&&ge<128&&++Fe;var T=Fe>=We*4/5;de.push(ee),de.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+Pe),de.push("Content-Transfer-Encoding: "+(T?"quoted-printable":"base64")),de.push("Content-Type: "+St(Be,Pe)),de.push(""),de.push(T?Zt(Ce):Ct(Ce))}return de.push(ee+`--\r
`),de.join(`\r
`)}function Xt(V){var ie={};return M(ie,V),ie}function as(V,ie,K,ee){var de=ee&&ee.unsafe;de||M(V);var le=!de&&Is.find(V,ie);if(!le){var Pe=V.FullPaths[0];ie.slice(0,Pe.length)==Pe?Pe=ie:(Pe.slice(-1)!="/"&&(Pe+="/"),Pe=(Pe+ie).replace("//","/")),le={name:a(ie),type:2},V.FileIndex.push(le),V.FullPaths.push(Pe),de||Is.utils.cfb_gc(V)}return le.content=K,le.size=K?K.length:0,ee&&(ee.CLSID&&(le.clsid=ee.CLSID),ee.mt&&(le.mt=ee.mt),ee.ct&&(le.ct=ee.ct)),le}function ds(V,ie){M(V);var K=Is.find(V,ie);if(K){for(var ee=0;ee<V.FileIndex.length;++ee)if(V.FileIndex[ee]==K)return V.FileIndex.splice(ee,1),V.FullPaths.splice(ee,1),!0}return!1}function ls(V,ie,K){M(V);var ee=Is.find(V,ie);if(ee){for(var de=0;de<V.FileIndex.length;++de)if(V.FileIndex[de]==ee)return V.FileIndex[de].name=a(K),V.FullPaths[de]=K,!0}return!1}function us(V){oe(V,!0)}return s.find=he,s.read=re,s.parse=v,s.write=pe,s.writeFile=Q,s.utils={cfb_new:Xt,cfb_add:as,cfb_del:ds,cfb_mov:ls,cfb_gc:us,ReadShift:cc,CheckField:dS,prep_blob:Nn,bconcat:Lr,use_zlib:U,_deflateRaw:ct,_inflateRaw:$t,consts:ve},s})();function E9(t){return typeof t=="string"?Pm(t):Array.isArray(t)?e9(t):t}function Uc(t,s,r){if(typeof Deno<"u"){if(r&&typeof s=="string")switch(r){case"utf8":s=new TextEncoder(r).encode(s);break;case"binary":s=Pm(s);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,s)}var n=r=="utf8"?bc(s):s;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([E9(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:t,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=t,c.href=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(s)&&(s=Qc(s)),u.write(s),u.close(),s}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function Ir(t){for(var s=Object.keys(t),r=[],n=0;n<s.length;++n)Object.prototype.hasOwnProperty.call(t,s[n])&&r.push(s[n]);return r}function vb(t,s){for(var r=[],n=Ir(t),a=0;a!==n.length;++a)r[t[n[a]][s]]==null&&(r[t[n[a]][s]]=n[a]);return r}function _h(t){for(var s=[],r=Ir(t),n=0;n!==r.length;++n)s[t[r[n]]]=r[n];return s}function Om(t){for(var s=[],r=Ir(t),n=0;n!==r.length;++n)s[t[r[n]]]=parseInt(r[n],10);return s}function P9(t){for(var s=[],r=Ir(t),n=0;n!==r.length;++n)s[t[r[n]]]==null&&(s[t[r[n]]]=[]),s[t[r[n]]].push(r[n]);return s}var Gu=new Date(1899,11,30,0,0,0);function xn(t,s){var r=t.getTime(),n=Gu.getTime()+(t.getTimezoneOffset()-Gu.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var Gj=new Date,A9=Gu.getTime()+(Gj.getTimezoneOffset()-Gu.getTimezoneOffset())*6e4,bb=Gj.getTimezoneOffset();function Hj(t){var s=new Date;return s.setTime(t*24*60*60*1e3+A9),s.getTimezoneOffset()!==bb&&s.setTime(s.getTime()+(s.getTimezoneOffset()-bb)*6e4),s}var wb=new Date("2017-02-19T19:06:09.000Z"),Yj=isNaN(wb.getFullYear())?new Date("2/19/17"):wb,T9=Yj.getFullYear()==2017;function en(t,s){var r=new Date(t);if(T9)return s>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):s<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Yj.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function Rm(t,s){if(As&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function hn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=hn(t[r]));return s}function tr(t,s){for(var r="";r.length<s;)r+=t;return r}function Ba(t){var s=Number(t);if(!isNaN(s))return isFinite(s)?s:NaN;if(!/\d/.test(t))return s;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(s=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,l){return r=-r,l}),!isNaN(s=Number(n)))?s/r:s}var O9=["january","february","march","april","may","june","july","august","september","october","november","december"];function vc(t){var s=new Date(t),r=new Date(NaN),n=s.getYear(),a=s.getMonth(),l=s.getDate();if(isNaN(l))return r;var c=t.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&O9.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||l>1)&&n!=101?s:t.match(/[^-0-9:,\/\\]/)?r:s}function gs(t,s,r){if(t.FullPaths){if(typeof r=="string"){var n;return As?n=Ha(r):n=t9(r),Is.utils.cfb_add(t,s,n)}Is.utils.cfb_add(t,s,r)}else t.file(s,r)}function Eh(){return Is.utils.cfb_new()}var vr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,R9={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ph=_h(R9),Ah=/[&<>'"]/g,D9=/[\u0000-\u0008\u000b-\u001f]/g;function Fs(t){var s=t+"";return s.replace(Ah,function(r){return Ph[r]}).replace(D9,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Nb(t){return Fs(t).replace(/ /g,"_x0020_")}var Kj=/[\u0000-\u001f]/g;function L9(t){var s=t+"";return s.replace(Ah,function(r){return Ph[r]}).replace(/\n/g,"<br/>").replace(Kj,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function F9(t){var s=t+"";return s.replace(Ah,function(r){return Ph[r]}).replace(Kj,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function M9(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function I9(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function G0(t){for(var s="",r=0,n=0,a=0,l=0,c=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){s+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){c=(n&31)<<6,c|=a&63,s+=String.fromCharCode(c);continue}if(l=t.charCodeAt(r++),n<240){s+=String.fromCharCode((n&15)<<12|(a&63)<<6|l&63);continue}c=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536,s+=String.fromCharCode(55296+(u>>>10&1023)),s+=String.fromCharCode(56320+(u&1023))}return s}function jb(t){var s=rl(2*t.length),r,n,a=1,l=0,c=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(s[l++]=c&255,s[l++]=c>>>8,c=0),s[l++]=r%256,s[l++]=r>>>8;return s.slice(0,l).toString("ucs2")}function Sb(t){return Ha(t,"binary").toString("utf8")}var pu="foo bar baz",oc=As&&(Sb(pu)==G0(pu)&&Sb||jb(pu)==G0(pu)&&jb)||G0,bc=As?function(t){return Ha(t,"utf8").toString("binary")}:function(t){for(var s=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:s.push(String.fromCharCode(n));break;case n<2048:s.push(String.fromCharCode(192+(n>>6))),s.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),s.push(String.fromCharCode(240+(a>>18&7))),s.push(String.fromCharCode(144+(a>>12&63))),s.push(String.fromCharCode(128+(a>>6&63))),s.push(String.fromCharCode(128+(a&63)));break;default:s.push(String.fromCharCode(224+(n>>12))),s.push(String.fromCharCode(128+(n>>6&63))),s.push(String.fromCharCode(128+(n&63)))}return s.join("")},q9=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(s){return[new RegExp("&"+s[0]+";","ig"),s[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}})(),Xj=/(^\s|\s$|\n)/;function Fr(t,s){return"<"+t+(s.match(Xj)?' xml:space="preserve"':"")+">"+s+"</"+t+">"}function wc(t){return Ir(t).map(function(s){return" "+s+'="'+t[s]+'"'}).join("")}function Ft(t,s,r){return"<"+t+(r!=null?wc(r):"")+(s!=null?(s.match(Xj)?' xml:space="preserve"':"")+">"+s+"</"+t:"/")+">"}function _x(t,s){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(s)throw r}return""}function B9(t,s){switch(typeof t){case"string":var r=Ft("vt:lpwstr",Fs(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ft((t|0)==t?"vt:i4":"vt:r8",Fs(String(t)));case"boolean":return Ft("vt:bool",t?"true":"false")}if(t instanceof Date)return Ft("vt:filetime",_x(t));throw new Error("Unable to serialize "+t)}var Er={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},xo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Sn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function z9(t,s){for(var r=1-2*(t[s+7]>>>7),n=((t[s+7]&127)<<4)+(t[s+6]>>>4&15),a=t[s+6]&15,l=5;l>=0;--l)a=a*256+t[s+l];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function $9(t,s,r){var n=(s<0||1/s==-1/0?1:0)<<7,a=0,l=0,c=n?-s:s;isFinite(c)?c==0?a=l=0:(a=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-a),a<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?a=-1022:(l-=Math.pow(2,52),a+=1023)):(a=2047,l=isNaN(s)?26985:0);for(var u=0;u<=5;++u,l/=256)t[r+u]=l&255;t[r+6]=(a&15)<<4|l&15,t[r+7]=a>>4|n}var kb=function(t){for(var s=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,l=t[0][n].length;a<l;a+=r)s.push.apply(s,t[0][n].slice(a,a+r));return s},Cb=As?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(s){return Buffer.isBuffer(s)?s:Ha(s)})):kb(t)}:kb,_b=function(t,s,r){for(var n=[],a=s;a<r;a+=2)n.push(String.fromCharCode(ac(t,a)));return n.join("").replace(lc,"")},Th=As?function(t,s,r){return Buffer.isBuffer(t)?t.toString("utf16le",s,r).replace(lc,""):_b(t,s,r)}:_b,Eb=function(t,s,r){for(var n=[],a=s;a<s+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},Jj=As?function(t,s,r){return Buffer.isBuffer(t)?t.toString("hex",s,s+r):Eb(t,s,r)}:Eb,Pb=function(t,s,r){for(var n=[],a=s;a<r;a++)n.push(String.fromCharCode(Ql(t,a)));return n.join("")},Vc=As?function(s,r,n){return Buffer.isBuffer(s)?s.toString("utf8",r,n):Pb(s,r,n)}:Pb,Zj=function(t,s){var r=kn(t,s);return r>0?Vc(t,s+4,s+4+r-1):""},eS=Zj,tS=function(t,s){var r=kn(t,s);return r>0?Vc(t,s+4,s+4+r-1):""},sS=tS,rS=function(t,s){var r=2*kn(t,s);return r>0?Vc(t,s+4,s+4+r-1):""},nS=rS,aS=function(s,r){var n=kn(s,r);return n>0?Th(s,r+4,r+4+n):""},iS=aS,lS=function(t,s){var r=kn(t,s);return r>0?Vc(t,s+4,s+4+r):""},oS=lS,cS=function(t,s){return z9(t,s)},Hu=cS,Oh=function(s){return Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array};As&&(eS=function(s,r){if(!Buffer.isBuffer(s))return Zj(s,r);var n=s.readUInt32LE(r);return n>0?s.toString("utf8",r+4,r+4+n-1):""},sS=function(s,r){if(!Buffer.isBuffer(s))return tS(s,r);var n=s.readUInt32LE(r);return n>0?s.toString("utf8",r+4,r+4+n-1):""},nS=function(s,r){if(!Buffer.isBuffer(s))return rS(s,r);var n=2*s.readUInt32LE(r);return s.toString("utf16le",r+4,r+4+n-1)},iS=function(s,r){if(!Buffer.isBuffer(s))return aS(s,r);var n=s.readUInt32LE(r);return s.toString("utf16le",r+4,r+4+n)},oS=function(s,r){if(!Buffer.isBuffer(s))return lS(s,r);var n=s.readUInt32LE(r);return s.toString("utf8",r+4,r+4+n)},Hu=function(s,r){return Buffer.isBuffer(s)?s.readDoubleLE(r):cS(s,r)},Oh=function(s){return Buffer.isBuffer(s)||Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array});var Ql=function(t,s){return t[s]},ac=function(t,s){return t[s+1]*256+t[s]},Q9=function(t,s){var r=t[s+1]*256+t[s];return r<32768?r:(65535-r+1)*-1},kn=function(t,s){return t[s+3]*(1<<24)+(t[s+2]<<16)+(t[s+1]<<8)+t[s]},Vi=function(t,s){return t[s+3]<<24|t[s+2]<<16|t[s+1]<<8|t[s]},U9=function(t,s){return t[s]<<24|t[s+1]<<16|t[s+2]<<8|t[s+3]};function cc(t,s){var r="",n,a,l=[],c,u,f,h;switch(s){case"dbcs":if(h=this.l,As&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)r+=String.fromCharCode(ac(this,h)),h+=2;t*=2;break;case"utf8":r=Vc(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Th(this,this.l,this.l+t);break;case"wstr":return cc.call(this,t,"dbcs");case"lpstr-ansi":r=eS(this,this.l),t=4+kn(this,this.l);break;case"lpstr-cp":r=sS(this,this.l),t=4+kn(this,this.l);break;case"lpwstr":r=nS(this,this.l),t=4+2*kn(this,this.l);break;case"lpp4":t=4+kn(this,this.l),r=iS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+kn(this,this.l),r=oS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(c=Ql(this,this.l+t++))!==0;)l.push(du(c));r=l.join("");break;case"_wstr":for(t=0,r="";(c=ac(this,this.l+t))!==0;)l.push(du(c)),t+=2;t+=2,r=l.join("");break;case"dbcs-cont":for(r="",h=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return c=Ql(this,h),this.l=h+1,u=cc.call(this,t-f,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(du(ac(this,h))),h+=2}r=l.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return c=Ql(this,h),this.l=h+1,u=cc.call(this,t-f,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(du(Ql(this,h))),h+=1}r=l.join("");break;default:switch(t){case 1:return n=Ql(this,this.l),this.l++,n;case 2:return n=(s==="i"?Q9:ac)(this,this.l),this.l+=2,n;case 4:case-4:return s==="i"||(this[this.l+3]&128)===0?(n=(t>0?Vi:U9)(this,this.l),this.l+=4,n):(a=kn(this,this.l),this.l+=4,a);case 8:case-8:if(s==="f")return t==8?a=Hu(this,this.l):a=Hu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=Jj(this,this.l,t);break}}return this.l+=t,r}var V9=function(t,s,r){t[r]=s&255,t[r+1]=s>>>8&255,t[r+2]=s>>>16&255,t[r+3]=s>>>24&255},W9=function(t,s,r){t[r]=s&255,t[r+1]=s>>8&255,t[r+2]=s>>16&255,t[r+3]=s>>24&255},G9=function(t,s,r){t[r]=s&255,t[r+1]=s>>>8&255};function H9(t,s,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=s.length;++a)G9(this,s.charCodeAt(a),this.l+2*a);n=2*s.length}else if(r==="sbcs"){for(s=s.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=s.length;++a)this[this.l+a]=s.charCodeAt(a)&255;n=s.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(s.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+t,this.length);for(a=0;a<Math.min(s.length,t);++a){var c=s.charCodeAt(a);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=s&255;break;case 2:n=2,this[this.l]=s&255,s>>>=8,this[this.l+1]=s&255;break;case 3:n=3,this[this.l]=s&255,s>>>=8,this[this.l+1]=s&255,s>>>=8,this[this.l+2]=s&255;break;case 4:n=4,V9(this,s,this.l);break;case 8:if(n=8,r==="f"){$9(this,s,this.l);break}case 16:break;case-4:n=4,W9(this,s,this.l);break}return this.l+=n,this}function dS(t,s){var r=Jj(this,this.l,t.length>>1);if(r!==t)throw new Error(s+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Nn(t,s){t.l=s,t.read_shift=cc,t.chk=dS,t.write_shift=H9}function Na(t,s){t.l+=s}function st(t){var s=rl(t);return Nn(s,0),s}function pn(){var t=[],s=As?256:2048,r=function(h){var v=st(h);return Nn(v,0),v},n=r(s),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},l=function(h){return n&&h<n.length-n.l?n:(a(),n=r(Math.max(h+1,s)))},c=function(){return a(),Lr(t)},u=function(h){a(),n=h,n.l==null&&(n.l=n.length),l(s)};return{next:l,push:u,end:c,_bufs:t}}function dt(t,s,r,n){var a=+s,l;if(!isNaN(a)){n||(n=z7[a].p||(r||[]).length||0),l=1+(a>=128?1:0)+1,n>=128&&++l,n>=16384&&++l,n>=2097152&&++l;var c=t.next(l);a<=127?c.write_shift(1,a):(c.write_shift(1,(a&127)+128),c.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)c.write_shift(1,(n&127)+128),n>>=7;else{c.write_shift(1,n);break}n>0&&Oh(r)&&t.push(r)}}function dc(t,s,r){var n=hn(t);if(s.s?(n.cRel&&(n.c+=s.s.c),n.rRel&&(n.r+=s.s.r)):(n.cRel&&(n.c+=s.c),n.rRel&&(n.r+=s.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ab(t,s,r){var n=hn(t);return n.s=dc(n.s,s.s,r),n.e=dc(n.e,s.s,r),n}function uc(t,s){if(t.cRel&&t.c<0)for(t=hn(t);t.c<0;)t.c+=s>8?16384:256;if(t.rRel&&t.r<0)for(t=hn(t);t.r<0;)t.r+=s>8?1048576:s>5?65536:16384;var r=Ms(t);return!t.cRel&&t.cRel!=null&&(r=X9(r)),!t.rRel&&t.rRel!=null&&(r=Y9(r)),r}function H0(t,s){return t.s.r==0&&!t.s.rRel&&t.e.r==(s.biff>=12?1048575:s.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Wr(t.s.c)+":"+(t.e.cRel?"":"$")+Wr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(s.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Mr(t.s.r)+":"+(t.e.rRel?"":"$")+Mr(t.e.r):uc(t.s,s.biff)+":"+uc(t.e,s.biff)}function Rh(t){return parseInt(K9(t),10)-1}function Mr(t){return""+(t+1)}function Y9(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function K9(t){return t.replace(/\$(\d+)$/,"$1")}function Dh(t){for(var s=J9(t),r=0,n=0;n!==s.length;++n)r=26*r+s.charCodeAt(n)-64;return r-1}function Wr(t){if(t<0)throw new Error("invalid column "+t);var s="";for(++t;t;t=Math.floor((t-1)/26))s=String.fromCharCode((t-1)%26+65)+s;return s}function X9(t){return t.replace(/^([A-Z])/,"$$$1")}function J9(t){return t.replace(/^\$([A-Z])/,"$1")}function Z9(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pr(t){for(var s=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?s=10*s+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:s-1}}function Ms(t){for(var s=t.c+1,r="";s;s=(s-1)/26|0)r=String.fromCharCode((s-1)%26+65)+r;return r+(t.r+1)}function En(t){var s=t.indexOf(":");return s==-1?{s:Pr(t),e:Pr(t)}:{s:Pr(t.slice(0,s)),e:Pr(t.slice(s+1))}}function gr(t,s){return typeof s>"u"||typeof s=="number"?gr(t.s,t.e):(typeof t!="string"&&(t=Ms(t)),typeof s!="string"&&(s=Ms(s)),t==s?t:t+":"+s)}function Ws(t){var s={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,l=t.length;for(r=0;n<l&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(s.s.c=--r,r=0;n<l&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(s.s.r=--r,n===l||a!=10)return s.e.c=s.s.c,s.e.r=s.s.r,s;for(++n,r=0;n!=l&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(s.e.c=--r,r=0;n!=l&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return s.e.r=--r,s}function Tb(t,s){var r=t.t=="d"&&s instanceof Date;if(t.z!=null)try{return t.w=Si(t.z,r?xn(s):s)}catch{}try{return t.w=Si((t.XF||{}).numFmtId||(r?14:0),r?xn(s):s)}catch{return""+s}}function Wa(t,s,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Wc[t.v]||t.v:s==null?Tb(t,t.v):Tb(t,s))}function il(t,s){var r=s&&s.sheet?s.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function uS(t,s,r){var n=r||{},a=t?Array.isArray(t):n.dense,l=t||(a?[]:{}),c=0,u=0;if(l&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var f=typeof n.origin=="string"?Pr(n.origin):n.origin;c=f.r,u=f.c}l["!ref"]||(l["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var v=Ws(l["!ref"]);h.s.c=v.s.c,h.s.r=v.s.r,h.e.c=Math.max(h.e.c,v.e.c),h.e.r=Math.max(h.e.r,v.e.r),c==-1&&(h.e.r=c=v.e.r+1)}for(var w=0;w!=s.length;++w)if(s[w]){if(!Array.isArray(s[w]))throw new Error("aoa_to_sheet expects an array of arrays");for(var j=0;j!=s[w].length;++j)if(!(typeof s[w][j]>"u")){var C={v:s[w][j]},k=c+w,S=u+j;if(h.s.r>k&&(h.s.r=k),h.s.c>S&&(h.s.c=S),h.e.r<k&&(h.e.r=k),h.e.c<S&&(h.e.c=S),s[w][j]&&typeof s[w][j]=="object"&&!Array.isArray(s[w][j])&&!(s[w][j]instanceof Date))C=s[w][j];else if(Array.isArray(C.v)&&(C.f=s[w][j][1],C.v=C.v[0]),C.v===null)if(C.f)C.t="n";else if(n.nullError)C.t="e",C.v=0;else if(n.sheetStubs)C.t="z";else continue;else typeof C.v=="number"?C.t="n":typeof C.v=="boolean"?C.t="b":C.v instanceof Date?(C.z=n.dateNF||ir[14],n.cellDates?(C.t="d",C.w=Si(C.z,xn(C.v))):(C.t="n",C.v=xn(C.v),C.w=Si(C.z,C.v))):C.t="s";if(a)l[k]||(l[k]=[]),l[k][S]&&l[k][S].z&&(C.z=l[k][S].z),l[k][S]=C;else{var _=Ms({c:S,r:k});l[_]&&l[_].z&&(C.z=l[_].z),l[_]=C}}}return h.s.c<1e7&&(l["!ref"]=gr(h)),l}function ho(t,s){return uS(null,t,s)}function eF(t){return t.read_shift(4,"i")}function Xn(t,s){return s||(s=st(4)),s.write_shift(4,t),s}function Gr(t){var s=t.read_shift(4);return s===0?"":t.read_shift(s,"dbcs")}function Ar(t,s){var r=!1;return s==null&&(r=!0,s=st(4+2*t.length)),s.write_shift(4,t.length),t.length>0&&s.write_shift(0,t,"dbcs"),r?s.slice(0,s.l):s}function tF(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function sF(t,s){return s||(s=st(4)),s.write_shift(2,0),s.write_shift(2,0),s}function Lh(t,s){var r=t.l,n=t.read_shift(1),a=Gr(t),l=[],c={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),f=0;f!=u;++f)l.push(tF(t));c.r=l}else c.r=[{ich:0,ifnt:0}];return t.l=r+s,c}function rF(t,s){var r=!1;return s==null&&(r=!0,s=st(15+4*t.t.length)),s.write_shift(1,0),Ar(t.t,s),r?s.slice(0,s.l):s}var nF=Lh;function aF(t,s){var r=!1;return s==null&&(r=!0,s=st(23+4*t.t.length)),s.write_shift(1,1),Ar(t.t,s),s.write_shift(4,1),sF({},s),r?s.slice(0,s.l):s}function qn(t){var s=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:s,iStyleRef:r}}function ll(t,s){return s==null&&(s=st(8)),s.write_shift(-4,t.c),s.write_shift(3,t.iStyleRef||t.s),s.write_shift(1,0),s}function ol(t){var s=t.read_shift(2);return s+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:s}}function cl(t,s){return s==null&&(s=st(4)),s.write_shift(3,t.iStyleRef||t.s),s.write_shift(1,0),s}var iF=Gr,mS=Ar;function Fh(t){var s=t.read_shift(4);return s===0||s===4294967295?"":t.read_shift(s,"dbcs")}function Yu(t,s){var r=!1;return s==null&&(r=!0,s=st(127)),s.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&s.write_shift(0,t,"dbcs"),r?s.slice(0,s.l):s}var lF=Gr,Ex=Fh,Mh=Yu;function pS(t){var s=t.slice(t.l,t.l+4),r=s[0]&1,n=s[0]&2;t.l+=4;var a=n===0?Hu([0,0,0,0,s[0]&252,s[1],s[2],s[3]],0):Vi(s,0)>>2;return r?a/100:a}function xS(t,s){s==null&&(s=st(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)s.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function hS(t){var s={s:{},e:{}};return s.s.r=t.read_shift(4),s.e.r=t.read_shift(4),s.s.c=t.read_shift(4),s.e.c=t.read_shift(4),s}function oF(t,s){return s||(s=st(16)),s.write_shift(4,t.s.r),s.write_shift(4,t.e.r),s.write_shift(4,t.s.c),s.write_shift(4,t.e.c),s}var dl=hS,fo=oF;function go(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function nl(t,s){return(s||st(8)).write_shift(8,t,"f")}function cF(t){var s={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),l=t.read_shift(2,"i"),c=t.read_shift(1),u=t.read_shift(1),f=t.read_shift(1);switch(t.l++,n){case 0:s.auto=1;break;case 1:s.index=a;var h=yF[a];h&&(s.rgb=$b(h));break;case 2:s.rgb=$b([c,u,f]);break;case 3:s.theme=a;break}return l!=0&&(s.tint=l>0?l/32767:l/32768),s}function Ku(t,s){if(s||(s=st(8)),!t||t.auto)return s.write_shift(4,0),s.write_shift(4,0),s;t.index!=null?(s.write_shift(1,2),s.write_shift(1,t.index)):t.theme!=null?(s.write_shift(1,6),s.write_shift(1,t.theme)):(s.write_shift(1,5),s.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),s.write_shift(2,r),!t.rgb||t.theme!=null)s.write_shift(2,0),s.write_shift(1,0),s.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),s.write_shift(1,parseInt(n.slice(0,2),16)),s.write_shift(1,parseInt(n.slice(2,4),16)),s.write_shift(1,parseInt(n.slice(4,6),16)),s.write_shift(1,255)}return s}function dF(t){var s=t.read_shift(1);t.l++;var r={fBold:s&1,fItalic:s&2,fUnderline:s&4,fStrikeout:s&8,fOutline:s&16,fShadow:s&32,fCondense:s&64,fExtend:s&128};return r}function uF(t,s){s||(s=st(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return s.write_shift(1,r),s.write_shift(1,0),s}var fS=2,wn=3,xu=11,Xu=19,hu=64,mF=65,pF=71,xF=4108,hF=4126,Dr=80,Ob={1:{n:"CodePage",t:fS},2:{n:"Category",t:Dr},3:{n:"PresentationFormat",t:Dr},4:{n:"ByteCount",t:wn},5:{n:"LineCount",t:wn},6:{n:"ParagraphCount",t:wn},7:{n:"SlideCount",t:wn},8:{n:"NoteCount",t:wn},9:{n:"HiddenCount",t:wn},10:{n:"MultimediaClipCount",t:wn},11:{n:"ScaleCrop",t:xu},12:{n:"HeadingPairs",t:xF},13:{n:"TitlesOfParts",t:hF},14:{n:"Manager",t:Dr},15:{n:"Company",t:Dr},16:{n:"LinksUpToDate",t:xu},17:{n:"CharacterCount",t:wn},19:{n:"SharedDoc",t:xu},22:{n:"HyperlinksChanged",t:xu},23:{n:"AppVersion",t:wn,p:"version"},24:{n:"DigSig",t:mF},26:{n:"ContentType",t:Dr},27:{n:"ContentStatus",t:Dr},28:{n:"Language",t:Dr},29:{n:"Version",t:Dr},255:{},2147483648:{n:"Locale",t:Xu},2147483651:{n:"Behavior",t:Xu},1919054434:{}},Rb={1:{n:"CodePage",t:fS},2:{n:"Title",t:Dr},3:{n:"Subject",t:Dr},4:{n:"Author",t:Dr},5:{n:"Keywords",t:Dr},6:{n:"Comments",t:Dr},7:{n:"Template",t:Dr},8:{n:"LastAuthor",t:Dr},9:{n:"RevNumber",t:Dr},10:{n:"EditTime",t:hu},11:{n:"LastPrinted",t:hu},12:{n:"CreatedDate",t:hu},13:{n:"ModifiedDate",t:hu},14:{n:"PageCount",t:wn},15:{n:"WordCount",t:wn},16:{n:"CharCount",t:wn},17:{n:"Thumbnail",t:pF},18:{n:"Application",t:Dr},19:{n:"DocSecurity",t:wn},255:{},2147483648:{n:"Locale",t:Xu},2147483651:{n:"Behavior",t:Xu},1919054434:{}};function fF(t){return t.map(function(s){return[s>>16&255,s>>8&255,s&255]})}var gF=fF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),yF=hn(gF),Wc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},vF={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},fu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function gS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function yS(t,s){var r=P9(vF),n=[],a;n[n.length]=vr,n[n.length]=Ft("Types",null,{xmlns:Er.CT,"xmlns:xsd":Er.xsd,"xmlns:xsi":Er.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Ft("Default",null,{Extension:f[0],ContentType:f[1]})}));var l=function(f){t[f]&&t[f].length>0&&(a=t[f][0],n[n.length]=Ft("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:fu[f][s.bookType]||fu[f].xlsx}))},c=function(f){(t[f]||[]).forEach(function(h){n[n.length]=Ft("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:fu[f][s.bookType]||fu[f].xlsx})})},u=function(f){(t[f]||[]).forEach(function(h){n[n.length]=Ft("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[f][0]})})};return l("workbooks"),c("sheets"),c("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),c("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var _s={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vS(t){var s=t.lastIndexOf("/");return t.slice(0,s+1)+"_rels/"+t.slice(s+1)+".rels"}function Hl(t){var s=[vr,Ft("Relationships",null,{xmlns:Er.RELS})];return Ir(t["!id"]).forEach(function(r){s[s.length]=Ft("Relationship",null,t["!id"][r])}),s.length>2&&(s[s.length]="</Relationships>",s[1]=s[1].replace("/>",">")),s.join("")}function Ls(t,s,r,n,a,l){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),s<0)for(s=t["!idx"];t["!id"]["rId"+s];++s);if(t["!idx"]=s+1,a.Id="rId"+s,a.Type=n,a.Target=r,[_s.HLINK,_s.XPATH,_s.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+s);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,s}function bF(t){var s=[vr];s.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),s.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)s.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return s.push("</manifest:manifest>"),s.join("")}function Db(t,s,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+s+`"/>
`,`  </rdf:Description>
`].join("")}function wF(t,s){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+s+`"/>
`,`  </rdf:Description>
`].join("")}function NF(t){var s=[vr];s.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)s.push(Db(t[r][0],t[r][1])),s.push(wF("",t[r][0]));return s.push(Db("","Document","pkg")),s.push("</rdf:RDF>"),s.join("")}function bS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+$u.version+"</meta:generator></office:meta></office:document-meta>"}var Yi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Y0(t,s,r,n,a){a[t]!=null||s==null||s===""||(a[t]=s,s=Fs(s),n[n.length]=r?Ft(t,s,r):Fr(t,s))}function wS(t,s){var r=s||{},n=[vr,Ft("cp:coreProperties",null,{"xmlns:cp":Er.CORE_PROPS,"xmlns:dc":Er.dc,"xmlns:dcterms":Er.dcterms,"xmlns:dcmitype":Er.dcmitype,"xmlns:xsi":Er.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Y0("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:_x(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&Y0("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:_x(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var l=0;l!=Yi.length;++l){var c=Yi[l],u=r.Props&&r.Props[c[1]]!=null?r.Props[c[1]]:t?t[c[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Y0(c[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Yl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],NS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function jS(t){var s=[],r=Ft;return t||(t={}),t.Application="SheetJS",s[s.length]=vr,s[s.length]=Ft("Properties",null,{xmlns:Er.EXT_PROPS,"xmlns:vt":Er.vt}),Yl.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Fs(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(s[s.length]=r(n[0],a))}}),s[s.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),s[s.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Fs(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),s.length>2&&(s[s.length]="</Properties>",s[1]=s[1].replace("/>",">")),s.join("")}function SS(t){var s=[vr,Ft("Properties",null,{xmlns:Er.CUST_PROPS,"xmlns:vt":Er.vt})];if(!t)return s.join("");var r=1;return Ir(t).forEach(function(a){++r,s[s.length]=Ft("property",B9(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Fs(a)})}),s.length>2&&(s[s.length]="</Properties>",s[1]=s[1].replace("/>",">")),s.join("")}var Lb={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function jF(t,s){var r=[];return Ir(Lb).map(function(n){for(var a=0;a<Yi.length;++a)if(Yi[a][1]==n)return Yi[a];for(a=0;a<Yl.length;++a)if(Yl[a][1]==n)return Yl[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=s&&s.Props&&s.Props[n[1]]!=null?s.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Fr(Lb[n[1]]||n[1],a))}}),Ft("DocumentProperties",r.join(""),{xmlns:Sn.o})}function SF(t,s){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Ir(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)){for(var c=0;c<Yi.length;++c)if(l==Yi[c][1])return;for(c=0;c<Yl.length;++c)if(l==Yl[c][1])return;for(c=0;c<r.length;++c)if(l==r[c])return;var u=t[l],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),a.push(Ft(Nb(l),u,{"dt:dt":f}))}}),s&&Ir(s).forEach(function(l){if(Object.prototype.hasOwnProperty.call(s,l)&&!(t&&Object.prototype.hasOwnProperty.call(t,l))){var c=s[l],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c instanceof Date?(u="dateTime.tz",c=c.toISOString()):c=String(c),a.push(Ft(Nb(l),c,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Sn.o+'">'+a.join("")+"</"+n+">"}function kF(t){var s=typeof t=="string"?new Date(Date.parse(t)):t,r=s.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var l=n/Math.pow(2,32)|0;l>0&&(n=n%Math.pow(2,32),a+=l);var c=st(8);return c.write_shift(4,n),c.write_shift(4,a),c}function Fb(t,s){var r=st(4),n=st(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,s);break;case 5:n=st(8),n.write_shift(8,s,"f");break;case 11:n.write_shift(4,s?1:0);break;case 64:n=kF(s);break;case 31:case 80:for(n=st(4+2*(s.length+1)+(s.length%2?0:2)),n.write_shift(4,s.length+1),n.write_shift(0,s,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}return Lr([r,n])}var kS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function CF(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Mb(t,s,r){var n=st(8),a=[],l=[],c=8,u=0,f=st(8),h=st(8);if(f.write_shift(4,2),f.write_shift(4,1200),h.write_shift(4,1),l.push(f),a.push(h),c+=8+f.length,!s){h=st(8),h.write_shift(4,0),a.unshift(h);var v=[st(4)];for(v[0].write_shift(4,t.length),u=0;u<t.length;++u){var w=t[u][0];for(f=st(8+2*(w.length+1)+(w.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,w.length+1),f.write_shift(0,w,"dbcs");f.l!=f.length;)f.write_shift(1,0);v.push(f)}f=Lr(v),l.unshift(f),c+=8+f.length}for(u=0;u<t.length;++u)if(!(s&&!s[t[u][0]])&&!(kS.indexOf(t[u][0])>-1||NS.indexOf(t[u][0])>-1)&&t[u][1]!=null){var j=t[u][1],C=0;if(s){C=+s[t[u][0]];var k=r[C];if(k.p=="version"&&typeof j=="string"){var S=j.split(".");j=(+S[0]<<16)+(+S[1]||0)}f=Fb(k.t,j)}else{var _=CF(j);_==-1&&(_=31,j=String(j)),f=Fb(_,j)}l.push(f),h=st(8),h.write_shift(4,s?C:2+u),a.push(h),c+=8+f.length}var I=8*(l.length+1);for(u=0;u<l.length;++u)a[u].write_shift(4,I),I+=l[u].length;return n.write_shift(4,c),n.write_shift(4,l.length),Lr([n].concat(a).concat(l))}function Ib(t,s,r,n,a,l){var c=st(a?68:48),u=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,Is.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,a?2:1),c.write_shift(16,s,"hex"),c.write_shift(4,a?68:48);var f=Mb(t,r,n);if(u.push(f),a){var h=Mb(a,null,null);c.write_shift(16,l,"hex"),c.write_shift(4,68+f.length),u.push(h)}return Lr(u)}function _F(t,s){s||(s=st(t));for(var r=0;r<t;++r)s.write_shift(1,0);return s}function EF(t,s){return t.read_shift(s)===1}function Zr(t,s){return s||(s=st(2)),s.write_shift(2,+!!t),s}function CS(t){return t.read_shift(2,"u")}function Mn(t,s){return s||(s=st(2)),s.write_shift(2,t),s}function _S(t,s,r){return r||(r=st(2)),r.write_shift(1,s=="e"?+t:+!!t),r.write_shift(1,s=="e"?1:0),r}function ES(t,s,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=t.read_shift(1);l&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var c=n?t.read_shift(n,a):"";return c}function PF(t){var s=t.t||"",r=st(3);r.write_shift(2,s.length),r.write_shift(1,1);var n=st(2*s.length);n.write_shift(2*s.length,s,"utf16le");var a=[r,n];return Lr(a)}function AF(t,s,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(s,"cpstr");if(r.biff>=12)return t.read_shift(s,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(s,"sbcs-cont"):n=t.read_shift(s,"dbcs-cont"),n}function TF(t,s,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):AF(t,n,r)}function OF(t,s,r){if(r.biff>5)return TF(t,s,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function PS(t,s,r){return r||(r=st(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function qb(t,s){s||(s=st(6+t.length*2)),s.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)s.write_shift(2,t.charCodeAt(r));return s.write_shift(2,0),s}function RF(t){var s=st(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),l=a>-1?31:23;switch(n.charAt(0)){case"#":l=28;break;case".":l&=-3;break}s.write_shift(4,2),s.write_shift(4,l);var c=[8,6815827,6619237,4849780,83];for(r=0;r<c.length;++r)s.write_shift(4,c[r]);if(l==28)n=n.slice(1),qb(n,s);else if(l&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<c.length;++r)s.write_shift(1,parseInt(c[r],16));var u=a>-1?n.slice(0,a):n;for(s.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)s.write_shift(2,u.charCodeAt(r));s.write_shift(2,0),l&8&&qb(a>-1?n.slice(a+1):"",s)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<c.length;++r)s.write_shift(1,parseInt(c[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(s.write_shift(2,f),s.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)s.write_shift(1,n.charCodeAt(r+3*f)&255);for(s.write_shift(1,0),s.write_shift(2,65535),s.write_shift(2,57005),r=0;r<6;++r)s.write_shift(4,0)}return s.slice(0,s.l)}function al(t,s,r,n){return n||(n=st(6)),n.write_shift(2,t),n.write_shift(2,s),n.write_shift(2,r||0),n}function DF(t,s,r){var n=r.biff>8?4:2,a=t.read_shift(n),l=t.read_shift(n,"i"),c=t.read_shift(n,"i");return[a,l,c]}function LF(t){var s=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:s},e:{c:a,r}}}function AS(t,s){return s||(s=st(8)),s.write_shift(2,t.s.r),s.write_shift(2,t.e.r),s.write_shift(2,t.s.c),s.write_shift(2,t.e.c),s}function Ih(t,s,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=st(a);return l.write_shift(2,n),l.write_shift(2,s),a>4&&l.write_shift(2,29282),a>6&&l.write_shift(2,1997),a>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function FF(t,s){var r=!s||s.biff==8,n=st(r?112:54);for(n.write_shift(s.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function MF(t,s){var r=!s||s.biff>=8?2:1,n=st(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),s.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,s.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function IF(t,s){var r=st(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=PF(t[a]);var l=Lr([r].concat(n));return l.parts=[r.length].concat(n.map(function(c){return c.length})),l}function qF(){var t=st(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function BF(t){var s=st(18),r=1718;return t&&t.RTL&&(r|=64),s.write_shift(2,r),s.write_shift(4,0),s.write_shift(4,64),s.write_shift(4,0),s.write_shift(4,0),s}function zF(t,s){var r=t.name||"Arial",n=s&&s.biff==5,a=n?15+r.length:16+2*r.length,l=st(a);return l.write_shift(2,t.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),n||l.write_shift(1,1),l.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),l}function $F(t,s,r,n){var a=st(10);return al(t,s,n,a),a.write_shift(4,r),a}function QF(t,s,r,n,a){var l=!a||a.biff==8,c=st(8+ +l+(1+l)*r.length);return al(t,s,n,c),c.write_shift(2,r.length),l&&c.write_shift(1,1),c.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),c}function UF(t,s,r,n){var a=r&&r.biff==5;n||(n=st(a?3+s.length:5+2*s.length)),n.write_shift(2,t),n.write_shift(a?1:2,s.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*s.length,s,a?"sbcs":"utf16le");var l=n.length>n.l?n.slice(0,n.l):n;return l.l==null&&(l.l=l.length),l}function VF(t,s){var r=s.biff==8||!s.biff?4:2,n=st(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function Bb(t,s,r,n){var a=r&&r.biff==5;n||(n=st(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,s<<4));var l=0;return t.numFmtId>0&&a&&(l|=1024),n.write_shift(4,l),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function WF(t){var s=st(8);return s.write_shift(4,0),s.write_shift(2,0),s.write_shift(2,0),s}function GF(t,s,r,n,a,l){var c=st(8);return al(t,s,n,c),_S(r,l,c),c}function HF(t,s,r,n){var a=st(14);return al(t,s,n,a),nl(r,a),a}function YF(t,s,r){if(r.biff<8)return KF(t,s,r);for(var n=[],a=t.l+s,l=t.read_shift(r.biff>8?4:2);l--!==0;)n.push(DF(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function KF(t,s,r){t[t.l+1]==3&&t[t.l]++;var n=ES(t,s,r);return n.charCodeAt(0)==3?n.slice(1):n}function XF(t){var s=st(2+t.length*8);s.write_shift(2,t.length);for(var r=0;r<t.length;++r)AS(t[r],s);return s}function JF(t){var s=st(24),r=Pr(t[0]);s.write_shift(2,r.r),s.write_shift(2,r.r),s.write_shift(2,r.c),s.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)s.write_shift(1,parseInt(n[a],16));return Lr([s,RF(t[1])])}function ZF(t){var s=t[1].Tooltip,r=st(10+2*(s.length+1));r.write_shift(2,2048);var n=Pr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<s.length;++a)r.write_shift(2,s.charCodeAt(a));return r.write_shift(2,0),r}function eM(t){return t||(t=st(4)),t.write_shift(2,1),t.write_shift(2,1),t}function tM(t,s,r){if(!r.cellStyles)return Na(t,s);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(n),u=t.read_shift(n),f=t.read_shift(2);n==2&&(t.l+=2);var h={s:a,e:l,w:c,ixfe:u,flags:f};return(r.biff>=5||!r.biff)&&(h.level=f>>8&7),h}function sM(t,s){var r=st(12);r.write_shift(2,s),r.write_shift(2,s),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function rM(t){for(var s=st(2*t),r=0;r<t;++r)s.write_shift(2,r+1);return s}function nM(t,s,r){var n=st(15);return Hc(n,t,s),n.write_shift(8,r,"f"),n}function aM(t,s,r){var n=st(9);return Hc(n,t,s),n.write_shift(2,r),n}var iM=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},s=_h({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,f){var h=[],v=rl(1);switch(f.type){case"base64":v=Yn(Va(u));break;case"binary":v=Yn(u);break;case"buffer":case"array":v=u;break}Nn(v,0);var w=v.read_shift(1),j=!!(w&136),C=!1,k=!1;switch(w){case 2:break;case 3:break;case 48:C=!0,j=!0;break;case 49:C=!0,j=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+w.toString(16))}var S=0,_=521;w==2&&(S=v.read_shift(2)),v.l+=3,w!=2&&(S=v.read_shift(4)),S>1048576&&(S=1e6),w!=2&&(_=v.read_shift(2));var I=v.read_shift(2),F=f.codepage||1252;w!=2&&(v.l+=16,v.read_shift(1),v[v.l]!==0&&(F=t[v[v.l]]),v.l+=1,v.l+=2),k&&(v.l+=36);for(var B=[],q={},me=Math.min(v.length,w==2?521:_-10-(C?264:0)),re=k?32:11;v.l<me&&v[v.l]!=13;)switch(q={},q.name=Qu.utils.decode(F,v.slice(v.l,v.l+re)).replace(/[\u0000\r\n].*$/g,""),v.l+=re,q.type=String.fromCharCode(v.read_shift(1)),w!=2&&!k&&(q.offset=v.read_shift(4)),q.len=v.read_shift(1),w==2&&(q.offset=v.read_shift(2)),q.dec=v.read_shift(1),q.name.length&&B.push(q),w!=2&&(v.l+=k?13:14),q.type){case"B":(!C||q.len!=8)&&f.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+q.type)}if(v[v.l]!==13&&(v.l=_-1),v.read_shift(1)!==13)throw new Error("DBF Terminator not found "+v.l+" "+v[v.l]);v.l=_;var M=0,W=0;for(h[0]=[],W=0;W!=B.length;++W)h[0][W]=B[W].name;for(;S-- >0;){if(v[v.l]===42){v.l+=I;continue}for(++v.l,h[++M]=[],W=0,W=0;W!=B.length;++W){var oe=v.slice(v.l,v.l+B[W].len);v.l+=B[W].len,Nn(oe,0);var X=Qu.utils.decode(F,oe);switch(B[W].type){case"C":X.trim().length&&(h[M][W]=X.replace(/\s+$/,""));break;case"D":X.length===8?h[M][W]=new Date(+X.slice(0,4),+X.slice(4,6)-1,+X.slice(6,8)):h[M][W]=X;break;case"F":h[M][W]=parseFloat(X.trim());break;case"+":case"I":h[M][W]=k?oe.read_shift(-4,"i")^2147483648:oe.read_shift(4,"i");break;case"L":switch(X.trim().toUpperCase()){case"Y":case"T":h[M][W]=!0;break;case"N":case"F":h[M][W]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+X+"|")}break;case"M":if(!j)throw new Error("DBF Unexpected MEMO for type "+w.toString(16));h[M][W]="##MEMO##"+(k?parseInt(X.trim(),10):oe.read_shift(4));break;case"N":X=X.replace(/\u0000/g,"").trim(),X&&X!="."&&(h[M][W]=+X||0);break;case"@":h[M][W]=new Date(oe.read_shift(-8,"f")-621356832e5);break;case"T":h[M][W]=new Date((oe.read_shift(4)-2440588)*864e5+oe.read_shift(4));break;case"Y":h[M][W]=oe.read_shift(4,"i")/1e4+oe.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[M][W]=-oe.read_shift(-8,"f");break;case"B":if(C&&B[W].len==8){h[M][W]=oe.read_shift(8,"f");break}case"G":case"P":oe.l+=B[W].len;break;case"0":if(B[W].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+B[W].type)}}}if(w!=2&&v.l<v.length&&v[v.l++]!=26)throw new Error("DBF EOF Marker missing "+(v.l-1)+" of "+v.length+" "+v[v.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=B,h}function n(u,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var v=ho(r(u,h),h);return v["!cols"]=h.DBF.map(function(w){return{wch:w.len,DBF:w}}),delete h.DBF,v}function a(u,f){try{return il(n(u,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,f){var h=f||{};if(+h.codepage>=0&&gc(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var v=pn(),w=sm(u,{header:1,raw:!0,cellDates:!0}),j=w[0],C=w.slice(1),k=u["!cols"]||[],S=0,_=0,I=0,F=1;for(S=0;S<j.length;++S){if(((k[S]||{}).DBF||{}).name){j[S]=k[S].DBF.name,++I;continue}if(j[S]!=null){if(++I,typeof j[S]=="number"&&(j[S]=j[S].toString(10)),typeof j[S]!="string")throw new Error("DBF Invalid column name "+j[S]+" |"+typeof j[S]+"|");if(j.indexOf(j[S])!==S){for(_=0;_<1024;++_)if(j.indexOf(j[S]+"_"+_)==-1){j[S]+="_"+_;break}}}}var B=Ws(u["!ref"]),q=[],me=[],re=[];for(S=0;S<=B.e.c-B.s.c;++S){var M="",W="",oe=0,X=[];for(_=0;_<C.length;++_)C[_][S]!=null&&X.push(C[_][S]);if(X.length==0||j[S]==null){q[S]="?";continue}for(_=0;_<X.length;++_){switch(typeof X[_]){case"number":W="B";break;case"string":W="C";break;case"boolean":W="L";break;case"object":W=X[_]instanceof Date?"D":"C";break;default:W="C"}oe=Math.max(oe,String(X[_]).length),M=M&&M!=W?"C":W}oe>250&&(oe=250),W=((k[S]||{}).DBF||{}).type,W=="C"&&k[S].DBF.len>oe&&(oe=k[S].DBF.len),M=="B"&&W=="N"&&(M="N",re[S]=k[S].DBF.dec,oe=k[S].DBF.len),me[S]=M=="C"||W=="N"?oe:l[M]||0,F+=me[S],q[S]=M}var he=v.next(32);for(he.write_shift(4,318902576),he.write_shift(4,C.length),he.write_shift(2,296+32*I),he.write_shift(2,F),S=0;S<4;++S)he.write_shift(4,0);for(he.write_shift(4,0|(+s[Oj]||3)<<8),S=0,_=0;S<j.length;++S)if(j[S]!=null){var ue=v.next(32),_e=(j[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ue.write_shift(1,_e,"sbcs"),ue.write_shift(1,q[S]=="?"?"C":q[S],"sbcs"),ue.write_shift(4,_),ue.write_shift(1,me[S]||l[q[S]]||0),ue.write_shift(1,re[S]||0),ue.write_shift(1,2),ue.write_shift(4,0),ue.write_shift(1,0),ue.write_shift(4,0),ue.write_shift(4,0),_+=me[S]||l[q[S]]||0}var ke=v.next(264);for(ke.write_shift(4,13),S=0;S<65;++S)ke.write_shift(4,0);for(S=0;S<C.length;++S){var Re=v.next(F);for(Re.write_shift(1,0),_=0;_<j.length;++_)if(j[_]!=null)switch(q[_]){case"L":Re.write_shift(1,C[S][_]==null?63:C[S][_]?84:70);break;case"B":Re.write_shift(8,C[S][_]||0,"f");break;case"N":var Y="0";for(typeof C[S][_]=="number"&&(Y=C[S][_].toFixed(re[_]||0)),I=0;I<me[_]-Y.length;++I)Re.write_shift(1,32);Re.write_shift(1,Y,"sbcs");break;case"D":C[S][_]?(Re.write_shift(4,("0000"+C[S][_].getFullYear()).slice(-4),"sbcs"),Re.write_shift(2,("00"+(C[S][_].getMonth()+1)).slice(-2),"sbcs"),Re.write_shift(2,("00"+C[S][_].getDate()).slice(-2),"sbcs")):Re.write_shift(8,"00000000","sbcs");break;case"C":var ve=String(C[S][_]!=null?C[S][_]:"").slice(0,me[_]);for(Re.write_shift(1,ve,"sbcs"),I=0;I<me[_]-ve.length;++I)Re.write_shift(1,32);break}}return v.next(1).write_shift(1,26),v.end()}return{to_workbook:a,to_sheet:n,from_sheet:c}})(),lM=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},s=new RegExp("\x1BN("+Ir(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(j,C){var k=t[C];return typeof k=="number"?db(k):k},n=function(j,C,k){var S=C.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return S==59?j:db(S)};t["|"]=254;function a(j,C){switch(C.type){case"base64":return l(Va(j),C);case"binary":return l(j,C);case"buffer":return l(As&&Buffer.isBuffer(j)?j.toString("binary"):Qc(j),C);case"array":return l(Rm(j),C)}throw new Error("Unrecognized type "+C.type)}function l(j,C){var k=j.split(/[\n\r]+/),S=-1,_=-1,I=0,F=0,B=[],q=[],me=null,re={},M=[],W=[],oe=[],X=0,he;for(+C.codepage>=0&&gc(+C.codepage);I!==k.length;++I){X=0;var ue=k[I].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(s,r),_e=ue.replace(/;;/g,"\0").split(";").map(function(ae){return ae.replace(/\u0000/g,";")}),ke=_e[0],Re;if(ue.length>0)switch(ke){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":_e[1].charAt(0)=="P"&&q.push(ue.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,ve=!1,Q=!1,be=!1,pe=-1,ne=-1;for(F=1;F<_e.length;++F)switch(_e[F].charAt(0)){case"A":break;case"X":_=parseInt(_e[F].slice(1))-1,ve=!0;break;case"Y":for(S=parseInt(_e[F].slice(1))-1,ve||(_=0),he=B.length;he<=S;++he)B[he]=[];break;case"K":Re=_e[F].slice(1),Re.charAt(0)==='"'?Re=Re.slice(1,Re.length-1):Re==="TRUE"?Re=!0:Re==="FALSE"?Re=!1:isNaN(Ba(Re))?isNaN(vc(Re).getDate())||(Re=en(Re)):(Re=Ba(Re),me!==null&&Uj(me)&&(Re=Hj(Re))),Y=!0;break;case"E":be=!0;var U=aI(_e[F].slice(1),{r:S,c:_});B[S][_]=[B[S][_],U];break;case"S":Q=!0,B[S][_]=[B[S][_],"S5S"];break;case"G":break;case"R":pe=parseInt(_e[F].slice(1))-1;break;case"C":ne=parseInt(_e[F].slice(1))-1;break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+ue)}if(Y&&(B[S][_]&&B[S][_].length==2?B[S][_][0]=Re:B[S][_]=Re,me=null),Q){if(be)throw new Error("SYLK shared formula cannot have own formula");var ce=pe>-1&&B[pe][ne];if(!ce||!ce[1])throw new Error("SYLK shared formula cannot find base");B[S][_][1]=iI(ce[1],{r:S-pe,c:_-ne})}break;case"F":var z=0;for(F=1;F<_e.length;++F)switch(_e[F].charAt(0)){case"X":_=parseInt(_e[F].slice(1))-1,++z;break;case"Y":for(S=parseInt(_e[F].slice(1))-1,he=B.length;he<=S;++he)B[he]=[];break;case"M":X=parseInt(_e[F].slice(1))/20;break;case"F":break;case"G":break;case"P":me=q[parseInt(_e[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(oe=_e[F].slice(1).split(" "),he=parseInt(oe[0],10);he<=parseInt(oe[1],10);++he)X=parseInt(oe[2],10),W[he-1]=X===0?{hidden:!0}:{wch:X},qh(W[he-1]);break;case"C":_=parseInt(_e[F].slice(1))-1,W[_]||(W[_]={});break;case"R":S=parseInt(_e[F].slice(1))-1,M[S]||(M[S]={}),X>0?(M[S].hpt=X,M[S].hpx=LS(X)):X===0&&(M[S].hidden=!0);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+ue)}z<1&&(me=null);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+ue)}}return M.length>0&&(re["!rows"]=M),W.length>0&&(re["!cols"]=W),C&&C.sheetRows&&(B=B.slice(0,C.sheetRows)),[B,re]}function c(j,C){var k=a(j,C),S=k[0],_=k[1],I=ho(S,C);return Ir(_).forEach(function(F){I[F]=_[F]}),I}function u(j,C){return il(c(j,C),C)}function f(j,C,k,S){var _="C;Y"+(k+1)+";X"+(S+1)+";K";switch(j.t){case"n":_+=j.v||0,j.f&&!j.F&&(_+=";E"+zh(j.f,{r:k,c:S}));break;case"b":_+=j.v?"TRUE":"FALSE";break;case"e":_+=j.w||j.v;break;case"d":_+='"'+(j.w||j.v)+'"';break;case"s":_+='"'+j.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function h(j,C){C.forEach(function(k,S){var _="F;W"+(S+1)+" "+(S+1)+" ";k.hidden?_+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=Ju(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=Zu(k.wpx)),typeof k.wch=="number"&&(_+=Math.round(k.wch))),_.charAt(_.length-1)!=" "&&j.push(_)})}function v(j,C){C.forEach(function(k,S){var _="F;";k.hidden?_+="M0;":k.hpt?_+="M"+20*k.hpt+";":k.hpx&&(_+="M"+20*em(k.hpx)+";"),_.length>2&&j.push(_+"R"+(S+1))})}function w(j,C){var k=["ID;PWXL;N;E"],S=[],_=Ws(j["!ref"]),I,F=Array.isArray(j),B=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),j["!cols"]&&h(k,j["!cols"]),j["!rows"]&&v(k,j["!rows"]),k.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var q=_.s.r;q<=_.e.r;++q)for(var me=_.s.c;me<=_.e.c;++me){var re=Ms({r:q,c:me});I=F?(j[q]||[])[me]:j[re],!(!I||I.v==null&&(!I.f||I.F))&&S.push(f(I,j,q,me))}return k.join(B)+B+S.join(B)+B+"E"+B}return{to_workbook:u,to_sheet:c,from_sheet:w}})(),oM=(function(){function t(l,c){switch(c.type){case"base64":return s(Va(l),c);case"binary":return s(l,c);case"buffer":return s(As&&Buffer.isBuffer(l)?l.toString("binary"):Qc(l),c);case"array":return s(Rm(l),c)}throw new Error("Unrecognized type "+c.type)}function s(l,c){for(var u=l.split(`
`),f=-1,h=-1,v=0,w=[];v!==u.length;++v){if(u[v].trim()==="BOT"){w[++f]=[],h=0;continue}if(!(f<0)){var j=u[v].trim().split(","),C=j[0],k=j[1];++v;for(var S=u[v]||"";(S.match(/["]/g)||[]).length&1&&v<u.length-1;)S+=`
`+u[++v];switch(S=S.trim(),+C){case-1:if(S==="BOT"){w[++f]=[],h=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?w[f][h]=!0:S==="FALSE"?w[f][h]=!1:isNaN(Ba(k))?isNaN(vc(k).getDate())?w[f][h]=k:w[f][h]=en(k):w[f][h]=Ba(k),++h;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),w[f][h++]=S!==""?S:null;break}if(S==="EOD")break}}return c&&c.sheetRows&&(w=w.slice(0,c.sheetRows)),w}function r(l,c){return ho(t(l,c),c)}function n(l,c){return il(r(l,c),c)}var a=(function(){var l=function(f,h,v,w,j){f.push(h),f.push(v+","+w),f.push('"'+j.replace(/"/g,'""')+'"')},c=function(f,h,v,w){f.push(h+","+v),f.push(h==1?'"'+w.replace(/"/g,'""')+'"':w)};return function(f){var h=[],v=Ws(f["!ref"]),w,j=Array.isArray(f);l(h,"TABLE",0,1,"sheetjs"),l(h,"VECTORS",0,v.e.r-v.s.r+1,""),l(h,"TUPLES",0,v.e.c-v.s.c+1,""),l(h,"DATA",0,0,"");for(var C=v.s.r;C<=v.e.r;++C){c(h,-1,0,"BOT");for(var k=v.s.c;k<=v.e.c;++k){var S=Ms({r:C,c:k});if(w=j?(f[C]||[])[k]:f[S],!w){c(h,1,0,"");continue}switch(w.t){case"n":var _=w.w;!_&&w.v!=null&&(_=w.v),_==null?w.f&&!w.F?c(h,1,0,"="+w.f):c(h,1,0,""):c(h,0,_,"V");break;case"b":c(h,0,w.v?1:0,w.v?"TRUE":"FALSE");break;case"s":c(h,1,0,isNaN(w.v)?w.v:'="'+w.v+'"');break;case"d":w.w||(w.w=Si(w.z||ir[14],xn(en(w.v)))),c(h,0,w.w,"V");break;default:c(h,1,0,"")}}}c(h,-1,0,"EOD");var I=`\r
`,F=h.join(I);return F}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),TS=(function(){function t(w){return w.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function s(w){return w.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(w,j){for(var C=w.split(`
`),k=-1,S=-1,_=0,I=[];_!==C.length;++_){var F=C[_].trim().split(":");if(F[0]==="cell"){var B=Pr(F[1]);if(I.length<=B.r)for(k=I.length;k<=B.r;++k)I[k]||(I[k]=[]);switch(k=B.r,S=B.c,F[2]){case"t":I[k][S]=t(F[3]);break;case"v":I[k][S]=+F[3];break;case"vtf":var q=F[F.length-1];case"vtc":switch(F[3]){case"nl":I[k][S]=!!+F[4];break;default:I[k][S]=+F[4];break}F[2]=="vtf"&&(I[k][S]=[I[k][S],q])}}}return j&&j.sheetRows&&(I=I.slice(0,j.sheetRows)),I}function n(w,j){return ho(r(w,j),j)}function a(w,j){return il(n(w,j),j)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(w){if(!w||!w["!ref"])return"";for(var j=[],C=[],k,S="",_=En(w["!ref"]),I=Array.isArray(w),F=_.s.r;F<=_.e.r;++F)for(var B=_.s.c;B<=_.e.c;++B)if(S=Ms({r:F,c:B}),k=I?(w[F]||[])[B]:w[S],!(!k||k.v==null||k.t==="z")){switch(C=["cell",S,"t"],k.t){case"s":case"str":C.push(s(k.v));break;case"n":k.f?(C[2]="vtf",C[3]="n",C[4]=k.v,C[5]=s(k.f)):(C[2]="v",C[3]=k.v);break;case"b":C[2]="vt"+(k.f?"f":"c"),C[3]="nl",C[4]=k.v?"1":"0",C[5]=s(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var q=xn(en(k.v));C[2]="vtc",C[3]="nd",C[4]=""+q,C[5]=k.w||Si(k.z||ir[14],q);break;case"e":continue}j.push(C.join(":"))}return j.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),j.push("valueformat:1:text-wiki"),j.join(`
`)}function v(w){return[l,c,u,c,h(w),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:v}})(),cM=(function(){function t(v,w,j,C,k){k.raw?w[j][C]=v:v===""||(v==="TRUE"?w[j][C]=!0:v==="FALSE"?w[j][C]=!1:isNaN(Ba(v))?isNaN(vc(v).getDate())?w[j][C]=v:w[j][C]=en(v):w[j][C]=Ba(v))}function s(v,w){var j=w||{},C=[];if(!v||v.length===0)return C;for(var k=v.split(/[\r\n]/),S=k.length-1;S>=0&&k[S].length===0;)--S;for(var _=10,I=0,F=0;F<=S;++F)I=k[F].indexOf(" "),I==-1?I=k[F].length:I++,_=Math.max(_,I);for(F=0;F<=S;++F){C[F]=[];var B=0;for(t(k[F].slice(0,_).trim(),C,F,B,j),B=1;B<=(k[F].length-_)/10+1;++B)t(k[F].slice(_+(B-1)*10,_+B*10).trim(),C,F,B,j)}return j.sheetRows&&(C=C.slice(0,j.sheetRows)),C}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(v){for(var w={},j=!1,C=0,k=0;C<v.length;++C)(k=v.charCodeAt(C))==34?j=!j:!j&&k in r&&(w[k]=(w[k]||0)+1);k=[];for(C in w)Object.prototype.hasOwnProperty.call(w,C)&&k.push([w[C],C]);if(!k.length){w=n;for(C in w)Object.prototype.hasOwnProperty.call(w,C)&&k.push([w[C],C])}return k.sort(function(S,_){return S[0]-_[0]||n[S[1]]-n[_[1]]}),r[k.pop()[1]]||44}function l(v,w){var j=w||{},C="",k=j.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};v.slice(0,4)=="sep="?v.charCodeAt(5)==13&&v.charCodeAt(6)==10?(C=v.charAt(4),v=v.slice(7)):v.charCodeAt(5)==13||v.charCodeAt(5)==10?(C=v.charAt(4),v=v.slice(6)):C=a(v.slice(0,1024)):j&&j.FS?C=j.FS:C=a(v.slice(0,1024));var _=0,I=0,F=0,B=0,q=0,me=C.charCodeAt(0),re=!1,M=0,W=v.charCodeAt(0);v=v.replace(/\r\n/mg,`
`);var oe=j.dateNF!=null?k9(j.dateNF):null;function X(){var he=v.slice(B,q),ue={};if(he.charAt(0)=='"'&&he.charAt(he.length-1)=='"'&&(he=he.slice(1,-1).replace(/""/g,'"')),he.length===0)ue.t="z";else if(j.raw)ue.t="s",ue.v=he;else if(he.trim().length===0)ue.t="s",ue.v=he;else if(he.charCodeAt(0)==61)he.charCodeAt(1)==34&&he.charCodeAt(he.length-1)==34?(ue.t="s",ue.v=he.slice(2,-1).replace(/""/g,'"')):lI(he)?(ue.t="n",ue.f=he.slice(1)):(ue.t="s",ue.v=he);else if(he=="TRUE")ue.t="b",ue.v=!0;else if(he=="FALSE")ue.t="b",ue.v=!1;else if(!isNaN(F=Ba(he)))ue.t="n",j.cellText!==!1&&(ue.w=he),ue.v=F;else if(!isNaN(vc(he).getDate())||oe&&he.match(oe)){ue.z=j.dateNF||ir[14];var _e=0;oe&&he.match(oe)&&(he=C9(he,j.dateNF,he.match(oe)||[]),_e=1),j.cellDates?(ue.t="d",ue.v=en(he,_e)):(ue.t="n",ue.v=xn(en(he,_e))),j.cellText!==!1&&(ue.w=Si(ue.z,ue.v instanceof Date?xn(ue.v):ue.v)),j.cellNF||delete ue.z}else ue.t="s",ue.v=he;if(ue.t=="z"||(j.dense?(k[_]||(k[_]=[]),k[_][I]=ue):k[Ms({c:I,r:_})]=ue),B=q+1,W=v.charCodeAt(B),S.e.c<I&&(S.e.c=I),S.e.r<_&&(S.e.r=_),M==me)++I;else if(I=0,++_,j.sheetRows&&j.sheetRows<=_)return!0}e:for(;q<v.length;++q)switch(M=v.charCodeAt(q)){case 34:W===34&&(re=!re);break;case me:case 10:case 13:if(!re&&X())break e;break}return q-B>0&&X(),k["!ref"]=gr(S),k}function c(v,w){return!(w&&w.PRN)||w.FS||v.slice(0,4)=="sep="||v.indexOf("	")>=0||v.indexOf(",")>=0||v.indexOf(";")>=0?l(v,w):ho(s(v,w),w)}function u(v,w){var j="",C=w.type=="string"?[0,0,0,0]:wq(v,w);switch(w.type){case"base64":j=Va(v);break;case"binary":j=v;break;case"buffer":w.codepage==65001?j=v.toString("utf8"):w.codepage&&typeof Qu<"u"||(j=As&&Buffer.isBuffer(v)?v.toString("binary"):Qc(v));break;case"array":j=Rm(v);break;case"string":j=v;break;default:throw new Error("Unrecognized type "+w.type)}return C[0]==239&&C[1]==187&&C[2]==191?j=oc(j.slice(3)):w.type!="string"&&w.type!="buffer"&&w.codepage==65001?j=oc(j):w.type=="binary"&&typeof Qu<"u",j.slice(0,19)=="socialcalc:version:"?TS.to_sheet(w.type=="string"?j:oc(j),w):c(j,w)}function f(v,w){return il(u(v,w),w)}function h(v){for(var w=[],j=Ws(v["!ref"]),C,k=Array.isArray(v),S=j.s.r;S<=j.e.r;++S){for(var _=[],I=j.s.c;I<=j.e.c;++I){var F=Ms({r:S,c:I});if(C=k?(v[S]||[])[I]:v[F],!C||C.v==null){_.push("          ");continue}for(var B=(C.w||(Wa(C),C.w)||"").slice(0,10);B.length<10;)B+=" ";_.push(B+(I===0?" ":""))}w.push(_.join(""))}return w.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:h}})(),zb=(function(){function t(U,ce,z){if(U){Nn(U,U.l||0);for(var ae=z.Enum||pe;U.l<U.length;){var ye=U.read_shift(2),fe=ae[ye]||ae[65535],Ee=U.read_shift(2),Le=U.l+Ee,De=fe.f&&fe.f(U,Ee,z);if(U.l=Le,ce(De,fe,ye))return}}}function s(U,ce){switch(ce.type){case"base64":return r(Yn(Va(U)),ce);case"binary":return r(Yn(U),ce);case"buffer":case"array":return r(U,ce)}throw"Unsupported type "+ce.type}function r(U,ce){if(!U)return U;var z=ce||{},ae=z.dense?[]:{},ye="Sheet1",fe="",Ee=0,Le={},De=[],Ve=[],et={s:{r:0,c:0},e:{r:0,c:0}},Nt=z.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)z.Enum=pe,t(U,function(Me,mt,it){switch(it){case 0:z.vers=Me,Me>=4096&&(z.qpro=!0);break;case 6:et=Me;break;case 204:Me&&(fe=Me);break;case 222:fe=Me;break;case 15:case 51:z.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:it==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=z.dateNF||ir[14],z.cellDates&&(Me[1].t="d",Me[1].v=Hj(Me[1].v))),z.qpro&&Me[3]>Ee&&(ae["!ref"]=gr(et),Le[ye]=ae,De.push(ye),ae=z.dense?[]:{},et={s:{r:0,c:0},e:{r:0,c:0}},Ee=Me[3],ye=fe||"Sheet"+(Ee+1),fe="");var Et=z.dense?(ae[Me[0].r]||[])[Me[0].c]:ae[Ms(Me[0])];if(Et){Et.t=Me[1].t,Et.v=Me[1].v,Me[1].z!=null&&(Et.z=Me[1].z),Me[1].f!=null&&(Et.f=Me[1].f);break}z.dense?(ae[Me[0].r]||(ae[Me[0].r]=[]),ae[Me[0].r][Me[0].c]=Me[1]):ae[Ms(Me[0])]=Me[1];break}},z);else if(U[2]==26||U[2]==14)z.Enum=ne,U[2]==14&&(z.qpro=!0,U.l=0),t(U,function(Me,mt,it){switch(it){case 204:ye=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>Ee&&(ae["!ref"]=gr(et),Le[ye]=ae,De.push(ye),ae=z.dense?[]:{},et={s:{r:0,c:0},e:{r:0,c:0}},Ee=Me[3],ye="Sheet"+(Ee+1)),Nt>0&&Me[0].r>=Nt)break;z.dense?(ae[Me[0].r]||(ae[Me[0].r]=[]),ae[Me[0].r][Me[0].c]=Me[1]):ae[Ms(Me[0])]=Me[1],et.e.c<Me[0].c&&(et.e.c=Me[0].c),et.e.r<Me[0].r&&(et.e.r=Me[0].r);break;case 27:Me[14e3]&&(Ve[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Ve[Me[0]]=Me[1],Me[0]==Ee&&(ye=Me[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(ae["!ref"]=gr(et),Le[fe||ye]=ae,De.push(fe||ye),!Ve.length)return{SheetNames:De,Sheets:Le};for(var ot={},Qt=[],qe=0;qe<Ve.length;++qe)Le[De[qe]]?(Qt.push(Ve[qe]||De[qe]),ot[Ve[qe]]=Le[Ve[qe]]||Le[De[qe]]):(Qt.push(Ve[qe]),ot[Ve[qe]]={"!ref":"A1"});return{SheetNames:Qt,Sheets:ot}}function n(U,ce){var z=ce||{};if(+z.codepage>=0&&gc(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var ae=pn(),ye=Ws(U["!ref"]),fe=Array.isArray(U),Ee=[];It(ae,0,l(1030)),It(ae,6,f(ye));for(var Le=Math.min(ye.e.r,8191),De=ye.s.r;De<=Le;++De)for(var Ve=Mr(De),et=ye.s.c;et<=ye.e.c;++et){De===ye.s.r&&(Ee[et]=Wr(et));var Nt=Ee[et]+Ve,ot=fe?(U[De]||[])[et]:U[Nt];if(!(!ot||ot.t=="z"))if(ot.t=="n")(ot.v|0)==ot.v&&ot.v>=-32768&&ot.v<=32767?It(ae,13,C(De,et,ot.v)):It(ae,14,S(De,et,ot.v));else{var Qt=Wa(ot);It(ae,15,w(De,et,Qt.slice(0,239)))}}return It(ae,1),ae.end()}function a(U,ce){var z=ce||{};if(+z.codepage>=0&&gc(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var ae=pn();It(ae,0,c(U));for(var ye=0,fe=0;ye<U.SheetNames.length;++ye)(U.Sheets[U.SheetNames[ye]]||{})["!ref"]&&It(ae,27,be(U.SheetNames[ye],fe++));var Ee=0;for(ye=0;ye<U.SheetNames.length;++ye){var Le=U.Sheets[U.SheetNames[ye]];if(!(!Le||!Le["!ref"])){for(var De=Ws(Le["!ref"]),Ve=Array.isArray(Le),et=[],Nt=Math.min(De.e.r,8191),ot=De.s.r;ot<=Nt;++ot)for(var Qt=Mr(ot),qe=De.s.c;qe<=De.e.c;++qe){ot===De.s.r&&(et[qe]=Wr(qe));var Me=et[qe]+Qt,mt=Ve?(Le[ot]||[])[qe]:Le[Me];if(!(!mt||mt.t=="z"))if(mt.t=="n")It(ae,23,X(ot,qe,Ee,mt.v));else{var it=Wa(mt);It(ae,22,M(ot,qe,Ee,it.slice(0,239)))}}++Ee}}return It(ae,1),ae.end()}function l(U){var ce=st(2);return ce.write_shift(2,U),ce}function c(U){var ce=st(26);ce.write_shift(2,4096),ce.write_shift(2,4),ce.write_shift(4,0);for(var z=0,ae=0,ye=0,fe=0;fe<U.SheetNames.length;++fe){var Ee=U.SheetNames[fe],Le=U.Sheets[Ee];if(!(!Le||!Le["!ref"])){++ye;var De=En(Le["!ref"]);z<De.e.r&&(z=De.e.r),ae<De.e.c&&(ae=De.e.c)}}return z>8191&&(z=8191),ce.write_shift(2,z),ce.write_shift(1,ye),ce.write_shift(1,ae),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(1,1),ce.write_shift(1,2),ce.write_shift(4,0),ce.write_shift(4,0),ce}function u(U,ce,z){var ae={s:{c:0,r:0},e:{c:0,r:0}};return ce==8&&z.qpro?(ae.s.c=U.read_shift(1),U.l++,ae.s.r=U.read_shift(2),ae.e.c=U.read_shift(1),U.l++,ae.e.r=U.read_shift(2),ae):(ae.s.c=U.read_shift(2),ae.s.r=U.read_shift(2),ce==12&&z.qpro&&(U.l+=2),ae.e.c=U.read_shift(2),ae.e.r=U.read_shift(2),ce==12&&z.qpro&&(U.l+=2),ae.s.c==65535&&(ae.s.c=ae.e.c=ae.s.r=ae.e.r=0),ae)}function f(U){var ce=st(8);return ce.write_shift(2,U.s.c),ce.write_shift(2,U.s.r),ce.write_shift(2,U.e.c),ce.write_shift(2,U.e.r),ce}function h(U,ce,z){var ae=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(ae[0].c=U.read_shift(1),ae[3]=U.read_shift(1),ae[0].r=U.read_shift(2),U.l+=2):(ae[2]=U.read_shift(1),ae[0].c=U.read_shift(2),ae[0].r=U.read_shift(2)),ae}function v(U,ce,z){var ae=U.l+ce,ye=h(U,ce,z);if(ye[1].t="s",z.vers==20768){U.l++;var fe=U.read_shift(1);return ye[1].v=U.read_shift(fe,"utf8"),ye}return z.qpro&&U.l++,ye[1].v=U.read_shift(ae-U.l,"cstr"),ye}function w(U,ce,z){var ae=st(7+z.length);ae.write_shift(1,255),ae.write_shift(2,ce),ae.write_shift(2,U),ae.write_shift(1,39);for(var ye=0;ye<ae.length;++ye){var fe=z.charCodeAt(ye);ae.write_shift(1,fe>=128?95:fe)}return ae.write_shift(1,0),ae}function j(U,ce,z){var ae=h(U,ce,z);return ae[1].v=U.read_shift(2,"i"),ae}function C(U,ce,z){var ae=st(7);return ae.write_shift(1,255),ae.write_shift(2,ce),ae.write_shift(2,U),ae.write_shift(2,z,"i"),ae}function k(U,ce,z){var ae=h(U,ce,z);return ae[1].v=U.read_shift(8,"f"),ae}function S(U,ce,z){var ae=st(13);return ae.write_shift(1,255),ae.write_shift(2,ce),ae.write_shift(2,U),ae.write_shift(8,z,"f"),ae}function _(U,ce,z){var ae=U.l+ce,ye=h(U,ce,z);if(ye[1].v=U.read_shift(8,"f"),z.qpro)U.l=ae;else{var fe=U.read_shift(2);q(U.slice(U.l,U.l+fe),ye),U.l+=fe}return ye}function I(U,ce,z){var ae=ce&32768;return ce&=-32769,ce=(ae?U:0)+(ce>=8192?ce-16384:ce),(ae?"":"$")+(z?Wr(ce):Mr(ce))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},B=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function q(U,ce){Nn(U,0);for(var z=[],ae=0,ye="",fe="",Ee="",Le="";U.l<U.length;){var De=U[U.l++];switch(De){case 0:z.push(U.read_shift(8,"f"));break;case 1:fe=I(ce[0].c,U.read_shift(2),!0),ye=I(ce[0].r,U.read_shift(2),!1),z.push(fe+ye);break;case 2:{var Ve=I(ce[0].c,U.read_shift(2),!0),et=I(ce[0].r,U.read_shift(2),!1);fe=I(ce[0].c,U.read_shift(2),!0),ye=I(ce[0].r,U.read_shift(2),!1),z.push(Ve+et+":"+fe+ye)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(U.read_shift(2));break;case 6:{for(var Nt="";De=U[U.l++];)Nt+=String.fromCharCode(De);z.push('"'+Nt.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:Le=z.pop(),Ee=z.pop(),z.push(["AND","OR"][De-20]+"("+Ee+","+Le+")");break;default:if(De<32&&B[De])Le=z.pop(),Ee=z.pop(),z.push(Ee+B[De]+Le);else if(F[De]){if(ae=F[De][1],ae==69&&(ae=U[U.l++]),ae>z.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+z.join("|")+"|");return}var ot=z.slice(-ae);z.length-=ae,z.push(F[De][0]+"("+ot.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}z.length==1?ce[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function me(U){var ce=[{c:0,r:0},{t:"n",v:0},0];return ce[0].r=U.read_shift(2),ce[3]=U[U.l++],ce[0].c=U[U.l++],ce}function re(U,ce){var z=me(U);return z[1].t="s",z[1].v=U.read_shift(ce-4,"cstr"),z}function M(U,ce,z,ae){var ye=st(6+ae.length);ye.write_shift(2,U),ye.write_shift(1,z),ye.write_shift(1,ce),ye.write_shift(1,39);for(var fe=0;fe<ae.length;++fe){var Ee=ae.charCodeAt(fe);ye.write_shift(1,Ee>=128?95:Ee)}return ye.write_shift(1,0),ye}function W(U,ce){var z=me(U);z[1].v=U.read_shift(2);var ae=z[1].v>>1;if(z[1].v&1)switch(ae&7){case 0:ae=(ae>>3)*5e3;break;case 1:ae=(ae>>3)*500;break;case 2:ae=(ae>>3)/20;break;case 3:ae=(ae>>3)/200;break;case 4:ae=(ae>>3)/2e3;break;case 5:ae=(ae>>3)/2e4;break;case 6:ae=(ae>>3)/16;break;case 7:ae=(ae>>3)/64;break}return z[1].v=ae,z}function oe(U,ce){var z=me(U),ae=U.read_shift(4),ye=U.read_shift(4),fe=U.read_shift(2);if(fe==65535)return ae===0&&ye===3221225472?(z[1].t="e",z[1].v=15):ae===0&&ye===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var Ee=fe&32768;return fe=(fe&32767)-16446,z[1].v=(1-Ee*2)*(ye*Math.pow(2,fe+32)+ae*Math.pow(2,fe)),z}function X(U,ce,z,ae){var ye=st(14);if(ye.write_shift(2,U),ye.write_shift(1,z),ye.write_shift(1,ce),ae==0)return ye.write_shift(4,0),ye.write_shift(4,0),ye.write_shift(2,65535),ye;var fe=0,Ee=0,Le=0,De=0;return ae<0&&(fe=1,ae=-ae),Ee=Math.log2(ae)|0,ae/=Math.pow(2,Ee-31),De=ae>>>0,(De&2147483648)==0&&(ae/=2,++Ee,De=ae>>>0),ae-=De,De|=2147483648,De>>>=0,ae*=Math.pow(2,32),Le=ae>>>0,ye.write_shift(4,Le),ye.write_shift(4,De),Ee+=16383+(fe?32768:0),ye.write_shift(2,Ee),ye}function he(U,ce){var z=oe(U);return U.l+=ce-14,z}function ue(U,ce){var z=me(U),ae=U.read_shift(4);return z[1].v=ae>>6,z}function _e(U,ce){var z=me(U),ae=U.read_shift(8,"f");return z[1].v=ae,z}function ke(U,ce){var z=_e(U);return U.l+=ce-10,z}function Re(U,ce){return U[U.l+ce-1]==0?U.read_shift(ce,"cstr"):""}function Y(U,ce){var z=U[U.l++];z>ce-1&&(z=ce-1);for(var ae="";ae.length<z;)ae+=String.fromCharCode(U[U.l++]);return ae}function ve(U,ce,z){if(!(!z.qpro||ce<21)){var ae=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var ye=U.read_shift(ce-21,"cstr");return[ae,ye]}}function Q(U,ce){for(var z={},ae=U.l+ce;U.l<ae;){var ye=U.read_shift(2);if(ye==14e3){for(z[ye]=[0,""],z[ye][0]=U.read_shift(2);U[U.l];)z[ye][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return z}function be(U,ce){var z=st(5+U.length);z.write_shift(2,14e3),z.write_shift(2,ce);for(var ae=0;ae<U.length;++ae){var ye=U.charCodeAt(ae);z[z.l++]=ye>127?95:ye}return z[z.l++]=0,z}var pe={0:{n:"BOF",f:CS},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:j},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:v},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:v},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Re},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},ne={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:re},23:{n:"NUMBER17",f:oe},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:he},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ue},38:{n:"??"},39:{n:"NUMBER27",f:_e},40:{n:"FORMULA28",f:ke},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ve},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:s}})(),dM=/^\s|\s$|[\t\n\r]/;function OS(t,s){if(!s.bookSST)return"";var r=[vr];r[r.length]=Ft("sst",null,{xmlns:xo[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],l="<si>";a.r?l+=a.r:(l+="<t",a.t||(a.t=""),a.t.match(dM)&&(l+=' xml:space="preserve"'),l+=">"+Fs(a.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function uM(t){return[t.read_shift(4),t.read_shift(4)]}function mM(t,s){return s||(s=st(8)),s.write_shift(4,t.Count),s.write_shift(4,t.Unique),s}var pM=rF;function xM(t){var s=pn();dt(s,159,mM(t));for(var r=0;r<t.length;++r)dt(s,19,pM(t[r]));return dt(s,160),s.end()}function hM(t){for(var s=[],r=t.split(""),n=0;n<r.length;++n)s[n]=r[n].charCodeAt(0);return s}function RS(t){var s=0,r,n=hM(t),a=n.length+1,l,c,u,f,h;for(r=rl(a),r[0]=n.length,l=1;l!=a;++l)r[l]=n[l-1];for(l=a-1;l>=0;--l)c=r[l],u=(s&16384)===0?0:1,f=s<<1&32767,h=u|f,s=h^c;return s^52811}var fM=(function(){function t(a,l){switch(l.type){case"base64":return s(Va(a),l);case"binary":return s(a,l);case"buffer":return s(As&&Buffer.isBuffer(a)?a.toString("binary"):Qc(a),l);case"array":return s(Rm(a),l)}throw new Error("Unrecognized type "+l.type)}function s(a,l){var c=l||{},u=c.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(v,w){Array.isArray(u)&&(u[w]=[]);for(var j=/\\\w+\b/g,C=0,k,S=-1;k=j.exec(v);){switch(k[0]){case"\\cell":var _=v.slice(C,j.lastIndex-k[0].length);if(_[0]==" "&&(_=_.slice(1)),++S,_.length){var I={v:_,t:"s"};Array.isArray(u)?u[w][S]=I:u[Ms({r:w,c:S})]=I}break}C=j.lastIndex}S>h.e.c&&(h.e.c=S)}),u["!ref"]=gr(h),u}function r(a,l){return il(t(a,l),l)}function n(a){for(var l=["{\\rtf1\\ansi"],c=Ws(a["!ref"]),u,f=Array.isArray(a),h=c.s.r;h<=c.e.r;++h){l.push("\\trowd\\trautofit1");for(var v=c.s.c;v<=c.e.c;++v)l.push("\\cellx"+(v+1));for(l.push("\\pard\\intbl"),v=c.s.c;v<=c.e.c;++v){var w=Ms({r:h,c:v});u=f?(a[h]||[])[v]:a[w],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(Wa(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function $b(t){for(var s=0,r=1;s!=3;++s)r=r*256+(t[s]>255?255:t[s]<0?0:t[s]);return r.toString(16).toUpperCase().slice(1)}var gM=6,za=gM;function Ju(t){return Math.floor((t+Math.round(128/za)/256)*za)}function Zu(t){return Math.floor((t-5)/za*100+.5)/100}function Px(t){return Math.round((t*za+5)/za*256)/256}function qh(t){t.width?(t.wpx=Ju(t.width),t.wch=Zu(t.wpx),t.MDW=za):t.wpx?(t.wch=Zu(t.wpx),t.width=Px(t.wch),t.MDW=za):typeof t.wch=="number"&&(t.width=Px(t.wch),t.wpx=Ju(t.width),t.MDW=za),t.customWidth&&delete t.customWidth}var yM=96,DS=yM;function em(t){return t*96/DS}function LS(t){return t*DS/96}function vM(t){var s=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(s[s.length]=Ft("numFmt",null,{numFmtId:n,formatCode:Fs(t[n])}))}),s.length===1?"":(s[s.length]="</numFmts>",s[0]=Ft("numFmts",null,{count:s.length-2}).replace("/>",">"),s.join(""))}function bM(t){var s=[];return s[s.length]=Ft("cellXfs",null),t.forEach(function(r){s[s.length]=Ft("xf",null,r)}),s[s.length]="</cellXfs>",s.length===2?"":(s[0]=Ft("cellXfs",null,{count:s.length-2}).replace("/>",">"),s.join(""))}function FS(t,s){var r=[vr,Ft("styleSheet",null,{xmlns:xo[0],"xmlns:vt":Er.vt})],n;return t.SSF&&(n=vM(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=bM(s.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function wM(t,s){var r=t.read_shift(2),n=Gr(t);return[r,n]}function NM(t,s,r){r||(r=st(6+4*s.length)),r.write_shift(2,t),Ar(s,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function jM(t,s,r){var n={};n.sz=t.read_shift(2)/20;var a=dF(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var l=t.read_shift(2);switch(l===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=t.read_shift(1);c!=0&&(n.underline=c);var u=t.read_shift(1);u>0&&(n.family=u);var f=t.read_shift(1);switch(f>0&&(n.charset=f),t.l++,n.color=cF(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Gr(t),n}function SM(t,s){s||(s=st(153)),s.write_shift(2,t.sz*20),uF(t,s),s.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),s.write_shift(2,r),s.write_shift(1,t.underline||0),s.write_shift(1,t.family||0),s.write_shift(1,t.charset||0),s.write_shift(1,0),Ku(t.color,s);var n=0;return n=2,s.write_shift(1,n),Ar(t.name,s),s.length>s.l?s.slice(0,s.l):s}var kM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],K0,CM=Na;function Qb(t,s){s||(s=st(84)),K0||(K0=_h(kM));var r=K0[t.patternType];r==null&&(r=40),s.write_shift(4,r);var n=0;if(r!=40)for(Ku({auto:1},s),Ku({auto:1},s);n<12;++n)s.write_shift(4,0);else{for(;n<4;++n)s.write_shift(4,0);for(;n<12;++n)s.write_shift(4,0)}return s.length>s.l?s.slice(0,s.l):s}function _M(t,s){var r=t.l+s,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function MS(t,s,r){r||(r=st(16)),r.write_shift(2,s||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function rc(t,s){return s||(s=st(10)),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(4,0),s.write_shift(4,0),s}var EM=Na;function PM(t,s){return s||(s=st(51)),s.write_shift(1,0),rc(null,s),rc(null,s),rc(null,s),rc(null,s),rc(null,s),s.length>s.l?s.slice(0,s.l):s}function AM(t,s){return s||(s=st(52)),s.write_shift(4,t.xfId),s.write_shift(2,1),s.write_shift(1,0),s.write_shift(1,0),Yu(t.name||"",s),s.length>s.l?s.slice(0,s.l):s}function TM(t,s,r){var n=st(2052);return n.write_shift(4,t),Yu(s,n),Yu(r,n),n.length>n.l?n.slice(0,n.l):n}function OM(t,s){if(s){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)s[a]!=null&&++r}),r!=0&&(dt(t,615,Xn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)s[a]!=null&&dt(t,44,NM(a,s[a]))}),dt(t,616))}}function RM(t){var s=1;dt(t,611,Xn(s)),dt(t,43,SM({sz:12,color:{theme:1},name:"Calibri",family:2})),dt(t,612)}function DM(t){var s=2;dt(t,603,Xn(s)),dt(t,45,Qb({patternType:"none"})),dt(t,45,Qb({patternType:"gray125"})),dt(t,604)}function LM(t){var s=1;dt(t,613,Xn(s)),dt(t,46,PM()),dt(t,614)}function FM(t){var s=1;dt(t,626,Xn(s)),dt(t,47,MS({numFmtId:0},65535)),dt(t,627)}function MM(t,s){dt(t,617,Xn(s.length)),s.forEach(function(r){dt(t,47,MS(r,0))}),dt(t,618)}function IM(t){var s=1;dt(t,619,Xn(s)),dt(t,48,AM({xfId:0,name:"Normal"})),dt(t,620)}function qM(t){var s=0;dt(t,505,Xn(s)),dt(t,506)}function BM(t){var s=0;dt(t,508,TM(s,"TableStyleMedium9","PivotStyleMedium4")),dt(t,509)}function zM(t,s){var r=pn();return dt(r,278),OM(r,t.SSF),RM(r),DM(r),LM(r),FM(r),MM(r,s.cellXfs),IM(r),qM(r),BM(r),dt(r,279),r.end()}function IS(t,s){if(s&&s.themeXLSX)return s.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[vr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function $M(t,s){return{flags:t.read_shift(4),version:t.read_shift(4),name:Gr(t)}}function QM(t){var s=st(12+2*t.name.length);return s.write_shift(4,t.flags),s.write_shift(4,t.version),Ar(t.name,s),s.slice(0,s.l)}function UM(t){for(var s=[],r=t.read_shift(4);r-- >0;)s.push([t.read_shift(4),t.read_shift(4)]);return s}function VM(t){var s=st(4+8*t.length);s.write_shift(4,t.length);for(var r=0;r<t.length;++r)s.write_shift(4,t[r][0]),s.write_shift(4,t[r][1]);return s}function WM(t,s){var r=st(8+2*s.length);return r.write_shift(4,t),Ar(s,r),r.slice(0,r.l)}function GM(t){return t.l+=4,t.read_shift(4)!=0}function HM(t,s){var r=st(8);return r.write_shift(4,t),r.write_shift(4,1),r}function YM(){var t=pn();return dt(t,332),dt(t,334,Xn(1)),dt(t,335,QM({name:"XLDAPR",version:12e4,flags:3496657072})),dt(t,336),dt(t,339,WM(1,"XLDAPR")),dt(t,52),dt(t,35,Xn(514)),dt(t,4096,Xn(0)),dt(t,4097,Mn(1)),dt(t,36),dt(t,53),dt(t,340),dt(t,337,HM(1)),dt(t,51,VM([[1,0]])),dt(t,338),dt(t,333),t.end()}function qS(){var t=[vr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function KM(t){var s={};s.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),s.r=Ms(r);var n=t.read_shift(1);return n&2&&(s.l="1"),n&8&&(s.a="1"),s}var Ul=1024;function BS(t,s){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ft("xml",null,{"xmlns:v":Sn.v,"xmlns:o":Sn.o,"xmlns:x":Sn.x,"xmlns:mv":Sn.mv}).replace(/\/>/,">"),Ft("o:shapelayout",Ft("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ft("v:shapetype",[Ft("v:stroke",null,{joinstyle:"miter"}),Ft("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ul<t*1e3;)Ul+=1e3;return s.forEach(function(l){var c=Pr(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?Ft("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ft("v:fill",f,u),v={on:"t",obscured:"t"};++Ul,a=a.concat(["<v:shape"+wc({id:"_x0000_s"+Ul,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ft("v:shadow",null,v),Ft("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Fr("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),Fr("x:AutoFill","False"),Fr("x:Row",String(c.r)),Fr("x:Column",String(c.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function zS(t){var s=[vr,Ft("comments",null,{xmlns:xo[0]})],r=[];return s.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var l=Fs(a.a);r.indexOf(l)==-1&&(r.push(l),s.push("<author>"+l+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),s.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),s.push("<author>SheetJ5</author>")),s.push("</authors>"),s.push("<commentList>"),t.forEach(function(n){var a=0,l=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=r.indexOf(Fs(f.a))),l.push(f.t||"")}),s.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),l.length<=1)s.push(Fr("t",Fs(l[0]||"")));else{for(var c=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)c+=`Reply:
    `+l[u]+`
`;s.push(Fr("t",Fs(c)))}s.push("</text></comment>")}),s.push("</commentList>"),s.length>2&&(s[s.length]="</comments>",s[1]=s[1].replace("/>",">")),s.join("")}function XM(t,s,r){var n=[vr,Ft("ThreadedComments",null,{xmlns:Er.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var l="";(a[1]||[]).forEach(function(c,u){if(!c.T){delete c.ID;return}c.a&&s.indexOf(c.a)==-1&&s.push(c.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?l=f.id:f.parentId=l,c.ID=f.id,c.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+s.indexOf(c.a)).slice(-12)+"}"),n.push(Ft("threadedComment",Fr("text",c.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function JM(t){var s=[vr,Ft("personList",null,{xmlns:Er.TCMNT,"xmlns:x":xo[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){s.push(Ft("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),s.push("</personList>"),s.join("")}function ZM(t){var s={};s.iauthor=t.read_shift(4);var r=dl(t);return s.rfx=r.s,s.ref=Ms(r.s),t.l+=16,s}function eI(t,s){return s==null&&(s=st(36)),s.write_shift(4,t[1].iauthor),fo(t[0],s),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s}var tI=Gr;function sI(t){return Ar(t.slice(0,54))}function rI(t){var s=pn(),r=[];return dt(s,628),dt(s,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),dt(s,632,sI(a.a)))})}),dt(s,631),dt(s,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var l={s:Pr(n[0]),e:Pr(n[0])};dt(s,635,eI([l,a])),a.t&&a.t.length>0&&dt(s,637,aF(a)),dt(s,636),delete a.iauthor})}),dt(s,634),dt(s,629),s.end()}function nI(t,s){s.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Is.utils.cfb_add(t,a,s.FileIndex[n].content)}})}var $S=["xlsb","xlsm","xlam","biff8","xla"],aI=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,s={r:0,c:0};function r(n,a,l,c){var u=!1,f=!1;l.length==0?f=!0:l.charAt(0)=="["&&(f=!0,l=l.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var h=l.length>0?parseInt(l,10)|0:0,v=c.length>0?parseInt(c,10)|0:0;return u?v+=s.c:--v,f?h+=s.r:--h,a+(u?"":"$")+Wr(v)+(f?"":"$")+Mr(h)}return function(a,l){return s=l,a.replace(t,r)}})(),Bh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,zh=(function(){return function(s,r){return s.replace(Bh,function(n,a,l,c,u,f){var h=Dh(c)-(l?0:r.c),v=Rh(f)-(u?0:r.r),w=v==0?"":u?v+1:"["+v+"]",j=h==0?"":l?h+1:"["+h+"]";return a+"R"+w+"C"+j})}})();function iI(t,s){return t.replace(Bh,function(r,n,a,l,c,u){return n+(a=="$"?a+l:Wr(Dh(l)+s.c))+(c=="$"?c+u:Mr(Rh(u)+s.r))})}function lI(t){return t.length!=1}function fr(t){t.l+=1}function ki(t,s){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function QS(t,s,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return US(t);r.biff==12&&(n=4)}var a=t.read_shift(n),l=t.read_shift(n),c=ki(t),u=ki(t);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function US(t){var s=ki(t),r=ki(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:s[0],c:n,cRel:s[1],rRel:s[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function oI(t,s,r){if(r.biff<8)return US(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),l=ki(t),c=ki(t);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function VS(t,s,r){if(r&&r.biff>=2&&r.biff<=5)return cI(t);var n=t.read_shift(r&&r.biff==12?4:2),a=ki(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function cI(t){var s=ki(t),r=t.read_shift(1);return{r:s[0],c:r,cRel:s[1],rRel:s[2]}}function dI(t){var s=t.read_shift(2),r=t.read_shift(2);return{r:s,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function uI(t,s,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return mI(t);var a=t.read_shift(n>=12?4:2),l=t.read_shift(2),c=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;a>524287;)a-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:a,c:l,cRel:c,rRel:u}}function mI(t){var s=t.read_shift(2),r=t.read_shift(1),n=(s&32768)>>15,a=(s&16384)>>14;return s&=16383,n==1&&s>=8192&&(s=s-16384),a==1&&r>=128&&(r=r-256),{r:s,c:r,cRel:a,rRel:n}}function pI(t,s,r){var n=(t[t.l++]&96)>>5,a=QS(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function xI(t,s,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:t.l+=12,l=6;break;case 12:l=12;break}var c=QS(t,l,r);return[n,a,c]}function hI(t,s,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function fI(t,s,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),l=8;if(r)switch(r.biff){case 5:t.l+=12,l=6;break;case 12:l=12;break}return t.l+=l,[n,a]}function gI(t,s,r){var n=(t[t.l++]&96)>>5,a=oI(t,s-1,r);return[n,a]}function yI(t,s,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Ub(t){var s=t[t.l+1]&1,r=1;return t.l+=4,[s,r]}function vI(t,s,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],l=0;l<=n;++l)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function bI(t,s,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function wI(t,s,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function NI(t){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(2)]}function jI(t,s,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function WS(t){var s=t.read_shift(1),r=t.read_shift(1);return[s,r]}function SI(t){return t.read_shift(2),WS(t)}function kI(t){return t.read_shift(2),WS(t)}function CI(t,s,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=VS(t,0,r);return[n,a]}function _I(t,s,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=uI(t,0,r);return[n,a]}function EI(t,s,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var l=VS(t,0,r);return[n,a,l]}function PI(t,s,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[P6[a],YS[a],n]}function AI(t,s,r){var n=t[t.l++],a=t.read_shift(1),l=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:TI(t);return[a,(l[0]===0?YS:E6)[l[1]]]}function TI(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function OI(t,s,r){t.l+=r&&r.biff==2?3:4}function RI(t,s,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function DI(t){return t.l++,Wc[t.read_shift(1)]}function LI(t){return t.l++,t.read_shift(2)}function FI(t){return t.l++,t.read_shift(1)!==0}function MI(t){return t.l++,go(t)}function II(t,s,r){return t.l++,ES(t,s-1,r)}function qI(t,s){var r=[t.read_shift(1)];if(s==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=EF(t,1)?"TRUE":"FALSE",s!=12&&(t.l+=7);break;case 37:case 16:r[1]=Wc[t[t.l]],t.l+=s==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=go(t);break;case 2:r[1]=OF(t,0,{biff:s>0&&s<8?2:s});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function BI(t,s,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],l=0;l!=n;++l)a.push((r.biff==12?dl:LF)(t));return a}function zI(t,s,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var l=0,c=[];l!=n&&(c[l]=[]);++l)for(var u=0;u!=a;++u)c[l][u]=qI(t,r.biff);return c}function $I(t,s,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,l=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,l]}function QI(t,s,r){if(r.biff==5)return UI(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),l=t.read_shift(4);return[n,a,l]}function UI(t){var s=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[s,r,n]}function VI(t,s,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function WI(t,s,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function GI(t,s,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function HI(t,s,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return t.l+=l,[n,a]}var YI=Na,KI=Na,XI=Na;function Gc(t,s,r){return t.l+=2,[dI(t)]}function $h(t){return t.l+=6,[]}var JI=Gc,ZI=$h,e6=$h,t6=Gc;function GS(t){return t.l+=2,[CS(t),t.read_shift(2)&1]}var s6=Gc,r6=GS,n6=$h,a6=Gc,i6=Gc,l6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function o6(t){t.l+=2;var s=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),l=t.read_shift(2),c=l6[r>>2&31];return{ixti:s,coltype:r&3,rt:c,idx:n,c:a,C:l}}function c6(t){return t.l+=2,[t.read_shift(4)]}function d6(t,s,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function u6(t,s,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function m6(t){var s=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[s,r]}function p6(t){var s=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[s,r]}function x6(t){return t.l+=4,[0,0]}var Vb={1:{n:"PtgExp",f:RI},2:{n:"PtgTbl",f:XI},3:{n:"PtgAdd",f:fr},4:{n:"PtgSub",f:fr},5:{n:"PtgMul",f:fr},6:{n:"PtgDiv",f:fr},7:{n:"PtgPower",f:fr},8:{n:"PtgConcat",f:fr},9:{n:"PtgLt",f:fr},10:{n:"PtgLe",f:fr},11:{n:"PtgEq",f:fr},12:{n:"PtgGe",f:fr},13:{n:"PtgGt",f:fr},14:{n:"PtgNe",f:fr},15:{n:"PtgIsect",f:fr},16:{n:"PtgUnion",f:fr},17:{n:"PtgRange",f:fr},18:{n:"PtgUplus",f:fr},19:{n:"PtgUminus",f:fr},20:{n:"PtgPercent",f:fr},21:{n:"PtgParen",f:fr},22:{n:"PtgMissArg",f:fr},23:{n:"PtgStr",f:II},26:{n:"PtgSheet",f:d6},27:{n:"PtgEndSheet",f:u6},28:{n:"PtgErr",f:DI},29:{n:"PtgBool",f:FI},30:{n:"PtgInt",f:LI},31:{n:"PtgNum",f:MI},32:{n:"PtgArray",f:yI},33:{n:"PtgFunc",f:PI},34:{n:"PtgFuncVar",f:AI},35:{n:"PtgName",f:$I},36:{n:"PtgRef",f:CI},37:{n:"PtgArea",f:pI},38:{n:"PtgMemArea",f:VI},39:{n:"PtgMemErr",f:YI},40:{n:"PtgMemNoMem",f:KI},41:{n:"PtgMemFunc",f:WI},42:{n:"PtgRefErr",f:GI},43:{n:"PtgAreaErr",f:hI},44:{n:"PtgRefN",f:_I},45:{n:"PtgAreaN",f:gI},46:{n:"PtgMemAreaN",f:m6},47:{n:"PtgMemNoMemN",f:p6},57:{n:"PtgNameX",f:QI},58:{n:"PtgRef3d",f:EI},59:{n:"PtgArea3d",f:xI},60:{n:"PtgRefErr3d",f:HI},61:{n:"PtgAreaErr3d",f:fI},255:{}},h6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},f6={1:{n:"PtgElfLel",f:GS},2:{n:"PtgElfRw",f:a6},3:{n:"PtgElfCol",f:JI},6:{n:"PtgElfRwV",f:i6},7:{n:"PtgElfColV",f:t6},10:{n:"PtgElfRadical",f:s6},11:{n:"PtgElfRadicalS",f:n6},13:{n:"PtgElfColS",f:ZI},15:{n:"PtgElfColSV",f:e6},16:{n:"PtgElfRadicalLel",f:r6},25:{n:"PtgList",f:o6},29:{n:"PtgSxName",f:c6},255:{}},g6={0:{n:"PtgAttrNoop",f:x6},1:{n:"PtgAttrSemi",f:jI},2:{n:"PtgAttrIf",f:wI},4:{n:"PtgAttrChoose",f:vI},8:{n:"PtgAttrGoto",f:bI},16:{n:"PtgAttrSum",f:OI},32:{n:"PtgAttrBaxcel",f:Ub},33:{n:"PtgAttrBaxcel",f:Ub},64:{n:"PtgAttrSpace",f:SI},65:{n:"PtgAttrSpaceSemi",f:kI},128:{n:"PtgAttrIfError",f:NI},255:{}};function y6(t,s,r,n){if(n.biff<8)return Na(t,s);for(var a=t.l+s,l=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=zI(t,0,n),l.push(r[c][1]);break;case"PtgMemArea":r[c][2]=BI(t,r[c][1],n),l.push(r[c][2]);break;case"PtgExp":n&&n.biff==12&&(r[c][1][1]=t.read_shift(4),l.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return s=a-t.l,s!==0&&l.push(Na(t,s)),l}function v6(t,s,r){for(var n=t.l+s,a,l,c=[];n!=t.l;)s=n-t.l,l=t[t.l],a=Vb[l]||Vb[h6[l]],(l===24||l===25)&&(a=(l===24?f6:g6)[t[t.l+1]]),!a||!a.f?Na(t,s):c.push([a.n,a.f(t,s,r)]);return c}function b6(t){for(var s=[],r=0;r<t.length;++r){for(var n=t[r],a=[],l=0;l<n.length;++l){var c=n[l];if(c)switch(c[0]){case 2:a.push('"'+c[1].replace(/"/g,'""')+'"');break;default:a.push(c[1])}else a.push("")}s.push(a.join(","))}return s.join(";")}var w6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function N6(t,s){if(!t&&!(s&&s.biff<=5&&s.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function HS(t,s,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[s]))return t.SheetNames[s];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[s];if(r.biff<8)return s>1e4&&(s-=65536),s<0&&(s=-s),s==0?"":t.XTI[s-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Wb(t,s,r){var n=HS(t,s,r);return n=="#REF"?n:N6(n,r)}function to(t,s,r,n,a){var l=a&&a.biff||8,c={s:{c:0,r:0}},u=[],f,h,v,w=0,j=0,C,k="";if(!t[0]||!t[0][0])return"";for(var S=-1,_="",I=0,F=t[0].length;I<F;++I){var B=t[0][I];switch(B[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),h=u.pop(),S>=0){switch(t[0][S][1][0]){case 0:_=tr(" ",t[0][S][1][1]);break;case 1:_=tr("\r",t[0][S][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}h=h+_,S=-1}u.push(h+w6[B[0]]+f);break;case"PtgIsect":f=u.pop(),h=u.pop(),u.push(h+" "+f);break;case"PtgUnion":f=u.pop(),h=u.pop(),u.push(h+","+f);break;case"PtgRange":f=u.pop(),h=u.pop(),u.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":v=dc(B[1][1],c,a),u.push(uc(v,l));break;case"PtgRefN":v=r?dc(B[1][1],r,a):B[1][1],u.push(uc(v,l));break;case"PtgRef3d":w=B[1][1],v=dc(B[1][2],c,a),k=Wb(n,w,a),u.push(k+"!"+uc(v,l));break;case"PtgFunc":case"PtgFuncVar":var q=B[1][0],me=B[1][1];q||(q=0),q&=127;var re=q==0?[]:u.slice(-q);u.length-=q,me==="User"&&(me=re.shift()),u.push(me+"("+re.join(",")+")");break;case"PtgBool":u.push(B[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(B[1]);break;case"PtgNum":u.push(String(B[1]));break;case"PtgStr":u.push('"'+B[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(B[1]);break;case"PtgAreaN":C=Ab(B[1][1],r?{s:r}:c,a),u.push(H0(C,a));break;case"PtgArea":C=Ab(B[1][1],c,a),u.push(H0(C,a));break;case"PtgArea3d":w=B[1][1],C=B[1][2],k=Wb(n,w,a),u.push(k+"!"+H0(C,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":j=B[1][2];var M=(n.names||[])[j-1]||(n[0]||[])[j],W=M?M.Name:"SH33TJSNAME"+String(j);W&&W.slice(0,6)=="_xlfn."&&!a.xlfn&&(W=W.slice(6)),u.push(W);break;case"PtgNameX":var oe=B[1][1];j=B[1][2];var X;if(a.biff<=5)oe<0&&(oe=-oe),n[oe]&&(X=n[oe][j]);else{var he="";if(((n[oe]||[])[0]||[])[0]==14849||(((n[oe]||[])[0]||[])[0]==1025?n[oe][j]&&n[oe][j].itab>0&&(he=n.SheetNames[n[oe][j].itab-1]+"!"):he=n.SheetNames[j-1]+"!"),n[oe]&&n[oe][j])he+=n[oe][j].Name;else if(n[0]&&n[0][j])he+=n[0][j].Name;else{var ue=(HS(n,oe,a)||"").split(";;");ue[j-1]?he=ue[j-1]:he+="SH33TJSERRX"}u.push(he);break}X||(X={Name:"SH33TJSERRY"}),u.push(X.Name);break;case"PtgParen":var _e="(",ke=")";if(S>=0){switch(_="",t[0][S][1][0]){case 2:_e=tr(" ",t[0][S][1][1])+_e;break;case 3:_e=tr("\r",t[0][S][1][1])+_e;break;case 4:ke=tr(" ",t[0][S][1][1])+ke;break;case 5:ke=tr("\r",t[0][S][1][1])+ke;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}S=-1}u.push(_e+u.pop()+ke);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":v={c:B[1][1],r:B[1][0]};var Re={c:r.c,r:r.r};if(n.sharedf[Ms(v)]){var Y=n.sharedf[Ms(v)];u.push(to(Y,c,Re,n,a))}else{var ve=!1;for(f=0;f!=n.arrayf.length;++f)if(h=n.arrayf[f],!(v.c<h[0].s.c||v.c>h[0].e.c)&&!(v.r<h[0].s.r||v.r>h[0].e.r)){u.push(to(h[1],c,Re,n,a)),ve=!0;break}ve||u.push(B[1])}break;case"PtgArray":u.push("{"+b6(B[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=I;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+B[1].idx+"[#"+B[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(B));default:throw new Error("Unrecognized Formula Token: "+String(B))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&S>=0&&Q.indexOf(t[0][I][0])==-1){B=t[0][S];var be=!0;switch(B[1][0]){case 4:be=!1;case 0:_=tr(" ",B[1][1]);break;case 5:be=!1;case 1:_=tr("\r",B[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+B[1][0])}u.push((be?_:"")+u.pop()+(be?"":_)),S=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function j6(t){if(t==null){var s=st(8);return s.write_shift(1,3),s.write_shift(1,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,65535),s}else if(typeof t=="number")return nl(t);return nl(0)}function S6(t,s,r,n,a){var l=al(s,r,a),c=j6(t.v),u=st(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var h=st(t.bf.length),v=0;v<t.bf.length;++v)h[v]=t.bf[v];var w=Lr([l,c,u,h]);return w}function Dm(t,s,r){var n=t.read_shift(4),a=v6(t,n,r),l=t.read_shift(4),c=l>0?y6(t,l,a,r):null;return[a,c]}var k6=Dm,Lm=Dm,C6=Dm,_6=Dm,E6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},YS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},P6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function A6(t){var s="of:="+t.replace(Bh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return s.replace(/;/g,"|").replace(/,/g,";")}function T6(t){return t.replace(/\./,"!")}var mc=typeof Map<"u";function Qh(t,s,r){var n=0,a=t.length;if(r){if(mc?r.has(s):Object.prototype.hasOwnProperty.call(r,s)){for(var l=mc?r.get(s):r[s];n<l.length;++n)if(t[l[n]].t===s)return t.Count++,l[n]}}else for(;n<a;++n)if(t[n].t===s)return t.Count++,n;return t[a]={t:s},t.Count++,t.Unique++,r&&(mc?(r.has(s)||r.set(s,[]),r.get(s).push(a)):(Object.prototype.hasOwnProperty.call(r,s)||(r[s]=[]),r[s].push(a))),a}function Fm(t,s){var r={min:t+1,max:t+1},n=-1;return s.MDW&&(za=s.MDW),s.width!=null?r.customWidth=1:s.wpx!=null?n=Zu(s.wpx):s.wch!=null&&(n=s.wch),n>-1?(r.width=Px(n),r.customWidth=1):s.width!=null&&(r.width=s.width),s.hidden&&(r.hidden=!0),s.level!=null&&(r.outlineLevel=r.level=s.level),r}function KS(t,s){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Ai(t,s,r){var n=r.revssf[s.z!=null?s.z:"General"],a=60,l=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Vj(s.z,a),r.ssf[a]=s.z,r.revssf[s.z]=n=a;break}}for(a=0;a!=l;++a)if(t[a].numFmtId===n)return a;return t[l]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function O6(t,s,r){if(t&&t["!ref"]){var n=Ws(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function R6(t){if(t.length===0)return"";for(var s='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)s+='<mergeCell ref="'+gr(t[r])+'"/>';return s+"</mergeCells>"}function D6(t,s,r,n,a){var l=!1,c={},u=null;if(n.bookType!=="xlsx"&&s.vbaraw){var f=s.SheetNames[r];try{s.Workbook&&(f=s.Workbook.Sheets[r].CodeName||f)}catch{}l=!0,c.codeName=bc(Fs(f))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),u=(u||"")+Ft("outlinePr",null,h)}!l&&!u||(a[a.length]=Ft("sheetPr",u,c))}var L6=["objects","scenarios","selectLockedCells","selectUnlockedCells"],F6=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function M6(t){var s={sheet:1};return L6.forEach(function(r){t[r]!=null&&t[r]&&(s[r]="1")}),F6.forEach(function(r){t[r]!=null&&!t[r]&&(s[r]="0")}),t.password&&(s.password=RS(t.password).toString(16).toUpperCase()),Ft("sheetProtection",null,s)}function I6(t){return KS(t),Ft("pageMargins",null,t)}function q6(t,s){for(var r=["<cols>"],n,a=0;a!=s.length;++a)(n=s[a])&&(r[r.length]=Ft("col",null,Fm(a,n)));return r[r.length]="</cols>",r.join("")}function B6(t,s,r,n){var a=typeof t.ref=="string"?t.ref:gr(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=En(a);c.s.r==c.e.r&&(c.e.r=En(s["!ref"]).e.r,a=gr(c));for(var u=0;u<l.length;++u){var f=l[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ft("autoFilter",null,{ref:a})}function z6(t,s,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ft("sheetViews",Ft("sheetView",null,a),{})}function $6(t,s,r,n){if(t.c&&r["!comments"].push([s,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",l=t.t,c=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Wc[t.v];break;case"d":n&&n.cellDates?a=en(t.v,-1).toISOString():(t=hn(t),t.t="n",a=""+(t.v=xn(en(t.v)))),typeof t.z>"u"&&(t.z=ir[14]);break;default:a=t.v;break}var u=Fr("v",Fs(a)),f={r:s},h=Ai(n.cellXfs,t,n);switch(h!==0&&(f.s=h),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=Fr("v",""+Qh(n.Strings,t.v,n.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=l&&(t.t=l,t.v=c),typeof t.f=="string"&&t.f){var v=t.F&&t.F.slice(0,s.length)==s?{t:"array",ref:t.F}:null;u=Ft("f",Fs(t.f),v)+(t.v!=null?u:"")}return t.l&&r["!links"].push([s,t.l]),t.D&&(f.cm=1),Ft("c",u,f)}function Q6(t,s,r,n){var a=[],l=[],c=Ws(t["!ref"]),u="",f,h="",v=[],w=0,j=0,C=t["!rows"],k=Array.isArray(t),S={r:h},_,I=-1;for(j=c.s.c;j<=c.e.c;++j)v[j]=Wr(j);for(w=c.s.r;w<=c.e.r;++w){for(l=[],h=Mr(w),j=c.s.c;j<=c.e.c;++j){f=v[j]+h;var F=k?(t[w]||[])[j]:t[f];F!==void 0&&(u=$6(F,f,t,s))!=null&&l.push(u)}(l.length>0||C&&C[w])&&(S={r:h},C&&C[w]&&(_=C[w],_.hidden&&(S.hidden=1),I=-1,_.hpx?I=em(_.hpx):_.hpt&&(I=_.hpt),I>-1&&(S.ht=I,S.customHeight=1),_.level&&(S.outlineLevel=_.level)),a[a.length]=Ft("row",l.join(""),S))}if(C)for(;w<C.length;++w)C&&C[w]&&(S={r:w+1},_=C[w],_.hidden&&(S.hidden=1),I=-1,_.hpx?I=em(_.hpx):_.hpt&&(I=_.hpt),I>-1&&(S.ht=I,S.customHeight=1),_.level&&(S.outlineLevel=_.level),a[a.length]=Ft("row","",S));return a.join("")}function XS(t,s,r,n){var a=[vr,Ft("worksheet",null,{xmlns:xo[0],"xmlns:r":Er.r})],l=r.SheetNames[t],c=0,u="",f=r.Sheets[l];f==null&&(f={});var h=f["!ref"]||"A1",v=Ws(h);if(v.e.c>16383||v.e.r>1048575){if(s.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");v.e.c=Math.min(v.e.c,16383),v.e.r=Math.min(v.e.c,1048575),h=gr(v)}n||(n={}),f["!comments"]=[];var w=[];D6(f,r,t,s,a),a[a.length]=Ft("dimension",null,{ref:h}),a[a.length]=z6(f,s,t,r),s.sheetFormat&&(a[a.length]=Ft("sheetFormatPr",null,{defaultRowHeight:s.sheetFormat.defaultRowHeight||"16",baseColWidth:s.sheetFormat.baseColWidth||"10",outlineLevelRow:s.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=q6(f,f["!cols"])),a[c=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=Q6(f,s),u.length>0&&(a[a.length]=u)),a.length>c+1&&(a[a.length]="</sheetData>",a[c]=a[c].replace("/>",">")),f["!protect"]&&(a[a.length]=M6(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=B6(f["!autofilter"],f,r,t)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=R6(f["!merges"]));var j=-1,C,k=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(S){S[1].Target&&(C={ref:S[0]},S[1].Target.charAt(0)!="#"&&(k=Ls(n,-1,Fs(S[1].Target).replace(/#.*$/,""),_s.HLINK),C["r:id"]="rId"+k),(j=S[1].Target.indexOf("#"))>-1&&(C.location=Fs(S[1].Target.slice(j+1))),S[1].Tooltip&&(C.tooltip=Fs(S[1].Tooltip)),a[a.length]=Ft("hyperlink",null,C))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=I6(f["!margins"])),(!s||s.ignoreEC||s.ignoreEC==null)&&(a[a.length]=Fr("ignoredErrors",Ft("ignoredError",null,{numberStoredAsText:1,sqref:h}))),w.length>0&&(k=Ls(n,-1,"../drawings/drawing"+(t+1)+".xml",_s.DRAW),a[a.length]=Ft("drawing",null,{"r:id":"rId"+k}),f["!drawing"]=w),f["!comments"].length>0&&(k=Ls(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",_s.VML),a[a.length]=Ft("legacyDrawing",null,{"r:id":"rId"+k}),f["!legacy"]=k),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function U6(t,s){var r={},n=t.l+s;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var l=t.read_shift(1);return t.l=n,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=a/20),r}function V6(t,s,r){var n=st(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var l=320;a.hpx?l=em(a.hpx)*20:a.hpt&&(l=a.hpt*20),n.write_shift(2,l),n.write_shift(1,0);var c=0;a.level&&(c|=a.level),a.hidden&&(c|=16),(a.hpx||a.hpt)&&(c|=32),n.write_shift(1,c),n.write_shift(1,0);var u=0,f=n.l;n.l+=4;for(var h={r:t,c:0},v=0;v<16;++v)if(!(s.s.c>v+1<<10||s.e.c<v<<10)){for(var w=-1,j=-1,C=v<<10;C<v+1<<10;++C){h.c=C;var k=Array.isArray(r)?(r[h.r]||[])[h.c]:r[Ms(h)];k&&(w<0&&(w=C),j=C)}w<0||(++u,n.write_shift(4,w),n.write_shift(4,j))}var S=n.l;return n.l=f,n.write_shift(4,u),n.l=S,n.length>n.l?n.slice(0,n.l):n}function W6(t,s,r,n){var a=V6(n,r,s);(a.length>17||(s["!rows"]||[])[n])&&dt(t,0,a)}var G6=dl,H6=fo;function Y6(){}function K6(t,s){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=iF(t),r}function X6(t,s,r){r==null&&(r=st(84+4*t.length));var n=192;s&&(s.above&&(n&=-65),s.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Ku({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),mS(t,r),r.slice(0,r.l)}function J6(t){var s=qn(t);return[s]}function Z6(t,s,r){return r==null&&(r=st(8)),ll(s,r)}function e8(t){var s=ol(t);return[s]}function t8(t,s,r){return r==null&&(r=st(4)),cl(s,r)}function s8(t){var s=qn(t),r=t.read_shift(1);return[s,r,"b"]}function r8(t,s,r){return r==null&&(r=st(9)),ll(s,r),r.write_shift(1,t.v?1:0),r}function n8(t){var s=ol(t),r=t.read_shift(1);return[s,r,"b"]}function a8(t,s,r){return r==null&&(r=st(5)),cl(s,r),r.write_shift(1,t.v?1:0),r}function i8(t){var s=qn(t),r=t.read_shift(1);return[s,r,"e"]}function l8(t,s,r){return r==null&&(r=st(9)),ll(s,r),r.write_shift(1,t.v),r}function o8(t){var s=ol(t),r=t.read_shift(1);return[s,r,"e"]}function c8(t,s,r){return r==null&&(r=st(8)),cl(s,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function d8(t){var s=qn(t),r=t.read_shift(4);return[s,r,"s"]}function u8(t,s,r){return r==null&&(r=st(12)),ll(s,r),r.write_shift(4,s.v),r}function m8(t){var s=ol(t),r=t.read_shift(4);return[s,r,"s"]}function p8(t,s,r){return r==null&&(r=st(8)),cl(s,r),r.write_shift(4,s.v),r}function x8(t){var s=qn(t),r=go(t);return[s,r,"n"]}function h8(t,s,r){return r==null&&(r=st(16)),ll(s,r),nl(t.v,r),r}function f8(t){var s=ol(t),r=go(t);return[s,r,"n"]}function g8(t,s,r){return r==null&&(r=st(12)),cl(s,r),nl(t.v,r),r}function y8(t){var s=qn(t),r=pS(t);return[s,r,"n"]}function v8(t,s,r){return r==null&&(r=st(12)),ll(s,r),xS(t.v,r),r}function b8(t){var s=ol(t),r=pS(t);return[s,r,"n"]}function w8(t,s,r){return r==null&&(r=st(8)),cl(s,r),xS(t.v,r),r}function N8(t){var s=qn(t),r=Lh(t);return[s,r,"is"]}function j8(t){var s=qn(t),r=Gr(t);return[s,r,"str"]}function S8(t,s,r){return r==null&&(r=st(12+4*t.v.length)),ll(s,r),Ar(t.v,r),r.length>r.l?r.slice(0,r.l):r}function k8(t){var s=ol(t),r=Gr(t);return[s,r,"str"]}function C8(t,s,r){return r==null&&(r=st(8+4*t.v.length)),cl(s,r),Ar(t.v,r),r.length>r.l?r.slice(0,r.l):r}function _8(t,s,r){var n=t.l+s,a=qn(t);a.r=r["!row"];var l=t.read_shift(1),c=[a,l,"b"];if(r.cellFormula){t.l+=2;var u=Lm(t,n-t.l,r);c[3]=to(u,null,a,r.supbooks,r)}else t.l=n;return c}function E8(t,s,r){var n=t.l+s,a=qn(t);a.r=r["!row"];var l=t.read_shift(1),c=[a,l,"e"];if(r.cellFormula){t.l+=2;var u=Lm(t,n-t.l,r);c[3]=to(u,null,a,r.supbooks,r)}else t.l=n;return c}function P8(t,s,r){var n=t.l+s,a=qn(t);a.r=r["!row"];var l=go(t),c=[a,l,"n"];if(r.cellFormula){t.l+=2;var u=Lm(t,n-t.l,r);c[3]=to(u,null,a,r.supbooks,r)}else t.l=n;return c}function A8(t,s,r){var n=t.l+s,a=qn(t);a.r=r["!row"];var l=Gr(t),c=[a,l,"str"];if(r.cellFormula){t.l+=2;var u=Lm(t,n-t.l,r);c[3]=to(u,null,a,r.supbooks,r)}else t.l=n;return c}var T8=dl,O8=fo;function R8(t,s){return s==null&&(s=st(4)),s.write_shift(4,t),s}function D8(t,s){var r=t.l+s,n=dl(t),a=Fh(t),l=Gr(t),c=Gr(t),u=Gr(t);t.l=r;var f={rfx:n,relId:a,loc:l,display:u};return c&&(f.Tooltip=c),f}function L8(t,s){var r=st(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));fo({s:Pr(t[0]),e:Pr(t[0])},r),Mh("rId"+s,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return Ar(a||"",r),Ar(t[1].Tooltip||"",r),Ar("",r),r.slice(0,r.l)}function F8(){}function M8(t,s,r){var n=t.l+s,a=hS(t),l=t.read_shift(1),c=[a];if(c[2]=l,r.cellFormula){var u=k6(t,n-t.l,r);c[1]=u}else t.l=n;return c}function I8(t,s,r){var n=t.l+s,a=dl(t),l=[a];if(r.cellFormula){var c=_6(t,n-t.l,r);l[1]=c,t.l=n}else t.l=n;return l}function q8(t,s,r){r==null&&(r=st(18));var n=Fm(t,s);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return s.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),s.level&&(a|=s.level<<8),r.write_shift(2,a),r}var JS=["left","right","top","bottom","header","footer"];function B8(t){var s={};return JS.forEach(function(r){s[r]=go(t)}),s}function z8(t,s){return s==null&&(s=st(48)),KS(t),JS.forEach(function(r){nl(t[r],s)}),s}function $8(t){var s=t.read_shift(2);return t.l+=28,{RTL:s&32}}function Q8(t,s,r){r==null&&(r=st(30));var n=924;return(((s||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function U8(t){var s=st(24);return s.write_shift(4,4),s.write_shift(4,1),fo(t,s),s}function V8(t,s){return s==null&&(s=st(66)),s.write_shift(2,t.password?RS(t.password):0),s.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?s.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):s.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),s}function W8(){}function G8(){}function H8(t,s,r,n,a,l,c){if(s.v===void 0)return!1;var u="";switch(s.t){case"b":u=s.v?"1":"0";break;case"d":s=hn(s),s.z=s.z||ir[14],s.v=xn(en(s.v)),s.t="n";break;case"n":case"e":u=""+s.v;break;default:u=s.v;break}var f={r,c:n};switch(f.s=Ai(a.cellXfs,s,a),s.l&&l["!links"].push([Ms(f),s.l]),s.c&&l["!comments"].push([Ms(f),s.c]),s.t){case"s":case"str":return a.bookSST?(u=Qh(a.Strings,s.v,a.revStrings),f.t="s",f.v=u,c?dt(t,18,p8(s,f)):dt(t,7,u8(s,f))):(f.t="str",c?dt(t,17,C8(s,f)):dt(t,6,S8(s,f))),!0;case"n":return s.v==(s.v|0)&&s.v>-1e3&&s.v<1e3?c?dt(t,13,w8(s,f)):dt(t,2,v8(s,f)):c?dt(t,16,g8(s,f)):dt(t,5,h8(s,f)),!0;case"b":return f.t="b",c?dt(t,15,a8(s,f)):dt(t,4,r8(s,f)),!0;case"e":return f.t="e",c?dt(t,14,c8(s,f)):dt(t,3,l8(s,f)),!0}return c?dt(t,12,t8(s,f)):dt(t,1,Z6(s,f)),!0}function Y8(t,s,r,n){var a=Ws(s["!ref"]||"A1"),l,c="",u=[];dt(t,145);var f=Array.isArray(s),h=a.e.r;s["!rows"]&&(h=Math.max(a.e.r,s["!rows"].length-1));for(var v=a.s.r;v<=h;++v){c=Mr(v),W6(t,s,a,v);var w=!1;if(v<=a.e.r)for(var j=a.s.c;j<=a.e.c;++j){v===a.s.r&&(u[j]=Wr(j)),l=u[j]+c;var C=f?(s[v]||[])[j]:s[l];if(!C){w=!1;continue}w=H8(t,C,v,j,n,s,w)}}dt(t,146)}function K8(t,s){!s||!s["!merges"]||(dt(t,177,R8(s["!merges"].length)),s["!merges"].forEach(function(r){dt(t,176,O8(r))}),dt(t,178))}function X8(t,s){!s||!s["!cols"]||(dt(t,390),s["!cols"].forEach(function(r,n){r&&dt(t,60,q8(n,r))}),dt(t,391))}function J8(t,s){!s||!s["!ref"]||(dt(t,648),dt(t,649,U8(Ws(s["!ref"]))),dt(t,650))}function Z8(t,s,r){s["!links"].forEach(function(n){if(n[1].Target){var a=Ls(r,-1,n[1].Target.replace(/#.*$/,""),_s.HLINK);dt(t,494,L8(n,a))}}),delete s["!links"]}function e7(t,s,r,n){if(s["!comments"].length>0){var a=Ls(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",_s.VML);dt(t,551,Mh("rId"+a)),s["!legacy"]=a}}function t7(t,s,r,n){if(s["!autofilter"]){var a=s["!autofilter"],l=typeof a.ref=="string"?a.ref:gr(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var c=r.Workbook.Names,u=En(l);u.s.r==u.e.r&&(u.e.r=En(s["!ref"]).e.r,l=gr(u));for(var f=0;f<c.length;++f){var h=c[f];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+l;break}}f==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+l}),dt(t,161,fo(Ws(l))),dt(t,162)}}function s7(t,s,r){dt(t,133),dt(t,137,Q8(s,r)),dt(t,138),dt(t,134)}function r7(t,s){s["!protect"]&&dt(t,535,V8(s["!protect"]))}function n7(t,s,r,n){var a=pn(),l=r.SheetNames[t],c=r.Sheets[l]||{},u=l;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var f=Ws(c["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(s.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],dt(a,129),(r.vbaraw||c["!outline"])&&dt(a,147,X6(u,c["!outline"])),dt(a,148,H6(f)),s7(a,c,r.Workbook),X8(a,c),Y8(a,c,t,s),r7(a,c),t7(a,c,r,t),K8(a,c),Z8(a,c,n),c["!margins"]&&dt(a,476,z8(c["!margins"])),(!s||s.ignoreEC||s.ignoreEC==null)&&J8(a,c),e7(a,c,t,n),dt(a,130),a.end()}function a7(t,s){t.l+=10;var r=Gr(t);return{name:r}}var i7=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function l7(t){return!t.Workbook||!t.Workbook.WBProps?"false":I9(t.Workbook.WBProps.date1904)?"true":"false"}var o7="][*?/\\".split("");function ZS(t,s){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return o7.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function c7(t,s,r){t.forEach(function(n,a){ZS(n);for(var l=0;l<a;++l)if(n==t[l])throw new Error("Duplicate Sheet Name: "+n);if(r){var c=s&&s[a]&&s[a].CodeName||n;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function d7(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var s=t.Workbook&&t.Workbook.Sheets||[];c7(t.SheetNames,s,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)O6(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function e2(t){var s=[vr];s[s.length]=Ft("workbook",null,{xmlns:xo[0],"xmlns:r":Er.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(i7.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),s[s.length]=Ft("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],l=0;if(a&&a[0]&&a[0].Hidden){for(s[s.length]="<bookViews>",l=0;l!=t.SheetNames.length&&!(!a[l]||!a[l].Hidden);++l);l==t.SheetNames.length&&(l=0),s[s.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',s[s.length]="</bookViews>"}for(s[s.length]="<sheets>",l=0;l!=t.SheetNames.length;++l){var c={name:Fs(t.SheetNames[l].slice(0,31))};if(c.sheetId=""+(l+1),c["r:id"]="rId"+(l+1),a[l])switch(a[l].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}s[s.length]=Ft("sheet",null,c)}return s[s.length]="</sheets>",r&&(s[s.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(s[s.length]=Ft("definedName",Fs(u.Ref),f))}),s[s.length]="</definedNames>"),s.length>2&&(s[s.length]="</workbook>",s[1]=s[1].replace("/>",">")),s.join("")}function u7(t,s){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Ex(t),r.name=Gr(t),r}function m7(t,s){return s||(s=st(127)),s.write_shift(4,t.Hidden),s.write_shift(4,t.iTabID),Mh(t.strRelID,s),Ar(t.name.slice(0,31),s),s.length>s.l?s.slice(0,s.l):s}function p7(t,s){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=s>8?Gr(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function x7(t,s){s||(s=st(72));var r=0;return t&&t.filterPrivacy&&(r|=8),s.write_shift(4,r),s.write_shift(4,0),mS(t&&t.CodeName||"ThisWorkbook",s),s.slice(0,s.l)}function h7(t,s,r){var n=t.l+s;t.l+=4,t.l+=1;var a=t.read_shift(4),l=lF(t),c=C6(t,0,r),u=Fh(t);t.l=n;var f={Name:l,Ptg:c};return a<268435455&&(f.Sheet=a),u&&(f.Comment=u),f}function f7(t,s){dt(t,143);for(var r=0;r!=s.SheetNames.length;++r){var n=s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r]&&s.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:s.SheetNames[r]};dt(t,156,m7(a))}dt(t,144)}function g7(t,s){s||(s=st(127));for(var r=0;r!=4;++r)s.write_shift(4,0);return Ar("SheetJS",s),Ar($u.version,s),Ar($u.version,s),Ar("7262",s),s.length>s.l?s.slice(0,s.l):s}function y7(t,s){s||(s=st(29)),s.write_shift(-4,0),s.write_shift(-4,460),s.write_shift(4,28800),s.write_shift(4,17600),s.write_shift(4,500),s.write_shift(4,t),s.write_shift(4,t);var r=120;return s.write_shift(1,r),s.length>s.l?s.slice(0,s.l):s}function v7(t,s){if(!(!s.Workbook||!s.Workbook.Sheets)){for(var r=s.Workbook.Sheets,n=0,a=-1,l=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&l==-1&&(l=n);l>a||(dt(t,135),dt(t,158,y7(a)),dt(t,136))}}function b7(t,s){var r=pn();return dt(r,131),dt(r,128,g7()),dt(r,153,x7(t.Workbook&&t.Workbook.WBProps||null)),v7(r,t),f7(r,t),dt(r,132),r.end()}function w7(t,s,r){return(s.slice(-4)===".bin"?b7:e2)(t)}function N7(t,s,r,n,a){return(s.slice(-4)===".bin"?n7:XS)(t,r,n,a)}function j7(t,s,r){return(s.slice(-4)===".bin"?zM:FS)(t,r)}function S7(t,s,r){return(s.slice(-4)===".bin"?xM:OS)(t,r)}function k7(t,s,r){return(s.slice(-4)===".bin"?rI:zS)(t)}function C7(t){return(t.slice(-4)===".bin"?YM:qS)()}function _7(t,s){var r=[];return t.Props&&r.push(jF(t.Props,s)),t.Custprops&&r.push(SF(t.Props,t.Custprops)),r.join("")}function E7(){return""}function P7(t,s){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return s.cellXfs.forEach(function(n,a){var l=[];l.push(Ft("NumberFormat",null,{"ss:Format":Fs(ir[n.numFmtId])}));var c={"ss:ID":"s"+(21+a)};r.push(Ft("Style",l.join(""),c))}),Ft("Styles",r.join(""))}function t2(t){return Ft("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+zh(t.Ref,{r:0,c:0})})}function A7(t){if(!((t||{}).Workbook||{}).Names)return"";for(var s=t.Workbook.Names,r=[],n=0;n<s.length;++n){var a=s[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(t2(a)))}return Ft("Names",r.join(""))}function T7(t,s,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,l=[],c=0;c<a.length;++c){var u=a[c];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||l.push(t2(u)))}return l.join("")}function O7(t,s,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Ft("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Ft("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Ft("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ft("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(n.Workbook.Sheets[l]&&!n.Workbook.Sheets[l].Hidden);++l);l==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(Fr("ProtectContents","True")),t["!protect"].objects&&a.push(Fr("ProtectObjects","True")),t["!protect"].scenarios&&a.push(Fr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(Fr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(Fr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){t["!protect"][c[0]]&&a.push("<"+c[1]+"/>")})),a.length==0?"":Ft("WorksheetOptions",a.join(""),{xmlns:Sn.x})}function R7(t){return t.map(function(s){var r=M9(s.t||""),n=Ft("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ft("Comment",n,{"ss:Author":s.a})}).join("")}function D7(t,s,r,n,a,l,c){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+Fs(zh(t.f,c))),t.F&&t.F.slice(0,s.length)==s){var f=Pr(t.F.slice(s.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==c.r?"":"["+(f.r-c.r)+"]")+"C"+(f.c==c.c?"":"["+(f.c-c.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=Fs(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=Fs(t.l.Tooltip))),r["!merges"])for(var h=r["!merges"],v=0;v!=h.length;++v)h[v].s.c!=c.c||h[v].s.r!=c.r||(h[v].e.c>h[v].s.c&&(u["ss:MergeAcross"]=h[v].e.c-h[v].s.c),h[v].e.r>h[v].s.r&&(u["ss:MergeDown"]=h[v].e.r-h[v].s.r));var w="",j="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":w="Number",j=String(t.v);break;case"b":w="Boolean",j=t.v?"1":"0";break;case"e":w="Error",j=Wc[t.v];break;case"d":w="DateTime",j=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ir[14]);break;case"s":w="String",j=F9(t.v||"");break}var C=Ai(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+C),u["ss:Index"]=c.c+1;var k=t.v!=null?j:"",S=t.t=="z"?"":'<Data ss:Type="'+w+'">'+k+"</Data>";return(t.c||[]).length>0&&(S+=R7(t.c)),Ft("Cell",S,u)}function L7(t,s){var r='<Row ss:Index="'+(t+1)+'"';return s&&(s.hpt&&!s.hpx&&(s.hpx=LS(s.hpt)),s.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+s.hpx+'"'),s.hidden&&(r+=' ss:Hidden="1"')),r+">"}function F7(t,s,r,n){if(!t["!ref"])return"";var a=Ws(t["!ref"]),l=t["!merges"]||[],c=0,u=[];t["!cols"]&&t["!cols"].forEach(function(_,I){qh(_);var F=!!_.width,B=Fm(I,_),q={"ss:Index":I+1};F&&(q["ss:Width"]=Ju(B.width)),_.hidden&&(q["ss:Hidden"]="1"),u.push(Ft("Column",null,q))});for(var f=Array.isArray(t),h=a.s.r;h<=a.e.r;++h){for(var v=[L7(h,(t["!rows"]||[])[h])],w=a.s.c;w<=a.e.c;++w){var j=!1;for(c=0;c!=l.length;++c)if(!(l[c].s.c>w)&&!(l[c].s.r>h)&&!(l[c].e.c<w)&&!(l[c].e.r<h)){(l[c].s.c!=w||l[c].s.r!=h)&&(j=!0);break}if(!j){var C={r:h,c:w},k=Ms(C),S=f?(t[h]||[])[w]:t[k];v.push(D7(S,k,t,s,r,n,C))}}v.push("</Row>"),v.length>2&&u.push(v.join(""))}return u.join("")}function M7(t,s,r){var n=[],a=r.SheetNames[t],l=r.Sheets[a],c=l?T7(l,s,t,r):"";return c.length>0&&n.push("<Names>"+c+"</Names>"),c=l?F7(l,s,t,r):"",c.length>0&&n.push("<Table>"+c+"</Table>"),n.push(O7(l,s,t,r)),n.join("")}function I7(t,s){s||(s={}),t.SSF||(t.SSF=hn(ir)),t.SSF&&(Tm(),Am(t.SSF),s.revssf=Om(t.SSF),s.revssf[t.SSF[65535]]=0,s.ssf=t.SSF,s.cellXfs=[],Ai(s.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(_7(t,s)),r.push(E7()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ft("Worksheet",M7(n,s,t),{"ss:Name":Fs(t.SheetNames[n])}));return r[2]=P7(t,s),r[3]=A7(t),vr+Ft("Workbook",r.join(""),{xmlns:Sn.ss,"xmlns:o":Sn.o,"xmlns:x":Sn.x,"xmlns:ss":Sn.ss,"xmlns:dt":Sn.dt,"xmlns:html":Sn.html})}var X0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function q7(t,s){var r=[],n=[],a=[],l=0,c,u=vb(Ob,"n"),f=vb(Rb,"n");if(t.Props)for(c=Ir(t.Props),l=0;l<c.length;++l)(Object.prototype.hasOwnProperty.call(u,c[l])?r:Object.prototype.hasOwnProperty.call(f,c[l])?n:a).push([c[l],t.Props[c[l]]]);if(t.Custprops)for(c=Ir(t.Custprops),l=0;l<c.length;++l)Object.prototype.hasOwnProperty.call(t.Props||{},c[l])||(Object.prototype.hasOwnProperty.call(u,c[l])?r:Object.prototype.hasOwnProperty.call(f,c[l])?n:a).push([c[l],t.Custprops[c[l]]]);var h=[];for(l=0;l<a.length;++l)kS.indexOf(a[l][0])>-1||NS.indexOf(a[l][0])>-1||a[l][1]!=null&&h.push(a[l]);n.length&&Is.utils.cfb_add(s,"/SummaryInformation",Ib(n,X0.SI,f,Rb)),(r.length||h.length)&&Is.utils.cfb_add(s,"/DocumentSummaryInformation",Ib(r,X0.DSI,u,Ob,h.length?h:null,X0.UDI))}function B7(t,s){var r=s||{},n=Is.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Is.utils.cfb_add(n,a,s2(t,r)),r.biff==8&&(t.Props||t.Custprops)&&q7(t,n),r.biff==8&&t.vbaraw&&nI(n,Is.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var z7={0:{f:U6},1:{f:J6},2:{f:y8},3:{f:i8},4:{f:s8},5:{f:x8},6:{f:j8},7:{f:d8},8:{f:A8},9:{f:P8},10:{f:_8},11:{f:E8},12:{f:e8},13:{f:b8},14:{f:o8},15:{f:n8},16:{f:f8},17:{f:k8},18:{f:m8},19:{f:Lh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:h7},40:{},42:{},43:{f:jM},44:{f:wM},45:{f:CM},46:{f:EM},47:{f:_M},48:{},49:{f:eF},50:{},51:{f:UM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:tM},62:{f:N8},63:{f:KM},64:{f:W8},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Na,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:$8},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:K6},148:{f:G6,p:16},151:{f:F8},152:{},153:{f:p7},154:{},155:{},156:{f:u7},157:{},158:{},159:{T:1,f:uM},160:{T:-1},161:{T:1,f:dl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:T8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:$M},336:{T:-1},337:{f:GM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ex},357:{},358:{},359:{},360:{T:1},361:{},362:{f:YF},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:M8},427:{f:I8},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:B8},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Y6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:D8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ex},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:tI},633:{T:1},634:{T:-1},635:{T:1,f:ZM},636:{T:-1},637:{f:nF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:a7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:G8},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function It(t,s,r,n){var a=s;if(!isNaN(a)){var l=n||(r||[]).length||0,c=t.next(4);c.write_shift(2,a),c.write_shift(2,l),l>0&&Oh(r)&&t.push(r)}}function $7(t,s,r,n){var a=(r||[]).length||0;if(a<=8224)return It(t,s,r,a);var l=s;if(!isNaN(l)){for(var c=r.parts||[],u=0,f=0,h=0;h+(c[u]||8224)<=8224;)h+=c[u]||8224,u++;var v=t.next(4);for(v.write_shift(2,l),v.write_shift(2,h),t.push(r.slice(f,f+h)),f+=h;f<a;){for(v=t.next(4),v.write_shift(2,60),h=0;h+(c[u]||8224)<=8224;)h+=c[u]||8224,u++;v.write_shift(2,h),t.push(r.slice(f,f+h)),f+=h}}}function Hc(t,s,r){return t||(t=st(7)),t.write_shift(2,s),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function Q7(t,s,r,n){var a=st(9);return Hc(a,t,s),_S(r,n||"b",a),a}function U7(t,s,r){var n=st(8+2*r.length);return Hc(n,t,s),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function V7(t,s,r,n){if(s.v!=null)switch(s.t){case"d":case"n":var a=s.t=="d"?xn(en(s.v)):s.v;a==(a|0)&&a>=0&&a<65536?It(t,2,aM(r,n,a)):It(t,3,nM(r,n,a));return;case"b":case"e":It(t,5,Q7(r,n,s.v,s.t));return;case"s":case"str":It(t,4,U7(r,n,(s.v||"").slice(0,255)));return}It(t,1,Hc(null,r,n))}function W7(t,s,r,n){var a=Array.isArray(s),l=Ws(s["!ref"]||"A1"),c,u="",f=[];if(l.e.c>255||l.e.r>16383){if(n.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),c=gr(l)}for(var h=l.s.r;h<=l.e.r;++h){u=Mr(h);for(var v=l.s.c;v<=l.e.c;++v){h===l.s.r&&(f[v]=Wr(v)),c=f[v]+u;var w=a?(s[h]||[])[v]:s[c];w&&V7(t,w,h,v)}}}function G7(t,s){for(var r=s||{},n=pn(),a=0,l=0;l<t.SheetNames.length;++l)t.SheetNames[l]==r.sheet&&(a=l);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return It(n,r.biff==4?1033:r.biff==3?521:9,Ih(t,16,r)),W7(n,t.Sheets[t.SheetNames[a]],a,r),It(n,10),n.end()}function H7(t,s,r){It(t,49,zF({sz:12,name:"Arial"},r))}function Y7(t,s,r){s&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)s[a]!=null&&It(t,1054,UF(a,s[a],r))})}function K7(t,s){var r=st(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),It(t,2151,r),r=st(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),AS(Ws(s["!ref"]||"A1"),r),r.write_shift(4,4),It(t,2152,r)}function X7(t,s){for(var r=0;r<16;++r)It(t,224,Bb({numFmtId:0,style:!0},0,s));s.cellXfs.forEach(function(n){It(t,224,Bb(n,0,s))})}function J7(t,s){for(var r=0;r<s["!links"].length;++r){var n=s["!links"][r];It(t,440,JF(n)),n[1].Tooltip&&It(t,2048,ZF(n))}delete s["!links"]}function Z7(t,s){if(s){var r=0;s.forEach(function(n,a){++r<=256&&n&&It(t,125,sM(Fm(a,n),a))})}}function eq(t,s,r,n,a){var l=16+Ai(a.cellXfs,s,a);if(s.v==null&&!s.bf){It(t,513,al(r,n,l));return}if(s.bf)It(t,6,S6(s,r,n,a,l));else switch(s.t){case"d":case"n":var c=s.t=="d"?xn(en(s.v)):s.v;It(t,515,HF(r,n,c,l));break;case"b":case"e":It(t,517,GF(r,n,s.v,l,a,s.t));break;case"s":case"str":if(a.bookSST){var u=Qh(a.Strings,s.v,a.revStrings);It(t,253,$F(r,n,u,l))}else It(t,516,QF(r,n,(s.v||"").slice(0,255),l,a));break;default:It(t,513,al(r,n,l))}}function tq(t,s,r){var n=pn(),a=r.SheetNames[t],l=r.Sheets[a]||{},c=(r||{}).Workbook||{},u=(c.Sheets||[])[t]||{},f=Array.isArray(l),h=s.biff==8,v,w="",j=[],C=Ws(l["!ref"]||"A1"),k=h?65536:16384;if(C.e.c>255||C.e.r>=k){if(s.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");C.e.c=Math.min(C.e.c,255),C.e.r=Math.min(C.e.c,k-1)}It(n,2057,Ih(r,16,s)),It(n,13,Mn(1)),It(n,12,Mn(100)),It(n,15,Zr(!0)),It(n,17,Zr(!1)),It(n,16,nl(.001)),It(n,95,Zr(!0)),It(n,42,Zr(!1)),It(n,43,Zr(!1)),It(n,130,Mn(1)),It(n,128,WF()),It(n,131,Zr(!1)),It(n,132,Zr(!1)),h&&Z7(n,l["!cols"]),It(n,512,VF(C,s)),h&&(l["!links"]=[]);for(var S=C.s.r;S<=C.e.r;++S){w=Mr(S);for(var _=C.s.c;_<=C.e.c;++_){S===C.s.r&&(j[_]=Wr(_)),v=j[_]+w;var I=f?(l[S]||[])[_]:l[v];I&&(eq(n,I,S,_,s),h&&I.l&&l["!links"].push([v,I.l]))}}var F=u.CodeName||u.name||a;return h&&It(n,574,BF((c.Views||[])[0])),h&&(l["!merges"]||[]).length&&It(n,229,XF(l["!merges"])),h&&J7(n,l),It(n,442,PS(F)),h&&K7(n,l),It(n,10),n.end()}function sq(t,s,r){var n=pn(),a=(t||{}).Workbook||{},l=a.Sheets||[],c=a.WBProps||{},u=r.biff==8,f=r.biff==5;if(It(n,2057,Ih(t,5,r)),r.bookType=="xla"&&It(n,135),It(n,225,u?Mn(1200):null),It(n,193,_F(2)),f&&It(n,191),f&&It(n,192),It(n,226),It(n,92,FF("SheetJS",r)),It(n,66,Mn(u?1200:1252)),u&&It(n,353,Mn(0)),u&&It(n,448),It(n,317,rM(t.SheetNames.length)),u&&t.vbaraw&&It(n,211),u&&t.vbaraw){var h=c.CodeName||"ThisWorkbook";It(n,442,PS(h))}It(n,156,Mn(17)),It(n,25,Zr(!1)),It(n,18,Zr(!1)),It(n,19,Mn(0)),u&&It(n,431,Zr(!1)),u&&It(n,444,Mn(0)),It(n,61,qF()),It(n,64,Zr(!1)),It(n,141,Mn(0)),It(n,34,Zr(l7(t)=="true")),It(n,14,Zr(!0)),u&&It(n,439,Zr(!1)),It(n,218,Mn(0)),H7(n,t,r),Y7(n,t.SSF,r),X7(n,r),u&&It(n,352,Zr(!1));var v=n.end(),w=pn();u&&It(w,140,eM()),u&&r.Strings&&$7(w,252,IF(r.Strings)),It(w,10);var j=w.end(),C=pn(),k=0,S=0;for(S=0;S<t.SheetNames.length;++S)k+=(u?12:11)+(u?2:1)*t.SheetNames[S].length;var _=v.length+k+j.length;for(S=0;S<t.SheetNames.length;++S){var I=l[S]||{};It(C,133,MF({pos:_,hs:I.Hidden||0,dt:0,name:t.SheetNames[S]},r)),_+=s[S].length}var F=C.end();if(k!=F.length)throw new Error("BS8 "+k+" != "+F.length);var B=[];return v.length&&B.push(v),F.length&&B.push(F),j.length&&B.push(j),Lr(B)}function rq(t,s){var r=s||{},n=[];t&&!t.SSF&&(t.SSF=hn(ir)),t&&t.SSF&&(Tm(),Am(t.SSF),r.revssf=Om(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Uh(r),r.cellXfs=[],Ai(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=tq(a,r,t);return n.unshift(sq(t,n,r)),Lr(n)}function s2(t,s){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=En(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=s||{};switch(l.biff||2){case 8:case 5:return rq(t,s);case 4:case 3:case 2:return G7(t,s)}throw new Error("invalid type "+l.bookType+" for BIFF")}function nq(t,s,r,n){for(var a=t["!merges"]||[],l=[],c=s.s.c;c<=s.e.c;++c){for(var u=0,f=0,h=0;h<a.length;++h)if(!(a[h].s.r>r||a[h].s.c>c)&&!(a[h].e.r<r||a[h].e.c<c)){if(a[h].s.r<r||a[h].s.c<c){u=-1;break}u=a[h].e.r-a[h].s.r+1,f=a[h].e.c-a[h].s.c+1;break}if(!(u<0)){var v=Ms({r,c}),w=n.dense?(t[r]||[])[c]:t[v],j=w&&w.v!=null&&(w.h||L9(w.w||(Wa(w),w.w)||""))||"",C={};u>1&&(C.rowspan=u),f>1&&(C.colspan=f),n.editable?j='<span contenteditable="true">'+j+"</span>":w&&(C["data-t"]=w&&w.t||"z",w.v!=null&&(C["data-v"]=w.v),w.z!=null&&(C["data-z"]=w.z),w.l&&(w.l.Target||"#").charAt(0)!="#"&&(j='<a href="'+w.l.Target+'">'+j+"</a>")),C.id=(n.id||"sjs")+"-"+v,l.push(Ft("td",j,C))}}var k="<tr>";return k+l.join("")+"</tr>"}var aq='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',iq="</body></html>";function lq(t,s,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function r2(t,s){var r=s||{},n=r.header!=null?r.header:aq,a=r.footer!=null?r.footer:iq,l=[n],c=En(t["!ref"]);r.dense=Array.isArray(t),l.push(lq(t,c,r));for(var u=c.s.r;u<=c.e.r;++u)l.push(nq(t,c,u,r));return l.push("</table>"+a),l.join("")}function n2(t,s,r){var n=r||{},a=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Pr(n.origin):n.origin;a=c.r,l=c.c}var u=s.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:a,c:l}};if(t["!ref"]){var v=En(t["!ref"]);h.s.r=Math.min(h.s.r,v.s.r),h.s.c=Math.min(h.s.c,v.s.c),h.e.r=Math.max(h.e.r,v.e.r),h.e.c=Math.max(h.e.c,v.e.c),a==-1&&(h.e.r=a=v.e.r+1)}var w=[],j=0,C=t["!rows"]||(t["!rows"]=[]),k=0,S=0,_=0,I=0,F=0,B=0;for(t["!cols"]||(t["!cols"]=[]);k<u.length&&S<f;++k){var q=u[k];if(Gb(q)){if(n.display)continue;C[S]={hidden:!0}}var me=q.children;for(_=I=0;_<me.length;++_){var re=me[_];if(!(n.display&&Gb(re))){var M=re.hasAttribute("data-v")?re.getAttribute("data-v"):re.hasAttribute("v")?re.getAttribute("v"):q9(re.innerHTML),W=re.getAttribute("data-z")||re.getAttribute("z");for(j=0;j<w.length;++j){var oe=w[j];oe.s.c==I+l&&oe.s.r<S+a&&S+a<=oe.e.r&&(I=oe.e.c+1-l,j=-1)}B=+re.getAttribute("colspan")||1,((F=+re.getAttribute("rowspan")||1)>1||B>1)&&w.push({s:{r:S+a,c:I+l},e:{r:S+a+(F||1)-1,c:I+l+(B||1)-1}});var X={t:"s",v:M},he=re.getAttribute("data-t")||re.getAttribute("t")||"";M!=null&&(M.length==0?X.t=he||"z":n.raw||M.trim().length==0||he=="s"||(M==="TRUE"?X={t:"b",v:!0}:M==="FALSE"?X={t:"b",v:!1}:isNaN(Ba(M))?isNaN(vc(M).getDate())||(X={t:"d",v:en(M)},n.cellDates||(X={t:"n",v:xn(X.v)}),X.z=n.dateNF||ir[14]):X={t:"n",v:Ba(M)})),X.z===void 0&&W!=null&&(X.z=W);var ue="",_e=re.getElementsByTagName("A");if(_e&&_e.length)for(var ke=0;ke<_e.length&&!(_e[ke].hasAttribute("href")&&(ue=_e[ke].getAttribute("href"),ue.charAt(0)!="#"));++ke);ue&&ue.charAt(0)!="#"&&(X.l={Target:ue}),n.dense?(t[S+a]||(t[S+a]=[]),t[S+a][I+l]=X):t[Ms({c:I+l,r:S+a})]=X,h.e.c<I+l&&(h.e.c=I+l),I+=B}}++S}return w.length&&(t["!merges"]=(t["!merges"]||[]).concat(w)),h.e.r=Math.max(h.e.r,S-1+a),t["!ref"]=gr(h),S>=f&&(t["!fullref"]=gr((h.e.r=u.length-k+S-1+a,h))),t}function a2(t,s){var r=s||{},n=r.dense?[]:{};return n2(n,t,s)}function oq(t,s){return il(a2(t,s),s)}function Gb(t){var s="",r=cq(t);return r&&(s=r(t).getPropertyValue("display")),s||(s=t.style&&t.style.display),s==="none"}function cq(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var dq=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),s="<office:document-styles "+wc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return vr+s}})(),Hb=(function(){var t=function(l){return Fs(l).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},s=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(l,c,u){var f=[];f.push('      <table:table table:name="'+Fs(c.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,v=0,w=En(l["!ref"]||"A1"),j=l["!merges"]||[],C=0,k=Array.isArray(l);if(l["!cols"])for(v=0;v<=w.e.c;++v)f.push("        <table:table-column"+(l["!cols"][v]?' table:style-name="co'+l["!cols"][v].ods+'"':"")+`></table:table-column>
`);var S="",_=l["!rows"]||[];for(h=0;h<w.s.r;++h)S=_[h]?' table:style-name="ro'+_[h].ods+'"':"",f.push("        <table:table-row"+S+`></table:table-row>
`);for(;h<=w.e.r;++h){for(S=_[h]?' table:style-name="ro'+_[h].ods+'"':"",f.push("        <table:table-row"+S+`>
`),v=0;v<w.s.c;++v)f.push(s);for(;v<=w.e.c;++v){var I=!1,F={},B="";for(C=0;C!=j.length;++C)if(!(j[C].s.c>v)&&!(j[C].s.r>h)&&!(j[C].e.c<v)&&!(j[C].e.r<h)){(j[C].s.c!=v||j[C].s.r!=h)&&(I=!0),F["table:number-columns-spanned"]=j[C].e.c-j[C].s.c+1,F["table:number-rows-spanned"]=j[C].e.r-j[C].s.r+1;break}if(I){f.push(r);continue}var q=Ms({r:h,c:v}),me=k?(l[h]||[])[v]:l[q];if(me&&me.f&&(F["table:formula"]=Fs(A6(me.f)),me.F&&me.F.slice(0,q.length)==q)){var re=En(me.F);F["table:number-matrix-columns-spanned"]=re.e.c-re.s.c+1,F["table:number-matrix-rows-spanned"]=re.e.r-re.s.r+1}if(!me){f.push(s);continue}switch(me.t){case"b":B=me.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=me.v?"true":"false";break;case"n":B=me.w||String(me.v||0),F["office:value-type"]="float",F["office:value"]=me.v||0;break;case"s":case"str":B=me.v==null?"":me.v,F["office:value-type"]="string";break;case"d":B=me.w||en(me.v).toISOString(),F["office:value-type"]="date",F["office:date-value"]=en(me.v).toISOString(),F["table:style-name"]="ce1";break;default:f.push(s);continue}var M=t(B);if(me.l&&me.l.Target){var W=me.l.Target;W=W.charAt(0)=="#"?"#"+T6(W.slice(1)):W,W.charAt(0)!="#"&&!W.match(/^\w+:/)&&(W="../"+W),M=Ft("text:a",M,{"xlink:href":W.replace(/&/g,"&amp;")})}f.push("          "+Ft("table:table-cell",Ft("text:p",M,{}),F)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(l,c){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;c.SheetNames.map(function(h){return c.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var v=0;v<h["!cols"].length;++v)if(h["!cols"][v]){var w=h["!cols"][v];if(w.width==null&&w.wpx==null&&w.wch==null)continue;qh(w),w.ods=u;var j=h["!cols"][v].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+j+`"/>
`),l.push(`  </style:style>
`),++u}}});var f=0;c.SheetNames.map(function(h){return c.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var v=0;v<h["!rows"].length;++v)if(h["!rows"][v]){h["!rows"][v].ods=f;var w=h["!rows"][v].hpx+"px";l.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+w+`"/>
`),l.push(`  </style:style>
`),++f}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(c,u){var f=[vr],h=wc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),v=wc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+h+v+`>
`),f.push(bS().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+h+`>
`),a(f,c),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var w=0;w!=c.SheetNames.length;++w)f.push(n(c.Sheets[c.SheetNames[w]],c,w));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function i2(t,s){if(s.bookType=="fods")return Hb(t,s);var r=Eh(),n="",a=[],l=[];return n="mimetype",gs(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",gs(r,n,Hb(t,s)),a.push([n,"text/xml"]),l.push([n,"ContentFile"]),n="styles.xml",gs(r,n,dq(t,s)),a.push([n,"text/xml"]),l.push([n,"StylesFile"]),n="meta.xml",gs(r,n,vr+bS()),a.push([n,"text/xml"]),l.push([n,"MetadataFile"]),n="manifest.rdf",gs(r,n,NF(l)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",gs(r,n,bF(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function tm(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function uq(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Yn(bc(t))}function mq(t,s){e:for(var r=0;r<=t.length-s.length;++r){for(var n=0;n<s.length;++n)if(t[r+n]!=s[n])continue e;return!0}return!1}function Ci(t){var s=t.reduce(function(a,l){return a+l.length},0),r=new Uint8Array(s),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function pq(t,s,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[s+15]|=n>>7,t[s+14]|=(n&127)<<1;for(var l=0;a>=1;++l,a/=256)t[s+l]=a&255;t[s+15]|=r>=0?0:128}function Nc(t,s){var r=s?s[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return s&&(s[0]=r),n}function Rs(t){var s=new Uint8Array(7);s[0]=t&127;var r=1;e:if(t>127){if(s[r-1]|=128,s[r]=t>>7&127,++r,t<=16383||(s[r-1]|=128,s[r]=t>>14&127,++r,t<=2097151)||(s[r-1]|=128,s[r]=t>>21&127,++r,t<=268435455)||(s[r-1]|=128,s[r]=t/256>>>21&127,++r,t<=34359738367)||(s[r-1]|=128,s[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;s[r-1]|=128,s[r]=t/16777216>>>21&127,++r}return s.slice(0,r)}function Kl(t){var s=0,r=t[s]&127;e:if(t[s++]>=128){if(r|=(t[s]&127)<<7,t[s++]<128||(r|=(t[s]&127)<<14,t[s++]<128)||(r|=(t[s]&127)<<21,t[s++]<128))break e;r|=(t[s]&127)<<28}return r}function jr(t){for(var s=[],r=[0];r[0]<t.length;){var n=r[0],a=Nc(t,r),l=a&7;a=Math.floor(a/8);var c=0,u;if(a==0)break;switch(l){case 0:{for(var f=r[0];t[r[0]++]>=128;);u=t.slice(f,r[0])}break;case 5:c=4,u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=Nc(t,r),u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(a," at offset ").concat(n))}var h={data:u,type:l};s[a]==null?s[a]=[h]:s[a].push(h)}return s}function Rr(t){var s=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(s.push(Rs(n*8+a.type)),a.type==2&&s.push(Rs(a.data.length)),s.push(a.data))})}),Ci(s)}function Wn(t){for(var s,r=[],n=[0];n[0]<t.length;){var a=Nc(t,n),l=jr(t.slice(n[0],n[0]+a));n[0]+=a;var c={id:Kl(l[1][0].data),messages:[]};l[2].forEach(function(u){var f=jr(u.data),h=Kl(f[3][0].data);c.messages.push({meta:f,data:t.slice(n[0],n[0]+h)}),n[0]+=h}),(s=l[3])!=null&&s[0]&&(c.merge=Kl(l[3][0].data)>>>0>0),r.push(c)}return r}function zl(t){var s=[];return t.forEach(function(r){var n=[];n[1]=[{data:Rs(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Rs(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(c){a.push(c.data),c.meta[3]=[{type:0,data:Rs(c.data.length)}],n[2].push({data:Rr(c.meta),type:2})});var l=Rr(n);s.push(Rs(l.length)),s.push(l),a.forEach(function(c){return s.push(c)})}),Ci(s)}function xq(t,s){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Nc(s,r),a=[];r[0]<s.length;){var l=s[r[0]]&3;if(l==0){var c=s[r[0]++]>>2;if(c<60)++c;else{var u=c-59;c=s[r[0]],u>1&&(c|=s[r[0]+1]<<8),u>2&&(c|=s[r[0]+2]<<16),u>3&&(c|=s[r[0]+3]<<24),c>>>=0,c++,r[0]+=u}a.push(s.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var f=0,h=0;if(l==1?(h=(s[r[0]]>>2&7)+4,f=(s[r[0]++]&224)<<3,f|=s[r[0]++]):(h=(s[r[0]++]>>2)+1,l==2?(f=s[r[0]]|s[r[0]+1]<<8,r[0]+=2):(f=(s[r[0]]|s[r[0]+1]<<8|s[r[0]+2]<<16|s[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Ci(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(a.push(a[0].slice(-f)),h-=f;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-f,-f+h))}}var v=Ci(a);if(v.length!=n)throw new Error("Unexpected length: ".concat(v.length," != ").concat(n));return v}function Gn(t){for(var s=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,s.push(xq(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Ci(s)}function $l(t){for(var s=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);s.push(a);var l=Rs(n),c=l.length;s.push(l),n<=60?(c++,s.push(new Uint8Array([n-1<<2]))):n<=256?(c+=2,s.push(new Uint8Array([240,n-1&255]))):n<=65536?(c+=3,s.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(c+=4,s.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(c+=5,s.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),s.push(t.slice(r,r+n)),c+=n,a[0]=0,a[1]=c&255,a[2]=c>>8&255,a[3]=c>>16&255,r+=n}return Ci(s)}function J0(t,s){var r=new Uint8Array(32),n=tm(r),a=12,l=0;switch(r[0]=5,t.t){case"n":r[1]=2,pq(r,a,t.v),l|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),l|=2,a+=8;break;case"s":if(s.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,s.indexOf(t.v),!0),l|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,l,!0),r.slice(0,a)}function Z0(t,s){var r=new Uint8Array(32),n=tm(r),a=12,l=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),l|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),l|=32,a+=8;break;case"s":if(s.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,s.indexOf(t.v),!0),l|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,l,!0),r.slice(0,a)}function fi(t){var s=jr(t);return Nc(s[1][0].data)}function hq(t,s,r){var n,a,l,c;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((c=(l=t[8])==null?void 0:l[0])==null?void 0:c.data)&&Kl(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,h=tm(t[7][0].data),v=0,w=[],j=tm(t[4][0].data),C=0,k=[],S=0;S<s.length;++S){if(s[S]==null){h.setUint16(S*2,65535,!0),j.setUint16(S*2,65535);continue}h.setUint16(S*2,v,!0),j.setUint16(S*2,C,!0);var _,I;switch(typeof s[S]){case"string":_=J0({t:"s",v:s[S]},r),I=Z0({t:"s",v:s[S]},r);break;case"number":_=J0({t:"n",v:s[S]},r),I=Z0({t:"n",v:s[S]},r);break;case"boolean":_=J0({t:"b",v:s[S]},r),I=Z0({t:"b",v:s[S]},r);break;default:throw new Error("Unsupported value "+s[S])}w.push(_),v+=_.length,k.push(I),C+=I.length,++f}for(t[2][0].data=Rs(f);S<t[7][0].data.length/2;++S)h.setUint16(S*2,65535,!0),j.setUint16(S*2,65535,!0);return t[6][0].data=Ci(w),t[3][0].data=Ci(k),f}function fq(t,s){if(!s||!s.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=En(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(gr(n)));var l=sm(r,{range:n,header:1}),c=["~Sh33tJ5~"];l.forEach(function(ce){return ce.forEach(function(z){typeof z=="string"&&c.push(z)})});var u={},f=[],h=Is.read(s.numbers,{type:"base64"});h.FileIndex.map(function(ce,z){return[ce,h.FullPaths[z]]}).forEach(function(ce){var z=ce[0],ae=ce[1];if(z.type==2&&z.name.match(/\.iwa/)){var ye=z.content,fe=Gn(ye),Ee=Wn(fe);Ee.forEach(function(Le){f.push(Le.id),u[Le.id]={deps:[],location:ae,type:Kl(Le.messages[0].meta[1][0].data)}})}}),f.sort(function(ce,z){return ce-z});var v=f.filter(function(ce){return ce>1}).map(function(ce){return[ce,Rs(ce)]});h.FileIndex.map(function(ce,z){return[ce,h.FullPaths[z]]}).forEach(function(ce){var z=ce[0];if(ce[1],!!z.name.match(/\.iwa/)){var ae=Wn(Gn(z.content));ae.forEach(function(ye){ye.messages.forEach(function(fe){v.forEach(function(Ee){ye.messages.some(function(Le){return Kl(Le.meta[1][0].data)!=11006&&mq(Le.data,Ee[1])})&&u[Ee[0]].deps.push(ye.id)})})})}});for(var w=Is.find(h,u[1].location),j=Wn(Gn(w.content)),C,k=0;k<j.length;++k){var S=j[k];S.id==1&&(C=S)}var _=fi(jr(C.messages[0].data)[1][0].data);for(w=Is.find(h,u[_].location),j=Wn(Gn(w.content)),k=0;k<j.length;++k)S=j[k],S.id==_&&(C=S);for(_=fi(jr(C.messages[0].data)[2][0].data),w=Is.find(h,u[_].location),j=Wn(Gn(w.content)),k=0;k<j.length;++k)S=j[k],S.id==_&&(C=S);for(_=fi(jr(C.messages[0].data)[2][0].data),w=Is.find(h,u[_].location),j=Wn(Gn(w.content)),k=0;k<j.length;++k)S=j[k],S.id==_&&(C=S);var I=jr(C.messages[0].data);{I[6][0].data=Rs(n.e.r+1),I[7][0].data=Rs(n.e.c+1);var F=fi(I[46][0].data),B=Is.find(h,u[F].location),q=Wn(Gn(B.content));{for(var me=0;me<q.length&&q[me].id!=F;++me);if(q[me].id!=F)throw"Bad ColumnRowUIDMapArchive";var re=jr(q[me].messages[0].data);re[1]=[],re[2]=[],re[3]=[];for(var M=0;M<=n.e.c;++M){var W=[];W[1]=W[2]=[{type:0,data:Rs(M+420690)}],re[1].push({type:2,data:Rr(W)}),re[2].push({type:0,data:Rs(M)}),re[3].push({type:0,data:Rs(M)})}re[4]=[],re[5]=[],re[6]=[];for(var oe=0;oe<=n.e.r;++oe)W=[],W[1]=W[2]=[{type:0,data:Rs(oe+726270)}],re[4].push({type:2,data:Rr(W)}),re[5].push({type:0,data:Rs(oe)}),re[6].push({type:0,data:Rs(oe)});q[me].messages[0].data=Rr(re)}B.content=$l(zl(q)),B.size=B.content.length,delete I[46];var X=jr(I[4][0].data);{X[7][0].data=Rs(n.e.r+1);var he=jr(X[1][0].data),ue=fi(he[2][0].data);B=Is.find(h,u[ue].location),q=Wn(Gn(B.content));{if(q[0].id!=ue)throw"Bad HeaderStorageBucket";var _e=jr(q[0].messages[0].data);for(oe=0;oe<l.length;++oe){var ke=jr(_e[2][0].data);ke[1][0].data=Rs(oe),ke[4][0].data=Rs(l[oe].length),_e[2][oe]={type:_e[2][0].type,data:Rr(ke)}}q[0].messages[0].data=Rr(_e)}B.content=$l(zl(q)),B.size=B.content.length;var Re=fi(X[2][0].data);B=Is.find(h,u[Re].location),q=Wn(Gn(B.content));{if(q[0].id!=Re)throw"Bad HeaderStorageBucket";for(_e=jr(q[0].messages[0].data),M=0;M<=n.e.c;++M)ke=jr(_e[2][0].data),ke[1][0].data=Rs(M),ke[4][0].data=Rs(n.e.r+1),_e[2][M]={type:_e[2][0].type,data:Rr(ke)};q[0].messages[0].data=Rr(_e)}B.content=$l(zl(q)),B.size=B.content.length;var Y=fi(X[4][0].data);(function(){for(var ce=Is.find(h,u[Y].location),z=Wn(Gn(ce.content)),ae,ye=0;ye<z.length;++ye){var fe=z[ye];fe.id==Y&&(ae=fe)}var Ee=jr(ae.messages[0].data);{Ee[3]=[];var Le=[];c.forEach(function(et,Nt){Le[1]=[{type:0,data:Rs(Nt)}],Le[2]=[{type:0,data:Rs(1)}],Le[3]=[{type:2,data:uq(et)}],Ee[3].push({type:2,data:Rr(Le)})})}ae.messages[0].data=Rr(Ee);var De=zl(z),Ve=$l(De);ce.content=Ve,ce.size=ce.content.length})();var ve=jr(X[3][0].data);{var Q=ve[1][0];delete ve[2];var be=jr(Q.data);{var pe=fi(be[2][0].data);(function(){for(var ce=Is.find(h,u[pe].location),z=Wn(Gn(ce.content)),ae,ye=0;ye<z.length;++ye){var fe=z[ye];fe.id==pe&&(ae=fe)}var Ee=jr(ae.messages[0].data);{delete Ee[6],delete ve[7];var Le=new Uint8Array(Ee[5][0].data);Ee[5]=[];for(var De=0,Ve=0;Ve<=n.e.r;++Ve){var et=jr(Le);De+=hq(et,l[Ve],c),et[1][0].data=Rs(Ve),Ee[5].push({data:Rr(et),type:2})}Ee[1]=[{type:0,data:Rs(n.e.c+1)}],Ee[2]=[{type:0,data:Rs(n.e.r+1)}],Ee[3]=[{type:0,data:Rs(De)}],Ee[4]=[{type:0,data:Rs(n.e.r+1)}]}ae.messages[0].data=Rr(Ee);var Nt=zl(z),ot=$l(Nt);ce.content=ot,ce.size=ce.content.length})()}Q.data=Rr(be)}X[3][0].data=Rr(ve)}I[4][0].data=Rr(X)}C.messages[0].data=Rr(I);var ne=zl(j),U=$l(ne);return w.content=U,w.size=w.content.length,h}function gq(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Uh(t){gq([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function yq(t,s){return s.bookType=="ods"?i2(t,s):s.bookType=="numbers"?fq(t,s):s.bookType=="xlsb"?vq(t,s):bq(t,s)}function vq(t,s){Ul=1024,t&&!t.SSF&&(t.SSF=hn(ir)),t&&t.SSF&&(Tm(),Am(t.SSF),s.revssf=Om(t.SSF),s.revssf[t.SSF[65535]]=0,s.ssf=t.SSF),s.rels={},s.wbrels={},s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,mc?s.revStrings=new Map:(s.revStrings={},s.revStrings.foo=[],delete s.revStrings.foo);var r=s.bookType=="xlsb"?"bin":"xml",n=$S.indexOf(s.bookType)>-1,a=gS();Uh(s=s||{});var l=Eh(),c="",u=0;if(s.cellXfs=[],Ai(s.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),c="docProps/core.xml",gs(l,c,wS(t.Props,s)),a.coreprops.push(c),Ls(s.rels,2,c,_s.CORE_PROPS),c="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(t.SheetNames[h]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,gs(l,c,jS(t.Props)),a.extprops.push(c),Ls(s.rels,3,c,_s.EXT_PROPS),t.Custprops!==t.Props&&Ir(t.Custprops||{}).length>0&&(c="docProps/custom.xml",gs(l,c,SS(t.Custprops)),a.custprops.push(c),Ls(s.rels,4,c,_s.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var v={"!id":{}},w=t.Sheets[t.SheetNames[u-1]],j=(w||{})["!type"]||"sheet";switch(j){case"chart":default:c="xl/worksheets/sheet"+u+"."+r,gs(l,c,N7(u-1,c,s,t,v)),a.sheets.push(c),Ls(s.wbrels,-1,"worksheets/sheet"+u+"."+r,_s.WS[0])}if(w){var C=w["!comments"],k=!1,S="";C&&C.length>0&&(S="xl/comments"+u+"."+r,gs(l,S,k7(C,S)),a.comments.push(S),Ls(v,-1,"../comments"+u+"."+r,_s.CMNT),k=!0),w["!legacy"]&&k&&gs(l,"xl/drawings/vmlDrawing"+u+".vml",BS(u,w["!comments"])),delete w["!comments"],delete w["!legacy"]}v["!id"].rId1&&gs(l,vS(c),Hl(v))}return s.Strings!=null&&s.Strings.length>0&&(c="xl/sharedStrings."+r,gs(l,c,S7(s.Strings,c,s)),a.strs.push(c),Ls(s.wbrels,-1,"sharedStrings."+r,_s.SST)),c="xl/workbook."+r,gs(l,c,w7(t,c)),a.workbooks.push(c),Ls(s.rels,1,c,_s.WB),c="xl/theme/theme1.xml",gs(l,c,IS(t.Themes,s)),a.themes.push(c),Ls(s.wbrels,-1,"theme/theme1.xml",_s.THEME),c="xl/styles."+r,gs(l,c,j7(t,c,s)),a.styles.push(c),Ls(s.wbrels,-1,"styles."+r,_s.STY),t.vbaraw&&n&&(c="xl/vbaProject.bin",gs(l,c,t.vbaraw),a.vba.push(c),Ls(s.wbrels,-1,"vbaProject.bin",_s.VBA)),c="xl/metadata."+r,gs(l,c,C7(c)),a.metadata.push(c),Ls(s.wbrels,-1,"metadata."+r,_s.XLMETA),gs(l,"[Content_Types].xml",yS(a,s)),gs(l,"_rels/.rels",Hl(s.rels)),gs(l,"xl/_rels/workbook."+r+".rels",Hl(s.wbrels)),delete s.revssf,delete s.ssf,l}function bq(t,s){Ul=1024,t&&!t.SSF&&(t.SSF=hn(ir)),t&&t.SSF&&(Tm(),Am(t.SSF),s.revssf=Om(t.SSF),s.revssf[t.SSF[65535]]=0,s.ssf=t.SSF),s.rels={},s.wbrels={},s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,mc?s.revStrings=new Map:(s.revStrings={},s.revStrings.foo=[],delete s.revStrings.foo);var r="xml",n=$S.indexOf(s.bookType)>-1,a=gS();Uh(s=s||{});var l=Eh(),c="",u=0;if(s.cellXfs=[],Ai(s.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),c="docProps/core.xml",gs(l,c,wS(t.Props,s)),a.coreprops.push(c),Ls(s.rels,2,c,_s.CORE_PROPS),c="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(t.SheetNames[h]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,gs(l,c,jS(t.Props)),a.extprops.push(c),Ls(s.rels,3,c,_s.EXT_PROPS),t.Custprops!==t.Props&&Ir(t.Custprops||{}).length>0&&(c="docProps/custom.xml",gs(l,c,SS(t.Custprops)),a.custprops.push(c),Ls(s.rels,4,c,_s.CUST_PROPS));var v=["SheetJ5"];for(s.tcid=0,u=1;u<=t.SheetNames.length;++u){var w={"!id":{}},j=t.Sheets[t.SheetNames[u-1]],C=(j||{})["!type"]||"sheet";switch(C){case"chart":default:c="xl/worksheets/sheet"+u+"."+r,gs(l,c,XS(u-1,s,t,w)),a.sheets.push(c),Ls(s.wbrels,-1,"worksheets/sheet"+u+"."+r,_s.WS[0])}if(j){var k=j["!comments"],S=!1,_="";if(k&&k.length>0){var I=!1;k.forEach(function(F){F[1].forEach(function(B){B.T==!0&&(I=!0)})}),I&&(_="xl/threadedComments/threadedComment"+u+"."+r,gs(l,_,XM(k,v,s)),a.threadedcomments.push(_),Ls(w,-1,"../threadedComments/threadedComment"+u+"."+r,_s.TCMNT)),_="xl/comments"+u+"."+r,gs(l,_,zS(k)),a.comments.push(_),Ls(w,-1,"../comments"+u+"."+r,_s.CMNT),S=!0}j["!legacy"]&&S&&gs(l,"xl/drawings/vmlDrawing"+u+".vml",BS(u,j["!comments"])),delete j["!comments"],delete j["!legacy"]}w["!id"].rId1&&gs(l,vS(c),Hl(w))}return s.Strings!=null&&s.Strings.length>0&&(c="xl/sharedStrings."+r,gs(l,c,OS(s.Strings,s)),a.strs.push(c),Ls(s.wbrels,-1,"sharedStrings."+r,_s.SST)),c="xl/workbook."+r,gs(l,c,e2(t)),a.workbooks.push(c),Ls(s.rels,1,c,_s.WB),c="xl/theme/theme1.xml",gs(l,c,IS(t.Themes,s)),a.themes.push(c),Ls(s.wbrels,-1,"theme/theme1.xml",_s.THEME),c="xl/styles."+r,gs(l,c,FS(t,s)),a.styles.push(c),Ls(s.wbrels,-1,"styles."+r,_s.STY),t.vbaraw&&n&&(c="xl/vbaProject.bin",gs(l,c,t.vbaraw),a.vba.push(c),Ls(s.wbrels,-1,"vbaProject.bin",_s.VBA)),c="xl/metadata."+r,gs(l,c,qS()),a.metadata.push(c),Ls(s.wbrels,-1,"metadata."+r,_s.XLMETA),v.length>1&&(c="xl/persons/person.xml",gs(l,c,JM(v)),a.people.push(c),Ls(s.wbrels,-1,"persons/person.xml",_s.PEOPLE)),gs(l,"[Content_Types].xml",yS(a,s)),gs(l,"_rels/.rels",Hl(s.rels)),gs(l,"xl/_rels/workbook."+r+".rels",Hl(s.wbrels)),delete s.revssf,delete s.ssf,l}function wq(t,s){var r="";switch((s||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Va(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(s&&s.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function l2(t,s){switch(s.type){case"base64":case"binary":break;case"buffer":case"array":s.type="";break;case"file":return Uc(s.file,Is.write(t,{type:As?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+s.bookType+"' files");default:throw new Error("Unrecognized type "+s.type)}return Is.write(t,s)}function Nq(t,s){var r=hn(s||{}),n=yq(t,r);return jq(n,r)}function jq(t,s){var r={},n=As?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(s.compression&&(r.compression="DEFLATE"),s.password)r.type=n;else switch(s.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+s.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+s.type)}var a=t.FullPaths?Is.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!s.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(s.type=="binary"||s.type=="base64")return a;a=new Uint8Array(Pm(a))}return s.password&&typeof encrypt_agile<"u"?l2(encrypt_agile(a,s.password),s):s.type==="file"?Uc(s.file,a):s.type=="string"?oc(a):a}function Sq(t,s){var r=s||{},n=B7(t,r);return l2(n,r)}function xa(t,s,r){r||(r="");var n=r+t;switch(s.type){case"base64":return yc(bc(n));case"binary":return bc(n);case"string":return t;case"file":return Uc(s.file,n,"utf8");case"buffer":return As?Ha(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):xa(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+s.type)}function kq(t,s){switch(s.type){case"base64":return yc(t);case"binary":return t;case"string":return t;case"file":return Uc(s.file,t,"binary");case"buffer":return As?Ha(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+s.type)}function gu(t,s){switch(s.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return s.type=="base64"?yc(r):s.type=="string"?oc(r):r;case"file":return Uc(s.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+s.type)}}function Zs(t,s){ZL(),d7(t);var r=hn(s||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Zs(t,r);return r.type="array",Pm(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return xa(I7(t,r),r);case"slk":case"sylk":return xa(lM.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return xa(r2(t.Sheets[t.SheetNames[a]],r),r);case"txt":return kq(o2(t.Sheets[t.SheetNames[a]],r),r);case"csv":return xa(Vh(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return xa(oM.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return gu(iM.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return xa(cM.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return xa(fM.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return xa(TS.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return xa(i2(t,r),r);case"wk1":return gu(zb.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return gu(zb.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),gu(s2(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Sq(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Nq(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Cq(t){if(!t.bookType){var s={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=s[t.bookType]||t.bookType}}function Yb(t,s,r){var n={};return n.type="file",n.file=s,Cq(n),Zs(t,n)}function _q(t,s,r,n,a,l,c,u){var f=Mr(r),h=u.defval,v=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),w=!0,j=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(j,"__rowNum__",{value:r,enumerable:!1})}catch{j.__rowNum__=r}else j.__rowNum__=r;if(!c||t[r])for(var C=s.s.c;C<=s.e.c;++C){var k=c?t[r][C]:t[n[C]+f];if(k===void 0||k.t===void 0){if(h===void 0)continue;l[C]!=null&&(j[l[C]]=h);continue}var S=k.v;switch(k.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(l[C]!=null){if(S==null)if(k.t=="e"&&S===null)j[l[C]]=null;else if(h!==void 0)j[l[C]]=h;else if(v&&S===null)j[l[C]]=null;else continue;else j[l[C]]=v&&(k.t!=="n"||k.t==="n"&&u.rawNumbers!==!1)?S:Wa(k,S,u);S!=null&&(w=!1)}}return{row:j,isempty:w}}function sm(t,s){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,l=[],c=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},h=s||{},v=h.range!=null?h.range:t["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof v){case"string":f=Ws(v);break;case"number":f=Ws(t["!ref"]),f.s.r=v;break;default:f=v}n>0&&(a=0);var w=Mr(f.s.r),j=[],C=[],k=0,S=0,_=Array.isArray(t),I=f.s.r,F=0,B={};_&&!t[I]&&(t[I]=[]);var q=h.skipHidden&&t["!cols"]||[],me=h.skipHidden&&t["!rows"]||[];for(F=f.s.c;F<=f.e.c;++F)if(!(q[F]||{}).hidden)switch(j[F]=Wr(F),r=_?t[I][F]:t[j[F]+w],n){case 1:l[F]=F-f.s.c;break;case 2:l[F]=j[F];break;case 3:l[F]=h.header[F-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=c=Wa(r,null,h),S=B[c]||0,!S)B[c]=1;else{do u=c+"_"+S++;while(B[u]);B[c]=S,B[u]=1}l[F]=u}for(I=f.s.r+a;I<=f.e.r;++I)if(!(me[I]||{}).hidden){var re=_q(t,f,I,j,n,l,_,h);(re.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(C[k++]=re.row)}return C.length=k,C}var Kb=/"/g;function Eq(t,s,r,n,a,l,c,u){for(var f=!0,h=[],v="",w=Mr(r),j=s.s.c;j<=s.e.c;++j)if(n[j]){var C=u.dense?(t[r]||[])[j]:t[n[j]+w];if(C==null)v="";else if(C.v!=null){f=!1,v=""+(u.rawNumbers&&C.t=="n"?C.v:Wa(C,null,u));for(var k=0,S=0;k!==v.length;++k)if((S=v.charCodeAt(k))===a||S===l||S===34||u.forceQuotes){v='"'+v.replace(Kb,'""')+'"';break}v=="ID"&&(v='"ID"')}else C.f!=null&&!C.F?(f=!1,v="="+C.f,v.indexOf(",")>=0&&(v='"'+v.replace(Kb,'""')+'"')):v="";h.push(v)}return u.blankrows===!1&&f?null:h.join(c)}function Vh(t,s){var r=[],n=s??{};if(t==null||t["!ref"]==null)return"";var a=Ws(t["!ref"]),l=n.FS!==void 0?n.FS:",",c=l.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),h=new RegExp((l=="|"?"\\|":l)+"+$"),v="",w=[];n.dense=Array.isArray(t);for(var j=n.skipHidden&&t["!cols"]||[],C=n.skipHidden&&t["!rows"]||[],k=a.s.c;k<=a.e.c;++k)(j[k]||{}).hidden||(w[k]=Wr(k));for(var S=0,_=a.s.r;_<=a.e.r;++_)(C[_]||{}).hidden||(v=Eq(t,a,_,w,c,f,l,n),v!=null&&(n.strip&&(v=v.replace(h,"")),(v||n.blankrows!==!1)&&r.push((S++?u:"")+v)));return delete n.dense,r.join("")}function o2(t,s){s||(s={}),s.FS="	",s.RS=`
`;var r=Vh(t,s);return r}function Pq(t){var s="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Ws(t["!ref"]),l="",c=[],u,f=[],h=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)c[u]=Wr(u);for(var v=a.s.r;v<=a.e.r;++v)for(l=Mr(v),u=a.s.c;u<=a.e.c;++u)if(s=c[u]+l,r=h?(t[v]||[])[u]:t[s],n="",r!==void 0){if(r.F!=null){if(s=r.F,!r.f)continue;n=r.f,s.indexOf(":")==-1&&(s=s+":"+s)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=s+"="+n}return f}function c2(t,s,r){var n=r||{},a=+!n.skipHeader,l=t||{},c=0,u=0;if(l&&n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var f=typeof n.origin=="string"?Pr(n.origin):n.origin;c=f.r,u=f.c}var h,v={s:{c:0,r:0},e:{c:u,r:c+s.length-1+a}};if(l["!ref"]){var w=Ws(l["!ref"]);v.e.c=Math.max(v.e.c,w.e.c),v.e.r=Math.max(v.e.r,w.e.r),c==-1&&(c=w.e.r+1,v.e.r=c+s.length-1+a)}else c==-1&&(c=0,v.e.r=s.length-1+a);var j=n.header||[],C=0;s.forEach(function(S,_){Ir(S).forEach(function(I){(C=j.indexOf(I))==-1&&(j[C=j.length]=I);var F=S[I],B="z",q="",me=Ms({c:u+C,r:c+_+a});h=jc(l,me),F&&typeof F=="object"&&!(F instanceof Date)?l[me]=F:(typeof F=="number"?B="n":typeof F=="boolean"?B="b":typeof F=="string"?B="s":F instanceof Date?(B="d",n.cellDates||(B="n",F=xn(F)),q=n.dateNF||ir[14]):F===null&&n.nullError&&(B="e",F=0),h?(h.t=B,h.v=F,delete h.w,delete h.R,q&&(h.z=q)):l[me]=h={t:B,v:F},q&&(h.z=q))})}),v.e.c=Math.max(v.e.c,u+j.length-1);var k=Mr(c);if(a)for(C=0;C<j.length;++C)l[Wr(C+u)+k]={t:"s",v:j[C]};return l["!ref"]=gr(v),l}function Aq(t,s){return c2(null,t,s)}function jc(t,s,r){if(typeof s=="string"){if(Array.isArray(t)){var n=Pr(s);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[s]||(t[s]={t:"z"})}return typeof s!="number"?jc(t,Ms(s)):jc(t,Ms({r:s,c:r||0}))}function Tq(t,s){if(typeof s=="number"){if(s>=0&&t.SheetNames.length>s)return s;throw new Error("Cannot find sheet # "+s)}else if(typeof s=="string"){var r=t.SheetNames.indexOf(s);if(r>-1)return r;throw new Error("Cannot find sheet name |"+s+"|")}else throw new Error("Cannot find sheet |"+s+"|")}function Oq(){return{SheetNames:[],Sheets:{}}}function Rq(t,s,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);a=l&&+l[2]||0;var c=l&&l[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=c+a)!=-1;++a);}if(ZS(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=s,r}function Dq(t,s,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Tq(t,s);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Lq(t,s){return t.z=s,t}function d2(t,s,r){return s?(t.l={Target:s},r&&(t.l.Tooltip=r)):delete t.l,t}function Fq(t,s,r){return d2(t,"#"+s,r)}function Mq(t,s,r){t.c||(t.c=[]),t.c.push({t:s,a:r||"SheetJS"})}function Iq(t,s,r,n){for(var a=typeof s!="string"?s:Ws(s),l=typeof s=="string"?s:gr(s),c=a.s.r;c<=a.e.r;++c)for(var u=a.s.c;u<=a.e.c;++u){var f=jc(t,c,u);f.t="n",f.F=l,delete f.v,c==a.s.r&&u==a.s.c&&(f.f=r,n&&(f.D=!0))}return t}var Ht={encode_col:Wr,encode_row:Mr,encode_cell:Ms,encode_range:gr,decode_col:Dh,decode_row:Rh,split_cell:Z9,decode_cell:Pr,decode_range:En,format_cell:Wa,sheet_add_aoa:uS,sheet_add_json:c2,sheet_add_dom:n2,aoa_to_sheet:ho,json_to_sheet:Aq,table_to_sheet:a2,table_to_book:oq,sheet_to_csv:Vh,sheet_to_txt:o2,sheet_to_json:sm,sheet_to_html:r2,sheet_to_formulae:Pq,sheet_to_row_object_array:sm,sheet_get_cell:jc,book_new:Oq,book_append_sheet:Rq,book_set_sheet_visibility:Dq,cell_set_number_format:Lq,cell_set_hyperlink:d2,cell_set_internal_link:Fq,cell_add_comment:Mq,sheet_set_array_formula:Iq,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Eu={exports:{}},qq=Eu.exports,Xb;function Bq(){return Xb||(Xb=1,(function(t,s){(function(r,n){n()})(qq,function(){function r(h,v){return typeof v>"u"?v={autoBom:!1}:typeof v!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),v={autoBom:!v}),v.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function n(h,v,w){var j=new XMLHttpRequest;j.open("GET",h),j.responseType="blob",j.onload=function(){f(j.response,v,w)},j.onerror=function(){console.error("could not download file")},j.send()}function a(h){var v=new XMLHttpRequest;v.open("HEAD",h,!1);try{v.send()}catch{}return 200<=v.status&&299>=v.status}function l(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var v=document.createEvent("MouseEvents");v.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(v)}}var c=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Jd=="object"&&Jd.global===Jd?Jd:void 0,u=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),f=c.saveAs||(typeof window!="object"||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(h,v,w){var j=c.URL||c.webkitURL,C=document.createElement("a");v=v||h.name||"download",C.download=v,C.rel="noopener",typeof h=="string"?(C.href=h,C.origin===location.origin?l(C):a(C.href)?n(h,v,w):l(C,C.target="_blank")):(C.href=j.createObjectURL(h),setTimeout(function(){j.revokeObjectURL(C.href)},4e4),setTimeout(function(){l(C)},0))}:"msSaveOrOpenBlob"in navigator?function(h,v,w){if(v=v||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(r(h,w),v);else if(a(h))n(h,v,w);else{var j=document.createElement("a");j.href=h,j.target="_blank",setTimeout(function(){l(j)})}}:function(h,v,w,j){if(j=j||open("","_blank"),j&&(j.document.title=j.document.body.innerText="downloading..."),typeof h=="string")return n(h,v,w);var C=h.type==="application/octet-stream",k=/constructor/i.test(c.HTMLElement)||c.safari,S=/CriOS\/[\d]+/.test(navigator.userAgent);if((S||C&&k||u)&&typeof FileReader<"u"){var _=new FileReader;_.onloadend=function(){var B=_.result;B=S?B:B.replace(/^data:[^;]*;/,"data:attachment/file;"),j?j.location.href=B:location=B,j=null},_.readAsDataURL(h)}else{var I=c.URL||c.webkitURL,F=I.createObjectURL(h);j?j.location=F:location.href=F,j=null,setTimeout(function(){I.revokeObjectURL(F)},4e4)}});c.saveAs=f.saveAs=f,t.exports=f})})(Eu)),Eu.exports}var pr=Bq();const Wh={planning:["material-issue"],"material-issue":["semi-qc"],"semi-qc":["phosphating"],phosphating:["assembly-a","assembly-b","assembly-c","assembly-d"],"assembly-a":["testing1"],"assembly-b":["testing1"],"assembly-c":["testing1"],"assembly-d":["testing2"],testing1:["marking1"],testing2:["marking2"],marking1:["pdi1"],marking2:["pdi2"],pdi1:["tpi","dispatch"],pdi2:["tpi","dispatch"],svs:["marking1"],dispatch:[],tpi:["dispatch"]},Jb={planning:"Planning","material-issue":"Material Issue","semi-qc":"Semi QC",phosphating:"Phosphating QC","assembly-a":"Assembly A","assembly-b":"Assembly B","assembly-c":"Assembly C","assembly-d":"Assembly D",testing1:"Testing1",testing2:"Testing2",svs:"SVS",marking1:"Marking1",marking2:"Marking2",pdi1:"PDI1",pdi2:"PDI2",tpi:"TPI",dispatch:"Dispatch"},Ns=t=>{if(!t)return[];const s=t.trim().toLowerCase().replace(/\s+/g,"-");return Wh[s]||[]},rt=t=>{if(!t)return"";const s=t.trim().toLowerCase();return Jb[s]?Jb[s]:s.replace(/-/g," ").replace(/\b\w/g,r=>r.toUpperCase())},Zb=()=>Object.keys(Wh),fn=t=>{const s=t.trim().toLowerCase().replace(/\s+/g,"-");return(Wh[s]?.length??0)===0};function zq(t,s=[]){let r=[];function n(l,c){const u=d.createContext(c);u.displayName=l+"Context";const f=r.length;r=[...r,c];const h=w=>{const{scope:j,children:C,...k}=w,S=j?.[t]?.[f]||u,_=d.useMemo(()=>k,Object.values(k));return e.jsx(S.Provider,{value:_,children:C})};h.displayName=l+"Provider";function v(w,j){const C=j?.[t]?.[f]||u,k=d.useContext(C);if(k)return k;if(c!==void 0)return c;throw new Error(`\`${w}\` must be used within \`${l}\``)}return[h,v]}const a=()=>{const l=r.map(c=>d.createContext(c));return function(u){const f=u?.[t]||l;return d.useMemo(()=>({[`__scope${t}`]:{...u,[t]:f}}),[u,f])}};return a.scopeName=t,[n,$q(a,...s)]}function $q(...t){const s=t[0];if(t.length===1)return s;const r=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const c=n.reduce((u,{useScope:f,scopeName:h})=>{const w=f(l)[`__scope${h}`];return{...u,...w}},{});return d.useMemo(()=>({[`__scope${s.scopeName}`]:c}),[c])}};return r.scopeName=s.scopeName,r}var Qq=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Gh=Qq.reduce((t,s)=>{const r=Bx(`Primitive.${s}`),n=d.forwardRef((a,l)=>{const{asChild:c,...u}=a,f=c?r:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(f,{...u,ref:l})});return n.displayName=`Primitive.${s}`,{...t,[s]:n}},{}),ex={exports:{}},tx={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e1;function Uq(){if(e1)return tx;e1=1;var t=am();function s(w,j){return w===j&&(w!==0||1/w===1/j)||w!==w&&j!==j}var r=typeof Object.is=="function"?Object.is:s,n=t.useState,a=t.useEffect,l=t.useLayoutEffect,c=t.useDebugValue;function u(w,j){var C=j(),k=n({inst:{value:C,getSnapshot:j}}),S=k[0].inst,_=k[1];return l(function(){S.value=C,S.getSnapshot=j,f(S)&&_({inst:S})},[w,C,j]),a(function(){return f(S)&&_({inst:S}),w(function(){f(S)&&_({inst:S})})},[w]),c(C),C}function f(w){var j=w.getSnapshot;w=w.value;try{var C=j();return!r(w,C)}catch{return!0}}function h(w,j){return j()}var v=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:u;return tx.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:v,tx}var t1;function Vq(){return t1||(t1=1,ex.exports=Uq()),ex.exports}var Wq=Vq();function Gq(){return Wq.useSyncExternalStore(Hq,()=>!0,()=>!1)}function Hq(){return()=>{}}var Hh="Avatar",[Yq]=zq(Hh),[Kq,u2]=Yq(Hh),m2=d.forwardRef((t,s)=>{const{__scopeAvatar:r,...n}=t,[a,l]=d.useState("idle");return e.jsx(Kq,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:l,children:e.jsx(Gh.span,{...n,ref:s})})});m2.displayName=Hh;var p2="AvatarImage",x2=d.forwardRef((t,s)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:a=()=>{},...l}=t,c=u2(p2,r),u=Xq(n,l),f=Zn(h=>{a(h),c.onImageLoadingStatusChange(h)});return Sr(()=>{u!=="idle"&&f(u)},[u,f]),u==="loaded"?e.jsx(Gh.img,{...l,ref:s,src:n}):null});x2.displayName=p2;var h2="AvatarFallback",f2=d.forwardRef((t,s)=>{const{__scopeAvatar:r,delayMs:n,...a}=t,l=u2(h2,r),[c,u]=d.useState(n===void 0);return d.useEffect(()=>{if(n!==void 0){const f=window.setTimeout(()=>u(!0),n);return()=>window.clearTimeout(f)}},[n]),c&&l.imageLoadingStatus!=="loaded"?e.jsx(Gh.span,{...a,ref:s}):null});f2.displayName=h2;function s1(t,s){return t?s?(t.src!==s&&(t.src=s),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Xq(t,{referrerPolicy:s,crossOrigin:r}){const n=Gq(),a=d.useRef(null),l=n?(a.current||(a.current=new window.Image),a.current):null,[c,u]=d.useState(()=>s1(l,t));return Sr(()=>{u(s1(l,t))},[l,t]),Sr(()=>{const f=w=>()=>{u(w)};if(!l)return;const h=f("loaded"),v=f("error");return l.addEventListener("load",h),l.addEventListener("error",v),s&&(l.referrerPolicy=s),typeof r=="string"&&(l.crossOrigin=r),()=>{l.removeEventListener("load",h),l.removeEventListener("error",v)}},[l,r,s]),c}var g2=m2,y2=x2,v2=f2;const b2=d.forwardRef(({className:t,...s},r)=>e.jsx(g2,{ref:r,"data-slot":"avatar",className:js("relative flex size-10 shrink-0 overflow-hidden rounded-full",t),...s}));b2.displayName=g2.displayName;const w2=d.forwardRef(({className:t,...s},r)=>e.jsx(y2,{ref:r,"data-slot":"avatar-image",className:js("aspect-square size-full",t),...s}));w2.displayName=y2.displayName;const N2=d.forwardRef(({className:t,...s},r)=>e.jsx(v2,{ref:r,"data-slot":"avatar-fallback",className:js("bg-muted flex size-full items-center justify-center rounded-full",t),...s}));N2.displayName=v2.displayName;var sx="rovingFocusGroup.onEntryFocus",Jq={bubbles:!1,cancelable:!0},Yc="RovingFocusGroup",[Ax,j2,Zq]=Jx(Yc),[eB,S2]=Ga(Yc,[Zq]),[tB,sB]=eB(Yc),k2=d.forwardRef((t,s)=>e.jsx(Ax.Provider,{scope:t.__scopeRovingFocusGroup,children:e.jsx(Ax.Slot,{scope:t.__scopeRovingFocusGroup,children:e.jsx(rB,{...t,ref:s})})}));k2.displayName=Yc;var rB=d.forwardRef((t,s)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:l,currentTabStopId:c,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:f,onEntryFocus:h,preventScrollOnEntryFocus:v=!1,...w}=t,j=d.useRef(null),C=Ts(s,j),k=Zx(l),[S,_]=Ki({prop:c,defaultProp:u??null,onChange:f,caller:Yc}),[I,F]=d.useState(!1),B=Zn(h),q=j2(r),me=d.useRef(!1),[re,M]=d.useState(0);return d.useEffect(()=>{const W=j.current;if(W)return W.addEventListener(sx,B),()=>W.removeEventListener(sx,B)},[B]),e.jsx(tB,{scope:r,orientation:n,dir:k,loop:a,currentTabStopId:S,onItemFocus:d.useCallback(W=>_(W),[_]),onItemShiftTab:d.useCallback(()=>F(!0),[]),onFocusableItemAdd:d.useCallback(()=>M(W=>W+1),[]),onFocusableItemRemove:d.useCallback(()=>M(W=>W-1),[]),children:e.jsx(bs.div,{tabIndex:I||re===0?-1:0,"data-orientation":n,...w,ref:C,style:{outline:"none",...t.style},onMouseDown:rs(t.onMouseDown,()=>{me.current=!0}),onFocus:rs(t.onFocus,W=>{const oe=!me.current;if(W.target===W.currentTarget&&oe&&!I){const X=new CustomEvent(sx,Jq);if(W.currentTarget.dispatchEvent(X),!X.defaultPrevented){const he=q().filter(Y=>Y.focusable),ue=he.find(Y=>Y.active),_e=he.find(Y=>Y.id===S),Re=[ue,_e,...he].filter(Boolean).map(Y=>Y.ref.current);E2(Re,v)}}me.current=!1}),onBlur:rs(t.onBlur,()=>F(!1))})})}),C2="RovingFocusGroupItem",_2=d.forwardRef((t,s)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:l,children:c,...u}=t,f=ya(),h=l||f,v=sB(C2,r),w=v.currentTabStopId===h,j=j2(r),{onFocusableItemAdd:C,onFocusableItemRemove:k,currentTabStopId:S}=v;return d.useEffect(()=>{if(n)return C(),()=>k()},[n,C,k]),e.jsx(Ax.ItemSlot,{scope:r,id:h,focusable:n,active:a,children:e.jsx(bs.span,{tabIndex:w?0:-1,"data-orientation":v.orientation,...u,ref:s,onMouseDown:rs(t.onMouseDown,_=>{n?v.onItemFocus(h):_.preventDefault()}),onFocus:rs(t.onFocus,()=>v.onItemFocus(h)),onKeyDown:rs(t.onKeyDown,_=>{if(_.key==="Tab"&&_.shiftKey){v.onItemShiftTab();return}if(_.target!==_.currentTarget)return;const I=iB(_,v.orientation,v.dir);if(I!==void 0){if(_.metaKey||_.ctrlKey||_.altKey||_.shiftKey)return;_.preventDefault();let B=j().filter(q=>q.focusable).map(q=>q.ref.current);if(I==="last")B.reverse();else if(I==="prev"||I==="next"){I==="prev"&&B.reverse();const q=B.indexOf(_.currentTarget);B=v.loop?lB(B,q+1):B.slice(q+1)}setTimeout(()=>E2(B))}}),children:typeof c=="function"?c({isCurrentTabStop:w,hasTabStop:S!=null}):c})})});_2.displayName=C2;var nB={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function aB(t,s){return s!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function iB(t,s,r){const n=aB(t.key,r);if(!(s==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(s==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return nB[n]}function E2(t,s=!1){const r=document.activeElement;for(const n of t)if(n===r||(n.focus({preventScroll:s}),document.activeElement!==r))return}function lB(t,s){return t.map((r,n)=>t[(s+n)%t.length])}var oB=k2,cB=_2;function dB(t){const s=uB(t),r=d.forwardRef((n,a)=>{const{children:l,...c}=n,u=d.Children.toArray(l),f=u.find(pB);if(f){const h=f.props.children,v=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(s,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,v):null})}return e.jsx(s,{...c,ref:a,children:l})});return r.displayName=`${t}.Slot`,r}function uB(t){const s=d.forwardRef((r,n)=>{const{children:a,...l}=r;if(d.isValidElement(a)){const c=hB(a),u=xB(l,a.props);return a.type!==d.Fragment&&(u.ref=n?ka(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var mB=Symbol("radix.slottable");function pB(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===mB}function xB(t,s){const r={...s};for(const n in s){const a=t[n],l=s[n];/^on[A-Z]/.test(n)?a&&l?r[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(r[n]=a):n==="style"?r[n]={...a,...l}:n==="className"&&(r[n]=[a,l].filter(Boolean).join(" "))}return{...t,...r}}function hB(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Tx=["Enter"," "],fB=["ArrowDown","PageUp","Home"],P2=["ArrowUp","PageDown","End"],gB=[...fB,...P2],yB={ltr:[...Tx,"ArrowRight"],rtl:[...Tx,"ArrowLeft"]},vB={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Kc="Menu",[Sc,bB,wB]=Jx(Kc),[ul,A2]=Ga(Kc,[wB,mo,S2]),Mm=mo(),T2=S2(),[NB,ml]=ul(Kc),[jB,Xc]=ul(Kc),O2=t=>{const{__scopeMenu:s,open:r=!1,children:n,dir:a,onOpenChange:l,modal:c=!0}=t,u=Mm(s),[f,h]=d.useState(null),v=d.useRef(!1),w=Zn(l),j=Zx(a);return d.useEffect(()=>{const C=()=>{v.current=!0,document.addEventListener("pointerdown",k,{capture:!0,once:!0}),document.addEventListener("pointermove",k,{capture:!0,once:!0})},k=()=>v.current=!1;return document.addEventListener("keydown",C,{capture:!0}),()=>{document.removeEventListener("keydown",C,{capture:!0}),document.removeEventListener("pointerdown",k,{capture:!0}),document.removeEventListener("pointermove",k,{capture:!0})}},[]),e.jsx(oh,{...u,children:e.jsx(NB,{scope:s,open:r,onOpenChange:w,content:f,onContentChange:h,children:e.jsx(jB,{scope:s,onClose:d.useCallback(()=>w(!1),[w]),isUsingKeyboardRef:v,dir:j,modal:c,children:n})})})};O2.displayName=Kc;var SB="MenuAnchor",Yh=d.forwardRef((t,s)=>{const{__scopeMenu:r,...n}=t,a=Mm(r);return e.jsx(jm,{...a,...n,ref:s})});Yh.displayName=SB;var Kh="MenuPortal",[kB,R2]=ul(Kh,{forceMount:void 0}),D2=t=>{const{__scopeMenu:s,forceMount:r,children:n,container:a}=t,l=ml(Kh,s);return e.jsx(kB,{scope:s,forceMount:r,children:e.jsx(aa,{present:r||l.open,children:e.jsx(Lc,{asChild:!0,container:a,children:n})})})};D2.displayName=Kh;var In="MenuContent",[CB,Xh]=ul(In),L2=d.forwardRef((t,s)=>{const r=R2(In,t.__scopeMenu),{forceMount:n=r.forceMount,...a}=t,l=ml(In,t.__scopeMenu),c=Xc(In,t.__scopeMenu);return e.jsx(Sc.Provider,{scope:t.__scopeMenu,children:e.jsx(aa,{present:n||l.open,children:e.jsx(Sc.Slot,{scope:t.__scopeMenu,children:c.modal?e.jsx(_B,{...a,ref:s}):e.jsx(EB,{...a,ref:s})})})})}),_B=d.forwardRef((t,s)=>{const r=ml(In,t.__scopeMenu),n=d.useRef(null),a=Ts(s,n);return d.useEffect(()=>{const l=n.current;if(l)return gm(l)},[]),e.jsx(Jh,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:rs(t.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),EB=d.forwardRef((t,s)=>{const r=ml(In,t.__scopeMenu);return e.jsx(Jh,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),PB=dB("MenuContent.ScrollLock"),Jh=d.forwardRef((t,s)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:l,onCloseAutoFocus:c,disableOutsidePointerEvents:u,onEntryFocus:f,onEscapeKeyDown:h,onPointerDownOutside:v,onFocusOutside:w,onInteractOutside:j,onDismiss:C,disableOutsideScroll:k,...S}=t,_=ml(In,r),I=Xc(In,r),F=Mm(r),B=T2(r),q=bB(r),[me,re]=d.useState(null),M=d.useRef(null),W=Ts(s,M,_.onContentChange),oe=d.useRef(0),X=d.useRef(""),he=d.useRef(0),ue=d.useRef(null),_e=d.useRef("right"),ke=d.useRef(0),Re=k?Fc:d.Fragment,Y=k?{as:PB,allowPinchZoom:!0}:void 0,ve=be=>{const pe=X.current+be,ne=q().filter(fe=>!fe.disabled),U=document.activeElement,ce=ne.find(fe=>fe.ref.current===U)?.textValue,z=ne.map(fe=>fe.textValue),ae=zB(z,pe,ce),ye=ne.find(fe=>fe.textValue===ae)?.ref.current;(function fe(Ee){X.current=Ee,window.clearTimeout(oe.current),Ee!==""&&(oe.current=window.setTimeout(()=>fe(""),1e3))})(pe),ye&&setTimeout(()=>ye.focus())};d.useEffect(()=>()=>window.clearTimeout(oe.current),[]),hm();const Q=d.useCallback(be=>_e.current===ue.current?.side&&QB(be,ue.current?.area),[]);return e.jsx(CB,{scope:r,searchRef:X,onItemEnter:d.useCallback(be=>{Q(be)&&be.preventDefault()},[Q]),onItemLeave:d.useCallback(be=>{Q(be)||(M.current?.focus(),re(null))},[Q]),onTriggerLeave:d.useCallback(be=>{Q(be)&&be.preventDefault()},[Q]),pointerGraceTimerRef:he,onPointerGraceIntentChange:d.useCallback(be=>{ue.current=be},[]),children:e.jsx(Re,{...Y,children:e.jsx(Dc,{asChild:!0,trapped:a,onMountAutoFocus:rs(l,be=>{be.preventDefault(),M.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:e.jsx(Rc,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:h,onPointerDownOutside:v,onFocusOutside:w,onInteractOutside:j,onDismiss:C,children:e.jsx(oB,{asChild:!0,...B,dir:I.dir,orientation:"vertical",loop:n,currentTabStopId:me,onCurrentTabStopIdChange:re,onEntryFocus:rs(f,be=>{I.isUsingKeyboardRef.current||be.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(ch,{role:"menu","aria-orientation":"vertical","data-state":X2(_.open),"data-radix-menu-content":"",dir:I.dir,...F,...S,ref:W,style:{outline:"none",...S.style},onKeyDown:rs(S.onKeyDown,be=>{const ne=be.target.closest("[data-radix-menu-content]")===be.currentTarget,U=be.ctrlKey||be.altKey||be.metaKey,ce=be.key.length===1;ne&&(be.key==="Tab"&&be.preventDefault(),!U&&ce&&ve(be.key));const z=M.current;if(be.target!==z||!gB.includes(be.key))return;be.preventDefault();const ye=q().filter(fe=>!fe.disabled).map(fe=>fe.ref.current);P2.includes(be.key)&&ye.reverse(),qB(ye)}),onBlur:rs(t.onBlur,be=>{be.currentTarget.contains(be.target)||(window.clearTimeout(oe.current),X.current="")}),onPointerMove:rs(t.onPointerMove,kc(be=>{const pe=be.target,ne=ke.current!==be.clientX;if(be.currentTarget.contains(pe)&&ne){const U=be.clientX>ke.current?"right":"left";_e.current=U,ke.current=be.clientX}}))})})})})})})});L2.displayName=In;var AB="MenuGroup",Zh=d.forwardRef((t,s)=>{const{__scopeMenu:r,...n}=t;return e.jsx(bs.div,{role:"group",...n,ref:s})});Zh.displayName=AB;var TB="MenuLabel",F2=d.forwardRef((t,s)=>{const{__scopeMenu:r,...n}=t;return e.jsx(bs.div,{...n,ref:s})});F2.displayName=TB;var rm="MenuItem",r1="menu.itemSelect",Im=d.forwardRef((t,s)=>{const{disabled:r=!1,onSelect:n,...a}=t,l=d.useRef(null),c=Xc(rm,t.__scopeMenu),u=Xh(rm,t.__scopeMenu),f=Ts(s,l),h=d.useRef(!1),v=()=>{const w=l.current;if(!r&&w){const j=new CustomEvent(r1,{bubbles:!0,cancelable:!0});w.addEventListener(r1,C=>n?.(C),{once:!0}),q1(w,j),j.defaultPrevented?h.current=!1:c.onClose()}};return e.jsx(M2,{...a,ref:f,disabled:r,onClick:rs(t.onClick,v),onPointerDown:w=>{t.onPointerDown?.(w),h.current=!0},onPointerUp:rs(t.onPointerUp,w=>{h.current||w.currentTarget?.click()}),onKeyDown:rs(t.onKeyDown,w=>{const j=u.searchRef.current!=="";r||j&&w.key===" "||Tx.includes(w.key)&&(w.currentTarget.click(),w.preventDefault())})})});Im.displayName=rm;var M2=d.forwardRef((t,s)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...l}=t,c=Xh(rm,r),u=T2(r),f=d.useRef(null),h=Ts(s,f),[v,w]=d.useState(!1),[j,C]=d.useState("");return d.useEffect(()=>{const k=f.current;k&&C((k.textContent??"").trim())},[l.children]),e.jsx(Sc.ItemSlot,{scope:r,disabled:n,textValue:a??j,children:e.jsx(cB,{asChild:!0,...u,focusable:!n,children:e.jsx(bs.div,{role:"menuitem","data-highlighted":v?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...l,ref:h,onPointerMove:rs(t.onPointerMove,kc(k=>{n?c.onItemLeave(k):(c.onItemEnter(k),k.defaultPrevented||k.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:rs(t.onPointerLeave,kc(k=>c.onItemLeave(k))),onFocus:rs(t.onFocus,()=>w(!0)),onBlur:rs(t.onBlur,()=>w(!1))})})})}),OB="MenuCheckboxItem",I2=d.forwardRef((t,s)=>{const{checked:r=!1,onCheckedChange:n,...a}=t;return e.jsx(Q2,{scope:t.__scopeMenu,checked:r,children:e.jsx(Im,{role:"menuitemcheckbox","aria-checked":nm(r)?"mixed":r,...a,ref:s,"data-state":tf(r),onSelect:rs(a.onSelect,()=>n?.(nm(r)?!0:!r),{checkForDefaultPrevented:!1})})})});I2.displayName=OB;var q2="MenuRadioGroup",[RB,DB]=ul(q2,{value:void 0,onValueChange:()=>{}}),B2=d.forwardRef((t,s)=>{const{value:r,onValueChange:n,...a}=t,l=Zn(n);return e.jsx(RB,{scope:t.__scopeMenu,value:r,onValueChange:l,children:e.jsx(Zh,{...a,ref:s})})});B2.displayName=q2;var z2="MenuRadioItem",$2=d.forwardRef((t,s)=>{const{value:r,...n}=t,a=DB(z2,t.__scopeMenu),l=r===a.value;return e.jsx(Q2,{scope:t.__scopeMenu,checked:l,children:e.jsx(Im,{role:"menuitemradio","aria-checked":l,...n,ref:s,"data-state":tf(l),onSelect:rs(n.onSelect,()=>a.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});$2.displayName=z2;var ef="MenuItemIndicator",[Q2,LB]=ul(ef,{checked:!1}),U2=d.forwardRef((t,s)=>{const{__scopeMenu:r,forceMount:n,...a}=t,l=LB(ef,r);return e.jsx(aa,{present:n||nm(l.checked)||l.checked===!0,children:e.jsx(bs.span,{...a,ref:s,"data-state":tf(l.checked)})})});U2.displayName=ef;var FB="MenuSeparator",V2=d.forwardRef((t,s)=>{const{__scopeMenu:r,...n}=t;return e.jsx(bs.div,{role:"separator","aria-orientation":"horizontal",...n,ref:s})});V2.displayName=FB;var MB="MenuArrow",W2=d.forwardRef((t,s)=>{const{__scopeMenu:r,...n}=t,a=Mm(r);return e.jsx(dh,{...a,...n,ref:s})});W2.displayName=MB;var IB="MenuSub",[b$,G2]=ul(IB),ic="MenuSubTrigger",H2=d.forwardRef((t,s)=>{const r=ml(ic,t.__scopeMenu),n=Xc(ic,t.__scopeMenu),a=G2(ic,t.__scopeMenu),l=Xh(ic,t.__scopeMenu),c=d.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:f}=l,h={__scopeMenu:t.__scopeMenu},v=d.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return d.useEffect(()=>v,[v]),d.useEffect(()=>{const w=u.current;return()=>{window.clearTimeout(w),f(null)}},[u,f]),e.jsx(Yh,{asChild:!0,...h,children:e.jsx(M2,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":X2(r.open),...t,ref:ka(s,a.onTriggerChange),onClick:w=>{t.onClick?.(w),!(t.disabled||w.defaultPrevented)&&(w.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:rs(t.onPointerMove,kc(w=>{l.onItemEnter(w),!w.defaultPrevented&&!t.disabled&&!r.open&&!c.current&&(l.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{r.onOpenChange(!0),v()},100))})),onPointerLeave:rs(t.onPointerLeave,kc(w=>{v();const j=r.content?.getBoundingClientRect();if(j){const C=r.content?.dataset.side,k=C==="right",S=k?-5:5,_=j[k?"left":"right"],I=j[k?"right":"left"];l.onPointerGraceIntentChange({area:[{x:w.clientX+S,y:w.clientY},{x:_,y:j.top},{x:I,y:j.top},{x:I,y:j.bottom},{x:_,y:j.bottom}],side:C}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>l.onPointerGraceIntentChange(null),300)}else{if(l.onTriggerLeave(w),w.defaultPrevented)return;l.onPointerGraceIntentChange(null)}})),onKeyDown:rs(t.onKeyDown,w=>{const j=l.searchRef.current!=="";t.disabled||j&&w.key===" "||yB[n.dir].includes(w.key)&&(r.onOpenChange(!0),r.content?.focus(),w.preventDefault())})})})});H2.displayName=ic;var Y2="MenuSubContent",K2=d.forwardRef((t,s)=>{const r=R2(In,t.__scopeMenu),{forceMount:n=r.forceMount,...a}=t,l=ml(In,t.__scopeMenu),c=Xc(In,t.__scopeMenu),u=G2(Y2,t.__scopeMenu),f=d.useRef(null),h=Ts(s,f);return e.jsx(Sc.Provider,{scope:t.__scopeMenu,children:e.jsx(aa,{present:n||l.open,children:e.jsx(Sc.Slot,{scope:t.__scopeMenu,children:e.jsx(Jh,{id:u.contentId,"aria-labelledby":u.triggerId,...a,ref:h,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:v=>{c.isUsingKeyboardRef.current&&f.current?.focus(),v.preventDefault()},onCloseAutoFocus:v=>v.preventDefault(),onFocusOutside:rs(t.onFocusOutside,v=>{v.target!==u.trigger&&l.onOpenChange(!1)}),onEscapeKeyDown:rs(t.onEscapeKeyDown,v=>{c.onClose(),v.preventDefault()}),onKeyDown:rs(t.onKeyDown,v=>{const w=v.currentTarget.contains(v.target),j=vB[c.dir].includes(v.key);w&&j&&(l.onOpenChange(!1),u.trigger?.focus(),v.preventDefault())})})})})})});K2.displayName=Y2;function X2(t){return t?"open":"closed"}function nm(t){return t==="indeterminate"}function tf(t){return nm(t)?"indeterminate":t?"checked":"unchecked"}function qB(t){const s=document.activeElement;for(const r of t)if(r===s||(r.focus(),document.activeElement!==s))return}function BB(t,s){return t.map((r,n)=>t[(s+n)%t.length])}function zB(t,s,r){const a=s.length>1&&Array.from(s).every(h=>h===s[0])?s[0]:s,l=r?t.indexOf(r):-1;let c=BB(t,Math.max(l,0));a.length===1&&(c=c.filter(h=>h!==r));const f=c.find(h=>h.toLowerCase().startsWith(a.toLowerCase()));return f!==r?f:void 0}function $B(t,s){const{x:r,y:n}=t;let a=!1;for(let l=0,c=s.length-1;l<s.length;c=l++){const u=s[l],f=s[c],h=u.x,v=u.y,w=f.x,j=f.y;v>n!=j>n&&r<(w-h)*(n-v)/(j-v)+h&&(a=!a)}return a}function QB(t,s){if(!s)return!1;const r={x:t.clientX,y:t.clientY};return $B(r,s)}function kc(t){return s=>s.pointerType==="mouse"?t(s):void 0}var UB=O2,VB=Yh,WB=D2,GB=L2,HB=Zh,YB=F2,KB=Im,XB=I2,JB=B2,ZB=$2,ez=U2,tz=V2,sz=W2,rz=H2,nz=K2,qm="DropdownMenu",[az]=Ga(qm,[A2]),tn=A2(),[iz,J2]=az(qm),Z2=t=>{const{__scopeDropdownMenu:s,children:r,dir:n,open:a,defaultOpen:l,onOpenChange:c,modal:u=!0}=t,f=tn(s),h=d.useRef(null),[v,w]=Ki({prop:a,defaultProp:l??!1,onChange:c,caller:qm});return e.jsx(iz,{scope:s,triggerId:ya(),triggerRef:h,contentId:ya(),open:v,onOpenChange:w,onOpenToggle:d.useCallback(()=>w(j=>!j),[w]),modal:u,children:e.jsx(UB,{...f,open:v,onOpenChange:w,dir:n,modal:u,children:r})})};Z2.displayName=qm;var ek="DropdownMenuTrigger",tk=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=t,l=J2(ek,r),c=tn(r);return e.jsx(VB,{asChild:!0,...c,children:e.jsx(bs.button,{type:"button",id:l.triggerId,"aria-haspopup":"menu","aria-expanded":l.open,"aria-controls":l.open?l.contentId:void 0,"data-state":l.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:ka(s,l.triggerRef),onPointerDown:rs(t.onPointerDown,u=>{!n&&u.button===0&&u.ctrlKey===!1&&(l.onOpenToggle(),l.open||u.preventDefault())}),onKeyDown:rs(t.onKeyDown,u=>{n||(["Enter"," "].includes(u.key)&&l.onOpenToggle(),u.key==="ArrowDown"&&l.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(u.key)&&u.preventDefault())})})})});tk.displayName=ek;var lz="DropdownMenuPortal",sk=t=>{const{__scopeDropdownMenu:s,...r}=t,n=tn(s);return e.jsx(WB,{...n,...r})};sk.displayName=lz;var rk="DropdownMenuContent",nk=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=J2(rk,r),l=tn(r),c=d.useRef(!1);return e.jsx(GB,{id:a.contentId,"aria-labelledby":a.triggerId,...l,...n,ref:s,onCloseAutoFocus:rs(t.onCloseAutoFocus,u=>{c.current||a.triggerRef.current?.focus(),c.current=!1,u.preventDefault()}),onInteractOutside:rs(t.onInteractOutside,u=>{const f=u.detail.originalEvent,h=f.button===0&&f.ctrlKey===!0,v=f.button===2||h;(!a.modal||v)&&(c.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});nk.displayName=rk;var oz="DropdownMenuGroup",cz=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=tn(r);return e.jsx(HB,{...a,...n,ref:s})});cz.displayName=oz;var dz="DropdownMenuLabel",uz=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=tn(r);return e.jsx(YB,{...a,...n,ref:s})});uz.displayName=dz;var mz="DropdownMenuItem",ak=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=tn(r);return e.jsx(KB,{...a,...n,ref:s})});ak.displayName=mz;var pz="DropdownMenuCheckboxItem",xz=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=tn(r);return e.jsx(XB,{...a,...n,ref:s})});xz.displayName=pz;var hz="DropdownMenuRadioGroup",fz=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=tn(r);return e.jsx(JB,{...a,...n,ref:s})});fz.displayName=hz;var gz="DropdownMenuRadioItem",yz=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=tn(r);return e.jsx(ZB,{...a,...n,ref:s})});yz.displayName=gz;var vz="DropdownMenuItemIndicator",bz=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=tn(r);return e.jsx(ez,{...a,...n,ref:s})});bz.displayName=vz;var wz="DropdownMenuSeparator",Nz=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=tn(r);return e.jsx(tz,{...a,...n,ref:s})});Nz.displayName=wz;var jz="DropdownMenuArrow",Sz=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=tn(r);return e.jsx(sz,{...a,...n,ref:s})});Sz.displayName=jz;var kz="DropdownMenuSubTrigger",Cz=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=tn(r);return e.jsx(rz,{...a,...n,ref:s})});Cz.displayName=kz;var _z="DropdownMenuSubContent",Ez=d.forwardRef((t,s)=>{const{__scopeDropdownMenu:r,...n}=t,a=tn(r);return e.jsx(nz,{...a,...n,ref:s,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Ez.displayName=_z;var Pz=Z2,Az=tk,Tz=sk,Oz=nk,Rz=ak;function Dz({...t}){return e.jsx(Pz,{"data-slot":"dropdown-menu",...t})}function Lz({...t}){return e.jsx(Az,{"data-slot":"dropdown-menu-trigger",...t})}function Fz({className:t,sideOffset:s=4,...r}){return e.jsx(Tz,{children:e.jsx(Oz,{"data-slot":"dropdown-menu-content",sideOffset:s,className:js("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...r})})}function Mz({className:t,inset:s,variant:r="default",...n}){return e.jsx(Rz,{"data-slot":"dropdown-menu-item","data-inset":s,"data-variant":r,className:js("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n})}const or=({onLogout:t,currentPage:s="Dashboard",onNavigate:r,onUploadSuccess:n,role:a})=>{const[l,c]=d.useState(!1),[u,f]=d.useState(!1),h=pe=>{c(pe),pe&&(I(null),B(null),M(null),oe(null),S(!1),w(null),q.current&&(q.current.value=""))},[v,w]=d.useState(null),[j,C]=d.useState(!1),[k,S]=d.useState(!1),[_,I]=d.useState(null),[F,B]=d.useState(null),q=d.useRef(null),me=localStorage.getItem("token"),[re,M]=d.useState(null),[W,oe]=d.useState(null),X=async pe=>{if(pe.preventDefault(),!v){I("warning"),B(" Please select a file first.");return}const ne=new FormData;ne.append("file",v);try{S(!0),M(null),B("Uploading..."),I(null);const U=await ht.post("https://plan.gmvalve.in/backend/api/upload-order-file",ne,{headers:{Authorization:`Bearer ${me}`}}),{Resp_code:ce,Resp_desc:z,file_url:ae}=U.data;if(console.log("Upload Response:",U.data),ce==="true"){I("success"),B("File imported successfully!"),M(null),oe(null),w(null),q.current&&(q.current.value=""),n?.(),c(!1);try{window.location.reload()}catch{}}else z?.toLowerCase().includes("header mismatch")?(I("error"),B(" Header mismatch found in your Excel file."),M(ae||null),oe("header")):z?.toLowerCase().includes("validation errors")?(I("error"),B("Validation errors found in uploaded data."),M(ae||null),oe("validation")):(I("error"),B(` ${z||"Error uploading file."}`),M(null),oe(null))}catch(U){console.error("Upload Error:",U),I("error"),B(" Error uploading file.")}finally{S(!1)}},he=pe=>{const ne=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"],ce=[".xlsx",".xls",".csv"].some(z=>pe.name.toLowerCase().endsWith(z));ne.includes(pe.type)||ce?(w(pe),B(null)):(I("error"),B(" Please select a valid Excel (.xlsx, .xls) or CSV (.csv) file."))},ue=pe=>{pe.preventDefault(),C(!1);const ne=pe.dataTransfer.files[0];ne&&he(ne)},_e=pe=>{pe.preventDefault(),C(!0)},ke=pe=>{pe.preventDefault(),C(!1)},Re=()=>q.current?.click(),Y=pe=>{const ne=pe.target.files?.[0];ne&&he(ne)},ve=()=>{w(null),q.current&&(q.current.value="")},Q=[{id:"Dashboard",label:"Dashboard"},{id:"Planning",label:"Planning"},{id:"MaterialIssue",label:"Material Issue"},{id:"SemiQC",label:"Semi QC"},{id:"PhosphatingQC",label:"After Phosphating QC"},{id:"Assembly-A",label:"Assembly A"},{id:"Assembly-B",label:"Assembly B"},{id:"Assembly-C",label:"Assembly C"},{id:"Assembly-D",label:"Assembly D"},{id:"Testing",label:"Testing"},{id:"SVS",label:"SVS"},{id:"Marking",label:"Marking"},{id:"PDI",label:"PDI"},{id:"TPI",label:"TPI"},{id:"Dispatch",label:"Dispatch"}],be={planning:["Planning"],"material-issue":["MaterialIssue"],"semi-qc":["SemiQC"],"phosphating-qc":["PhosphatingQC"],"assembly-a":["Assembly-A"],"assembly-b":["Assembly-B"],"assembly-c":["Assembly-C"],"assembly-d":["Assembly-D"],testing:["Testing"],marking:["Marking"],svs:["SVS"],pdi:["PDI"],tpi:["TPI"],dispatch:["Dispatch"],admin:Q.map(pe=>pe.id)};return a&&be[a]&&Q.filter(pe=>be[a].includes(pe.id)),e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"glass-header relative z-50",children:e.jsx("div",{className:"mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx("div",{className:"flex items-center space-x-8",children:e.jsx("img",{src:rw,alt:"GM Logo",className:"h-8 w-auto object-contain"})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[a==="planning"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mobile-only",children:[e.jsx("button",{className:"w-full flex items-center justify-center gap-2 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm px-3 py-2 rounded-md","aria-label":"Menu",onClick:()=>f(pe=>!pe),children:e.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),e.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),e.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),u&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 rounded-md bg-white shadow-lg border z-50",children:[e.jsxs("button",{className:"w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center gap-2",onClick:()=>{const pe=["Assembly Line","SOA No.","SR.No.","Assembly Date","Unique Code","Splitted Code","Party","Customer PO No.","Code No","Product","Po Qty","Qty","Qty Exe.","Qty Pending","finished valve","GM Logo","Name Plate","Special Notes","Product Spcl 1","Product Spcl 2","Product Spcl 3","Inspection","Painting","Remarks"],ne={};pe.forEach(z=>ne[z]=""),ne["Assembly Date"]="(dd-mm-yyyy)";const U=Ht.json_to_sheet([ne]),ce=Ht.book_new();Ht.book_append_sheet(ce,U,"Order Format"),Yb(ce,"GMV_Order_Format.xlsx"),f(!1)},children:[e.jsx(uv,{className:"h-4 w-4 text-[#174a9f]"}),"Demo Excel"]}),e.jsxs("button",{className:"w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center gap-2",onClick:()=>{c(!0),f(!1)},children:[e.jsx(pv,{className:"h-4 w-4 text-[#174a9f]"}),"Add New Order"]})]})]}),e.jsxs("div",{className:"desktop-only gap-2 justify-end",children:[e.jsxs(J,{variant:"outline",onClick:()=>{const pe=["Assembly Line","SOA No.","SR.No.","Assembly Date","Unique Code","Splitted Code","Party","Customer PO No.","Code No","Product","Po Qty","Qty","Qty Exe.","Qty Pending","finished valve","GM Logo","Name Plate","Special Notes","Product Spcl 1","Product Spcl 2","Product Spcl 3","Inspection","Painting","Remarks"],ne={};pe.forEach(z=>ne[z]=""),ne["Assembly Date"]="(dd-mm-yyyy)";const U=Ht.json_to_sheet([ne]),ce=Ht.book_new();Ht.book_append_sheet(ce,U,"Order Format"),Yb(ce,"GMV_Order_Format.xlsx")},className:"flex items-center gap-2 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(uv,{className:"h-4 w-4"}),"Demo Excel"]}),e.jsxs(J,{variant:"outline",onClick:()=>c(!0),className:"flex items-center gap-2 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(pv,{className:"h-4 w-4"}),"Add New Order"]})]})]}),e.jsxs(J,{variant:"ghost",size:"sm",className:"h-9 w-9 p-0 rounded-lg hover:bg-gray-100 relative",children:[e.jsx(FE,{className:"h-4 w-4 text-gray-500"}),e.jsx("div",{className:"absolute -top-1 -right-1 h-2 w-2 bg-red-500 rounded-full"})]}),e.jsxs(Dz,{children:[e.jsx(Lz,{asChild:!0,children:e.jsxs(b2,{className:"h-9 w-9 cursor-pointer ring-2 ring-transparent hover:ring-[#a3c4e7] transition-all duration-300 hover:scale-110",children:[e.jsx(w2,{src:"/api/placeholder/36/36"}),e.jsx(N2,{className:"bg-gradient-to-br from-[#2461c7] to-[#174a9f] text-white text-sm font-medium",children:"GM"})]})}),e.jsx(Fz,{align:"end",className:"w-48 mt-2",children:e.jsxs(Mz,{onClick:t,className:"text-red-600 cursor-pointer focus:bg-red-50",children:[e.jsx(a4,{className:"h-4 w-4 mr-2"}),"Sign Out"]})})]})]})]})})}),e.jsx(Rt,{open:l,onOpenChange:h,children:e.jsxs(Tt,{className:"max-w-lg mx-auto bg-white rounded-2xl shadow-2xl border-0",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-2xl font-semibold text-gray-900 text-center",children:"Add New Order"}),e.jsx(Mt,{className:"text-gray-600 text-center",children:"Upload an Excel or CSV file to add new orders to your system."})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:`
          relative border-2 border-dashed rounded-xl p-8 text-center transition-all duration-200
          ${j?"border-[#174a9f] bg-[#e8f0f9]":"border-gray-300 hover:border-gray-400"}
          ${v?"bg-green-50 border-green-300":""}
        `,onDrop:ue,onDragOver:_e,onDragLeave:ke,children:v?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(s4,{className:"w-6 h-6 text-green-600"})}),e.jsx("p",{className:"font-medium text-gray-900",children:v.name}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[(v.size/1024).toFixed(1)," KB"]}),e.jsxs(J,{variant:"outline",size:"sm",onClick:ve,className:"text-red-600 border-red-200 hover:bg-red-50",children:[e.jsx(Ux,{className:"w-4 h-4 mr-2"}),"Remove File"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(y4,{className:"w-6 h-6 text-gray-600"})}),e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Drag and drop your file here"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"or"}),e.jsx(J,{variant:"outline",onClick:Re,className:"border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9]",children:"Choose File"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Supports Excel files (.xlsx, .xls) and CSV files (.csv)"})]})}),F&&e.jsxs("div",{className:`flex flex-col gap-2 text-sm p-3 rounded-md ${_==="success"?"bg-green-50 text-green-700 border border-green-200":_==="warning"?"bg-yellow-50 text-yellow-700 border border-yellow-200":_==="error"?"bg-red-50 text-red-700 border border-red-200":"text-gray-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[_==="success"&&e.jsx(WE,{className:"h-4 w-4"}),_==="warning"&&e.jsx(f4,{className:"h-4 w-4"}),_==="error"&&e.jsx(ew,{className:"h-4 w-4"}),e.jsx("span",{children:F})]}),re&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:W==="header"?"Your uploaded Excel headers dont match the required format.":"Validation errors found in uploaded Excel data."}),e.jsx("a",{href:re,download:"Error_Report.xlsx",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline hover:text-blue-800 text-sm",children:"Download error report"})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>c(!1),className:"px-6",children:"Cancel"}),e.jsx(J,{onClick:X,disabled:!v||k,className:"px-6 bg-[#1457f6] hover:bg-[#1145d4] text-white shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:k?"Uploading...":"Submit"})]})]}),e.jsx("input",{type:"file",ref:q,onChange:Y,accept:".xlsx,.xls,.csv",className:"hidden"})]})})]})};function Iz({className:t,...s}){return e.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:js("mx-auto flex w-full justify-center",t),...s})}function qz({className:t,...s}){return e.jsx("ul",{"data-slot":"pagination-content",className:js("flex flex-row items-center gap-1",t),...s})}function rx({...t}){return e.jsx("li",{"data-slot":"pagination-item",...t})}function sf({className:t,isActive:s,size:r="icon",...n}){return e.jsx("a",{"aria-current":s?"page":void 0,"data-slot":"pagination-link","data-active":s,className:js(Ou({variant:s?"outline":"ghost",size:r}),t),...n})}function Bz({className:t,...s}){return e.jsxs(sf,{"aria-label":"Go to previous page",size:"default",className:js("gap-1 px-2.5 sm:pl-2.5",t),...s,children:[e.jsx(K1,{}),e.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function zz({className:t,...s}){return e.jsxs(sf,{"aria-label":"Go to next page",size:"default",className:js("gap-1 px-2.5 sm:pr-2.5",t),...s,children:[e.jsx("span",{className:"hidden sm:block",children:"Next"}),e.jsx(X1,{})]})}function cr({page:t,perPage:s,total:r,lastPage:n,onChangePage:a,onChangePerPage:l,disabled:c}){const u=t>1,f=t<Math.max(n,1);return e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",t," of ",Math.max(n,1),"  Total ",r]}),e.jsxs("div",{className:"flex items-center gap-3",children:[l&&e.jsxs("select",{value:s,onChange:h=>{a(1),l(Number(h.target.value))},className:"border rounded px-2 py-1 text-sm",disabled:c,children:[e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:300,children:"300"}),e.jsx("option",{value:500,children:"500"})]}),e.jsx(Iz,{className:"justify-end",children:e.jsxs(qz,{children:[e.jsx(rx,{children:e.jsx(Bz,{href:"#",onClick:h=>{h.preventDefault(),u&&a(t-1)},"aria-disabled":!u})}),e.jsx(rx,{children:e.jsx(sf,{href:"#",isActive:!0,children:t})}),e.jsx(rx,{children:e.jsx(zz,{href:"#",onClick:h=>{h.preventDefault(),f&&a(t+1)},"aria-disabled":!f})})]})})]})]})}function rf(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(0),[F,B]=d.useState(1),[q,me]=d.useState(null),[re,M]=d.useState(""),[W,oe]=d.useState(!1),[X,he]=d.useState(!1),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("all"),[Y,ve]=d.useState("all"),[Q,be]=d.useState("single"),[pe,ne]=d.useState(void 0),[U,ce]=d.useState(void 0),[z,ae]=d.useState(new Set),[ye,fe]=d.useState(!1),[Ee,Le]=d.useState(null),[De,Ve]=d.useState(""),[et,Nt]=d.useState(""),[ot,Qt]=d.useState(!1),[qe,Me]=d.useState(""),[mt,it]=d.useState(""),[Et,pt]=d.useState({}),[xe,tt]=d.useState(!1),[lt,Ue]=d.useState(!1),[He,zt]=d.useState(null),[gt,jt]=d.useState(!1),[ct,Yt]=d.useState(null),[Z,Ze]=d.useState(""),[nt,Ke]=d.useState(null),[kt,wt]=d.useState(!1),[$t,At]=d.useState(null);d.useRef(null);const Vt=d.useRef(null),Ot=localStorage.getItem("token"),yt=async()=>{try{h(!0),w(null);const N=rt("material-issue"),R=(()=>{try{const se=localStorage.getItem("user");if(!se)return"";const Ie=JSON.parse(se),$e=typeof Ie.role=="object"?Ie.role?.name:Ie.role;return String($e||"").toLowerCase()}catch{return""}})().includes("admin"),L={menu_name:N,page:j,per_page:k},Ne=await ht.post(`${qt}/order-list`,L,{headers:{Authorization:`Bearer ${Ot}`}});if((Ne?.data?.Resp_code==="true"||Ne?.data?.Resp_code===!0||Ne?.data?.Resp_code==="RCS")&&Array.isArray(Ne.data.data)){const se=Ne.data.data.map(($e,te)=>({id:String($e.id),assemblyLine:$e.assembly_no||"",gmsoaNo:$e.soa_no||"",soaSrNo:$e.soa_sr_no||"",assemblyDate:$e.assembly_date||"",uniqueCode:$e.unique_code||$e.order_no||"",split_id:$e.split_id||"",splittedCode:$e.splitted_code||"",party:$e.party_name||$e.party||"",customerPoNo:$e.customer_po_no||"",codeNo:$e.code_no||"",product:$e.product||"",qty:Number($e.qty||0),totalQty:Number($e.totalQty||$e.total_qty||$e.qty||0),qtyExe:Number($e.qty_executed||0),qtyPending:Number($e.qty_pending||0),finishedValve:$e.finished_valve||"",gmLogo:$e.gm_logo||"",namePlate:$e.name_plate||"",specialNotes:$e.special_notes||$e.special_note||"",productSpcl1:$e.product_spc1||"",productSpcl2:$e.product_spc2||"",productSpcl3:$e.product_spc3||"",inspection:$e.inspection||"",painting:$e.painting||"",remarks:$e.remarks||"",alertStatus:$e.is_urgent===!0||$e.is_urgent==="true"||$e.alert_status===!0||$e.alert_status==="true"||$e.urgent===1||$e.urgent==="1",originalIndex:te}));console.log(" Orders fetched:",se.length,"records"),l(ge(se)),u(null);const Ie=Ne?.data?.pagination;Ie?(I(Number(Ie.total||se.length)),B(Number(Ie.last_page||1))):(I(se.length),B(1)),w(null),At(null)}else console.warn(" No valid order data received",Ne.data),l([]),w(Ne?.data?.Resp_desc||"Failed to fetch orders")}catch(y){console.error("Error fetching orders:",y),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}};rt(De);const Ge=d.useMemo(()=>re.trim().length>0||(ue!=="all"||ke!=="all"||Y!=="all")||(!!pe||!!U)||W||X,[re,ue,ke,Y,pe,U,W,X]);d.useEffect(()=>{!Ge&&!f&&yt()},[j,k]);const St=async()=>{try{h(!0);const N=rt("material-issue"),P=await ht.post(`${qt}/order-list`,{menu_name:N,page:1,per_page:k},{headers:{Authorization:`Bearer ${Ot}`}});if(!(P?.data?.Resp_code==="true"||P?.data?.Resp_code===!0||P?.data?.Resp_code==="RCS")){u(null);return}const L=Number(P?.data?.pagination?.last_page||1);let Ne=0,Je=[];Array.isArray(P?.data?.data)&&Je.push(...P.data.data.map(te=>({id:String(te.id),assemblyLine:te.assembly_no||"",gmsoaNo:te.soa_no||"",soaSrNo:te.soa_sr_no||"",assemblyDate:te.assembly_date||"",uniqueCode:te.unique_code||te.order_no||"",split_id:te.split_id||"",splittedCode:te.splitted_code||"",party:te.party_name||te.party||"",customerPoNo:te.customer_po_no||"",codeNo:te.code_no||"",product:te.product||"",qty:Number(te.qty||0),totalQty:Number(te.total_qty||te.qty||0),qtyExe:Number(te.qty_executed||0),qtyPending:Number(te.qty_pending||0),finishedValve:te.finished_valve||"",gmLogo:te.gm_logo||"",namePlate:te.name_plate||"",specialNotes:te.special_notes||te.special_note||"",productSpcl1:te.product_spc1||"",productSpcl2:te.product_spc2||"",productSpcl3:te.product_spc3||"",inspection:te.inspection||"",painting:te.painting||"",remarks:te.remarks||"",alertStatus:te.is_urgent===!0||te.is_urgent==="true"||te.alert_status===!0||te.alert_status==="true"||te.urgent===1||te.urgent==="1",originalIndex:Ne++})));const se=[];for(let te=2;te<=L;te++)se.push(ht.post(`${qt}/order-list`,{menu_name:N,page:te,per_page:k},{headers:{Authorization:`Bearer ${Ot}`}}));const Ie=await Promise.all(se);for(const te of Ie)Array.isArray(te?.data?.data)&&Je.push(...te.data.data.map(Se=>({id:String(Se.id),assemblyLine:Se.assembly_no||"",gmsoaNo:Se.soa_no||"",soaSrNo:Se.soa_sr_no||"",assemblyDate:Se.assembly_date||"",uniqueCode:Se.unique_code||Se.order_no||"",split_id:Se.split_id||"",splittedCode:Se.splitted_code||"",party:Se.party_name||Se.party||"",customerPoNo:Se.customer_po_no||"",codeNo:Se.code_no||"",product:Se.product||"",qty:Number(Se.qty||0),totalQty:Number(Se.total_qty||Se.qty||0),qtyExe:Number(Se.qty_executed||0),qtyPending:Number(Se.qty_pending||0),finishedValve:Se.finished_valve||"",gmLogo:Se.gm_logo||"",namePlate:Se.name_plate||"",specialNotes:Se.special_notes||Se.special_note||"",productSpcl1:Se.product_spc1||"",productSpcl2:Se.product_spc2||"",productSpcl3:Se.product_spc3||"",inspection:Se.inspection||"",painting:Se.painting||"",remarks:Se.remarks||"",alertStatus:Se.is_urgent===!0||Se.is_urgent==="true"||Se.alert_status===!0||Se.alert_status==="true"||Se.urgent===1||Se.urgent==="1",originalIndex:Ne++})));const $e=new Map;for(const te of Je){const Se=`${te.uniqueCode}|${te.soaSrNo}|${te.split_id||""}`;$e.has(Se)||$e.set(Se,te)}u(ge(Array.from($e.values())))}catch(y){console.error("fetchAllPages error:",y),u(null)}finally{h(!1)}},Ct=d.useMemo(()=>Array.from(new Set(a.map(y=>y.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(y=>y.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(y=>y.party))).filter(Boolean).sort(),[a]);const Zt=d.useMemo(()=>{let N=(Ge&&c?c:a).slice();if(W&&(N=N.filter(P=>n(String(P.id))||P.alertStatus)),X&&(N=N.filter(P=>typeof P.remarks=="string"&&P.remarks.trim().length>0)),ue!=="all"&&(N=N.filter(P=>P.assemblyLine===ue)),ke!=="all"&&(N=N.filter(P=>P.gmsoaNo===ke)),Y!=="all"&&(N=N.filter(P=>P.party===Y)),(pe||U)&&(N=N.filter(P=>{if(!P.assemblyDate||P.assemblyDate==="HOLD")return!1;const L=P.assemblyDate.split(/[\/-]/).map(Je=>Je.trim()).map(Je=>Number(Je));if(L.some(Je=>isNaN(Je)))return!1;let Ne=null;if(L.length>=3){const[Je,se,Ie]=L;Ne=new Date(Ie,se-1,Je)}else if(L.length===2){const[Je,se]=L;Ne=new Date(se,Je-1,1)}else if(L.length===1){const[Je]=L;Ne=new Date(Je,0,1)}else return!1;if(!Ne||isNaN(Ne.getTime()))return!1;if(Q==="year"&&pe)return Ne.getFullYear()===pe.getFullYear();if(Q==="month"&&pe)return Ne.getFullYear()===pe.getFullYear()&&Ne.getMonth()===pe.getMonth();if(Q==="range"||Q==="single"){if(pe&&U)return Ne>=pe&&Ne<=U;if(pe)return Ne>=pe;if(U)return Ne<=U}return!0})),re.trim()){const P=re.toLowerCase();N=N.filter(R=>String(R.uniqueCode).toLowerCase().includes(P)||String(R.party).toLowerCase().includes(P)||String(R.gmsoaNo).toLowerCase().includes(P)||String(R.customerPoNo).toLowerCase().includes(P)||String(R.codeNo).toLowerCase().includes(P)||String(R.product).toLowerCase().includes(P))}return q&&(N=[...N].sort((P,R)=>{const L=parseInt(P.soaSrNo||"0",10),Ne=parseInt(R.soaSrNo||"0",10);return q==="asc"?L-Ne:Ne-L})),N},[a,c,re,W,X,ue,ke,Y,Q,pe,U,n,q]),_t=(y="",N=4)=>{const P=y.trim().split(/\s+/);return P.length<=N?y:P.slice(0,N).join(" ")+"..."},Ut=d.useMemo(()=>{if(Ge)return Zt;const y=(j-1)*k;return Zt.slice(y,y+k)},[Zt,j,k]);d.useEffect(()=>{C(1)},[re,ue,ke,Y,pe,U,W,X]);const Kt=d.useRef(!1);d.useEffect(()=>{Ge?!c&&!Kt.current&&(Kt.current=!0,St().finally(()=>{Kt.current=!1})):u(null)},[Ge,k]);const Bt=y=>y.splittedCode?String(y.splittedCode):y.split_id?String(y.split_id):y.uniqueCode||y.soaSrNo||y.gmsoaNo||y.codeNo||y.assemblyLine?[y.id,y.uniqueCode,y.soaSrNo,y.gmsoaNo,y.codeNo,y.assemblyLine].map(P=>P??"").join("|"):`${y.id}-${y.originalIndex??""}`,Xt=d.useMemo(()=>{const y=Zt.filter(N=>z.has(Bt(N)));return{count:y.length,qty:y.reduce((N,P)=>N+(P.totalQty||P.qty||0),0),qtyExe:y.reduce((N,P)=>N+(P.qtyExe||0),0),qtyPending:y.reduce((N,P)=>N+(P.qtyPending||0),0)}},[z,Zt]),as=y=>{ae(N=>{const P=new Set(N);return P.has(y)?P.delete(y):P.add(y),P})},ds=()=>{ae(y=>y.size===Zt.length?new Set:new Set(Zt.map(N=>Bt(N))))},ls=Zt.length>0&&z.size===Zt.length,us="material-issue",V=Ns(us);console.log("Next step(s):",V.map(rt)),console.log("Is final step?",fn(us));const ie=y=>{const P=Ns("material-issue");Le(y),fe(!0),Ve(P[0]||""),Nt(String(y.qtyPending??y.qty??0)),T(null),A(!1),Qt(!1),Me(""),it(""),pt({})},K=()=>{const y={},N=Number(Ee?.qtyPending??0),P=Number(et||0),R=Number(mt||0);if(De||Array.isArray(V)&&V[0],De||(y.quickAssignStep="Please select a workflow step."),(!et||P<=0)&&(y.quickAssignQty="Quantity must be greater than 0."),P>N&&(y.quickAssignQty=`Cannot exceed available (${N})`),ot){qe||(y.splitAssignStep="Choose split step."),(!mt||R<=0)&&(y.splitAssignQty="Split quantity is required."),De===qe&&(y.sameEngineer="Split step cannot be the same as main step.");const L=P+R;L!==N&&(y.totalQtyMismatch=`Total quantity (${L}) must equal available (${N}).`)}return pt(y),Object.keys(y).length===0},ee=()=>{A(!1),T(null),fe(!1),Le(null),Ve(""),Nt(""),Qt(!1),Me(""),it(""),pt({})},de=a.filter(y=>z.has(Bt(y))),le=()=>tt(!0),Pe=()=>{const N=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${de.map(L=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${L.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(L.gmsoaNo).replace(/^SOA/i,"")}-${L.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${L.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${L.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${L.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${L.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${L.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${L.specialNotes||""}</span> </div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,P=document.createElement("iframe");P.style.position="fixed",P.style.right="0",P.style.bottom="0",P.style.width="0",P.style.height="0",P.style.border="0",document.body.appendChild(P);const R=P.contentDocument||P.contentWindow?.document;R&&(R.open(),R.write(N),R.close(),setTimeout(()=>{P.contentWindow?.focus(),P.contentWindow?.print(),setTimeout(()=>document.body.removeChild(P),500)},300))},Be=()=>{const y=W===!0,N=X===!0,P=z.size>0;if(!y&&!N&&!P)return;const R=P?Zt.filter(L=>z.has(Bt(L))):Zt;if(!R.length){alert("No data available to export");return}je(R)},Te=()=>{const y=c&&c.length>0?c:a;if(!y||y.length===0){alert("No data available to export");return}je(y)},je=y=>{const N=y.map((Ne,Je)=>({No:Je+1,"Assembly Line":Ne.assemblyLine,"GMSOA No":Ne.gmsoaNo,"SOA Sr No":Ne.soaSrNo,"Assembly Date":Ne.assemblyDate,"Unique Code":Ne.uniqueCode,"Splitted Code":Ne.splittedCode||"-",Party:Ne.party,"Customer PO No":Ne.customerPoNo,"Code No":Ne.codeNo,Product:Ne.product,"PO Qty":Ne.poQty,Qty:Ne.qty,"Qty Executed":Ne.qtyExe,"Qty Pending":Ne.qtyPending,"Finished Valve":Ne.finishedValve,"GM Logo":Ne.gmLogo,"Name Plate":Ne.namePlate,"Special Notes":Ne.specialNotes||"","Product Special 1":Ne.productSpcl1,"Product Special 2":Ne.productSpcl2,"Product Special 3":Ne.productSpcl3,Inspection:Ne.inspection,Painting:Ne.painting,Remarks:Ne.remarks||""})),P=Ht.json_to_sheet(N),R=Ht.book_new();Ht.book_append_sheet(R,P,"Orders");const L=Zs(R,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([L],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Ce=y=>{zt(y),Ue(!0)},Fe=y=>{Yt(y),Ze(y.remarks||""),jt(!0)},We=async()=>{if(!ct)return;const y=new FormData;y.append("orderId",String(ct.id)),y.append("remarks",Z);try{const N=await ht.post(`${qt}/add-remarks`,y,{headers:{Authorization:`Bearer ${Ot}`}});if(console.log("Add Remarks Response:",N.data),N.data?.Resp_code==="true"||N.data?.Resp_code===!0){l(R=>R.map(L=>L.id===ct.id?{...L,remarks:Z}:L));try{t(ct.id,Z)}catch{}jt(!1),Yt(null),Ze("")}else console.warn("Backend rejected remarks:",N.data)}catch(N){console.error("Error saving remarks:",N)}},ge=y=>[...y].sort((N,P)=>(N.originalIndex??0)-(P.originalIndex??0)),[G,T]=d.useState(null),[x,A]=d.useState(!1),g=async()=>{if(!x&&(A(!0),!!Ee&&K())){T({type:"info",message:"Assigning order, please wait..."});try{const y=localStorage.getItem("token");if(!y){T({type:"error",message:"Token missing. Please log in again."});return}const N=Number(et||0),P=Number(mt||0),R=De||(Array.isArray(V)?V[0]:"semi-qc"),L=rt(R),Ne=rt(us),Je=new FormData;Je.append("orderId",String(Ee.id)),Je.append("totalQty",String(Ee.totalQty??Ee.qty??0)),Je.append("executedQty",String(N)),Je.append("currentSteps",Ne),Je.append("nextSteps",L),Je.append("split_id",String(Ee.split_id||"")),console.log(" MAIN PAYLOAD:");for(const te of Je.entries())console.log(te[0],te[1]);const se=await ht.post(`${qt}/assign-order`,Je,{headers:{Authorization:`Bearer ${y}`}});if(!(se.data?.Resp_code==="true"||se.data?.Resp_code===!0)){T({type:"error",message:se.data?.Resp_desc||"Main assignment failed."});return}let $e=` Assigned ${N}  ${L}`;if(ot&&P>0){const te=new FormData;te.append("orderId",String(Ee.id)),te.append("totalQty",String(Ee.totalQty??Ee.qty??0)),te.append("executedQty",String(P)),te.append("currentSteps",Ne),te.append("nextSteps",L),te.append("split_id",String(Ee.split_id||"")),console.log(" SPLIT PAYLOAD:");for(const ut of te.entries())console.log("SPLIT:",ut[0],ut[1]);const Se=await ht.post(`${qt}/assign-order`,te,{headers:{Authorization:`Bearer ${y}`}});Se.data?.Resp_code==="true"||Se.data?.Resp_code===!0?$e+=`
 Split ${P}  ${L}`:T({type:"error",message:"Main assigned but split failed: "+(Se.data?.Resp_desc||"Unknown error")})}T({type:"success",message:$e}),await yt(),fe(!1)}catch(y){console.error(" Error assigning order:",y),T({type:"error",message:"Server error while assigning."})}finally{A(!1)}}},p=()=>{_e("all"),Re("all"),ve("all"),be("range"),ne(void 0),ce(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:y=>{window.location.href=`/${y.toLowerCase()}`},onUploadSuccess:()=>yt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(J,{onClick:le,variant:"outline",disabled:z.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>oe(!W),className:`btn-urgent flex items-center gap-2 ${W?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),W?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>he(!X),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:X?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:Be,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:Te,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:re,setSearchTerm:M,assemblyLineFilter:ue,setAssemblyLineFilter:_e,dateFilterMode:Q,setDateFilterMode:be,dateFrom:pe,setDateFrom:ne,dateTo:U,setDateTo:ce,assemblyLines:Ct,onClearFilters:p,hasActiveFilters:ue!=="all"||ke!=="all"||Y!=="all"||!!pe||!!U})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:Vt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs("div",{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(ls),onClick:ds,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${ls?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>me(y=>y==="asc"?"desc":y==="desc"?null:"asc"),children:["Sr.No.",q==="asc"&&" ",q==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Ut.map(y=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:z.has(Bt(y)),onCheckedChange:()=>as(Bt(y)),"aria-label":`Select row ${y.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:y.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:y.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:y.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:y.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:y.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:y.party,children:_t(y.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:y.product,children:y.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:y.specialNotes,children:y.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:y.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:y.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:y.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${y.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Fe(y),children:e.jsx(lr,{className:`h-4 w-4 ${y.remarks?.trim()?"text-white":"text-blue-600"}`})}),y.remarks?.trim()&&e.jsx("div",{className:`\r
          absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
          hidden group-hover:block\r
          bg-gray-900 text-white text-xs\r
          px-3 py-2 rounded-md shadow-lg\r
          max-w-[260px] break-words z-[999]\r
        `,children:y.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>Ce(y),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ie(y),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${y.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${y.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},Bt(y)))})]}),Zt.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),Xt.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:Xt.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:Xt.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:Xt.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:Xt.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:Zt.length,lastPage:Math.max(1,Math.ceil(Zt.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:ye,onOpenChange:y=>{y||(fe(!1),A(!1),T(null))},children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",Ee?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:De,onValueChange:Ve,children:[e.jsx(nr,{id:"assignStep",children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:V.map(y=>e.jsx(Es,{value:y,children:rt(y)},y))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:et,onChange:y=>{const N=y.target.value;Nt(N);const P=Number(Ee?.qtyPending??0),R=Number(N||0);pt(L=>{const Ne={...L};return R>P?Ne.quickAssignQty=`Cannot exceed available (${P})`:Ne.quickAssignQty&&delete Ne.quickAssignQty,Ne})},max:Ee?.qtyPending}),Et.quickAssignQty&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:Et.quickAssignQty})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:Ee?.qtyPending})]})]})}),G&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${G.type==="success"?"bg-green-50 text-green-700 border border-green-200":G.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:G.message.split(`
`).map((y,N)=>e.jsx("div",{children:y},N))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:ee,disabled:x,children:"Cancel"}),e.jsx(J,{onClick:g,disabled:x||!!Et.quickAssignQty,className:"bg-black hover:bg-gray-800 text-white",children:x?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:xe,onOpenChange:tt,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:de.map(y=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",y.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(y.gmsoaNo).replace(/^SOA/i,""),"-",y.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",y.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:y.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:y.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",y.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",y.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:y.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},y.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>tt(!1),children:"Cancel"}),e.jsxs(J,{onClick:Pe,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:lt,onOpenChange:Ue,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",He?.uniqueCode]})]}),He&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>Ue(!1),children:"Close"})})]})}),e.jsx(Rt,{open:gt,onOpenChange:jt,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:ct?`Order: ${ct.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:Z,onChange:y=>Ze(y.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>jt(!1),children:"Cancel"}),e.jsx(J,{onClick:We,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function nf(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),[pe,ne]=d.useState(new Set),[U,ce]=d.useState(!1),[z,ae]=d.useState(null),[ye,fe]=d.useState(""),[Ee,Le]=d.useState(""),[De,Ve]=d.useState(!1),[et,Nt]=d.useState(""),[ot,Qt]=d.useState(""),[qe,Me]=d.useState({}),[mt,it]=d.useState(!1),[Et,pt]=d.useState(!1),[xe,tt]=d.useState(null),[lt,Ue]=d.useState(!1),[He,zt]=d.useState(null),[gt,jt]=d.useState(""),ct=x=>x?.trim().toLowerCase().replace(/\s+/g,"-"),[Yt,Z]=d.useState(null),[Ze,nt]=d.useState(!1),[Ke,kt]=d.useState(null);d.useRef(null);const wt=d.useRef(null),$t=localStorage.getItem("token"),At=async()=>{try{h(!0),w(null);const A=rt("semi-qc"),p=(()=>{try{const R=localStorage.getItem("user");if(!R)return"";const L=JSON.parse(R),Ne=typeof L.role=="object"?L.role?.name:L.role;return String(Ne||"").toLowerCase()}catch{return""}})().includes("admin"),y={menu_name:A},N=await ht.post(`${qt}/order-list`,y,{headers:{Authorization:`Bearer ${$t}`}});if((N?.data?.Resp_code==="true"||N?.data?.Resp_code===!0||N?.data?.Resp_code==="RCS")&&Array.isArray(N.data.data)){const R=N.data.data.map(L=>({id:String(L.id),assemblyLine:L.assembly_no||"",gmsoaNo:L.soa_no||"",soaSrNo:L.soa_sr_no||"",assemblyDate:L.assembly_date||"",uniqueCode:L.unique_code||L.order_no||"",splittedCode:L.splitted_code||"",split_id:L.split_id||L.splitted_code||"",party:L.party_name||L.party||"",customerPoNo:L.customer_po_no||"",codeNo:L.code_no||"",product:L.product||"",totalQty:Number(L.semi_qc_total_qty??L.totalQty??L.total_qty??L.qty??0),qty:Number(L.qty??L.semi_qc_qty??0),qtyExe:Number(L.semi_qc_qty_executed??L.qty_executed??L.qtyExe??0),qtyPending:Number(L.semi_qc_qty_pending??L.qty_pending??0),finishedValve:L.finished_valve||"",gmLogo:L.gm_logo||"",namePlate:L.name_plate||"",specialNotes:L.special_notes||L.special_note||"",productSpcl1:L.product_spc1||"",productSpcl2:L.product_spc2||"",productSpcl3:L.product_spc3||"",inspection:L.inspection||"",painting:L.painting||"",remarks:L.remarks||"",currentStage:"Semi QC",alertStatus:L.is_urgent===!0||L.is_urgent==="true"||L.alert_status===!0||L.alert_status==="true"||L.urgent===1||L.urgent==="1"}));console.log(" Orders fetched:",R.length,"records"),l(je(R)),u(null),w(null),kt(null)}else console.warn(" No valid order data received",N.data),l([]),w(N?.data?.Resp_desc||"Failed to fetch orders")}catch(x){console.error("Error fetching orders:",x),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Vt=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{Vt||At()},[j,k,Vt]);const Ot=d.useMemo(()=>Array.from(new Set(a.map(x=>x.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(x=>x.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(x=>x.party))).filter(Boolean).sort(),[a]);const yt=x=>{const A=parseInt(x,10);return isNaN(A)?0:A},Ge=d.useMemo(()=>{let A=(Vt&&c?c:a).slice();if(A=A.filter(g=>ct(g.currentStage)==="semi-qc"),q&&(A=A.filter(g=>n(String(g.id))||g.alertStatus)),re&&(A=A.filter(g=>typeof g.remarks=="string"&&g.remarks.trim().length>0)),W!=="all"&&(A=A.filter(g=>g.assemblyLine===W)),X!=="all"&&(A=A.filter(g=>g.gmsoaNo===X)),ue!=="all"&&(A=A.filter(g=>g.party===ue)),(Y||Q)&&(A=A.filter(g=>{if(!g.assemblyDate||g.assemblyDate==="HOLD")return!1;const y=g.assemblyDate.split(/[\/-]/).map(P=>P.trim()).map(P=>Number(P));if(y.some(P=>isNaN(P)))return!1;let N=null;if(y.length>=3){const[P,R,L]=y;N=new Date(L,R-1,P)}else if(y.length===2){const[P,R]=y;N=new Date(R,P-1,1)}else if(y.length===1){const[P]=y;N=new Date(P,0,1)}else return!1;if(!N||isNaN(N.getTime()))return!1;if(ke==="year"&&Y)return N.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return N.getFullYear()===Y.getFullYear()&&N.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return N>=Y&&N<=Q;if(Y)return N>=Y;if(Q)return N<=Q}return!0})),F.trim()){const g=F.toLowerCase();A=A.filter(p=>String(p.uniqueCode).toLowerCase().includes(g)||String(p.party).toLowerCase().includes(g)||String(p.gmsoaNo).toLowerCase().includes(g)||String(p.customerPoNo).toLowerCase().includes(g)||String(p.codeNo).toLowerCase().includes(g)||String(p.product).toLowerCase().includes(g))}return _&&(A=[...A].sort((g,p)=>{const y=yt(g.soaSrNo),N=yt(p.soaSrNo);return _==="asc"?y-N:N-y})),A},[a,c,F,q,re,W,X,ue,ke,Y,Q,n,_]),St=(x="",A=4)=>{const g=x.trim().split(/\s+/);return g.length<=A?x:g.slice(0,A).join(" ")+"..."},Ct=d.useMemo(()=>{const x=(j-1)*k;return Ge.slice(x,x+k)},[Ge,j,k]);d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const Zt=x=>{ne(A=>{const g=new Set(A);return g.has(x)?g.delete(x):g.add(x),g})},_t=()=>{ne(x=>{if(x.size===Ge.length)return new Set;const A=Ge.map(g=>g.splittedCode||g.split_id?g.splittedCode||g.split_id:[g.uniqueCode,g.soaSrNo,g.gmsoaNo,g.codeNo,g.assemblyLine].map(p=>p??"").join("|"));return new Set(A)})},Ut=Ge.length>0&&pe.size===Ge.length,Kt="semi-qc",Bt=Ns(Kt);console.log("Next step(s):",Bt.map(rt)),console.log("Is final step?",fn(Kt));const Xt=x=>{const g=Ns("semi-qc");ae(x),ce(!0),fe(g[0]||""),Le(String(x.qtyPending??x.qty??0)),Ve(!1),Nt(""),Qt(""),Me({})},as=()=>{const x={},A=Number(z?.qtyPending??0),g=Number(Ee||0),p=Number(ot||0);if(ye||(x.quickAssignStep="Please select a workflow step."),(!Ee||g<=0)&&(x.quickAssignQty="Quantity must be greater than 0."),g>A&&(x.quickAssignQty=`Cannot exceed available (${A})`),De){et||(x.splitAssignStep="Choose split step."),(!ot||p<=0)&&(x.splitAssignQty="Split quantity is required."),ye===et&&(x.sameEngineer="Split step cannot be the same as main step.");const y=g+p;y!==A&&(x.totalQtyMismatch=`Total quantity (${y}) must equal available (${A}).`)}return Me(x),Object.keys(x).length===0},ds=()=>{ge(!1),Fe(null),ce(!1),ae(null),fe(""),Le(""),Ve(!1),Nt(""),Qt(""),Me({})},ls=a.filter(x=>pe.has(x.splittedCode||x.split_id||x.uniqueCode||x.id)),us=()=>it(!0),V=()=>{const A=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ls.map(y=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${y.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(y.gmsoaNo).replace(/^SOA/i,"")}-${y.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${y.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${y.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${y.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${y.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${y.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${y.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,g=document.createElement("iframe");g.style.position="fixed",g.style.right="0",g.style.bottom="0",g.style.width="0",g.style.height="0",g.style.border="0",document.body.appendChild(g);const p=g.contentDocument||g.contentWindow?.document;p&&(p.open(),p.write(A),p.close(),setTimeout(()=>{g.contentWindow?.focus(),g.contentWindow?.print(),setTimeout(()=>document.body.removeChild(g),500)},300))},ie=x=>x.splittedCode||x.split_id?x.splittedCode||x.split_id:[x.uniqueCode,x.soaSrNo,x.gmsoaNo,x.codeNo,x.assemblyLine].map(A=>A??"").join("|"),K=d.useMemo(()=>{const x=Ge.filter(A=>pe.has(ie(A)));return{count:x.length,qty:x.reduce((A,g)=>A+(g.totalQty||g.qty||0),0),qtyExe:x.reduce((A,g)=>A+(g.qtyExe||0),0),qtyPending:x.reduce((A,g)=>A+(g.qtyPending||0),0)}},[pe,Ge]),ee=()=>{const x=q===!0,A=re===!0,g=pe.size>0;if(!x&&!A&&!g)return;const p=g?Ge.filter(y=>pe.has(ie(y))):Ge;if(!p.length){alert("No data available to export");return}le(p)},de=()=>{const x=c&&c.length>0?c:a;if(!x||x.length===0){alert("No data available to export");return}le(x)},le=x=>{const A=x.map((N,P)=>({No:P+1,"Assembly Line":N.assemblyLine,"GMSOA No":N.gmsoaNo,"SOA Sr No":N.soaSrNo,"Assembly Date":N.assemblyDate,"Unique Code":N.uniqueCode,"Splitted Code":N.splittedCode||"-",Party:N.party,"Customer PO No":N.customerPoNo,"Code No":N.codeNo,Product:N.product,"PO Qty":N.poQty,Qty:N.qty,"Qty Executed":N.qtyExe,"Qty Pending":N.qtyPending,"Finished Valve":N.finishedValve,"GM Logo":N.gmLogo,"Name Plate":N.namePlate,"Special Notes":N.specialNotes||"","Product Special 1":N.productSpcl1,"Product Special 2":N.productSpcl2,"Product Special 3":N.productSpcl3,Inspection:N.inspection,Painting:N.painting,Remarks:N.remarks||""})),g=Ht.json_to_sheet(A),p=Ht.book_new();Ht.book_append_sheet(p,g,"Orders");const y=Zs(p,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([y],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Pe=x=>{tt(x),pt(!0)},Be=x=>{zt(x),jt(x.remarks||""),Ue(!0)},Te=async()=>{if(!He)return;const x=new FormData;x.append("orderId",String(He.id)),x.append("remarks",gt);try{const A=await ht.post(`${qt}/add-remarks`,x,{headers:{Authorization:`Bearer ${$t}`}});if(console.log("Add Remarks Response:",A.data),A.data?.Resp_code==="true"||A.data?.Resp_code===!0){l(p=>p.map(y=>y.id===He.id?{...y,remarks:gt}:y));try{t(He.id,gt)}catch{}Ue(!1),zt(null),jt("")}else console.warn("Backend rejected remarks:",A.data)}catch(A){console.error("Error saving remarks:",A)}},je=x=>[...x].sort((A,g)=>(A.originalIndex??0)-(g.originalIndex??0)),[Ce,Fe]=d.useState(null),[We,ge]=d.useState(!1),G=async()=>{if(!We&&z&&as()){ge(!0),Fe({type:"info",message:"Assigning order, please wait..."});try{const x=localStorage.getItem("token");if(!x){Fe({type:"error",message:"Token missing. Please log in again."});return}const A=rt("semi-qc"),g=Number(Ee||0),p=Number(ot||0),y=ye||(Array.isArray(Bt)?Bt[0]:"phosphating-qc"),N=rt(y),P=new FormData;P.append("orderId",String(z.id)),P.append("totalQty",String(z.totalQty??z.qty??0)),P.append("executedQty",String(g)),P.append("currentSteps",A),P.append("nextSteps",N),P.append("split_id",String(z.split_id||""));const R=await ht.post(`${qt}/assign-order`,P,{headers:{Authorization:`Bearer ${x}`}});if(!(R.data?.Resp_code==="true"||R.data?.Resp_code===!0)){Fe({type:"error",message:R.data?.Resp_desc||"Main assignment failed."});return}let Ne=` Assigned ${g}  ${N}`;if(De&&p>0){const Ie=new FormData;Ie.append("orderId",String(z.id)),Ie.append("totalQty",String(z.totalQty??z.qty??0)),Ie.append("executedQty",String(p)),Ie.append("currentSteps",A),Ie.append("nextSteps",N),Ie.append("split_id",String(z.split_id||"")),Ie.append("splitOrder","true");const $e=await ht.post(`${qt}/assign-order`,Ie,{headers:{Authorization:`Bearer ${x}`}});($e.data?.Resp_code==="true"||$e.data?.Resp_code===!0)&&(Ne+=`
 Split ${p}  ${N}`)}Fe({type:"success",message:Ne});const Je=Ie=>Ie.splittedCode||Ie.split_id?Ie.splittedCode||Ie.split_id:[Ie.uniqueCode,Ie.soaSrNo,Ie.gmsoaNo,Ie.codeNo,Ie.assemblyLine].map($e=>$e??"").join("|"),se=Je(z);l(Ie=>Ie.filter($e=>Je($e)!==se)),ne(Ie=>{const $e=new Set(Ie);return $e.delete(se),$e}),setTimeout(()=>{ce(!1),Fe(null)},1500)}catch(x){console.error(" Error assigning order:",x),Fe({type:"error",message:"Server error while assigning."})}finally{ge(!1)}}},T=()=>{oe("all"),he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:x=>{window.location.href=`/${x.toLowerCase()}`},onUploadSuccess:()=>At()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Semi QC"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(J,{onClick:us,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:ee,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:de,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:Ot,onClearFilters:T,hasActiveFilters:W!=="all"||X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:wt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ut),onClick:_t,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ut?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(x=>x==="asc"?"desc":x==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Ct.map((x,A)=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:pe.has(x.splittedCode||x.split_id?x.splittedCode||x.split_id:[x.uniqueCode,x.soaSrNo,x.gmsoaNo,x.codeNo,x.assemblyLine].map(g=>g??"").join("|")),onCheckedChange:()=>Zt(x.splittedCode||x.split_id?x.splittedCode||x.split_id:[x.uniqueCode,x.soaSrNo,x.gmsoaNo,x.codeNo,x.assemblyLine].map(g=>g??"").join("|")),"aria-label":`Select row ${x.splittedCode||x.split_id||x.uniqueCode||x.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:x.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:x.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:x.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:x.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:x.party,children:St(x.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:x.product,children:x.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:x.specialNotes,children:x.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:x.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:x.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${x.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Be(x),children:e.jsx(lr,{className:`h-4 w-4 ${x.remarks?.trim()?"text-white":"text-blue-600"}`})}),x.remarks?.trim()&&e.jsx("div",{className:`\r
                                absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                hidden group-hover:block\r
                                bg-gray-900 text-white text-xs\r
                                px-3 py-2 rounded-md shadow-lg\r
                                max-w-[260px] break-words z-[999]\r
                              `,children:x.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>Pe(x),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Xt(x),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${x.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${x.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},x.splittedCode||x.split_id?x.splittedCode||x.split_id:[x.uniqueCode,x.soaSrNo,x.gmsoaNo,x.codeNo,x.assemblyLine,A].map(g=>g??"").join("|")))})]}),Ge.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),K.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:K.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:K.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:K.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:K.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:Ge.length,lastPage:Math.max(1,Math.ceil(Ge.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:U,onOpenChange:ce,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:ye,onValueChange:fe,children:[e.jsx(nr,{id:"assignStep",disabled:!0,children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:Bt.map(x=>e.jsx(Es,{value:x,children:rt(x)},x))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Ee,onChange:x=>Le(x.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),Ce&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Ce.type==="success"?"bg-green-50 text-green-700 border border-green-200":Ce.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Ce.message.split(`
`).map((x,A)=>e.jsx("div",{children:x},A))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:ds,disabled:We,children:"Cancel"}),e.jsx(J,{onClick:G,disabled:We,className:"bg-black hover:bg-gray-800 text-white",children:We?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:mt,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ls.map(x=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",x.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(x.gmsoaNo).replace(/^SOA/i,""),"-",x.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",x.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:x.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:x.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",x.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",x.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:x.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},x.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(J,{onClick:V,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:Et,onOpenChange:pt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>pt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:lt,onOpenChange:Ue,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:gt,onChange:x=>jt(x.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>Ue(!1),children:"Cancel"}),e.jsx(J,{onClick:Te,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function af(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),[pe,ne]=d.useState(new Set),[U,ce]=d.useState(!1),[z,ae]=d.useState(null),[ye,fe]=d.useState(""),[Ee,Le]=d.useState(""),[De,Ve]=d.useState(!1),[et,Nt]=d.useState(""),[ot,Qt]=d.useState(""),[qe,Me]=d.useState({}),[mt,it]=d.useState(!1),[Et,pt]=d.useState(!1),[xe,tt]=d.useState(null),[lt,Ue]=d.useState(!1),[He,zt]=d.useState(null),[gt,jt]=d.useState(""),[ct,Yt]=d.useState(null),[Z,Ze]=d.useState(!1),[nt,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),wt=localStorage.getItem("token"),$t=async()=>{try{h(!0),w(null);const A=rt("phosphating"),p=(()=>{try{const R=localStorage.getItem("user");if(!R)return"";const L=JSON.parse(R),Ne=typeof L.role=="object"?L.role?.name:L.role;return String(Ne||"").toLowerCase()}catch{return""}})().includes("admin"),y={menu_name:A},N=await ht.post(`${qt}/order-list`,y,{headers:{Authorization:`Bearer ${wt}`}});if((N?.data?.Resp_code==="true"||N?.data?.Resp_code===!0||N?.data?.Resp_code==="RCS")&&Array.isArray(N.data.data)){const R=N.data.data.map((L,Ne)=>({id:String(L.id),originalIndex:Ne,assemblyLine:L.assembly_no||"",gmsoaNo:L.soa_no||"",soaSrNo:L.soa_sr_no||"",assemblyDate:L.assembly_date||"",uniqueCode:L.unique_code||L.order_no||"",splittedCode:L.splitted_code||"",split_id:L.split_id||L.splitted_code||"",party:L.party_name||L.party||"",customerPoNo:L.customer_po_no||"",codeNo:L.code_no||"",product:L.product||"",totalQty:Number(L.totalQty||L.total_qty||L.qty||0),qty:Number(L.qty||0),qtyExe:Number(L.qty_executed||0),qtyPending:Number(L.qty_pending||0),finishedValve:L.finished_valve||"",gmLogo:L.gm_logo||"",namePlate:L.name_plate||"",specialNotes:L.special_notes||L.special_note||"",productSpcl1:L.product_spc1||"",productSpcl2:L.product_spc2||"",productSpcl3:L.product_spc3||"",inspection:L.inspection||"",painting:L.painting||"",currentStage:"Phosphating",alertStatus:L.is_urgent===!0||L.is_urgent==="true"||L.alert_status===!0||L.alert_status==="true"||L.urgent===1||L.urgent==="1"}));console.log(" Orders fetched:",R.length,"records"),u(null),l(Te(R)),w(null),Ke(null)}else console.warn(" No valid order data received",N.data),l([]),w(N?.data?.Resp_desc||"Failed to fetch orders")}catch(x){console.error("Error fetching orders:",x),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},At=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{At||u(null)},[At,k]),d.useEffect(()=>{At||$t()},[j,k,At]);const Vt=d.useMemo(()=>Array.from(new Set(a.map(x=>x.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(x=>x.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(x=>x.party))).filter(Boolean).sort(),[a]);const Ot=x=>{const A=parseInt(x,10);return isNaN(A)?0:A},yt=d.useMemo(()=>{let A=(At&&c?c:a).slice();if(q&&(A=A.filter(g=>n(String(g.id))||g.alertStatus)),re&&(A=A.filter(g=>typeof g.remarks=="string"&&g.remarks.trim().length>0)),W!=="all"&&(A=A.filter(g=>g.assemblyLine===W)),X!=="all"&&(A=A.filter(g=>g.gmsoaNo===X)),ue!=="all"&&(A=A.filter(g=>g.party===ue)),(Y||Q)&&(A=A.filter(g=>{if(!g.assemblyDate||g.assemblyDate==="HOLD")return!1;const y=g.assemblyDate.split(/[\/-]/).map(P=>P.trim()).map(P=>Number(P));if(y.some(P=>isNaN(P)))return!1;let N=null;if(y.length>=3){const[P,R,L]=y;N=new Date(L,R-1,P)}else if(y.length===2){const[P,R]=y;N=new Date(R,P-1,1)}else if(y.length===1){const[P]=y;N=new Date(P,0,1)}else return!1;if(!N||isNaN(N.getTime()))return!1;if(ke==="year"&&Y)return N.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return N.getFullYear()===Y.getFullYear()&&N.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return N>=Y&&N<=Q;if(Y)return N>=Y;if(Q)return N<=Q}return!0})),F.trim()){const g=F.toLowerCase();A=A.filter(p=>String(p.uniqueCode).toLowerCase().includes(g)||String(p.party).toLowerCase().includes(g)||String(p.gmsoaNo).toLowerCase().includes(g)||String(p.customerPoNo).toLowerCase().includes(g)||String(p.codeNo).toLowerCase().includes(g)||String(p.product).toLowerCase().includes(g))}return _&&(A=[...A].sort((g,p)=>{const y=Ot(g.soaSrNo),N=Ot(p.soaSrNo);return _==="asc"?y-N:N-y})),A},[a,c,F,q,re,W,X,ue,ke,Y,Q,n,_]),Ge=(x="",A=4)=>{const g=x.trim().split(/\s+/);return g.length<=A?x:g.slice(0,A).join(" ")+"..."},St=d.useMemo(()=>{const x=(j-1)*k;return yt.slice(x,x+k)},[yt,j,k]);d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const Ct=x=>{ne(A=>{const g=new Set(A);return g.has(x)?g.delete(x):g.add(x),g})},Zt=()=>{ne(x=>x.size===yt.length?new Set:new Set(yt.map(A=>A.id)))},_t=yt.length>0&&pe.size===yt.length,Ut="phosphating",Kt=Ns(Ut);console.log("Next step(s):",Kt.map(rt)),console.log("Is final step?",fn(Ut));const Bt=x=>{const g=Ns("phosphating");ae(x),ce(!0),fe(g[0]||""),Le(String(x.qtyPending??x.qty??0)),Ve(!1),Nt(""),Qt(""),Me({})},Xt=()=>{const x={},A=Number(z?.qtyPending??0),g=Number(Ee||0),p=Number(ot||0);if(ye||(x.quickAssignStep="Please select a workflow step."),(!Ee||g<=0)&&(x.quickAssignQty="Quantity must be greater than 0."),g>A&&(x.quickAssignQty=`Cannot exceed available (${A})`),De){et||(x.splitAssignStep="Choose split step."),(!ot||p<=0)&&(x.splitAssignQty="Split quantity is required."),ye===et&&(x.sameEngineer="Split step cannot be the same as main step.");const y=g+p;y!==A&&(x.totalQtyMismatch=`Total quantity (${y}) must equal available (${A}).`)}return Me(x),Object.keys(x).length===0},as=()=>{We(!1),Ce(null),ce(!1),ae(null),fe(""),Le(""),Ve(!1),Nt(""),Qt(""),Me({})},ds=a.filter(x=>pe.has(x.id)),ls=()=>it(!0),us=()=>{const A=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ds.map(y=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${y.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(y.gmsoaNo).replace(/^SOA/i,"")}-${y.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${y.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${y.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${y.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${y.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${y.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${y.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,g=document.createElement("iframe");g.style.position="fixed",g.style.right="0",g.style.bottom="0",g.style.width="0",g.style.height="0",g.style.border="0",document.body.appendChild(g);const p=g.contentDocument||g.contentWindow?.document;p&&(p.open(),p.write(A),p.close(),setTimeout(()=>{g.contentWindow?.focus(),g.contentWindow?.print(),setTimeout(()=>document.body.removeChild(g),500)},300))},V=x=>x.id,ie=d.useMemo(()=>{const x=yt.filter(A=>pe.has(V(A)));return{count:x.length,qty:x.reduce((A,g)=>A+(g.totalQty||g.qty||0),0),qtyExe:x.reduce((A,g)=>A+(g.qtyExe||0),0),qtyPending:x.reduce((A,g)=>A+(g.qtyPending||0),0)}},[pe,yt]),K=()=>{const x=q===!0,A=re===!0,g=pe.size>0;if(!x&&!A&&!g)return;const p=g?yt.filter(y=>pe.has(V(y))):yt;if(!p.length){alert("No data available to export");return}de(p)},ee=()=>{const x=c&&c.length>0?c:a;if(!x||x.length===0){alert("No data available to export");return}de(x)},de=x=>{const A=x.map((N,P)=>({No:P+1,"Assembly Line":N.assemblyLine,"GMSOA No":N.gmsoaNo,"SOA Sr No":N.soaSrNo,"Assembly Date":N.assemblyDate,"Unique Code":N.uniqueCode,"Splitted Code":N.splittedCode||"-",Party:N.party,"Customer PO No":N.customerPoNo,"Code No":N.codeNo,Product:N.product,"PO Qty":N.poQty,Qty:N.qty,"Qty Executed":N.qtyExe,"Qty Pending":N.qtyPending,"Finished Valve":N.finishedValve,"GM Logo":N.gmLogo,"Name Plate":N.namePlate,"Special Notes":N.specialNotes||"","Product Special 1":N.productSpcl1,"Product Special 2":N.productSpcl2,"Product Special 3":N.productSpcl3,Inspection:N.inspection,Painting:N.painting,Remarks:N.remarks||""})),g=Ht.json_to_sheet(A),p=Ht.book_new();Ht.book_append_sheet(p,g,"Orders");const y=Zs(p,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([y],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},le=x=>{tt(x),pt(!0)},Pe=x=>{zt(x),jt(x.remarks||""),Ue(!0)},Be=async()=>{if(!He)return;const x=new FormData;x.append("orderId",String(He.id)),x.append("remarks",gt);try{const A=await ht.post(`${qt}/add-remarks`,x,{headers:{Authorization:`Bearer ${wt}`}});if(console.log("Add Remarks Response:",A.data),A.data?.Resp_code==="true"||A.data?.Resp_code===!0){l(p=>p.map(y=>y.id===He.id?{...y,remarks:gt}:y));try{t(He.id,gt)}catch{}Ue(!1),zt(null),jt("")}else console.warn("Backend rejected remarks:",A.data)}catch(A){console.error("Error saving remarks:",A)}},Te=x=>[...x].sort((A,g)=>(A.originalIndex??0)-(g.originalIndex??0)),[je,Ce]=d.useState(null),[Fe,We]=d.useState(!1),ge=x=>{const A=(x||"").toLowerCase();return A.includes("assembly a")||A.trim()==="a"?"assembly-a":A.includes("assembly b")||A.trim()==="b"?"assembly-b":A.includes("assembly c")||A.trim()==="c"?"assembly-c":A.includes("assembly d")||A.trim()==="d"?"assembly-d":"assembly-a"},G=async()=>{if(!Fe&&(We(!0),!!z&&Xt())){Ce({type:"info",message:"Assigning order, please wait..."});try{const x=localStorage.getItem("token");if(!x){Ce({type:"error",message:"Token missing. Please log in again."});return}const g=rt("phosphating"),p=Number(Ee||0),y=Number(ot||0),N=Ns(Ut);let P=ye||(Array.isArray(N)&&N.length>0?N[0]:"");const R=String(z?.assemblyLine||"").trim().toUpperCase().charAt(0),L={A:"Assembly A",B:"Assembly B",C:"Assembly C",D:"Assembly D"};if(L[R]&&(P=L[R]),!P){Ce({type:"error",message:"Next step not found."});return}const Ne=new FormData;Ne.append("orderId",String(z.id)),Ne.append("totalQty",String(z.totalQty??z.qty??0)),Ne.append("executedQty",String(p)),Ne.append("currentSteps",g),Ne.append("nextSteps",P),Ne.append("split_id",String(z.split_id||"")),console.log(" MAIN PAYLOAD:",Object.fromEntries(Ne.entries()));const Je=await ht.post(`${qt}/assign-order`,Ne,{headers:{Authorization:`Bearer ${x}`}});if(!(Je.data?.Resp_code==="true"||Je.data?.Resp_code===!0)){Ce({type:"error",message:Je.data?.Resp_desc||"Main assignment failed."});return}let Ie=` Assigned ${p}  ${P}`;if(De&&y>0){const Se=new FormData;Se.append("orderId",String(z.id)),Se.append("totalQty",String(z.totalQty??z.qty??0)),Se.append("executedQty",String(y)),Se.append("currentSteps",g),Se.append("nextSteps",P),Se.append("split_id",String(z.split_id||"")),await ht.post(`${qt}/assign-order`,Se,{headers:{Authorization:`Bearer ${x}`}}),Ie+=`
 Split ${y}  ${P}`}Ce({type:"success",message:Ie});const $e=Se=>Se.splittedCode||Se.split_id?Se.splittedCode||Se.split_id:[Se.uniqueCode,Se.soaSrNo,Se.gmsoaNo,Se.codeNo,Se.assemblyLine].map(at=>at??"").join("|"),te=$e(z);l(Se=>Se.filter(at=>$e(at)!==te)),ne(Se=>{const at=new Set(Se);return at.delete(te),at}),setTimeout(()=>{ce(!1),Ce(null)},1e3)}catch(x){console.error(" Error assigning order:",x),console.error(" Backend Response:",x?.response?.data),Ce({type:"error",message:x?.response?.data?.message||"Server error while assigning."})}finally{We(!1)}}},T=()=>{oe("all"),he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:x=>{window.location.href=`/${x.toLowerCase()}`},onUploadSuccess:()=>$t()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"After Phosphating QC"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(J,{onClick:ls,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:K,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:ee,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:Vt,onClearFilters:T,hasActiveFilters:W!=="all"||X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(_t),onClick:Zt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${_t?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(x=>x==="asc"?"desc":x==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:St.map((x,A)=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:pe.has(x.id),onCheckedChange:()=>Ct(x.id)})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:x.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:x.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:x.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:x.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:x.party,children:Ge(x.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:x.product,children:x.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:x.specialNotes,children:x.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:x.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:x.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${x.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Pe(x),children:e.jsx(lr,{className:`h-4 w-4 ${x.remarks?.trim()?"text-white":"text-blue-600"}`})}),x.remarks?.trim()&&e.jsx("div",{className:`\r
                                                      absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                      hidden group-hover:block\r
                                                      bg-gray-900 text-white text-xs\r
                                                      px-3 py-2 rounded-md shadow-lg\r
                                                      max-w-[260px] break-words z-[999]\r
                                                    `,children:x.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>le(x),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Bt(x),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${x.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${x.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},V(x)))})]}),yt.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),ie.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:ie.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:ie.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:ie.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:ie.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:yt.length,lastPage:Math.max(1,Math.ceil(yt.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:U,onOpenChange:ce,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:ge(String(z?.assemblyLine||"")),onValueChange:()=>{},children:[e.jsx(nr,{id:"assignStep",disabled:!0,children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:e.jsx(Es,{value:ge(String(z?.assemblyLine||"")),children:rt(ge(String(z?.assemblyLine||"")))})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Ee,onChange:x=>Le(x.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),je&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${je.type==="success"?"bg-green-50 text-green-700 border border-green-200":je.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:je.message.split(`
`).map((x,A)=>e.jsx("div",{children:x},A))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:as,disabled:Fe,children:"Cancel"}),e.jsx(J,{onClick:G,disabled:Fe,className:"bg-black hover:bg-gray-800 text-white",children:Fe?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:mt,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ds.map(x=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",x.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(x.gmsoaNo).replace(/^SOA/i,""),"-",x.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",x.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:x.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:x.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",x.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",x.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:x.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},x.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(J,{onClick:us,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:Et,onOpenChange:pt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>pt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:lt,onOpenChange:Ue,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:gt,onChange:x=>jt(x.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>Ue(!1),children:"Cancel"}),e.jsx(J,{onClick:Be,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function lf(){const t=d.useRef(null),{updateRemark:s,toggleAlertStatus:r,getRemark:n,getAlertStatus:a}=yr(),[l,c]=d.useState([]),[u,f]=d.useState(null),[h,v]=d.useState(!1),[w,j]=d.useState(null),[C,k]=d.useState(1),[S,_]=d.useState(100),[I,F]=d.useState(""),[B,q]=d.useState(!1),[me,re]=d.useState(!1),[M,W]=d.useState("all"),[oe,X]=d.useState("all"),[he,ue]=d.useState("all"),[_e,ke]=d.useState("single"),[Re,Y]=d.useState(void 0),[ve,Q]=d.useState(void 0),be=Pn(),[pe,ne]=d.useState(null),[U,ce]=d.useState(new Set),[z,ae]=d.useState(!1),[ye,fe]=d.useState(null),[Ee,Le]=d.useState(""),[De,Ve]=d.useState(""),[et,Nt]=d.useState(!1),[ot,Qt]=d.useState(""),[qe,Me]=d.useState(""),[mt,it]=d.useState({}),[Et,pt]=d.useState(!1),[xe,tt]=d.useState(!1),[lt,Ue]=d.useState(null),[He,zt]=d.useState(!1),[gt,jt]=d.useState(null),[ct,Yt]=d.useState(""),[Z,Ze]=d.useState(null),[nt,Ke]=d.useState(!1),[kt,wt]=d.useState(null);d.useRef(null);const $t=d.useRef(null),At=localStorage.getItem("token"),Vt=async()=>{try{v(!0),j(null);const y=rt("assembly-a"),P=(()=>{try{const Je=localStorage.getItem("user");if(!Je)return"";const se=JSON.parse(Je),Ie=typeof se.role=="object"?se.role?.name:se.role;return String(Ie||"").toLowerCase()}catch{return""}})().includes("admin"),R={menu_name:y},L=await ht.post(`${qt}/order-list`,R,{headers:{Authorization:`Bearer ${At}`}});if((L?.data?.Resp_code==="true"||L?.data?.Resp_code===!0||L?.data?.Resp_code==="RCS")&&Array.isArray(L.data.data)){const Je=L.data.data.map((Ie,$e)=>({id:String(Ie.id),assemblyLine:Ie.assembly_no||"",gmsoaNo:Ie.soa_no||"",soaSrNo:Ie.soa_sr_no||"",assemblyDate:Ie.assembly_date||"",uniqueCode:Ie.unique_code||Ie.order_no||"",splittedCode:Ie.splitted_code||"",split_id:Ie.split_id||Ie.splitted_code||"",party:Ie.party_name||Ie.party||"",customerPoNo:Ie.customer_po_no||"",codeNo:Ie.code_no||"",product:Ie.product||"",qty:Number(Ie.qty||0),totalQty:Number(Ie.totalQty||Ie.total_qty||Ie.qty||0),qtyExe:Number(Ie.qty_executed||0),qtyPending:Number(Ie.qty_pending||0),finishedValve:Ie.finished_valve||"",gmLogo:Ie.gm_logo||"",namePlate:Ie.name_plate||"",specialNotes:Ie.special_notes||Ie.special_note||"",productSpcl1:Ie.product_spc1||"",productSpcl2:Ie.product_spc2||"",productSpcl3:Ie.product_spc3||"",inspection:Ie.inspection||"",painting:Ie.painting||"",remarks:Ie.remarks||"",originalIndex:$e,alertStatus:Ie.is_urgent===!0||Ie.is_urgent==="true"||Ie.alert_status===!0||Ie.alert_status==="true"||Ie.urgent===1||Ie.urgent==="1"}));console.log(" Orders fetched:",Je.length,"records");const se=new Map;Je.forEach((Ie,$e)=>{const te=`${Ie.uniqueCode}|${Ie.soaSrNo}|${Ie.split_id||""}`;se.has(te)||se.set(te,{...Ie,originalIndex:$e})}),c(We(Array.from(se.values()))),f(null),j(null),wt(null)}else console.warn(" No valid order data received",L.data),c([]),j(L?.data?.Resp_desc||"Failed to fetch orders")}catch(p){console.error("Error fetching orders:",p),j("Error fetching order list. Please check your token or server.")}finally{v(!1)}},Ot=d.useMemo(()=>I.trim().length>0||(M!=="all"||oe!=="all"||he!=="all")||(!!Re||!!ve)||B||me,[I,M,oe,he,Re,ve,B,me]);d.useEffect(()=>{Ot||Vt()},[C,S,Ot]);const yt=d.useMemo(()=>Array.from(new Set(l.map(p=>p.assemblyLine))).filter(Boolean).sort(),[l]);d.useMemo(()=>Array.from(new Set(l.map(p=>p.gmsoaNo))).filter(Boolean).sort(),[l]),d.useMemo(()=>Array.from(new Set(l.map(p=>p.party))).filter(Boolean).sort(),[l]);const Ge=p=>{const y=parseInt(p,10);return isNaN(y)?0:y},St=d.useMemo(()=>{let p=l.slice();if(B&&(p=p.filter(y=>a(String(y.id))||y.alertStatus)),me&&(p=p.filter(y=>typeof y.remarks=="string"&&y.remarks.trim().length>0)),M!=="all"){const y=M.startsWith("assembly-")?M.split("-")[1].toUpperCase():M.toUpperCase();p=p.filter(N=>{const P=String(N.assemblyLine||"").toUpperCase();return P===y||P.includes(y)})}if(oe!=="all"&&(p=p.filter(y=>y.gmsoaNo===oe)),he!=="all"&&(p=p.filter(y=>y.party===he)),(Re||ve)&&(p=p.filter(y=>{if(!y.assemblyDate||y.assemblyDate==="HOLD")return!1;const P=y.assemblyDate.split(/[\/-]/).map(L=>L.trim()).map(L=>Number(L));if(P.some(L=>isNaN(L)))return!1;let R=null;if(P.length>=3){const[L,Ne,Je]=P;R=new Date(Je,Ne-1,L)}else if(P.length===2){const[L,Ne]=P;R=new Date(Ne,L-1,1)}else if(P.length===1){const[L]=P;R=new Date(L,0,1)}else return!1;if(!R||isNaN(R.getTime()))return!1;if(_e==="year"&&Re)return R.getFullYear()===Re.getFullYear();if(_e==="month"&&Re)return R.getFullYear()===Re.getFullYear()&&R.getMonth()===Re.getMonth();if(_e==="range"||_e==="single"){if(Re&&ve)return R>=Re&&R<=ve;if(Re)return R>=Re;if(ve)return R<=ve}return!0})),I.trim()){const y=I.trim().toLowerCase(),N=R=>R.toLowerCase().replace(/[\s\/_-]+/g,""),P=N(y);p=p.filter(R=>{const L=N(R.gmsoaNo||""),Ne=N(String(R.soaSrNo||"")),Je=N(`${R.gmsoaNo}-${R.soaSrNo}`),se=N(R.uniqueCode||"");return y.includes("-")||y.includes("/")?Je===P:y.startsWith("soa")&&y.length>=7?L===P:se.includes(P)||L.includes(P)||Ne.includes(P)||N(R.party||"").includes(P)||N(R.customerPoNo||"").includes(P)||N(R.codeNo||"").includes(P)||N(R.product||"").includes(P)})}return pe&&(p=[...p].sort((y,N)=>{const P=Ge(y.soaSrNo),R=Ge(N.soaSrNo);return pe==="asc"?P-R:R-P})),p},[l,I,B,me,M,oe,he,_e,Re,ve,pe,a]),Ct=(p="",y=4)=>{const N=p.trim().split(/\s+/);return N.length<=y?p:N.slice(0,y).join(" ")+"..."},Zt=d.useMemo(()=>{const p=(C-1)*S;return St.slice(p,p+S)},[St,C,S]);d.useEffect(()=>{k(1)},[I,M,oe,he,Re,ve,B,me]);const _t=p=>{ce(y=>{const N=new Set(y);return N.has(p)?N.delete(p):N.add(p),N})},Ut=()=>{ce(p=>{if(p.size===St.length)return new Set;const y=St.map(N=>N.splittedCode||N.split_id||N.uniqueCode||N.id);return new Set(y)})},Kt=St.length>0&&U.size===St.length,Bt="assembly-a",Xt=Ns(Bt),as=(ye?.assemblyLine||"").toUpperCase().includes("D"),ds=Xt.filter(p=>p==="testing1"||p==="testing2"?as?p==="testing2":p==="testing1":!0);console.log("Next step(s):",Xt.map(rt)),console.log("Is final step?",fn(Bt));const ls=p=>{const N=Ns("assembly-a");fe(p),ae(!0);const P=(p.assemblyLine||"").toUpperCase().includes("D"),R=N.filter(L=>L==="testing1"||L==="testing2"?P?L==="testing2":L==="testing1":!0);Le(R[0]||N[0]||""),Ve(String(p.qtyPending??p.qty??0)),G(null),x(!1),Nt(!1),Qt(""),Me(""),it({})},us=()=>{const p={},y=Number(ye?.qtyPending??0),N=Number(De||0),P=Number(qe||0);if(Ee||(p.quickAssignStep="Please select a workflow step."),(!De||N<=0)&&(p.quickAssignQty="Quantity must be greater than 0."),N>y&&(p.quickAssignQty=`Cannot exceed available (${y})`),et){ot||(p.splitAssignStep="Choose split step."),(!qe||P<=0)&&(p.splitAssignQty="Split quantity is required."),Ee===ot&&(p.sameEngineer="Split step cannot be the same as main step.");const R=N+P;R!==y&&(p.totalQtyMismatch=`Total quantity (${R}) must equal available (${y}).`)}return it(p),Object.keys(p).length===0},V=()=>{t.current&&(t.current.abort(),t.current=null),x(!1),G(null),ae(!1),fe(null),Le(""),Ve(""),Nt(!1),Qt(""),Me(""),it({})},ie=l.filter(p=>U.has(p.splittedCode||p.split_id||p.uniqueCode||p.id)),K=()=>pt(!0),ee=()=>{const y=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>

        <style>
          @page {
            size: 130mm 85mm;
            margin: 0;
          }

          html, body {
            width: 130mm;
            height: 85mm;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
          }

          .item-label,
          .party-desc {
          padding-bottom: 2mm;}

          .item-label {
          line-height: 1.8em;}

          .bin-card {
            width: 130mm;
            height: 85mm;
            padding: 6mm;
            box-sizing: border-box;
            page-break-after: always;
          }

        .item-label-description {
        padding-top: 50px;}

          .meta-qty {
          width: 50%;}

          .process-border {
          border-top:1px solid #000;
          border-bottom:1px solid #000;
          padding-top: 1.5mm;
          padding-bottom: 1.5mm;
          }

          .detail-logo {
            padding-bottom: 0.9mm;
          }

          .description {
            padding-bottom: 2mm;
          }

          .content {
            width: 100%;
            height: 100%;
            border: 1.5px solid #000;
            border-radius: 10px;
            padding-top: 2mm;
            padding-bottom: 4mm;
              padding-left: 6mm;
                  padding-right: 6mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
          }

          .meta-item {
            padding-top: 2mm;
          }

          /* RESET DEFAULT P TAG SPACE */
          p {
            margin: 0;
          }

          /* HEADER */
          .company-name {
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1mm;
            
          }

          .assembly-title p {
          border: 1px solid #000;
            display: inline-block;
            padding-top: 1mm;
            padding-bottom: 0.9mm;
            padding-left: 1mm;
            padding-right: 1mm;
          }

          .company-address {
            font-size: 8px;
            font-weight: 400;
            text-align: center;
            line-height: 1.2;
            margin: 0 0 1.2mm;
          }

          .tag-title {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1.5mm;
          }

          .doc-row {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            margin-bottom: 0.5mm; /*  reduced */
          }

          /* ASSEMBLY LINE */
          .title {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            margin-top: 0;       /*  no top gap */
            margin-bottom: 0.5mm;
            //  border: 1px solid #000;
            // display: inline-block;
          }

          .title-line {
            border-bottom: 1px solid #000;
            margin-bottom: 1.5mm;
            margin-top: 0.5mm;
          }

          /* META */
          .meta {
            font-size: 10px;
            line-height: 1.25;
            margin-bottom: 0.8mm;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }

          .meta div {
            margin-bottom: 0.5mm;
          }

          /* ITEM */
          .desc {
            font-size: 9px;
            margin-bottom: 0.8mm;
          }

          .desc p {
          padding-bottom: 0.6mm;}

          .desc span {
            display: block;
            padding-bottom: 0.1mm;
          }

          .desc .label {
            display: block;
            font-size: 10px;
            margin-bottom: 0.8mm;
            margin-top: 0.8mm;
          }

          .desc .text {
            word-break: break-word;
            
          }

          /* QTY */
          .qty-logo {
            font-size: 10px;
            line-height: 1.3;
            margin-bottom: 0.4mm;
            margin-top: 0.8mm;
          }

          /* INSPECTION */
          .inspect {
            margin-top: auto;
            font-size: 10px;
          }

          .inspect-line {
            height: 3mm;
            border-bottom: 1px solid #000;
          }

          .label {
            font-weight: 600;
          }
        </style>
      </head>

      <body>${ie.map(R=>`
        <div class="bin-card">
          <div class="content">

            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>

            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${R.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(R.gmsoaNo).replace(/^SOA/i,"")}-${R.soaSrNo}
                </div>

              </div>
                <div class="title assembly-title">
                  <p>Assembly Line: ${R.assemblyLine}</p>
                </div>
                <div class="meta-item">
                  <p>GMV-L4-F-PRD 01 A</p>
                  <p>(02/10.09.2020)</p>
                </div>
          </div>

            

            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${R.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${R.product}</p>
              </div>
            </div>

            <div class="qty-logo">
            <div class="meta meta-logo">
              <div class="meta-qty"><span class="label">QTY:</span> ${R.qty}</div>
              <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${R.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${R.specialNotes||""}</span></div>
              </div>

            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>

          </div>
        </div>`).join("")}</body>
    </html>`,N=document.createElement("iframe");N.style.position="fixed",N.style.right="0",N.style.bottom="0",N.style.width="0",N.style.height="0",N.style.border="0",document.body.appendChild(N);const P=N.contentDocument||N.contentWindow?.document;P&&(P.open(),P.write(y),P.close(),setTimeout(()=>{N.contentWindow?.focus(),N.contentWindow?.print(),setTimeout(()=>document.body.removeChild(N),500)},300))},de=()=>{const p=B===!0,y=me===!0,N=U.size>0;if(!p&&!y&&!N)return;const P=N?St.filter(R=>U.has(le(R))):St;if(!P.length){alert("No data available to export");return}Te(P)},le=p=>p.splittedCode||p.split_id?p.splittedCode||p.split_id:[p.uniqueCode,p.soaSrNo,p.gmsoaNo,p.codeNo,p.assemblyLine].map(y=>y??"").join("|"),Pe=d.useMemo(()=>{const p=St.filter(y=>U.has(le(y)));return{count:p.length,qty:p.reduce((y,N)=>y+(N.totalQty||N.qty||0),0),qtyExe:p.reduce((y,N)=>y+(N.qtyExe||0),0),qtyPending:p.reduce((y,N)=>y+(N.qtyPending||0),0)}},[U,St]),Be=()=>{const p=u&&u.length>0?u:l;if(!p||p.length===0){alert("No data available to export");return}Te(p)},Te=p=>{const y=p.map((L,Ne)=>({No:Ne+1,"Assembly Line":L.assemblyLine,"GMSOA No":L.gmsoaNo,"SOA Sr No":L.soaSrNo,"Assembly Date":L.assemblyDate,"Unique Code":L.uniqueCode,"Splitted Code":L.splittedCode||"-",Party:L.party,"Customer PO No":L.customerPoNo,"Code No":L.codeNo,Product:L.product,"PO Qty":L.poQty,Qty:L.qty,"Qty Executed":L.qtyExe,"Qty Pending":L.qtyPending,"Finished Valve":L.finishedValve,"GM Logo":L.gmLogo,"Name Plate":L.namePlate,"Special Notes":L.specialNotes||"","Product Special 1":L.productSpcl1,"Product Special 2":L.productSpcl2,"Product Special 3":L.productSpcl3,Inspection:L.inspection,Painting:L.painting,Remarks:L.remarks||""})),N=Ht.json_to_sheet(y),P=Ht.book_new();Ht.book_append_sheet(P,N,"Orders");const R=Zs(P,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([R],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},je=p=>{Ue(p),tt(!0)},Ce=p=>{jt(p),Yt(p.remarks||""),zt(!0)},Fe=async()=>{if(!gt)return;const p=new FormData;p.append("orderId",String(gt.id)),p.append("remarks",ct);try{const y=await ht.post(`${qt}/add-remarks`,p,{headers:{Authorization:`Bearer ${At}`}});if(console.log("Add Remarks Response:",y.data),y.data?.Resp_code==="true"||y.data?.Resp_code===!0){c(P=>P.map(R=>R.id===gt.id?{...R,remarks:ct}:R));try{s(gt.id,ct)}catch{}zt(!1),jt(null),Yt("")}else console.warn("Backend rejected remarks:",y.data)}catch(y){console.error("Error saving remarks:",y)}},We=p=>[...p].sort((y,N)=>(y.originalIndex??0)-(N.originalIndex??0)),[ge,G]=d.useState(null),[T,x]=d.useState(!1),A=async()=>{if(T||!ye||!us())return;x(!0);const p=new AbortController;t.current=p,G({type:"info",message:"Assigning order, please wait..."});try{const y=localStorage.getItem("token");if(!y){G({type:"error",message:"Token missing. Please log in again."});return}const N="assembly-a",P=Number(De||0),R=Number(qe||0),L=Ee||(Array.isArray(Xt)?Xt[0]:"Assembly D"),Ne=rt(L),Je=rt(N),se=new FormData;se.append("orderId",String(ye.id)),se.append("totalQty",String(ye.totalQty??ye.qty??0)),se.append("executedQty",String(P)),se.append("currentSteps",Je),se.append("nextSteps",Ne),se.append("split_id",String(ye.split_id||""));const Ie=await ht.post(`${qt}/assign-order`,se,{headers:{Authorization:`Bearer ${y}`},signal:p.signal});if(!(Ie.data?.Resp_code==="true"||Ie.data?.Resp_code===!0)){G({type:"error",message:Ie.data?.Resp_desc||"Main assignment failed."});return}let te=`Assigned ${P}  ${Ne}`;if(et&&R>0){const Se=new FormData;Se.append("orderId",String(ye.id)),Se.append("totalQty",String(ye.totalQty??ye.qty??0)),Se.append("executedQty",String(R)),Se.append("currentSteps",Je),Se.append("nextSteps",Ne),Se.append("split_id",String(ye.split_id||""));const at=await ht.post(`${qt}/assign-order`,Se,{headers:{Authorization:`Bearer ${y}`},signal:p.signal});at.data?.Resp_code==="true"||at.data?.Resp_code===!0?te+=`
 Split ${R}  ${Ne}`:G({type:"error",message:"Main assigned but split failed: "+(at.data?.Resp_desc||"Unknown error")})}G({type:"success",message:` ${te}`}),c(Se=>Se.map(at=>{if(at.id!==ye.id)return at;const ut=at.qtyExe||0,Wt=P+(et?R:0),vt=ut+Wt,Hr=(at.totalQty??at.qty)-vt;return{...at,qtyExe:vt,qtyPending:Hr}})),await Vt(),setTimeout(()=>{ae(!1),G(null)},1e3)}catch(y){if(y?.name==="CanceledError"||y?.code==="ERR_CANCELED"){console.log(" Assign request cancelled");return}console.error(" Error assigning order:",y),G({type:"error",message:"Server error while assigning."})}finally{x(!1),t.current=null}},g=()=>{X("all"),ue("all"),ke("range"),Y(void 0),Q(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:p=>{window.location.href=`/${p.toLowerCase()}`},onUploadSuccess:()=>Vt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsxs("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold flex gap-3",children:["Assembly A",e.jsx(J,{onClick:()=>be("/testing-assembly",{state:{source:"assembly-a"}}),variant:"outline",className:"flex items-center gap-2",children:"Testing-1"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(J,{onClick:K,variant:"outline",disabled:U.size===0,className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>q(!B),className:`btn-urgent flex items-center gap-2 ${B?"bg-red-600 text-white":"bg-red-50 text-red-700 btn-urgent"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),B?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>re(!me),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:me?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:de,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:Be,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"assembly-a",searchTerm:I,setSearchTerm:F,assemblyLineFilter:M,setAssemblyLineFilter:W,dateFilterMode:_e,setDateFilterMode:ke,dateFrom:Re,setDateFrom:Y,dateTo:ve,setDateTo:Q,assemblyLines:yt,onClearFilters:g,hasActiveFilters:oe!=="all"||he!=="all"||!!Re||!!ve})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:$t,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:h&&l.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Kt),onClick:Ut,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Kt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>ne(p=>p==="asc"?"desc":p==="desc"?null:"asc"),children:["Sr.No.",pe==="asc"&&" ",pe==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Zt.map(p=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:U.has(p.splittedCode||p.split_id||p.uniqueCode||p.id),onCheckedChange:()=>_t(p.splittedCode||p.split_id||p.uniqueCode||p.id),"aria-label":`Select row ${p.splittedCode||p.split_id||p.uniqueCode||p.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:p.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:p.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:p.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:p.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:p.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:p.party,children:Ct(p.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:p.product,children:p.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:p.specialNotes,children:p.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:p.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:p.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${p.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Ce(p),children:e.jsx(lr,{className:`h-4 w-4 ${p.remarks?.trim()?"text-white":"text-blue-600"}`})}),p.remarks?.trim()&&e.jsx("div",{className:`\r
                                  absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                  hidden group-hover:block\r
                                  bg-gray-900 text-white text-xs\r
                                  px-3 py-2 rounded-md shadow-lg\r
                                  max-w-[260px] break-words z-[999]\r
                                `,children:p.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>je(p),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ls(p),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${p.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${p.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},p.splittedCode||p.split_id||p.uniqueCode||p.id))})]}),St.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),Pe.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:Pe.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:Pe.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:Pe.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:Pe.qtyPending})]})]}),e.jsx(cr,{page:C,perPage:S,total:St.length,lastPage:Math.max(1,Math.ceil(St.length/Math.max(S,1))),onChangePage:k,onChangePerPage:_,disabled:h}),e.jsx(Rt,{open:z,onOpenChange:p=>{p?ae(!0):V()},children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",ye?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:Ee,onValueChange:Le,disabled:!0,children:[e.jsx(nr,{id:"assignStep",children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:ds.map(p=>e.jsx(Es,{value:p,children:rt(p)},p))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:De,onChange:p=>{const y=p.target.value;Ve(y);const N=Number(ye?.qtyPending??0),P=Number(y||0);it(R=>{const L={...R};return P>N?L.quickAssignQty=`Cannot exceed available (${N})`:L.quickAssignQty&&delete L.quickAssignQty,L})},max:ye?.qtyPending}),mt.quickAssignQty&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:mt.quickAssignQty})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:ye?.qtyPending})]})]})}),ge&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${ge.type==="success"?"bg-green-50 text-green-700 border border-green-200":ge.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:ge.message.split(`
`).map((p,y)=>e.jsx("div",{children:p},y))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:V,disabled:T,children:"Cancel"}),e.jsx(J,{onClick:A,disabled:T||!!mt.quickAssignQty,className:"bg-black hover:bg-gray-800 text-white",children:T?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:Et,onOpenChange:pt,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ie.map(p=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",p.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(p.gmsoaNo).replace(/^SOA/i,""),"-",p.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",p.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:p.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:p.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",p.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",p.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:p.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},p.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>pt(!1),children:"Cancel"}),e.jsxs(J,{onClick:ee,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:xe,onOpenChange:tt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",lt?.uniqueCode]})]}),lt&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>tt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:He,onOpenChange:zt,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:gt?`Order: ${gt.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:ct,onChange:p=>Yt(p.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>zt(!1),children:"Cancel"}),e.jsx(J,{onClick:Fe,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function of(){const t=d.useRef(null),{updateRemark:s,toggleAlertStatus:r,getRemark:n,getAlertStatus:a}=yr(),[l,c]=d.useState([]),[u,f]=d.useState(null),[h,v]=d.useState(!1),[w,j]=d.useState(null),[C,k]=d.useState(1),[S,_]=d.useState(100),[I,F]=d.useState(null),[B,q]=d.useState(""),[me,re]=d.useState(!1),[M,W]=d.useState(!1),[oe,X]=d.useState("all"),[he,ue]=d.useState("all"),[_e,ke]=d.useState("all"),[Re,Y]=d.useState("single"),[ve,Q]=d.useState(void 0),[be,pe]=d.useState(void 0),ne=Pn(),[U,ce]=d.useState(new Set),[z,ae]=d.useState(!1),[ye,fe]=d.useState(null),[Ee,Le]=d.useState(""),[De,Ve]=d.useState(""),[et,Nt]=d.useState(!1),[ot,Qt]=d.useState(""),[qe,Me]=d.useState(""),[mt,it]=d.useState({}),[Et,pt]=d.useState(!1),[xe,tt]=d.useState(!1),[lt,Ue]=d.useState(null),[He,zt]=d.useState(!1),[gt,jt]=d.useState(null),[ct,Yt]=d.useState(""),[Z,Ze]=d.useState(null),[nt,Ke]=d.useState(!1),[kt,wt]=d.useState(null);d.useRef(null);const $t=d.useRef(null),At=localStorage.getItem("token"),Vt=async()=>{try{v(!0),j(null);const y=rt("assembly-b"),P=(()=>{try{const Je=localStorage.getItem("user");if(!Je)return"";const se=JSON.parse(Je),Ie=typeof se.role=="object"?se.role?.name:se.role;return String(Ie||"").toLowerCase()}catch{return""}})().includes("admin"),R={menu_name:y},L=await ht.post(`${qt}/order-list`,R,{headers:{Authorization:`Bearer ${At}`}});if((L?.data?.Resp_code==="true"||L?.data?.Resp_code===!0||L?.data?.Resp_code==="RCS")&&Array.isArray(L.data.data)){const Je=L.data.data.map((se,Ie)=>({id:String(se.id),assemblyLine:se.assembly_no||"",gmsoaNo:se.soa_no||"",soaSrNo:se.soa_sr_no||"",assemblyDate:se.assembly_date||"",uniqueCode:se.unique_code||se.order_no||"",splittedCode:se.splitted_code||"",split_id:se.split_id||se.splitted_code||"",party:se.party_name||se.party||"",customerPoNo:se.customer_po_no||"",codeNo:se.code_no||"",product:se.product||"",qty:Number(se.qty||0),totalQty:Number(se.totalQty||se.total_qty||se.qty||0),qtyExe:Number(se.qty_executed||0),qtyPending:Number(se.qty_pending||0),finishedValve:se.finished_valve||"",gmLogo:se.gm_logo||"",namePlate:se.name_plate||"",specialNotes:se.special_notes||se.special_note||"",productSpcl1:se.product_spc1||"",productSpcl2:se.product_spc2||"",productSpcl3:se.product_spc3||"",inspection:se.inspection||"",painting:se.painting||"",remarks:se.remarks||"",alertStatus:se.is_urgent===!0||se.is_urgent==="true"||se.alert_status===!0||se.alert_status==="true"||se.urgent===1||se.urgent==="1",originalIndex:Ie}));console.log(" Orders fetched:",Je.length,"records"),c(We(Je)),f(null),j(null),wt(null)}else console.warn(" No valid order data received",L.data),c([]),j(L?.data?.Resp_desc||"Failed to fetch orders")}catch(p){console.error("Error fetching orders:",p),j("Error fetching order list. Please check your token or server.")}finally{v(!1)}},Ot=d.useMemo(()=>B.trim().length>0||(oe!=="all"||he!=="all"||_e!=="all")||(!!ve||!!be)||me||M,[B,oe,he,_e,ve,be,me,M]);d.useEffect(()=>{Ot||Vt()},[C,S,Ot]);const yt=d.useMemo(()=>Array.from(new Set(l.map(p=>p.assemblyLine))).filter(Boolean).sort(),[l]);d.useMemo(()=>Array.from(new Set(l.map(p=>p.gmsoaNo))).filter(Boolean).sort(),[l]),d.useMemo(()=>Array.from(new Set(l.map(p=>p.party))).filter(Boolean).sort(),[l]);const Ge=p=>{const y=parseInt(p,10);return isNaN(y)?0:y},St=d.useMemo(()=>{let p=l.slice();if(me&&(p=p.filter(y=>a(String(y.id))||y.alertStatus)),M&&(p=p.filter(y=>typeof y.remarks=="string"&&y.remarks.trim().length>0)),oe!=="all"){const y=oe.startsWith("assembly-")?oe.split("-")[1].toUpperCase():oe.toUpperCase();p=p.filter(N=>{const P=String(N.assemblyLine||"").toUpperCase();return P===y||P.includes(y)})}if(he!=="all"&&(p=p.filter(y=>y.gmsoaNo===he)),_e!=="all"&&(p=p.filter(y=>y.party===_e)),(ve||be)&&(p=p.filter(y=>{if(!y.assemblyDate||y.assemblyDate==="HOLD")return!1;const P=y.assemblyDate.split(/[\/-]/).map(L=>L.trim()).map(L=>Number(L));if(P.some(L=>isNaN(L)))return!1;let R=null;if(P.length>=3){const[L,Ne,Je]=P;R=new Date(Je,Ne-1,L)}else if(P.length===2){const[L,Ne]=P;R=new Date(Ne,L-1,1)}else if(P.length===1){const[L]=P;R=new Date(L,0,1)}else return!1;if(!R||isNaN(R.getTime()))return!1;if(Re==="year"&&ve)return R.getFullYear()===ve.getFullYear();if(Re==="month"&&ve)return R.getFullYear()===ve.getFullYear()&&R.getMonth()===ve.getMonth();if(Re==="range"||Re==="single"){if(ve&&be)return R>=ve&&R<=be;if(ve)return R>=ve;if(be)return R<=be}return!0})),B.trim()){const y=B.toLowerCase();p=p.filter(N=>String(N.uniqueCode).toLowerCase().includes(y)||String(N.party).toLowerCase().includes(y)||String(N.gmsoaNo).toLowerCase().includes(y)||String(N.customerPoNo).toLowerCase().includes(y)||String(N.codeNo).toLowerCase().includes(y)||String(N.product).toLowerCase().includes(y))}return I&&(p=[...p].sort((y,N)=>{const P=Ge(y.soaSrNo),R=Ge(N.soaSrNo);return I==="asc"?P-R:R-P})),p},[l,B,me,M,oe,he,_e,Re,ve,be,a,I]),Ct=(p="",y=4)=>{const N=p.trim().split(/\s+/);return N.length<=y?p:N.slice(0,y).join(" ")+"..."},Zt=d.useMemo(()=>{const p=(C-1)*S;return St.slice(p,p+S)},[St,C,S]);d.useEffect(()=>{k(1)},[B,oe,he,_e,ve,be,me,M]);const _t=p=>{ce(y=>{const N=new Set(y);return N.has(p)?N.delete(p):N.add(p),N})},Ut=()=>{ce(p=>{if(p.size===St.length)return new Set;const y=St.map(N=>N.splittedCode||N.split_id||N.uniqueCode||N.id);return new Set(y)})},Kt=St.length>0&&U.size===St.length,Bt="assembly-b",Xt=Ns(Bt),as=(ye?.assemblyLine||"").toUpperCase().includes("D"),ds=Xt.filter(p=>p==="testing1"||p==="testing2"?as?p==="testing2":p==="testing1":!0);console.log("Next step(s):",Xt.map(rt)),console.log("Is final step?",fn(Bt));const ls=p=>{const N=Ns("assembly-b");fe(p),ae(!0);const P=(p.assemblyLine||"").toUpperCase().includes("D"),R=N.filter(L=>L==="testing1"||L==="testing2"?P?L==="testing2":L==="testing1":!0);Le(R[0]||N[0]||""),Ve(String(p.qtyPending??p.qty??0)),G(null),x(!1),Nt(!1),Qt(""),Me(""),it({})},us=()=>{const p={},y=Number(ye?.qtyPending??0),N=Number(De||0),P=Number(qe||0);if(Ee||(p.quickAssignStep="Please select a workflow step."),(!De||N<=0)&&(p.quickAssignQty="Quantity must be greater than 0."),N>y&&(p.quickAssignQty=`Cannot exceed available (${y})`),et){ot||(p.splitAssignStep="Choose split step."),(!qe||P<=0)&&(p.splitAssignQty="Split quantity is required."),Ee===ot&&(p.sameEngineer="Split step cannot be the same as main step.");const R=N+P;R!==y&&(p.totalQtyMismatch=`Total quantity (${R}) must equal available (${y}).`)}return it(p),Object.keys(p).length===0},V=()=>{t.current&&(t.current.abort(),t.current=null),x(!1),G(null),ae(!1),fe(null),Le(""),Ve(""),Nt(!1),Qt(""),Me(""),it({})},ie=l.filter(p=>U.has(p.splittedCode||p.split_id||p.uniqueCode||p.id)),K=()=>pt(!0),ee=()=>{const y=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>

        <style>
          @page {
            size: 130mm 85mm;
            margin: 0;
          }

          html, body {
            width: 130mm;
            height: 85mm;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
          }

          .item-label,
          .party-desc {
          padding-bottom: 2mm;}

          .item-label {
          line-height: 1.8em;}

          .bin-card {
            width: 130mm;
            height: 85mm;
            padding: 6mm;
            box-sizing: border-box;
            page-break-after: always;
          }

        .item-label-description {
        padding-top: 50px;}

          .meta-qty {
          width: 50%;}

          .process-border {
          border-top:1px solid #000;
          border-bottom:1px solid #000;
          padding-top: 1.5mm;
          padding-bottom: 1.5mm;
          }

          .detail-logo {
            padding-bottom: 0.9mm;
          }

          .description {
            padding-bottom: 2mm;
          }

          .content {
            width: 100%;
            height: 100%;
            border: 1.5px solid #000;
            border-radius: 10px;
            padding-top: 2mm;
            padding-bottom: 4mm;
              padding-left: 6mm;
                  padding-right: 6mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
          }

          .meta-item {
            padding-top: 2mm;
          }

          /* RESET DEFAULT P TAG SPACE */
          p {
            margin: 0;
          }

          /* HEADER */
          .company-name {
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1mm;
            
          }

          .assembly-title p {
          border: 1px solid #000;
            display: inline-block;
            padding-top: 1mm;
            padding-bottom: 0.9mm;
            padding-left: 1mm;
            padding-right: 1mm;
          }

          .company-address {
            font-size: 8px;
            font-weight: 400;
            text-align: center;
            line-height: 1.2;
            margin: 0 0 1.2mm;
          }

          .tag-title {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1.5mm;
          }

          .doc-row {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            margin-bottom: 0.5mm; /*  reduced */
          }

          /* ASSEMBLY LINE */
          .title {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            margin-top: 0;       /*  no top gap */
            margin-bottom: 0.5mm;
            //  border: 1px solid #000;
            // display: inline-block;
          }

          .title-line {
            border-bottom: 1px solid #000;
            margin-bottom: 1.5mm;
            margin-top: 0.5mm;
          }

          /* META */
          .meta {
            font-size: 10px;
            line-height: 1.25;
            margin-bottom: 0.8mm;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }

          .meta div {
            margin-bottom: 0.5mm;
          }

          /* ITEM */
          .desc {
            font-size: 9px;
            margin-bottom: 0.8mm;
          }

          .desc p {
          padding-bottom: 0.6mm;}

          .desc span {
            display: block;
            padding-bottom: 0.1mm;
          }

          .desc .label {
            display: block;
            font-size: 10px;
            margin-bottom: 0.8mm;
            margin-top: 0.8mm;
          }

          .desc .text {
            word-break: break-word;
            
          }

          /* QTY */
          .qty-logo {
            font-size: 10px;
            line-height: 1.3;
            margin-bottom: 0.4mm;
            margin-top: 0.8mm;
          }

          /* INSPECTION */
          .inspect {
            margin-top: auto;
            font-size: 10px;
          }

          .inspect-line {
            height: 3mm;
            border-bottom: 1px solid #000;
          }

          .label {
            font-weight: 600;
          }
        </style>
      </head>

      <body>${ie.map(R=>`
        <div class="bin-card">
          <div class="content">

            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>

            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${R.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(R.gmsoaNo).replace(/^SOA/i,"")}-${R.soaSrNo}
                </div>

              </div>
                <div class="title assembly-title">
                  <p>Assembly Line: ${R.assemblyLine}</p>
                </div>
                <div class="meta-item">
                  <p>GMV-L4-F-PRD 01 A</p>
                  <p>(02/10.09.2020)</p>
                </div>
          </div>

            

            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${R.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${R.product}</p>
              </div>
            </div>

            <div class="qty-logo">
            <div class="meta meta-logo">
              <div class="meta-qty"><span class="label">QTY:</span> ${R.qty}</div>
              <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${R.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${R.specialNotes||""}</span></div>
              </div>

            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>

          </div>
        </div>`).join("")}</body>
    </html>`,N=document.createElement("iframe");N.style.position="fixed",N.style.right="0",N.style.bottom="0",N.style.width="0",N.style.height="0",N.style.border="0",document.body.appendChild(N);const P=N.contentDocument||N.contentWindow?.document;P&&(P.open(),P.write(y),P.close(),setTimeout(()=>{N.contentWindow?.focus(),N.contentWindow?.print(),setTimeout(()=>document.body.removeChild(N),500)},300))},de=p=>{Ue(p),tt(!0)},le=p=>p.splittedCode||p.split_id?p.splittedCode||p.split_id:[p.uniqueCode,p.soaSrNo,p.gmsoaNo,p.codeNo,p.assemblyLine].map(y=>y??"").join("|"),Pe=d.useMemo(()=>{const p=St.filter(y=>U.has(le(y)));return{count:p.length,qty:p.reduce((y,N)=>y+(N.totalQty||N.qty||0),0),qtyExe:p.reduce((y,N)=>y+(N.qtyExe||0),0),qtyPending:p.reduce((y,N)=>y+(N.qtyPending||0),0)}},[U,St]),Be=()=>{const p=me===!0,y=M===!0,N=U.size>0;if(!p&&!y&&!N)return;const P=N?St.filter(R=>U.has(le(R))):St;if(!P.length){alert("No data available to export");return}je(P)},Te=()=>{const p=u&&u.length>0?u:l;if(!p||p.length===0){alert("No data available to export");return}je(p)},je=p=>{const y=p.map((L,Ne)=>({No:Ne+1,"Assembly Line":L.assemblyLine,"GMSOA No":L.gmsoaNo,"SOA Sr No":L.soaSrNo,"Assembly Date":L.assemblyDate,"Unique Code":L.uniqueCode,"Splitted Code":L.splittedCode||"-",Party:L.party,"Customer PO No":L.customerPoNo,"Code No":L.codeNo,Product:L.product,"PO Qty":L.poQty,Qty:L.qty,"Qty Executed":L.qtyExe,"Qty Pending":L.qtyPending,"Finished Valve":L.finishedValve,"GM Logo":L.gmLogo,"Name Plate":L.namePlate,"Special Notes":L.specialNotes||"","Product Special 1":L.productSpcl1,"Product Special 2":L.productSpcl2,"Product Special 3":L.productSpcl3,Inspection:L.inspection,Painting:L.painting,Remarks:L.remarks||""})),N=Ht.json_to_sheet(y),P=Ht.book_new();Ht.book_append_sheet(P,N,"Orders");const R=Zs(P,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([R],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Ce=p=>{jt(p),Yt(p.remarks||""),zt(!0)},Fe=async()=>{if(!gt)return;const p=new FormData;p.append("orderId",String(gt.id)),p.append("remarks",ct);try{const y=await ht.post(`${qt}/add-remarks`,p,{headers:{Authorization:`Bearer ${At}`}});if(console.log("Add Remarks Response:",y.data),y.data?.Resp_code==="true"||y.data?.Resp_code===!0){c(P=>P.map(R=>R.id===gt.id?{...R,remarks:ct}:R));try{s(gt.id,ct)}catch{}zt(!1),jt(null),Yt("")}else console.warn("Backend rejected remarks:",y.data)}catch(y){console.error("Error saving remarks:",y)}},We=p=>[...p].sort((y,N)=>(y.originalIndex??0)-(N.originalIndex??0)),[ge,G]=d.useState(null),[T,x]=d.useState(!1),A=async()=>{if(T||!ye||!us())return;x(!0);const p=new AbortController;t.current=p,G({type:"info",message:"Assigning order, please wait..."});try{const y=localStorage.getItem("token");if(!y){G({type:"error",message:"Token missing. Please log in again."});return}const N="assembly-b",P=Number(De||0),R=Number(qe||0),L=Ee||(Array.isArray(Xt)?Xt[0]:"Assembly D"),Ne=rt(L),Je=rt(N),se=new FormData;se.append("orderId",String(ye.id)),se.append("totalQty",String(ye.totalQty??ye.qty??0)),se.append("executedQty",String(P)),se.append("currentSteps",Je),se.append("nextSteps",Ne),se.append("split_id",String(ye.split_id||""));const Ie=await ht.post(`${qt}/assign-order`,se,{headers:{Authorization:`Bearer ${y}`},signal:p.signal});if(!(Ie.data?.Resp_code==="true"||Ie.data?.Resp_code===!0)){G({type:"error",message:Ie.data?.Resp_desc||"Main assignment failed."});return}let te=`Assigned ${P}  ${Ne}`;if(et&&R>0){const Se=new FormData;Se.append("orderId",String(ye.id)),Se.append("totalQty",String(ye.totalQty??ye.qty??0)),Se.append("executedQty",String(R)),Se.append("currentSteps",Je),Se.append("nextSteps",Ne),Se.append("split_id",String(ye.split_id||""));const at=await ht.post(`${qt}/assign-order`,Se,{headers:{Authorization:`Bearer ${y}`},signal:p.signal});at.data?.Resp_code==="true"||at.data?.Resp_code===!0?te+=`
 Split ${R}  ${Ne}`:G({type:"error",message:"Main assigned but split failed: "+(at.data?.Resp_desc||"Unknown error")})}G({type:"success",message:` ${te}`}),c(Se=>Se.map(at=>{if(at.id!==ye.id)return at;const ut=at.qtyExe||0,Wt=P+(et?R:0),vt=ut+Wt,Hr=(at.totalQty??at.qty)-vt;return{...at,qtyExe:vt,qtyPending:Hr}})),await Vt(),setTimeout(()=>{ae(!1),G(null),ce(new Set)},1e3)}catch(y){if(y?.name==="CanceledError"||y?.code==="ERR_CANCELED"){console.log(" Assign request cancelled");return}console.error(" Error assigning order:",y),G({type:"error",message:"Server error while assigning."})}finally{x(!1),t.current=null}},g=()=>{ue("all"),ke("all"),Y("range"),Q(void 0),pe(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"assembly-b",currentPage:"Assembly-B",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:p=>{const y=p.toLowerCase().replace(/\s+/g,"-");window.location.href=`/${y}`},onUploadSuccess:()=>Vt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4 ",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsxs("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold flex gap-3",children:["Assembly B",e.jsx(J,{onClick:()=>ne("/testing-assembly",{state:{source:"assembly-b"}}),variant:"outline",className:"flex items-center gap-2",children:"Testing-1"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(J,{onClick:K,variant:"outline",disabled:U.size===0,className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>re(!me),className:`btn-urgent flex items-center gap-2 ${me?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),me?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>W(!M),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:M?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:Be,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:Te,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"assembly-b",searchTerm:B,setSearchTerm:q,assemblyLineFilter:oe,setAssemblyLineFilter:X,dateFilterMode:Re,setDateFilterMode:Y,dateFrom:ve,setDateFrom:Q,dateTo:be,setDateTo:pe,assemblyLines:yt,onClearFilters:g,hasActiveFilters:he!=="all"||_e!=="all"||!!ve||!!be})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:$t,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:h&&l.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Kt),onClick:Ut,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Kt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>F(p=>p==="asc"?"desc":p==="desc"?null:"asc"),children:["Sr.No.",I==="asc"&&" ",I==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Zt.map(p=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:U.has(p.splittedCode||p.split_id||p.uniqueCode||p.id),onCheckedChange:()=>_t(p.splittedCode||p.split_id||p.uniqueCode||p.id),"aria-label":`Select row ${p.splittedCode||p.split_id||p.uniqueCode||p.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:p.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:p.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:p.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:p.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:p.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:p.party,children:Ct(p.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:p.product,children:p.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:p.specialNotes,children:p.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:p.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:p.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${p.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Ce(p),children:e.jsx(lr,{className:`h-4 w-4 ${p.remarks?.trim()?"text-white":"text-blue-600"}`})}),p.remarks?.trim()&&e.jsx("div",{className:`\r
                                                        absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                        hidden group-hover:block\r
                                                        bg-gray-900 text-white text-xs\r
                                                        px-3 py-2 rounded-md shadow-lg\r
                                                        max-w-[260px] break-words z-[999]\r
                                                      `,children:p.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>de(p),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ls(p),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${p.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${p.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},p.splittedCode||p.split_id||p.uniqueCode||p.id))})]}),St.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),Pe.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:Pe.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:Pe.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:Pe.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:Pe.qtyPending})]})]}),e.jsx(cr,{page:C,perPage:S,total:St.length,lastPage:Math.max(1,Math.ceil(St.length/Math.max(S,1))),onChangePage:k,onChangePerPage:_,disabled:h}),e.jsx(Rt,{open:z,onOpenChange:p=>{p?ae(!0):V()},children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",ye?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:Ee,onValueChange:Le,disabled:!0,children:[e.jsx(nr,{id:"assignStep",children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:ds.map(p=>e.jsx(Es,{value:p,children:rt(p)},p))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:De,onChange:p=>{const y=p.target.value;Ve(y);const N=Number(ye?.qtyPending??0),P=Number(y||0);it(R=>{const L={...R};return P>N?L.quickAssignQty=`Cannot exceed available (${N})`:L.quickAssignQty&&delete L.quickAssignQty,L})},max:ye?.qtyPending}),mt.quickAssignQty&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:mt.quickAssignQty})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:ye?.qtyPending})]})]})}),ge&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${ge.type==="success"?"bg-green-50 text-green-700 border border-green-200":ge.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:ge.message.split(`
`).map((p,y)=>e.jsx("div",{children:p},y))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:V,disabled:T,children:"Cancel"}),e.jsx(J,{onClick:A,disabled:T||!!mt.quickAssignQty,className:"bg-black hover:bg-gray-800 text-white",children:T?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:Et,onOpenChange:pt,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ie.map(p=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",p.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(p.gmsoaNo).replace(/^SOA/i,""),"-",p.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",p.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:p.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:p.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",p.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",p.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:p.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},p.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>pt(!1),children:"Cancel"}),e.jsxs(J,{onClick:ee,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:xe,onOpenChange:tt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",lt?.uniqueCode]})]}),lt&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:lt.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>tt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:He,onOpenChange:zt,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:gt?`Order: ${gt.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:ct,onChange:p=>Yt(p.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>zt(!1),children:"Cancel"}),e.jsx(J,{onClick:Fe,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function cf(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),pe=Pn(),[ne,U]=d.useState(new Set),[ce,z]=d.useState(!1),[ae,ye]=d.useState(null),[fe,Ee]=d.useState(""),[Le,De]=d.useState(""),[Ve,et]=d.useState(!1),[Nt,ot]=d.useState(""),[Qt,qe]=d.useState(""),[Me,mt]=d.useState({}),[it,Et]=d.useState(!1),[pt,xe]=d.useState(!1),[tt,lt]=d.useState(null),[Ue,He]=d.useState(!1),[zt,gt]=d.useState(null),[jt,ct]=d.useState(""),[Yt,Z]=d.useState(null),[Ze,nt]=d.useState(!1),[Ke,kt]=d.useState(null);d.useRef(null);const wt=d.useRef(null),$t=localStorage.getItem("token"),At=async()=>{try{h(!0),w(null);const p=rt("assembly-c"),N=(()=>{try{const Je=localStorage.getItem("user");if(!Je)return"";const se=JSON.parse(Je),Ie=typeof se.role=="object"?se.role?.name:se.role;return String(Ie||"").toLowerCase()}catch{return""}})().includes("admin"),P={menu_name:p},R=await ht.post(`${qt}/order-list`,P,{headers:{Authorization:`Bearer ${$t}`}}),L=R?.data?.Resp_code==="true"||R?.data?.Resp_code===!0||R?.data?.Resp_code==="RCS"||R?.status===200,Ne=Array.isArray(R?.data?.data)?R.data.data:Array.isArray(R?.data?.orders)?R.data.orders:Array.isArray(R?.data)?R.data:[];if(L&&Array.isArray(Ne)){const Je=Ne.map((se,Ie)=>({id:String(se.id),assemblyLine:se.assembly_no||"",gmsoaNo:se.soa_no||"",soaSrNo:se.soa_sr_no||"",assemblyDate:se.assembly_date||"",uniqueCode:se.unique_code||se.order_no||"",splittedCode:se.splitted_code||"",split_id:se.split_id||se.splitted_code||"",party:se.party_name||se.party||"",customerPoNo:se.customer_po_no||"",codeNo:se.code_no||"",product:se.product||"",qty:Number(se.qty||0),totalQty:Number(se.totalQty||se.total_qty||se.qty||0),qtyExe:Number(se.qty_executed||0),qtyPending:Number(se.qty_pending||0),finishedValve:se.finished_valve||"",gmLogo:se.gm_logo||"",namePlate:se.name_plate||"",specialNotes:se.special_notes||se.special_note||"",productSpcl1:se.product_spc1||"",productSpcl2:se.product_spc2||"",productSpcl3:se.product_spc3||"",inspection:se.inspection||"",painting:se.painting||"",remarks:se.remarks||"",alertStatus:se.is_urgent===!0||se.is_urgent==="true"||se.alert_status===!0||se.alert_status==="true"||se.urgent===1||se.urgent==="1",originalIndex:Ie}));console.log(" Orders fetched:",Je.length,"records"),l(Fe(Je)),u(null),w(null),kt(null)}else console.warn(" No valid order data received",R.data),l([]),w(R?.data?.Resp_desc||"Failed to fetch orders")}catch(g){console.error("Error fetching orders:",g),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Vt=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{Vt||At()},[j,k,Vt]);const Ot=d.useMemo(()=>Array.from(new Set(a.map(g=>g.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(g=>g.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(g=>g.party))).filter(Boolean).sort(),[a]);const yt=g=>{const p=parseInt(g,10);return isNaN(p)?0:p},Ge=d.useMemo(()=>{let g=a.slice();if(q&&(g=g.filter(p=>n(String(p.id))||p.alertStatus)),re&&(g=g.filter(p=>typeof p.remarks=="string"&&p.remarks.trim().length>0)),W!=="all"){const p=W.startsWith("assembly-")?W.split("-")[1].toUpperCase():W.toUpperCase();g=g.filter(y=>{const N=String(y.assemblyLine||"").toUpperCase();return N===p||N.includes(p)})}if(X!=="all"&&(g=g.filter(p=>p.gmsoaNo===X)),ue!=="all"&&(g=g.filter(p=>p.party===ue)),(Y||Q)&&(g=g.filter(p=>{if(!p.assemblyDate||p.assemblyDate==="HOLD")return!1;const N=p.assemblyDate.split(/[\/-]/).map(R=>R.trim()).map(R=>Number(R));if(N.some(R=>isNaN(R)))return!1;let P=null;if(N.length>=3){const[R,L,Ne]=N;P=new Date(Ne,L-1,R)}else if(N.length===2){const[R,L]=N;P=new Date(L,R-1,1)}else if(N.length===1){const[R]=N;P=new Date(R,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(ke==="year"&&Y)return P.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return P.getFullYear()===Y.getFullYear()&&P.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return P>=Y&&P<=Q;if(Y)return P>=Y;if(Q)return P<=Q}return!0})),F.trim()){const p=F.toLowerCase();g=g.filter(y=>String(y.uniqueCode).toLowerCase().includes(p)||String(y.party).toLowerCase().includes(p)||String(y.gmsoaNo).toLowerCase().includes(p)||String(y.customerPoNo).toLowerCase().includes(p)||String(y.codeNo).toLowerCase().includes(p)||String(y.product).toLowerCase().includes(p))}return _&&(g=[...g].sort((p,y)=>{const N=yt(p.soaSrNo),P=yt(y.soaSrNo);return _==="asc"?N-P:P-N})),g},[a,F,q,re,W,X,ue,ke,Y,Q,n,_]),St=d.useMemo(()=>{const g=(j-1)*k;return Ge.slice(g,g+k)},[Ge,j,k]),Ct=(g="",p=4)=>{const y=g.trim().split(/\s+/);return y.length<=p?g:y.slice(0,p).join(" ")+"..."};d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const Zt=g=>{U(p=>{const y=new Set(p);return y.has(g)?y.delete(g):y.add(g),y})},_t=()=>{U(g=>{if(g.size===Ge.length)return new Set;const p=Ge.map(y=>y.splittedCode||y.split_id||y.uniqueCode||y.id);return new Set(p)})},Ut=Ge.length>0&&ne.size===Ge.length,Kt="assembly-c",Bt=Ns(Kt),Xt=(ae?.assemblyLine||"").toUpperCase().includes("D"),as=Bt.filter(g=>g==="testing1"||g==="testing2"?Xt?g==="testing2":g==="testing1":!0);console.log("Next step(s):",Bt.map(rt)),console.log("Is final step?",fn(Kt));const ds=g=>{const y=Ns("assembly-c");ye(g),z(!0);const N=(g.assemblyLine||"").toUpperCase().includes("D"),P=y.filter(R=>R==="testing1"||R==="testing2"?N?R==="testing2":R==="testing1":!0);Ee(P[0]||y[0]||""),De(String(g.qtyPending??g.qty??0)),ge(null),T(!1),et(!1),ot(""),qe(""),mt({})},ls=()=>{const g={},p=Number(ae?.qtyPending??0),y=Number(Le||0),N=Number(Qt||0);if(fe||(g.quickAssignStep="Please select a workflow step."),(!Le||y<=0)&&(g.quickAssignQty="Quantity must be greater than 0."),y>p&&(g.quickAssignQty=`Cannot exceed available (${p})`),Ve){Nt||(g.splitAssignStep="Choose split step."),(!Qt||N<=0)&&(g.splitAssignQty="Split quantity is required."),fe===Nt&&(g.sameEngineer="Split step cannot be the same as main step.");const P=y+N;P!==p&&(g.totalQtyMismatch=`Total quantity (${P}) must equal available (${p}).`)}return mt(g),Object.keys(g).length===0},us=()=>{T(!1),ge(null),z(!1),ye(null),Ee(""),De(""),et(!1),ot(""),qe(""),mt({})},V=a.filter(g=>ne.has(g.splittedCode||g.split_id||g.uniqueCode||g.id)),ie=()=>Et(!0),K=()=>{const p=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>

        <style>
          @page {
            size: 130mm 85mm;
            margin: 0;
          }

          html, body {
            width: 130mm;
            height: 85mm;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
          }

          .item-label,
          .party-desc {
          padding-bottom: 2mm;}

          .item-label {
          line-height: 1.8em;}

          .bin-card {
            width: 130mm;
            height: 85mm;
            padding: 6mm;
            box-sizing: border-box;
            page-break-after: always;
          }

        .item-label-description {
        padding-top: 50px;}

          .meta-qty {
          width: 50%;}

          .process-border {
          border-top:1px solid #000;
          border-bottom:1px solid #000;
          padding-top: 1.5mm;
          padding-bottom: 1.5mm;
          }

          .detail-logo {
            padding-bottom: 0.9mm;
          }

          .description {
            padding-bottom: 2mm;
          }

          .content {
            width: 100%;
            height: 100%;
            border: 1.5px solid #000;
            border-radius: 10px;
            padding-top: 2mm;
            padding-bottom: 4mm;
              padding-left: 6mm;
                  padding-right: 6mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
          }

          .meta-item {
            padding-top: 2mm;
          }

          /* RESET DEFAULT P TAG SPACE */
          p {
            margin: 0;
          }

          /* HEADER */
          .company-name {
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1mm;
            
          }

          .assembly-title p {
          border: 1px solid #000;
            display: inline-block;
            padding-top: 1mm;
            padding-bottom: 0.9mm;
            padding-left: 1mm;
            padding-right: 1mm;
          }

          .company-address {
            font-size: 8px;
            font-weight: 400;
            text-align: center;
            line-height: 1.2;
            margin: 0 0 1.2mm;
          }

          .tag-title {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1.5mm;
          }

          .doc-row {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            margin-bottom: 0.5mm; /*  reduced */
          }

          /* ASSEMBLY LINE */
          .title {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            margin-top: 0;       /*  no top gap */
            margin-bottom: 0.5mm;
            //  border: 1px solid #000;
            // display: inline-block;
          }

          .title-line {
            border-bottom: 1px solid #000;
            margin-bottom: 1.5mm;
            margin-top: 0.5mm;
          }

          /* META */
          .meta {
            font-size: 10px;
            line-height: 1.25;
            margin-bottom: 0.8mm;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }

          .meta div {
            margin-bottom: 0.5mm;
          }

          /* ITEM */
          .desc {
            font-size: 9px;
            margin-bottom: 0.8mm;
          }

          .desc p {
          padding-bottom: 0.6mm;}

          .desc span {
            display: block;
            padding-bottom: 0.1mm;
          }

          .desc .label {
            display: block;
            font-size: 10px;
            margin-bottom: 0.8mm;
            margin-top: 0.8mm;
          }

          .desc .text {
            word-break: break-word;
            
          }

          /* QTY */
          .qty-logo {
            font-size: 10px;
            line-height: 1.3;
            margin-bottom: 0.4mm;
            margin-top: 0.8mm;
          }

          /* INSPECTION */
          .inspect {
            margin-top: auto;
            font-size: 10px;
          }

          .inspect-line {
            height: 3mm;
            border-bottom: 1px solid #000;
          }

          .label {
            font-weight: 600;
          }
        </style>
      </head>

      <body>${V.map(P=>`
        <div class="bin-card">
          <div class="content">

            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>

            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${P.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(P.gmsoaNo).replace(/^SOA/i,"")}-${P.soaSrNo}
                </div>

              </div>
                <div class="title assembly-title">
                  <p>Assembly Line: ${P.assemblyLine}</p>
                </div>
                <div class="meta-item">
                  <p>GMV-L4-F-PRD 01 A</p>
                  <p>(02/10.09.2020)</p>
                </div>
          </div>

            

            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${P.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${P.product}</p>
              </div>
            </div>

            <div class="qty-logo">
            <div class="meta meta-logo">
              <div class="meta-qty"><span class="label">QTY:</span> ${P.qty}</div>
              <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${P.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${P.specialNotes||""}</span></div>
              </div>

            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>

          </div>
        </div>`).join("")}</body>
    </html>`,y=document.createElement("iframe");y.style.position="fixed",y.style.right="0",y.style.bottom="0",y.style.width="0",y.style.height="0",y.style.border="0",document.body.appendChild(y);const N=y.contentDocument||y.contentWindow?.document;N&&(N.open(),N.write(p),N.close(),setTimeout(()=>{y.contentWindow?.focus(),y.contentWindow?.print(),setTimeout(()=>document.body.removeChild(y),500)},300))},ee=g=>{lt(g),xe(!0)},de=g=>g.splittedCode||g.split_id?g.splittedCode||g.split_id:[g.uniqueCode,g.soaSrNo,g.gmsoaNo,g.codeNo,g.assemblyLine].map(p=>p??"").join("|"),le=d.useMemo(()=>{const g=Ge.filter(p=>ne.has(de(p)));return{count:g.length,qty:g.reduce((p,y)=>p+(y.totalQty||y.qty||0),0),qtyExe:g.reduce((p,y)=>p+(y.qtyExe||0),0),qtyPending:g.reduce((p,y)=>p+(y.qtyPending||0),0)}},[ne,Ge]),Pe=()=>{const g=q===!0,p=re===!0,y=ne.size>0;if(!g&&!p&&!y)return;const N=y?Ge.filter(P=>ne.has(de(P))):Ge;if(!N.length){alert("No data available to export");return}Te(N)},Be=()=>{const g=c&&c.length>0?c:a;if(!g||g.length===0){alert("No data available to export");return}Te(g)},Te=g=>{const p=g.map((R,L)=>({No:L+1,"Assembly Line":R.assemblyLine,"GMSOA No":R.gmsoaNo,"SOA Sr No":R.soaSrNo,"Assembly Date":R.assemblyDate,"Unique Code":R.uniqueCode,"Splitted Code":R.splittedCode||"-",Party:R.party,"Customer PO No":R.customerPoNo,"Code No":R.codeNo,Product:R.product,"PO Qty":R.poQty,Qty:R.qty,"Qty Executed":R.qtyExe,"Qty Pending":R.qtyPending,"Finished Valve":R.finishedValve,"GM Logo":R.gmLogo,"Name Plate":R.namePlate,"Special Notes":R.specialNotes||"","Product Special 1":R.productSpcl1,"Product Special 2":R.productSpcl2,"Product Special 3":R.productSpcl3,Inspection:R.inspection,Painting:R.painting,Remarks:R.remarks||""})),y=Ht.json_to_sheet(p),N=Ht.book_new();Ht.book_append_sheet(N,y,"Orders");const P=Zs(N,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([P],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},je=g=>{gt(g),ct(g.remarks||""),He(!0)},Ce=async()=>{if(!zt)return;const g=new FormData;g.append("orderId",String(zt.id)),g.append("remarks",jt);try{const p=await ht.post(`${qt}/add-remarks`,g,{headers:{Authorization:`Bearer ${$t}`}});if(console.log("Add Remarks Response:",p.data),p.data?.Resp_code==="true"||p.data?.Resp_code===!0){l(N=>N.map(P=>P.id===zt.id?{...P,remarks:jt}:P));try{t(zt.id,jt)}catch{}He(!1),gt(null),ct("")}else console.warn("Backend rejected remarks:",p.data)}catch(p){console.error("Error saving remarks:",p)}},Fe=g=>[...g].sort((p,y)=>(p.originalIndex??0)-(y.originalIndex??0)),[We,ge]=d.useState(null),[G,T]=d.useState(!1),x=async()=>{if(!G&&ae&&ls()){T(!0),ge({type:"info",message:"Assigning order, please wait..."});try{const g=localStorage.getItem("token");if(!g){ge({type:"error",message:"Token missing. Please log in again."});return}const y=rt("assembly-c"),N=Number(Le||0),P=Number(Qt||0),R=fe||(Array.isArray(Bt)?Bt[0]:"assembly-d"),L=rt(R),Ne=new FormData;Ne.append("orderId",String(ae.id)),Ne.append("totalQty",String(ae.totalQty??ae.qty??0)),Ne.append("executedQty",String(N)),Ne.append("currentSteps",y),Ne.append("nextSteps",L),Ne.append("split_id",String(ae.split_id||""));const Je=await ht.post(`${qt}/assign-order`,Ne,{headers:{Authorization:`Bearer ${g}`}});if(!(Je.data?.Resp_code==="true"||Je.data?.Resp_code===!0)){ge({type:"error",message:Je.data?.Resp_desc||"Main assignment failed."});return}let Ie=`Assigned ${N}  ${L}`;if(Ve&&P>0){const $e=new FormData;$e.append("orderId",String(ae.id)),$e.append("totalQty",String(ae.totalQty??ae.qty??0)),$e.append("executedQty",String(P)),$e.append("currentSteps",y),$e.append("nextSteps",L),$e.append("split_id",String(ae.split_id||"")),$e.append("splitOrder","true");const te=await ht.post(`${qt}/assign-order`,$e,{headers:{Authorization:`Bearer ${g}`}});te.data?.Resp_code==="true"||te.data?.Resp_code===!0?Ie+=`
 Split ${P}  ${L}`:ge({type:"error",message:"Main assigned but split failed: "+(te.data?.Resp_desc||"Unknown error")})}ge({type:"success",message:` ${Ie}`}),l($e=>$e.map(te=>{if(te.id!==ae.id)return te;const Se=Number(te.qtyExe||0),at=Number(te.totalQty||te.qty||0),ut=Se+N+(Ve?P:0),Wt=at-ut;return{...te,qtyExe:ut,qtyPending:Wt}})),await At(),setTimeout(()=>{z(!1),ge(null)},1e3)}catch(g){console.error(" Error assigning order:",g),ge({type:"error",message:"Server error while assigning."})}finally{T(!1)}}},A=()=>{he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"assembly-c",currentPage:"Assembly-C",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:g=>{const p=g.toLowerCase().replace(/\s+/g,"-");window.location.href=`/${p}`},onUploadSuccess:()=>At()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsxs("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold flex gap-3",children:["Assembly C",e.jsx(J,{onClick:()=>pe("/testing-assembly",{state:{source:"assembly-c"}}),variant:"outline",className:"flex items-center gap-2",children:"Testing-1"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(J,{onClick:ie,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:Pe,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:Be,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"assembly-c",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:Ot,onClearFilters:A,hasActiveFilters:X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:wt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ut),onClick:_t,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ut?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(g=>g==="asc"?"desc":g==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:St.map(g=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:ne.has(g.splittedCode||g.split_id||g.uniqueCode||g.id),onCheckedChange:()=>Zt(g.splittedCode||g.split_id||g.uniqueCode||g.id),"aria-label":`Select row ${g.splittedCode||g.split_id||g.uniqueCode||g.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:g.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:g.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:g.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:g.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:g.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:g.party,children:Ct(g.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:g.product,children:g.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:g.specialNotes,children:g.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:g.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:g.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${g.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>je(g),children:e.jsx(lr,{className:`h-4 w-4 ${g.remarks?.trim()?"text-white":"text-blue-600"}`})}),g.remarks?.trim()&&e.jsx("div",{className:`\r
                                                                              absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                                              hidden group-hover:block\r
                                                                              bg-gray-900 text-white text-xs\r
                                                                              px-3 py-2 rounded-md shadow-lg\r
                                                                              max-w-[260px] break-words z-[999]\r
                                                                            `,children:g.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>ee(g),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ds(g),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${g.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${g.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},g.splittedCode||g.split_id||g.uniqueCode||g.id))})]}),Ge.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),le.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:le.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:le.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:le.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:le.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:Ge.length,lastPage:Math.max(1,Math.ceil(Ge.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:ce,onOpenChange:z,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",ae?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:fe,onValueChange:Ee,disabled:!0,children:[e.jsx(nr,{id:"assignStep",children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:as.map(g=>e.jsx(Es,{value:g,children:rt(g)},g))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Le,onChange:g=>{const p=g.target.value;De(p);const y=Number(ae?.qtyPending??0),N=Number(p||0);mt(P=>{const R={...P};return N>y?R.quickAssignQty=`Cannot exceed available (${y})`:R.quickAssignQty&&delete R.quickAssignQty,R})},max:ae?.qtyPending}),Me.quickAssignQty&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:Me.quickAssignQty})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:ae?.qtyPending})]})]})}),We&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${We.type==="success"?"bg-green-50 text-green-700 border border-green-200":We.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:We.message.split(`
`).map((g,p)=>e.jsx("div",{children:g},p))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:us,disabled:G,children:"Cancel"}),e.jsx(J,{onClick:x,disabled:G||!!Me.quickAssignQty,className:"bg-black hover:bg-gray-800 text-white",children:G?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:it,onOpenChange:Et,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:V.map(g=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",g.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(g.gmsoaNo).replace(/^SOA/i,""),"-",g.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",g.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:g.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:g.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",g.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",g.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:g.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},g.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>Et(!1),children:"Cancel"}),e.jsxs(J,{onClick:K,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:pt,onOpenChange:xe,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",tt?.uniqueCode]})]}),tt&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>xe(!1),children:"Close"})})]})}),e.jsx(Rt,{open:Ue,onOpenChange:He,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:zt?`Order: ${zt.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:jt,onChange:g=>ct(g.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>He(!1),children:"Cancel"}),e.jsx(J,{onClick:Ce,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function df(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(20),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),pe=Pn(),[ne,U]=d.useState(new Set),[ce,z]=d.useState(!1),[ae,ye]=d.useState(null),[fe,Ee]=d.useState(""),[Le,De]=d.useState(""),[Ve,et]=d.useState(!1),[Nt,ot]=d.useState(""),[Qt,qe]=d.useState(""),[Me,mt]=d.useState({}),[it,Et]=d.useState(!1),[pt,xe]=d.useState(!1),[tt,lt]=d.useState(null),[Ue,He]=d.useState(!1),[zt,gt]=d.useState(null),[jt,ct]=d.useState(""),[Yt,Z]=d.useState(null),[Ze,nt]=d.useState(!1),[Ke,kt]=d.useState(null);d.useRef(null);const wt=d.useRef(null),$t=localStorage.getItem("token"),At=async()=>{try{h(!0),w(null);const p=rt("assembly-d"),N=(()=>{try{const Je=localStorage.getItem("user");if(!Je)return"";const se=JSON.parse(Je),Ie=typeof se.role=="object"?se.role?.name:se.role;return String(Ie||"").toLowerCase()}catch{return""}})().includes("admin"),P={menu_name:p},R=await ht.post(`${qt}/order-list`,P,{headers:{Authorization:`Bearer ${$t}`}}),L=R?.data?.Resp_code==="true"||R?.data?.Resp_code===!0||R?.data?.Resp_code==="RCS"||R?.status===200,Ne=Array.isArray(R?.data?.data)?R.data.data:Array.isArray(R?.data?.orders)?R.data.orders:Array.isArray(R?.data)?R.data:[];if(L&&Array.isArray(Ne)){const Je=Ne.map((se,Ie)=>({id:String(se.id),assemblyLine:se.assembly_no||"",gmsoaNo:se.soa_no||"",soaSrNo:se.soa_sr_no||"",assemblyDate:se.assembly_date||"",uniqueCode:se.unique_code||se.order_no||"",splittedCode:se.splitted_code||"",split_id:se.split_id||se.splitted_code||"",party:se.party_name||se.party||"",customerPoNo:se.customer_po_no||"",codeNo:se.code_no||"",product:se.product||"",qty:Number(se.qty||0),totalQty:Number(se.totalQty||se.total_qty||se.qty||0),qtyExe:Number(se.qty_executed||0),qtyPending:Number(se.qty_pending||0),finishedValve:se.finished_valve||"",gmLogo:se.gm_logo||"",namePlate:se.name_plate||"",specialNotes:se.special_notes||se.special_note||"",productSpcl1:se.product_spc1||"",productSpcl2:se.product_spc2||"",productSpcl3:se.product_spc3||"",inspection:se.inspection||"",painting:se.painting||"",remarks:se.remarks||"",alertStatus:se.is_urgent===!0||se.is_urgent==="true"||se.alert_status===!0||se.alert_status==="true"||se.urgent===1||se.urgent==="1",originalIndex:Ie}));console.log(" Orders fetched:",Je.length,"records"),l(Fe(Je)),u(null),w(null),kt(null)}else console.warn(" No valid order data received",R.data),l([]),w(R?.data?.Resp_desc||"Failed to fetch orders")}catch(g){console.error("Error fetching orders:",g),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Vt=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{Vt||At()},[j,k,Vt]);const Ot=d.useMemo(()=>Array.from(new Set(a.map(g=>g.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(g=>g.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(g=>g.party))).filter(Boolean).sort(),[a]);const yt=g=>{const p=parseInt(g,10);return isNaN(p)?0:p},Ge=d.useMemo(()=>{let g=a.slice();if(q&&(g=g.filter(p=>n(String(p.id))||p.alertStatus)),re&&(g=g.filter(p=>typeof p.remarks=="string"&&p.remarks.trim().length>0)),W!=="all"){const p=W.startsWith("assembly-")?W.split("-")[1].toUpperCase():W.toUpperCase();g=g.filter(y=>{const N=String(y.assemblyLine||"").toUpperCase();return N===p||N.includes(p)})}if(X!=="all"&&(g=g.filter(p=>p.gmsoaNo===X)),ue!=="all"&&(g=g.filter(p=>p.party===ue)),(Y||Q)&&(g=g.filter(p=>{if(!p.assemblyDate||p.assemblyDate==="HOLD")return!1;const N=p.assemblyDate.split(/[\/-]/).map(R=>R.trim()).map(R=>Number(R));if(N.some(R=>isNaN(R)))return!1;let P=null;if(N.length>=3){const[R,L,Ne]=N;P=new Date(Ne,L-1,R)}else if(N.length===2){const[R,L]=N;P=new Date(L,R-1,1)}else if(N.length===1){const[R]=N;P=new Date(R,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(ke==="year"&&Y)return P.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return P.getFullYear()===Y.getFullYear()&&P.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return P>=Y&&P<=Q;if(Y)return P>=Y;if(Q)return P<=Q}return!0})),F.trim()){const p=F.toLowerCase();g=g.filter(y=>String(y.uniqueCode).toLowerCase().includes(p)||String(y.party).toLowerCase().includes(p)||String(y.gmsoaNo).toLowerCase().includes(p)||String(y.customerPoNo).toLowerCase().includes(p)||String(y.codeNo).toLowerCase().includes(p)||String(y.product).toLowerCase().includes(p))}return _&&(g=[...g].sort((p,y)=>{const N=yt(p.soaSrNo),P=yt(y.soaSrNo);return _==="asc"?N-P:P-N})),g},[a,F,q,re,W,X,ue,ke,Y,Q,n,_]),St=d.useMemo(()=>{const g=(j-1)*k;return Ge.slice(g,g+k)},[Ge,j,k]),Ct=(g="",p=4)=>{const y=g.trim().split(/\s+/);return y.length<=p?g:y.slice(0,p).join(" ")+"..."};d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const Zt=g=>{U(p=>{const y=new Set(p);return y.has(g)?y.delete(g):y.add(g),y})},_t=()=>{U(g=>{if(g.size===Ge.length)return new Set;const p=Ge.map(y=>y.splittedCode||y.split_id||y.uniqueCode||y.id);return new Set(p)})},Ut=Ge.length>0&&ne.size===Ge.length,Kt="assembly-d",Bt=Ns(Kt),Xt=(ae?.assemblyLine||"").toUpperCase().includes("D"),as=Bt.filter(g=>g==="testing1"||g==="testing2"?Xt?g==="testing2":g==="testing1":!0);console.log("Next step(s):",Bt.map(rt)),console.log("Is final step?",fn(Kt));const ds=g=>{const y=Ns("assembly-d");ye(g),z(!0);const N=(g.assemblyLine||"").toUpperCase().includes("D"),P=y.filter(R=>R==="testing1"||R==="testing2"?N?R==="testing2":R==="testing1":!0);Ee(P[0]||y[0]||""),De(String(g.qtyPending??g.qty??0)),ge(null),T(!1),et(!1),ot(""),qe(""),mt({})},ls=()=>{const g={},p=Number(ae?.qtyPending??0),y=Number(Le||0),N=Number(Qt||0);if(fe||(g.quickAssignStep="Please select a workflow step."),(!Le||y<=0)&&(g.quickAssignQty="Quantity must be greater than 0."),y>p&&(g.quickAssignQty=`Cannot exceed available (${p})`),Ve){Nt||(g.splitAssignStep="Choose split step."),(!Qt||N<=0)&&(g.splitAssignQty="Split quantity is required."),fe===Nt&&(g.sameEngineer="Split step cannot be the same as main step.");const P=y+N;P!==p&&(g.totalQtyMismatch=`Total quantity (${P}) must equal available (${p}).`)}return mt(g),Object.keys(g).length===0},us=()=>{z(!1)},V=a.filter(g=>ne.has(g.splittedCode||g.split_id||g.uniqueCode||g.id)),ie=()=>Et(!0),K=()=>{const p=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${V.map(P=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${P.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(P.gmsoaNo).replace(/^SOA/i,"")}-${P.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${P.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${P.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${P.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${P.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${P.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> </div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,y=document.createElement("iframe");y.style.position="fixed",y.style.right="0",y.style.bottom="0",y.style.width="0",y.style.height="0",y.style.border="0",document.body.appendChild(y);const N=y.contentDocument||y.contentWindow?.document;N&&(N.open(),N.write(p),N.close(),setTimeout(()=>{y.contentWindow?.focus(),y.contentWindow?.print(),setTimeout(()=>document.body.removeChild(y),500)},300))},ee=g=>{lt(g),xe(!0)},de=g=>g.splittedCode||g.split_id?g.splittedCode||g.split_id:[g.uniqueCode,g.soaSrNo,g.gmsoaNo,g.codeNo,g.assemblyLine].map(p=>p??"").join("|"),le=d.useMemo(()=>{const g=Ge.filter(p=>ne.has(de(p)));return{count:g.length,qty:g.reduce((p,y)=>p+(y.totalQty||y.qty||0),0),qtyExe:g.reduce((p,y)=>p+(y.qtyExe||0),0),qtyPending:g.reduce((p,y)=>p+(y.qtyPending||0),0)}},[ne,Ge]),Pe=()=>{const g=q===!0,p=re===!0,y=ne.size>0;if(!g&&!p&&!y)return;const N=y?Ge.filter(P=>ne.has(de(P))):Ge;if(!N.length){alert("No data available to export");return}Te(N)},Be=()=>{const g=c&&c.length>0?c:a;if(!g||g.length===0){alert("No data available to export");return}Te(g)},Te=g=>{const p=g.map((R,L)=>({No:L+1,"Assembly Line":R.assemblyLine,"GMSOA No":R.gmsoaNo,"SOA Sr No":R.soaSrNo,"Assembly Date":R.assemblyDate,"Unique Code":R.uniqueCode,"Splitted Code":R.splittedCode||"-",Party:R.party,"Customer PO No":R.customerPoNo,"Code No":R.codeNo,Product:R.product,"PO Qty":R.poQty,Qty:R.qty,"Qty Executed":R.qtyExe,"Qty Pending":R.qtyPending,"Finished Valve":R.finishedValve,"GM Logo":R.gmLogo,"Name Plate":R.namePlate,"Special Notes":R.specialNotes||"","Product Special 1":R.productSpcl1,"Product Special 2":R.productSpcl2,"Product Special 3":R.productSpcl3,Inspection:R.inspection,Painting:R.painting,Remarks:R.remarks||""})),y=Ht.json_to_sheet(p),N=Ht.book_new();Ht.book_append_sheet(N,y,"Orders");const P=Zs(N,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([P],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},je=g=>{gt(g),ct(g.remarks||""),He(!0)},Ce=async()=>{if(!zt)return;const g=new FormData;g.append("orderId",String(zt.id)),g.append("remarks",jt);try{const p=await ht.post(`${qt}/add-remarks`,g,{headers:{Authorization:`Bearer ${$t}`}});if(console.log("Add Remarks Response:",p.data),p.data?.Resp_code==="true"||p.data?.Resp_code===!0){l(N=>N.map(P=>P.id===zt.id?{...P,remarks:jt}:P));try{t(zt.id,jt)}catch{}He(!1),gt(null),ct("")}else console.warn("Backend rejected remarks:",p.data)}catch(p){console.error("Error saving remarks:",p)}},Fe=g=>[...g].sort((p,y)=>(p.originalIndex??0)-(y.originalIndex??0)),[We,ge]=d.useState(null),[G,T]=d.useState(!1),x=async()=>{if(!G&&ae&&ls()){T(!0),ge({type:"info",message:"Assigning order, please wait..."});try{const g=localStorage.getItem("token");if(!g){ge({type:"error",message:"Token missing. Please log in again."});return}const y=rt("assembly-d"),N=Number(Le||0),P=Number(Qt||0),R=fe||(Array.isArray(Bt)?Bt[0]:""),L=rt(R),Ne=new FormData;Ne.append("orderId",String(ae.id)),Ne.append("totalQty",String(ae.totalQty??ae.qty??0)),Ne.append("executedQty",String(N)),Ne.append("currentSteps",y),Ne.append("nextSteps",L),Ne.append("split_id",String(ae.split_id||""));const Je=await ht.post(`${qt}/assign-order`,Ne,{headers:{Authorization:`Bearer ${g}`}});if(!(Je?.data?.Resp_code==="true"||Je?.data?.Resp_code===!0)){ge({type:"error",message:Je?.data?.Resp_desc||"Main assignment failed."});return}let Ie=`Assigned ${N}  ${L}`;if(Ve&&P>0){const $e=new FormData;$e.append("orderId",String(ae.id)),$e.append("totalQty",String(ae.totalQty??ae.qty??0)),$e.append("executedQty",String(P)),$e.append("currentSteps",y),$e.append("nextSteps",L),$e.append("split_id",String(ae.split_id||"")),$e.append("splitOrder","true");const te=await ht.post(`${qt}/assign-order`,$e,{headers:{Authorization:`Bearer ${g}`}});te?.data?.Resp_code==="true"||te?.data?.Resp_code===!0?Ie+=`
 Split ${P}  ${L}`:ge({type:"error",message:"Main assigned but split failed: "+(te?.data?.Resp_desc||"Unknown error")})}l($e=>$e.map(te=>{if(te.id!==ae.id)return te;const Se=Number(te.qtyExe||0),at=N+(Ve?P:0),ut=Number(te.totalQty??te.qty??0);return{...te,qtyExe:Se+at,qtyPending:ut-(Se+at)}})),await At(),ge({type:"success",message:` ${Ie}`}),setTimeout(()=>{z(!1),ge(null)},1e3)}catch(g){console.error(" Error assigning order:",g),ge({type:"error",message:"Server error while assigning."})}finally{T(!1)}}},A=()=>{he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"assembly-d",currentPage:"Assembly-D",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:g=>{const p=g.toLowerCase().replace(/\s+/g,"-");window.location.href=`/${p}`},onUploadSuccess:()=>At()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsxs("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold flex gap-3",children:["Assembly D",e.jsx(J,{onClick:()=>pe("/testing-assembly-2",{state:{source:"assembly-d"}}),variant:"outline",className:"flex items-center gap-2",children:"Testing-2"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(J,{onClick:ie,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:Pe,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:Be,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"assembly-d",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:Ot,onClearFilters:A,hasActiveFilters:X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:wt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ut),onClick:_t,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ut?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(g=>g==="asc"?"desc":g==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:St.map(g=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:ne.has(g.splittedCode||g.split_id||g.uniqueCode||g.id),onCheckedChange:()=>Zt(g.splittedCode||g.split_id||g.uniqueCode||g.id),"aria-label":`Select row ${g.splittedCode||g.split_id||g.uniqueCode||g.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:g.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:g.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:g.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:g.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:g.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:g.party,children:Ct(g.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:g.product,children:g.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:g.specialNotes,children:g.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:g.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:g.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${g.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>je(g),children:e.jsx(lr,{className:`h-4 w-4 ${g.remarks?.trim()?"text-white":"text-blue-600"}`})}),g.remarks?.trim()&&e.jsx("div",{className:`\r
                                                                                                   absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                                                                   hidden group-hover:block\r
                                                                                                   bg-gray-900 text-white text-xs\r
                                                                                                   px-3 py-2 rounded-md shadow-lg\r
                                                                                                   max-w-[260px] break-words z-[999]\r
                                                                                                 `,children:g.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>ee(g),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ds(g),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${g.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${g.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},g.splittedCode||g.split_id||g.uniqueCode||g.id))})]}),Ge.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),le.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:le.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:le.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:le.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:le.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:Ge.length,lastPage:Math.max(1,Math.ceil(Ge.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:ce,onOpenChange:z,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",ae?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:fe,onValueChange:Ee,disabled:!0,children:[e.jsx(nr,{id:"assignStep",children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:as.map(g=>e.jsx(Es,{value:g,children:rt(g)},g))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Le,onChange:g=>{const p=g.target.value;De(p);const y=Number(ae?.qtyPending??0),N=Number(p||0);mt(P=>{const R={...P};return N>y?R.quickAssignQty=`Cannot exceed available (${y})`:R.quickAssignQty&&delete R.quickAssignQty,R})},max:ae?.qtyPending}),Me.quickAssignQty&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:Me.quickAssignQty})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:ae?.qtyPending})]})]})}),We&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${We.type==="success"?"bg-green-50 text-green-700 border border-green-200":We.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:We.message.split(`
`).map((g,p)=>e.jsx("div",{children:g},p))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:us,disabled:G,children:"Cancel"}),e.jsx(J,{onClick:x,disabled:G||!!Me.quickAssignQty,className:"bg-black hover:bg-gray-800 text-white",children:G?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:it,onOpenChange:Et,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:V.map(g=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",g.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(g.gmsoaNo).replace(/^SOA/i,""),"-",g.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",g.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:g.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:g.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",g.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",g.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:g.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},g.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>Et(!1),children:"Cancel"}),e.jsxs(J,{onClick:K,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:pt,onOpenChange:xe,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",tt?.uniqueCode]})]}),tt&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>xe(!1),children:"Close"})})]})}),e.jsx(Rt,{open:Ue,onOpenChange:He,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:zt?`Order: ${zt.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:jt,onChange:g=>ct(g.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>He(!1),children:"Cancel"}),e.jsx(J,{onClick:Ce,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function uf(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),[pe,ne]=d.useState(new Set),[U,ce]=d.useState(!1),[z,ae]=d.useState(null),[ye,fe]=d.useState(""),[Ee,Le]=d.useState(""),[De,Ve]=d.useState(!1),[et,Nt]=d.useState(""),[ot,Qt]=d.useState(""),[qe,Me]=d.useState({}),[mt,it]=d.useState(!1),[Et,pt]=d.useState(!1),[xe,tt]=d.useState(null),[lt,Ue]=d.useState(!1),[He,zt]=d.useState(null),[gt,jt]=d.useState(""),[ct,Yt]=d.useState(null),[Z,Ze]=d.useState(!1),[nt,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),wt=localStorage.getItem("token"),$t=async()=>{try{h(!0),w(null);const A=rt("testing1"),p=(()=>{try{const R=localStorage.getItem("user");if(!R)return"";const L=JSON.parse(R),Ne=typeof L.role=="object"?L.role?.name:L.role;return String(Ne||"").toLowerCase()}catch{return""}})().includes("admin"),y={menu_name:A},N=await ht.post(`${qt}/order-list`,y,{headers:{Authorization:`Bearer ${wt}`}});if((N?.data?.Resp_code==="true"||N?.data?.Resp_code===!0||N?.data?.Resp_code==="RCS")&&Array.isArray(N.data.data)){const R=N.data.data.map(L=>({id:String(L.id),assemblyLine:L.assembly_no||"",gmsoaNo:L.soa_no||"",soaSrNo:L.soa_sr_no||"",assemblyDate:L.assembly_date||"",uniqueCode:L.unique_code||L.order_no||"",splittedCode:L.splitted_code||"",party:L.party_name||L.party||"",customerPoNo:L.customer_po_no||"",codeNo:L.code_no||"",product:L.product||"",qty:Number(L.qty||0),totalQty:Number(L.totalQty||L.total_qty||L.qty||0),qtyExe:Number(L.qty_executed||0),qtyPending:Number(L.qty_pending||0),finishedValve:L.finished_valve||"",gmLogo:L.gm_logo||"",namePlate:L.name_plate||"",specialNotes:L.special_notes||L.special_note||"",productSpcl1:L.product_spc1||"",productSpcl2:L.product_spc2||"",productSpcl3:L.product_spc3||"",inspection:L.inspection||"",painting:L.painting||"",remarks:L.remarks||"",alertStatus:L.is_urgent===!0||L.is_urgent==="true"||L.alert_status===!0||L.alert_status==="true"||L.urgent===1||L.urgent==="1"}));console.log(" Orders fetched:",R.length,"records"),l(je(R)),u(null),w(null),Ke(null)}else console.warn(" No valid order data received",N.data),l([]),w(N?.data?.Resp_desc||"Failed to fetch orders")}catch(x){console.error("Error fetching orders:",x),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},At=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{At||$t()},[j,k,At]);const Vt=d.useMemo(()=>Array.from(new Set(a.map(x=>x.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(x=>x.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(x=>x.party))).filter(Boolean).sort(),[a]);const Ot=x=>{const A=parseInt(x,10);return isNaN(A)?0:A},yt=d.useMemo(()=>{let x=a.slice();if(q&&(x=x.filter(A=>n(String(A.id))||A.alertStatus)),re&&(x=x.filter(A=>typeof A.remarks=="string"&&A.remarks.trim().length>0)),W!=="all"&&(x=x.filter(A=>A.assemblyLine===W)),X!=="all"&&(x=x.filter(A=>A.gmsoaNo===X)),ue!=="all"&&(x=x.filter(A=>A.party===ue)),(Y||Q)&&(x=x.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const p=A.assemblyDate.split(/[\/-]/).map(N=>N.trim()).map(N=>Number(N));if(p.some(N=>isNaN(N)))return!1;let y=null;if(p.length>=3){const[N,P,R]=p;y=new Date(R,P-1,N)}else if(p.length===2){const[N,P]=p;y=new Date(P,N-1,1)}else if(p.length===1){const[N]=p;y=new Date(N,0,1)}else return!1;if(!y||isNaN(y.getTime()))return!1;if(ke==="year"&&Y)return y.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return y.getFullYear()===Y.getFullYear()&&y.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return y>=Y&&y<=Q;if(Y)return y>=Y;if(Q)return y<=Q}return!0})),F.trim()){const A=F.toLowerCase();x=x.filter(g=>String(g.uniqueCode).toLowerCase().includes(A)||String(g.party).toLowerCase().includes(A)||String(g.gmsoaNo).toLowerCase().includes(A)||String(g.customerPoNo).toLowerCase().includes(A)||String(g.codeNo).toLowerCase().includes(A)||String(g.product).toLowerCase().includes(A))}return _&&(x=[...x].sort((A,g)=>{const p=Ot(A.soaSrNo),y=Ot(g.soaSrNo);return _==="asc"?p-y:y-p})),x},[a,F,q,re,W,X,ue,ke,Y,Q,n,_]),Ge=d.useMemo(()=>{const x=(j-1)*k;return yt.slice(x,x+k)},[yt,j,k]);d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const St=(x="",A=4)=>{const g=x.trim().split(/\s+/);return g.length<=A?x:g.slice(0,A).join(" ")+"..."},Ct=x=>{ne(A=>{const g=new Set(A);return g.has(x)?g.delete(x):g.add(x),g})},Zt=()=>{ne(x=>x.size===yt.length?new Set:new Set(yt.map(Bt)))},_t=yt.length>0&&pe.size===yt.length,Ut=x=>{const A=x.assemblyLine?.toLowerCase();return A==="c"||A==="assembly c"||A==="assembly-c"?["svs","marking1"]:Ns("testing1")},Kt=d.useMemo(()=>z?Ut(z):[],[z]),Bt=x=>x.splittedCode||x.split_id||x.uniqueCode||x.id,Xt=x=>{const A=Ut(x);ae(x),ce(!0),fe(A[0]||""),Le(String(x.qtyPending??x.qty??0)),Ve(!1),Nt(""),Qt(""),Me({})},as=()=>{const x={},A=Number(z?.qtyPending??0),g=Number(Ee||0),p=Number(ot||0);if(ye||(x.quickAssignStep="Please select a workflow step."),(!Ee||g<=0)&&(x.quickAssignQty="Quantity must be greater than 0."),g>A&&(x.quickAssignQty=`Cannot exceed available (${A})`),De){et||(x.splitAssignStep="Choose split step."),(!ot||p<=0)&&(x.splitAssignQty="Split quantity is required."),ye===et&&(x.sameEngineer="Split step cannot be the same as main step.");const y=g+p;y!==A&&(x.totalQtyMismatch=`Total quantity (${y}) must equal available (${A}).`)}return Me(x),Object.keys(x).length===0},ds=()=>{ge(!1),Fe(null),ce(!1),ae(null),fe(""),Le(""),Ve(!1),Nt(""),Qt(""),Me({})},ls=a.filter(x=>pe.has(x.splittedCode||x.split_id||x.uniqueCode||x.id)),us=()=>it(!0),V=()=>{const A=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ls.map(y=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${y.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(y.gmsoaNo).replace(/^SOA/i,"")}-${y.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${y.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${y.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${y.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${y.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${y.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${y.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,g=document.createElement("iframe");g.style.position="fixed",g.style.right="0",g.style.bottom="0",g.style.width="0",g.style.height="0",g.style.border="0",document.body.appendChild(g);const p=g.contentDocument||g.contentWindow?.document;p&&(p.open(),p.write(A),p.close(),setTimeout(()=>{g.contentWindow?.focus(),g.contentWindow?.print(),setTimeout(()=>document.body.removeChild(g),500)},300))},ie=x=>{tt(x),pt(!0)},K=x=>x.splittedCode||x.split_id?x.splittedCode||x.split_id:[x.uniqueCode,x.soaSrNo,x.gmsoaNo,x.codeNo,x.assemblyLine].map(A=>A??"").join("|"),ee=d.useMemo(()=>{const x=yt.filter(A=>pe.has(K(A)));return{count:x.length,qty:x.reduce((A,g)=>A+(g.totalQty||g.qty||0),0),qtyExe:x.reduce((A,g)=>A+(g.qtyExe||0),0),qtyPending:x.reduce((A,g)=>A+(g.qtyPending||0),0)}},[pe,yt]),de=()=>{const x=q===!0,A=re===!0,g=pe.size>0;if(!x&&!A&&!g)return;const p=g?yt.filter(y=>pe.has(K(y))):yt;if(!p.length){alert("No data available to export");return}Pe(p)},le=()=>{const x=c&&c.length>0?c:a;if(!x||x.length===0){alert("No data available to export");return}Pe(x)},Pe=x=>{const A=x.map((N,P)=>({No:P+1,"Assembly Line":N.assemblyLine,"GMSOA No":N.gmsoaNo,"SOA Sr No":N.soaSrNo,"Assembly Date":N.assemblyDate,"Unique Code":N.uniqueCode,"Splitted Code":N.splittedCode||"-",Party:N.party,"Customer PO No":N.customerPoNo,"Code No":N.codeNo,Product:N.product,"PO Qty":N.poQty,Qty:N.qty,"Qty Executed":N.qtyExe,"Qty Pending":N.qtyPending,"Finished Valve":N.finishedValve,"GM Logo":N.gmLogo,"Name Plate":N.namePlate,"Special Notes":N.specialNotes||"","Product Special 1":N.productSpcl1,"Product Special 2":N.productSpcl2,"Product Special 3":N.productSpcl3,Inspection:N.inspection,Painting:N.painting,Remarks:N.remarks||""})),g=Ht.json_to_sheet(A),p=Ht.book_new();Ht.book_append_sheet(p,g,"Orders");const y=Zs(p,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([y],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Be=x=>{zt(x),jt(x.remarks||""),Ue(!0)},Te=async()=>{if(!He)return;const x=new FormData;x.append("orderId",String(He.id)),x.append("remarks",gt);try{const A=await ht.post(`${qt}/add-remarks`,x,{headers:{Authorization:`Bearer ${wt}`}});if(console.log("Add Remarks Response:",A.data),A.data?.Resp_code==="true"||A.data?.Resp_code===!0){l(p=>p.map(y=>y.id===He.id?{...y,remarks:gt}:y));try{t(He.id,gt)}catch{}Ue(!1),zt(null),jt("")}else console.warn("Backend rejected remarks:",A.data)}catch(A){console.error("Error saving remarks:",A)}},je=x=>[...x].sort((A,g)=>{const p=A.alertStatus?1:0,y=g.alertStatus?1:0;return p!==y?y-p:(A.originalIndex??0)-(g.originalIndex??0)}),[Ce,Fe]=d.useState(null),[We,ge]=d.useState(!1),G=async()=>{if(!We&&z&&as()){ge(!0),Fe({type:"info",message:"Assigning order, please wait..."});try{const x=localStorage.getItem("token");if(!x){Fe({type:"error",message:"Token missing. Please log in again."});return}const A="testing1",g=rt(A),p=Number(Ee||0),y=Number(ot||0),N=Ns(A)[0]||"",R=rt(ye||N),L=new FormData;L.append("orderId",String(z.id)),L.append("totalQty",String(z.totalQty??z.qty??0)),L.append("executedQty",String(p)),L.append("currentSteps",g),L.append("nextSteps",R),L.append("split_id",String(z.split_id||"")),console.log(" MAIN PAYLOAD:",Object.fromEntries(L.entries()));const Ne=await ht.post(`${qt}/assign-order`,L,{headers:{Authorization:`Bearer ${x}`}});if(!(Ne.data?.Resp_code===!0||Ne.data?.Resp_code==="true"||Ne.data?.status===!0)){Fe({type:"error",message:Ne.data?.Resp_desc||"Main assignment failed."});return}let se=` Assigned ${p}  ${R}`;if(De&&y>0){const te=new FormData;te.append("orderId",String(z.id)),te.append("totalQty",String(z.totalQty??z.qty??0)),te.append("executedQty",String(y)),te.append("currentSteps",g),te.append("nextSteps",R),te.append("split_id",String(z.split_id||"")),console.log(" SPLIT PAYLOAD:",Object.fromEntries(te.entries()));const Se=await ht.post(`${qt}/assign-order`,te,{headers:{Authorization:`Bearer ${x}`}});Se.data?.Resp_code===!0||Se.data?.Resp_code==="true"||Se.data?.status===!0?se+=`
 Split ${y}  ${R}`:Fe({type:"error",message:"Main assigned but split failed: "+(Se.data?.Resp_desc||"Unknown error")})}Fe({type:"success",message:se});const Ie=te=>te.splittedCode||te.split_id?te.splittedCode||te.split_id:[te.uniqueCode,te.soaSrNo,te.gmsoaNo,te.codeNo,te.assemblyLine].map(Se=>Se??"").join("|"),$e=Ie(z);l(te=>te.filter(Se=>Ie(Se)!==$e)),ne(te=>{const Se=new Set(te);return Se.delete($e),Se}),setTimeout(()=>{ce(!1),Fe(null)},1e3)}catch(x){console.error(" Error assigning order:",x),Fe({type:"error",message:x?.response?.data?.Resp_desc||x?.response?.data?.message||"Server error while assigning."})}finally{ge(!1)}}},T=()=>{oe("all"),he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:x=>{window.location.href=`/${x.toLowerCase()}`},onUploadSuccess:()=>$t()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Testing 1"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(J,{onClick:us,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:de,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:le,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:Vt,onClearFilters:T,hasActiveFilters:W!=="all"||X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(_t),onClick:Zt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${_t?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(x=>x==="asc"?"desc":x==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Ge.map(x=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:pe.has(Bt(x)),onCheckedChange:()=>Ct(Bt(x))})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:x.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:x.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:x.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:x.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:x.party,children:St(x.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:x.product,children:x.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:x.specialNotes,children:x.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:x.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:x.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${x.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Be(x),children:e.jsx(lr,{className:`h-4 w-4 ${x.remarks?.trim()?"text-white":"text-blue-600"}`})}),x.remarks?.trim()&&e.jsx("div",{className:`\r
                                  absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                  hidden group-hover:block\r
                                  bg-gray-900 text-white text-xs\r
                                  px-3 py-2 rounded-md shadow-lg\r
                                  max-w-[260px] break-words z-[999]\r
                                `,children:x.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>ie(x),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Xt(x),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${x.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${x.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},x.splittedCode||x.split_id||x.uniqueCode||x.id))})]}),yt.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),ee.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:ee.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:ee.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:ee.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:ee.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:yt.length,lastPage:Math.max(1,Math.ceil(yt.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:U,onOpenChange:ce,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:ye,onValueChange:fe,children:[e.jsx(nr,{id:"assignStep",children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:Kt.map(x=>e.jsx(Es,{value:x,children:rt(x)},x))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Ee,onChange:x=>Le(x.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),Ce&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Ce.type==="success"?"bg-green-50 text-green-700 border border-green-200":Ce.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Ce.message.split(`
`).map((x,A)=>e.jsx("div",{children:x},A))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:ds,disabled:We,children:"Cancel"}),e.jsx(J,{onClick:G,disabled:We,className:"bg-black hover:bg-gray-800 text-white",children:We?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:mt,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ls.map(x=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",x.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(x.gmsoaNo).replace(/^SOA/i,""),"-",x.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",x.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:x.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:x.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",x.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",x.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:x.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},x.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(J,{onClick:V,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:Et,onOpenChange:pt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>pt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:lt,onOpenChange:Ue,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:gt,onChange:x=>jt(x.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>Ue(!1),children:"Cancel"}),e.jsx(J,{onClick:Te,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function mf(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),[pe,ne]=d.useState(new Set),[U,ce]=d.useState(!1),[z,ae]=d.useState(null),[ye,fe]=d.useState(""),[Ee,Le]=d.useState(""),[De,Ve]=d.useState(!1),[et,Nt]=d.useState(""),[ot,Qt]=d.useState(""),[qe,Me]=d.useState({}),[mt,it]=d.useState(!1),[Et,pt]=d.useState(!1),[xe,tt]=d.useState(null),[lt,Ue]=d.useState(!1),[He,zt]=d.useState(null),[gt,jt]=d.useState(""),[ct,Yt]=d.useState(null),[Z,Ze]=d.useState(!1),[nt,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),wt=localStorage.getItem("token"),$t=async()=>{try{h(!0),w(null);const x=rt("testing2"),g=(()=>{try{const P=localStorage.getItem("user");if(!P)return"";const R=JSON.parse(P),L=typeof R.role=="object"?R.role?.name:R.role;return String(L||"").toLowerCase()}catch{return""}})().includes("admin"),p={menu_name:x},y=await ht.post(`${qt}/order-list`,p,{headers:{Authorization:`Bearer ${wt}`}});if((y?.data?.Resp_code==="true"||y?.data?.Resp_code===!0||y?.data?.Resp_code==="RCS")&&Array.isArray(y.data.data)){const P=y.data.data.map(R=>({id:String(R.id),assemblyLine:R.assembly_no||"",gmsoaNo:R.soa_no||"",soaSrNo:R.soa_sr_no||"",assemblyDate:R.assembly_date||"",uniqueCode:R.unique_code||R.order_no||"",splittedCode:R.splitted_code||"",split_id:R.split_id||R.splitted_code||"",party:R.party_name||R.party||"",customerPoNo:R.customer_po_no||"",codeNo:R.code_no||"",product:R.product||"",qty:Number(R.qty||0),totalQty:Number(R.totalQty||R.total_qty||R.qty||0),qtyExe:Number(R.qty_executed||0),qtyPending:Number(R.qty_pending||0),finishedValve:R.finished_valve||"",gmLogo:R.gm_logo||"",namePlate:R.name_plate||"",specialNotes:R.special_notes||R.special_note||"",productSpcl1:R.product_spc1||"",productSpcl2:R.product_spc2||"",productSpcl3:R.product_spc3||"",inspection:R.inspection||"",painting:R.painting||"",remarks:R.remarks||"",alertStatus:R.is_urgent===!0||R.is_urgent==="true"||R.alert_status===!0||R.alert_status==="true"||R.urgent===1||R.urgent==="1"}));console.log(" Orders fetched:",P.length,"records"),l(Te(P)),u(null),w(null),Ke(null)}else console.warn(" No valid order data received",y.data),l([]),w(y?.data?.Resp_desc||"Failed to fetch orders")}catch(T){console.error("Error fetching orders:",T),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},At=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{At||$t()},[j,k,At]);const Vt=d.useMemo(()=>Array.from(new Set(a.map(T=>T.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(T=>T.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(T=>T.party))).filter(Boolean).sort(),[a]);const Ot=d.useMemo(()=>{let T=a.slice();if(q&&(T=T.filter(g=>n(String(g.id))||g.alertStatus)),re&&(T=T.filter(g=>typeof g.remarks=="string"&&g.remarks.trim().length>0)),W!=="all"&&(T=T.filter(g=>g.assemblyLine===W)),X!=="all"&&(T=T.filter(g=>g.gmsoaNo===X)),ue!=="all"&&(T=T.filter(g=>g.party===ue)),(Y||Q)&&(T=T.filter(g=>{if(!g.assemblyDate||g.assemblyDate==="HOLD")return!1;const y=g.assemblyDate.split(/[\/-]/).map(P=>P.trim()).map(P=>Number(P));if(y.some(P=>isNaN(P)))return!1;let N=null;if(y.length>=3){const[P,R,L]=y;N=new Date(L,R-1,P)}else if(y.length===2){const[P,R]=y;N=new Date(R,P-1,1)}else if(y.length===1){const[P]=y;N=new Date(P,0,1)}else return!1;if(!N||isNaN(N.getTime()))return!1;if(ke==="year"&&Y)return N.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return N.getFullYear()===Y.getFullYear()&&N.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return N>=Y&&N<=Q;if(Y)return N>=Y;if(Q)return N<=Q}return!0})),F.trim()){const g=F.toLowerCase();T=T.filter(p=>String(p.uniqueCode).toLowerCase().includes(g)||String(p.party).toLowerCase().includes(g)||String(p.gmsoaNo).toLowerCase().includes(g)||String(p.customerPoNo).toLowerCase().includes(g)||String(p.codeNo).toLowerCase().includes(g)||String(p.product).toLowerCase().includes(g))}const x=new Set,A=g=>g.splittedCode||g.split_id||g.uniqueCode||g.id;return T=T.filter(g=>{const p=A(g);return x.has(p)?!1:(x.add(p),!0)}),_&&(T=[...T].sort((g,p)=>{const y=parseSoaSrNo(g.soaSrNo),N=parseSoaSrNo(p.soaSrNo);return _==="asc"?y-N:N-y})),T},[a,F,q,re,W,X,ue,ke,Y,Q,n,_]),yt=d.useMemo(()=>{const T=(j-1)*k;return Ot.slice(T,T+k)},[Ot,j,k]);d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const Ge=(T="",x=4)=>{const A=T.trim().split(/\s+/);return A.length<=x?T:A.slice(0,x).join(" ")+"..."},St=T=>{ne(x=>{const A=new Set(x);return A.has(T)?A.delete(T):A.add(T),A})},Ct=T=>T.splittedCode||T.split_id||T.uniqueCode||T.id,Zt=()=>{ne(T=>T.size===Ot.length?new Set:new Set(Ot.map(Ct)))},_t=Ot.length>0&&pe.size===Ot.length,Ut="testing2",Kt=Ns(Ut);console.log("Next step(s):",Kt.map(rt)),console.log("Is final step?",fn(Ut));const Bt=T=>{const A=Ns("testing2");ae(T),ce(!0),fe(A[0]||""),Le(String(T.qtyPending??T.qty??0)),Ve(!1),Nt(""),Qt(""),Me({})},Xt=()=>{const T={},x=Number(z?.qtyPending??0),A=Number(Ee||0),g=Number(ot||0);if(ye||(T.quickAssignStep="Please select a workflow step."),(!Ee||A<=0)&&(T.quickAssignQty="Quantity must be greater than 0."),A>x&&(T.quickAssignQty=`Cannot exceed available (${x})`),De){et||(T.splitAssignStep="Choose split step."),(!ot||g<=0)&&(T.splitAssignQty="Split quantity is required."),ye===et&&(T.sameEngineer="Split step cannot be the same as main step.");const p=A+g;p!==x&&(T.totalQtyMismatch=`Total quantity (${p}) must equal available (${x}).`)}return Me(T),Object.keys(T).length===0},as=()=>{We(!1),Ce(null),ce(!1),ae(null),fe(""),Le(""),Ve(!1),Nt(""),Qt(""),Me({})},ds=a.filter(T=>pe.has(T.splittedCode||T.split_id||T.uniqueCode||T.id)),ls=()=>it(!0),us=()=>{const x=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>

        <style>
          @page {
            size: 130mm 85mm;
            margin: 0;
          }

          html, body {
            width: 130mm;
            height: 85mm;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
          }

          .item-label,
          .party-desc {
          padding-bottom: 2mm;}

          .item-label {
          line-height: 1.8em;}

          .bin-card {
            width: 130mm;
            height: 85mm;
            padding: 6mm;
            box-sizing: border-box;
            page-break-after: always;
          }

        .item-label-description {
        padding-top: 50px;}

          .meta-qty {
          width: 50%;}

          .process-border {
          border-top:1px solid #000;
          border-bottom:1px solid #000;
          padding-top: 1.5mm;
          padding-bottom: 1.5mm;
          }

          .detail-logo {
            padding-bottom: 0.9mm;
          }

          .description {
            padding-bottom: 2mm;
          }

          .content {
            width: 100%;
            height: 100%;
            border: 1.5px solid #000;
            border-radius: 10px;
            padding-top: 2mm;
            padding-bottom: 4mm;
              padding-left: 6mm;
                  padding-right: 6mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
          }

          .meta-item {
            padding-top: 2mm;
          }

          /* RESET DEFAULT P TAG SPACE */
          p {
            margin: 0;
          }

          /* HEADER */
          .company-name {
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1mm;
            
          }

          .assembly-title p {
          border: 1px solid #000;
            display: inline-block;
            padding-top: 1mm;
            padding-bottom: 0.9mm;
            padding-left: 1mm;
            padding-right: 1mm;
          }

          .company-address {
            font-size: 8px;
            font-weight: 400;
            text-align: center;
            line-height: 1.2;
            margin: 0 0 1.2mm;
          }

          .tag-title {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1.5mm;
          }

          .doc-row {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            margin-bottom: 0.5mm; /*  reduced */
          }

          /* ASSEMBLY LINE */
          .title {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            margin-top: 0;       /*  no top gap */
            margin-bottom: 0.5mm;
            //  border: 1px solid #000;
            // display: inline-block;
          }

          .title-line {
            border-bottom: 1px solid #000;
            margin-bottom: 1.5mm;
            margin-top: 0.5mm;
          }

          /* META */
          .meta {
            font-size: 10px;
            line-height: 1.25;
            margin-bottom: 0.8mm;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }

          .meta div {
            margin-bottom: 0.5mm;
          }

          /* ITEM */
          .desc {
            font-size: 9px;
            margin-bottom: 0.8mm;
          }

          .desc p {
          padding-bottom: 0.6mm;}

          .desc span {
            display: block;
            padding-bottom: 0.1mm;
          }

          .desc .label {
            display: block;
            font-size: 10px;
            margin-bottom: 0.8mm;
            margin-top: 0.8mm;
          }

          .desc .text {
            word-break: break-word;
            
          }

          /* QTY */
          .qty-logo {
            font-size: 10px;
            line-height: 1.3;
            margin-bottom: 0.4mm;
            margin-top: 0.8mm;
          }

          /* INSPECTION */
          .inspect {
            margin-top: auto;
            font-size: 10px;
          }

          .inspect-line {
            height: 3mm;
            border-bottom: 1px solid #000;
          }

          .label {
            font-weight: 600;
          }
        </style>
      </head>

      <body>${ds.map(p=>`
        <div class="bin-card">
          <div class="content">

            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>

            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${p.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(p.gmsoaNo).replace(/^SOA/i,"")}-${p.soaSrNo}
                </div>

              </div>
                <div class="title assembly-title">
                  <p>Assembly Line: ${p.assemblyLine}</p>
                </div>
                <div class="meta-item">
                  <p>GMV-L4-F-PRD 01 A</p>
                  <p>(02/10.09.2020)</p>
                </div>
          </div>

            

            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${p.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${p.product}</p>
              </div>
            </div>

            <div class="qty-logo">
            <div class="meta meta-logo">
              <div class="meta-qty"><span class="label">QTY:</span> ${p.qty}</div>
              <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${p.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${p.specialNotes||""}</span></div>
              </div>

            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>

          </div>
        </div>`).join("")}</body>
    </html>`,A=document.createElement("iframe");A.style.position="fixed",A.style.right="0",A.style.bottom="0",A.style.width="0",A.style.height="0",A.style.border="0",document.body.appendChild(A);const g=A.contentDocument||A.contentWindow?.document;g&&(g.open(),g.write(x),g.close(),setTimeout(()=>{A.contentWindow?.focus(),A.contentWindow?.print(),setTimeout(()=>document.body.removeChild(A),500)},300))},V=T=>{tt(T),pt(!0)},ie=T=>T.splittedCode||T.split_id?T.splittedCode||T.split_id:[T.uniqueCode,T.soaSrNo,T.gmsoaNo,T.codeNo,T.assemblyLine].map(x=>x??"").join("|"),K=d.useMemo(()=>{const T=Ot.filter(x=>pe.has(ie(x)));return{count:T.length,qty:T.reduce((x,A)=>x+(A.totalQty||A.qty||0),0),qtyExe:T.reduce((x,A)=>x+(A.qtyExe||0),0),qtyPending:T.reduce((x,A)=>x+(A.qtyPending||0),0)}},[pe,Ot]),ee=()=>{const T=q===!0,x=re===!0,A=pe.size>0;if(!T&&!x&&!A)return;const g=A?Ot.filter(p=>pe.has(ie(p))):Ot;if(!g.length){alert("No data available to export");return}le(g)},de=()=>{const T=c&&c.length>0?c:a;if(!T||T.length===0){alert("No data available to export");return}le(T)},le=T=>{const x=T.map((y,N)=>({No:N+1,"Assembly Line":y.assemblyLine,"GMSOA No":y.gmsoaNo,"SOA Sr No":y.soaSrNo,"Assembly Date":y.assemblyDate,"Unique Code":y.uniqueCode,"Splitted Code":y.splittedCode||"-",Party:y.party,"Customer PO No":y.customerPoNo,"Code No":y.codeNo,Product:y.product,"PO Qty":y.poQty,Qty:y.qty,"Qty Executed":y.qtyExe,"Qty Pending":y.qtyPending,"Finished Valve":y.finishedValve,"GM Logo":y.gmLogo,"Name Plate":y.namePlate,"Special Notes":y.specialNotes||"","Product Special 1":y.productSpcl1,"Product Special 2":y.productSpcl2,"Product Special 3":y.productSpcl3,Inspection:y.inspection,Painting:y.painting,Remarks:y.remarks||""})),A=Ht.json_to_sheet(x),g=Ht.book_new();Ht.book_append_sheet(g,A,"Orders");const p=Zs(g,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([p],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Pe=T=>{zt(T),jt(T.remarks||""),Ue(!0)},Be=async()=>{if(!He)return;const T=new FormData;T.append("orderId",String(He.id)),T.append("remarks",gt);try{const x=await ht.post(`${qt}/add-remarks`,T,{headers:{Authorization:`Bearer ${wt}`}});if(console.log("Add Remarks Response:",x.data),x.data?.Resp_code==="true"||x.data?.Resp_code===!0){l(g=>g.map(p=>p.id===He.id?{...p,remarks:gt}:p));try{t(He.id,gt)}catch{}Ue(!1),zt(null),jt("")}else console.warn("Backend rejected remarks:",x.data)}catch(x){console.error("Error saving remarks:",x)}},Te=T=>[...T].sort((x,A)=>(x.originalIndex??0)-(A.originalIndex??0)),[je,Ce]=d.useState(null),[Fe,We]=d.useState(!1),ge=async()=>{if(!Fe&&z&&Xt()){We(!0),Ce({type:"info",message:"Assigning order, please wait..."});try{const T=localStorage.getItem("token");if(!T){Ce({type:"error",message:"Token missing. Please log in again."});return}const A=rt("testing2"),g=Number(Ee||0),p=Number(ot||0),y=ye||(Array.isArray(Kt)?Kt[0]:"testing2"),N=rt(y),P=new FormData;P.append("orderId",String(z.id)),P.append("totalQty",String(z.totalQty??z.qty??0)),P.append("executedQty",String(g)),P.append("currentSteps",A),P.append("nextSteps",N),P.append("split_id",String(z.split_id||""));const R=await ht.post(`${qt}/assign-order`,P,{headers:{Authorization:`Bearer ${T}`}});if(!(R.data?.Resp_code===!0||R.data?.Resp_code==="true"||R.data?.status===!0)){Ce({type:"error",message:R.data?.Resp_desc||"Main assignment failed."});return}let Ne=` Assigned ${g}  ${N}`;if(De&&p>0){const Ie=new FormData;Ie.append("orderId",String(z.id)),Ie.append("totalQty",String(z.totalQty??z.qty??0)),Ie.append("executedQty",String(p)),Ie.append("currentSteps",A),Ie.append("nextSteps",N),Ie.append("split_id",String(z.split_id||""));const $e=await ht.post(`${qt}/assign-order`,Ie,{headers:{Authorization:`Bearer ${T}`}});$e.data?.Resp_code===!0||$e.data?.Resp_code==="true"||$e.data?.status===!0?Ne+=`
 Split ${p}  ${N}`:Ce({type:"error",message:"Main assigned but split failed: "+($e.data?.Resp_desc||"Unknown error")})}Ce({type:"success",message:Ne});const Je=Ie=>Ie.splittedCode||Ie.split_id?Ie.splittedCode||Ie.split_id:[Ie.uniqueCode,Ie.soaSrNo,Ie.gmsoaNo,Ie.codeNo,Ie.assemblyLine].map($e=>$e??"").join("|"),se=Je(z);l(Ie=>Ie.filter($e=>Je($e)!==se)),ne(Ie=>{const $e=new Set(Ie);return $e.delete(se),$e}),setTimeout(()=>{ce(!1),Ce(null)},1e3)}catch(T){console.error(" Error assigning order:",T),Ce({type:"error",message:T?.response?.data?.Resp_desc||T?.response?.data?.message||"Server error while assigning."})}finally{We(!1)}}},G=()=>{oe("all"),he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:T=>{window.location.href=`/${T.toLowerCase()}`},onUploadSuccess:()=>$t()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Testing 2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(J,{onClick:ls,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:ee,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:de,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:Vt,onClearFilters:G,hasActiveFilters:W!=="all"||X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(_t),onClick:Zt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${_t?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
              text-xs font-medium text-gray-500 uppercase tracking-wider\r
              border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(T=>T==="asc"?"desc":T==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:yt.map(T=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:pe.has(Ct(T)),onCheckedChange:()=>St(Ct(T))})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:T.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:T.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:T.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:T.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:T.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:T.party,children:Ge(T.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:T.product,children:T.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:T.specialNotes,children:T.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:T.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:T.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${T.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Pe(T),children:e.jsx(lr,{className:`h-4 w-4 ${T.remarks?.trim()?"text-white":"text-blue-600"}`})}),T.remarks?.trim()&&e.jsx("div",{className:`\r
                                                          absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                          hidden group-hover:block\r
                                                          bg-gray-900 text-white text-xs\r
                                                          px-3 py-2 rounded-md shadow-lg\r
                                                          max-w-[260px] break-words z-[999]\r
                                                        `,children:T.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>V(T),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Bt(T),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${T.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${T.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},T.splittedCode||T.split_id||T.uniqueCode||T.id))})]}),Ot.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),K.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:K.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:K.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:K.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:K.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:Ot.length,lastPage:Math.max(1,Math.ceil(Ot.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:U,onOpenChange:ce,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:ye,onValueChange:fe,children:[e.jsx(nr,{id:"assignStep",disabled:!0,children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:Kt.map(T=>e.jsx(Es,{value:T,children:rt(T)},T))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Ee,onChange:T=>Le(T.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),je&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${je.type==="success"?"bg-green-50 text-green-700 border border-green-200":je.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:je.message.split(`
`).map((T,x)=>e.jsx("div",{children:T},x))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:as,disabled:Fe,children:"Cancel"}),e.jsx(J,{onClick:ge,disabled:Fe,className:"bg-black hover:bg-gray-800 text-white",children:Fe?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:mt,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ds.map(T=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",T.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(T.gmsoaNo).replace(/^SOA/i,""),"-",T.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",T.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:T.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:T.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",T.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",T.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:T.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},T.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(J,{onClick:us,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:Et,onOpenChange:pt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>pt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:lt,onOpenChange:Ue,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:gt,onChange:T=>jt(T.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>Ue(!1),children:"Cancel"}),e.jsx(J,{onClick:Be,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function pf(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),[pe,ne]=d.useState(new Set),[U,ce]=d.useState(!1),[z,ae]=d.useState(null),[ye,fe]=d.useState(""),[Ee,Le]=d.useState(""),[De,Ve]=d.useState(!1),[et,Nt]=d.useState(""),[ot,Qt]=d.useState(""),[qe,Me]=d.useState({}),[mt,it]=d.useState(!1),[Et,pt]=d.useState(!1),[xe,tt]=d.useState(null),[lt,Ue]=d.useState(!1),[He,zt]=d.useState(null),[gt,jt]=d.useState(""),[ct,Yt]=d.useState(null),[Z,Ze]=d.useState(!1),[nt,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),wt=localStorage.getItem("token");(()=>{try{const x=localStorage.getItem("user");if(!x)return"";const A=JSON.parse(x),g=typeof A.role=="object"?A.role?.name:A.role;return String(g||"").toLowerCase()}catch{return""}})().includes("admin");const At=async()=>{try{h(!0),w(null);const g={menu_name:rt("marking1")},p=await ht.post(`${qt}/order-list`,g,{headers:{Authorization:`Bearer ${wt}`}});if((p?.data?.Resp_code==="true"||p?.data?.Resp_code===!0||p?.data?.Resp_code==="RCS")&&Array.isArray(p.data.data)){const N=p.data.data.map(P=>({id:String(P.id),assemblyLine:P.assembly_no||"",gmsoaNo:P.soa_no||"",soaSrNo:P.soa_sr_no||"",assemblyDate:P.assembly_date||"",uniqueCode:P.unique_code||P.order_no||"",splittedCode:P.splitted_code||"",split_id:P.split_id||P.splitted_code||"",party:P.party_name||P.party||"",customerPoNo:P.customer_po_no||"",codeNo:P.code_no||"",product:P.product||"",qty:Number(P.qty||0),totalQty:Number(P.totalQty||P.total_qty||P.qty||0),qtyExe:Number(P.qty_executed||0),qtyPending:Number(P.qty_pending||0),finishedValve:P.finished_valve||"",gmLogo:P.gm_logo||"",namePlate:P.name_plate||"",specialNotes:P.special_notes||P.special_note||"",productSpcl1:P.product_spc1||"",productSpcl2:P.product_spc2||"",productSpcl3:P.product_spc3||"",inspection:P.inspection||"",painting:P.painting||"",remarks:P.remarks||"",alertStatus:P.is_urgent===!0||P.is_urgent==="true"||P.alert_status===!0||P.alert_status==="true"||P.urgent===1||P.urgent==="1"}));console.log(" Orders fetched:",N.length,"records"),l(je(N)),w(null),Ke(null)}else console.warn(" No valid order data received",p.data),l([]),w(p?.data?.Resp_desc||"Failed to fetch orders")}catch(x){console.error("Error fetching orders:",x),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Vt=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{Vt||At()},[j,k,Vt]);const Ot=d.useMemo(()=>Array.from(new Set(a.map(x=>x.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(x=>x.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(x=>x.party))).filter(Boolean).sort(),[a]);const yt=x=>{const A=parseInt(x,10);return isNaN(A)?0:A},Ge=d.useMemo(()=>{let x=a.slice();if(q&&(x=x.filter(p=>n(String(p.id))||p.alertStatus)),re&&(x=x.filter(p=>typeof p.remarks=="string"&&p.remarks.trim().length>0)),W!=="all"&&(x=x.filter(p=>p.assemblyLine===W)),X!=="all"&&(x=x.filter(p=>p.gmsoaNo===X)),ue!=="all"&&(x=x.filter(p=>p.party===ue)),(Y||Q)&&(x=x.filter(p=>{if(!p.assemblyDate||p.assemblyDate==="HOLD")return!1;const N=p.assemblyDate.split(/[\/-]/).map(R=>R.trim()).map(R=>Number(R));if(N.some(R=>isNaN(R)))return!1;let P=null;if(N.length>=3){const[R,L,Ne]=N;P=new Date(Ne,L-1,R)}else if(N.length===2){const[R,L]=N;P=new Date(L,R-1,1)}else if(N.length===1){const[R]=N;P=new Date(R,0,1)}else return!1;if(!P||isNaN(P.getTime()))return!1;if(ke==="year"&&Y)return P.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return P.getFullYear()===Y.getFullYear()&&P.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return P>=Y&&P<=Q;if(Y)return P>=Y;if(Q)return P<=Q}return!0})),F.trim()){const p=F.toLowerCase();x=x.filter(y=>String(y.uniqueCode).toLowerCase().includes(p)||String(y.party).toLowerCase().includes(p)||String(y.gmsoaNo).toLowerCase().includes(p)||String(y.customerPoNo).toLowerCase().includes(p)||String(y.codeNo).toLowerCase().includes(p)||String(y.product).toLowerCase().includes(p))}const A=new Set,g=p=>p.splittedCode||p.split_id||p.uniqueCode||p.id;return x=x.filter(p=>{const y=g(p);return A.has(y)?!1:(A.add(y),!0)}),_&&(x=[...x].sort((p,y)=>{const N=yt(p.soaSrNo),P=yt(y.soaSrNo);return _==="asc"?N-P:P-N})),x},[a,F,q,re,W,X,ue,ke,Y,Q,n,_]),St=d.useMemo(()=>{const x=(j-1)*k;return Ge.slice(x,x+k)},[Ge,j,k]);d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const Ct=(x="",A=4)=>{const g=x.trim().split(/\s+/);return g.length<=A?x:g.slice(0,A).join(" ")+"..."},Zt=x=>{ne(A=>{const g=new Set(A);return g.has(x)?g.delete(x):g.add(x),g})},_t=()=>{ne(x=>x.size===Ge.length?new Set:new Set(Ge.map(A=>A.id)))},Ut=Ge.length>0&&pe.size===Ge.length,Kt="marking1",Bt=Ns(Kt);console.log("Next step(s):",Bt.map(rt)),console.log("Is final step?",fn(Kt));const Xt=x=>{const g=Ns("marking1");ae(x),ce(!0),fe(g[0]||""),Le(String(x.qtyPending??x.qty??0)),Fe(null),ge(!1),Ve(!1),Nt(""),Qt(""),Me({})},as=()=>{const x={},A=Number(z?.qtyPending??0),g=Number(Ee||0),p=Number(ot||0);if(ye||(x.quickAssignStep="Please select a workflow step."),(!Ee||g<=0)&&(x.quickAssignQty="Quantity must be greater than 0."),g>A&&(x.quickAssignQty=`Cannot exceed available (${A})`),De){et||(x.splitAssignStep="Choose split step."),(!ot||p<=0)&&(x.splitAssignQty="Split quantity is required."),ye===et&&(x.sameEngineer="Split step cannot be the same as main step.");const y=g+p;y!==A&&(x.totalQtyMismatch=`Total quantity (${y}) must equal available (${A}).`)}return Me(x),Object.keys(x).length===0},ds=()=>{ge(!1),Fe(null),ce(!1),ae(null),fe(""),Le(""),Ve(!1),Nt(""),Qt(""),Me({})},ls=a.filter(x=>pe.has(x.id)),us=()=>it(!0),V=()=>{const A=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ls.map(y=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${y.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(y.gmsoaNo).replace(/^SOA/i,"")}-${y.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${y.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${y.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${y.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${y.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${y.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${y.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,g=document.createElement("iframe");g.style.position="fixed",g.style.right="0",g.style.bottom="0",g.style.width="0",g.style.height="0",g.style.border="0",document.body.appendChild(g);const p=g.contentDocument||g.contentWindow?.document;p&&(p.open(),p.write(A),p.close(),setTimeout(()=>{g.contentWindow?.focus(),g.contentWindow?.print(),setTimeout(()=>document.body.removeChild(g),500)},300))},ie=x=>x.splittedCode||x.split_id?x.splittedCode||x.split_id:[x.uniqueCode,x.soaSrNo,x.gmsoaNo,x.codeNo,x.assemblyLine].map(A=>A??"").join("|"),K=d.useMemo(()=>{const x=Ge.filter(A=>pe.has(String(A.id)));return{count:x.length,qty:x.reduce((A,g)=>A+(g.totalQty||g.qty||0),0),qtyExe:x.reduce((A,g)=>A+(g.qtyExe||0),0),qtyPending:x.reduce((A,g)=>A+(g.qtyPending||0),0)}},[pe,Ge]),ee=()=>{const x=q===!0,A=re===!0,g=pe.size>0;if(!x&&!A&&!g)return;const p=g?Ge.filter(y=>pe.has(ie(y))):Ge;if(!p.length){alert("No data available to export");return}le(p)},de=()=>{const x=c&&c.length>0?c:a;if(!x||x.length===0){alert("No data available to export");return}le(x)},le=x=>{const A=x.map((N,P)=>({No:P+1,"Assembly Line":N.assemblyLine,"GMSOA No":N.gmsoaNo,"SOA Sr No":N.soaSrNo,"Assembly Date":N.assemblyDate,"Unique Code":N.uniqueCode,"Splitted Code":N.splittedCode||"-",Party:N.party,"Customer PO No":N.customerPoNo,"Code No":N.codeNo,Product:N.product,"PO Qty":N.poQty,Qty:N.qty,"Qty Executed":N.qtyExe,"Qty Pending":N.qtyPending,"Finished Valve":N.finishedValve,"GM Logo":N.gmLogo,"Name Plate":N.namePlate,"Special Notes":N.specialNotes||"","Product Special 1":N.productSpcl1,"Product Special 2":N.productSpcl2,"Product Special 3":N.productSpcl3,Inspection:N.inspection,Painting:N.painting,Remarks:N.remarks||""})),g=Ht.json_to_sheet(A),p=Ht.book_new();Ht.book_append_sheet(p,g,"Orders");const y=Zs(p,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([y],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Pe=x=>{tt(x),pt(!0)},Be=x=>{zt(x),jt(r(x.id)||x.remarks||""),Ue(!0)},Te=()=>{He&&(t(He.id,gt),Ue(!1),zt(null),jt(""))},je=x=>[...x].sort((A,g)=>(A.originalIndex??0)-(g.originalIndex??0)),[Ce,Fe]=d.useState(null),[We,ge]=d.useState(!1),G=async()=>{if(!We&&z&&as()){ge(!0),Fe({type:"info",message:"Assigning order, please wait..."});try{const x=localStorage.getItem("token");if(!x){Fe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(Ee||0),g=Number(ot||0),y=rt("marking1"),N=ye||(Array.isArray(Bt)?Bt[0]:"marking2"),P=rt(N),R=new FormData;R.append("orderId",String(z.id)),R.append("totalQty",String(z.totalQty??z.qty??0)),R.append("executedQty",String(A)),R.append("currentSteps",y),R.append("nextSteps",P),R.append("split_id",String(z.split_id||"")),console.log(" MAIN PAYLOAD:",Object.fromEntries(R.entries()));const L=await ht.post(`${qt}/assign-order`,R,{headers:{Authorization:`Bearer ${x}`}});if(!(L.data?.Resp_code==="true"||L.data?.Resp_code===!0||L.data?.status===!0)){Fe({type:"error",message:L.data?.Resp_desc||"Main assignment failed."});return}let Je=` Assigned ${A}  ${P}`;if(De&&g>0){const $e=new FormData;$e.append("orderId",String(z.id)),$e.append("totalQty",String(z.totalQty??z.qty??0)),$e.append("executedQty",String(g)),$e.append("currentSteps",y),$e.append("nextSteps",P),$e.append("split_id",String(z.split_id||"")),console.log(" SPLIT PAYLOAD:",Object.fromEntries($e.entries()));const te=await ht.post(`${qt}/assign-order`,$e,{headers:{Authorization:`Bearer ${x}`}});te.data?.Resp_code==="true"||te.data?.Resp_code===!0||te.data?.status===!0?Je+=`
 Split ${g}  ${P}`:Fe({type:"error",message:"Main assigned but split failed: "+(te.data?.Resp_desc||"Unknown error")})}Fe({type:"success",message:Je});const se=$e=>$e.splittedCode||$e.split_id?$e.splittedCode||$e.split_id:[$e.uniqueCode,$e.soaSrNo,$e.gmsoaNo,$e.codeNo,$e.assemblyLine].map(te=>te??"").join("|"),Ie=se(z);l($e=>$e.filter(te=>se(te)!==Ie)),ne($e=>{const te=new Set($e);return te.delete(Ie),te}),setTimeout(()=>{ce(!1),Fe(null)},1e3)}catch(x){console.error(" Error assigning order:",x),Fe({type:"error",message:"Server error while assigning."})}finally{ge(!1)}}},T=()=>{oe("all"),he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:x=>{window.location.href=`/${x.toLowerCase()}`},onUploadSuccess:()=>At()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Marking 1"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(J,{onClick:us,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:ee,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:de,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:Ot,onClearFilters:T,hasActiveFilters:W!=="all"||X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ut),onClick:_t,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ut?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(x=>x==="asc"?"desc":x==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:St.map(x=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:pe.has(x.id),onCheckedChange:()=>Zt(x.id),"aria-label":`Select row ${x.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:x.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:x.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:x.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:x.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:x.party,children:Ct(x.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:x.product,children:x.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:x.specialNotes,children:x.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:x.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:x.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${x.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Be(x),children:e.jsx(lr,{className:`h-4 w-4 ${x.remarks?.trim()?"text-white":"text-blue-600"}`})}),x.remarks?.trim()&&e.jsx("div",{className:`\r
                               absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                               hidden group-hover:block\r
                               bg-gray-900 text-white text-xs\r
                               px-3 py-2 rounded-md shadow-lg\r
                               max-w-[260px] break-words z-[999]\r
                             `,children:x.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>Pe(x),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Xt(x),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${x.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${x.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},x.id))})]}),Ge.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),K.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:K.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:K.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:K.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:K.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:Ge.length,lastPage:Math.max(1,Math.ceil(Ge.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:U,onOpenChange:ce,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:ye,onValueChange:fe,children:[e.jsx(nr,{id:"assignStep",disabled:!0,children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:Bt.map(x=>e.jsx(Es,{value:x,children:rt(x)},x))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Ee,onChange:x=>Le(x.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),Ce&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Ce.type==="success"?"bg-green-50 text-green-700 border border-green-200":Ce.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Ce.message.split(`
`).map((x,A)=>e.jsx("div",{children:x},A))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:ds,children:"Cancel"}),e.jsx(J,{onClick:G,disabled:We,className:"bg-black hover:bg-gray-800 text-white",children:We?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:mt,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ls.map(x=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",x.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(x.gmsoaNo).replace(/^SOA/i,""),"-",x.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",x.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:x.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:x.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",x.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",x.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:x.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},x.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(J,{onClick:V,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:Et,onOpenChange:pt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>pt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:lt,onOpenChange:Ue,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:gt,onChange:x=>jt(x.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:ds,disabled:We,children:"Cancel"}),e.jsx(J,{onClick:Te,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function xf(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),[pe,ne]=d.useState(new Set),[U,ce]=d.useState(!1),[z,ae]=d.useState(null),[ye,fe]=d.useState(""),[Ee,Le]=d.useState(""),[De,Ve]=d.useState(!1),[et,Nt]=d.useState(""),[ot,Qt]=d.useState(""),[qe,Me]=d.useState({}),[mt,it]=d.useState(!1),[Et,pt]=d.useState(!1),[xe,tt]=d.useState(null),[lt,Ue]=d.useState(!1),[He,zt]=d.useState(null),[gt,jt]=d.useState(""),[ct,Yt]=d.useState(null),[Z,Ze]=d.useState(!1),[nt,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),wt=localStorage.getItem("token");(()=>{try{const g=localStorage.getItem("user");if(!g)return"";const p=JSON.parse(g),y=typeof p.role=="object"?p.role?.name:p.role;return String(y||"").toLowerCase()}catch{return""}})().includes("admin");const At=async()=>{try{h(!0),w(null);const y={menu_name:rt("marking2")},N=await ht.post(`${qt}/order-list`,y,{headers:{Authorization:`Bearer ${wt}`}});if((N?.data?.Resp_code==="true"||N?.data?.Resp_code===!0||N?.data?.Resp_code==="RCS")&&Array.isArray(N.data.data)){const R=N.data.data.map(L=>({id:String(L.id),order_id:String(L.order_id),assemblyLine:L.assembly_no||"",gmsoaNo:L.soa_no||"",soaSrNo:L.soa_sr_no||"",assemblyDate:L.assembly_date||"",uniqueCode:L.unique_code||L.order_no||"",splittedCode:L.splitted_code||"",split_id:L.split_id||L.splitted_code||"",party:L.party_name||L.party||"",customerPoNo:L.customer_po_no||"",codeNo:L.code_no||"",product:L.product||"",totalQty:Number(L.totalQty||L.total_qty||L.qty||0),qty:Number(L.qty||0),qtyExe:Number(L.qty_executed||0),qtyPending:Number(L.qty_pending||0),finishedValve:L.finished_valve||"",gmLogo:L.gm_logo||"",namePlate:L.name_plate||"",specialNotes:L.special_notes||L.special_note||"",productSpcl1:L.product_spc1||"",productSpcl2:L.product_spc2||"",productSpcl3:L.product_spc3||"",inspection:L.inspection||"",painting:L.painting||"",remarks:L.remarks||"",alertStatus:L.is_urgent===!0||L.is_urgent==="true"||L.alert_status===!0||L.alert_status==="true"||L.urgent===1||L.urgent==="1"}));console.log(" Orders fetched:",R.length,"records"),l(Ce(R)),u(null),w(null),Ke(null)}else console.warn(" No valid order data received",N.data),l([]),w(N?.data?.Resp_desc||"Failed to fetch orders")}catch(g){console.error("Error fetching orders:",g),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Vt=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{Vt||At()},[j,k,Vt]);const Ot=d.useMemo(()=>Array.from(new Set(a.map(g=>g.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(g=>g.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(g=>g.party))).filter(Boolean).sort(),[a]);const yt=g=>{const p=parseInt(g,10);return isNaN(p)?0:p},Ge=d.useMemo(()=>{let g=a.slice();if(q&&(g=g.filter(N=>n(String(N.id))||N.alertStatus)),re&&(g=g.filter(N=>typeof N.remarks=="string"&&N.remarks.trim().length>0)),W!=="all"&&(g=g.filter(N=>N.assemblyLine===W)),X!=="all"&&(g=g.filter(N=>N.gmsoaNo===X)),ue!=="all"&&(g=g.filter(N=>N.party===ue)),(Y||Q)&&(g=g.filter(N=>{if(!N.assemblyDate||N.assemblyDate==="HOLD")return!1;const R=N.assemblyDate.split(/[\/-]/).map(Ne=>Ne.trim()).map(Ne=>Number(Ne));if(R.some(Ne=>isNaN(Ne)))return!1;let L=null;if(R.length>=3){const[Ne,Je,se]=R;L=new Date(se,Je-1,Ne)}else if(R.length===2){const[Ne,Je]=R;L=new Date(Je,Ne-1,1)}else if(R.length===1){const[Ne]=R;L=new Date(Ne,0,1)}else return!1;if(!L||isNaN(L.getTime()))return!1;if(ke==="year"&&Y)return L.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return L.getFullYear()===Y.getFullYear()&&L.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return L>=Y&&L<=Q;if(Y)return L>=Y;if(Q)return L<=Q}return!0})),F.trim()){const N=F.toLowerCase();g=g.filter(P=>String(P.uniqueCode).toLowerCase().includes(N)||String(P.party).toLowerCase().includes(N)||String(P.gmsoaNo).toLowerCase().includes(N)||String(P.customerPoNo).toLowerCase().includes(N)||String(P.codeNo).toLowerCase().includes(N)||String(P.product).toLowerCase().includes(N))}const p=new Set,y=N=>N.splittedCode||N.split_id||N.uniqueCode||N.id;return g=g.filter(N=>{const P=y(N);return p.has(P)?!1:(p.add(P),!0)}),_&&(g=[...g].sort((N,P)=>{const R=yt(N.soaSrNo),L=yt(P.soaSrNo);return _==="asc"?R-L:L-R})),g},[a,F,re,q,W,X,ue,ke,Y,Q,n,_]),St=g=>g.splittedCode||g.split_id||g.uniqueCode||g.id,Ct=d.useMemo(()=>{const g=Ge.filter(p=>pe.has(St(p)));return{count:g.length,qty:g.reduce((p,y)=>p+(y.totalQty||y.qty||0),0),qtyExe:g.reduce((p,y)=>p+(y.qtyExe||0),0),qtyPending:g.reduce((p,y)=>p+(y.qtyPending||0),0)}},[pe,Ge]),Zt=d.useMemo(()=>{const g=(j-1)*k;return Ge.slice(g,g+k)},[Ge,j,k]);d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const _t=(g="",p=4)=>{const y=g.trim().split(/\s+/);return y.length<=p?g:y.slice(0,p).join(" ")+"..."},Ut=g=>{ne(p=>{const y=new Set(p);return y.has(g)?y.delete(g):y.add(g),y})},Kt=()=>{ne(g=>{const p=Ge.map(St);return p.every(N=>g.has(N))?new Set:new Set(p)})},Bt=Ge.length>0&&Ge.every(g=>pe.has(St(g))),Xt="marking2",as=Ns(Xt);console.log("Next step(s):",as.map(rt)),console.log("Is final step?",fn(Xt));const ds=g=>{const y=Ns("marking2");ae(g),ce(!0),fe(y[0]||""),Le(String(g.qtyPending??g.qty??0)),We(null),G(!1),Ve(!1),Nt(""),Qt(""),Me({})},ls=()=>{const g={},p=Number(z?.qtyPending??0),y=Number(Ee||0),N=Number(ot||0);if(ye||(g.quickAssignStep="Please select a workflow step."),(!Ee||y<=0)&&(g.quickAssignQty="Quantity must be greater than 0."),y>p&&(g.quickAssignQty=`Cannot exceed available (${p})`),De){et||(g.splitAssignStep="Choose split step."),(!ot||N<=0)&&(g.splitAssignQty="Split quantity is required."),ye===et&&(g.sameEngineer="Split step cannot be the same as main step.");const P=y+N;P!==p&&(g.totalQtyMismatch=`Total quantity (${P}) must equal available (${p}).`)}return Me(g),Object.keys(g).length===0},us=()=>{G(!1),We(null),ce(!1),ae(null),fe(""),Le(""),Ve(!1),Nt(""),Qt(""),Me({})},V=a.filter(g=>pe.has(g.id)),ie=()=>it(!0),K=()=>{const p=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${V.map(P=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${P.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(P.gmsoaNo).replace(/^SOA/i,"")}-${P.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${P.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${P.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${P.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${P.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${P.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${P.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,y=document.createElement("iframe");y.style.position="fixed",y.style.right="0",y.style.bottom="0",y.style.width="0",y.style.height="0",y.style.border="0",document.body.appendChild(y);const N=y.contentDocument||y.contentWindow?.document;N&&(N.open(),N.write(p),N.close(),setTimeout(()=>{y.contentWindow?.focus(),y.contentWindow?.print(),setTimeout(()=>document.body.removeChild(y),500)},300))},ee=g=>g.splittedCode||g.split_id?g.splittedCode||g.split_id:[g.uniqueCode,g.soaSrNo,g.gmsoaNo,g.codeNo,g.assemblyLine].map(p=>p??"").join("|"),de=()=>{const g=q===!0,p=re===!0,y=pe.size>0;if(!g&&!p&&!y)return;const N=y?Ge.filter(P=>pe.has(ee(P))):Ge;if(!N.length){alert("No data available to export");return}Pe(N)},le=()=>{const g=c&&c.length>0?c:a;if(!g||g.length===0){alert("No data available to export");return}Pe(g)},Pe=g=>{const p=g.map((R,L)=>({No:L+1,"Assembly Line":R.assemblyLine,"GMSOA No":R.gmsoaNo,"SOA Sr No":R.soaSrNo,"Assembly Date":R.assemblyDate,"Unique Code":R.uniqueCode,"Splitted Code":R.splittedCode||"-",Party:R.party,"Customer PO No":R.customerPoNo,"Code No":R.codeNo,Product:R.product,"PO Qty":R.poQty,Qty:R.qty,"Qty Executed":R.qtyExe,"Qty Pending":R.qtyPending,"Finished Valve":R.finishedValve,"GM Logo":R.gmLogo,"Name Plate":R.namePlate,"Special Notes":R.specialNotes||"","Product Special 1":R.productSpcl1,"Product Special 2":R.productSpcl2,"Product Special 3":R.productSpcl3,Inspection:R.inspection,Painting:R.painting,Remarks:R.remarks||""})),y=Ht.json_to_sheet(p),N=Ht.book_new();Ht.book_append_sheet(N,y,"Orders");const P=Zs(N,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([P],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Be=g=>{tt(g),pt(!0)},Te=g=>{zt(g),jt(r(g.id)||g.remarks||""),Ue(!0)},je=()=>{He&&(t(He.id,gt),l(g=>g.map(p=>p.id===He.id?{...p,remarks:gt}:p)),tt(g=>g&&g.id===He.id?{...g,remarks:gt}:g),Ue(!1),zt(null),jt(""))},Ce=g=>[...g].sort((p,y)=>(p.originalIndex??0)-(y.originalIndex??0)),[Fe,We]=d.useState(null),[ge,G]=d.useState(!1),T="marking2",x=async()=>{if(!ge&&z&&ls()){G(!0),We({type:"info",message:"Assigning order, please wait..."});try{const g=localStorage.getItem("token");if(!g){We({type:"error",message:"Token missing. Please log in again."});return}const p=Number(Ee||0),y=Number(ot||0),N=ye||(Array.isArray(as)?as[0]:"marking2"),P=rt(N),R=rt(T),L=new FormData;L.append("orderId",String(z.id)),L.append("totalQty",String(z.totalQty??z.qty??0)),L.append("executedQty",String(p)),L.append("currentSteps",R),L.append("nextSteps",P),L.append("split_id",String(z.split_id||""));const Ne=await ht.post(`${qt}/assign-order`,L,{headers:{Authorization:`Bearer ${g}`}});if(!(Ne.data?.Resp_code==="true"||Ne.data?.Resp_code===!0)){We({type:"error",message:Ne.data?.Resp_desc||"Main assignment failed."});return}let se=` Assigned ${p}  ${P}`;if(De&&y>0){const te=new FormData;te.append("orderId",String(z.id)),te.append("totalQty",String(z.totalQty??z.qty??0)),te.append("executedQty",String(y)),te.append("nextSteps",P),te.append("split_id",String(z.split_id||""));const Se=await ht.post(`${qt}/assign-order`,te,{headers:{Authorization:`Bearer ${g}`}});Se.data?.Resp_code==="true"||Se.data?.Resp_code===!0?se+=`
 Split ${y}  ${P}`:We({type:"error",message:"Main assigned but split failed: "+(Se.data?.Resp_desc||"Unknown error")})}We({type:"success",message:se});const Ie=te=>te.splittedCode||te.split_id?te.splittedCode||te.split_id:[te.uniqueCode,te.soaSrNo,te.gmsoaNo,te.codeNo,te.assemblyLine].map(Se=>Se??"").join("|"),$e=Ie(z);l(te=>te.filter(Se=>Ie(Se)!==$e)),ne(te=>{const Se=new Set(te);return Se.delete($e),Se}),setTimeout(()=>{ce(!1),We(null)},1e3)}catch(g){console.error(" Error assigning order:",g),We({type:"error",message:"Server error while assigning."})}finally{G(!1)}}},A=()=>{oe("all"),he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:g=>{window.location.href=`/${g.toLowerCase()}`},onUploadSuccess:()=>At()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Marking 2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(J,{onClick:ie,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:de,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:le,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:Ot,onClearFilters:A,hasActiveFilters:W!=="all"||X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Bt),onClick:Kt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Bt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(g=>g==="asc"?"desc":g==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Zt.map(g=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:pe.has(g.splittedCode||g.split_id||g.uniqueCode||g.id),onCheckedChange:()=>Ut(g.splittedCode||g.split_id||g.uniqueCode||g.id),"aria-label":`Select row ${g.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:g.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:g.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:g.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:g.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:g.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:g.party,children:_t(g.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:g.product,children:g.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:g.specialNotes,children:g.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:g.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:g.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${g.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Te(g),children:e.jsx(lr,{className:`h-4 w-4 ${g.remarks?.trim()?"text-white":"text-blue-600"}`})}),g.remarks?.trim()&&e.jsx("div",{className:`\r
                                                                          absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                                          hidden group-hover:block\r
                                                                          bg-gray-900 text-white text-xs\r
                                                                          px-3 py-2 rounded-md shadow-lg\r
                                                                          max-w-[260px] break-words z-[999]\r
                                                                        `,children:g.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>Be(g),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ds(g),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${g.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${g.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},g.splittedCode||g.split_id||g.uniqueCode||g.id))})]}),Ge.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),Ct.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:Ct.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:Ct.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:Ct.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:Ct.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:Ge.length,lastPage:Math.max(1,Math.ceil(Ge.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:U,onOpenChange:ce,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:ye,onValueChange:fe,children:[e.jsx(nr,{id:"assignStep",disabled:!0,children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:as.map(g=>e.jsx(Es,{value:g,children:rt(g)},g))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Ee,onChange:g=>Le(g.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),Fe&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Fe.type==="success"?"bg-green-50 text-green-700 border border-green-200":Fe.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Fe.message.split(`
`).map((g,p)=>e.jsx("div",{children:g},p))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:us,disabled:ge,children:"Cancel"}),e.jsx(J,{onClick:x,disabled:ge,className:"bg-black hover:bg-gray-800 text-white",children:ge?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:mt,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:V.map(g=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",g.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(g.gmsoaNo).replace(/^SOA/i,""),"-",g.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",g.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:g.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:g.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",g.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",g.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:g.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},g.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(J,{onClick:K,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:Et,onOpenChange:pt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>pt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:lt,onOpenChange:Ue,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:gt,onChange:g=>jt(g.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>Ue(!1),children:"Cancel"}),e.jsx(J,{onClick:je,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function hf(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),a=Pn(),[l,c]=d.useState([]),[u,f]=d.useState(null),[h,v]=d.useState(!1),[w,j]=d.useState(null),[C,k]=d.useState(1),[S,_]=d.useState(100),[I,F]=d.useState(null),[B,q]=d.useState(""),[me,re]=d.useState(!1),[M,W]=d.useState(!1),[oe,X]=d.useState("all"),[he,ue]=d.useState("all"),[_e,ke]=d.useState("all"),[Re,Y]=d.useState("single"),[ve,Q]=d.useState(void 0),[be,pe]=d.useState(void 0),[ne,U]=d.useState(new Set),[ce,z]=d.useState(!1),[ae,ye]=d.useState(null),[fe,Ee]=d.useState(""),[Le,De]=d.useState(""),[Ve,et]=d.useState(!1),[Nt,ot]=d.useState(""),[Qt,qe]=d.useState(""),[Me,mt]=d.useState({}),[it,Et]=d.useState(!1),[pt,xe]=d.useState(!1),[tt,lt]=d.useState(null),[Ue,He]=d.useState(!1),[zt,gt]=d.useState(null),[jt,ct]=d.useState(""),[Yt,Z]=d.useState(null),[Ze,nt]=d.useState(null),Ke=d.useRef(null),[kt,wt]=d.useState(!1),$t=localStorage.getItem("token");(()=>{try{const T=localStorage.getItem("user");if(!T)return"";const x=JSON.parse(T),A=typeof x.role=="object"?x.role?.name:x.role;return String(A||"").toLowerCase()}catch{return""}})().includes("admin");const Vt=async()=>{try{v(!0),j(null);const A={menu_name:rt("svs")},g=await ht.post(`${qt}/order-list`,A,{headers:{Authorization:`Bearer ${$t}`}});if((g?.data?.Resp_code==="true"||g?.data?.Resp_code===!0||g?.data?.Resp_code==="RCS")&&Array.isArray(g.data.data)){const y=g.data.data.map(P=>({id:String(P.id),assemblyLine:P.assembly_no||"",gmsoaNo:P.soa_no||"",soaSrNo:P.soa_sr_no||"",assemblyDate:P.assembly_date||"",uniqueCode:P.unique_code||P.order_no||"",splittedCode:P.splitted_code||"",party:P.party_name||P.party||"",customerPoNo:P.customer_po_no||"",codeNo:P.code_no||"",product:P.product||"",totalQty:Number(P.totalQty||P.total_qty||P.qty||0),qty:Number(P.qty||0),qtyExe:Number(P.qty_executed||0),qtyPending:Number(P.qty_pending||0),finishedValve:P.finished_valve||"",gmLogo:P.gm_logo||"",namePlate:P.name_plate||"",specialNotes:P.special_notes||P.special_note||"",productSpcl1:P.product_spc1||"",productSpcl2:P.product_spc2||"",productSpcl3:P.product_spc3||"",inspection:P.inspection||"",painting:P.painting||"",remarks:P.remarks||"",alertStatus:P.is_urgent===!0||P.is_urgent==="true"||P.alert_status===!0||P.alert_status==="true"||P.urgent===1||P.urgent==="1"}));console.log("SVS orders raw:",y.map(P=>({id:P.id,finishedValve:P.finishedValve})));const N=y.filter(P=>String(P.finishedValve).trim().toLowerCase()==="yes");console.log(" SVS Orders fetched:",N.length,"records"),c(N),f(y),j(null),Z(null)}else console.warn(" No valid order data received",g.data),c([]),j(g?.data?.Resp_desc||"Failed to fetch orders")}catch(T){console.error("Error fetching orders:",T),j("Error fetching order list. Please check your token or server.")}finally{v(!1)}};d.useEffect(()=>{Vt()},[]);const Ot=d.useMemo(()=>Array.from(new Set(l.map(T=>T.assemblyLine))).filter(Boolean).sort(),[l]);d.useMemo(()=>Array.from(new Set(l.map(T=>T.gmsoaNo))).filter(Boolean).sort(),[l]),d.useMemo(()=>Array.from(new Set(l.map(T=>T.party))).filter(Boolean).sort(),[l]);const yt=T=>{const x=parseInt(T,10);return isNaN(x)?0:x},Ge=d.useMemo(()=>{let T=l.slice();if(me&&(T=T.filter(A=>n(String(A.id))||A.alertStatus)),M&&(T=T.filter(A=>typeof A.remarks=="string"&&A.remarks.trim().length>0)),oe!=="all"&&(T=T.filter(A=>A.assemblyLine===oe)),he!=="all"&&(T=T.filter(A=>A.gmsoaNo===he)),_e!=="all"&&(T=T.filter(A=>A.party===_e)),(ve||be)&&(T=T.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const p=A.assemblyDate.split(/[\/-]/).map(N=>N.trim()).map(N=>Number(N));if(p.some(N=>isNaN(N)))return!1;let y=null;if(p.length>=3){const[N,P,R]=p;y=new Date(R,P-1,N)}else if(p.length===2){const[N,P]=p;y=new Date(P,N-1,1)}else if(p.length===1){const[N]=p;y=new Date(N,0,1)}else return!1;if(!y||isNaN(y.getTime()))return!1;if(Re==="year"&&ve)return y.getFullYear()===ve.getFullYear();if(Re==="month"&&ve)return y.getFullYear()===ve.getFullYear()&&y.getMonth()===ve.getMonth();if(Re==="range"||Re==="single"){if(ve&&be)return y>=ve&&y<=be;if(ve)return y>=ve;if(be)return y<=be}return!0})),B.trim()){const A=B.toLowerCase();T=T.filter(g=>String(g.uniqueCode).toLowerCase().includes(A)||String(g.party).toLowerCase().includes(A)||String(g.gmsoaNo).toLowerCase().includes(A)||String(g.customerPoNo).toLowerCase().includes(A)||String(g.codeNo).toLowerCase().includes(A)||String(g.product).toLowerCase().includes(A))}const x=new Set;return T=T.filter(A=>x.has(A.id)?!1:(x.add(A.id),!0)),I&&(T=[...T].sort((A,g)=>{const p=yt(A.soaSrNo),y=yt(g.soaSrNo);return I==="asc"?p-y:y-p})),T},[l,B,M,me,oe,he,_e,Re,ve,be,n,I]),St=d.useMemo(()=>{const T=(C-1)*S;return Ge.slice(T,T+S)},[Ge,C,S]);d.useEffect(()=>{k(1)},[B,oe,he,_e,ve,be,me,M]);const Ct=T=>{U(x=>{const A=new Set(x);return A.has(T)?A.delete(T):A.add(T),A})},Zt=(T="",x=4)=>{const A=T.trim().split(/\s+/);return A.length<=x?T:A.slice(0,x).join(" ")+"..."},_t=()=>{U(T=>T.size===Ge.length?new Set:new Set(Ge.map(x=>x.id)))},Ut=Ge.length>0&&ne.size===Ge.length,Kt=T=>{ye(T),z(!0);const x=T.assemblyLine?.toLowerCase()==="d"?"marking2":"marking1";Ee(x),De(String(T.qtyPending??T.qty??0)),et(!1),ot(""),qe(""),mt({})},Bt=()=>{const T={},x=Number(ae?.qtyPending??0),A=Number(Le||0),g=Number(Qt||0);if((!Le||A<=0)&&(T.quickAssignQty="Quantity is required and must be > 0"),A>x&&(T.quickAssignQty=`Cannot exceed available (${x})`),Ve){Nt||(T.splitAssignStep="Choose second step"),(!Qt||g<=0)&&(T.splitAssignQty="Split qty required"),fe&&Nt&&fe===Nt&&(T.sameEngineer="Choose different steps");const p=A+g;p!==x&&(T.totalQtyMismatch=`Split total must equal ${x} (current ${p})`)}return mt(T),Object.keys(T).length===0},Xt=()=>{z(!1)},as=l.filter(T=>ne.has(T.id)),ds=()=>Et(!0),ls=()=>{const x=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${as.map(p=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${p.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(p.gmsoaNo).replace(/^SOA/i,"")}-${p.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${p.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${p.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${p.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${p.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${p.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${p.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,A=document.createElement("iframe");A.style.position="fixed",A.style.right="0",A.style.bottom="0",A.style.width="0",A.style.height="0",A.style.border="0",document.body.appendChild(A);const g=A.contentDocument||A.contentWindow?.document;g&&(g.open(),g.write(x),g.close(),setTimeout(()=>{A.contentWindow?.focus(),A.contentWindow?.print(),setTimeout(()=>document.body.removeChild(A),500)},300))},us=T=>{lt(T),xe(!0)},V=T=>T.splittedCode||T.split_id?T.splittedCode||T.split_id:[T.uniqueCode,T.soaSrNo,T.gmsoaNo,T.codeNo,T.assemblyLine].map(x=>x??"").join("|"),ie=d.useMemo(()=>{const T=Ge.filter(x=>ne.has(String(x.id)));return{count:T.length,qty:T.reduce((x,A)=>x+(A.totalQty||A.qty||0),0),qtyExe:T.reduce((x,A)=>x+(A.qtyExe||0),0),qtyPending:T.reduce((x,A)=>x+(A.qtyPending||0),0)}},[ne,Ge]),K=()=>{const T=me===!0,x=M===!0,A=ne.size>0;if(!T&&!x&&!A)return;const g=A?Ge.filter(p=>ne.has(V(p))):Ge;if(!g.length){alert("No data available to export");return}de(g)},ee=()=>{const T=u&&u.length>0?u:l;if(!T||T.length===0){alert("No data available to export");return}de(T)},de=T=>{const x=T.map((y,N)=>({No:N+1,"Assembly Line":y.assemblyLine,"GMSOA No":y.gmsoaNo,"SOA Sr No":y.soaSrNo,"Assembly Date":y.assemblyDate,"Unique Code":y.uniqueCode,"Splitted Code":y.splittedCode||"-",Party:y.party,"Customer PO No":y.customerPoNo,"Code No":y.codeNo,Product:y.product,"PO Qty":y.poQty,Qty:y.qty,"Qty Executed":y.qtyExe,"Qty Pending":y.qtyPending,"Finished Valve":y.finishedValve,"GM Logo":y.gmLogo,"Name Plate":y.namePlate,"Special Notes":y.specialNotes||"","Product Special 1":y.productSpcl1,"Product Special 2":y.productSpcl2,"Product Special 3":y.productSpcl3,Inspection:y.inspection,Painting:y.painting,Remarks:y.remarks||""})),A=Ht.json_to_sheet(x),g=Ht.book_new();Ht.book_append_sheet(g,A,"Orders");const p=Zs(g,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([p],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},le=T=>{gt(T),ct(r(T.id)||T.remarks||""),He(!0)},Pe=async()=>{if(!zt)return;const T=new FormData;T.append("orderId",String(zt.id)),T.append("remarks",jt);try{const x=await ht.post(`${qt}/add-remarks`,T,{headers:{Authorization:`Bearer ${$t}`}});(x.data?.Resp_code==="true"||x.data?.Resp_code===!0)&&(c(g=>g.map(p=>p.id===zt.id?{...p,remarks:jt}:p)),t(zt.id,jt),He(!1),gt(null),ct(""))}catch(x){console.error("Error saving SVS remarks:",x)}},Be=async T=>{const A=l.find(y=>y.id===T)?.alertStatus===!0,g=!A;c(y=>{const N=y.map(P=>P.id===T?{...P,alertStatus:g}:P);return Te(N)});const p={orderId:String(T),urgent:g?"1":"0"};try{const y=await ht.post(`${qt}/mark-urgent`,p,{headers:{Authorization:`Bearer ${$t}`}});y.data?.Resp_code==="true"||y.data?.Resp_code===!0||y.data?.status===!0||c(P=>{const R=P.map(L=>L.id===T?{...L,alertStatus:A}:L);return Te(R)})}catch(y){console.error("Urgent API failed:",y),c(N=>{const P=N.map(R=>R.id===T?{...R,alertStatus:A}:R);return Te(P)})}},Te=T=>[...T].sort((x,A)=>(x.originalIndex??0)-(A.originalIndex??0)),[je,Ce]=d.useState(!1),Fe="svs",We=async()=>{if(!je&&(Ce(!0),!!ae&&Bt())){nt({type:"info",message:"Assigning order, please wait..."});try{const T=localStorage.getItem("token");if(!T){nt({type:"error",message:"Token missing. Please log in again."});return}const x=Number(Le||0),A=Number(Qt||0),g=fe||(Array.isArray(nextSteps)?nextSteps[0]:"svs"),p=rt(g),y=rt(Fe),N=new FormData;N.append("orderId",String(ae.id)),N.append("totalQty",String(ae.qty)),N.append("executedQty",String(x)),N.append("currentSteps",y),N.append("nextSteps",p),N.append("split_id",String(ae.split_id||"")),console.log(" MAIN PAYLOAD:");for(const Ne of N.entries())console.log(Ne[0],Ne[1]);const P=await ht.post(`${qt}/assign-order`,N,{headers:{Authorization:`Bearer ${T}`}});if(!(P.data?.Resp_code==="true"||P.data?.Resp_code===!0)){nt({type:"error",message:P.data?.Resp_desc||"Main assignment failed."});return}let L=` Assigned ${x}  ${p}`;if(Ve&&A>0){const Ne=new FormData;Ne.append("orderId",String(ae.id)),Ne.append("totalQty",String(ae.qty)),Ne.append("executedQty",String(A)),Ne.append("nextSteps",p),Ne.append("split_id",String(ae.split_id||"")),console.log(" SPLIT PAYLOAD:");for(const Ie of Ne.entries())console.log("SPLIT:",Ie[0],Ie[1]);const Je=await ht.post(`${qt}/assign-order`,Ne,{headers:{Authorization:`Bearer ${T}`}});Je.data?.Resp_code==="true"||Je.data?.Resp_code===!0?L+=`
 Split ${A}  ${p}`:nt({type:"error",message:"Main assigned but split failed: "+(Je.data?.Resp_desc||"Unknown error")})}nt({type:"success",message:L}),await Vt(),z(!1),nt(null)}catch(T){console.error(" Error assigning order:",T),nt({type:"error",message:"Server error while assigning."})}finally{Ce(!1)}}},ge=()=>{X("all"),ue("all"),ke("all"),Y("range"),Q(void 0),pe(void 0)},G=T=>e.jsxs("table",{className:"w-full border-collapse text-sm",children:[e.jsx("thead",{className:"sticky top-0 z-20 bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-center",children:e.jsx(Vs,{checked:T.length>0&&ne.size===T.length,onCheckedChange:_t})}),e.jsx("th",{className:"px-3 py-2 text-left",children:"SOA"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center",children:"Executed"}),e.jsx("th",{className:"px-3 py-2 text-center",children:"Pending"}),e.jsx("th",{className:"px-3 py-2 text-center",children:"Urgent"}),e.jsx("th",{className:"px-3 py-2 text-center",children:"Remarks"}),e.jsx("th",{className:"px-3 py-2 text-center",children:"Action"})]})}),e.jsx("tbody",{children:T.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"text-center py-6 text-gray-500",children:"No SVS data found"})}):T.map(x=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsx(Vs,{checked:ne.has(x.id),onCheckedChange:()=>Ct(x.id)})}),e.jsxs("td",{className:"px-3 py-2",children:[x.gmsoaNo,"-",x.soaSrNo]}),e.jsx("td",{className:"px-3 py-2",children:x.party}),e.jsx("td",{className:"px-3 py-2",children:x.product}),e.jsx("td",{className:"px-3 py-2 text-center",children:x.qty}),e.jsx("td",{className:"px-3 py-2 text-center",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 text-center",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsx(J,{size:"icon",variant:"ghost",onClick:()=>Be(x.id),children:e.jsx(ys,{className:`h-4 w-4 ${x.alertStatus?"text-red-600":"text-gray-400"}`})})}),e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsx(J,{size:"icon",variant:"ghost",onClick:()=>le(x),children:e.jsx(lr,{className:"h-4 w-4"})})}),e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsx(J,{size:"icon",variant:"ghost",onClick:()=>us(x),children:e.jsx(Ys,{className:"h-4 w-4"})})})]},x.id))})]});return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:T=>{window.location.href=`/${T.toLowerCase()}`},onUploadSuccess:()=>Vt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Stock Valve Store (SVS) Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage stock valve store orders and manufacturing workflow (Finished Valve = Yes)"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(J,{onClick:ds,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>re(!me),className:`btn-urgent flex items-center gap-2 ${me?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),me?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>W(!M),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:M?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:K,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:ee,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]}),e.jsx(J,{variant:"outline",className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",onClick:()=>a("/svs-stock"),children:"Inventory"})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:B,setSearchTerm:q,assemblyLineFilter:oe,setAssemblyLineFilter:X,dateFilterMode:Re,setDateFilterMode:Y,dateFrom:ve,setDateFrom:Q,dateTo:be,setDateTo:pe,assemblyLines:Ot,onClearFilters:ge,hasActiveFilters:oe!=="all"||he!=="all"||_e!=="all"||!!ve||!!be})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:Ke,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:h&&l.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ut),onClick:_t,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ut?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>F(T=>T==="asc"?"desc":T==="desc"?null:"asc"),children:["Sr.No.",I==="asc"&&" ",I==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:St.map(T=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:ne.has(T.id),onCheckedChange:()=>Ct(T.id),"aria-label":`Select row ${T.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:T.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:T.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:T.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:T.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:T.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:T.party,children:Zt(T.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:T.product,children:T.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:T.specialNotes,children:T.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:T.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:T.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${T.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>le(T),children:e.jsx(lr,{className:`h-4 w-4 ${T.remarks?.trim()?"text-white":"text-blue-600"}`})}),T.remarks?.trim()&&e.jsx("div",{className:`\r
                                             absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                             hidden group-hover:block\r
                                             bg-gray-900 text-white text-xs\r
                                             px-3 py-2 rounded-md shadow-lg\r
                                             max-w-[260px] break-words z-[999]\r
                                           `,children:T.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>us(T),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Kt(T),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${T.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${T.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},T.id))})]}),Ge.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No SVS orders found."})]})})})}),ie.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:ie.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:ie.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:ie.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:ie.qtyPending})]})]}),e.jsx(cr,{page:C,perPage:S,total:Ge.length,lastPage:Math.max(1,Math.ceil(Ge.length/Math.max(S,1))),onChangePage:k,onChangePerPage:_,disabled:h}),e.jsx(Rt,{open:ce,onOpenChange:z,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",ae?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:fe,onValueChange:Ee,children:[e.jsx(nr,{id:"assignStep",disabled:!0,children:e.jsx(rr,{placeholder:"Select step"})}),e.jsxs(ar,{children:[e.jsx(Es,{value:"marking1",children:"Marking 1"}),e.jsx(Es,{value:"marking2",children:"Marking 2"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Le,onChange:T=>De(T.target.value),max:ae?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:ae?.qtyPending})]})]})}),Ze&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Ze.type==="success"?"bg-green-50 text-green-700 border border-green-200":Ze.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Ze.message.split(`
`).map((T,x)=>e.jsx("div",{children:T},x))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:Xt,disabled:je,children:"Cancel"}),e.jsx(J,{onClick:We,disabled:je,className:"bg-black hover:bg-gray-800 text-white",children:je?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:it,onOpenChange:Et,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:as.map(T=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",T.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(T.gmsoaNo).replace(/^SOA/i,""),"-",T.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",T.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:T.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:T.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",T.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",T.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold inline-block",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:T.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},T.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>Et(!1),children:"Cancel"}),e.jsxs(J,{onClick:ls,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:pt,onOpenChange:xe,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",tt?.uniqueCode]})]}),tt&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.splittedCode||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.productSpcl1||"N/A"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.productSpcl2||"N/A"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.productSpcl3||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:tt.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>xe(!1),children:"Close"})})]})}),e.jsx(Rt,{open:Ue,onOpenChange:He,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:zt?`Order: ${zt.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:jt,onChange:T=>ct(T.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>He(!1),children:"Cancel"}),e.jsx(J,{onClick:Pe,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})}),e.jsx(Rt,{open:kt,onOpenChange:wt,children:e.jsxs(Tt,{className:"max-w-7xl h-[85vh] overflow-hidden assmebly-svs-data",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"SVS Inventory"}),e.jsx(Mt,{children:"Orders received from Assembly C  SVS"})]}),e.jsx("div",{className:"h-full overflow-auto border rounded-md",children:G(Ge)})]})})]})]})}function ff(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),[pe,ne]=d.useState(new Set),[U,ce]=d.useState(!1),[z,ae]=d.useState(null),[ye,fe]=d.useState(""),[Ee,Le]=d.useState(""),[De,Ve]=d.useState(!1),[et,Nt]=d.useState(""),[ot,Qt]=d.useState(""),[qe,Me]=d.useState({}),[mt,it]=d.useState(!1),[Et,pt]=d.useState(!1),[xe,tt]=d.useState(null),[lt,Ue]=d.useState(!1),[He,zt]=d.useState(null),[gt,jt]=d.useState(""),[ct,Yt]=d.useState(null),[Z,Ze]=d.useState(!1),[nt,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),wt=localStorage.getItem("token");(()=>{try{const x=localStorage.getItem("user");if(!x)return"";const A=JSON.parse(x),g=typeof A.role=="object"?A.role?.name:A.role;return String(g||"").toLowerCase()}catch{return""}})().includes("admin");const At=x=>x.splittedCode||x.split_id||x.uniqueCode||x.id,Vt=async()=>{try{h(!0),w(null);const g={menu_name:rt("pdi1")},p=await ht.post(`${qt}/order-list`,g,{headers:{Authorization:`Bearer ${wt}`}});if((p?.data?.Resp_code==="true"||p?.data?.Resp_code===!0||p?.data?.Resp_code==="RCS")&&Array.isArray(p.data.data)){const N=p.data.data.map(P=>({id:String(P.id),assemblyLine:P.assembly_no||"",gmsoaNo:P.soa_no||"",soaSrNo:P.soa_sr_no||"",assemblyDate:P.assembly_date||"",uniqueCode:P.unique_code||P.order_no||"",splittedCode:P.splitted_code||"",split_id:P.split_id||P.splitted_code||"",party:P.party_name||P.party||"",customerPoNo:P.customer_po_no||"",codeNo:P.code_no||"",product:P.product||"",totalQty:Number(P.totalQty||P.total_qty||P.qty||0),qty:Number(P.qty||0),qtyExe:Number(P.qty_executed||0),qtyPending:Number(P.qty_pending||0),finishedValve:P.finished_valve||"",gmLogo:P.gm_logo||"",namePlate:P.name_plate||"",specialNotes:P.special_notes||P.special_note||"",productSpcl1:P.product_spc1||"",productSpcl2:P.product_spc2||"",productSpcl3:P.product_spc3||"",inspection:P.inspection||"",painting:P.painting||"",remarks:P.remarks||"",alertStatus:P.is_urgent===!0||P.is_urgent==="true"||P.alert_status===!0||P.alert_status==="true"||P.urgent===1||P.urgent==="1"}));console.log(" Orders fetched:",N.length,"records"),l(N),u(null),w(null),Ke(null)}else console.warn(" No valid order data received",p.data),l([]),w(p?.data?.Resp_desc||"Failed to fetch orders")}catch(x){console.error("Error fetching orders:",x),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Ot=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{Ot||Vt()},[j,k,Ot]);const yt=d.useMemo(()=>Array.from(new Set(a.map(x=>x.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(x=>x.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(x=>x.party))).filter(Boolean).sort(),[a]);const Ge=x=>{const A=parseInt(x,10);return isNaN(A)?0:A},St=d.useMemo(()=>{let x=a.slice();if(q&&(x=x.filter(A=>n(String(A.id))||A.alertStatus)),re&&(x=x.filter(A=>typeof A.remarks=="string"&&A.remarks.trim().length>0)),W!=="all"&&(x=x.filter(A=>A.assemblyLine===W)),X!=="all"&&(x=x.filter(A=>A.gmsoaNo===X)),ue!=="all"&&(x=x.filter(A=>A.party===ue)),(Y||Q)&&(x=x.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const p=A.assemblyDate.split(/[\/-]/).map(N=>N.trim()).map(N=>Number(N));if(p.some(N=>isNaN(N)))return!1;let y=null;if(p.length>=3){const[N,P,R]=p;y=new Date(R,P-1,N)}else if(p.length===2){const[N,P]=p;y=new Date(P,N-1,1)}else if(p.length===1){const[N]=p;y=new Date(N,0,1)}else return!1;if(!y||isNaN(y.getTime()))return!1;if(ke==="year"&&Y)return y.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return y.getFullYear()===Y.getFullYear()&&y.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return y>=Y&&y<=Q;if(Y)return y>=Y;if(Q)return y<=Q}return!0})),F.trim()){const A=F.toLowerCase();x=x.filter(g=>String(g.uniqueCode).toLowerCase().includes(A)||String(g.party).toLowerCase().includes(A)||String(g.gmsoaNo).toLowerCase().includes(A)||String(g.customerPoNo).toLowerCase().includes(A)||String(g.codeNo).toLowerCase().includes(A)||String(g.product).toLowerCase().includes(A))}return _&&(x=[...x].sort((A,g)=>{const p=Ge(A.soaSrNo),y=Ge(g.soaSrNo);return _==="asc"?p-y:y-p})),x},[a,F,q,re,W,X,ue,ke,Y,Q,n,_]),Ct=d.useMemo(()=>{const x=St.filter(A=>pe.has(At(A)));return{count:x.length,qty:x.reduce((A,g)=>A+(g.totalQty||g.qty||0),0),qtyExe:x.reduce((A,g)=>A+(g.qtyExe||0),0),qtyPending:x.reduce((A,g)=>A+(g.qtyPending||0),0)}},[pe,St]),Zt=d.useMemo(()=>{const x=(j-1)*k;return St.slice(x,x+k)},[St,j,k]);d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const _t=(x="",A=4)=>{const g=x.trim().split(/\s+/);return g.length<=A?x:g.slice(0,A).join(" ")+"..."},Ut=x=>{const A=At(x);ne(g=>{const p=new Set(g);return p.has(A)?p.delete(A):p.add(A),p})},Kt=()=>{ne(x=>x.size===St.length?new Set:new Set(St.map(At)))},Bt=St.length>0&&pe.size===St.length,Xt="pdi1",as=Ns(Xt),ds=rt(Xt);console.log("Next step(s):",as.map(rt)),console.log("Is final step?",fn(Xt));const ls=x=>{const g=Ns("pdi1");ae(x),ce(!0),fe(g[0]||""),Le(String(x.qtyPending??x.qty??0)),Fe(null),ge(!1),Ve(!1),Nt(""),Qt(""),Me({})},us=()=>{const x={},A=Number(z?.qtyPending??0),g=Number(Ee||0),p=Number(ot||0);if(ye||(x.quickAssignStep="Please select a workflow step."),(!Ee||g<=0)&&(x.quickAssignQty="Quantity must be greater than 0."),g>A&&(x.quickAssignQty=`Cannot exceed available (${A})`),De){et||(x.splitAssignStep="Choose split step."),(!ot||p<=0)&&(x.splitAssignQty="Split quantity is required."),ye===et&&(x.sameEngineer="Split step cannot be the same as main step.");const y=g+p;y!==A&&(x.totalQtyMismatch=`Total quantity (${y}) must equal available (${A}).`)}return Me(x),Object.keys(x).length===0},V=()=>{ge(!1),Fe(null),ce(!1),ae(null),fe(""),Le(""),Ve(!1),Nt(""),Qt(""),Me({})},ie=a.filter(x=>pe.has(At(x))),K=()=>it(!0),ee=()=>{const A=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>

        <style>
          @page {
            size: 130mm 85mm;
            margin: 0;
          }

          html, body {
            width: 130mm;
            height: 85mm;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
          }

          .item-label,
          .party-desc {
          padding-bottom: 2mm;}

          .item-label {
          line-height: 1.8em;}

          .bin-card {
            width: 130mm;
            height: 85mm;
            padding: 6mm;
            box-sizing: border-box;
            page-break-after: always;
          }

        .item-label-description {
        padding-top: 50px;}

          .meta-qty {
          width: 50%;}

          .process-border {
          border-top:1px solid #000;
          border-bottom:1px solid #000;
          padding-top: 1.5mm;
          padding-bottom: 1.5mm;
          }

          .detail-logo {
            padding-bottom: 0.9mm;
          }

          .description {
            padding-bottom: 2mm;
          }

          .content {
            width: 100%;
            height: 100%;
            border: 1.5px solid #000;
            border-radius: 10px;
            padding-top: 2mm;
            padding-bottom: 4mm;
              padding-left: 6mm;
                  padding-right: 6mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
          }

          .meta-item {
            padding-top: 2mm;
          }

          /* RESET DEFAULT P TAG SPACE */
          p {
            margin: 0;
          }

          /* HEADER */
          .company-name {
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1mm;
            
          }

          .assembly-title p {
          border: 1px solid #000;
            display: inline-block;
            padding-top: 1mm;
            padding-bottom: 0.9mm;
            padding-left: 1mm;
            padding-right: 1mm;
          }

          .company-address {
            font-size: 8px;
            font-weight: 400;
            text-align: center;
            line-height: 1.2;
            margin: 0 0 1.2mm;
          }

          .tag-title {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1.5mm;
          }

          .doc-row {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            margin-bottom: 0.5mm; /*  reduced */
          }

          /* ASSEMBLY LINE */
          .title {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            margin-top: 0;       /*  no top gap */
            margin-bottom: 0.5mm;
            //  border: 1px solid #000;
            // display: inline-block;
          }

          .title-line {
            border-bottom: 1px solid #000;
            margin-bottom: 1.5mm;
            margin-top: 0.5mm;
          }

          /* META */
          .meta {
            font-size: 10px;
            line-height: 1.25;
            margin-bottom: 0.8mm;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }

          .meta div {
            margin-bottom: 0.5mm;
          }

          /* ITEM */
          .desc {
            font-size: 9px;
            margin-bottom: 0.8mm;
          }

          .desc p {
          padding-bottom: 0.6mm;}

          .desc span {
            display: block;
            padding-bottom: 0.1mm;
          }

          .desc .label {
            display: block;
            font-size: 10px;
            margin-bottom: 0.8mm;
            margin-top: 0.8mm;
          }

          .desc .text {
            word-break: break-word;
            
          }

          /* QTY */
          .qty-logo {
            font-size: 10px;
            line-height: 1.3;
            margin-bottom: 0.4mm;
            margin-top: 0.8mm;
          }

          /* INSPECTION */
          .inspect {
            margin-top: auto;
            font-size: 10px;
          }

          .inspect-line {
            height: 3mm;
            border-bottom: 1px solid #000;
          }

          .label {
            font-weight: 600;
          }
        </style>
      </head>

      <body>${ie.map(y=>`
        <div class="bin-card">
          <div class="content">

            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>

            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${y.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(y.gmsoaNo).replace(/^SOA/i,"")}-${y.soaSrNo}
                </div>

              </div>
                <div class="title assembly-title">
                  <p>Assembly Line: ${y.assemblyLine}</p>
                </div>
                <div class="meta-item">
                  <p>GMV-L4-F-PRD 01 A</p>
                  <p>(02/10.09.2020)</p>
                </div>
          </div>

            

            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${y.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${y.product}</p>
              </div>
            </div>

            <div class="qty-logo">
            <div class="meta meta-logo">
              <div class="meta-qty"><span class="label">QTY:</span> ${y.qty}</div>
              <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${y.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${y.specialNotes||""}</span></div>
              </div>

            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>

          </div>
        </div>`).join("")}</body>
    </html>`,g=document.createElement("iframe");g.style.position="fixed",g.style.right="0",g.style.bottom="0",g.style.width="0",g.style.height="0",g.style.border="0",document.body.appendChild(g);const p=g.contentDocument||g.contentWindow?.document;p&&(p.open(),p.write(A),p.close(),setTimeout(()=>{g.contentWindow?.focus(),g.contentWindow?.print(),setTimeout(()=>document.body.removeChild(g),500)},300))},de=()=>{const x=q===!0,A=re===!0,g=pe.size>0;if(!x&&!A&&!g)return;const p=g?St.filter(y=>pe.has(At(y))):St;if(!p.length){alert("No data available to export");return}Pe(p)},le=()=>{const x=c&&c.length>0?c:a;if(!x||x.length===0){alert("No data available to export");return}Pe(x)},Pe=x=>{const A=x.map((N,P)=>({No:P+1,"Assembly Line":N.assemblyLine,"GMSOA No":N.gmsoaNo,"SOA Sr No":N.soaSrNo,"Assembly Date":N.assemblyDate,"Unique Code":N.uniqueCode,"Splitted Code":N.splittedCode||"-",Party:N.party,"Customer PO No":N.customerPoNo,"Code No":N.codeNo,Product:N.product,"PO Qty":N.poQty,Qty:N.qty,"Qty Executed":N.qtyExe,"Qty Pending":N.qtyPending,"Finished Valve":N.finishedValve,"GM Logo":N.gmLogo,"Name Plate":N.namePlate,"Special Notes":N.specialNotes||"","Product Special 1":N.productSpcl1,"Product Special 2":N.productSpcl2,"Product Special 3":N.productSpcl3,Inspection:N.inspection,Painting:N.painting,Remarks:N.remarks||""})),g=Ht.json_to_sheet(A),p=Ht.book_new();Ht.book_append_sheet(p,g,"Orders");const y=Zs(p,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([y],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Be=x=>{tt(x),pt(!0)},Te=x=>{zt(x),jt(r(x.id)||x.remarks||""),Ue(!0)},je=async()=>{if(!He)return;const x=new FormData;x.append("orderId",String(He.id)),x.append("remarks",gt);try{const A=await ht.post(`${qt}/add-remarks`,x,{headers:{Authorization:`Bearer ${wt}`}});(A.data?.Resp_code==="true"||A.data?.Resp_code===!0)&&(l(p=>p.map(y=>y.id===He.id?{...y,remarks:gt}:y)),t(He.id,gt),Ue(!1),zt(null),jt(""))}catch(A){console.error("Error saving SVS remarks:",A)}},[Ce,Fe]=d.useState(null),[We,ge]=d.useState(!1),G=async()=>{if(z&&us()){ge(!0),Fe({type:"info",message:"Assigning order, please wait..."});try{const x=localStorage.getItem("token");if(!x){Fe({type:"error",message:"Token missing. Please log in again."});return}const A=Number(Ee||0),g=Number(ot||0),p=Ns(Xt)[0]||"",y=ye||p,N=rt(y),R=rt(et||y),L=new FormData;L.append("orderId",String(z.id)),L.append("totalQty",String(z.totalQty??z.qty??0)),L.append("executedQty",String(A)),L.append("nextSteps",N),L.append("currentSteps",ds),console.log(" MAIN PAYLOAD");for(const $e of L.entries())console.log($e[0],$e[1]);const Ne=await ht.post(`${qt}/assign-order`,L,{headers:{Authorization:`Bearer ${x}`}});if(!(Ne.data?.Resp_code===!0||Ne.data?.Resp_code==="true"||Ne.data?.status===!0)){Fe({type:"error",message:Ne.data?.Resp_desc||"Order assignment failed."});return}let se=` Assigned ${A}  ${N}`;if(De&&g>0){const $e=et||y,te=new FormData;te.append("orderId",String(z.id)),te.append("totalQty",String(z.totalQty??z.qty??0)),te.append("executedQty",String(g)),te.append("nextSteps",R),te.append("currentSteps",ds),console.log(" SPLIT PAYLOAD");for(const ut of te.entries())console.log("SPLIT:",ut[0],ut[1]);const Se=await ht.post(`${qt}/assign-order`,te,{headers:{Authorization:`Bearer ${x}`}});Se.data?.Resp_code===!0||Se.data?.Resp_code==="true"?se+=`
 Split ${g}  ${R}`:Fe({type:"error",message:"Main assigned but split failed: "+(Se.data?.Resp_desc||"Unknown error")})}Fe({type:"success",message:se});const Ie=At(z);l($e=>$e.filter(te=>At(te)!==Ie)),ne($e=>{const te=new Set($e);return te.delete(Ie),te}),setTimeout(()=>{ce(!1),Fe(null)},1e3)}catch(x){if(x?.name==="CanceledError"||x?.code==="ERR_CANCELED"){console.log(" Assignment request cancelled by user");return}if(console.error(" Error assigning order:",x),x.response){const A=x.response.data?.message||x.response.data?.Resp_desc||"Validation failed.",g=x.response.data?.errors&&Object.entries(x.response.data.errors).map(([p,y])=>`${p}: ${y}`).join(`
`);Fe({type:"error",message:` ${A}
${g||""}`})}else x.request?Fe({type:"error",message:" No response from server. Please check your connection."}):Fe({type:"error",message:` ${x.message}`})}finally{ge(!1)}}},T=()=>{oe("all"),he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:x=>{window.location.href=`/${x.toLowerCase()}`},onUploadSuccess:()=>Vt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Pre-Delivery Inspection"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(J,{onClick:K,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:de,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:le,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:yt,onClearFilters:T,hasActiveFilters:W!=="all"||X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Bt),onClick:Kt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Bt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(x=>x==="asc"?"desc":x==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Zt.map(x=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:pe.has(At(x)),onCheckedChange:()=>Ut(x)})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:x.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:x.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:x.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:x.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:x.party,children:_t(x.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:x.product,children:x.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:x.specialNotes,children:x.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:x.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:x.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${x.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Te(x),children:e.jsx(lr,{className:`h-4 w-4 ${x.remarks?.trim()?"text-white":"text-blue-600"}`})}),x.remarks?.trim()&&e.jsx("div",{className:`\r
                                                                                               absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                                                               hidden group-hover:block\r
                                                                                               bg-gray-900 text-white text-xs\r
                                                                                               px-3 py-2 rounded-md shadow-lg\r
                                                                                               max-w-[260px] break-words z-[999]\r
                                                                                             `,children:x.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>Be(x),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ls(x),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${n(x.id)||x.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${n(x.id)||x.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},At(x)))})]}),St.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),Ct.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:Ct.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:Ct.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:Ct.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:Ct.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:St.length,lastPage:Math.max(1,Math.ceil(St.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:U,onOpenChange:x=>{x?ce(!0):V()},children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:ye,onValueChange:fe,children:[e.jsx(nr,{id:"assignStep",children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:as.map(x=>e.jsx(Es,{value:x,children:rt(x)},x))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Ee,onChange:x=>Le(x.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),Ce&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Ce.type==="success"?"bg-green-50 text-green-700 border border-green-200":Ce.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Ce.message.split(`
`).map((x,A)=>e.jsx("div",{children:x},A))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:V,disabled:We,children:"Cancel"}),e.jsx(J,{onClick:G,disabled:We,className:"bg-black hover:bg-gray-800 text-white",children:We?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:mt,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ie.map(x=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",x.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(x.gmsoaNo).replace(/^SOA/i,""),"-",x.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",x.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:x.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:x.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",x.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",x.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5 border-b border-black",children:x.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},x.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(J,{onClick:ee,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:Et,onOpenChange:pt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>pt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:lt,onOpenChange:Ue,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:gt,onChange:x=>jt(x.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>Ue(!1),children:"Cancel"}),e.jsx(J,{onClick:je,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function gf(){d.useRef(null);const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),[pe,ne]=d.useState(new Set),[U,ce]=d.useState(!1),[z,ae]=d.useState(null),[ye,fe]=d.useState(""),[Ee,Le]=d.useState(""),[De,Ve]=d.useState(!1),[et,Nt]=d.useState(""),[ot,Qt]=d.useState(""),[qe,Me]=d.useState({}),[mt,it]=d.useState(!1),[Et,pt]=d.useState(!1),[xe,tt]=d.useState(null),[lt,Ue]=d.useState(!1),[He,zt]=d.useState(null),[gt,jt]=d.useState(""),[ct,Yt]=d.useState(null),[Z,Ze]=d.useState(!1),[nt,Ke]=d.useState(null);d.useRef(null),d.useRef(null);const kt=localStorage.getItem("token");(()=>{try{const G=localStorage.getItem("user");if(!G)return"";const T=JSON.parse(G),x=typeof T.role=="object"?T.role?.name:T.role;return String(x||"").toLowerCase()}catch{return""}})().includes("admin");const $t=G=>G.splittedCode||G.split_id||G.uniqueCode||G.id,At=async()=>{try{h(!0),w(null);const x={menu_name:rt("pdi2")},A=await ht.post(`${qt}/order-list`,x,{headers:{Authorization:`Bearer ${kt}`}});if((A?.data?.Resp_code==="true"||A?.data?.Resp_code===!0||A?.data?.Resp_code==="RCS")&&Array.isArray(A.data.data)){const p=A.data.data.map(y=>({id:String(y.id),assemblyLine:y.assembly_no||"",gmsoaNo:y.soa_no||"",soaSrNo:y.soa_sr_no||"",assemblyDate:y.assembly_date||"",uniqueCode:y.unique_code||y.order_no||"",splittedCode:y.splitted_code||"",split_id:y.split_id||y.splitted_code||"",party:y.party_name||y.party||"",customerPoNo:y.customer_po_no||"",codeNo:y.code_no||"",product:y.product||"",totalQty:Number(y.totalQty||y.total_qty||y.qty||0),qty:Number(y.qty||0),qtyExe:Number(y.qty_executed||0),qtyPending:Number(y.qty_pending||0),finishedValve:y.finished_valve||"",gmLogo:y.gm_logo||"",namePlate:y.name_plate||"",specialNotes:y.special_notes||y.special_note||"",productSpcl1:y.product_spc1||"",productSpcl2:y.product_spc2||"",productSpcl3:y.product_spc3||"",inspection:y.inspection||"",painting:y.painting||"",remarks:y.remarks||"",alertStatus:y.is_urgent===!0||y.is_urgent==="true"||y.alert_status===!0||y.alert_status==="true"||y.urgent===1||y.urgent==="1"}));console.log(" Orders fetched:",p.length,"records"),l(p),u(null),w(null),Ke(null)}else console.warn(" No valid order data received",A.data),l([]),w(A?.data?.Resp_desc||"Failed to fetch orders")}catch(G){console.error("Error fetching orders:",G),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Vt=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{Vt||At()},[j,k,Vt]);const Ot=d.useMemo(()=>Array.from(new Set(a.map(G=>G.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(G=>G.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(G=>G.party))).filter(Boolean).sort(),[a]);const yt=G=>{const T=parseInt(G,10);return isNaN(T)?0:T},Ge=d.useMemo(()=>{let G=a.slice();if(q&&(G=G.filter(T=>n(String(T.id))||T.alertStatus)),re&&(G=G.filter(T=>typeof T.remarks=="string"&&T.remarks.trim().length>0)),W!=="all"&&(G=G.filter(T=>T.assemblyLine===W)),X!=="all"&&(G=G.filter(T=>T.gmsoaNo===X)),ue!=="all"&&(G=G.filter(T=>T.party===ue)),(Y||Q)&&(G=G.filter(T=>{if(!T.assemblyDate||T.assemblyDate==="HOLD")return!1;const A=T.assemblyDate.split(/[\/-]/).map(p=>p.trim()).map(p=>Number(p));if(A.some(p=>isNaN(p)))return!1;let g=null;if(A.length>=3){const[p,y,N]=A;g=new Date(N,y-1,p)}else if(A.length===2){const[p,y]=A;g=new Date(y,p-1,1)}else if(A.length===1){const[p]=A;g=new Date(p,0,1)}else return!1;if(!g||isNaN(g.getTime()))return!1;if(ke==="year"&&Y)return g.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return g.getFullYear()===Y.getFullYear()&&g.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return g>=Y&&g<=Q;if(Y)return g>=Y;if(Q)return g<=Q}return!0})),F.trim()){const T=F.toLowerCase();G=G.filter(x=>String(x.uniqueCode).toLowerCase().includes(T)||String(x.party).toLowerCase().includes(T)||String(x.gmsoaNo).toLowerCase().includes(T)||String(x.customerPoNo).toLowerCase().includes(T)||String(x.codeNo).toLowerCase().includes(T)||String(x.product).toLowerCase().includes(T))}return _&&(G=[...G].sort((T,x)=>{const A=yt(T.soaSrNo),g=yt(x.soaSrNo);return _==="asc"?A-g:g-A})),G},[a,F,q,re,W,X,ue,ke,Y,Q,n,_]),St=d.useMemo(()=>{const G=(j-1)*k;return Ge.slice(G,G+k)},[Ge,j,k]),Ct=d.useMemo(()=>{const G=Ge.filter(T=>pe.has($t(T)));return{count:G.length,qty:G.reduce((T,x)=>T+(x.totalQty||x.qty||0),0),qtyExe:G.reduce((T,x)=>T+(x.qtyExe||0),0),qtyPending:G.reduce((T,x)=>T+(x.qtyPending||0),0)}},[pe,Ge]);d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const Zt=(G="",T=4)=>{const x=G.trim().split(/\s+/);return x.length<=T?G:x.slice(0,T).join(" ")+"..."},_t=G=>{const T=$t(G);ne(x=>{const A=new Set(x);return A.has(T)?A.delete(T):A.add(T),A})},Ut=()=>{ne(G=>G.size===Ge.length?new Set:new Set(Ge.map($t)))},Kt=Ge.length>0&&pe.size===Ge.length,Bt="pdi2",Xt=Ns(Bt);console.log("Next step(s):",Xt.map(rt)),console.log("Is final step?",fn(Bt));const as=G=>{const x=Ns("pdi2");ae(G),ce(!0),je(null),fe(x[0]||""),Le(String(G.qtyPending??G.qty??0)),je(null),Fe(!1),Ve(!1),Nt(""),Qt(""),Me({})},ds=()=>{const G={},T=Number(z?.qtyPending??0),x=Number(Ee||0),A=Number(ot||0);if(ye||(G.quickAssignStep="Please select a workflow step."),(!Ee||x<=0)&&(G.quickAssignQty="Quantity must be greater than 0."),x>T&&(G.quickAssignQty=`Cannot exceed available (${T})`),De){et||(G.splitAssignStep="Choose split step."),(!ot||A<=0)&&(G.splitAssignQty="Split quantity is required."),ye===et&&(G.sameEngineer="Split step cannot be the same as main step.");const g=x+A;g!==T&&(G.totalQtyMismatch=`Total quantity (${g}) must equal available (${T}).`)}return Me(G),Object.keys(G).length===0},ls=()=>{Fe(!1),je(null),ce(!1),ae(null),fe(""),Le(""),Ve(!1),Nt(""),Qt(""),Me({})},us=a.filter(G=>pe.has($t(G))),V=()=>it(!0),ie=()=>{const T=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${us.map(g=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${g.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(g.gmsoaNo).replace(/^SOA/i,"")}-${g.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${g.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${g.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${g.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${g.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${g.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${g.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,x=document.createElement("iframe");x.style.position="fixed",x.style.right="0",x.style.bottom="0",x.style.width="0",x.style.height="0",x.style.border="0",document.body.appendChild(x);const A=x.contentDocument||x.contentWindow?.document;A&&(A.open(),A.write(T),A.close(),setTimeout(()=>{x.contentWindow?.focus(),x.contentWindow?.print(),setTimeout(()=>document.body.removeChild(x),500)},300))},K=()=>{const G=q===!0,T=re===!0,x=pe.size>0;if(!G&&!T&&!x)return;const A=x?Ge.filter(g=>pe.has($t(g))):Ge;if(!A.length){alert("No data available to export");return}de(A)},ee=()=>{const G=c&&c.length>0?c:a;if(!G||G.length===0){alert("No data available to export");return}de(G)},de=G=>{const T=G.map((p,y)=>({No:y+1,"Assembly Line":p.assemblyLine,"GMSOA No":p.gmsoaNo,"SOA Sr No":p.soaSrNo,"Assembly Date":p.assemblyDate,"Unique Code":p.uniqueCode,"Splitted Code":p.splittedCode||"-",Party:p.party,"Customer PO No":p.customerPoNo,"Code No":p.codeNo,Product:p.product,"PO Qty":p.poQty,Qty:p.qty,"Qty Executed":p.qtyExe,"Qty Pending":p.qtyPending,"Finished Valve":p.finishedValve,"GM Logo":p.gmLogo,"Name Plate":p.namePlate,"Special Notes":p.specialNotes||"","Product Special 1":p.productSpcl1,"Product Special 2":p.productSpcl2,"Product Special 3":p.productSpcl3,Inspection:p.inspection,Painting:p.painting,Remarks:p.remarks||""})),x=Ht.json_to_sheet(T),A=Ht.book_new();Ht.book_append_sheet(A,x,"Orders");const g=Zs(A,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([g],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},le=G=>{tt(G),pt(!0)},Pe=G=>{zt(G),jt(r(G.id)||G.remarks||""),Ue(!0)},Be=async()=>{if(!He)return;const G=new FormData;G.append("orderId",String(He.id)),G.append("remarks",gt);try{const T=await ht.post(`${qt}/add-remarks`,G,{headers:{Authorization:`Bearer ${kt}`}});(T.data?.Resp_code==="true"||T.data?.Resp_code===!0)&&(l(A=>A.map(g=>g.id===He.id?{...g,remarks:gt}:g)),t(He.id,gt),Ue(!1),zt(null),jt(""))}catch(T){console.error("Error saving SVS remarks:",T)}},[Te,je]=d.useState(null),[Ce,Fe]=d.useState(!1),We=async()=>{if(z&&ds()){Fe(!0),je({type:"info",message:"Assigning order, please wait..."});try{const G=localStorage.getItem("token");if(!G){je({type:"error",message:"Token missing. Please log in again."});return}const T=Number(Ee||0),x=Number(ot||0),A=rt(Bt),g=Ns(Bt)[0]||"",p=ye||g,y=rt(p),P=rt(et||p),R=new FormData;R.append("orderId",String(z.id)),R.append("totalQty",String(z.totalQty??z.qty??0)),R.append("executedQty",String(T)),R.append("nextSteps",y),R.append("currentSteps",A),console.log(" MAIN PAYLOAD");for(const Ie of R.entries())console.log(Ie[0],Ie[1]);const L=await ht.post(`${qt}/assign-order`,R,{headers:{Authorization:`Bearer ${G}`}});if(!(L.data?.Resp_code===!0||L.data?.Resp_code==="true"||L.data?.status===!0)){je({type:"error",message:L.data?.Resp_desc||"Order assignment failed."});return}let Je=` Assigned ${T}  ${y}`;if(De&&x>0){const Ie=et||p,$e=new FormData;$e.append("orderId",String(z.id)),$e.append("totalQty",String(z.totalQty??z.qty??0)),$e.append("executedQty",String(x)),$e.append("nextSteps",P),$e.append("currentSteps",A),console.log(" SPLIT PAYLOAD");for(const at of $e.entries())console.log("SPLIT:",at[0],at[1]);const te=await ht.post(`${qt}/assign-order`,$e,{headers:{Authorization:`Bearer ${G}`},signal:controller.signal});te.data?.Resp_code===!0||te.data?.Resp_code==="true"?Je+=`
 Split ${x}  ${P}`:je({type:"error",message:"Main assigned but split failed: "+(te.data?.Resp_desc||"Unknown error")})}je({type:"success",message:Je});const se=$t(z);l(Ie=>Ie.filter($e=>$t($e)!==se)),ne(Ie=>{const $e=new Set(Ie);return $e.delete(se),$e}),setTimeout(()=>{ce(!1),je(null)},1e3)}catch(G){if(G?.name==="CanceledError"||G?.code==="ERR_CANCELED"){console.log(" Assignment request cancelled by user");return}if(console.error(" Error assigning order:",G),G.response){const T=G.response.data?.message||G.response.data?.Resp_desc||"Validation failed.",x=G.response.data?.errors&&Object.entries(G.response.data.errors).map(([A,g])=>`${A}: ${g}`).join(`
`);je({type:"error",message:` ${T}
${x||""}`})}else G.request?je({type:"error",message:" No response from server. Please check your connection."}):je({type:"error",message:` ${G.message}`})}finally{Fe(!1)}}},ge=()=>{oe("all"),he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:G=>{window.location.href=`/${G.toLowerCase()}`},onUploadSuccess:()=>At()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Pre-Delivery Inspection"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(J,{onClick:V,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:K,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:ee,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:Ot,onClearFilters:ge,hasActiveFilters:W!=="all"||X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Kt),onClick:Ut,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Kt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(G=>G==="asc"?"desc":G==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:St.map(G=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:pe.has($t(G)),onCheckedChange:()=>_t(G)})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:G.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:G.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:G.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:G.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:G.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:G.party,children:Zt(G.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:G.product,children:G.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:G.specialNotes,children:G.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:G.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:G.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:G.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${G.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Pe(G),children:e.jsx(lr,{className:`h-4 w-4 ${G.remarks?.trim()?"text-white":"text-blue-600"}`})}),G.remarks?.trim()&&e.jsx("div",{className:`\r
                                  absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                  hidden group-hover:block\r
                                  bg-gray-900 text-white text-xs\r
                                  px-3 py-2 rounded-md shadow-lg\r
                                  max-w-[260px] break-words z-[999]\r
                                `,children:G.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>le(G),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>as(G),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${n(G.id)||G.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${n(G.id)||G.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},$t(G)))})]}),Ge.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),Ct.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:Ct.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:Ct.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:Ct.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:Ct.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:Ge.length,lastPage:Math.max(1,Math.ceil(Ge.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:U,onOpenChange:G=>{G?ce(!0):ls()},children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:ye,onValueChange:fe,children:[e.jsx(nr,{id:"assignStep",children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:Xt.map(G=>e.jsx(Es,{value:G,children:rt(G)},G))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Ee,onChange:G=>Le(G.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),Te&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Te.type==="success"?"bg-green-50 text-green-700 border border-green-200":Te.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Te.message.split(`
`).map((G,T)=>e.jsx("div",{children:G},T))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:ls,disabled:Ce,children:"Cancel"}),e.jsx(J,{onClick:We,disabled:Ce,className:"bg-black hover:bg-gray-800 text-white",children:Ce?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:mt,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:us.map(G=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",G.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(G.gmsoaNo).replace(/^SOA/i,""),"-",G.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",G.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:G.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:G.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",G.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",G.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:G.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},G.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(J,{onClick:ie,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:Et,onOpenChange:pt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>pt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:lt,onOpenChange:Ue,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:gt,onChange:G=>jt(G.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>Ue(!1),children:"Cancel"}),e.jsx(J,{onClick:Be,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function yf(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),[pe,ne]=d.useState(new Set),[U,ce]=d.useState(!1),[z,ae]=d.useState(null),[ye,fe]=d.useState(""),[Ee,Le]=d.useState(""),[De,Ve]=d.useState(!1),[et,Nt]=d.useState(""),[ot,Qt]=d.useState(""),[qe,Me]=d.useState({}),[mt,it]=d.useState(!1),[Et,pt]=d.useState(!1),[xe,tt]=d.useState(null),[lt,Ue]=d.useState(!1),[He,zt]=d.useState(null),[gt,jt]=d.useState(""),[ct,Yt]=d.useState(null),[Z,Ze]=d.useState(!1),[nt,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),wt=localStorage.getItem("token"),$t=async()=>{try{h(!0),w(null);const A=rt("tpi"),g=await ht.post(`${qt}/order-list`,{menu_name:A},{headers:{Authorization:`Bearer ${wt}`}});if((g?.data?.Resp_code==="true"||g?.data?.Resp_code===!0||g?.data?.Resp_code==="RCS")&&Array.isArray(g.data.data)){const y=g.data.data.map(N=>({id:String(N.id),assemblyLine:N.assembly_no||"",gmsoaNo:N.soa_no||"",soaSrNo:N.soa_sr_no||"",assemblyDate:N.assembly_date||"",uniqueCode:N.unique_code||N.order_no||"",splittedCode:N.splitted_code||"",split_id:N.split_id||N.splitted_code||"",party:N.party_name||N.party||"",customerPoNo:N.customer_po_no||"",codeNo:N.code_no||"",product:N.product||"",totalQty:Number(N.totalQty||N.total_qty||N.qty||0),qty:Number(N.qty||0),qtyExe:Number(N.qty_executed||0),qtyPending:Number(N.qty_pending||0),finishedValve:N.finished_valve||"",gmLogo:N.gm_logo||"",namePlate:N.name_plate||"",specialNotes:N.special_notes||N.special_note||"",productSpcl1:N.product_spc1||"",productSpcl2:N.product_spc2||"",productSpcl3:N.product_spc3||"",inspection:N.inspection||"",painting:N.painting||"",remarks:N.remarks||"",alertStatus:N.is_urgent===!0||N.is_urgent==="true"||N.alert_status===!0||N.alert_status==="true"||N.urgent===1||N.urgent==="1"}));console.log(" Orders fetched:",y.length,"records"),l(G(y)),u(null),w(null),Ke(null)}else console.warn(" No valid order data received",g.data),l([]),w(g?.data?.Resp_desc||"Failed to fetch orders")}catch(x){console.error("Error fetching orders:",x),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},At=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{At||$t()},[j,k,At]);const Vt=d.useMemo(()=>Array.from(new Set(a.map(x=>x.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(x=>x.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(x=>x.party))).filter(Boolean).sort(),[a]);const Ot=x=>{const A=parseInt(x,10);return isNaN(A)?0:A},yt=d.useMemo(()=>{let x=a.slice();if(q&&(x=x.filter(A=>n(String(A.id))||A.alertStatus)),re&&(x=x.filter(A=>typeof A.remarks=="string"&&A.remarks.trim().length>0)),W!=="all"&&(x=x.filter(A=>A.assemblyLine===W)),X!=="all"&&(x=x.filter(A=>A.gmsoaNo===X)),ue!=="all"&&(x=x.filter(A=>A.party===ue)),(Y||Q)&&(x=x.filter(A=>{if(!A.assemblyDate||A.assemblyDate==="HOLD")return!1;const p=A.assemblyDate.split(/[\/-]/).map(N=>N.trim()).map(N=>Number(N));if(p.some(N=>isNaN(N)))return!1;let y=null;if(p.length>=3){const[N,P,R]=p;y=new Date(R,P-1,N)}else if(p.length===2){const[N,P]=p;y=new Date(P,N-1,1)}else if(p.length===1){const[N]=p;y=new Date(N,0,1)}else return!1;if(!y||isNaN(y.getTime()))return!1;if(ke==="year"&&Y)return y.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return y.getFullYear()===Y.getFullYear()&&y.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return y>=Y&&y<=Q;if(Y)return y>=Y;if(Q)return y<=Q}return!0})),F.trim()){const A=F.toLowerCase();x=x.filter(g=>String(g.uniqueCode).toLowerCase().includes(A)||String(g.party).toLowerCase().includes(A)||String(g.gmsoaNo).toLowerCase().includes(A)||String(g.customerPoNo).toLowerCase().includes(A)||String(g.codeNo).toLowerCase().includes(A)||String(g.product).toLowerCase().includes(A))}return _&&(x=[...x].sort((A,g)=>{const p=Ot(A.soaSrNo),y=Ot(g.soaSrNo);return _==="asc"?p-y:y-p})),x},[a,F,q,re,W,X,ue,ke,Y,Q,n,_]),Ge=d.useMemo(()=>{const x=(j-1)*k;return yt.slice(x,x+k)},[yt,j,k]);d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const St=(x="",A=4)=>{const g=x.trim().split(/\s+/);return g.length<=A?x:g.slice(0,A).join(" ")+"..."},Ct=x=>x.id,Zt=x=>{ne(A=>{const g=new Set(A);return g.has(x)?g.delete(x):g.add(x),g})},_t=()=>{ne(x=>{const A=Ge.map(y=>y.id);if(A.every(y=>x.has(y))){const y=new Set(x);return A.forEach(N=>y.delete(N)),y}const p=new Set(x);return A.forEach(y=>p.add(y)),p})},Ut=d.useMemo(()=>Ge.length===0?!1:Ge.every(x=>pe.has(x.id)),[Ge,pe]),Kt="tpi",Bt=Ns(Kt);console.log("Next step(s):",Bt.map(rt)),console.log("Is final step?",fn(Kt));const Xt=x=>{const g=Ns("tpi");ae(x),ce(!0),je(null),fe(g[0]||""),Le(String(x.qtyPending??x.qty??0)),je(null),Fe(!1),Ve(!1),Nt(""),Qt(""),Me({})},as=()=>{const x={},A=Number(z?.qtyPending??0),g=Number(Ee||0),p=Number(ot||0);if(ye||(x.quickAssignStep="Please select a workflow step."),(!Ee||g<=0)&&(x.quickAssignQty="Quantity must be greater than 0."),g>A&&(x.quickAssignQty=`Cannot exceed available (${A})`),De){et||(x.splitAssignStep="Choose split step."),(!ot||p<=0)&&(x.splitAssignQty="Split quantity is required."),ye===et&&(x.sameEngineer="Split step cannot be the same as main step.");const y=g+p;y!==A&&(x.totalQtyMismatch=`Total quantity (${y}) must equal available (${A}).`)}return Me(x),Object.keys(x).length===0},ds=()=>{Ce&&We.current&&We.current.abort(),Fe(!1),je(null),ce(!1),ae(null),fe(""),Le(""),Ve(!1),Nt(""),Qt(""),Me({})},ls=a.filter(x=>pe.has(x.id)),us=()=>it(!0),V=()=>{const A=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ls.map(y=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${y.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(y.gmsoaNo).replace(/^SOA/i,"")}-${y.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${y.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${y.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${y.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${y.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${y.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${y.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,g=document.createElement("iframe");g.style.position="fixed",g.style.right="0",g.style.bottom="0",g.style.width="0",g.style.height="0",g.style.border="0",document.body.appendChild(g);const p=g.contentDocument||g.contentWindow?.document;p&&(p.open(),p.write(A),p.close(),setTimeout(()=>{g.contentWindow?.focus(),g.contentWindow?.print(),setTimeout(()=>document.body.removeChild(g),500)},300))},ie=d.useMemo(()=>{const x=yt.filter(A=>pe.has(A.id));return{count:x.length,qty:x.reduce((A,g)=>A+(g.totalQty||g.qty||0),0),qtyExe:x.reduce((A,g)=>A+(g.qtyExe||0),0),qtyPending:x.reduce((A,g)=>A+(g.qtyPending||0),0)}},[pe,yt]),K=()=>{const x=q===!0,A=re===!0,g=pe.size>0;if(!x&&!A&&!g)return;const p=g?yt.filter(y=>pe.has(y.id)):yt;if(!p.length){alert("No data available to export");return}de(p)},ee=()=>{const x=c&&c.length>0?c:a;if(!x||x.length===0){alert("No data available to export");return}de(x)},de=x=>{const A=x.map((N,P)=>({No:P+1,"Assembly Line":N.assemblyLine,"GMSOA No":N.gmsoaNo,"SOA Sr No":N.soaSrNo,"Assembly Date":N.assemblyDate,"Unique Code":N.uniqueCode,"Splitted Code":N.splittedCode||"-",Party:N.party,"Customer PO No":N.customerPoNo,"Code No":N.codeNo,Product:N.product,"PO Qty":N.poQty,Qty:N.qty,"Qty Executed":N.qtyExe,"Qty Pending":N.qtyPending,"Finished Valve":N.finishedValve,"GM Logo":N.gmLogo,"Name Plate":N.namePlate,"Special Notes":N.specialNotes||"","Product Special 1":N.productSpcl1,"Product Special 2":N.productSpcl2,"Product Special 3":N.productSpcl3,Inspection:N.inspection,Painting:N.painting,Remarks:N.remarks||""})),g=Ht.json_to_sheet(A),p=Ht.book_new();Ht.book_append_sheet(p,g,"Orders");const y=Zs(p,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([y],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},le=x=>{tt(x),pt(!0)},Pe=x=>{zt(x),jt(r(x.id)||x.remarks||""),Ue(!0)},Be=()=>{He&&(t(He.id,gt),Ue(!1),zt(null),jt(""))},[Te,je]=d.useState(null),[Ce,Fe]=d.useState(!1),We=d.useRef(null),ge=async()=>{if(!Ce&&z&&as()){Fe(!0),je({type:"info",message:"Assigning order, please wait..."});try{const x=localStorage.getItem("token");if(!x){je({type:"error",message:"Token missing. Please log in again."});return}const A=Number(Ee||0),g=Number(ot||0),p=z?.currentStep||z?.stage||"TPI",y=rt(p)||p||"",N=Ns(p)[0]||"",P=ye||N||p,R=rt(P)||P||"",L=new FormData;L.append("orderId",String(z.id)),L.append("totalQty",String(z.totalQty??z.qty??0)),L.append("executedQty",String(A)),z.split_id&&L.append("split_id",String(z.split_id)),L.append("currentSteps",y),R&&L.append("nextSteps",R),console.log(" MAIN PAYLOAD");for(const Se of L.entries())console.log(Se[0],Se[1]);We.current?.abort();const Ne=new AbortController;We.current=Ne;const Je=await ht.post(`${qt}/assign-order`,L,{headers:{Authorization:`Bearer ${x}`},signal:Ne.signal});if(!(Je.data?.Resp_code===!0||Je.data?.Resp_code==="true"||Je.data?.status===!0)){je({type:"error",message:Je.data?.Resp_desc||"Order assignment failed."});return}let Ie=` Assigned ${A}  ${R||"next stage"}`;if(De&&g>0){const Se=et||P,at=rt(Se)||Se||"",ut=new FormData;ut.append("orderId",String(z.id)),ut.append("totalQty",String(z.totalQty??z.qty??0)),ut.append("executedQty",String(g)),z.split_id&&ut.append("split_id",String(z.split_id)),ut.append("splitOrder","true"),ut.append("currentSteps",y),at&&ut.append("nextSteps",at),console.log(" SPLIT PAYLOAD");for(const Hr of ut.entries())console.log("SPLIT:",Hr[0],Hr[1]);const Wt=await ht.post(`${qt}/assign-order`,ut,{headers:{Authorization:`Bearer ${x}`},signal:Ne.signal});if(Wt.data?.Resp_code===!0||Wt.data?.Resp_code==="true"||Wt.data?.status===!0)Ie+=`
 Split ${g}  ${at||"next stage"}`;else{je({type:"error",message:"Main assigned but split failed: "+(Wt.data?.Resp_desc||"Unknown error")});return}}je({type:"success",message:Ie});const $e=Se=>Se.splittedCode||Se.split_id?Se.splittedCode||Se.split_id:[Se.uniqueCode,Se.soaSrNo,Se.gmsoaNo,Se.codeNo,Se.assemblyLine].map(at=>at??"").join("|"),te=$e(z);l(Se=>Se.filter(at=>$e(at)!==te)),ne(Se=>{const at=new Set(Se);return at.delete(te),at}),await $t(),setTimeout(()=>{ce(!1),je(null)},1e3)}catch(x){if(x?.name==="CanceledError"||x?.code==="ERR_CANCELED")je({type:"info",message:"Assignment canceled."});else if(x.response){const A=x.response.data?.message||x.response.data?.Resp_desc||"Validation failed.",g=x.response.data?.errors&&Object.entries(x.response.data.errors).map(([p,y])=>`${p}: ${y}`).join(`
`);je({type:"error",message:` ${A}
${g||""}`})}else x.request?je({type:"error",message:" No response from server. Please check your connection."}):(console.error(" Error assigning order:",x),je({type:"error",message:"Server error while assigning."}))}finally{Fe(!1)}}},G=x=>[...x].sort((A,g)=>(A.originalIndex??0)-(g.originalIndex??0)),T=()=>{oe("all"),he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:x=>{window.location.href=`/${x.toLowerCase()}`},onUploadSuccess:()=>$t()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Test and Performance Inspection"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(J,{onClick:us,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:K,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:ee,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:Vt,onClearFilters:T,hasActiveFilters:W!=="all"||X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ut),onClick:_t,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ut?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(x=>x==="asc"?"desc":x==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Ge.map(x=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:pe.has(x.id),onCheckedChange:()=>Zt(x.id),"aria-label":`Select row ${Ct(x)}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:x.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:x.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:x.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:x.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:x.party,children:St(x.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:x.product,children:x.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:x.specialNotes,children:x.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:x.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:x.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${x.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Pe(x),children:e.jsx(lr,{className:`h-4 w-4 ${x.remarks?.trim()?"text-white":"text-blue-600"}`})}),x.remarks?.trim()&&e.jsx("div",{className:`\r
                                               absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                               hidden group-hover:block\r
                                               bg-gray-900 text-white text-xs\r
                                               px-3 py-2 rounded-md shadow-lg\r
                                               max-w-[260px] break-words z-[999]\r
                                             `,children:x.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>le(x),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Xt(x),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${n(x.id)||x.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${n(x.id)||x.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},[x.id,x.splittedCode||x.split_id,x.uniqueCode,x.soaSrNo].join("-")))})]}),yt.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),ie.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:ie.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:ie.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:ie.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:ie.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:yt.length,lastPage:Math.max(1,Math.ceil(yt.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:U,onOpenChange:x=>{ce(x),x||je(null)},children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:ye,onValueChange:fe,children:[e.jsx(nr,{id:"assignStep",disabled:!0,children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:Bt.map(x=>e.jsx(Es,{value:x,children:rt(x)},x))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Ee,onChange:x=>Le(x.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),Te&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Te.type==="success"?"bg-green-50 text-green-700 border border-green-200":Te.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Te.message.split(`
`).map((x,A)=>e.jsx("div",{children:x},A))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:ds,disabled:Ce,children:"Cancel"}),e.jsx(J,{onClick:ge,disabled:Ce,className:"bg-black hover:bg-gray-800 text-white",children:Ce?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:mt,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ls.map(x=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",x.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(x.gmsoaNo).replace(/^SOA/i,""),"-",x.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",x.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:x.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:x.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",x.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",x.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:x.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},x.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(J,{onClick:V,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:Et,onOpenChange:pt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>pt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:lt,onOpenChange:Ue,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:gt,onChange:x=>jt(x.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>Ue(!1),children:"Cancel"}),e.jsx(J,{onClick:Be,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function vf(){const t=Pn(),{updateRemark:s,toggleAlertStatus:r,getRemark:n,getAlertStatus:a}=yr(),[l,c]=d.useState([]),[u,f]=d.useState(null),[h,v]=d.useState(!1),[w,j]=d.useState(null),[C,k]=d.useState(1),[S,_]=d.useState(100),[I,F]=d.useState(null),[B,q]=d.useState(""),[me,re]=d.useState(!1),[M,W]=d.useState(!1),[oe,X]=d.useState(!1),[he,ue]=d.useState("all"),[_e,ke]=d.useState("all"),[Re,Y]=d.useState("all"),[ve,Q]=d.useState("single"),[be,pe]=d.useState(void 0),[ne,U]=d.useState(void 0),[ce,z]=d.useState(new Set),[ae,ye]=d.useState(!1),[fe,Ee]=d.useState(null),[Le,De]=d.useState(""),[Ve,et]=d.useState(""),[Nt,ot]=d.useState(!1),[Qt,qe]=d.useState(""),[Me,mt]=d.useState(""),[it,Et]=d.useState({}),[pt,xe]=d.useState(!1),[tt,lt]=d.useState(!1),[Ue,He]=d.useState(null),[zt,gt]=d.useState(!1),[jt,ct]=d.useState(null),[Yt,Z]=d.useState(""),[Ze,nt]=d.useState(null),[Ke,kt]=d.useState(!1),[wt,$t]=d.useState(null);d.useRef(null);const At=d.useRef(null),Vt=localStorage.getItem("token"),[Ot,yt]=d.useState(!1),[Ge,St]=d.useState(null),[Ct,Zt]=d.useState(""),[_t,Ut]=d.useState(!1),[Kt,Bt]=d.useState(!1),[Xt,as]=d.useState(!1),ds=async(te,Se)=>{if(te)try{const at=localStorage.getItem("token");as(!0),setTimeout(()=>as(!1),2e3);const ut=new FormData;ut.append("split_id",String(Se.split_id)),ut.append("packaging","1"),await ht.post(`${qt}/change-to-packaging`,ut,{headers:{Authorization:`Bearer ${at}`}}),c(Wt=>Wt.map(vt=>vt.id===Se.id?{...vt,packaging:1}:vt)),Bt(!0),setTimeout(()=>Bt(!1),1e3)}catch(at){console.error("Packaging toggle failed",at)}},ls=te=>{console.log("Opening OCL for order:",te),St(te),Zt(""),yt(!0)},us=async()=>{if(console.log("CONFIRM CLICKED",Ge,Ct),!Ge?.id){alert("Order ID missing");return}if(!Ct.trim()){alert("Enter OCL number");return}try{Ut(!0);const te=localStorage.getItem("token");if(!te){alert("Token missing. Please login again.");return}const Se=new FormData;Se.append("split_id",Ge.split_id),Se.append("order_id",Ge.id),Se.append("currentSteps","Dispatch"),Se.append("nextSteps","Packaging"),Se.append("ocl_no",Ct),await ht.post(`${qt}/dispatch-to-packaging`,Se,{headers:{Authorization:`Bearer ${te}`}}),c(at=>at.map(ut=>ut.id===Ge.id?{...ut,oclAdded:!0}:ut)),alert("OCL Number saved successfully"),yt(!1),St(null),Zt(""),ie()}catch(te){console.error("Dispatch to packaging failed",te),alert(te.response?.data?.message||te.response?.data?.Resp_desc||"Failed to move order to Packaging")}finally{Ut(!1)}},V=()=>{yt(!1),St(null),Zt("")},ie=async()=>{try{v(!0),j(null);const Se=rt("dispatch"),at=await ht.post(`${qt}/order-list`,{menu_name:Se},{headers:{Authorization:`Bearer ${Vt}`}});if((at?.data?.Resp_code==="true"||at?.data?.Resp_code===!0||at?.data?.Resp_code==="RCS")&&Array.isArray(at.data.data)){const Wt=at.data.data.map(vt=>({id:String(vt.id),assemblyLine:vt.assembly_no||"",gmsoaNo:vt.soa_no||"",soaSrNo:vt.soa_sr_no||"",assemblyDate:vt.assembly_date||"",uniqueCode:vt.unique_code||vt.order_no||"",splittedCode:vt.splitted_code||"",split_id:vt.split_id||vt.splitted_code||"",party:vt.party_name||vt.party||"",customerPoNo:vt.customer_po_no||"",codeNo:vt.code_no||"",product:vt.product||"",qty:Number(vt.totalQty||vt.total_qty||vt.qty||0),totalQty:Number(vt.totalQty||vt.total_qty||vt.qty||0),qtyExe:Number(vt.qty_executed||0),qtyPending:Number(vt.qty_pending||0),finishedValve:vt.finished_valve||"",gmLogo:vt.gm_logo||"",namePlate:vt.name_plate||"",specialNotes:vt.special_notes||vt.special_note||"",productSpcl1:vt.product_spc1||"",productSpcl2:vt.product_spc2||"",productSpcl3:vt.product_spc3||"",inspection:vt.inspection||"",painting:vt.painting||"",remarks:vt.remarks||"",packaging:vt.packaging===1||vt.packaging==="1"?1:0,alertStatus:vt.is_urgent===!0||vt.is_urgent==="true"||vt.alert_status===!0||vt.alert_status==="true"||vt.urgent===1||vt.urgent==="1"}));console.log(" Orders fetched:",Wt.length,"records"),c(L(Wt)),f(null),j(null),$t(null)}else console.warn(" No valid order data received",at.data),c([]),j(at?.data?.Resp_desc||"Failed to fetch orders")}catch(te){console.error("Error fetching orders:",te),j("Error fetching order list. Please check your token or server.")}finally{v(!1)}},K=d.useMemo(()=>B.trim().length>0||(he!=="all"||_e!=="all"||Re!=="all")||(!!be||!!ne)||me||oe,[B,he,_e,Re,be,ne,me,oe]);d.useEffect(()=>{K||ie()},[C,S,K]);const ee=d.useMemo(()=>Array.from(new Set(l.map(te=>te.assemblyLine))).filter(Boolean).sort(),[l]);d.useMemo(()=>Array.from(new Set(l.map(te=>te.gmsoaNo))).filter(Boolean).sort(),[l]),d.useMemo(()=>Array.from(new Set(l.map(te=>te.party))).filter(Boolean).sort(),[l]);const de=te=>{const Se=parseInt(te,10);return isNaN(Se)?0:Se},le=d.useMemo(()=>{let te=l.slice();if(me&&(te=te.filter(Se=>a(String(Se.id))||Se.alertStatus)),oe&&(te=te.filter(Se=>typeof Se.remarks=="string"&&Se.remarks.trim().length>0)),M&&(te=te.filter(Se=>Se.packaging===1)),he!=="all"&&(te=te.filter(Se=>Se.assemblyLine===he)),_e!=="all"&&(te=te.filter(Se=>Se.gmsoaNo===_e)),Re!=="all"&&(te=te.filter(Se=>Se.party===Re)),(be||ne)&&(te=te.filter(Se=>{if(!Se.assemblyDate||Se.assemblyDate==="HOLD")return!1;const ut=Se.assemblyDate.split(/[\/-]/).map(vt=>vt.trim()).map(vt=>Number(vt));if(ut.some(vt=>isNaN(vt)))return!1;let Wt=null;if(ut.length>=3){const[vt,Hr,yo]=ut;Wt=new Date(yo,Hr-1,vt)}else if(ut.length===2){const[vt,Hr]=ut;Wt=new Date(Hr,vt-1,1)}else if(ut.length===1){const[vt]=ut;Wt=new Date(vt,0,1)}else return!1;if(!Wt||isNaN(Wt.getTime()))return!1;if(ve==="year"&&be)return Wt.getFullYear()===be.getFullYear();if(ve==="month"&&be)return Wt.getFullYear()===be.getFullYear()&&Wt.getMonth()===be.getMonth();if(ve==="range"||ve==="single"){if(be&&ne)return Wt>=be&&Wt<=ne;if(be)return Wt>=be;if(ne)return Wt<=ne}return!0})),B.trim()){const Se=B.toLowerCase();te=te.filter(at=>String(at.uniqueCode).toLowerCase().includes(Se)||String(at.party).toLowerCase().includes(Se)||String(at.gmsoaNo).toLowerCase().includes(Se)||String(at.customerPoNo).toLowerCase().includes(Se)||String(at.codeNo).toLowerCase().includes(Se)||String(at.product).toLowerCase().includes(Se))}return I&&(te=[...te].sort((Se,at)=>{const ut=de(Se.soaSrNo),Wt=de(at.soaSrNo);return I==="asc"?ut-Wt:Wt-ut})),te},[l,B,me,oe,M,he,_e,Re,ve,be,ne,a,I]),Pe=d.useMemo(()=>{const te=(C-1)*S;return le.slice(te,te+S)},[le,C,S]);d.useEffect(()=>{k(1)},[B,he,_e,Re,be,ne,me,oe,M]);const Be=(te="",Se=4)=>{const at=te.trim().split(/\s+/);return at.length<=Se?te:at.slice(0,Se).join(" ")+"..."},Te=te=>{z(Se=>{const at=new Set(Se);return at.has(te)?at.delete(te):at.add(te),at})},je=()=>{z(te=>te.size===le.length?new Set:new Set(le.map(Se=>Se.id)))},Ce=le.length>0&&ce.size===le.length,Fe="dispatch",We=Ns(Fe);console.log("Next step(s):",We.map(rt)),console.log("Is final step?",fn(Fe));const ge=l.filter(te=>ce.has(te.id)),G=()=>xe(!0),T=()=>{const Se=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ge.map(Wt=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${Wt.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(Wt.gmsoaNo).replace(/^SOA/i,"")}-${Wt.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${Wt.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${Wt.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${Wt.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${Wt.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${Wt.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${Wt.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,at=document.createElement("iframe");at.style.position="fixed",at.style.right="0",at.style.bottom="0",at.style.width="0",at.style.height="0",at.style.border="0",document.body.appendChild(at);const ut=at.contentDocument||at.contentWindow?.document;ut&&(ut.open(),ut.write(Se),ut.close(),setTimeout(()=>{at.contentWindow?.focus(),at.contentWindow?.print(),setTimeout(()=>document.body.removeChild(at),500)},300))},x=te=>te.splittedCode||te.split_id?te.splittedCode||te.split_id:[te.uniqueCode,te.soaSrNo,te.gmsoaNo,te.codeNo,te.assemblyLine].map(Se=>Se??"").join("|"),A=d.useMemo(()=>{const te=le.filter(Se=>ce.has(x(Se)));return{count:te.length,qty:te.reduce((Se,at)=>Se+(at.totalQty||at.qty||0),0),qtyExe:te.reduce((Se,at)=>Se+(at.qtyExe||0),0),qtyPending:te.reduce((Se,at)=>Se+(at.qtyPending||0),0)}},[ce,le]),g=()=>{const te=me===!0,Se=oe===!0,at=ce.size>0;if(!te&&!Se&&!at)return;const ut=at?le.filter(Wt=>ce.has(x(Wt))):le;if(!ut.length){alert("No data available to export");return}y(ut)},p=()=>{const te=u&&u.length>0?u:l;if(!te||te.length===0){alert("No data available to export");return}y(te)},y=te=>{const Se=te.map((vt,Hr)=>({No:Hr+1,"Assembly Line":vt.assemblyLine,"GMSOA No":vt.gmsoaNo,"SOA Sr No":vt.soaSrNo,"Assembly Date":vt.assemblyDate,"Unique Code":vt.uniqueCode,"Splitted Code":vt.splittedCode||"-",Party:vt.party,"Customer PO No":vt.customerPoNo,"Code No":vt.codeNo,Product:vt.product,"PO Qty":vt.poQty,Qty:vt.qty,"Qty Executed":vt.qtyExe,"Qty Pending":vt.qtyPending,"Finished Valve":vt.finishedValve,"GM Logo":vt.gmLogo,"Name Plate":vt.namePlate,"Special Notes":vt.specialNotes||"","Product Special 1":vt.productSpcl1,"Product Special 2":vt.productSpcl2,"Product Special 3":vt.productSpcl3,Inspection:vt.inspection,Painting:vt.painting,Remarks:vt.remarks||""})),at=Ht.json_to_sheet(Se),ut=Ht.book_new();Ht.book_append_sheet(ut,at,"Orders");const Wt=Zs(ut,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([Wt],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},N=te=>{He(te),lt(!0)},P=te=>{ct(te),Z(n(te.id)||te.remarks||""),gt(!0)},R=()=>{jt&&(s(jt.id,Yt),gt(!1),ct(null),Z(""))},L=te=>[...te].sort((Se,at)=>(Se.originalIndex??0)-(at.originalIndex??0)),[Ne,Je]=d.useState(null),[se,Ie]=d.useState(!1),$e=()=>{ue("all"),ke("all"),Y("all"),Q("range"),pe(void 0),U(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:te=>{window.location.href=`/${te.toLowerCase()}`},onUploadSuccess:()=>ie()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Dispatch"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(J,{onClick:G,variant:"outline",disabled:ce.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>re(!me),className:`btn-urgent flex items-center gap-2 ${me?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),me?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>X(!oe),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:oe?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",s:!0,onClick:g,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:p,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]}),e.jsx(J,{variant:"outline",className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",onClick:()=>t("/packaging"),children:"Completed Projects"}),e.jsx(J,{variant:"outline",onClick:()=>{W(te=>!te),re(!1),X(!1)},className:`flex items-center gap-0 border-[#174a9f] transition-all ${M?"bg-[#174a9f] text-white":"text-[#174a9f] hover:bg-[#e8f0f9]"}`,children:M?"Show All Projects":"OCL Only"})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:B,setSearchTerm:q,assemblyLineFilter:he,setAssemblyLineFilter:ue,dateFilterMode:ve,setDateFilterMode:Q,dateFrom:be,setDateFrom:pe,dateTo:ne,setDateTo:U,assemblyLines:ee,onClearFilters:$e,hasActiveFilters:he!=="all"||_e!=="all"||Re!=="all"||!!be||!!ne})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:At,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:h&&l.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ce),onClick:je,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ce?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>F(te=>te==="asc"?"desc":te==="desc"?null:"asc"),children:["Sr.No.",I==="asc"&&" ",I==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Pe.map(te=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:ce.has(te.id),onCheckedChange:()=>Te(te.id),"aria-label":`Select row ${te.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:te.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:te.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:te.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:te.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:te.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:te.party,children:Be(te.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:te.product,children:te.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:te.specialNotes,children:te.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:te.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:te.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${te.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>P(te),children:e.jsx(lr,{className:`h-4 w-4 ${te.remarks?.trim()?"text-white":"text-blue-600"}`})}),te.remarks?.trim()&&e.jsx("div",{className:`\r
                                                                    absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                                    hidden group-hover:block\r
                                                                    bg-gray-900 text-white text-xs\r
                                                                    px-3 py-2 rounded-md shadow-lg\r
                                                                    max-w-[260px] break-words z-[999]\r
                                                                  `,children:te.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>N(te),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${te.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${te.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})}),e.jsxs("div",{onClick:Se=>Se.stopPropagation(),className:"flex items-center gap-2",children:[e.jsx(Vs,{checked:te.packaging===1,disabled:te.packaging===1,onCheckedChange:Se=>{ds(!!Se,te)},title:"Toggle Packaging"}),Xt&&e.jsx(Rt,{open:Xt,onOpenChange:as,children:e.jsx(Tt,{className:"max-w-[400px]",children:e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Moved to Packaging"}),e.jsx(Mt,{})]})})}),te.packaging===1&&e.jsx(J,{size:"sm",variant:"outline",onClick:()=>ls(te),children:"OCL"})]})]})})]},[te.id,te.splittedCode||te.split_id,te.uniqueCode,te.soaSrNo].join("-")))})]}),le.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),A.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:A.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:A.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:A.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:A.qtyPending})]})]}),e.jsx(cr,{page:C,perPage:S,total:le.length,lastPage:Math.max(1,Math.ceil(le.length/Math.max(S,1))),onChangePage:k,onChangePerPage:_,disabled:h}),e.jsx(Rt,{open:pt,onOpenChange:xe,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ge.map(te=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",te.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(te.gmsoaNo).replace(/^SOA/i,""),"-",te.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",te.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:te.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:te.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",te.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",te.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:te.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},te.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>xe(!1),children:"Cancel"}),e.jsxs(J,{onClick:T,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:Ot,onOpenChange:yt,children:e.jsxs(Tt,{className:"max-w-[400px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Move to Packaging"}),e.jsx(Mt,{children:"Enter OCL Number to continue"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{children:"OCL Number"}),e.jsx(Js,{value:Ct,onChange:te=>Zt(te.target.value),placeholder:"Enter OCL No"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(J,{variant:"outline",onClick:V,children:"Cancel"}),e.jsx(J,{onClick:us,disabled:_t,children:_t?"Processing...":"Confirm"})]})]})}),e.jsx(Rt,{open:tt,onOpenChange:lt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",Ue?.uniqueCode]})]}),Ue&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>lt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:zt,onOpenChange:gt,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:jt?`Order: ${jt.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:Yt,onChange:te=>Z(te.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>gt(!1),children:"Cancel"}),e.jsx(J,{onClick:R,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function ik(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(0),[F,B]=d.useState(1),[q,me]=d.useState(null),[re,M]=d.useState(""),[W,oe]=d.useState(!1),[X,he]=d.useState(!1),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("all"),[Y,ve]=d.useState("all"),[Q,be]=d.useState("single"),[pe,ne]=d.useState(void 0),[U,ce]=d.useState(void 0),[z,ae]=d.useState(new Set),[ye,fe]=d.useState(!1),[Ee,Le]=d.useState(null),[De,Ve]=d.useState(""),[et,Nt]=d.useState(""),[ot,Qt]=d.useState(!1),[qe,Me]=d.useState(""),[mt,it]=d.useState(""),[Et,pt]=d.useState({}),[xe,tt]=d.useState(!1),[lt,Ue]=d.useState(!1),[He,zt]=d.useState(null),[gt,jt]=d.useState(!1),[ct,Yt]=d.useState(null),[Z,Ze]=d.useState(""),[nt,Ke]=d.useState(null),[kt,wt]=d.useState(!1),[$t,At]=d.useState(null);d.useRef(null);const Vt=d.useRef(null),Ot=localStorage.getItem("token");(()=>{try{const ge=localStorage.getItem("user");if(!ge)return"";const G=JSON.parse(ge),T=typeof G.role=="object"?G.role?.name:G.role;return String(T||"").toLowerCase()}catch{return""}})().includes("admin");const Ge=async()=>{try{h(!0),w(null);const T={menu_name:rt("planning"),page:j,per_page:k},x=await ht.post(`${qt}/order-list`,T,{headers:{Authorization:`Bearer ${Ot}`}});if((x?.data?.Resp_code==="true"||x?.data?.Resp_code===!0||x?.data?.Resp_code==="RCS")&&Array.isArray(x.data.data)){const g=x.data.data.map((y,N)=>({id:String(y.id),assemblyLine:y.assembly_no||"",gmsoaNo:y.soa_no||"",soaSrNo:y.soa_sr_no||"",assemblyDate:y.assembly_date||"",uniqueCode:y.unique_code||y.order_no||"",splittedCode:y.splitted_code||"",split_id:y.split_id||y.splitted_code||"",party:y.party_name||y.party||"",customerPoNo:y.customer_po_no||"",codeNo:y.code_no||"",product:y.product||"",poQty:Number(y.po_qty??y.qty??0),qty:Number(y.qty||0),qtyExe:Number(y.qty_executed||0),qtyPending:Number(y.qty_pending||0),finishedValve:y.finished_valve||"",gmLogo:y.gm_logo||"",namePlate:y.name_plate||"",specialNotes:y.special_notes||y.special_note||"",productSpcl1:y.product_spc1||"",productSpcl2:y.product_spc2||"",productSpcl3:y.product_spc3||"",inspection:y.inspection||"",painting:y.painting||"",remarks:y.remarks||"",alertStatus:y.is_urgent===!0||y.is_urgent==="true"||y.alert_status===!0||y.alert_status==="true"||y.urgent===1||y.urgent==="1",originalIndex:N}));console.log(" Orders fetched:",g.length,"records"),l(je(g)),u(null);const p=x?.data?.pagination;if(p){const y=Number(p.total??g.length),N=Number(p.current_page??j),P=p.last_page??Math.ceil(y/Math.max(k,1)),R=Number(P||1);I(y),C(N),B(R)}else{const y=g.length;I(y),B(Math.max(1,Math.ceil(y/Math.max(k,1))))}w(null),At(null)}else console.warn(" No valid order data received",x.data),l([]),w(x?.data?.Resp_desc||"Failed to fetch orders")}catch(ge){console.error("Error fetching orders:",ge),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},St=d.useMemo(()=>re.trim().length>0||(ue!=="all"||ke!=="all"||Y!=="all")||(!!pe||!!U)||W||X,[re,ue,ke,Y,pe,U,W,X]);d.useEffect(()=>{St?c||Zt():u(null)},[St,k]),d.useEffect(()=>{St||Ge()},[j,k,St]);const Ct=ge=>{const G=parseInt(ge,10);return isNaN(G)?0:G},Zt=async()=>{try{h(!0);const G=rt("planning"),T=await ht.post(`${qt}/order-list`,{menu_name:G,page:1,per_page:k},{headers:{Authorization:`Bearer ${Ot}`}});if(!(T?.data?.Resp_code==="true"||T?.data?.Resp_code===!0||T?.data?.Resp_code==="RCS")){u(null);return}const A=T?.data?.pagination,g=Number(A?.last_page||1),p=[];for(let Ne=1;Ne<=g;Ne++)p.push(ht.post(`${qt}/order-list`,{menu_name:G,page:Ne,per_page:k},{headers:{Authorization:`Bearer ${Ot}`}}));const y=await Promise.all(p);let N=[];for(const Ne of y)if(Array.isArray(Ne?.data?.data)){const Je=Ne.data.data.map((se,Ie)=>({id:String(se.id),assemblyLine:se.assembly_no||"",gmsoaNo:se.soa_no||"",soaSrNo:se.soa_sr_no||"",assemblyDate:se.assembly_date||"",uniqueCode:se.unique_code||se.order_no||"",splittedCode:se.splitted_code||"",split_id:se.split_id||se.splitted_code||"",party:se.party_name||se.party||"",customerPoNo:se.customer_po_no||"",codeNo:se.code_no||"",product:se.product||"",poQty:Number(se.po_qty??se.qty??0),qty:Number(se.qty||0),qtyExe:Number(se.qty_executed||0),qtyPending:Number(se.qty_pending||0),finishedValve:se.finished_valve||"",gmLogo:se.gm_logo||"",namePlate:se.name_plate||"",specialNotes:se.special_notes||se.special_note||"",productSpcl1:se.product_spc1||"",productSpcl2:se.product_spc2||"",productSpcl3:se.product_spc3||"",inspection:se.inspection||"",painting:se.painting||"",remarks:se.remarks||"",alertStatus:se.is_urgent===!0||se.is_urgent==="true"||se.alert_status===!0||se.alert_status==="true"||se.urgent===1||se.urgent==="1",originalIndex:Ie}));N=N.concat(Je)}const P=new Set,R=Ne=>Ne.splittedCode||Ne.split_id||Ne.uniqueCode||Ne.id,L=N.filter(Ne=>{const Je=R(Ne);return P.has(Je)?!1:(P.add(Je),!0)});u(je(L))}catch{u(null)}finally{h(!1)}},_t=d.useMemo(()=>Array.from(new Set(a.map(ge=>ge.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(ge=>ge.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(ge=>ge.party))).filter(Boolean).sort(),[a]);const Ut=d.useMemo(()=>{let G=(St&&c?c:a).slice();if(W&&(G=G.filter(T=>n(String(T.id))||T.alertStatus)),X&&(G=G.filter(T=>typeof T.remarks=="string"&&T.remarks.trim().length>0)),ue!=="all"&&(G=G.filter(T=>T.assemblyLine===ue)),ke!=="all"&&(G=G.filter(T=>T.gmsoaNo===ke)),Y!=="all"&&(G=G.filter(T=>T.party===Y)),(pe||U)&&(G=G.filter(T=>{if(!T.assemblyDate||T.assemblyDate==="HOLD")return!1;const A=(g=>{if(!g)return null;const p=g.trim().match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if(!p)return null;const[,y,N,P]=p,R=Number(y),L=Number(N),Ne=Number(P),Je=new Date(Ne,L-1,R);return Je.getFullYear()!==Ne||Je.getMonth()!==L-1||Je.getDate()!==R?null:Je})(T.assemblyDate);if(!A)return!1;if(Q==="year"&&pe)return A.getFullYear()===pe.getFullYear();if(Q==="month"&&pe)return A.getFullYear()===pe.getFullYear()&&A.getMonth()===pe.getMonth();if(Q==="range"||Q==="single"){if(pe&&U)return A>=pe&&A<=U;if(pe)return A>=pe;if(U)return A<=U}return!0})),re.trim()){const T=re.toLowerCase();G=G.filter(x=>String(x.uniqueCode).toLowerCase().includes(T)||String(x.party).toLowerCase().includes(T)||String(x.gmsoaNo).toLowerCase().includes(T)||String(x.customerPoNo).toLowerCase().includes(T)||String(x.codeNo).toLowerCase().includes(T)||String(x.product).toLowerCase().includes(T))}return q&&(G=[...G].sort((T,x)=>{const A=Ct(T.soaSrNo),g=Ct(x.soaSrNo);return q==="asc"?A-g:g-A})),G},[a,c,St,re,W,X,ue,ke,Y,Q,pe,U,n,q]),Kt=(ge="",G=4)=>{const T=ge.trim().split(/\s+/);return T.length<=G?ge:T.slice(0,G).join(" ")+"..."},Bt=d.useMemo(()=>{const ge=(j-1)*k;return Ut.slice(ge,ge+k)},[Ut,j,k]);d.useEffect(()=>{C(1)},[re,ue,ke,Y,pe,U,W,X]);const Xt=ge=>{ae(G=>{const T=new Set(G);return T.has(ge)?T.delete(ge):T.add(ge),T})},as=d.useMemo(()=>{const ge=Ut.filter(G=>z.has(G.id));return{count:ge.length,qty:ge.reduce((G,T)=>G+(T.qty||0),0),qtyExe:ge.reduce((G,T)=>G+(T.qtyExe||0),0),qtyPending:ge.reduce((G,T)=>G+(T.qtyPending||0),0)}},[z,Ut]),ds=()=>{ae(ge=>ge.size===Ut.length?new Set:new Set(Ut.map(G=>G.id)))},ls=Ut.length>0&&z.size===Ut.length,us=a.filter(ge=>z.has(ge.id)),V=()=>tt(!0),ie=()=>{const G=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>

        <style>
          @page {
            size: 130mm 85mm;
            margin: 0;
          }

          html, body {
            width: 130mm;
            height: 85mm;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
          }

          .item-label,
          .party-desc {
          padding-bottom: 2mm;}

          .item-label {
          line-height: 1.8em;}

          .bin-card {
            width: 130mm;
            height: 85mm;
            padding: 6mm;
            box-sizing: border-box;
            page-break-after: always;
          }

        .item-label-description {
        padding-top: 50px;}

          .meta-qty {
          width: 50%;}

          .process-border {
          border-top:1px solid #000;
          border-bottom:1px solid #000;
          padding-top: 1.5mm;
          padding-bottom: 1.5mm;
          }

          .detail-logo {
            padding-bottom: 0.9mm;
          }

          .description {
            padding-bottom: 2mm;
          }

          .content {
            width: 100%;
            height: 100%;
            border: 1.5px solid #000;
            border-radius: 10px;
            padding-top: 2mm;
            padding-bottom: 4mm;
              padding-left: 6mm;
                  padding-right: 6mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
          }

          .meta-item {
            padding-top: 2mm;
          }

          /* RESET DEFAULT P TAG SPACE */
          p {
            margin: 0;
          }

          /* HEADER */
          .company-name {
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1mm;
            
          }

          .assembly-title p {
          border: 1px solid #000;
            display: inline-block;
            padding-top: 1mm;
            padding-bottom: 0.9mm;
            padding-left: 1mm;
            padding-right: 1mm;
          }

          .company-address {
            font-size: 8px;
            font-weight: 400;
            text-align: center;
            line-height: 1.2;
            margin: 0 0 1.2mm;
          }

          .tag-title {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1.5mm;
          }

          .doc-row {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            margin-bottom: 0.5mm; /*  reduced */
          }

          /* ASSEMBLY LINE */
          .title {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            margin-top: 0;       /*  no top gap */
            margin-bottom: 0.5mm;
            //  border: 1px solid #000;
            // display: inline-block;
          }

          .title-line {
            border-bottom: 1px solid #000;
            margin-bottom: 1.5mm;
            margin-top: 0.5mm;
          }

          /* META */
          .meta {
            font-size: 10px;
            line-height: 1.25;
            margin-bottom: 0.8mm;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }

          .meta div {
            margin-bottom: 0.5mm;
          }

          /* ITEM */
          .desc {
            font-size: 9px;
            margin-bottom: 0.8mm;
          }

          .desc p {
          padding-bottom: 0.6mm;}

          .desc span {
            display: block;
            padding-bottom: 0.1mm;
          }

          .desc .label {
            display: block;
            font-size: 10px;
            margin-bottom: 0.8mm;
            margin-top: 0.8mm;
          }

          .desc .text {
            word-break: break-word;
            
          }

          /* QTY */
          .qty-logo {
            font-size: 10px;
            line-height: 1.3;
            margin-bottom: 0.4mm;
            margin-top: 0.8mm;
          }

          /* INSPECTION */
          .inspect {
            margin-top: auto;
            font-size: 10px;
          }

          .inspect-line {
            height: 3mm;
            border-bottom: 1px solid #000;
          }

          .label {
            font-weight: 600;
          }
        </style>
      </head>

      <body>${us.map(A=>`
        <div class="bin-card">
          <div class="content">

            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>

            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${A.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(A.gmsoaNo).replace(/^SOA/i,"")}-${A.soaSrNo}
                </div>

              </div>
                <div class="title assembly-title">
                  <p>Assembly Line: ${A.assemblyLine}</p>
                </div>
                <div class="meta-item">
                  <p>GMV-L4-F-PRD 01 A</p>
                  <p>(02/10.09.2020)</p>
                </div>
          </div>

            

            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${A.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${A.product}</p>
              </div>
            </div>

            <div class="qty-logo">
            <div class="meta meta-logo">
              <div class="meta-qty"><span class="label">QTY:</span> ${A.qty}</div>
              <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${A.gmLogo}</div>
              </div>
              <div class="detail-items">
  <span class="label">Special Note:</span>
  <span>${A.specialNotes||""}</span>
</div>

              </div>

            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>

          </div>
        </div>`).join("")}</body>
    </html>`,T=document.createElement("iframe");T.style.position="fixed",T.style.right="0",T.style.bottom="0",T.style.width="0",T.style.height="0",T.style.border="0",document.body.appendChild(T);const x=T.contentDocument||T.contentWindow?.document;x&&(x.open(),x.write(G),x.close(),setTimeout(()=>{T.contentWindow?.focus(),T.contentWindow?.print(),setTimeout(()=>document.body.removeChild(T),500)},300))},K=()=>{const ge=W===!0,G=X===!0,T=z.size>0;if(!ge&&!G&&!T)return;let x=[];if(T?x=Ut.filter(A=>z.has(A.id)):x=Ut,!x||x.length===0){alert("No data available to export");return}de(x)},ee=()=>{const ge=c&&c.length>0?c:a;if(!ge||ge.length===0){alert("No data available to export");return}de(ge)},de=ge=>{const G=ge.map((g,p)=>({No:p+1,"Assembly Line":g.assemblyLine,"GMSOA No":g.gmsoaNo,"SOA Sr No":g.soaSrNo,"Assembly Date":g.assemblyDate,"Unique Code":g.uniqueCode,"Splitted Code":g.splittedCode||"-",Party:g.party,"Customer PO No":g.customerPoNo,"Code No":g.codeNo,Product:g.product,"PO Qty":g.poQty,Qty:g.qty,"Qty Executed":g.qtyExe,"Qty Pending":g.qtyPending,"Finished Valve":g.finishedValve,"GM Logo":g.gmLogo,"Name Plate":g.namePlate,"Special Notes":g.specialNotes||"","Product Special 1":g.productSpcl1,"Product Special 2":g.productSpcl2,"Product Special 3":g.productSpcl3,Inspection:g.inspection,Painting:g.painting,Remarks:g.remarks||""})),T=Ht.json_to_sheet(G),x=Ht.book_new();Ht.book_append_sheet(x,T,"Orders");const A=Zs(x,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([A],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},le=ge=>{zt(ge),Ue(!0)},Pe=ge=>{Yt(ge),Ze(ge.remarks||""),jt(!0)},Be=async()=>{if(!ct)return;const ge=new FormData;ge.append("orderId",String(ct.id)),ge.append("remarks",Z);try{const G=await ht.post(`${qt}/add-remarks`,ge,{headers:{Authorization:`Bearer ${Ot}`}});if(console.log("Add Remarks Response:",G.data),G.data?.Resp_code==="true"||G.data?.Resp_code===!0){l(x=>x.map(A=>A.id===ct.id?{...A,remarks:Z}:A));try{t(ct.id,Z)}catch{}jt(!1),Yt(null),Ze("")}else console.warn("Backend rejected remarks:",G.data)}catch(G){console.error("Error saving remarks:",G)}},Te=async ge=>{const T=a.find(g=>g.id===ge)?.alertStatus===!0,x=!T;l(g=>{const p=g.map(y=>y.id===ge?{...y,alertStatus:x}:y);return je(p)});const A={orderId:String(ge),urgent:x?"1":"0"};try{const g=await ht.post(`${qt}/mark-urgent`,A,{headers:{Authorization:`Bearer ${Ot}`}});g.data?.Resp_code==="true"||g.data?.Resp_code===!0||g.data?.status===!0||l(y=>{const N=y.map(P=>P.id===ge?{...P,alertStatus:T}:P);return je(N)})}catch(g){console.error("Urgent API failed:",g),l(p=>{const y=p.map(N=>N.id===ge?{...N,alertStatus:T}:N);return je(y)})}},je=ge=>[...ge].sort((G,T)=>(G.originalIndex??0)-(T.originalIndex??0)),[Ce,Fe]=d.useState(null),We=()=>{M(""),_e("all"),Re("all"),ve("all"),be("range"),ne(void 0),ce(void 0)};return d.useEffect(()=>{console.log(" SEARCH TERM:",re)},[re]),e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"printable-bin-card",style:{display:"none"}}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4 flex-",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Orders Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow."})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(J,{onClick:V,variant:"outline",disabled:z.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>oe(!W),className:`btn-urgent flex items-center gap-2 ${W?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),W?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>he(!X),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:X?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:K,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:ee,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{searchTerm:re,setSearchTerm:M,currentStage:"default",assemblyLineFilter:ue,setAssemblyLineFilter:_e,dateFilterMode:Q,setDateFilterMode:be,dateFrom:pe,setDateFrom:ne,dateTo:U,setDateTo:ce,assemblyLines:_t,onClearFilters:We,hasActiveFilters:ue!=="all"||ke!=="all"||Y!=="all"||!!pe||!!U})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:e.jsx("div",{ref:Vt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle table-sticky",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(ls),onClick:ds,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${ls?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA No."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
                                    text-xs font-medium text-gray-500 uppercase tracking-wider\r
                                    border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>me(ge=>ge==="asc"?"desc":ge==="desc"?null:"asc"),children:["SR.No.",q==="asc"&&" ",q==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-20",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PO QTY"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Bt.map(ge=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:z.has(ge.id),onCheckedChange:()=>Xt(ge.id),"aria-label":`Select row ${ge.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:ge.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:ge.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:ge.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:ge.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:ge.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:ge.party,children:Kt(ge.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 min-w-90",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:ge.product,children:ge.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.poQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.qty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:ge.specialNotes,children:ge.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:ge.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:ge.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${ge.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Pe(ge),children:e.jsx(lr,{className:`h-4 w-4 ${ge.remarks?.trim()?"text-white":"text-blue-600"}`})}),ge.remarks?.trim()&&e.jsx("div",{className:`\r
          absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
          hidden group-hover:block\r
          bg-gray-900 text-white text-xs\r
          px-3 py-2 rounded-md shadow-lg\r
          max-w-[260px] break-words z-[999]\r
        `,children:ge.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>le(ge),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${ge.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:ge.alertStatus?"Click to unmark urgent":"Click to mark as urgent",onClick:()=>{console.clear(),console.log("BUTTON CLICKED  orderId:",ge.id),console.log("BEFORE CLICK  alertStatus:",ge.alertStatus),Te(ge.id)},children:e.jsx(ys,{className:`h-4 w-4 ${ge.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},ge.id))})]}),Ut.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),as.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:as.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:as.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:as.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:as.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:Ut.length,lastPage:Math.max(1,Math.ceil(Ut.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:xe,onOpenChange:tt,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:us.map(ge=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",ge.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(ge.gmsoaNo).replace(/^SOA/i,""),"-",ge.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",ge.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:ge.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:ge.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",ge.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",ge.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:ge.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},ge.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>tt(!1),children:"Cancel"}),e.jsxs(J,{onClick:ie,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:lt,onOpenChange:Ue,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",He?.uniqueCode]})]}),He&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.qty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm ",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.remarks||"-"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>Ue(!1),children:"Close"})})]})}),e.jsx(Rt,{open:gt,onOpenChange:jt,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:ct?`Order: ${ct.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:Z,onChange:ge=>Ze(ge.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>jt(!1),children:"Cancel"}),e.jsx(J,{onClick:Be,children:"Save Remarks"})]})]})})]})]})}const $z={blue:{bg:"from-[#174a9f] to-indigo-600",light:"from-blue-50 to-indigo-50",text:"text-[#174a9f]",glow:"shadow-[#174a9f]/20"},green:{bg:"from-green-500 to-emerald-600",light:"from-green-50 to-emerald-50",text:"text-green-600",glow:"shadow-green-500/20"},purple:{bg:"from-purple-500 to-violet-600",light:"from-purple-50 to-violet-50",text:"text-purple-600",glow:"shadow-purple-500/20"},orange:{bg:"from-orange-500 to-amber-600",light:"from-orange-50 to-amber-50",text:"text-orange-600",glow:"shadow-orange-500/20"}};function nx({title:t,value:s,change:r,icon:n,gradient:a,trend:l}){const c=$z[a];return e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:`absolute -inset-0.5 bg-gradient-to-r ${c.bg} rounded-2xl blur opacity-0 group-hover:opacity-30 transition duration-500`}),e.jsxs("div",{className:"relative bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/60 p-6 transition-all duration-300 hover:shadow-2xl hover:-translate-y-2 overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${c.light} opacity-50 rounded-bl-full transition-all duration-500 group-hover:w-48 group-hover:h-48`}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-2 group-hover:text-gray-700 transition-colors",children:t}),e.jsx("h3",{className:`text-4xl ${c.text} transition-all duration-300 group-hover:scale-105 inline-block`,children:s})]}),e.jsx("div",{className:`p-3 bg-gradient-to-br ${c.bg} rounded-xl shadow-lg ${c.glow} transition-all duration-300 group-hover:scale-110 group-hover:rotate-6`,children:e.jsx(n,{className:"h-6 w-6 text-white"})})]}),r&&e.jsxs("div",{className:`flex items-center gap-1.5 text-sm ${r.positive?"text-green-600":"text-red-600"}`,children:[e.jsx("span",{className:`text-base transition-transform duration-300 ${r.positive?"":"rotate-180-deg"}`,children:""}),e.jsx("span",{className:"font-medium",children:r.value}),e.jsx("span",{className:"text-gray-500",children:"from last month"})]}),l&&e.jsx("div",{className:"mt-4 h-12 flex items-end gap-1",children:l.map((u,f)=>e.jsx("div",{className:`flex-1 bg-gradient-to-t ${c.bg} rounded-t opacity-30 group-hover:opacity-60 transition-all duration-300`,style:{height:`${u}%`,transitionDelay:`${f*50}ms`}},f))})]}),e.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]})]})}function Ma({className:t,...s}){return e.jsx("div",{"data-slot":"card",className:js("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border transition-all duration-300 hover:shadow-lg",t),...s})}const Qz=`${qt}/order-counts`;function lk({onLogout:t}){const[s,r]=d.useState("Dashboard"),[n,a]=d.useState({}),[l,c]=d.useState(!1),[u,f]=d.useState(!0),[h,v]=d.useState(""),[w,j]=d.useState("");(()=>{try{const X=localStorage.getItem("user")||localStorage.getItem("userData");if(!X)return"";const he=JSON.parse(X),ue=typeof he?.role=="object"?he.role?.name:he?.role;return String(ue||"").toLowerCase()}catch{return""}})().includes("admin");const k=d.useRef(!1),S=d.useRef(null),_=X=>{if(!X)return X;const he=X.toLowerCase().replace(/[\s_-]+/g,"");return he.includes("material")?"materialIssue":he.includes("semi")?"semiQc":he.includes("phosphat")?"phosphatingQc":he==="svs"?"svs":he.includes("testing1")?"testing1":he.includes("testing2")?"testing2":he.includes("marking1")?"marking1":he.includes("marking2")?"marking2":he.includes("pdi1")?"pdi1":he.includes("pdi2")?"pdi2":he.includes("tpi")?"tpi":he.includes("assemblya")||he.includes("linea")?"assemblyA":he.includes("assemblyb")||he.includes("lineb")?"assemblyB":he.includes("assemblyc")||he.includes("linec")?"assemblyC":he.includes("assemblyd")||he.includes("lined")?"assemblyD":X},I=X=>{const he={};if(!X)return he;const ue=X.counts??X;if(ue&&typeof ue=="object"){ue.totalOrders!=null&&(he.totalOrders=Number(ue.totalOrders)||0);const _e=[["pendingMaterialIssue","materialIssue"],["pendingSemiQC","semiQc"],["pendingPhosphatingQC","phosphatingQc"],["pendingSVS","svs"],["pendingTesting1","testing1"],["pendingTesting2","testing2"],["pendingMarking1","marking1"],["pendingMarking2","marking2"],["pendingPDI1","pdi1"],["pendingPDI2","pdi2"],["pendingTPI","tpi"],["pendingAssemblyA","assemblyA"],["pendingAssemblyB","assemblyB"],["pendingAssemblyC","assemblyC"],["pendingAssemblyD","assemblyD"],["inProgress","inProgress"],["completed","completed"],["efficiency","efficiency"],["pendingDispatch","dispatch"]];for(const[ke,Re]of _e)ue[ke]!=null&&(he[Re]=Number(ue[ke])||0);ue.totalOrdersCompare!=null&&(he.totalOrdersCompare=ue.totalOrdersCompare),ue.inProgressCompare!=null&&(he.inProgressCompare=ue.inProgressCompare),ue.completedCompare!=null&&(he.completedCompare=ue.completedCompare),ue.efficiencyCompare!=null&&(he.efficiencyCompare=ue.efficiencyCompare)}return X.stages&&Array.isArray(X.stages)&&X.stages.forEach(_e=>{he[_(_e.stage)]=Number(_e.pending??0)}),X.assembly&&Array.isArray(X.assembly)&&X.assembly.forEach(_e=>{const ke=_("assembly"+_e.line);he[ke]=Number(_e.pending??0)}),he};async function F(X=!1,he){const ue=localStorage.getItem("token"),_e=ue?{Authorization:`Bearer ${ue}`}:{};_e["Content-Type"]="application/json";try{X?c(!0):f(!0);const ke=he?{assemblyDate:he}:{},Re=await ht.post(Qz,ke,{headers:_e});a(I(Re.data))}catch(ke){console.error("Dashboard summary error:",ke)}finally{X?c(!1):f(!1)}}d.useEffect(()=>{if(!k.current)return k.current=!0,F(!1,h||void 0),()=>{S.current&&(clearInterval(S.current),S.current=null)}},[]);const B=X=>{const he={materialIssue:"Material Issue",semiQc:"Semi QC",phosphatingQc:"Phosphating QC",svs:"SVS",testing1:"Testing-1",testing2:"Testing-2",marking1:"Marking-1",marking2:"Marking-2",pdi1:"PDI-1",pdi2:"PDI-2",tpi:"TPI",dispatch:"Dispatch"};return he[X]?he[X]:X.startsWith("assembly")?"Assembly Line "+X.slice(-1).toUpperCase():X},q={materialIssue:"purple",semiQc:"yellow",phosphatingQc:"orange",svs:"green",testing1:"blue",testing2:"blue",marking1:"teal",marking2:"teal",pdi1:"violet",pdi2:"violet",tpi:"rose",dispatch:"green"},me=Object.keys(q),re=["assemblyA","assemblyB","assemblyC","assemblyD"],M={Planning:e.jsx(ik,{}),MaterialIssue:e.jsx(rf,{}),SemiQC:e.jsx(nf,{}),Phosphating:e.jsx(af,{}),AssemblyA:e.jsx(lf,{}),AssemblyB:e.jsx(of,{}),AssemblyC:e.jsx(cf,{}),AssemblyD:e.jsx(df,{}),Testing1:e.jsx(uf,{}),Testing2:e.jsx(mf,{}),SVS:e.jsx(hf,{}),Marking1:e.jsx(pf,{}),Marking2:e.jsx(xf,{}),PDI1:e.jsx(ff,{}),PDI2:e.jsx(gf,{}),TPI:e.jsx(yf,{}),Dispatch:e.jsx(vf,{})};if(s!=="Dashboard")return e.jsx(e.Fragment,{children:M[s]});const W=d.useMemo(()=>n.totalOrders!=null?Number(n.totalOrders):[...me,...re].reduce((he,ue)=>he+Number(n[ue]||0),0),[n]),oe=X=>{if(!X)return!1;const he=parseFloat(X.replace("%",""));return!isNaN(he)&&he>=0};return e.jsx("div",{className:"page-container",children:e.jsxs("div",{className:"max-w-7xl mx-auto py-10 px-6 space-y-10 main-content",children:[e.jsxs("div",{className:"top-title",children:[e.jsxs("h1",{className:"text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-[#174a9f] to-[#1a5cb8] rounded-xl shadow-lg",children:e.jsx(Wi,{className:"h-6 w-6 text-white"})}),"Dashboard Overview",e.jsxs("button",{className:"ml-4 flex items-center px-3 py-1 border rounded-md",onClick:()=>{S.current&&(clearInterval(S.current),S.current=null),F(!0,h||void 0)},children:[e.jsx(tw,{className:"h-4 w-4 mr-1"}),"Refresh"]})]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Real-time insights into your manufacturing operations"})]}),e.jsx(e.Fragment,{children:u||l?e.jsx("div",{className:"text-center font-700",children:"Loading...."}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(nx,{title:"Total Orders",value:W,icon:Wi,gradient:"blue",change:{value:String(n.totalOrdersCompare??""),positive:oe(n.totalOrdersCompare)},trend:[30,40,50,60,80]}),e.jsx(nx,{title:"In Progress",value:n.inProgress??0,icon:bu,gradient:"orange",change:{value:String(n.inProgressCompare??""),positive:oe(n.inProgressCompare)},trend:[20,30,40,60,75]}),e.jsx(nx,{title:"Completed",value:n.completed??0,icon:Z1,gradient:"green",change:{value:String(n.completedCompare??""),positive:oe(n.completedCompare)},trend:[40,50,70,90,100]})]})}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h2",{className:"text-gray-900 flex items-center gap-2 top-title",children:[e.jsx(bu,{className:"h-5 w-5 text-[#174a9f]"}),"Stage-wise Pending Quantity"]})}),u||l?e.jsx("div",{className:"text-center font-700",children:"Loading..."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:me.map(X=>{const he=q[X];return e.jsx(Ma,{className:`p-4 rounded-xl border bg-gradient-to-br from-${he}-50 to-white border-${he}-200 hover:-translate-y-1 hover:shadow-lg transition`,children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("div",{className:`p-2 rounded-lg bg-${he}-100`,children:e.jsx(Wi,{className:`h-4 w-4 text-${he}-600`})}),e.jsx(qs,{className:`bg-${he}-100 text-${he}-700 border-${he}-200 text-xs`,children:"Pending"})]}),e.jsx("p",{className:"text-gray-700 text-xs",children:B(X)}),e.jsx("p",{className:`text-xl font-semibold text-${he}-900`,children:n[X]??0})]})},X)})})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-gray-900 flex items-center gap-2 top-title",children:[e.jsx(bu,{className:"text-[#174a9f] pt-5 mt-5"}),"Assembly Line-wise Pending Quantity"]}),u||l?e.jsx("div",{className:"text-center font-700",children:"Loading...."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:re.map(X=>e.jsx(Ma,{className:"p-4 rounded-xl border bg-gradient-to-br from-purple-50 to-white border-purple-200 hover:-translate-y-1 hover:shadow-lg transition",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-100",children:e.jsx(Wi,{className:"h-4 w-4 text-purple-600"})}),e.jsx(qs,{className:"bg-purple-100 text-purple-700 border-purple-200 text-xs",children:"Pending"})]}),e.jsx("p",{className:"text-gray-700 text-xs",children:B(X)}),e.jsx("p",{className:"text-xl font-semibold text-purple-900",children:n[X]??0})]})},X))})]})]})})}const Uz="modulepreload",Vz=function(t){return"/"+t},n1={},Wz=function(s,r,n){let a=Promise.resolve();if(r&&r.length>0){let c=function(h){return Promise.all(h.map(v=>Promise.resolve(v).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=u?.nonce||u?.getAttribute("nonce");a=c(r.map(h=>{if(h=Vz(h),h in n1)return;n1[h]=!0;const v=h.endsWith(".css"),w=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${w}`))return;const j=document.createElement("link");if(j.rel=v?"stylesheet":Uz,v||(j.as="script"),j.crossOrigin="",j.href=h,f&&j.setAttribute("nonce",f),document.head.appendChild(j),v)return new Promise((C,k)=>{j.addEventListener("load",C),j.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return a.then(c=>{for(const u of c||[])u.status==="rejected"&&l(u.reason);return s().catch(l)})},Gz=`${qt}/customer-support`;function ok(){const t=Z=>{if(!Z)return"";const[Ze,nt,Ke]=Z.split("-");return`${Ke}-${nt}-${Ze}`},[s,r]=d.useState(""),[n,a]=d.useState("all"),[l,c]=d.useState("all"),[u,f]=d.useState(null),[h,v]=d.useState(!1),[w,j]=d.useState({}),[C,k]=d.useState(!1),[S,_]=d.useState(null),[I,F]=d.useState(null),[B,q]=d.useState(1),[me,re]=d.useState(100),[M,W]=d.useState({}),[oe,X]=d.useState(!1),[he,ue]=d.useState([]),_e=localStorage.getItem("token"),ke=d.useMemo(()=>{let Z="";try{const nt=localStorage.getItem("user")||localStorage.getItem("userData");if(nt){const Ke=JSON.parse(nt),kt=typeof Ke?.role=="object"?Ke.role?.name:Ke?.role;Z=String(kt||"").toLowerCase()}}catch{}return Zb().map(nt=>({key:nt,display:rt(nt)}))},[]),Re=d.useMemo(()=>{const Z={};return Zb().forEach(Ze=>{const nt=rt(Ze).replace(/-/g," ").replace(/\s+/g," ").trim().toLowerCase();Z[nt]=Ze}),Z["phosphating qc"]="phosphating",Z["after phosphating qc"]="phosphating",Z},[]),Y=Z=>{const Ze=String(Z).replace(/-/g," ").replace(/\s+/g," ").trim().toLowerCase();return Re[Ze]||Ze.replace(/\s+/g,"-")||"planning"},ve=Z=>{const Ze=Z.status||Z.stage||Z.stage_name||Z.current_stage||Z.menu_name||"Planning",nt=Y(Ze),Ke={};return Object.entries(Z.stage_progress||{}).forEach(([kt,wt])=>{const $t=kt.replace(/-/g," ").replace(/\s+/g," ").trim();Ke[$t]=wt}),{id:String(Z.id),assemblyLine:Z.assembly_no||"",gmsoaNo:Z.soa_no||"",soaSrNo:Z.soa_sr_no||"",assemblyDate:Z.assembly_date||"",uniqueCode:Z.unique_code||Z.order_no||"",splittedCode:Z.splitted_code||"",party:Z.party_name||Z.party||"",customerPoNo:Z.customer_po_no||"",codeNo:Z.code_no||"",product:Z.product||"",totalQty:Number(Z.totalQty||Z.total_qty||Z.qty||0),qty:Number(Z.qty||0),qtyExe:Number(Z.qty_executed||0),qtyPending:Number(Z.qty_pending||0),poQty:Number(Z.po_qty||0),finishedValve:Z.finished_valve||"",gmLogo:Z.gm_logo||"",namePlate:Z.name_plate||"",specialNotes:Z.special_notes||Z.special_note||"",productSpcl1:Z.product_spc1||"",productSpcl2:Z.product_spc2||"",productSpcl3:Z.product_spc3||"",inspection:Z.inspection||"",painting:Z.painting||"",remarks:Z.remarks||"",alertStatus:Z.is_urgent===!0||Z.is_urgent==="true"||Z.alert_status===!0||Z.alert_status==="true"||Z.urgent===1||Z.urgent==="1",expectedDeliveryDate:(()=>{const kt=Z.deliveryDate||Z.expected_delivery_date||Z.expectedDeliveryDate||Z.delivery_date||"";if(typeof kt=="string"&&/^\d{2}-\d{2}-\d{4}$/.test(kt)){const[wt,$t,At]=kt.split("-");return`${At}-${$t}-${wt}`}return kt})(),stage:Ze,stageKey:nt,workflowHistory:Z.workflowHistory||[],stageProgress:Ke}},Q=async Z=>{try{const nt=(await ht.post(`${qt}/order-history`,{per_page:20,current_page:1,orderId:Z.id},{headers:{Authorization:`Bearer ${_e}`}}))?.data?.splits||{},Ke=Object.values(nt).flat();ue(Array.isArray(Ke)?Ke:[]),X(!0)}catch(Ze){console.error("Error fetching order history",Ze),ue([]),X(!0)}},be=d.useRef(!1),[pe,ne]=d.useState(!1),U=async()=>{if(be.current)return;be.current=!0,ne(!0),k(!0),_(null);const Z={};try{const Ze=tt(n),nt={per_page:1e3,current_page:1};Ze&&(nt.stage=Ze);const Ke=await ht.post(Gz,nt,{headers:{Authorization:`Bearer ${_e}`}}),wt=(Array.isArray(Ke?.data?.data)?Ke.data.data:[]).map(($t,At)=>{const Vt=ve($t);return{...Vt,expectedDeliveryDate:Vt.expectedDeliveryDate||"",originalIndex:At}});F(Ke?.data?.counts||null),wt.forEach($t=>{const At=$t.stageKey||"planning";Z[At]||(Z[At]=[]),Z[At].push($t)})}catch(Ze){console.warn("GET /customer-support failed",Ze)}W(Z),j({}),k(!1),ne(!1),be.current=!1},ce=async(Z,Ze)=>{try{const nt=new FormData;nt.append("orderId",String(Z.id)),nt.append("unique_code",Z.uniqueCode),nt.append("date",t(Ze)),(await ht.post(`${qt}/add-delivery-date`,nt,{headers:{Authorization:`Bearer ${_e}`}}))?.data?.Resp_code&&(await U(),j(kt=>{const wt={...kt};return delete wt[Z.uniqueCode],wt}))}catch(nt){console.error("Date save failed:",nt)}};d.useEffect(()=>{U()},[n,l]),M.planning;const z=M["material-issue"]||[],ae=M["semi-qc"]||[],ye=M.phosphating||[],fe=M["assembly-a"]||[],Ee=M["assembly-b"]||[],Le=M["assembly-c"]||[],De=M["assembly-d"]||[],Ve=[...fe,...Ee,...Le,...De],et=M.testing1||[],Nt=M.testing2||[],ot=M.svs||[],Qt=[...M.marking1||[],...M.marking2||[]],qe=M.pdi1||[],Me=M.pdi2||[],mt=M.tpi||[],it=M.dispatch||[],Et=d.useMemo(()=>Object.values(M).flat().map(Z=>({...Z,stageKey:Z.stageKey,currentStage:Z.stage||rt(Z.stageKey)})).sort((Z,Ze)=>(Z.originalIndex??0)-(Ze.originalIndex??0)),[M]),pt=he.reduce((Z,Ze)=>{const nt=Ze.split_code||"UNKNOWN";return Z[nt]||(Z[nt]=[]),Z[nt].push(Ze),Z},{}),xe=d.useMemo(()=>Et.filter(Z=>{const Ze=s.toLowerCase(),nt=Z.uniqueCode.toLowerCase().includes(Ze)||Z.gmsoaNo.toLowerCase().includes(Ze)||Z.party.toLowerCase().includes(Ze)||Z.customerPoNo.toLowerCase().includes(Ze)||Z.product.toLowerCase().includes(Ze)||Z.codeNo.toLowerCase().includes(Ze),Ke=l==="all"||Z.assemblyLine===l;return nt&&Ke}),[Et,s,l]),tt=Z=>Z==="all"?"":rt(Z),lt=d.useMemo(()=>{const Z=(B-1)*me;return xe.slice(Z,Z+me)},[xe,B,me]);d.useEffect(()=>{q(1)},[s,n,l]);const Ue=d.useMemo(()=>{const Z=I?.totalOrders??Et.length,Ze=I?.totalQty??Et.reduce((N,P)=>N+(P.totalQty||0),0),nt=I?.completeOrders??Et.reduce((N,P)=>N+P.qtyExe,0),Ke=I?.pendingQty??Et.reduce((N,P)=>N+P.qtyPending,0),kt=I?.urgentOrders??Et.filter(N=>N.alertStatus).length,wt=z.reduce((N,P)=>N+P.qtyPending,0),$t=ae.reduce((N,P)=>N+P.qtyPending,0),At=ye.reduce((N,P)=>N+P.qtyPending,0),Vt=Ve.reduce((N,P)=>N+P.qtyPending,0),Ot=fe.reduce((N,P)=>N+P.qtyPending,0),yt=Ee.reduce((N,P)=>N+P.qtyPending,0),Ge=Le.reduce((N,P)=>N+P.qtyPending,0),St=De.reduce((N,P)=>N+P.qtyPending,0),Ct=et.reduce((N,P)=>N+P.qtyPending,0),Zt=Nt.reduce((N,P)=>N+P.qtyPending,0),_t=ot.reduce((N,P)=>N+P.qtyPending,0),Ut=Qt.reduce((N,P)=>N+P.qtyPending,0),Kt=(M.testing1||[]).reduce((N,P)=>N+P.qtyPending,0),Bt=(M.testing2||[]).reduce((N,P)=>N+P.qtyPending,0),Xt=(M.marking1||[]).reduce((N,P)=>N+P.qtyPending,0),as=(M.marking2||[]).reduce((N,P)=>N+P.qtyPending,0),ds=qe.reduce((N,P)=>N+P.qtyPending,0),ls=Me.reduce((N,P)=>N+P.qtyPending,0),us=mt.reduce((N,P)=>N+P.qtyPending,0),V=it.reduce((N,P)=>N+P.qtyPending,0),ie=["A","B","C","D","S"],K={};ie.forEach(N=>{K[N]=Et.filter(P=>P.assemblyLine===N).reduce((P,R)=>P+R.qtyPending,0)});const ee=N=>({inProgress:N.filter(P=>P.qtyExe>0&&P.qtyPending>0).length,done:N.filter(P=>P.qtyPending===0&&(P.totalQty>0||P.qtyExe>0)).length}),de=ee(z),le=ee(ae),Pe=ee(ye),Be=ee(Ve),Te=ee(fe),je=ee(Ee),Ce=ee(Le),Fe=ee(De),We=ee(M.testing1||[]),ge=ee(M.testing2||[]),G=ee(ot),T=ee(M.marking1||[]),x=ee(M.marking2||[]),A=ee(qe),g=ee(Me),p=ee(mt),y=ee(it);return{totalOrders:Z,totalQty:Ze,totalCompleted:nt,totalPending:Ke,alertCount:kt,materialIssuePending:wt,semiQcPending:$t,phosphatingQcPending:At,assemblyPending:Vt,assemblyAPending:Ot,assemblyBPending:yt,assemblyCPending:Ge,assemblyDPending:St,testingPending:Ct,testingPending2:Zt,svsPending:_t,markingPending:Ut,testing1Pending:Kt,testing2Pending:Bt,marking1Pending:Xt,marking2Pending:as,pdi1Pending:ds,pdi2Pending:ls,tpiPending:us,dispatchPending:V,materialIssueCounts:de,semiQcCounts:le,phosphatingCounts:Pe,assemblyCounts:Be,assemblyACounts:Te,assemblyBCounts:je,assemblyCCounts:Ce,assemblyDCounts:Fe,testing1Counts:We,testing2Counts:ge,svsCounts:G,marking1Counts:T,marking2Counts:x,pdi1Counts:A,pdi2Counts:g,tpiCounts:p,dispatchCounts:y,assemblyLinePending:K}},[Et,M]),He=Z=>{f(Z),v(!0)},zt=()=>{Wz(()=>import("./exceljs.min-L5ATBYIY.js").then(Z=>Z.e),[]).then(async Z=>{const Ze=Z.default||Z,nt=new Ze.Workbook,Ke=nt.addWorksheet("Customer Support"),kt=new Date,wt=kt.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),$t=kt.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0});Ke.columns=[{header:"Assembly Line",key:"assemblyLine",width:15},{header:"GMSOA NO.",key:"gmsoaNo",width:12},{header:"SOA SR NO.",key:"soaSrNo",width:12},{header:"Assembly Date",key:"assemblyDate",width:15},{header:"Party",key:"party",width:30},{header:"Order No.",key:"orderNo",width:15},{header:"Code No.",key:"codeNo",width:25},{header:"Product",key:"product",width:50},{header:"Qty",key:"qty",width:8},{header:"Qty Executed",key:"qtyExecuted",width:12},{header:"Qty Pending",key:"qtyPending",width:12},{header:"Planning",key:"planning",width:14},{header:"Material Issue",key:"materialIssue",width:15},{header:"Semi QC",key:"semiQc",width:12},{header:"Phosphating QC",key:"phosphating",width:15},{header:"Assembly A",key:"assemblyA",width:12},{header:"Assembly B",key:"assemblyB",width:12},{header:"Assembly C",key:"assemblyC",width:12},{header:"Assembly D",key:"assemblyD",width:12},{header:"Testing1",key:"testing1",width:12},{header:"Testing2",key:"testing2",width:12},{header:"SVS",key:"svs",width:10},{header:"Marking1",key:"marking1",width:12},{header:"Marking2",key:"marking2",width:12},{header:"PDI1",key:"pdi1",width:12},{header:"PDI2",key:"pdi2",width:12},{header:"TPI",key:"tpi",width:10},{header:"Dispatch",key:"dispatch",width:12}],Ke.spliceRows(1,0,[],[],[]),Ke.getCell("A1").value="Date",Ke.getCell("B1").value=wt,Ke.getCell("A1").font={bold:!0,size:12},Ke.getCell("B1").font={size:12},Ke.getCell("A2").value="Time",Ke.getCell("B2").value=$t,Ke.getCell("A2").font={bold:!0,size:12},Ke.getCell("B2").font={size:12};const At=Ke.getRow(4);At.height=20,At.font={bold:!0,size:11},At.alignment={vertical:"middle",horizontal:"center"};const Vt={12:"DBEAFE",13:"E9D5FF",14:"FEF3C7",15:"FED7AA",16:"E0E7FF",17:"E0E7FF",18:"E0E7FF",19:"E0E7FF",20:"FCE7F3",21:"FCE7F3",22:"D1FAE5",23:"CCFBF1",24:"CCFBF1",25:"F3F4F6",26:"F3F4F6",27:"FFE4E6",28:"DCFCE7"};At.eachCell((_t,Ut)=>{_t.fill={type:"pattern",pattern:"solid",fgColor:{argb:Vt[Ut]?"FF"+Vt[Ut]:"FFF3F4F6"}},_t.border={top:{style:"thin",color:{argb:"FFD1D5DB"}},left:{style:"thin",color:{argb:"FFD1D5DB"}},bottom:{style:"thin",color:{argb:"FFD1D5DB"}},right:{style:"thin",color:{argb:"FFD1D5DB"}}}}),xe.forEach(_t=>{Ke.addRow({assemblyLine:_t.assemblyLine,gmsoaNo:_t.gmsoaNo,soaSrNo:_t.soaSrNo,assemblyDate:_t.assemblyDate,party:_t.party,orderNo:_t.customerPoNo,codeNo:_t.codeNo,product:_t.product,qty:_t.totalQty,qtyExecuted:_t.qtyExe,qtyPending:_t.qtyPending,planning:ct(_t,rt("planning")),materialIssue:ct(_t,rt("material-issue")),semiQc:ct(_t,rt("semi-qc")),phosphating:ct(_t,rt("phosphating")),assemblyA:ct(_t,rt("assembly-a")),assemblyB:ct(_t,rt("assembly-b")),assemblyC:ct(_t,rt("assembly-c")),assemblyD:ct(_t,rt("assembly-d")),testing1:ct(_t,rt("testing1")),testing2:ct(_t,rt("testing2")),svs:ct(_t,rt("svs")),marking1:ct(_t,rt("marking1")),marking2:ct(_t,rt("marking2")),pdi1:ct(_t,rt("pdi1")),pdi2:ct(_t,rt("pdi2")),tpi:ct(_t,rt("tpi")),dispatch:ct(_t,rt("dispatch")),materialIssueLegacy:ct(_t,"Material Issue"),semiQcLegacy:ct(_t,"Semi QC"),phosphatingQcLegacy:ct(_t,"After Phosphating QC"),assemblyLegacy:ct(_t,"Assembly"),testingLegacy:ct(_t,"Testing"),svsLegacy:ct(_t,"SVS"),markingLegacy:ct(_t,"Marking")})}),Ke.eachRow((_t,Ut)=>{Ut>3&&_t.eachCell((Kt,Bt)=>{if(Kt.alignment={vertical:"middle",horizontal:"left"},Kt.border={top:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}},Bt>=12&&Bt<=28){const Xt=Kt.value;Xt==="OK"?(Kt.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF86EFAC"}},Kt.font={bold:!0,color:{argb:"FF166534"}},Kt.alignment={vertical:"middle",horizontal:"center"}):Xt==="IN PROCESS"?(Kt.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF93C5FD"}},Kt.font={bold:!0,color:{argb:"FF1E40AF"}},Kt.alignment={vertical:"middle",horizontal:"center"}):Kt.alignment={vertical:"middle",horizontal:"center"}}})});const yt=`Customer_Support_Export_${new Date().toISOString().split("T")[0]}.xlsx`,Ge=await nt.xlsx.writeBuffer(),St=new Blob([Ge],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Ct=window.URL.createObjectURL(St),Zt=document.createElement("a");Zt.href=Ct,Zt.download=yt,Zt.click(),window.URL.revokeObjectURL(Ct)}).catch(Z=>{console.error("Error exporting data:",Z),alert("Failed to export data. Please try again.")})},gt=Z=>({Planning:"bg-blue-100 text-blue-700 border-blue-200","Material Issue":"bg-purple-100 text-purple-700 border-purple-200","Semi QC":"bg-yellow-100 text-yellow-700 border-yellow-200",Phosphating:"bg-orange-100 text-orange-700 border-orange-200","Phosphating QC":"bg-orange-100 text-orange-700 border-orange-200","Assembly A":"bg-indigo-100 text-indigo-700 border-indigo-200","Assembly B":"bg-indigo-100 text-indigo-700 border-indigo-200","Assembly C":"bg-indigo-100 text-indigo-700 border-indigo-200","Assembly D":"bg-indigo-100 text-indigo-700 border-indigo-200",Testing1:"bg-pink-100 text-pink-700 border-pink-200",Testing2:"bg-pink-100 text-pink-700 border-pink-200",SVS:"bg-green-100 text-green-700 border-green-200",Marking1:"bg-teal-100 text-teal-700 border-teal-200",Marking2:"bg-teal-100 text-teal-700 border-teal-200",PDI1:"bg-gray-100 text-gray-700 border-gray-200",PDI2:"bg-gray-100 text-gray-700 border-gray-200",TPI:"bg-rose-100 text-rose-700 border-rose-200",Dispatch:"bg-emerald-100 text-emerald-700 border-emerald-200"})[Z]||"bg-gray-100 text-gray-700 border-gray-200",jt=Z=>Z==="Phosphating QC"?"Phosphating":Z,ct=(Z,Ze)=>{const nt=Z.stageProgress||{},Ke=jt(Ze),kt=Ze.replace(/-/g," ").replace(/\s+/g," ").trim(),wt=nt[kt]||nt[kt.toUpperCase()]||nt[kt.toLowerCase()]||nt[Ke];if(wt!=null){const Ot=String(wt).trim().toLowerCase().replace(/\s+/g,"_");if(Ot==="ok")return"OK";if(Ot==="pending")return"pending";if(Ot==="in_progress"||Ot==="inprogress")return"IN PROCESS";if(Ot==="skip")return"SKIP"}if(!Z.workflowHistory)return"";const $t=Ot=>String(Ot||"").toLowerCase().replace(/-/g," ").replace(/\s+/g," ").trim().replace(/\s+qc$/,""),At=$t(Ze),Vt=Z.workflowHistory.findIndex(Ot=>$t(Ot.stage)===At);return Vt===-1?"":Z.workflowHistory[Vt].exitedAt?"OK":$t(Z.currentStage)===At?"IN PROCESS":""},Yt=Z=>{const Ze=Z?.toLowerCase();return Ze==="ok"?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 border border-green-200 rounded text-xs font-medium",children:"OK"})}):Ze==="in process"||Ze==="in_progress"?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 border border-purple-200 rounded text-xs font-medium",children:"In Progress"})}):Ze==="pending"?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 border border-blue-200 rounded text-xs font-medium",children:"Pending"})}):Ze==="skip"?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 border border-gray-300 rounded text-xs font-medium",children:"Skip"})}):e.jsx("div",{className:"text-center text-gray-300",children:"-"})};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:Z=>{window.location.href=`/${Z.toLowerCase()}`},onUploadSuccess:()=>U()}),e.jsxs("div",{className:"p-6 max-w-[1920px] mx-auto space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between ctm-wrap",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-[#174a9f] to-[#1a5cb8] rounded-xl shadow-lg",children:e.jsx(Wi,{className:"h-6 w-6 text-white"})}),"Customer Support"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive view of all orders across all workflow stages"})]}),e.jsxs(J,{onClick:U,disabled:pe||C,className:"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50",children:[e.jsx(tw,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs(J,{disabled:xe.length===0,onClick:zt,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx(Ma,{className:"p-4 bg-white/70 backdrop-blur-sm border-gray-200 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(Wi,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Total Orders"}),e.jsx("p",{className:"text-2xl text-gray-900",children:Ue.totalOrders})]})]})}),e.jsx(Ma,{className:"p-4 bg-white/70 backdrop-blur-sm border-gray-200 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-indigo-100 rounded-xl",children:e.jsx(Wi,{className:"h-5 w-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Total Quantity"}),e.jsx("p",{className:"text-2xl text-gray-900",children:Ue.totalQty})]})]})}),e.jsx(Ma,{className:"p-4 bg-white/70 backdrop-blur-sm border-gray-200 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(Z1,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Completed"}),e.jsx("p",{className:"text-2xl text-gray-900",children:Ue.totalCompleted})]})]})}),e.jsx(Ma,{className:"p-4 bg-white/70 backdrop-blur-sm border-gray-200 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-xl",children:e.jsx(bu,{className:"h-5 w-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Pending"}),e.jsx("p",{className:"text-2xl text-gray-900",children:Ue.totalPending})]})]})}),e.jsx(Ma,{className:"p-4 bg-white/70 backdrop-blur-sm border-gray-200 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-red-100 rounded-xl",children:e.jsx(dv,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Urgent"}),e.jsx("p",{className:"text-2xl text-gray-900",children:Ue.alertCount})]})]})})]}),e.jsx(Ma,{className:"p-4 bg-white/70 backdrop-blur-sm border-gray-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(sw,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Js,{placeholder:"Search by Order ID, SOA NO., Party, Customer PO, Product, or Code No...",value:s,onChange:Z=>r(Z.target.value),className:"pl-10 border-gray-300 focus:border-[#174a9f] focus:ring-[#174a9f]"})]}),e.jsxs(sr,{value:n,onValueChange:a,children:[e.jsx(nr,{className:"w-full md:w-[200px] border-gray-300",children:e.jsx(rr,{placeholder:"Filter by Stage"})}),e.jsxs(ar,{children:[e.jsx(Es,{value:"all",children:"All Stages"}),ke.map(Z=>e.jsx(Es,{value:Z.key,children:Z.display},Z.key))]})]}),e.jsxs(sr,{value:l,onValueChange:c,children:[e.jsx(nr,{className:"w-full md:w-[200px] border-gray-300",children:e.jsx(rr,{placeholder:"Filter by Line"})}),e.jsxs(ar,{children:[e.jsx(Es,{value:"all",children:"All Lines"}),e.jsx(Es,{value:"A",children:"Line A"}),e.jsx(Es,{value:"B",children:"Line B"}),e.jsx(Es,{value:"C",children:"Line C"}),e.jsx(Es,{value:"D",children:"Line D"})]})]})]})}),e.jsx(Ma,{className:"bg-white/70 backdrop-blur-sm border-gray-200 overflow-hidden",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{className:"bg-gradient-to-r from-[#174a9f]/10 to-indigo-50/50 border-b border-gray-200",children:[e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 sticky left-0 bg-gradient-to-r from-[#174a9f]/10 to-indigo-50/50 z-10 ctm-opacity",children:"Assembly Line"}),e.jsx("th",{className:"px-4 py-3 text-gray-700 truncate text-center",children:"SOA NO."}),e.jsx("th",{className:"px-4 py-3 text-gray-700 text-center truncate",children:"SR.NO."}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 truncate text-center",children:"Assembly Date"}),e.jsx("th",{className:"px-4 py-3 text-gray-700 truncate text-center",children:"Unique Code"}),e.jsx("th",{className:"px-4 py-3 text-gray-700 truncate text-center",children:"Party"}),e.jsx("th",{className:"px-4 py-3 text-gray-700 truncate text-center",children:"Order No."}),e.jsx("th",{className:"px-4 py-3 text-gray-700 truncate text-center",children:"Code No."}),e.jsx("th",{className:"px-4 py-3 text-gray-700 truncate text-center",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 truncate text-center",children:"PO Qty"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-sky-50/80 truncate text-center",children:"Expected Delivery Date"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 truncate text-center",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 truncate text-center",children:"Qty Executed"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700",children:"Qty Pending"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-blue-50/80",children:"Planning"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-purple-50/80",children:"Material Issue"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-yellow-50/80",children:"Semi QC"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-orange-50/80",children:"Phosphating QC"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-indigo-50/80",children:"Assembly A"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-indigo-50/80",children:"Assembly B"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-indigo-50/80",children:"Assembly C"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-indigo-50/80",children:"Assembly D"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-pink-50/80",children:"Testing1"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-pink-50/80",children:"Testing2"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-green-50/80",children:"SVS"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-teal-50/80",children:"Marking1"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-teal-50/80",children:"Marking2"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-gray-50/80",children:"PDI1"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-gray-50/80",children:"PDI2"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-rose-50/80",children:"TPI"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-emerald-50/80",children:"Dispatch"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:C?e.jsx("tr",{children:e.jsx("td",{colSpan:30,className:"px-4 py-12 text-center text-gray-500",children:"Loading..."})}):xe.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:30,className:"px-4 py-12 text-center text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(ew,{className:"h-12 w-12 text-gray-400"}),e.jsx("p",{children:"No orders found matching your criteria"})]})})}):lt.map(Z=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-blue-50/50 transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3 sticky left-0 bg-white hover:bg-blue-50/50 z-10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[Z.alertStatus&&e.jsx(dv,{className:"h-4 w-4 text-red-500 animate-pulse-soft"}),e.jsx(qs,{className:"bg-gray-100 text-gray-700 border-gray-200",children:Z.assemblyLine})]})}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700",children:Z.gmsoaNo}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700",children:Z.soaSrNo}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700 truncate",children:Z.assemblyDate}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700 truncate",children:Z.uniqueCode}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700 max-w-[200px] truncate",title:Z.party,children:Z.party}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700",children:Z.customerPoNo}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700",children:Z.codeNo}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700 max-w-[300px] truncate",title:Z.product,children:Z.product}),e.jsx("td",{className:"px-4 py-3 text-center",children:Z.poQty}),e.jsxs("td",{className:"px-4 py-3 bg-sky-50/30 text-center",children:[e.jsx(Js,{type:"date",value:w[Z.uniqueCode]?w[Z.uniqueCode]:Z.expectedDeliveryDate||"",onChange:Ze=>{const nt=Ze.target.value;ce(Z,nt),j(Ke=>({...Ke,[Z.uniqueCode]:nt}))},className:"w-40 mx-auto text-sm border-gray-300"}),(w[Z.uniqueCode]||Z.expectedDeliveryDate)&&e.jsx("div",{className:"text-xs text-gray-600 mt-1 hidden",children:(()=>{const Ze=w[Z.uniqueCode]||Z.expectedDeliveryDate;if(!Ze)return"";const[nt,Ke,kt]=Ze.split("-");return`${kt}-${Ke}-${nt}`})()})]}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(qs,{className:"bg-blue-100 text-blue-700 border-blue-200",children:Z.totalQty})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(qs,{className:Z.qtyPending===0?"bg-blue-100 text-blue-700 border-blue-200":"bg-green-100 text-green-700 border-green-200",children:Z.qtyExe})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(qs,{className:Z.qtyPending===0?"bg-blue-100 text-blue-700 border-blue-200":"bg-orange-100 text-orange-700 border-orange-200",children:Z.qtyPending})}),e.jsx("td",{className:"px-4 py-3 bg-blue-50/30 truncate",children:Yt(ct(Z,rt("planning")))}),e.jsx("td",{className:"px-4 py-3 bg-purple-50/30 truncate",children:Yt(ct(Z,rt("material-issue")))}),e.jsx("td",{className:"px-4 py-3 bg-yellow-50/30 truncate",children:Yt(ct(Z,rt("semi-qc")))}),e.jsx("td",{className:"px-4 py-3 bg-orange-50/30 truncate",children:Yt(ct(Z,rt("phosphating")))}),e.jsx("td",{className:"px-4 py-3 bg-indigo-50/30 truncate",children:Yt(ct(Z,rt("assembly-a")))}),e.jsx("td",{className:"px-4 py-3 bg-indigo-50/30 truncate",children:Yt(ct(Z,rt("assembly-b")))}),e.jsx("td",{className:"px-4 py-3 bg-indigo-50/30 truncate",children:Yt(ct(Z,rt("assembly-c")))}),e.jsx("td",{className:"px-4 py-3 bg-indigo-50/30 truncate",children:Yt(ct(Z,rt("assembly-d")))}),e.jsx("td",{className:"px-4 py-3 bg-pink-50/30 truncate",children:Yt(ct(Z,rt("testing1")))}),e.jsx("td",{className:"px-4 py-3 bg-pink-50/30 truncate",children:Yt(ct(Z,rt("testing2")))}),e.jsx("td",{className:"px-4 py-3 bg-green-50/30 truncate",children:Yt(ct(Z,rt("svs")))}),e.jsx("td",{className:"px-4 py-3 bg-teal-50/30 truncate",children:Yt(ct(Z,rt("marking1")))}),e.jsx("td",{className:"px-4 py-3 bg-teal-50/30 truncate",children:Yt(ct(Z,rt("marking2")))}),e.jsx("td",{className:"px-4 py-3 bg-gray-50/30 truncate",children:Yt(ct(Z,rt("pdi1")))}),e.jsx("td",{className:"px-4 py-3 bg-gray-50/30 truncate",children:Yt(ct(Z,rt("pdi2")))}),e.jsx("td",{className:"px-4 py-3 bg-rose-50/30 truncate",children:Yt(ct(Z,rt("tpi")))}),e.jsx("td",{className:"px-4 py-3 bg-emerald-50/30 truncate",children:Yt(ct(Z,rt("dispatch")))}),e.jsxs("td",{className:"px-4 py-3 text-center truncate",children:[e.jsx(J,{size:"sm",variant:"ghost",onClick:()=>He(Z),className:"hover:bg-[#174a9f]/10 hover:text-[#174a9f]",children:e.jsx(Ys,{className:"h-4 w-4"})}),e.jsx(J,{size:"sm",variant:"ghost",onClick:()=>Q(Z),className:"hover:bg-[#174a9f]/10 hover:text-[#174a9f]",children:e.jsx(mv,{className:"h-4 w-4"})})]})]},`${Z.id}-${Z.uniqueCode}-${Math.random()}`))})]})})}),e.jsx(cr,{page:B,perPage:me,total:xe.length,lastPage:Math.max(1,Math.ceil(xe.length/Math.max(me,1))),onChangePage:q,onChangePerPage:re,disabled:C}),e.jsxs("div",{className:"text-center text-gray-600 text-sm",children:["Showing ",xe.length," of ",Et.length," orders"]}),e.jsx(Rt,{open:h,onOpenChange:v,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",u?.uniqueCode]})]}),u&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.qty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.gmLogo||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.namePlate||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special Notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.inspection||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.painting||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.remarks||"-"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>v(!1),children:"Close"})})]})}),e.jsx(Rt,{open:oe,onOpenChange:X,children:e.jsxs(Tt,{className:"max-w-[800px] w-full modal-main overflow-y-auto rounded-xl shadow-lg flex flex-col",children:[e.jsxs(Dt,{children:[e.jsxs(Lt,{className:"text-xl flex items-center gap-2",children:[e.jsx(mv,{className:"h-5 w-5 text-[#174a9f]"}),"Order History"]}),e.jsx(Mt,{className:"text-gray-600",children:"Stage-by-stage workflow with timestamps and quantities."})]}),e.jsx("div",{className:"border rounded-lg bg-white",children:e.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 text-sm border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left w-[25%]",children:"Split Code"}),e.jsx("th",{className:"px-4 py-3 text-left w-[40%]",children:"Stage / Time"}),e.jsx("th",{className:"px-4 py-3 text-center w-[20%]",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-center w-[20%]",children:"Assigned"}),e.jsx("th",{className:"px-4 py-3 text-center w-[20%]",children:"Duration"})]})}),e.jsx("tbody",{className:"text-sm",children:Object.keys(pt).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center text-gray-500 py-4",children:"No history found"})}):Object.entries(pt).flatMap(([Z,Ze])=>Ze.map((nt,Ke)=>e.jsxs("tr",{className:"border-b hover:bg-blue-50/40 transition",children:[e.jsx("td",{className:"px-4 py-4 font-semibold text-blue-700",children:Z}),e.jsxs("td",{className:"px-4 py-4 align-top",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium border ${gt(nt.currentStage)}`,children:nt.currentStage}),e.jsxs("div",{className:"text-xs text-gray-700 mt-1",children:[e.jsx("div",{children:nt.entered}),nt.exited&&e.jsx("div",{children:nt.exited})]})]}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 border border-blue-200 rounded text-xs font-medium",children:nt.qty})}),e.jsx("td",{className:"px-4 py-4 text-center",children:nt.assigned_qty==="-"||nt.assigned_qty==="0"||nt.assigned_qty===0?e.jsx("span",{className:"text-gray-400 font-medium",children:"-"}):e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 border border-green-200 rounded text-xs font-medium",children:nt.assigned_qty})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-700 border border-indigo-200 rounded text-xs font-medium",children:nt.duration||"-"})})]},`${Z}-${Ke}`)))})]})})})]})})]})]})}const Hz=()=>{const[t,s]=d.useState(()=>{try{return sessionStorage.getItem("superAdminActiveTab")||"dashboard"}catch{return"dashboard"}}),r=d.useMemo(()=>[{key:"dashboard",label:"Dashboard",component:e.jsx(lk,{onLogout:()=>{try{localStorage.clear()}catch{}window.location.href="/login"}})},{key:"planning",label:"Planning",component:e.jsx(ik,{})},{key:"material-issue",label:"Material Issue",component:e.jsx(rf,{})},{key:"semi-qc",label:"Semi QC",component:e.jsx(nf,{})},{key:"phosphating",label:"Phosphating",component:e.jsx(af,{})},{key:"assembly-a",label:"Assembly A",component:e.jsx(lf,{})},{key:"assembly-b",label:"Assembly B",component:e.jsx(of,{})},{key:"assembly-c",label:"Assembly C",component:e.jsx(cf,{})},{key:"assembly-d",label:"Assembly D",component:e.jsx(df,{})},{key:"testing1",label:"Testing 1",component:e.jsx(uf,{})},{key:"testing2",label:"Testing 2",component:e.jsx(mf,{})},{key:"svs",label:"SVS",component:e.jsx(hf,{})},{key:"marking1",label:"Marking 1",component:e.jsx(pf,{})},{key:"marking2",label:"Marking 2",component:e.jsx(xf,{})},{key:"pdi1",label:"PDI 1",component:e.jsx(ff,{})},{key:"pdi2",label:"PDI 2",component:e.jsx(gf,{})},{key:"tpi",label:"TPI",component:e.jsx(yf,{})},{key:"dispatch",label:"Dispatch",component:e.jsx(vf,{})},{key:"customer-support",label:"Customer Support",component:e.jsx(ok,{})}],[]),n=r.find(a=>a.key===t)??r[0];return d.useEffect(()=>{try{sessionStorage.setItem("superAdminActiveTab",t)}catch{}},[t]),e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(or,{role:"planning",currentPage:t==="dashboard"?"Dashboard":t==="planning"?"Planning":t,onLogout:()=>{try{localStorage.clear()}catch{}window.location.href="/login"},onNavigate:a=>{const l=a.toLowerCase().replace(/\s+/g,"-");s(l)}}),e.jsx("div",{className:"z-30 bg-white/80 backdrop-blur border-b px-4 py-2 flex flex-wrap gap-2 main-admin-tabbing",children:r.map(a=>e.jsx(J,{variant:a.key===t?"default":"outline",className:a.key===t?"":"bg-white",onClick:()=>s(a.key),children:a.label},a.key))}),e.jsx("div",{className:"flex-1 inner-header-main overflow-y-auto overflow-x-hidden",children:n.component})]})};function Yz(){const t=Pn(),[s,r]=d.useState([]),[n,a]=d.useState(!1),[l,c]=d.useState(1),[u,f]=d.useState(20),[h,v]=d.useState(""),[w,j]=d.useState("all"),[C,k]=d.useState("range"),[S,_]=d.useState(),[I,F]=d.useState(),[B,q]=d.useState(new Set),[me,re]=d.useState(!1),[M,W]=d.useState(null),[oe,X]=d.useState(!1),[he,ue]=d.useState(!1),[_e,ke]=d.useState(null),[Re,Y]=d.useState(""),[ve,Q]=d.useState(null),be=d.useRef(null),pe=localStorage.getItem("token"),ne=async()=>{try{a(!0);const qe=await ht.post(`${qt}/get-svs-orders`,{menu_name:rt("svs")},{headers:{Authorization:`Bearer ${pe}`}});if((qe.data?.Resp_code===!0||qe.data?.Resp_code==="true"||qe.data?.Resp_code==="RCS")&&Array.isArray(qe.data.data)){const mt=qe.data.data.map(it=>({id:String(it.id),assemblyLine:it.assembly_no||"",gmsoaNo:it.soa_no||"",soaSrNo:it.soa_sr_no||"",assemblyDate:it.assembly_date||"",uniqueCode:it.unique_code||"",splittedCode:it.split_code||"",party:it.party_name||"",customerPoNo:it.customer_po_no||"",codeNo:it.code_no||"",product:it.product||"",totalQty:Number(it.totalQty||it.qty||0),qtyExe:Number(it.qty_executed||0),qtyPending:Number(it.qty_pending||0),finishedValve:it.finished_valve||"",gmLogo:it.gm_logo||"",namePlate:it.name_plate||"",specialNotes:it.special_notes||"",productSpcl1:it.product_spc1||"",productSpcl2:it.product_spc2||"",productSpcl3:it.product_spc3||"",inspection:it.inspection||"",painting:it.painting||"",remarks:it.remarks||""}));r(mt)}else r([])}catch(qe){console.error("SVS Stock fetch error",qe)}finally{a(!1)}};d.useEffect(()=>{ne()},[]);const U=d.useMemo(()=>Array.from(new Set(s.map(qe=>qe.assemblyLine))).filter(Boolean),[s]),ce=(qe="",Me=4)=>{const mt=qe.trim().split(/\s+/);return mt.length<=Me?qe:mt.slice(0,Me).join(" ")+"..."},z=d.useMemo(()=>{let qe=s.slice();if(w!=="all"&&(qe=qe.filter(Me=>Me.assemblyLine===w)),h.trim()){const Me=h.toLowerCase();qe=qe.filter(mt=>mt.uniqueCode.toLowerCase().includes(Me)||mt.party.toLowerCase().includes(Me)||mt.product.toLowerCase().includes(Me)||mt.gmsoaNo.toLowerCase().includes(Me))}return ve&&qe.sort((Me,mt)=>{const it=Number(Me.soaSrNo)||0,Et=Number(mt.soaSrNo)||0;return ve==="asc"?it-Et:Et-it}),qe},[s,w,h,ve]),ae=d.useMemo(()=>{const qe=(l-1)*u;return z.slice(qe,qe+u)},[z,l,u]);d.useEffect(()=>c(1),[w,h]);const ye=qe=>{q(Me=>{const mt=new Set(Me);return mt.has(qe)?mt.delete(qe):mt.add(qe),mt})},fe=()=>{q(qe=>qe.size===z.length?new Set:new Set(z.map(Me=>Me.id)))},Ee=z.length>0&&B.size===z.length,Le=s.filter(qe=>B.has(qe.id)),De=()=>X(!0),Ve=()=>{const Me=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>
        <style>
          @page { size: 130mm 85mm; margin: 0; }
          html, body { width: 130mm; height: 85mm; margin: 0; padding: 0; font-family: Arial, Helvetica, sans-serif; }
          .item-label, .party-desc { padding-bottom: 2mm; }
          .item-label { line-height: 1.8em; }
          .bin-card { width: 130mm; height: 85mm; padding: 6mm; box-sizing: border-box; page-break-after: always; }
          .item-label-description { padding-top: 50px; }
          .meta-qty { width: 50%; }
          .process-border { border-top:1px solid #000; border-bottom:1px solid #000; padding-top: 1.5mm; padding-bottom: 1.5mm; }
          .detail-logo { padding-bottom: 0.9mm; }
          .description { padding-bottom: 2mm; }
          .content { width: 100%; height: 100%; border: 1.5px solid #000; border-radius: 10px; padding-top: 2mm; padding-bottom: 4mm; padding-left: 6mm; padding-right: 6mm; box-sizing: border-box; display: flex; flex-direction: column; }
          .meta-item { padding-top: 2mm; }
          p { margin: 0; }
          .company-name { font-size: 12px; font-weight: 700; text-align: center; margin: 0 0 1mm; }
          .assembly-title p { border: 1px solid #000; display: inline-block; padding-top: 1mm; padding-bottom: 0.9mm; padding-left: 1mm; padding-right: 1mm; }
          .company-address { font-size: 8px; font-weight: 400; text-align: center; line-height: 1.2; margin: 0 0 1.2mm; }
          .tag-title { font-size: 11px; font-weight: 700; text-align: center; margin: 0 0 1.5mm; }
          .doc-row { display: flex; justify-content: space-between; font-size: 9px; margin-bottom: 0.5mm; }
          .title { text-align: center; font-size: 11px; font-weight: 700; margin-top: 0; margin-bottom: 0.5mm; }
          .title-line { border-bottom: 1px solid #000; margin-bottom: 1.5mm; margin-top: 0.5mm; }
          .meta { font-size: 10px; line-height: 1.25; margin-bottom: 0.8mm; display: flex; align-items: center; justify-content: space-between; }
          .meta div { margin-bottom: 0.5mm; }
          .desc { font-size: 9px; margin-bottom: 0.8mm; }
          .desc p { padding-bottom: 0.6mm; }
          .desc span { display: block; padding-bottom: 0.1mm; }
          .desc .label { display: block; font-size: 10px; margin-bottom: 0.8mm; margin-top: 0.8mm; }
          .desc .text { word-break: break-word; }
          .qty-logo { font-size: 10px; line-height: 1.3; margin-bottom: 0.4mm; margin-top: 0.8mm; }
          .inspect { margin-top: auto; font-size: 10px; }
          .inspect-line { height: 3mm; border-bottom: 1px solid #000; }
          .label { font-weight: 600; }
        </style>
      </head>
      <body>${Le.map(Et=>`
        <div class="bin-card">
          <div class="content">
            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>
            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>
            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${Et.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(Et.gmsoaNo).replace(/^SOA/i,"")}-${Et.soaSrNo}
                </div>
              </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${Et.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
            </div>
            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${Et.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${Et.product}</p>
              </div>
            </div>
            <div class="qty-logo">
              <div class="meta meta-logo">
                <div class="meta-qty"><span class="label">QTY:</span> ${Et.totalQty}</div>
                <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${Et.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${Et.specialNotes||""}</span></div>
            </div>
            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>
          </div>
        </div>`).join("")}</body>
    </html>`,mt=document.createElement("iframe");mt.style.position="fixed",mt.style.right="0",mt.style.bottom="0",mt.style.width="0",mt.style.height="0",mt.style.border="0",document.body.appendChild(mt);const it=mt.contentDocument||mt.contentWindow?.document;it&&(it.open(),it.write(Me),it.close(),setTimeout(()=>{mt.contentWindow?.focus(),mt.contentWindow?.print(),setTimeout(()=>document.body.removeChild(mt),500)},300))},et=qe=>{W(qe),re(!0)},Nt=qe=>{ke(qe),Y(qe.remarks||""),ue(!0)},ot=()=>{const qe=B.size>0?z.filter(Me=>B.has(Me.id)):z;if(!qe.length){alert("No data available to export");return}Qt(qe)},Qt=qe=>{const Me=qe.map((pt,xe)=>({No:xe+1,"Assembly Line":pt.assemblyLine,"GMSOA No":pt.gmsoaNo,"SOA Sr No":pt.soaSrNo,"Assembly Date":pt.assemblyDate,"Unique Code":pt.uniqueCode,"Splitted Code":pt.splittedCode||"-",Party:pt.party,"Customer PO No":pt.customerPoNo,"Code No":pt.codeNo,Product:pt.product,Qty:pt.totalQty,"Qty Executed":pt.qtyExe,"Qty Pending":pt.qtyPending,"Finished Valve":pt.finishedValve,"GM Logo":pt.gmLogo,"Name Plate":pt.namePlate,"Special Notes":pt.specialNotes||"","Product Special 1":pt.productSpcl1,"Product Special 2":pt.productSpcl2,"Product Special 3":pt.productSpcl3,Inspection:pt.inspection,Painting:pt.painting,Remarks:pt.remarks||""})),mt=Ht.json_to_sheet(Me),it=Ht.book_new();Ht.book_append_sheet(it,mt,"SVS Stock");const Et=Zs(it,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([Et],{type:"application/octet-stream"}),`SVS_Stock_${new Date().toISOString().slice(0,10)}.xlsx`)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"SVS Stock",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:qe=>window.location.href=`/${qe.toLowerCase()}`}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 bg-white min-h-screen animate-fade-in",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"SVS Inventory (Stock)"}),e.jsx("p",{className:"text-gray-600",children:"Read-only inventory view (Finished Valve = Yes)"}),e.jsx("div",{className:"mt-4",children:e.jsxs(J,{variant:"outline",className:"flex items-center gap-2",onClick:()=>{try{const qe=localStorage.getItem("user"),Me=qe?JSON.parse(qe):null,mt=Me?.role?.name||Me?.role||"";String(mt||"").toLowerCase().includes("planning")?t("/planning"):t("/svs")}catch{t("/svs")}},title:"Back to SVS",children:[e.jsx(cm,{className:"h-4 w-4"}),"Back to SVS"]})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(J,{onClick:De,variant:"outline",disabled:B.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{variant:"outline",onClick:ot,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:h,setSearchTerm:v,assemblyLineFilter:w,setAssemblyLineFilter:j,dateFilterMode:C,setDateFilterMode:k,dateFrom:S,setDateFrom:_,dateTo:I,setDateTo:F,assemblyLines:U,onClearFilters:()=>{j("all"),v(""),_(void 0),F(void 0)},hasActiveFilters:w!=="all"||!!S||!!I})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:be,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:n&&s.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ee),onClick:fe,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ee?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24 cursor-pointer select-none",onClick:()=>Q(qe=>qe==="asc"?"desc":qe==="desc"?null:"asc"),children:["Sr.No.",ve==="asc"&&" ",ve==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Finished Valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:ae.map((qe,Me)=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:B.has(qe.id),onCheckedChange:()=>ye(qe.id),"aria-label":`Select row ${qe.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:qe.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:qe.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:qe.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:qe.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:qe.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:qe.party,children:ce(qe.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:qe.product,children:qe.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:qe.specialNotes,children:qe.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:qe.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:qe.remarks||"View Remarks",className:`h-7 w-7 p-0 ${qe.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Nt(qe),children:e.jsx(lr,{className:`h-4 w-4 ${qe.remarks?.trim()?"text-white":"text-blue-600"}`})}),qe.remarks?.trim()&&e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block bg-gray-900 text-white text-xs px-3 py-2 rounded-md shadow-lg max-w-[260px] break-words z-[999]",children:qe.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>et(qe),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})})})})]},`${qe.id}-${qe.soaSrNo}-${qe.uniqueCode}-${Me}`))})]}),z.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No SVS stock found"})]})})})}),e.jsx(cr,{page:l,perPage:u,total:z.length,lastPage:Math.max(1,Math.ceil(z.length/Math.max(u,1))),onChangePage:c,onChangePerPage:f,disabled:n})]}),e.jsx(Rt,{open:oe,onOpenChange:X,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:Le.map(qe=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",qe.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(qe.gmsoaNo).replace(/^SOA/i,""),"-",qe.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",qe.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:qe.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:qe.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",qe.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",qe.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:qe.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},qe.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>X(!1),children:"Cancel"}),e.jsxs(J,{onClick:Ve,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:me,onOpenChange:re,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",M?.uniqueCode]})]}),M&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.splittedCode||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special Notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.specialNotes||"N/A"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.productSpcl1||"N/A"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.productSpcl2||"N/A"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.productSpcl3||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>re(!1),children:"Close"})})]})}),e.jsx(Rt,{open:he,onOpenChange:ue,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"View Remarks"}),e.jsx(Mt,{children:_e?`Order: ${_e.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",value:Re,readOnly:!0,rows:6,className:"resize-none bg-gray-50"})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>ue(!1),children:"Close"})})]})})]})}const Kz=(t,s)=>{if(!t)return"";const r=String(t).trim().split(/\s+/);return r.length<=s?t:r.slice(0,s).join(" ")+"..."};function Xz(){const t=Pn(),{updateRemark:s,getRemark:r,getAlertStatus:n}=yr(),a=localStorage.getItem("token"),[l,c]=d.useState([]),[u,f]=d.useState(null),[h,v]=d.useState(!1),[w,j]=d.useState(null),[C,k]=d.useState(1),[S,_]=d.useState(20),[I,F]=d.useState(null),[B,q]=d.useState(""),[me,re]=d.useState(!1),[M,W]=d.useState(!1),[oe,X]=d.useState("all"),[he,ue]=d.useState("all"),[_e,ke]=d.useState("all"),[Re,Y]=d.useState("single"),[ve,Q]=d.useState(void 0),[be,pe]=d.useState(void 0),[ne,U]=d.useState(new Set),[ce,z]=d.useState(!1),[ae,ye]=d.useState(null),[fe,Ee]=d.useState(""),[Le,De]=d.useState(!1),[Ve,et]=d.useState(null),Nt=d.useRef(null),ot=async()=>{try{v(!0),j(null);const Z=await ht.post(`${qt}/packaging-orders`,{},{headers:{Authorization:`Bearer ${a}`}});if((Z.data?.status===!0||Z.data?.status==="true"||Array.isArray(Z.data?.data))&&Array.isArray(Z.data.data)){const nt=Z.data.data.map((Ke,kt)=>({id:String(Ke.id),assemblyLine:Ke.assembly_no||"",gmsoaNo:Ke.soa_no||"",soaSrNo:Ke.soa_sr_no||"",assemblyDate:Ke.assembly_date||"",uniqueCode:Ke.unique_code||Ke.order_no||"",splittedCode:Ke.split_code||Ke.splitted_code||"",split_id:Ke.split_id||Ke.split_code||Ke.splitted_code||"",party:Ke.party_name||Ke.party||"",customerPoNo:Ke.customer_po_no||"",codeNo:Ke.code_no||"",product:Ke.product||"",totalQty:Number(Ke.totalQty||Ke.total_qty||Ke.qty||Ke.po_qty||0),qtyExe:Number(Ke.qty_executed||Ke.assigned_qty||0),qtyPending:Number(Ke.qty_pending||Ke.remaining_qty||0),finishedValve:Ke.finished_valve||"",gmLogo:Ke.gm_logo||"",namePlate:Ke.name_plate||"",productSpcl1:Ke.product_spc1||"",productSpcl2:Ke.product_spc2||"",productSpcl3:Ke.product_spc3||"",inspection:Ke.inspection||"",painting:Ke.painting||"",remarks:Ke.remarks||"",specialNotes:Ke.special_notes||Ke.special_note||"",alertStatus:Ke.is_urgent===!0||Ke.is_urgent==="true"||Ke.alert_status===!0||Ke.alert_status==="true"||Ke.urgent===1||Ke.urgent==="1",packaging:Ke.is_packaging===1||Ke.is_packaging==="1"||Ke.packaging===1||Ke.packaging==="1"?1:0,oclNo:Ke.ocl_no||"",completedDate:Ke.completed_date||"",originalIndex:kt}));c(nt),f(nt)}else c([]),j(Z?.data?.message||Z?.data?.Resp_desc||"Failed to fetch packaging orders")}catch{j("Error fetching packaging orders")}finally{v(!1)}};d.useEffect(()=>{ot()},[]);const Qt=d.useMemo(()=>Array.from(new Set(l.map(Z=>Z.assemblyLine))).filter(Boolean).sort(),[l]);d.useMemo(()=>Array.from(new Set(l.map(Z=>Z.gmsoaNo))).filter(Boolean).sort(),[l]),d.useMemo(()=>Array.from(new Set(l.map(Z=>Z.party))).filter(Boolean).sort(),[l]);const qe=Z=>{const Ze=parseInt(Z,10);return isNaN(Ze)?0:Ze},Me=d.useMemo(()=>{let Z=l.slice();if(me&&(Z=Z.filter(Ze=>n(String(Ze.id))||Ze.alertStatus)),M&&(Z=Z.filter(Ze=>typeof Ze.remarks=="string"&&Ze.remarks.trim().length>0)),oe!=="all"&&(Z=Z.filter(Ze=>Ze.assemblyLine===oe)),he!=="all"&&(Z=Z.filter(Ze=>Ze.gmsoaNo===he)),_e!=="all"&&(Z=Z.filter(Ze=>Ze.party===_e)),(ve||be)&&(Z=Z.filter(Ze=>{if(!Ze.assemblyDate||Ze.assemblyDate==="HOLD")return!1;const Ke=Ze.assemblyDate.split(/[\/-]/).map(wt=>wt.trim()).map(wt=>Number(wt));if(Ke.some(wt=>isNaN(wt)))return!1;let kt=null;if(Ke.length>=3){const[wt,$t,At]=Ke;kt=new Date(At,$t-1,wt)}else if(Ke.length===2){const[wt,$t]=Ke;kt=new Date($t,wt-1,1)}else if(Ke.length===1){const[wt]=Ke;kt=new Date(wt,0,1)}else return!1;if(!kt||isNaN(kt.getTime()))return!1;if(Re==="year"&&ve)return kt.getFullYear()===ve.getFullYear();if(Re==="month"&&ve)return kt.getFullYear()===ve.getFullYear()&&kt.getMonth()===ve.getMonth();if(Re==="range"||Re==="single"){if(ve&&be)return kt>=ve&&kt<=be;if(ve)return kt>=ve;if(be)return kt<=be}return!0})),B.trim()){const Ze=B.toLowerCase();Z=Z.filter(nt=>String(nt.uniqueCode).toLowerCase().includes(Ze)||String(nt.party).toLowerCase().includes(Ze)||String(nt.gmsoaNo).toLowerCase().includes(Ze)||String(nt.customerPoNo).toLowerCase().includes(Ze)||String(nt.codeNo).toLowerCase().includes(Ze)||String(nt.product).toLowerCase().includes(Ze))}return I&&(Z=[...Z].sort((Ze,nt)=>{const Ke=qe(Ze.soaSrNo),kt=qe(nt.soaSrNo);return I==="asc"?Ke-kt:kt-Ke})),Z},[l,B,me,M,oe,he,_e,Re,ve,be,n,I]),mt=d.useMemo(()=>{const Z=(C-1)*S;return Me.slice(Z,Z+S)},[Me,C,S]),it=Z=>Z.splittedCode||Z.split_id?Z.splittedCode||Z.split_id:[Z.uniqueCode,Z.soaSrNo,Z.gmsoaNo,Z.codeNo,Z.assemblyLine].map(Ze=>Ze??"").join("|"),Et=Z=>{U(Ze=>{const nt=new Set(Ze);return nt.has(Z)?nt.delete(Z):nt.add(Z),nt})},pt=()=>{ne.size===Me.length?U(new Set):U(new Set(Me.map(it)))},xe=d.useMemo(()=>l.filter(Z=>ne.has(it(Z))),[l,ne]),[tt,lt]=d.useState(!1),Ue=()=>lt(!0),He=()=>{const Ze=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>
        <style>
          @page { size: 130mm 85mm; margin: 0; }
          html, body { width: 130mm; height: 85mm; margin: 0; padding: 0; font-family: Arial, Helvetica, sans-serif; }
          .item-label, .party-desc { padding-bottom: 2mm; }
          .item-label { line-height: 1.8em; }
          .bin-card { width: 130mm; height: 85mm; padding: 6mm; box-sizing: border-box; page-break-after: always; }
          .item-label-description { padding-top: 50px; }
          .meta-qty { width: 50%; }
          .process-border { border-top:1px solid #000; border-bottom:1px solid #000; padding-top: 1.5mm; padding-bottom: 1.5mm; }
          .detail-logo { padding-bottom: 0.9mm; }
          .description { padding-bottom: 2mm; }
          .content { width: 100%; height: 100%; border: 1.5px solid #000; border-radius: 10px; padding-top: 2mm; padding-bottom: 4mm; padding-left: 6mm; padding-right: 6mm; box-sizing: border-box; display: flex; flex-direction: column; }
          .meta-item { padding-top: 2mm; }
          p { margin: 0; }
          .company-name { font-size: 12px; font-weight: 700; text-align: center; margin: 0 0 1mm; }
          .assembly-title p { border: 1px solid #000; display: inline-block; padding-top: 1mm; padding-bottom: 0.9mm; padding-left: 1mm; padding-right: 1mm; }
          .company-address { font-size: 8px; font-weight: 400; text-align: center; line-height: 1.2; margin: 0 0 1.2mm; }
          .tag-title { font-size: 11px; font-weight: 700; text-align: center; margin: 0 0 1.5mm; }
          .doc-row { display: flex; justify-content: space-between; font-size: 9px; margin-bottom: 0.5mm; }
          .title { text-align: center; font-size: 11px; font-weight: 700; margin-top: 0; margin-bottom: 0.5mm; }
          .title-line { border-bottom: 1px solid #000; margin-bottom: 1.5mm; margin-top: 0.5mm; }
          .meta { font-size: 10px; line-height: 1.25; margin-bottom: 0.8mm; display: flex; align-items: center; justify-content: space-between; }
          .meta div { margin-bottom: 0.5mm; }
          .desc { font-size: 9px; margin-bottom: 0.8mm; }
          .desc p { padding-bottom: 0.6mm; }
          .desc span { display: block; padding-bottom: 0.1mm; }
          .desc .label { display: block; font-size: 10px; margin-bottom: 0.8mm; margin-top: 0.8mm; }
          .desc .text { word-break: break-word; }
          .qty-logo { font-size: 10px; line-height: 1.3; margin-bottom: 0.4mm; margin-top: 0.8mm; }
          .inspect { margin-top: auto; font-size: 10px; }
          .inspect-line { height: 3mm; border-bottom: 1px solid #000; }
          .label { font-weight: 600; }
        </style>
      </head>
      <body>${xe.map(kt=>`
        <div class="bin-card">
          <div class="content">
            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>
            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>
            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${kt.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(kt.gmsoaNo).replace(/^SOA/i,"")}-${kt.soaSrNo}
                </div>
              </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${kt.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
            </div>
            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${kt.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${kt.product}</p>
              </div>
            </div>
            <div class="qty-logo">
              <div class="meta meta-logo">
                <div class="meta-qty"><span class="label">QTY:</span> ${kt.totalQty}</div>
                <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${kt.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${kt.specialNotes||""}</span></div>
            </div>
            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>
          </div>
        </div>`).join("")}</body>
    </html>`,nt=document.createElement("iframe");nt.style.position="fixed",nt.style.right="0",nt.style.bottom="0",nt.style.width="0",nt.style.height="0",nt.style.border="0",document.body.appendChild(nt);const Ke=nt.contentDocument||nt.contentWindow?.document;Ke&&(Ke.open(),Ke.write(Ze),Ke.close(),setTimeout(()=>{nt.contentWindow?.focus(),nt.contentWindow?.print(),setTimeout(()=>document.body.removeChild(nt),500)},300))},zt=Me.length>0&&ne.size===Me.length,gt=Z=>{const Ze=Z.map((wt,$t)=>({No:$t+1,"Assembly Line":wt.assemblyLine,"GMSOA No":wt.gmsoaNo,"SOA Sr No":wt.soaSrNo,"Assembly Date":wt.assemblyDate,"Unique Code":wt.uniqueCode,"Splitted Code":wt.splittedCode||"-",Party:wt.party,"Customer PO No":wt.customerPoNo,"Code No":wt.codeNo,Product:wt.product,Qty:wt.totalQty,"Qty Executed":wt.qtyExe,"Qty Pending":wt.qtyPending,"Finished Valve":wt.finishedValve,"GM Logo":wt.gmLogo,"Name Plate":wt.namePlate,"Special Notes":wt.specialNotes||"","Product Special 1":wt.productSpcl1,"Product Special 2":wt.productSpcl2,"Product Special 3":wt.productSpcl3,Inspection:wt.inspection,Painting:wt.painting,OCL:wt.oclNo,"Completed Date":wt.completedDate,Remarks:wt.remarks||""})),nt=Ht.json_to_sheet(Ze),Ke=Ht.book_new();Ht.book_append_sheet(Ke,nt,"Packaging");const kt=Zs(Ke,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([kt]),"Packaging.xlsx")},jt=()=>{const Z=ne.size>0?Me.filter(Ze=>ne.has(it(Ze))):Me;gt(Z)},ct=Z=>{ye(Z),Ee(r(Z.id)||Z.remarks||""),z(!0)},Yt=()=>{ae&&(s(ae.id,fe),z(!1))};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:"svs",currentPage:"Packaging",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:Z=>window.location.href=`/${Z.toLowerCase()}`}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Packaging"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Completed and packaged orders"})]}),e.jsxs("div",{className:"flex gap-4 w-full justify-end",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(J,{onClick:Ue,variant:"outline",disabled:ne.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]})})}),e.jsxs(J,{variant:"outline",onClick:jt,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(J,{variant:"outline",onClick:()=>{try{const Z=localStorage.getItem("user"),Ze=Z?JSON.parse(Z):null,nt=Ze?.role?.name||Ze?.role||"";String(nt||"").toLowerCase().includes("planning")?t("/planning"):t("/dispatch")}catch{t("/dispatch")}},className:"flex items-center gap-2",children:[e.jsx(cm,{className:"h-4 w-4"}),"Back to Dispatch"]})}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:B,setSearchTerm:q,assemblyLineFilter:oe,setAssemblyLineFilter:X,dateFilterMode:Re,setDateFilterMode:Y,dateFrom:ve,setDateFrom:Q,dateTo:be,setDateTo:pe,assemblyLines:Qt,onClearFilters:()=>{X("all"),ue("all"),ke("all"),Y("range"),Q(void 0),pe(void 0)},hasActiveFilters:oe!=="all"||he!=="all"||_e!=="all"||!!ve||!!be})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:Nt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:h&&l.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(zt),onClick:pt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${zt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24 cursor-pointer select-none",onClick:()=>F(Z=>Z==="asc"?"desc":Z==="desc"?null:"asc"),children:["Sr.No.",I==="asc"&&" ",I==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"OCL Number"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:mt.map(Z=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:ne.has(it(Z)),onCheckedChange:()=>Et(it(Z)),"aria-label":`Select row ${Z.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:Z.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:Z.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:Z.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:Z.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:Z.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:Z.party,children:Kz(Z.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:Z.product,children:Z.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:Z.specialNotes,children:Z.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:Z.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:Z.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${Z.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>ct(Z),children:e.jsx(lr,{className:`h-4 w-4 ${Z.remarks?.trim()?"text-white":"text-blue-600"}`})}),Z.remarks?.trim()&&e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block bg-gray-900 text-white text-xs px-3 py-2 rounded-md shadow-lg max-w-[260px] break-words z-[999]",children:Z.remarks})]})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:Z.oclNo||"-"}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>et(Z)||De(!0),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${Z.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${Z.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},[Z.id,Z.splittedCode||Z.split_id,Z.uniqueCode,Z.soaSrNo].join("-")))})]}),Me.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),e.jsx(cr,{page:C,perPage:S,total:Me.length,lastPage:Math.max(1,Math.ceil(Me.length/Math.max(S,1))),onChangePage:k,onChangePerPage:_,disabled:h})]}),e.jsx(Rt,{open:ce,onOpenChange:z,children:e.jsxs(Tt,{children:[e.jsx(Dt,{children:e.jsx(Lt,{children:"Remarks"})}),e.jsx(ur,{value:fe,onChange:Z=>Ee(Z.target.value)}),e.jsx(J,{onClick:Yt,children:"Save"})]})}),e.jsx(Rt,{open:Le,onOpenChange:De,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",Ve?.uniqueCode]})]}),Ve&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>De(!1),children:"Close"})})]})}),e.jsx(Rt,{open:tt,onOpenChange:lt,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:xe.map(Z=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",Z.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(Z.gmsoaNo).replace(/^SOA/i,""),"-",Z.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",Z.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:Z.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:Z.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",Z.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",Z.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:Z.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},Z.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>lt(!1),children:"Cancel"}),e.jsxs(J,{onClick:He,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})})]})}function Jz(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),pe=Pn(),U=Sa().state?.source||"assembly-a",[ce,z]=d.useState(new Set),[ae,ye]=d.useState(!1),[fe,Ee]=d.useState(null),[Le,De]=d.useState(""),[Ve,et]=d.useState(""),[Nt,ot]=d.useState(!1),[Qt,qe]=d.useState(""),[Me,mt]=d.useState(""),[it,Et]=d.useState({}),[pt,xe]=d.useState(!1),[tt,lt]=d.useState(!1),[Ue,He]=d.useState(null),[zt,gt]=d.useState(!1),[jt,ct]=d.useState(null),[Yt,Z]=d.useState(""),[Ze,nt]=d.useState(null),[Ke,kt]=d.useState(!1),[wt,$t]=d.useState(null);d.useRef(null);const At=d.useRef(null),Vt=localStorage.getItem("token"),Ot=async()=>{try{h(!0),w(null);const y=rt("testing1"),P=(()=>{try{const Je=localStorage.getItem("user");if(!Je)return"";const se=JSON.parse(Je),Ie=typeof se.role=="object"?se.role?.name:se.role;return String(Ie||"").toLowerCase()}catch{return""}})().includes("admin"),R={menu_name:y},L=await ht.post(`${qt}/order-list`,R,{headers:{Authorization:`Bearer ${Vt}`}});if((L?.data?.Resp_code==="true"||L?.data?.Resp_code===!0||L?.data?.Resp_code==="RCS")&&Array.isArray(L.data.data)){const Je=L.data.data.map(se=>({id:String(se.id),assemblyLine:se.assembly_no||"",gmsoaNo:se.soa_no||"",soaSrNo:se.soa_sr_no||"",assemblyDate:se.assembly_date||"",uniqueCode:se.unique_code||se.order_no||"",splittedCode:se.splitted_code||"",party:se.party_name||se.party||"",customerPoNo:se.customer_po_no||"",codeNo:se.code_no||"",product:se.product||"",qty:Number(se.qty||0),totalQty:Number(se.totalQty||se.total_qty||se.qty||0),qtyExe:Number(se.qty_executed||0),qtyPending:Number(se.qty_pending||0),finishedValve:se.finished_valve||"",gmLogo:se.gm_logo||"",namePlate:se.name_plate||"",specialNotes:se.special_notes||se.special_note||"",productSpcl1:se.product_spc1||"",productSpcl2:se.product_spc2||"",productSpcl3:se.product_spc3||"",inspection:se.inspection||"",painting:se.painting||"",remarks:se.remarks||"",alertStatus:se.is_urgent===!0||se.is_urgent==="true"||se.alert_status===!0||se.alert_status==="true"||se.urgent===1||se.urgent==="1"}));console.log(" Orders fetched:",Je.length,"records"),l(We(Je)),u(null),w(null),$t(null)}else console.warn(" No valid order data received",L.data),l([]),w(L?.data?.Resp_desc||"Failed to fetch orders")}catch(p){console.error("Error fetching orders:",p),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},yt=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{yt||Ot()},[j,k,yt]);const Ge=d.useMemo(()=>Array.from(new Set(a.map(p=>p.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(p=>p.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(p=>p.party))).filter(Boolean).sort(),[a]);const St=p=>{const y=parseInt(p,10);return isNaN(y)?0:y},Ct=d.useMemo(()=>{let p=a.slice();q&&(p=p.filter(y=>n(String(y.id))||y.alertStatus)),re&&(p=p.filter(y=>typeof y.remarks=="string"&&y.remarks.trim().length>0));{const y=U.replace("assembly-","").toLowerCase();p=p.filter(N=>(N.assemblyLine||"").toLowerCase().includes(y))}if(W!=="all"&&(p=p.filter(y=>y.assemblyLine===W)),X!=="all"&&(p=p.filter(y=>y.gmsoaNo===X)),ue!=="all"&&(p=p.filter(y=>y.party===ue)),(Y||Q)&&(p=p.filter(y=>{if(!y.assemblyDate||y.assemblyDate==="HOLD")return!1;const P=y.assemblyDate.split(/[\/-]/).map(L=>L.trim()).map(L=>Number(L));if(P.some(L=>isNaN(L)))return!1;let R=null;if(P.length>=3){const[L,Ne,Je]=P;R=new Date(Je,Ne-1,L)}else if(P.length===2){const[L,Ne]=P;R=new Date(Ne,L-1,1)}else if(P.length===1){const[L]=P;R=new Date(L,0,1)}else return!1;if(!R||isNaN(R.getTime()))return!1;if(ke==="year"&&Y)return R.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return R.getFullYear()===Y.getFullYear()&&R.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return R>=Y&&R<=Q;if(Y)return R>=Y;if(Q)return R<=Q}return!0})),F.trim()){const y=F.toLowerCase();p=p.filter(N=>String(N.uniqueCode).toLowerCase().includes(y)||String(N.party).toLowerCase().includes(y)||String(N.gmsoaNo).toLowerCase().includes(y)||String(N.customerPoNo).toLowerCase().includes(y)||String(N.codeNo).toLowerCase().includes(y)||String(N.product).toLowerCase().includes(y))}return _&&(p=[...p].sort((y,N)=>{const P=St(y.soaSrNo),R=St(N.soaSrNo);return _==="asc"?P-R:R-P})),p},[a,F,q,re,W,X,ue,ke,Y,Q,n,_]),Zt=d.useMemo(()=>{const p=(j-1)*k;return Ct.slice(p,p+k)},[Ct,j,k]);d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const _t=(p="",y=4)=>{const N=p.trim().split(/\s+/);return N.length<=y?p:N.slice(0,y).join(" ")+"..."},Ut=p=>{z(y=>{const N=new Set(y);return N.has(p)?N.delete(p):N.add(p),N})},Kt=()=>{z(p=>p.size===Ct.length?new Set:new Set(Ct.map(ds)))},Bt=Ct.length>0&&ce.size===Ct.length,Xt=p=>{const y=p.assemblyLine?.toLowerCase();return y==="c"||y==="assembly c"||y==="assembly-c"?["svs","marking1"]:Ns("testing1")},as=d.useMemo(()=>fe?Xt(fe):[],[fe]),ds=p=>p.splittedCode||p.split_id||p.uniqueCode||p.id,ls=p=>{const y=Xt(p);Ee(p),ye(!0),De(y[0]||""),et(String(p.qtyPending??p.qty??0)),ot(!1),qe(""),mt(""),Et({})},us=()=>{const p={},y=Number(fe?.qtyPending??0),N=Number(Ve||0),P=Number(Me||0);if(Le||(p.quickAssignStep="Please select a workflow step."),(!Ve||N<=0)&&(p.quickAssignQty="Quantity must be greater than 0."),N>y&&(p.quickAssignQty=`Cannot exceed available (${y})`),Nt){Qt||(p.splitAssignStep="Choose split step."),(!Me||P<=0)&&(p.splitAssignQty="Split quantity is required."),Le===Qt&&(p.sameEngineer="Split step cannot be the same as main step.");const R=N+P;R!==y&&(p.totalQtyMismatch=`Total quantity (${R}) must equal available (${y}).`)}return Et(p),Object.keys(p).length===0},V=()=>{x(!1),G(null),ye(!1),Ee(null),De(""),et(""),ot(!1),qe(""),mt(""),Et({})},ie=a.filter(p=>ce.has(p.splittedCode||p.split_id||p.uniqueCode||p.id)),K=()=>xe(!0),ee=()=>{const y=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ie.map(R=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${R.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(R.gmsoaNo).replace(/^SOA/i,"")}-${R.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${R.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${R.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${R.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${R.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${R.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${R.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,N=document.createElement("iframe");N.style.position="fixed",N.style.right="0",N.style.bottom="0",N.style.width="0",N.style.height="0",N.style.border="0",document.body.appendChild(N);const P=N.contentDocument||N.contentWindow?.document;P&&(P.open(),P.write(y),P.close(),setTimeout(()=>{N.contentWindow?.focus(),N.contentWindow?.print(),setTimeout(()=>document.body.removeChild(N),500)},300))},de=p=>{He(p),lt(!0)},le=p=>p.splittedCode||p.split_id?p.splittedCode||p.split_id:[p.uniqueCode,p.soaSrNo,p.gmsoaNo,p.codeNo,p.assemblyLine].map(y=>y??"").join("|"),Pe=d.useMemo(()=>{const p=Ct.filter(y=>ce.has(le(y)));return{count:p.length,qty:p.reduce((y,N)=>y+(N.totalQty||N.qty||0),0),qtyExe:p.reduce((y,N)=>y+(N.qtyExe||0),0),qtyPending:p.reduce((y,N)=>y+(N.qtyPending||0),0)}},[ce,Ct]),Be=()=>{const p=q===!0,y=re===!0,N=ce.size>0;if(!p&&!y&&!N)return;const P=N?Ct.filter(R=>ce.has(le(R))):Ct;if(!P.length){alert("No data available to export");return}je(P)},Te=()=>{const p=c&&c.length>0?c:a;if(!p||p.length===0){alert("No data available to export");return}je(p)},je=p=>{const y=p.map((L,Ne)=>({No:Ne+1,"Assembly Line":L.assemblyLine,"GMSOA No":L.gmsoaNo,"SOA Sr No":L.soaSrNo,"Assembly Date":L.assemblyDate,"Unique Code":L.uniqueCode,"Splitted Code":L.splittedCode||"-",Party:L.party,"Customer PO No":L.customerPoNo,"Code No":L.codeNo,Product:L.product,"PO Qty":L.poQty,Qty:L.qty,"Qty Executed":L.qtyExe,"Qty Pending":L.qtyPending,"Finished Valve":L.finishedValve,"GM Logo":L.gmLogo,"Name Plate":L.namePlate,"Special Notes":L.specialNotes||"","Product Special 1":L.productSpcl1,"Product Special 2":L.productSpcl2,"Product Special 3":L.productSpcl3,Inspection:L.inspection,Painting:L.painting,Remarks:L.remarks||""})),N=Ht.json_to_sheet(y),P=Ht.book_new();Ht.book_append_sheet(P,N,"Orders");const R=Zs(P,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([R],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Ce=p=>{ct(p),Z(p.remarks||""),gt(!0)},Fe=async()=>{if(!jt)return;const p=new FormData;p.append("orderId",String(jt.id)),p.append("remarks",Yt);try{const y=await ht.post(`${qt}/add-remarks`,p,{headers:{Authorization:`Bearer ${Vt}`}});if(console.log("Add Remarks Response:",y.data),y.data?.Resp_code==="true"||y.data?.Resp_code===!0){l(P=>P.map(R=>R.id===jt.id?{...R,remarks:Yt}:R));try{t(jt.id,Yt)}catch{}gt(!1),ct(null),Z("")}else console.warn("Backend rejected remarks:",y.data)}catch(y){console.error("Error saving remarks:",y)}},We=p=>[...p].sort((y,N)=>{const P=y.alertStatus?1:0,R=N.alertStatus?1:0;return P!==R?R-P:(y.originalIndex??0)-(N.originalIndex??0)}),[ge,G]=d.useState(null),[T,x]=d.useState(!1),A=async()=>{if(!T&&fe&&us()){x(!0),G({type:"info",message:"Assigning order, please wait..."});try{const p=localStorage.getItem("token");if(!p){G({type:"error",message:"Token missing. Please log in again."});return}const y="testing1",N=rt(y),P=Number(Ve||0),R=Number(Me||0),L=Ns(y)[0]||"",Je=rt(Le||L),se=new FormData;se.append("orderId",String(fe.id)),se.append("totalQty",String(fe.totalQty??fe.qty??0)),se.append("executedQty",String(P)),se.append("currentSteps",N),se.append("nextSteps",Je),se.append("split_id",String(fe.split_id||"")),console.log(" MAIN PAYLOAD:",Object.fromEntries(se.entries()));const Ie=await ht.post(`${qt}/assign-order`,se,{headers:{Authorization:`Bearer ${p}`}});if(!(Ie.data?.Resp_code===!0||Ie.data?.Resp_code==="true"||Ie.data?.status===!0)){G({type:"error",message:Ie.data?.Resp_desc||"Main assignment failed."});return}let te=` Assigned ${P}  ${Je}`;if(Nt&&R>0){const ut=new FormData;ut.append("orderId",String(fe.id)),ut.append("totalQty",String(fe.totalQty??fe.qty??0)),ut.append("executedQty",String(R)),ut.append("currentSteps",N),ut.append("nextSteps",Je),ut.append("split_id",String(fe.split_id||"")),console.log(" SPLIT PAYLOAD:",Object.fromEntries(ut.entries()));const Wt=await ht.post(`${qt}/assign-order`,ut,{headers:{Authorization:`Bearer ${p}`}});Wt.data?.Resp_code===!0||Wt.data?.Resp_code==="true"||Wt.data?.status===!0?te+=`
 Split ${R}  ${Je}`:G({type:"error",message:"Main assigned but split failed: "+(Wt.data?.Resp_desc||"Unknown error")})}G({type:"success",message:te});const Se=ut=>ut.splittedCode||ut.split_id?ut.splittedCode||ut.split_id:[ut.uniqueCode,ut.soaSrNo,ut.gmsoaNo,ut.codeNo,ut.assemblyLine].map(Wt=>Wt??"").join("|"),at=Se(fe);l(ut=>ut.filter(Wt=>Se(Wt)!==at)),z(ut=>{const Wt=new Set(ut);return Wt.delete(at),Wt}),setTimeout(()=>{ye(!1),G(null)},1e3)}catch(p){console.error(" Error assigning order:",p),G({type:"error",message:p?.response?.data?.Resp_desc||p?.response?.data?.message||"Server error while assigning."})}finally{x(!1)}}},g=()=>{oe("all"),he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:U,currentPage:`Testing Assembly (${U.replace("assembly-","Line ").toUpperCase()})`,onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:p=>{window.location.href=`/${p.toLowerCase()}`},onUploadSuccess:()=>Ot()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Testing 1"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"}),e.jsx("div",{className:"mt-4",children:e.jsxs(J,{variant:"outline",className:"flex items-center gap-2",onClick:()=>{try{const p=localStorage.getItem("user"),y=p?JSON.parse(p):null,N=y?.role?.name||y?.role||"",P=String(N||"").toLowerCase();P.includes("planning")||P.includes("admin")?pe("/planning"):pe(`/${U}`)}catch{pe(`/${U}`)}},title:`Back to ${U.replace("-"," ").toUpperCase()}`,children:[e.jsx(cm,{className:"h-4 w-4"}),"Back to"," ",U.replace(/-/g," ").replace(/\b\w/g,p=>p.toUpperCase())]})})]}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center flex-inner-wrapper justify-end",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(J,{onClick:K,variant:"outline",disabled:ce.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:Be,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:Te,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:Ge,onClearFilters:g,disableAssemblyFilter:!0,hasActiveFilters:W!=="all"||X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:At,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Bt),onClick:Kt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Bt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(p=>p==="asc"?"desc":p==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Zt.map(p=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:ce.has(ds(p)),onCheckedChange:()=>Ut(ds(p))})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:p.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:p.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:p.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:p.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:p.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:p.party,children:_t(p.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:p.product,children:p.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:p.specialNotes,children:p.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:p.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:p.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${p.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Ce(p),children:e.jsx(lr,{className:`h-4 w-4 ${p.remarks?.trim()?"text-white":"text-blue-600"}`})}),p.remarks?.trim()&&e.jsx("div",{className:`\r
                                  absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                  hidden group-hover:block\r
                                  bg-gray-900 text-white text-xs\r
                                  px-3 py-2 rounded-md shadow-lg\r
                                  max-w-[260px] break-words z-[999]\r
                                `,children:p.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>de(p),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{disabled:!0,size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ls(p),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${p.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${p.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},p.splittedCode||p.split_id||p.uniqueCode||p.id))})]}),Ct.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),Pe.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:Pe.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:Pe.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:Pe.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:Pe.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:Ct.length,lastPage:Math.max(1,Math.ceil(Ct.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:ae,onOpenChange:ye,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",fe?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:Le,onValueChange:De,children:[e.jsx(nr,{id:"assignStep",children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:as.map(p=>e.jsx(Es,{value:p,children:rt(p)},p))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Ve,onChange:p=>et(p.target.value),max:fe?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:fe?.qtyPending})]})]})}),ge&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${ge.type==="success"?"bg-green-50 text-green-700 border border-green-200":ge.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:ge.message.split(`
`).map((p,y)=>e.jsx("div",{children:p},y))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:V,disabled:T,children:"Cancel"}),e.jsx(J,{onClick:A,disabled:T,className:"bg-black hover:bg-gray-800 text-white",children:T?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:pt,onOpenChange:xe,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ie.map(p=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",p.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(p.gmsoaNo).replace(/^SOA/i,""),"-",p.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",p.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:p.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:p.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",p.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",p.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:p.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},p.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>xe(!1),children:"Cancel"}),e.jsxs(J,{onClick:ee,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:tt,onOpenChange:lt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",Ue?.uniqueCode]})]}),Ue&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>lt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:zt,onOpenChange:gt,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:jt?`Order: ${jt.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:Yt,onChange:p=>Z(p.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>gt(!1),children:"Cancel"}),e.jsx(J,{onClick:Fe,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function Zz(){const{updateRemark:t,toggleAlertStatus:s,getRemark:r,getAlertStatus:n}=yr(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[v,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[W,oe]=d.useState("all"),[X,he]=d.useState("all"),[ue,_e]=d.useState("all"),[ke,Re]=d.useState("single"),[Y,ve]=d.useState(void 0),[Q,be]=d.useState(void 0),pe=Pn(),U=Sa().state?.source||"assembly-a",[ce,z]=d.useState(new Set),[ae,ye]=d.useState(!1),[fe,Ee]=d.useState(null),[Le,De]=d.useState(""),[Ve,et]=d.useState(""),[Nt,ot]=d.useState(!1),[Qt,qe]=d.useState(""),[Me,mt]=d.useState(""),[it,Et]=d.useState({}),[pt,xe]=d.useState(!1),[tt,lt]=d.useState(!1),[Ue,He]=d.useState(null),[zt,gt]=d.useState(!1),[jt,ct]=d.useState(null),[Yt,Z]=d.useState(""),[Ze,nt]=d.useState(null),[Ke,kt]=d.useState(!1),[wt,$t]=d.useState(null);d.useRef(null);const At=d.useRef(null),Vt=localStorage.getItem("token"),Ot=async()=>{try{h(!0),w(null);const y=rt("testing2"),P=(()=>{try{const Je=localStorage.getItem("user");if(!Je)return"";const se=JSON.parse(Je),Ie=typeof se.role=="object"?se.role?.name:se.role;return String(Ie||"").toLowerCase()}catch{return""}})().includes("admin"),R={menu_name:y},L=await ht.post(`${qt}/order-list`,R,{headers:{Authorization:`Bearer ${Vt}`}});if((L?.data?.Resp_code==="true"||L?.data?.Resp_code===!0||L?.data?.Resp_code==="RCS")&&Array.isArray(L.data.data)){const Je=L.data.data.map(se=>({id:String(se.id),assemblyLine:se.assembly_no||"",gmsoaNo:se.soa_no||"",soaSrNo:se.soa_sr_no||"",assemblyDate:se.assembly_date||"",uniqueCode:se.unique_code||se.order_no||"",splittedCode:se.splitted_code||"",party:se.party_name||se.party||"",customerPoNo:se.customer_po_no||"",codeNo:se.code_no||"",product:se.product||"",qty:Number(se.qty||0),totalQty:Number(se.totalQty||se.total_qty||se.qty||0),qtyExe:Number(se.qty_executed||0),qtyPending:Number(se.qty_pending||0),finishedValve:se.finished_valve||"",gmLogo:se.gm_logo||"",namePlate:se.name_plate||"",specialNotes:se.special_notes||se.special_note||"",productSpcl1:se.product_spc1||"",productSpcl2:se.product_spc2||"",productSpcl3:se.product_spc3||"",inspection:se.inspection||"",painting:se.painting||"",remarks:se.remarks||"",alertStatus:se.is_urgent===!0||se.is_urgent==="true"||se.alert_status===!0||se.alert_status==="true"||se.urgent===1||se.urgent==="1"}));console.log(" Orders fetched:",Je.length,"records"),l(We(Je)),u(null),w(null),$t(null)}else console.warn(" No valid order data received",L.data),l([]),w(L?.data?.Resp_desc||"Failed to fetch orders")}catch(p){console.error("Error fetching orders:",p),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},yt=d.useMemo(()=>F.trim().length>0||(W!=="all"||X!=="all"||ue!=="all")||(!!Y||!!Q)||q||re,[F,W,X,ue,Y,Q,q,re]);d.useEffect(()=>{yt||Ot()},[j,k,yt]);const Ge=d.useMemo(()=>Array.from(new Set(a.map(p=>p.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(p=>p.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(p=>p.party))).filter(Boolean).sort(),[a]);const St=p=>{const y=parseInt(p,10);return isNaN(y)?0:y},Ct=d.useMemo(()=>{let p=a.slice();q&&(p=p.filter(y=>n(String(y.id))||y.alertStatus)),re&&(p=p.filter(y=>typeof y.remarks=="string"&&y.remarks.trim().length>0));{const y=U.replace("assembly-","").toLowerCase();p=p.filter(N=>(N.assemblyLine||"").toLowerCase().includes(y))}if(W!=="all"&&(p=p.filter(y=>y.assemblyLine===W)),X!=="all"&&(p=p.filter(y=>y.gmsoaNo===X)),ue!=="all"&&(p=p.filter(y=>y.party===ue)),(Y||Q)&&(p=p.filter(y=>{if(!y.assemblyDate||y.assemblyDate==="HOLD")return!1;const P=y.assemblyDate.split(/[\/-]/).map(L=>L.trim()).map(L=>Number(L));if(P.some(L=>isNaN(L)))return!1;let R=null;if(P.length>=3){const[L,Ne,Je]=P;R=new Date(Je,Ne-1,L)}else if(P.length===2){const[L,Ne]=P;R=new Date(Ne,L-1,1)}else if(P.length===1){const[L]=P;R=new Date(L,0,1)}else return!1;if(!R||isNaN(R.getTime()))return!1;if(ke==="year"&&Y)return R.getFullYear()===Y.getFullYear();if(ke==="month"&&Y)return R.getFullYear()===Y.getFullYear()&&R.getMonth()===Y.getMonth();if(ke==="range"||ke==="single"){if(Y&&Q)return R>=Y&&R<=Q;if(Y)return R>=Y;if(Q)return R<=Q}return!0})),F.trim()){const y=F.toLowerCase();p=p.filter(N=>String(N.uniqueCode).toLowerCase().includes(y)||String(N.party).toLowerCase().includes(y)||String(N.gmsoaNo).toLowerCase().includes(y)||String(N.customerPoNo).toLowerCase().includes(y)||String(N.codeNo).toLowerCase().includes(y)||String(N.product).toLowerCase().includes(y))}return _&&(p=[...p].sort((y,N)=>{const P=St(y.soaSrNo),R=St(N.soaSrNo);return _==="asc"?P-R:R-P})),p},[a,F,q,re,W,X,ue,ke,Y,Q,n,_]),Zt=d.useMemo(()=>{const p=(j-1)*k;return Ct.slice(p,p+k)},[Ct,j,k]);d.useEffect(()=>{C(1)},[F,W,X,ue,Y,Q,q,re]);const _t=(p="",y=4)=>{const N=p.trim().split(/\s+/);return N.length<=y?p:N.slice(0,y).join(" ")+"..."},Ut=p=>{z(y=>{const N=new Set(y);return N.has(p)?N.delete(p):N.add(p),N})},Kt=()=>{z(p=>p.size===Ct.length?new Set:new Set(Ct.map(ds)))},Bt=Ct.length>0&&ce.size===Ct.length,Xt=p=>{const y=p.assemblyLine?.toLowerCase();return y==="c"||y==="assembly c"||y==="assembly-c"?["svs","marking1"]:Ns("testing2")},as=d.useMemo(()=>fe?Xt(fe):[],[fe]),ds=p=>p.splittedCode||p.split_id||p.uniqueCode||p.id,ls=p=>{const y=Xt(p);Ee(p),ye(!0),De(y[0]||""),et(String(p.qtyPending??p.qty??0)),ot(!1),qe(""),mt(""),Et({})},us=()=>{const p={},y=Number(fe?.qtyPending??0),N=Number(Ve||0),P=Number(Me||0);if(Le||(p.quickAssignStep="Please select a workflow step."),(!Ve||N<=0)&&(p.quickAssignQty="Quantity must be greater than 0."),N>y&&(p.quickAssignQty=`Cannot exceed available (${y})`),Nt){Qt||(p.splitAssignStep="Choose split step."),(!Me||P<=0)&&(p.splitAssignQty="Split quantity is required."),Le===Qt&&(p.sameEngineer="Split step cannot be the same as main step.");const R=N+P;R!==y&&(p.totalQtyMismatch=`Total quantity (${R}) must equal available (${y}).`)}return Et(p),Object.keys(p).length===0},V=()=>{x(!1),G(null),ye(!1),Ee(null),De(""),et(""),ot(!1),qe(""),mt(""),Et({})},ie=a.filter(p=>ce.has(p.splittedCode||p.split_id||p.uniqueCode||p.id)),K=()=>xe(!0),ee=()=>{const y=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ie.map(R=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${R.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(R.gmsoaNo).replace(/^SOA/i,"")}-${R.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${R.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${R.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${R.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${R.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${R.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${R.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,N=document.createElement("iframe");N.style.position="fixed",N.style.right="0",N.style.bottom="0",N.style.width="0",N.style.height="0",N.style.border="0",document.body.appendChild(N);const P=N.contentDocument||N.contentWindow?.document;P&&(P.open(),P.write(y),P.close(),setTimeout(()=>{N.contentWindow?.focus(),N.contentWindow?.print(),setTimeout(()=>document.body.removeChild(N),500)},300))},de=p=>{He(p),lt(!0)},le=p=>p.splittedCode||p.split_id?p.splittedCode||p.split_id:[p.uniqueCode,p.soaSrNo,p.gmsoaNo,p.codeNo,p.assemblyLine].map(y=>y??"").join("|"),Pe=d.useMemo(()=>{const p=Ct.filter(y=>ce.has(le(y)));return{count:p.length,qty:p.reduce((y,N)=>y+(N.totalQty||N.qty||0),0),qtyExe:p.reduce((y,N)=>y+(N.qtyExe||0),0),qtyPending:p.reduce((y,N)=>y+(N.qtyPending||0),0)}},[ce,Ct]),Be=()=>{const p=q===!0,y=re===!0,N=ce.size>0;if(!p&&!y&&!N)return;const P=N?Ct.filter(R=>ce.has(le(R))):Ct;if(!P.length){alert("No data available to export");return}je(P)},Te=()=>{const p=c&&c.length>0?c:a;if(!p||p.length===0){alert("No data available to export");return}je(p)},je=p=>{const y=p.map((L,Ne)=>({No:Ne+1,"Assembly Line":L.assemblyLine,"GMSOA No":L.gmsoaNo,"SOA Sr No":L.soaSrNo,"Assembly Date":L.assemblyDate,"Unique Code":L.uniqueCode,"Splitted Code":L.splittedCode||"-",Party:L.party,"Customer PO No":L.customerPoNo,"Code No":L.codeNo,Product:L.product,"PO Qty":L.poQty,Qty:L.qty,"Qty Executed":L.qtyExe,"Qty Pending":L.qtyPending,"Finished Valve":L.finishedValve,"GM Logo":L.gmLogo,"Name Plate":L.namePlate,"Special Notes":L.specialNotes||"","Product Special 1":L.productSpcl1,"Product Special 2":L.productSpcl2,"Product Special 3":L.productSpcl3,Inspection:L.inspection,Painting:L.painting,Remarks:L.remarks||""})),N=Ht.json_to_sheet(y),P=Ht.book_new();Ht.book_append_sheet(P,N,"Orders");const R=Zs(P,{bookType:"xlsx",type:"array"});pr.saveAs(new Blob([R],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Ce=p=>{ct(p),Z(p.remarks||""),gt(!0)},Fe=async()=>{if(!jt)return;const p=new FormData;p.append("orderId",String(jt.id)),p.append("remarks",Yt);try{const y=await ht.post(`${qt}/add-remarks`,p,{headers:{Authorization:`Bearer ${Vt}`}});if(console.log("Add Remarks Response:",y.data),y.data?.Resp_code==="true"||y.data?.Resp_code===!0){l(P=>P.map(R=>R.id===jt.id?{...R,remarks:Yt}:R));try{t(jt.id,Yt)}catch{}gt(!1),ct(null),Z("")}else console.warn("Backend rejected remarks:",y.data)}catch(y){console.error("Error saving remarks:",y)}},We=p=>[...p].sort((y,N)=>{const P=y.alertStatus?1:0,R=N.alertStatus?1:0;return P!==R?R-P:(y.originalIndex??0)-(N.originalIndex??0)}),[ge,G]=d.useState(null),[T,x]=d.useState(!1),A=async()=>{if(!T&&fe&&us()){x(!0),G({type:"info",message:"Assigning order, please wait..."});try{const p=localStorage.getItem("token");if(!p){G({type:"error",message:"Token missing. Please log in again."});return}const y="testing2",N=rt(y),P=Number(Ve||0),R=Number(Me||0),L=Ns(y)[0]||"",Je=rt(Le||L),se=new FormData;se.append("orderId",String(fe.id)),se.append("totalQty",String(fe.totalQty??fe.qty??0)),se.append("executedQty",String(P)),se.append("currentSteps",N),se.append("nextSteps",Je),se.append("split_id",String(fe.split_id||"")),console.log(" MAIN PAYLOAD:",Object.fromEntries(se.entries()));const Ie=await ht.post(`${qt}/assign-order`,se,{headers:{Authorization:`Bearer ${p}`}});if(!(Ie.data?.Resp_code===!0||Ie.data?.Resp_code==="true"||Ie.data?.status===!0)){G({type:"error",message:Ie.data?.Resp_desc||"Main assignment failed."});return}let te=` Assigned ${P}  ${Je}`;if(Nt&&R>0){const ut=new FormData;ut.append("orderId",String(fe.id)),ut.append("totalQty",String(fe.totalQty??fe.qty??0)),ut.append("executedQty",String(R)),ut.append("currentSteps",N),ut.append("nextSteps",Je),ut.append("split_id",String(fe.split_id||"")),console.log(" SPLIT PAYLOAD:",Object.fromEntries(ut.entries()));const Wt=await ht.post(`${qt}/assign-order`,ut,{headers:{Authorization:`Bearer ${p}`}});Wt.data?.Resp_code===!0||Wt.data?.Resp_code==="true"||Wt.data?.status===!0?te+=`
 Split ${R}  ${Je}`:G({type:"error",message:"Main assigned but split failed: "+(Wt.data?.Resp_desc||"Unknown error")})}G({type:"success",message:te});const Se=ut=>ut.splittedCode||ut.split_id?ut.splittedCode||ut.split_id:[ut.uniqueCode,ut.soaSrNo,ut.gmsoaNo,ut.codeNo,ut.assemblyLine].map(Wt=>Wt??"").join("|"),at=Se(fe);l(ut=>ut.filter(Wt=>Se(Wt)!==at)),z(ut=>{const Wt=new Set(ut);return Wt.delete(at),Wt}),setTimeout(()=>{ye(!1),G(null)},1e3)}catch(p){console.error(" Error assigning order:",p),G({type:"error",message:p?.response?.data?.Resp_desc||p?.response?.data?.message||"Server error while assigning."})}finally{x(!1)}}},g=()=>{oe("all"),he("all"),_e("all"),Re("range"),ve(void 0),be(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(or,{role:U,currentPage:"Testing 2",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:p=>{window.location.href=`/${p.toLowerCase()}`},onUploadSuccess:()=>Ot()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Testing 2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"}),e.jsx("div",{className:"mt-4",children:e.jsxs(J,{variant:"outline",className:"flex items-center gap-2",onClick:()=>{try{const p=localStorage.getItem("user"),y=p?JSON.parse(p):null,N=y?.role?.name||y?.role||"",P=String(N||"").toLowerCase();P.includes("planning")||P.includes("admin")?pe("/planning"):pe(`/${U}`)}catch{pe(`/${U}`)}},title:`Back to ${U.replace("-"," ").toUpperCase()}`,children:[e.jsx(cm,{className:"h-4 w-4"}),"Back to"," ",U.replace(/-/g," ").replace(/\b\w/g,p=>p.toUpperCase())]})})]}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center flex-inner-wrapper justify-end",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(J,{onClick:K,variant:"outline",disabled:ce.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(J,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(ys,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(J,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(J,{variant:"outline",onClick:Be,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-smss",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(J,{variant:"outline",onClick:Te,className:"flex items-center gap-0 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(mr,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:W,setAssemblyLineFilter:oe,dateFilterMode:ke,setDateFilterMode:Re,dateFrom:Y,setDateFrom:ve,dateTo:Q,setDateTo:be,assemblyLines:Ge,onClearFilters:g,disableAssemblyFilter:!0,hasActiveFilters:W!=="all"||X!=="all"||ue!=="all"||!!Y||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:At,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Bt),onClick:Kt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Bt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(p=>p==="asc"?"desc":p==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Zt.map(p=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Vs,{checked:ce.has(ds(p)),onCheckedChange:()=>Ut(ds(p))})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(qs,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:p.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:p.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:p.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:p.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:p.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:p.party,children:_t(p.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:p.product,children:p.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:p.specialNotes,children:p.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:p.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:p.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(J,{size:"sm",variant:"ghost",title:p.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${p.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Ce(p),children:e.jsx(lr,{className:`h-4 w-4 ${p.remarks?.trim()?"text-white":"text-blue-600"}`})}),p.remarks?.trim()&&e.jsx("div",{className:`\r
                                  absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                  hidden group-hover:block\r
                                  bg-gray-900 text-white text-xs\r
                                  px-3 py-2 rounded-md shadow-lg\r
                                  max-w-[260px] break-words z-[999]\r
                                `,children:p.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(J,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>de(p),children:e.jsx(Ys,{className:"h-4 w-4 text-blue-600"})}),e.jsx(J,{disabled:!0,size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ls(p),children:e.jsx(qr,{className:"h-4 w-4 text-green-600"})}),e.jsx(J,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${p.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(ys,{className:`h-4 w-4 ${p.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},p.splittedCode||p.split_id||p.uniqueCode||p.id))})]}),Ct.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),Pe.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:Pe.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:Pe.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:Pe.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:Pe.qtyPending})]})]}),e.jsx(cr,{page:j,perPage:k,total:Ct.length,lastPage:Math.max(1,Math.ceil(Ct.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Rt,{open:ae,onOpenChange:ye,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Quick Assign Order"}),e.jsxs(Mt,{children:["Assign ",fe?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(sr,{value:Le,onValueChange:De,children:[e.jsx(nr,{id:"assignStep",children:e.jsx(rr,{placeholder:"Select next step"})}),e.jsx(ar,{children:as.map(p=>e.jsx(Es,{value:p,children:rt(p)},p))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Js,{id:"assignQty",type:"number",value:Ve,onChange:p=>et(p.target.value),max:fe?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:fe?.qtyPending})]})]})}),ge&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${ge.type==="success"?"bg-green-50 text-green-700 border border-green-200":ge.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:ge.message.split(`
`).map((p,y)=>e.jsx("div",{children:p},y))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:V,disabled:T,children:"Cancel"}),e.jsx(J,{onClick:A,disabled:T,className:"bg-black hover:bg-gray-800 text-white",children:T?"Assigning...":"Assign"})]})]})}),e.jsx(Rt,{open:pt,onOpenChange:xe,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Mt,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ie.map(p=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",p.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(p.gmsoaNo).replace(/^SOA/i,""),"-",p.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",p.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:p.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:p.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",p.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",p.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:p.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},p.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(J,{variant:"outline",onClick:()=>xe(!1),children:"Cancel"}),e.jsxs(J,{onClick:ee,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(hs,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Rt,{open:tt,onOpenChange:lt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Order Details"}),e.jsxs(Mt,{children:["Complete information for ",Ue?.uniqueCode]})]}),Ue&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.party})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.totalQty})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.qtyExe})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.gmLogo})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.namePlate})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.inspection})]}),e.jsxs("div",{children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(D,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ue.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(J,{variant:"outline",onClick:()=>lt(!1),children:"Close"})})]})}),e.jsx(Rt,{open:zt,onOpenChange:gt,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Dt,{children:[e.jsx(Lt,{children:"Add/Edit Remarks"}),e.jsx(Mt,{children:jt?`Order: ${jt.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(D,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ur,{id:"remarks",placeholder:"Enter remarks...",value:Yt,onChange:p=>Z(p.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(J,{variant:"outline",onClick:()=>gt(!1),children:"Cancel"}),e.jsx(J,{onClick:Fe,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function e$(){return e.jsx(S4,{children:e.jsx(c3,{children:e.jsxs("div",{className:"relative min-h-screen",children:[e.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-slate-50 via-blue-50/30 to-indigo-100/40 -z-10",children:[e.jsx("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-gradient-to-bl from-[#174a9f]/10 via-indigo-300/5 to-transparent rounded-full blur-3xl animate-pulse-soft"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-[500px] h-[500px] bg-gradient-to-tr from-purple-300/5 via-blue-300/5 to-transparent rounded-full blur-3xl animate-pulse-soft",style:{animationDelay:"1s"}})]}),e.jsxs(B_,{children:[e.jsx(zs,{path:"/svs-stock",element:e.jsx(Yz,{})}),e.jsx(zs,{path:"/packaging",element:e.jsx(Xz,{})}),e.jsx(zs,{path:"/testing-assembly",element:e.jsx(hr,{allowedRole:"assembly-shared",children:e.jsx(Jz,{})})}),e.jsx(zs,{path:"/testing-assembly-2",element:e.jsx(hr,{allowedRole:"assembly-shared",children:e.jsx(Zz,{})})}),e.jsx(zs,{path:"/login",element:e.jsx(j4,{})}),e.jsx(zs,{path:"/dashboard",element:e.jsx(k4,{children:e.jsx(lk,{})})}),e.jsx(zs,{path:"/planning",element:e.jsx(hr,{allowedRole:"planning",children:e.jsx(Hz,{})})}),e.jsx(zs,{path:"/material-issue",element:e.jsx(hr,{allowedRole:"material-issue",children:e.jsx(rf,{})})}),e.jsx(zs,{path:"/semi-qc",element:e.jsx(hr,{allowedRole:"semi-qc",children:e.jsx(nf,{})})}),e.jsx(zs,{path:"/assembly-b",element:e.jsx(hr,{allowedRole:"assembly-b",children:e.jsx(of,{})})}),e.jsx(zs,{path:"/phosphating",element:e.jsx(hr,{allowedRole:"phosphating",children:e.jsx(af,{})})}),e.jsx(zs,{path:"/assembly-a",element:e.jsx(hr,{allowedRole:"assembly-a",children:e.jsx(lf,{})})}),e.jsx(zs,{path:"/assembly-c",element:e.jsx(hr,{allowedRole:"assembly-c",children:e.jsx(cf,{})})}),e.jsx(zs,{path:"/assembly-d",element:e.jsx(hr,{allowedRole:"assembly-d",children:e.jsx(df,{})})}),e.jsx(zs,{path:"/testing1",element:e.jsx(hr,{allowedRole:"testing1",children:e.jsx(uf,{})})}),e.jsx(zs,{path:"/testing2",element:e.jsx(hr,{allowedRole:"testing2",children:e.jsx(mf,{})})}),e.jsx(zs,{path:"/marking1",element:e.jsx(hr,{allowedRole:"marking1",children:e.jsx(pf,{})})}),e.jsx(zs,{path:"/marking2",element:e.jsx(hr,{allowedRole:"marking2",children:e.jsx(xf,{})})}),e.jsx(zs,{path:"/svs",element:e.jsx(hr,{allowedRole:"svs",children:e.jsx(hf,{})})}),e.jsx(zs,{path:"/pdi1",element:e.jsx(hr,{allowedRole:"pdi1",children:e.jsx(ff,{})})}),e.jsx(zs,{path:"/pdi2",element:e.jsx(hr,{allowedRole:"pdi2",children:e.jsx(gf,{})})}),e.jsx(zs,{path:"/tpi",element:e.jsx(hr,{allowedRole:"tpi",children:e.jsx(yf,{})})}),e.jsx(zs,{path:"/dispatch",element:e.jsx(hr,{allowedRole:"dispatch",children:e.jsx(vf,{})})}),e.jsx(zs,{path:"/customer-support",element:e.jsx(hr,{allowedRole:"customer-support",children:e.jsx(ok,{})})}),e.jsx(zs,{path:"*",element:e.jsx(Au,{to:"/login",replace:!0})})]})]})})})}KC.createRoot(document.getElementById("root")).render(e.jsx(e$,{}));export{Jd as c,a1 as g};
