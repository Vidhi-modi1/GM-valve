function $C(t,r){for(var s=0;s<r.length;s++){const n=r[s];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const l=Object.getOwnPropertyDescriptor(n,a);l&&Object.defineProperty(t,a,l.get?l:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function s(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=s(a);fetch(a.href,l)}})();var Xd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function a1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var g0={exports:{}},Ko={},y0={exports:{}},br={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zy;function QC(){if(zy)return br;zy=1;var t=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),w=Symbol.iterator;function j(se){return se===null||typeof se!="object"?null:(se=w&&se[w]||se["@@iterator"],typeof se=="function"?se:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,S={};function _(se,U,ue){this.props=se,this.context=U,this.refs=S,this.updater=ue||C}_.prototype.isReactComponent={},_.prototype.setState=function(se,U){if(typeof se!="object"&&typeof se!="function"&&se!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,se,U,"setState")},_.prototype.forceUpdate=function(se){this.updater.enqueueForceUpdate(this,se,"forceUpdate")};function I(){}I.prototype=_.prototype;function F(se,U,ue){this.props=se,this.context=U,this.refs=S,this.updater=ue||C}var B=F.prototype=new I;B.constructor=F,k(B,_.prototype),B.isPureReactComponent=!0;var q=Array.isArray,me=Object.prototype.hasOwnProperty,re={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function G(se,U,ue){var z,ne={},ve=null,fe=null;if(U!=null)for(z in U.ref!==void 0&&(fe=U.ref),U.key!==void 0&&(ve=""+U.key),U)me.call(U,z)&&!M.hasOwnProperty(z)&&(ne[z]=U[z]);var Ce=arguments.length-2;if(Ce===1)ne.children=ue;else if(1<Ce){for(var Le=Array(Ce),De=0;De<Ce;De++)Le[De]=arguments[De+2];ne.children=Le}if(se&&se.defaultProps)for(z in Ce=se.defaultProps,Ce)ne[z]===void 0&&(ne[z]=Ce[z]);return{$$typeof:t,type:se,key:ve,ref:fe,props:ne,_owner:re.current}}function le(se,U){return{$$typeof:t,type:se.type,key:U,ref:se.ref,props:se.props,_owner:se._owner}}function Z(se){return typeof se=="object"&&se!==null&&se.$$typeof===t}function he(se){var U={"=":"=0",":":"=2"};return"$"+se.replace(/[=:]/g,function(ue){return U[ue]})}var ce=/\/+/g;function ke(se,U){return typeof se=="object"&&se!==null&&se.key!=null?he(""+se.key):U.toString(36)}function Ee(se,U,ue,z,ne){var ve=typeof se;(ve==="undefined"||ve==="boolean")&&(se=null);var fe=!1;if(se===null)fe=!0;else switch(ve){case"string":case"number":fe=!0;break;case"object":switch(se.$$typeof){case t:case r:fe=!0}}if(fe)return fe=se,ne=ne(fe),se=z===""?"."+ke(fe,0):z,q(ne)?(ue="",se!=null&&(ue=se.replace(ce,"$&/")+"/"),Ee(ne,U,ue,"",function(De){return De})):ne!=null&&(Z(ne)&&(ne=le(ne,ue+(!ne.key||fe&&fe.key===ne.key?"":(""+ne.key).replace(ce,"$&/")+"/")+se)),U.push(ne)),1;if(fe=0,z=z===""?".":z+":",q(se))for(var Ce=0;Ce<se.length;Ce++){ve=se[Ce];var Le=z+ke(ve,Ce);fe+=Ee(ve,U,ue,Le,ne)}else if(Le=j(se),typeof Le=="function")for(se=Le.call(se),Ce=0;!(ve=se.next()).done;)ve=ve.value,Le=z+ke(ve,Ce++),fe+=Ee(ve,U,ue,Le,ne);else if(ve==="object")throw U=String(se),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(se).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return fe}function Fe(se,U,ue){if(se==null)return se;var z=[],ne=0;return Ee(se,z,"","",function(ve){return U.call(ue,ve,ne++)}),z}function X(se){if(se._status===-1){var U=se._result;U=U(),U.then(function(ue){(se._status===0||se._status===-1)&&(se._status=1,se._result=ue)},function(ue){(se._status===0||se._status===-1)&&(se._status=2,se._result=ue)}),se._status===-1&&(se._status=0,se._result=U)}if(se._status===1)return se._result.default;throw se._result}var ye={current:null},Q={transition:null},we={ReactCurrentDispatcher:ye,ReactCurrentBatchConfig:Q,ReactCurrentOwner:re};function pe(){throw Error("act(...) is not supported in production builds of React.")}return br.Children={map:Fe,forEach:function(se,U,ue){Fe(se,function(){U.apply(this,arguments)},ue)},count:function(se){var U=0;return Fe(se,function(){U++}),U},toArray:function(se){return Fe(se,function(U){return U})||[]},only:function(se){if(!Z(se))throw Error("React.Children.only expected to receive a single React element child.");return se}},br.Component=_,br.Fragment=s,br.Profiler=a,br.PureComponent=F,br.StrictMode=n,br.Suspense=f,br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=we,br.act=pe,br.cloneElement=function(se,U,ue){if(se==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+se+".");var z=k({},se.props),ne=se.key,ve=se.ref,fe=se._owner;if(U!=null){if(U.ref!==void 0&&(ve=U.ref,fe=re.current),U.key!==void 0&&(ne=""+U.key),se.type&&se.type.defaultProps)var Ce=se.type.defaultProps;for(Le in U)me.call(U,Le)&&!M.hasOwnProperty(Le)&&(z[Le]=U[Le]===void 0&&Ce!==void 0?Ce[Le]:U[Le])}var Le=arguments.length-2;if(Le===1)z.children=ue;else if(1<Le){Ce=Array(Le);for(var De=0;De<Le;De++)Ce[De]=arguments[De+2];z.children=Ce}return{$$typeof:t,type:se.type,key:ne,ref:ve,props:z,_owner:fe}},br.createContext=function(se){return se={$$typeof:c,_currentValue:se,_currentValue2:se,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},se.Provider={$$typeof:l,_context:se},se.Consumer=se},br.createElement=G,br.createFactory=function(se){var U=G.bind(null,se);return U.type=se,U},br.createRef=function(){return{current:null}},br.forwardRef=function(se){return{$$typeof:u,render:se}},br.isValidElement=Z,br.lazy=function(se){return{$$typeof:y,_payload:{_status:-1,_result:se},_init:X}},br.memo=function(se,U){return{$$typeof:h,type:se,compare:U===void 0?null:U}},br.startTransition=function(se){var U=Q.transition;Q.transition={};try{se()}finally{Q.transition=U}},br.unstable_act=pe,br.useCallback=function(se,U){return ye.current.useCallback(se,U)},br.useContext=function(se){return ye.current.useContext(se)},br.useDebugValue=function(){},br.useDeferredValue=function(se){return ye.current.useDeferredValue(se)},br.useEffect=function(se,U){return ye.current.useEffect(se,U)},br.useId=function(){return ye.current.useId()},br.useImperativeHandle=function(se,U,ue){return ye.current.useImperativeHandle(se,U,ue)},br.useInsertionEffect=function(se,U){return ye.current.useInsertionEffect(se,U)},br.useLayoutEffect=function(se,U){return ye.current.useLayoutEffect(se,U)},br.useMemo=function(se,U){return ye.current.useMemo(se,U)},br.useReducer=function(se,U,ue){return ye.current.useReducer(se,U,ue)},br.useRef=function(se){return ye.current.useRef(se)},br.useState=function(se){return ye.current.useState(se)},br.useSyncExternalStore=function(se,U,ue){return ye.current.useSyncExternalStore(se,U,ue)},br.useTransition=function(){return ye.current.useTransition()},br.version="18.3.1",br}var $y;function nm(){return $y||($y=1,y0.exports=QC()),y0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qy;function UC(){if(Qy)return Ko;Qy=1;var t=nm(),r=Symbol.for("react.element"),s=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(u,f,h){var y,w={},j=null,C=null;h!==void 0&&(j=""+h),f.key!==void 0&&(j=""+f.key),f.ref!==void 0&&(C=f.ref);for(y in f)n.call(f,y)&&!l.hasOwnProperty(y)&&(w[y]=f[y]);if(u&&u.defaultProps)for(y in f=u.defaultProps,f)w[y]===void 0&&(w[y]=f[y]);return{$$typeof:r,type:u,key:j,ref:C,props:w,_owner:a.current}}return Ko.Fragment=s,Ko.jsx=c,Ko.jsxs=c,Ko}var Uy;function VC(){return Uy||(Uy=1,g0.exports=UC()),g0.exports}var e=VC(),Jd={},v0={exports:{}},ln={},b0={exports:{}},w0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vy;function WC(){return Vy||(Vy=1,(function(t){function r(Q,we){var pe=Q.length;Q.push(we);e:for(;0<pe;){var se=pe-1>>>1,U=Q[se];if(0<a(U,we))Q[se]=we,Q[pe]=U,pe=se;else break e}}function s(Q){return Q.length===0?null:Q[0]}function n(Q){if(Q.length===0)return null;var we=Q[0],pe=Q.pop();if(pe!==we){Q[0]=pe;e:for(var se=0,U=Q.length,ue=U>>>1;se<ue;){var z=2*(se+1)-1,ne=Q[z],ve=z+1,fe=Q[ve];if(0>a(ne,pe))ve<U&&0>a(fe,ne)?(Q[se]=fe,Q[ve]=pe,se=ve):(Q[se]=ne,Q[z]=pe,se=z);else if(ve<U&&0>a(fe,pe))Q[se]=fe,Q[ve]=pe,se=ve;else break e}}return we}function a(Q,we){var pe=Q.sortIndex-we.sortIndex;return pe!==0?pe:Q.id-we.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var f=[],h=[],y=1,w=null,j=3,C=!1,k=!1,S=!1,_=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(Q){for(var we=s(h);we!==null;){if(we.callback===null)n(h);else if(we.startTime<=Q)n(h),we.sortIndex=we.expirationTime,r(f,we);else break;we=s(h)}}function q(Q){if(S=!1,B(Q),!k)if(s(f)!==null)k=!0,X(me);else{var we=s(h);we!==null&&ye(q,we.startTime-Q)}}function me(Q,we){k=!1,S&&(S=!1,I(G),G=-1),C=!0;var pe=j;try{for(B(we),w=s(f);w!==null&&(!(w.expirationTime>we)||Q&&!he());){var se=w.callback;if(typeof se=="function"){w.callback=null,j=w.priorityLevel;var U=se(w.expirationTime<=we);we=t.unstable_now(),typeof U=="function"?w.callback=U:w===s(f)&&n(f),B(we)}else n(f);w=s(f)}if(w!==null)var ue=!0;else{var z=s(h);z!==null&&ye(q,z.startTime-we),ue=!1}return ue}finally{w=null,j=pe,C=!1}}var re=!1,M=null,G=-1,le=5,Z=-1;function he(){return!(t.unstable_now()-Z<le)}function ce(){if(M!==null){var Q=t.unstable_now();Z=Q;var we=!0;try{we=M(!0,Q)}finally{we?ke():(re=!1,M=null)}}else re=!1}var ke;if(typeof F=="function")ke=function(){F(ce)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,Fe=Ee.port2;Ee.port1.onmessage=ce,ke=function(){Fe.postMessage(null)}}else ke=function(){_(ce,0)};function X(Q){M=Q,re||(re=!0,ke())}function ye(Q,we){G=_(function(){Q(t.unstable_now())},we)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){k||C||(k=!0,X(me))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):le=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return j},t.unstable_getFirstCallbackNode=function(){return s(f)},t.unstable_next=function(Q){switch(j){case 1:case 2:case 3:var we=3;break;default:we=j}var pe=j;j=we;try{return Q()}finally{j=pe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,we){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var pe=j;j=Q;try{return we()}finally{j=pe}},t.unstable_scheduleCallback=function(Q,we,pe){var se=t.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?se+pe:se):pe=se,Q){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=pe+U,Q={id:y++,callback:we,priorityLevel:Q,startTime:pe,expirationTime:U,sortIndex:-1},pe>se?(Q.sortIndex=pe,r(h,Q),s(f)===null&&Q===s(h)&&(S?(I(G),G=-1):S=!0,ye(q,pe-se))):(Q.sortIndex=U,r(f,Q),k||C||(k=!0,X(me))),Q},t.unstable_shouldYield=he,t.unstable_wrapCallback=function(Q){var we=j;return function(){var pe=j;j=we;try{return Q.apply(this,arguments)}finally{j=pe}}}})(w0)),w0}var Wy;function GC(){return Wy||(Wy=1,b0.exports=WC()),b0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gy;function HC(){if(Gy)return ln;Gy=1;var t=nm(),r=GC();function s(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,p=1;p<arguments.length;p++)o+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function l(i,o){c(i,o),c(i+"Capture",o)}function c(i,o){for(a[i]=o,i=0;i<o.length;i++)n.add(o[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,y={},w={};function j(i){return f.call(w,i)?!0:f.call(y,i)?!1:h.test(i)?w[i]=!0:(y[i]=!0,!1)}function C(i,o,p,b){if(p!==null&&p.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return b?!1:p!==null?!p.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function k(i,o,p,b){if(o===null||typeof o>"u"||C(i,o,p,b))return!0;if(b)return!1;if(p!==null)switch(p.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function S(i,o,p,b,E,O,H){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=b,this.attributeNamespace=E,this.mustUseProperty=p,this.propertyName=i,this.type=o,this.sanitizeURL=O,this.removeEmptyString=H}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){_[i]=new S(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];_[o]=new S(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){_[i]=new S(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){_[i]=new S(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){_[i]=new S(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){_[i]=new S(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){_[i]=new S(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){_[i]=new S(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){_[i]=new S(i,5,!1,i.toLowerCase(),null,!1,!1)});var I=/[\-:]([a-z])/g;function F(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(I,F);_[o]=new S(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(I,F);_[o]=new S(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(I,F);_[o]=new S(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){_[i]=new S(i,1,!1,i.toLowerCase(),null,!1,!1)}),_.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){_[i]=new S(i,1,!1,i.toLowerCase(),null,!0,!0)});function B(i,o,p,b){var E=_.hasOwnProperty(o)?_[o]:null;(E!==null?E.type!==0:b||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(k(o,p,E,b)&&(p=null),b||E===null?j(o)&&(p===null?i.removeAttribute(o):i.setAttribute(o,""+p)):E.mustUseProperty?i[E.propertyName]=p===null?E.type===3?!1:"":p:(o=E.attributeName,b=E.attributeNamespace,p===null?i.removeAttribute(o):(E=E.type,p=E===3||E===4&&p===!0?"":""+p,b?i.setAttributeNS(b,o,p):i.setAttribute(o,p))))}var q=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,me=Symbol.for("react.element"),re=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),G=Symbol.for("react.strict_mode"),le=Symbol.for("react.profiler"),Z=Symbol.for("react.provider"),he=Symbol.for("react.context"),ce=Symbol.for("react.forward_ref"),ke=Symbol.for("react.suspense"),Ee=Symbol.for("react.suspense_list"),Fe=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),ye=Symbol.for("react.offscreen"),Q=Symbol.iterator;function we(i){return i===null||typeof i!="object"?null:(i=Q&&i[Q]||i["@@iterator"],typeof i=="function"?i:null)}var pe=Object.assign,se;function U(i){if(se===void 0)try{throw Error()}catch(p){var o=p.stack.trim().match(/\n( *(at )?)/);se=o&&o[1]||""}return`
`+se+i}var ue=!1;function z(i,o){if(!i||ue)return"";ue=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Ye){var b=Ye}Reflect.construct(i,[],o)}else{try{o.call()}catch(Ye){b=Ye}i.call(o.prototype)}else{try{throw Error()}catch(Ye){b=Ye}i()}}catch(Ye){if(Ye&&b&&typeof Ye.stack=="string"){for(var E=Ye.stack.split(`
`),O=b.stack.split(`
`),H=E.length-1,be=O.length-1;1<=H&&0<=be&&E[H]!==O[be];)be--;for(;1<=H&&0<=be;H--,be--)if(E[H]!==O[be]){if(H!==1||be!==1)do if(H--,be--,0>be||E[H]!==O[be]){var Pe=`
`+E[H].replace(" at new "," at ");return i.displayName&&Pe.includes("<anonymous>")&&(Pe=Pe.replace("<anonymous>",i.displayName)),Pe}while(1<=H&&0<=be);break}}}finally{ue=!1,Error.prepareStackTrace=p}return(i=i?i.displayName||i.name:"")?U(i):""}function ne(i){switch(i.tag){case 5:return U(i.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return i=z(i.type,!1),i;case 11:return i=z(i.type.render,!1),i;case 1:return i=z(i.type,!0),i;default:return""}}function ve(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case M:return"Fragment";case re:return"Portal";case le:return"Profiler";case G:return"StrictMode";case ke:return"Suspense";case Ee:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case he:return(i.displayName||"Context")+".Consumer";case Z:return(i._context.displayName||"Context")+".Provider";case ce:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Fe:return o=i.displayName||null,o!==null?o:ve(i.type)||"Memo";case X:o=i._payload,i=i._init;try{return ve(i(o))}catch{}}return null}function fe(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ve(o);case 8:return o===G?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Ce(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Le(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function De(i){var o=Le(i)?"checked":"value",p=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),b=""+i[o];if(!i.hasOwnProperty(o)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var E=p.get,O=p.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return E.call(this)},set:function(H){b=""+H,O.call(this,H)}}),Object.defineProperty(i,o,{enumerable:p.enumerable}),{getValue:function(){return b},setValue:function(H){b=""+H},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Ve(i){i._valueTracker||(i._valueTracker=De(i))}function tt(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var p=o.getValue(),b="";return i&&(b=Le(i)?i.checked?"true":"false":i.value),i=b,i!==p?(o.setValue(i),!0):!1}function Nt(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function lt(i,o){var p=o.checked;return pe({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??i._wrapperState.initialChecked})}function $t(i,o){var p=o.defaultValue==null?"":o.defaultValue,b=o.checked!=null?o.checked:o.defaultChecked;p=Ce(o.value!=null?o.value:p),i._wrapperState={initialChecked:b,initialValue:p,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function qe(i,o){o=o.checked,o!=null&&B(i,"checked",o,!1)}function Ie(i,o){qe(i,o);var p=Ce(o.value),b=o.type;if(p!=null)b==="number"?(p===0&&i.value===""||i.value!=p)&&(i.value=""+p):i.value!==""+p&&(i.value=""+p);else if(b==="submit"||b==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?it(i,o.type,p):o.hasOwnProperty("defaultValue")&&it(i,o.type,Ce(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function ut(i,o,p){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var b=o.type;if(!(b!=="submit"&&b!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,p||o===i.value||(i.value=o),i.defaultValue=o}p=i.name,p!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,p!==""&&(i.name=p)}function it(i,o,p){(o!=="number"||Nt(i.ownerDocument)!==i)&&(p==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+p&&(i.defaultValue=""+p))}var jt=Array.isArray;function mt(i,o,p,b){if(i=i.options,o){o={};for(var E=0;E<p.length;E++)o["$"+p[E]]=!0;for(p=0;p<i.length;p++)E=o.hasOwnProperty("$"+i[p].value),i[p].selected!==E&&(i[p].selected=E),E&&b&&(i[p].defaultSelected=!0)}else{for(p=""+Ce(p),o=null,E=0;E<i.length;E++){if(i[E].value===p){i[E].selected=!0,b&&(i[E].defaultSelected=!0);return}o!==null||i[E].disabled||(o=i[E])}o!==null&&(o.selected=!0)}}function xe(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(s(91));return pe({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Ge(i,o){var p=o.value;if(p==null){if(p=o.children,o=o.defaultValue,p!=null){if(o!=null)throw Error(s(92));if(jt(p)){if(1<p.length)throw Error(s(93));p=p[0]}o=p}o==null&&(o=""),p=o}i._wrapperState={initialValue:Ce(p)}}function ot(i,o){var p=Ce(o.value),b=Ce(o.defaultValue);p!=null&&(p=""+p,p!==i.value&&(i.value=p),o.defaultValue==null&&i.defaultValue!==p&&(i.defaultValue=p)),b!=null&&(i.defaultValue=""+b)}function et(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function He(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function It(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?He(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var yt,St=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,p,b,E){MSApp.execUnsafeLocalFunction(function(){return i(o,p,b,E)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(yt=yt||document.createElement("div"),yt.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=yt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function ct(i,o){if(o){var p=i.firstChild;if(p&&p===i.lastChild&&p.nodeType===3){p.nodeValue=o;return}}i.textContent=o}var Yt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},te=["Webkit","ms","Moz","O"];Object.keys(Yt).forEach(function(i){te.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Yt[o]=Yt[i]})});function Ze(i,o,p){return o==null||typeof o=="boolean"||o===""?"":p||typeof o!="number"||o===0||Yt.hasOwnProperty(i)&&Yt[i]?(""+o).trim():o+"px"}function at(i,o){i=i.style;for(var p in o)if(o.hasOwnProperty(p)){var b=p.indexOf("--")===0,E=Ze(p,o[p],b);p==="float"&&(p="cssFloat"),b?i.setProperty(p,E):i[p]=E}}var Ke=pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kt(i,o){if(o){if(Ke[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(s(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(s(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(s(61))}if(o.style!=null&&typeof o.style!="object")throw Error(s(62))}}function vt(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bt=null;function Et(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Qt=null,Ct=null,bt=null;function $e(i){if(i=Lo(i)){if(typeof Qt!="function")throw Error(s(280));var o=i.stateNode;o&&(o=md(o),Qt(i.stateNode,i.type,o))}}function gt(i){Ct?bt?bt.push(i):bt=[i]:Ct=i}function Pt(){if(Ct){var i=Ct,o=bt;if(bt=Ct=null,$e(i),o)for(i=0;i<o.length;i++)$e(o[i])}}function er(i,o){return i(o)}function At(){}var Ut=!1;function Vt(i,o,p){if(Ut)return i(o,p);Ut=!0;try{return er(i,o,p)}finally{Ut=!1,(Ct!==null||bt!==null)&&(At(),Pt())}}function zt(i,o){var p=i.stateNode;if(p===null)return null;var b=md(p);if(b===null)return null;p=b[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(i=i.type,b=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!b;break e;default:i=!1}if(i)return null;if(p&&typeof p!="function")throw Error(s(231,o,typeof p));return p}var rr=!1;if(u)try{var nr={};Object.defineProperty(nr,"passive",{get:function(){rr=!0}}),window.addEventListener("test",nr,nr),window.removeEventListener("test",nr,nr)}catch{rr=!1}function lr(i,o,p,b,E,O,H,be,Pe){var Ye=Array.prototype.slice.call(arguments,3);try{o.apply(p,Ye)}catch(ht){this.onError(ht)}}var ir=!1,ar=null,V=!1,ae=null,J={onError:function(i){ir=!0,ar=i}};function K(i,o,p,b,E,O,H,be,Pe){ir=!1,ar=null,lr.apply(J,arguments)}function de(i,o,p,b,E,O,H,be,Pe){if(K.apply(this,arguments),ir){if(ir){var Ye=ar;ir=!1,ar=null}else throw Error(s(198));V||(V=!0,ae=Ye)}}function oe(i){var o=i,p=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(p=o.return),i=o.return;while(i)}return o.tag===3?p:null}function _e(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function Be(i){if(oe(i)!==i)throw Error(s(188))}function Ae(i){var o=i.alternate;if(!o){if(o=oe(i),o===null)throw Error(s(188));return o!==i?null:i}for(var p=i,b=o;;){var E=p.return;if(E===null)break;var O=E.alternate;if(O===null){if(b=E.return,b!==null){p=b;continue}break}if(E.child===O.child){for(O=E.child;O;){if(O===p)return Be(E),i;if(O===b)return Be(E),o;O=O.sibling}throw Error(s(188))}if(p.return!==b.return)p=E,b=O;else{for(var H=!1,be=E.child;be;){if(be===p){H=!0,p=E,b=O;break}if(be===b){H=!0,b=E,p=O;break}be=be.sibling}if(!H){for(be=O.child;be;){if(be===p){H=!0,p=O,b=E;break}if(be===b){H=!0,b=O,p=E;break}be=be.sibling}if(!H)throw Error(s(189))}}if(p.alternate!==b)throw Error(s(190))}if(p.tag!==3)throw Error(s(188));return p.stateNode.current===p?i:o}function Ne(i){return i=Ae(i),i!==null?je(i):null}function je(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=je(i);if(o!==null)return o;i=i.sibling}return null}var Me=r.unstable_scheduleCallback,We=r.unstable_cancelCallback,ge=r.unstable_shouldYield,W=r.unstable_requestPaint,T=r.unstable_now,x=r.unstable_getCurrentPriorityLevel,P=r.unstable_ImmediatePriority,g=r.unstable_UserBlockingPriority,m=r.unstable_NormalPriority,v=r.unstable_LowPriority,N=r.unstable_IdlePriority,A=null,R=null;function D(i){if(R&&typeof R.onCommitFiberRoot=="function")try{R.onCommitFiberRoot(A,i,void 0,(i.current.flags&128)===128)}catch{}}var Te=Math.clz32?Math.clz32:ie,rt=Math.log,Y=Math.LN2;function ie(i){return i>>>=0,i===0?32:31-(rt(i)/Y|0)|0}var Oe=64,Se=4194304;function Je(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function ft(i,o){var p=i.pendingLanes;if(p===0)return 0;var b=0,E=i.suspendedLanes,O=i.pingedLanes,H=p&268435455;if(H!==0){var be=H&~E;be!==0?b=Je(be):(O&=H,O!==0&&(b=Je(O)))}else H=p&~E,H!==0?b=Je(H):O!==0&&(b=Je(O));if(b===0)return 0;if(o!==0&&o!==b&&(o&E)===0&&(E=b&-b,O=o&-o,E>=O||E===16&&(O&4194240)!==0))return o;if((b&4)!==0&&(b|=p&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=b;0<o;)p=31-Te(o),E=1<<p,b|=i[p],o&=~E;return b}function Ue(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mr(i,o){for(var p=i.suspendedLanes,b=i.pingedLanes,E=i.expirationTimes,O=i.pendingLanes;0<O;){var H=31-Te(O),be=1<<H,Pe=E[H];Pe===-1?((be&p)===0||(be&b)!==0)&&(E[H]=Ue(be,o)):Pe<=o&&(i.expiredLanes|=be),O&=~be}}function en(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Ca(){var i=Oe;return Oe<<=1,(Oe&4194240)===0&&(Oe=64),i}function qm(i){for(var o=[],p=0;31>p;p++)o.push(i);return o}function yo(i,o,p){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-Te(o),i[o]=p}function ck(i,o){var p=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var b=i.eventTimes;for(i=i.expirationTimes;0<p;){var E=31-Te(p),O=1<<E;o[E]=0,b[E]=-1,i[E]=-1,p&=~O}}function Bm(i,o){var p=i.entangledLanes|=o;for(i=i.entanglements;p;){var b=31-Te(p),E=1<<b;E&o|i[b]&o&&(i[b]|=o),p&=~E}}var Tr=0;function vf(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var bf,zm,wf,Nf,jf,$m=!1,Xc=[],Ya=null,Ka=null,Xa=null,vo=new Map,bo=new Map,Ja=[],dk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sf(i,o){switch(i){case"focusin":case"focusout":Ya=null;break;case"dragenter":case"dragleave":Ka=null;break;case"mouseover":case"mouseout":Xa=null;break;case"pointerover":case"pointerout":vo.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":bo.delete(o.pointerId)}}function wo(i,o,p,b,E,O){return i===null||i.nativeEvent!==O?(i={blockedOn:o,domEventName:p,eventSystemFlags:b,nativeEvent:O,targetContainers:[E]},o!==null&&(o=Lo(o),o!==null&&zm(o)),i):(i.eventSystemFlags|=b,o=i.targetContainers,E!==null&&o.indexOf(E)===-1&&o.push(E),i)}function uk(i,o,p,b,E){switch(o){case"focusin":return Ya=wo(Ya,i,o,p,b,E),!0;case"dragenter":return Ka=wo(Ka,i,o,p,b,E),!0;case"mouseover":return Xa=wo(Xa,i,o,p,b,E),!0;case"pointerover":var O=E.pointerId;return vo.set(O,wo(vo.get(O)||null,i,o,p,b,E)),!0;case"gotpointercapture":return O=E.pointerId,bo.set(O,wo(bo.get(O)||null,i,o,p,b,E)),!0}return!1}function kf(i){var o=Ti(i.target);if(o!==null){var p=oe(o);if(p!==null){if(o=p.tag,o===13){if(o=_e(p),o!==null){i.blockedOn=o,jf(i.priority,function(){wf(p)});return}}else if(o===3&&p.stateNode.current.memoizedState.isDehydrated){i.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Jc(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var p=Um(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(p===null){p=i.nativeEvent;var b=new p.constructor(p.type,p);Bt=b,p.target.dispatchEvent(b),Bt=null}else return o=Lo(p),o!==null&&zm(o),i.blockedOn=p,!1;o.shift()}return!0}function Cf(i,o,p){Jc(i)&&p.delete(o)}function mk(){$m=!1,Ya!==null&&Jc(Ya)&&(Ya=null),Ka!==null&&Jc(Ka)&&(Ka=null),Xa!==null&&Jc(Xa)&&(Xa=null),vo.forEach(Cf),bo.forEach(Cf)}function No(i,o){i.blockedOn===o&&(i.blockedOn=null,$m||($m=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,mk)))}function jo(i){function o(E){return No(E,i)}if(0<Xc.length){No(Xc[0],i);for(var p=1;p<Xc.length;p++){var b=Xc[p];b.blockedOn===i&&(b.blockedOn=null)}}for(Ya!==null&&No(Ya,i),Ka!==null&&No(Ka,i),Xa!==null&&No(Xa,i),vo.forEach(o),bo.forEach(o),p=0;p<Ja.length;p++)b=Ja[p],b.blockedOn===i&&(b.blockedOn=null);for(;0<Ja.length&&(p=Ja[0],p.blockedOn===null);)kf(p),p.blockedOn===null&&Ja.shift()}var pl=q.ReactCurrentBatchConfig,Zc=!0;function pk(i,o,p,b){var E=Tr,O=pl.transition;pl.transition=null;try{Tr=1,Qm(i,o,p,b)}finally{Tr=E,pl.transition=O}}function xk(i,o,p,b){var E=Tr,O=pl.transition;pl.transition=null;try{Tr=4,Qm(i,o,p,b)}finally{Tr=E,pl.transition=O}}function Qm(i,o,p,b){if(Zc){var E=Um(i,o,p,b);if(E===null)lp(i,o,b,ed,p),Sf(i,b);else if(uk(E,i,o,p,b))b.stopPropagation();else if(Sf(i,b),o&4&&-1<dk.indexOf(i)){for(;E!==null;){var O=Lo(E);if(O!==null&&bf(O),O=Um(i,o,p,b),O===null&&lp(i,o,b,ed,p),O===E)break;E=O}E!==null&&b.stopPropagation()}else lp(i,o,b,null,p)}}var ed=null;function Um(i,o,p,b){if(ed=null,i=Et(b),i=Ti(i),i!==null)if(o=oe(i),o===null)i=null;else if(p=o.tag,p===13){if(i=_e(o),i!==null)return i;i=null}else if(p===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return ed=i,null}function _f(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(x()){case P:return 1;case g:return 4;case m:case v:return 16;case N:return 536870912;default:return 16}default:return 16}}var Za=null,Vm=null,td=null;function Ef(){if(td)return td;var i,o=Vm,p=o.length,b,E="value"in Za?Za.value:Za.textContent,O=E.length;for(i=0;i<p&&o[i]===E[i];i++);var H=p-i;for(b=1;b<=H&&o[p-b]===E[O-b];b++);return td=E.slice(i,1<b?1-b:void 0)}function rd(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function sd(){return!0}function Pf(){return!1}function fn(i){function o(p,b,E,O,H){this._reactName=p,this._targetInst=E,this.type=b,this.nativeEvent=O,this.target=H,this.currentTarget=null;for(var be in i)i.hasOwnProperty(be)&&(p=i[be],this[be]=p?p(O):O[be]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?sd:Pf,this.isPropagationStopped=Pf,this}return pe(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=sd)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=sd)},persist:function(){},isPersistent:sd}),o}var xl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wm=fn(xl),So=pe({},xl,{view:0,detail:0}),hk=fn(So),Gm,Hm,ko,nd=pe({},So,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Km,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ko&&(ko&&i.type==="mousemove"?(Gm=i.screenX-ko.screenX,Hm=i.screenY-ko.screenY):Hm=Gm=0,ko=i),Gm)},movementY:function(i){return"movementY"in i?i.movementY:Hm}}),Af=fn(nd),fk=pe({},nd,{dataTransfer:0}),gk=fn(fk),yk=pe({},So,{relatedTarget:0}),Ym=fn(yk),vk=pe({},xl,{animationName:0,elapsedTime:0,pseudoElement:0}),bk=fn(vk),wk=pe({},xl,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Nk=fn(wk),jk=pe({},xl,{data:0}),Tf=fn(jk),Sk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ck={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _k(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Ck[i])?!!o[i]:!1}function Km(){return _k}var Ek=pe({},So,{key:function(i){if(i.key){var o=Sk[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=rd(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?kk[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Km,charCode:function(i){return i.type==="keypress"?rd(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?rd(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Pk=fn(Ek),Ak=pe({},nd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Of=fn(Ak),Tk=pe({},So,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Km}),Ok=fn(Tk),Rk=pe({},xl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dk=fn(Rk),Lk=pe({},nd,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Fk=fn(Lk),Mk=[9,13,27,32],Xm=u&&"CompositionEvent"in window,Co=null;u&&"documentMode"in document&&(Co=document.documentMode);var Ik=u&&"TextEvent"in window&&!Co,Rf=u&&(!Xm||Co&&8<Co&&11>=Co),Df=" ",Lf=!1;function Ff(i,o){switch(i){case"keyup":return Mk.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mf(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var hl=!1;function qk(i,o){switch(i){case"compositionend":return Mf(o);case"keypress":return o.which!==32?null:(Lf=!0,Df);case"textInput":return i=o.data,i===Df&&Lf?null:i;default:return null}}function Bk(i,o){if(hl)return i==="compositionend"||!Xm&&Ff(i,o)?(i=Ef(),td=Vm=Za=null,hl=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Rf&&o.locale!=="ko"?null:o.data;default:return null}}var zk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function If(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!zk[i.type]:o==="textarea"}function qf(i,o,p,b){gt(b),o=cd(o,"onChange"),0<o.length&&(p=new Wm("onChange","change",null,p,b),i.push({event:p,listeners:o}))}var _o=null,Eo=null;function $k(i){sg(i,0)}function ad(i){var o=bl(i);if(tt(o))return i}function Qk(i,o){if(i==="change")return o}var Bf=!1;if(u){var Jm;if(u){var Zm="oninput"in document;if(!Zm){var zf=document.createElement("div");zf.setAttribute("oninput","return;"),Zm=typeof zf.oninput=="function"}Jm=Zm}else Jm=!1;Bf=Jm&&(!document.documentMode||9<document.documentMode)}function $f(){_o&&(_o.detachEvent("onpropertychange",Qf),Eo=_o=null)}function Qf(i){if(i.propertyName==="value"&&ad(Eo)){var o=[];qf(o,Eo,i,Et(i)),Vt($k,o)}}function Uk(i,o,p){i==="focusin"?($f(),_o=o,Eo=p,_o.attachEvent("onpropertychange",Qf)):i==="focusout"&&$f()}function Vk(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return ad(Eo)}function Wk(i,o){if(i==="click")return ad(o)}function Gk(i,o){if(i==="input"||i==="change")return ad(o)}function Hk(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var qn=typeof Object.is=="function"?Object.is:Hk;function Po(i,o){if(qn(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var p=Object.keys(i),b=Object.keys(o);if(p.length!==b.length)return!1;for(b=0;b<p.length;b++){var E=p[b];if(!f.call(o,E)||!qn(i[E],o[E]))return!1}return!0}function Uf(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Vf(i,o){var p=Uf(i);i=0;for(var b;p;){if(p.nodeType===3){if(b=i+p.textContent.length,i<=o&&b>=o)return{node:p,offset:o-i};i=b}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Uf(p)}}function Wf(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Wf(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Gf(){for(var i=window,o=Nt();o instanceof i.HTMLIFrameElement;){try{var p=typeof o.contentWindow.location.href=="string"}catch{p=!1}if(p)i=o.contentWindow;else break;o=Nt(i.document)}return o}function ep(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function Yk(i){var o=Gf(),p=i.focusedElem,b=i.selectionRange;if(o!==p&&p&&p.ownerDocument&&Wf(p.ownerDocument.documentElement,p)){if(b!==null&&ep(p)){if(o=b.start,i=b.end,i===void 0&&(i=o),"selectionStart"in p)p.selectionStart=o,p.selectionEnd=Math.min(i,p.value.length);else if(i=(o=p.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var E=p.textContent.length,O=Math.min(b.start,E);b=b.end===void 0?O:Math.min(b.end,E),!i.extend&&O>b&&(E=b,b=O,O=E),E=Vf(p,O);var H=Vf(p,b);E&&H&&(i.rangeCount!==1||i.anchorNode!==E.node||i.anchorOffset!==E.offset||i.focusNode!==H.node||i.focusOffset!==H.offset)&&(o=o.createRange(),o.setStart(E.node,E.offset),i.removeAllRanges(),O>b?(i.addRange(o),i.extend(H.node,H.offset)):(o.setEnd(H.node,H.offset),i.addRange(o)))}}for(o=[],i=p;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<o.length;p++)i=o[p],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Kk=u&&"documentMode"in document&&11>=document.documentMode,fl=null,tp=null,Ao=null,rp=!1;function Hf(i,o,p){var b=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;rp||fl==null||fl!==Nt(b)||(b=fl,"selectionStart"in b&&ep(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),Ao&&Po(Ao,b)||(Ao=b,b=cd(tp,"onSelect"),0<b.length&&(o=new Wm("onSelect","select",null,o,p),i.push({event:o,listeners:b}),o.target=fl)))}function id(i,o){var p={};return p[i.toLowerCase()]=o.toLowerCase(),p["Webkit"+i]="webkit"+o,p["Moz"+i]="moz"+o,p}var gl={animationend:id("Animation","AnimationEnd"),animationiteration:id("Animation","AnimationIteration"),animationstart:id("Animation","AnimationStart"),transitionend:id("Transition","TransitionEnd")},sp={},Yf={};u&&(Yf=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function ld(i){if(sp[i])return sp[i];if(!gl[i])return i;var o=gl[i],p;for(p in o)if(o.hasOwnProperty(p)&&p in Yf)return sp[i]=o[p];return i}var Kf=ld("animationend"),Xf=ld("animationiteration"),Jf=ld("animationstart"),Zf=ld("transitionend"),eg=new Map,tg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ei(i,o){eg.set(i,o),l(o,[i])}for(var np=0;np<tg.length;np++){var ap=tg[np],Xk=ap.toLowerCase(),Jk=ap[0].toUpperCase()+ap.slice(1);ei(Xk,"on"+Jk)}ei(Kf,"onAnimationEnd"),ei(Xf,"onAnimationIteration"),ei(Jf,"onAnimationStart"),ei("dblclick","onDoubleClick"),ei("focusin","onFocus"),ei("focusout","onBlur"),ei(Zf,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var To="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zk=new Set("cancel close invalid load scroll toggle".split(" ").concat(To));function rg(i,o,p){var b=i.type||"unknown-event";i.currentTarget=p,de(b,o,void 0,i),i.currentTarget=null}function sg(i,o){o=(o&4)!==0;for(var p=0;p<i.length;p++){var b=i[p],E=b.event;b=b.listeners;e:{var O=void 0;if(o)for(var H=b.length-1;0<=H;H--){var be=b[H],Pe=be.instance,Ye=be.currentTarget;if(be=be.listener,Pe!==O&&E.isPropagationStopped())break e;rg(E,be,Ye),O=Pe}else for(H=0;H<b.length;H++){if(be=b[H],Pe=be.instance,Ye=be.currentTarget,be=be.listener,Pe!==O&&E.isPropagationStopped())break e;rg(E,be,Ye),O=Pe}}}if(V)throw i=ae,V=!1,ae=null,i}function $r(i,o){var p=o[pp];p===void 0&&(p=o[pp]=new Set);var b=i+"__bubble";p.has(b)||(ng(o,i,2,!1),p.add(b))}function ip(i,o,p){var b=0;o&&(b|=4),ng(p,i,b,o)}var od="_reactListening"+Math.random().toString(36).slice(2);function Oo(i){if(!i[od]){i[od]=!0,n.forEach(function(p){p!=="selectionchange"&&(Zk.has(p)||ip(p,!1,i),ip(p,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[od]||(o[od]=!0,ip("selectionchange",!1,o))}}function ng(i,o,p,b){switch(_f(o)){case 1:var E=pk;break;case 4:E=xk;break;default:E=Qm}p=E.bind(null,o,p,i),E=void 0,!rr||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(E=!0),b?E!==void 0?i.addEventListener(o,p,{capture:!0,passive:E}):i.addEventListener(o,p,!0):E!==void 0?i.addEventListener(o,p,{passive:E}):i.addEventListener(o,p,!1)}function lp(i,o,p,b,E){var O=b;if((o&1)===0&&(o&2)===0&&b!==null)e:for(;;){if(b===null)return;var H=b.tag;if(H===3||H===4){var be=b.stateNode.containerInfo;if(be===E||be.nodeType===8&&be.parentNode===E)break;if(H===4)for(H=b.return;H!==null;){var Pe=H.tag;if((Pe===3||Pe===4)&&(Pe=H.stateNode.containerInfo,Pe===E||Pe.nodeType===8&&Pe.parentNode===E))return;H=H.return}for(;be!==null;){if(H=Ti(be),H===null)return;if(Pe=H.tag,Pe===5||Pe===6){b=O=H;continue e}be=be.parentNode}}b=b.return}Vt(function(){var Ye=O,ht=Et(p),wt=[];e:{var pt=eg.get(i);if(pt!==void 0){var Wt=Wm,Kt=i;switch(i){case"keypress":if(rd(p)===0)break e;case"keydown":case"keyup":Wt=Pk;break;case"focusin":Kt="focus",Wt=Ym;break;case"focusout":Kt="blur",Wt=Ym;break;case"beforeblur":case"afterblur":Wt=Ym;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Wt=Af;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Wt=gk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Wt=Ok;break;case Kf:case Xf:case Jf:Wt=bk;break;case Zf:Wt=Dk;break;case"scroll":Wt=hk;break;case"wheel":Wt=Fk;break;case"copy":case"cut":case"paste":Wt=Nk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Wt=Of}var tr=(o&4)!==0,cs=!tr&&i==="scroll",ze=tr?pt!==null?pt+"Capture":null:pt;tr=[];for(var Re=Ye,Qe;Re!==null;){Qe=Re;var _t=Qe.stateNode;if(Qe.tag===5&&_t!==null&&(Qe=_t,ze!==null&&(_t=zt(Re,ze),_t!=null&&tr.push(Ro(Re,_t,Qe)))),cs)break;Re=Re.return}0<tr.length&&(pt=new Wt(pt,Kt,null,p,ht),wt.push({event:pt,listeners:tr}))}}if((o&7)===0){e:{if(pt=i==="mouseover"||i==="pointerover",Wt=i==="mouseout"||i==="pointerout",pt&&p!==Bt&&(Kt=p.relatedTarget||p.fromElement)&&(Ti(Kt)||Kt[_a]))break e;if((Wt||pt)&&(pt=ht.window===ht?ht:(pt=ht.ownerDocument)?pt.defaultView||pt.parentWindow:window,Wt?(Kt=p.relatedTarget||p.toElement,Wt=Ye,Kt=Kt?Ti(Kt):null,Kt!==null&&(cs=oe(Kt),Kt!==cs||Kt.tag!==5&&Kt.tag!==6)&&(Kt=null)):(Wt=null,Kt=Ye),Wt!==Kt)){if(tr=Af,_t="onMouseLeave",ze="onMouseEnter",Re="mouse",(i==="pointerout"||i==="pointerover")&&(tr=Of,_t="onPointerLeave",ze="onPointerEnter",Re="pointer"),cs=Wt==null?pt:bl(Wt),Qe=Kt==null?pt:bl(Kt),pt=new tr(_t,Re+"leave",Wt,p,ht),pt.target=cs,pt.relatedTarget=Qe,_t=null,Ti(ht)===Ye&&(tr=new tr(ze,Re+"enter",Kt,p,ht),tr.target=Qe,tr.relatedTarget=cs,_t=tr),cs=_t,Wt&&Kt)t:{for(tr=Wt,ze=Kt,Re=0,Qe=tr;Qe;Qe=yl(Qe))Re++;for(Qe=0,_t=ze;_t;_t=yl(_t))Qe++;for(;0<Re-Qe;)tr=yl(tr),Re--;for(;0<Qe-Re;)ze=yl(ze),Qe--;for(;Re--;){if(tr===ze||ze!==null&&tr===ze.alternate)break t;tr=yl(tr),ze=yl(ze)}tr=null}else tr=null;Wt!==null&&ag(wt,pt,Wt,tr,!1),Kt!==null&&cs!==null&&ag(wt,cs,Kt,tr,!0)}}e:{if(pt=Ye?bl(Ye):window,Wt=pt.nodeName&&pt.nodeName.toLowerCase(),Wt==="select"||Wt==="input"&&pt.type==="file")var sr=Qk;else if(If(pt))if(Bf)sr=Gk;else{sr=Vk;var or=Uk}else(Wt=pt.nodeName)&&Wt.toLowerCase()==="input"&&(pt.type==="checkbox"||pt.type==="radio")&&(sr=Wk);if(sr&&(sr=sr(i,Ye))){qf(wt,sr,p,ht);break e}or&&or(i,pt,Ye),i==="focusout"&&(or=pt._wrapperState)&&or.controlled&&pt.type==="number"&&it(pt,"number",pt.value)}switch(or=Ye?bl(Ye):window,i){case"focusin":(If(or)||or.contentEditable==="true")&&(fl=or,tp=Ye,Ao=null);break;case"focusout":Ao=tp=fl=null;break;case"mousedown":rp=!0;break;case"contextmenu":case"mouseup":case"dragend":rp=!1,Hf(wt,p,ht);break;case"selectionchange":if(Kk)break;case"keydown":case"keyup":Hf(wt,p,ht)}var cr;if(Xm)e:{switch(i){case"compositionstart":var ur="onCompositionStart";break e;case"compositionend":ur="onCompositionEnd";break e;case"compositionupdate":ur="onCompositionUpdate";break e}ur=void 0}else hl?Ff(i,p)&&(ur="onCompositionEnd"):i==="keydown"&&p.keyCode===229&&(ur="onCompositionStart");ur&&(Rf&&p.locale!=="ko"&&(hl||ur!=="onCompositionStart"?ur==="onCompositionEnd"&&hl&&(cr=Ef()):(Za=ht,Vm="value"in Za?Za.value:Za.textContent,hl=!0)),or=cd(Ye,ur),0<or.length&&(ur=new Tf(ur,i,null,p,ht),wt.push({event:ur,listeners:or}),cr?ur.data=cr:(cr=Mf(p),cr!==null&&(ur.data=cr)))),(cr=Ik?qk(i,p):Bk(i,p))&&(Ye=cd(Ye,"onBeforeInput"),0<Ye.length&&(ht=new Tf("onBeforeInput","beforeinput",null,p,ht),wt.push({event:ht,listeners:Ye}),ht.data=cr))}sg(wt,o)})}function Ro(i,o,p){return{instance:i,listener:o,currentTarget:p}}function cd(i,o){for(var p=o+"Capture",b=[];i!==null;){var E=i,O=E.stateNode;E.tag===5&&O!==null&&(E=O,O=zt(i,p),O!=null&&b.unshift(Ro(i,O,E)),O=zt(i,o),O!=null&&b.push(Ro(i,O,E))),i=i.return}return b}function yl(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function ag(i,o,p,b,E){for(var O=o._reactName,H=[];p!==null&&p!==b;){var be=p,Pe=be.alternate,Ye=be.stateNode;if(Pe!==null&&Pe===b)break;be.tag===5&&Ye!==null&&(be=Ye,E?(Pe=zt(p,O),Pe!=null&&H.unshift(Ro(p,Pe,be))):E||(Pe=zt(p,O),Pe!=null&&H.push(Ro(p,Pe,be)))),p=p.return}H.length!==0&&i.push({event:o,listeners:H})}var eC=/\r\n?/g,tC=/\u0000|\uFFFD/g;function ig(i){return(typeof i=="string"?i:""+i).replace(eC,`
`).replace(tC,"")}function dd(i,o,p){if(o=ig(o),ig(i)!==o&&p)throw Error(s(425))}function ud(){}var op=null,cp=null;function dp(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var up=typeof setTimeout=="function"?setTimeout:void 0,rC=typeof clearTimeout=="function"?clearTimeout:void 0,lg=typeof Promise=="function"?Promise:void 0,sC=typeof queueMicrotask=="function"?queueMicrotask:typeof lg<"u"?function(i){return lg.resolve(null).then(i).catch(nC)}:up;function nC(i){setTimeout(function(){throw i})}function mp(i,o){var p=o,b=0;do{var E=p.nextSibling;if(i.removeChild(p),E&&E.nodeType===8)if(p=E.data,p==="/$"){if(b===0){i.removeChild(E),jo(o);return}b--}else p!=="$"&&p!=="$?"&&p!=="$!"||b++;p=E}while(p);jo(o)}function ti(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function og(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var p=i.data;if(p==="$"||p==="$!"||p==="$?"){if(o===0)return i;o--}else p==="/$"&&o++}i=i.previousSibling}return null}var vl=Math.random().toString(36).slice(2),la="__reactFiber$"+vl,Do="__reactProps$"+vl,_a="__reactContainer$"+vl,pp="__reactEvents$"+vl,aC="__reactListeners$"+vl,iC="__reactHandles$"+vl;function Ti(i){var o=i[la];if(o)return o;for(var p=i.parentNode;p;){if(o=p[_a]||p[la]){if(p=o.alternate,o.child!==null||p!==null&&p.child!==null)for(i=og(i);i!==null;){if(p=i[la])return p;i=og(i)}return o}i=p,p=i.parentNode}return null}function Lo(i){return i=i[la]||i[_a],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function bl(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(s(33))}function md(i){return i[Do]||null}var xp=[],wl=-1;function ri(i){return{current:i}}function Qr(i){0>wl||(i.current=xp[wl],xp[wl]=null,wl--)}function qr(i,o){wl++,xp[wl]=i.current,i.current=o}var si={},qs=ri(si),tn=ri(!1),Oi=si;function Nl(i,o){var p=i.type.contextTypes;if(!p)return si;var b=i.stateNode;if(b&&b.__reactInternalMemoizedUnmaskedChildContext===o)return b.__reactInternalMemoizedMaskedChildContext;var E={},O;for(O in p)E[O]=o[O];return b&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=E),E}function rn(i){return i=i.childContextTypes,i!=null}function pd(){Qr(tn),Qr(qs)}function cg(i,o,p){if(qs.current!==si)throw Error(s(168));qr(qs,o),qr(tn,p)}function dg(i,o,p){var b=i.stateNode;if(o=o.childContextTypes,typeof b.getChildContext!="function")return p;b=b.getChildContext();for(var E in b)if(!(E in o))throw Error(s(108,fe(i)||"Unknown",E));return pe({},p,b)}function xd(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||si,Oi=qs.current,qr(qs,i),qr(tn,tn.current),!0}function ug(i,o,p){var b=i.stateNode;if(!b)throw Error(s(169));p?(i=dg(i,o,Oi),b.__reactInternalMemoizedMergedChildContext=i,Qr(tn),Qr(qs),qr(qs,i)):Qr(tn),qr(tn,p)}var Ea=null,hd=!1,hp=!1;function mg(i){Ea===null?Ea=[i]:Ea.push(i)}function lC(i){hd=!0,mg(i)}function ni(){if(!hp&&Ea!==null){hp=!0;var i=0,o=Tr;try{var p=Ea;for(Tr=1;i<p.length;i++){var b=p[i];do b=b(!0);while(b!==null)}Ea=null,hd=!1}catch(E){throw Ea!==null&&(Ea=Ea.slice(i+1)),Me(P,ni),E}finally{Tr=o,hp=!1}}return null}var jl=[],Sl=0,fd=null,gd=0,Pn=[],An=0,Ri=null,Pa=1,Aa="";function Di(i,o){jl[Sl++]=gd,jl[Sl++]=fd,fd=i,gd=o}function pg(i,o,p){Pn[An++]=Pa,Pn[An++]=Aa,Pn[An++]=Ri,Ri=i;var b=Pa;i=Aa;var E=32-Te(b)-1;b&=~(1<<E),p+=1;var O=32-Te(o)+E;if(30<O){var H=E-E%5;O=(b&(1<<H)-1).toString(32),b>>=H,E-=H,Pa=1<<32-Te(o)+E|p<<E|b,Aa=O+i}else Pa=1<<O|p<<E|b,Aa=i}function fp(i){i.return!==null&&(Di(i,1),pg(i,1,0))}function gp(i){for(;i===fd;)fd=jl[--Sl],jl[Sl]=null,gd=jl[--Sl],jl[Sl]=null;for(;i===Ri;)Ri=Pn[--An],Pn[An]=null,Aa=Pn[--An],Pn[An]=null,Pa=Pn[--An],Pn[An]=null}var gn=null,yn=null,Wr=!1,Bn=null;function xg(i,o){var p=Dn(5,null,null,0);p.elementType="DELETED",p.stateNode=o,p.return=i,o=i.deletions,o===null?(i.deletions=[p],i.flags|=16):o.push(p)}function hg(i,o){switch(i.tag){case 5:var p=i.type;return o=o.nodeType!==1||p.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,gn=i,yn=ti(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,gn=i,yn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(p=Ri!==null?{id:Pa,overflow:Aa}:null,i.memoizedState={dehydrated:o,treeContext:p,retryLane:1073741824},p=Dn(18,null,null,0),p.stateNode=o,p.return=i,i.child=p,gn=i,yn=null,!0):!1;default:return!1}}function yp(i){return(i.mode&1)!==0&&(i.flags&128)===0}function vp(i){if(Wr){var o=yn;if(o){var p=o;if(!hg(i,o)){if(yp(i))throw Error(s(418));o=ti(p.nextSibling);var b=gn;o&&hg(i,o)?xg(b,p):(i.flags=i.flags&-4097|2,Wr=!1,gn=i)}}else{if(yp(i))throw Error(s(418));i.flags=i.flags&-4097|2,Wr=!1,gn=i}}}function fg(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;gn=i}function yd(i){if(i!==gn)return!1;if(!Wr)return fg(i),Wr=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!dp(i.type,i.memoizedProps)),o&&(o=yn)){if(yp(i))throw gg(),Error(s(418));for(;o;)xg(i,o),o=ti(o.nextSibling)}if(fg(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(s(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var p=i.data;if(p==="/$"){if(o===0){yn=ti(i.nextSibling);break e}o--}else p!=="$"&&p!=="$!"&&p!=="$?"||o++}i=i.nextSibling}yn=null}}else yn=gn?ti(i.stateNode.nextSibling):null;return!0}function gg(){for(var i=yn;i;)i=ti(i.nextSibling)}function kl(){yn=gn=null,Wr=!1}function bp(i){Bn===null?Bn=[i]:Bn.push(i)}var oC=q.ReactCurrentBatchConfig;function Fo(i,o,p){if(i=p.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(s(309));var b=p.stateNode}if(!b)throw Error(s(147,i));var E=b,O=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===O?o.ref:(o=function(H){var be=E.refs;H===null?delete be[O]:be[O]=H},o._stringRef=O,o)}if(typeof i!="string")throw Error(s(284));if(!p._owner)throw Error(s(290,i))}return i}function vd(i,o){throw i=Object.prototype.toString.call(o),Error(s(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function yg(i){var o=i._init;return o(i._payload)}function vg(i){function o(ze,Re){if(i){var Qe=ze.deletions;Qe===null?(ze.deletions=[Re],ze.flags|=16):Qe.push(Re)}}function p(ze,Re){if(!i)return null;for(;Re!==null;)o(ze,Re),Re=Re.sibling;return null}function b(ze,Re){for(ze=new Map;Re!==null;)Re.key!==null?ze.set(Re.key,Re):ze.set(Re.index,Re),Re=Re.sibling;return ze}function E(ze,Re){return ze=mi(ze,Re),ze.index=0,ze.sibling=null,ze}function O(ze,Re,Qe){return ze.index=Qe,i?(Qe=ze.alternate,Qe!==null?(Qe=Qe.index,Qe<Re?(ze.flags|=2,Re):Qe):(ze.flags|=2,Re)):(ze.flags|=1048576,Re)}function H(ze){return i&&ze.alternate===null&&(ze.flags|=2),ze}function be(ze,Re,Qe,_t){return Re===null||Re.tag!==6?(Re=u0(Qe,ze.mode,_t),Re.return=ze,Re):(Re=E(Re,Qe),Re.return=ze,Re)}function Pe(ze,Re,Qe,_t){var sr=Qe.type;return sr===M?ht(ze,Re,Qe.props.children,_t,Qe.key):Re!==null&&(Re.elementType===sr||typeof sr=="object"&&sr!==null&&sr.$$typeof===X&&yg(sr)===Re.type)?(_t=E(Re,Qe.props),_t.ref=Fo(ze,Re,Qe),_t.return=ze,_t):(_t=Qd(Qe.type,Qe.key,Qe.props,null,ze.mode,_t),_t.ref=Fo(ze,Re,Qe),_t.return=ze,_t)}function Ye(ze,Re,Qe,_t){return Re===null||Re.tag!==4||Re.stateNode.containerInfo!==Qe.containerInfo||Re.stateNode.implementation!==Qe.implementation?(Re=m0(Qe,ze.mode,_t),Re.return=ze,Re):(Re=E(Re,Qe.children||[]),Re.return=ze,Re)}function ht(ze,Re,Qe,_t,sr){return Re===null||Re.tag!==7?(Re=$i(Qe,ze.mode,_t,sr),Re.return=ze,Re):(Re=E(Re,Qe),Re.return=ze,Re)}function wt(ze,Re,Qe){if(typeof Re=="string"&&Re!==""||typeof Re=="number")return Re=u0(""+Re,ze.mode,Qe),Re.return=ze,Re;if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case me:return Qe=Qd(Re.type,Re.key,Re.props,null,ze.mode,Qe),Qe.ref=Fo(ze,null,Re),Qe.return=ze,Qe;case re:return Re=m0(Re,ze.mode,Qe),Re.return=ze,Re;case X:var _t=Re._init;return wt(ze,_t(Re._payload),Qe)}if(jt(Re)||we(Re))return Re=$i(Re,ze.mode,Qe,null),Re.return=ze,Re;vd(ze,Re)}return null}function pt(ze,Re,Qe,_t){var sr=Re!==null?Re.key:null;if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number")return sr!==null?null:be(ze,Re,""+Qe,_t);if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case me:return Qe.key===sr?Pe(ze,Re,Qe,_t):null;case re:return Qe.key===sr?Ye(ze,Re,Qe,_t):null;case X:return sr=Qe._init,pt(ze,Re,sr(Qe._payload),_t)}if(jt(Qe)||we(Qe))return sr!==null?null:ht(ze,Re,Qe,_t,null);vd(ze,Qe)}return null}function Wt(ze,Re,Qe,_t,sr){if(typeof _t=="string"&&_t!==""||typeof _t=="number")return ze=ze.get(Qe)||null,be(Re,ze,""+_t,sr);if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case me:return ze=ze.get(_t.key===null?Qe:_t.key)||null,Pe(Re,ze,_t,sr);case re:return ze=ze.get(_t.key===null?Qe:_t.key)||null,Ye(Re,ze,_t,sr);case X:var or=_t._init;return Wt(ze,Re,Qe,or(_t._payload),sr)}if(jt(_t)||we(_t))return ze=ze.get(Qe)||null,ht(Re,ze,_t,sr,null);vd(Re,_t)}return null}function Kt(ze,Re,Qe,_t){for(var sr=null,or=null,cr=Re,ur=Re=0,Cs=null;cr!==null&&ur<Qe.length;ur++){cr.index>ur?(Cs=cr,cr=null):Cs=cr.sibling;var kr=pt(ze,cr,Qe[ur],_t);if(kr===null){cr===null&&(cr=Cs);break}i&&cr&&kr.alternate===null&&o(ze,cr),Re=O(kr,Re,ur),or===null?sr=kr:or.sibling=kr,or=kr,cr=Cs}if(ur===Qe.length)return p(ze,cr),Wr&&Di(ze,ur),sr;if(cr===null){for(;ur<Qe.length;ur++)cr=wt(ze,Qe[ur],_t),cr!==null&&(Re=O(cr,Re,ur),or===null?sr=cr:or.sibling=cr,or=cr);return Wr&&Di(ze,ur),sr}for(cr=b(ze,cr);ur<Qe.length;ur++)Cs=Wt(cr,ze,ur,Qe[ur],_t),Cs!==null&&(i&&Cs.alternate!==null&&cr.delete(Cs.key===null?ur:Cs.key),Re=O(Cs,Re,ur),or===null?sr=Cs:or.sibling=Cs,or=Cs);return i&&cr.forEach(function(pi){return o(ze,pi)}),Wr&&Di(ze,ur),sr}function tr(ze,Re,Qe,_t){var sr=we(Qe);if(typeof sr!="function")throw Error(s(150));if(Qe=sr.call(Qe),Qe==null)throw Error(s(151));for(var or=sr=null,cr=Re,ur=Re=0,Cs=null,kr=Qe.next();cr!==null&&!kr.done;ur++,kr=Qe.next()){cr.index>ur?(Cs=cr,cr=null):Cs=cr.sibling;var pi=pt(ze,cr,kr.value,_t);if(pi===null){cr===null&&(cr=Cs);break}i&&cr&&pi.alternate===null&&o(ze,cr),Re=O(pi,Re,ur),or===null?sr=pi:or.sibling=pi,or=pi,cr=Cs}if(kr.done)return p(ze,cr),Wr&&Di(ze,ur),sr;if(cr===null){for(;!kr.done;ur++,kr=Qe.next())kr=wt(ze,kr.value,_t),kr!==null&&(Re=O(kr,Re,ur),or===null?sr=kr:or.sibling=kr,or=kr);return Wr&&Di(ze,ur),sr}for(cr=b(ze,cr);!kr.done;ur++,kr=Qe.next())kr=Wt(cr,ze,ur,kr.value,_t),kr!==null&&(i&&kr.alternate!==null&&cr.delete(kr.key===null?ur:kr.key),Re=O(kr,Re,ur),or===null?sr=kr:or.sibling=kr,or=kr);return i&&cr.forEach(function(zC){return o(ze,zC)}),Wr&&Di(ze,ur),sr}function cs(ze,Re,Qe,_t){if(typeof Qe=="object"&&Qe!==null&&Qe.type===M&&Qe.key===null&&(Qe=Qe.props.children),typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case me:e:{for(var sr=Qe.key,or=Re;or!==null;){if(or.key===sr){if(sr=Qe.type,sr===M){if(or.tag===7){p(ze,or.sibling),Re=E(or,Qe.props.children),Re.return=ze,ze=Re;break e}}else if(or.elementType===sr||typeof sr=="object"&&sr!==null&&sr.$$typeof===X&&yg(sr)===or.type){p(ze,or.sibling),Re=E(or,Qe.props),Re.ref=Fo(ze,or,Qe),Re.return=ze,ze=Re;break e}p(ze,or);break}else o(ze,or);or=or.sibling}Qe.type===M?(Re=$i(Qe.props.children,ze.mode,_t,Qe.key),Re.return=ze,ze=Re):(_t=Qd(Qe.type,Qe.key,Qe.props,null,ze.mode,_t),_t.ref=Fo(ze,Re,Qe),_t.return=ze,ze=_t)}return H(ze);case re:e:{for(or=Qe.key;Re!==null;){if(Re.key===or)if(Re.tag===4&&Re.stateNode.containerInfo===Qe.containerInfo&&Re.stateNode.implementation===Qe.implementation){p(ze,Re.sibling),Re=E(Re,Qe.children||[]),Re.return=ze,ze=Re;break e}else{p(ze,Re);break}else o(ze,Re);Re=Re.sibling}Re=m0(Qe,ze.mode,_t),Re.return=ze,ze=Re}return H(ze);case X:return or=Qe._init,cs(ze,Re,or(Qe._payload),_t)}if(jt(Qe))return Kt(ze,Re,Qe,_t);if(we(Qe))return tr(ze,Re,Qe,_t);vd(ze,Qe)}return typeof Qe=="string"&&Qe!==""||typeof Qe=="number"?(Qe=""+Qe,Re!==null&&Re.tag===6?(p(ze,Re.sibling),Re=E(Re,Qe),Re.return=ze,ze=Re):(p(ze,Re),Re=u0(Qe,ze.mode,_t),Re.return=ze,ze=Re),H(ze)):p(ze,Re)}return cs}var Cl=vg(!0),bg=vg(!1),bd=ri(null),wd=null,_l=null,wp=null;function Np(){wp=_l=wd=null}function jp(i){var o=bd.current;Qr(bd),i._currentValue=o}function Sp(i,o,p){for(;i!==null;){var b=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,b!==null&&(b.childLanes|=o)):b!==null&&(b.childLanes&o)!==o&&(b.childLanes|=o),i===p)break;i=i.return}}function El(i,o){wd=i,wp=_l=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(sn=!0),i.firstContext=null)}function Tn(i){var o=i._currentValue;if(wp!==i)if(i={context:i,memoizedValue:o,next:null},_l===null){if(wd===null)throw Error(s(308));_l=i,wd.dependencies={lanes:0,firstContext:i}}else _l=_l.next=i;return o}var Li=null;function kp(i){Li===null?Li=[i]:Li.push(i)}function wg(i,o,p,b){var E=o.interleaved;return E===null?(p.next=p,kp(o)):(p.next=E.next,E.next=p),o.interleaved=p,Ta(i,b)}function Ta(i,o){i.lanes|=o;var p=i.alternate;for(p!==null&&(p.lanes|=o),p=i,i=i.return;i!==null;)i.childLanes|=o,p=i.alternate,p!==null&&(p.childLanes|=o),p=i,i=i.return;return p.tag===3?p.stateNode:null}var ai=!1;function Cp(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ng(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Oa(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function ii(i,o,p){var b=i.updateQueue;if(b===null)return null;if(b=b.shared,(jr&2)!==0){var E=b.pending;return E===null?o.next=o:(o.next=E.next,E.next=o),b.pending=o,Ta(i,p)}return E=b.interleaved,E===null?(o.next=o,kp(b)):(o.next=E.next,E.next=o),b.interleaved=o,Ta(i,p)}function Nd(i,o,p){if(o=o.updateQueue,o!==null&&(o=o.shared,(p&4194240)!==0)){var b=o.lanes;b&=i.pendingLanes,p|=b,o.lanes=p,Bm(i,p)}}function jg(i,o){var p=i.updateQueue,b=i.alternate;if(b!==null&&(b=b.updateQueue,p===b)){var E=null,O=null;if(p=p.firstBaseUpdate,p!==null){do{var H={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};O===null?E=O=H:O=O.next=H,p=p.next}while(p!==null);O===null?E=O=o:O=O.next=o}else E=O=o;p={baseState:b.baseState,firstBaseUpdate:E,lastBaseUpdate:O,shared:b.shared,effects:b.effects},i.updateQueue=p;return}i=p.lastBaseUpdate,i===null?p.firstBaseUpdate=o:i.next=o,p.lastBaseUpdate=o}function jd(i,o,p,b){var E=i.updateQueue;ai=!1;var O=E.firstBaseUpdate,H=E.lastBaseUpdate,be=E.shared.pending;if(be!==null){E.shared.pending=null;var Pe=be,Ye=Pe.next;Pe.next=null,H===null?O=Ye:H.next=Ye,H=Pe;var ht=i.alternate;ht!==null&&(ht=ht.updateQueue,be=ht.lastBaseUpdate,be!==H&&(be===null?ht.firstBaseUpdate=Ye:be.next=Ye,ht.lastBaseUpdate=Pe))}if(O!==null){var wt=E.baseState;H=0,ht=Ye=Pe=null,be=O;do{var pt=be.lane,Wt=be.eventTime;if((b&pt)===pt){ht!==null&&(ht=ht.next={eventTime:Wt,lane:0,tag:be.tag,payload:be.payload,callback:be.callback,next:null});e:{var Kt=i,tr=be;switch(pt=o,Wt=p,tr.tag){case 1:if(Kt=tr.payload,typeof Kt=="function"){wt=Kt.call(Wt,wt,pt);break e}wt=Kt;break e;case 3:Kt.flags=Kt.flags&-65537|128;case 0:if(Kt=tr.payload,pt=typeof Kt=="function"?Kt.call(Wt,wt,pt):Kt,pt==null)break e;wt=pe({},wt,pt);break e;case 2:ai=!0}}be.callback!==null&&be.lane!==0&&(i.flags|=64,pt=E.effects,pt===null?E.effects=[be]:pt.push(be))}else Wt={eventTime:Wt,lane:pt,tag:be.tag,payload:be.payload,callback:be.callback,next:null},ht===null?(Ye=ht=Wt,Pe=wt):ht=ht.next=Wt,H|=pt;if(be=be.next,be===null){if(be=E.shared.pending,be===null)break;pt=be,be=pt.next,pt.next=null,E.lastBaseUpdate=pt,E.shared.pending=null}}while(!0);if(ht===null&&(Pe=wt),E.baseState=Pe,E.firstBaseUpdate=Ye,E.lastBaseUpdate=ht,o=E.shared.interleaved,o!==null){E=o;do H|=E.lane,E=E.next;while(E!==o)}else O===null&&(E.shared.lanes=0);Ii|=H,i.lanes=H,i.memoizedState=wt}}function Sg(i,o,p){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var b=i[o],E=b.callback;if(E!==null){if(b.callback=null,b=p,typeof E!="function")throw Error(s(191,E));E.call(b)}}}var Mo={},oa=ri(Mo),Io=ri(Mo),qo=ri(Mo);function Fi(i){if(i===Mo)throw Error(s(174));return i}function _p(i,o){switch(qr(qo,o),qr(Io,i),qr(oa,Mo),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:It(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=It(o,i)}Qr(oa),qr(oa,o)}function Pl(){Qr(oa),Qr(Io),Qr(qo)}function kg(i){Fi(qo.current);var o=Fi(oa.current),p=It(o,i.type);o!==p&&(qr(Io,i),qr(oa,p))}function Ep(i){Io.current===i&&(Qr(oa),Qr(Io))}var Yr=ri(0);function Sd(i){for(var o=i;o!==null;){if(o.tag===13){var p=o.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Pp=[];function Ap(){for(var i=0;i<Pp.length;i++)Pp[i]._workInProgressVersionPrimary=null;Pp.length=0}var kd=q.ReactCurrentDispatcher,Tp=q.ReactCurrentBatchConfig,Mi=0,Kr=null,vs=null,Ss=null,Cd=!1,Bo=!1,zo=0,cC=0;function Bs(){throw Error(s(321))}function Op(i,o){if(o===null)return!1;for(var p=0;p<o.length&&p<i.length;p++)if(!qn(i[p],o[p]))return!1;return!0}function Rp(i,o,p,b,E,O){if(Mi=O,Kr=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,kd.current=i===null||i.memoizedState===null?pC:xC,i=p(b,E),Bo){O=0;do{if(Bo=!1,zo=0,25<=O)throw Error(s(301));O+=1,Ss=vs=null,o.updateQueue=null,kd.current=hC,i=p(b,E)}while(Bo)}if(kd.current=Pd,o=vs!==null&&vs.next!==null,Mi=0,Ss=vs=Kr=null,Cd=!1,o)throw Error(s(300));return i}function Dp(){var i=zo!==0;return zo=0,i}function ca(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ss===null?Kr.memoizedState=Ss=i:Ss=Ss.next=i,Ss}function On(){if(vs===null){var i=Kr.alternate;i=i!==null?i.memoizedState:null}else i=vs.next;var o=Ss===null?Kr.memoizedState:Ss.next;if(o!==null)Ss=o,vs=i;else{if(i===null)throw Error(s(310));vs=i,i={memoizedState:vs.memoizedState,baseState:vs.baseState,baseQueue:vs.baseQueue,queue:vs.queue,next:null},Ss===null?Kr.memoizedState=Ss=i:Ss=Ss.next=i}return Ss}function $o(i,o){return typeof o=="function"?o(i):o}function Lp(i){var o=On(),p=o.queue;if(p===null)throw Error(s(311));p.lastRenderedReducer=i;var b=vs,E=b.baseQueue,O=p.pending;if(O!==null){if(E!==null){var H=E.next;E.next=O.next,O.next=H}b.baseQueue=E=O,p.pending=null}if(E!==null){O=E.next,b=b.baseState;var be=H=null,Pe=null,Ye=O;do{var ht=Ye.lane;if((Mi&ht)===ht)Pe!==null&&(Pe=Pe.next={lane:0,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null}),b=Ye.hasEagerState?Ye.eagerState:i(b,Ye.action);else{var wt={lane:ht,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null};Pe===null?(be=Pe=wt,H=b):Pe=Pe.next=wt,Kr.lanes|=ht,Ii|=ht}Ye=Ye.next}while(Ye!==null&&Ye!==O);Pe===null?H=b:Pe.next=be,qn(b,o.memoizedState)||(sn=!0),o.memoizedState=b,o.baseState=H,o.baseQueue=Pe,p.lastRenderedState=b}if(i=p.interleaved,i!==null){E=i;do O=E.lane,Kr.lanes|=O,Ii|=O,E=E.next;while(E!==i)}else E===null&&(p.lanes=0);return[o.memoizedState,p.dispatch]}function Fp(i){var o=On(),p=o.queue;if(p===null)throw Error(s(311));p.lastRenderedReducer=i;var b=p.dispatch,E=p.pending,O=o.memoizedState;if(E!==null){p.pending=null;var H=E=E.next;do O=i(O,H.action),H=H.next;while(H!==E);qn(O,o.memoizedState)||(sn=!0),o.memoizedState=O,o.baseQueue===null&&(o.baseState=O),p.lastRenderedState=O}return[O,b]}function Cg(){}function _g(i,o){var p=Kr,b=On(),E=o(),O=!qn(b.memoizedState,E);if(O&&(b.memoizedState=E,sn=!0),b=b.queue,Mp(Ag.bind(null,p,b,i),[i]),b.getSnapshot!==o||O||Ss!==null&&Ss.memoizedState.tag&1){if(p.flags|=2048,Qo(9,Pg.bind(null,p,b,E,o),void 0,null),ks===null)throw Error(s(349));(Mi&30)!==0||Eg(p,o,E)}return E}function Eg(i,o,p){i.flags|=16384,i={getSnapshot:o,value:p},o=Kr.updateQueue,o===null?(o={lastEffect:null,stores:null},Kr.updateQueue=o,o.stores=[i]):(p=o.stores,p===null?o.stores=[i]:p.push(i))}function Pg(i,o,p,b){o.value=p,o.getSnapshot=b,Tg(o)&&Og(i)}function Ag(i,o,p){return p(function(){Tg(o)&&Og(i)})}function Tg(i){var o=i.getSnapshot;i=i.value;try{var p=o();return!qn(i,p)}catch{return!0}}function Og(i){var o=Ta(i,1);o!==null&&Un(o,i,1,-1)}function Rg(i){var o=ca();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$o,lastRenderedState:i},o.queue=i,i=i.dispatch=mC.bind(null,Kr,i),[o.memoizedState,i]}function Qo(i,o,p,b){return i={tag:i,create:o,destroy:p,deps:b,next:null},o=Kr.updateQueue,o===null?(o={lastEffect:null,stores:null},Kr.updateQueue=o,o.lastEffect=i.next=i):(p=o.lastEffect,p===null?o.lastEffect=i.next=i:(b=p.next,p.next=i,i.next=b,o.lastEffect=i)),i}function Dg(){return On().memoizedState}function _d(i,o,p,b){var E=ca();Kr.flags|=i,E.memoizedState=Qo(1|o,p,void 0,b===void 0?null:b)}function Ed(i,o,p,b){var E=On();b=b===void 0?null:b;var O=void 0;if(vs!==null){var H=vs.memoizedState;if(O=H.destroy,b!==null&&Op(b,H.deps)){E.memoizedState=Qo(o,p,O,b);return}}Kr.flags|=i,E.memoizedState=Qo(1|o,p,O,b)}function Lg(i,o){return _d(8390656,8,i,o)}function Mp(i,o){return Ed(2048,8,i,o)}function Fg(i,o){return Ed(4,2,i,o)}function Mg(i,o){return Ed(4,4,i,o)}function Ig(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function qg(i,o,p){return p=p!=null?p.concat([i]):null,Ed(4,4,Ig.bind(null,o,i),p)}function Ip(){}function Bg(i,o){var p=On();o=o===void 0?null:o;var b=p.memoizedState;return b!==null&&o!==null&&Op(o,b[1])?b[0]:(p.memoizedState=[i,o],i)}function zg(i,o){var p=On();o=o===void 0?null:o;var b=p.memoizedState;return b!==null&&o!==null&&Op(o,b[1])?b[0]:(i=i(),p.memoizedState=[i,o],i)}function $g(i,o,p){return(Mi&21)===0?(i.baseState&&(i.baseState=!1,sn=!0),i.memoizedState=p):(qn(p,o)||(p=Ca(),Kr.lanes|=p,Ii|=p,i.baseState=!0),o)}function dC(i,o){var p=Tr;Tr=p!==0&&4>p?p:4,i(!0);var b=Tp.transition;Tp.transition={};try{i(!1),o()}finally{Tr=p,Tp.transition=b}}function Qg(){return On().memoizedState}function uC(i,o,p){var b=di(i);if(p={lane:b,action:p,hasEagerState:!1,eagerState:null,next:null},Ug(i))Vg(o,p);else if(p=wg(i,o,p,b),p!==null){var E=Gs();Un(p,i,b,E),Wg(p,o,b)}}function mC(i,o,p){var b=di(i),E={lane:b,action:p,hasEagerState:!1,eagerState:null,next:null};if(Ug(i))Vg(o,E);else{var O=i.alternate;if(i.lanes===0&&(O===null||O.lanes===0)&&(O=o.lastRenderedReducer,O!==null))try{var H=o.lastRenderedState,be=O(H,p);if(E.hasEagerState=!0,E.eagerState=be,qn(be,H)){var Pe=o.interleaved;Pe===null?(E.next=E,kp(o)):(E.next=Pe.next,Pe.next=E),o.interleaved=E;return}}catch{}finally{}p=wg(i,o,E,b),p!==null&&(E=Gs(),Un(p,i,b,E),Wg(p,o,b))}}function Ug(i){var o=i.alternate;return i===Kr||o!==null&&o===Kr}function Vg(i,o){Bo=Cd=!0;var p=i.pending;p===null?o.next=o:(o.next=p.next,p.next=o),i.pending=o}function Wg(i,o,p){if((p&4194240)!==0){var b=o.lanes;b&=i.pendingLanes,p|=b,o.lanes=p,Bm(i,p)}}var Pd={readContext:Tn,useCallback:Bs,useContext:Bs,useEffect:Bs,useImperativeHandle:Bs,useInsertionEffect:Bs,useLayoutEffect:Bs,useMemo:Bs,useReducer:Bs,useRef:Bs,useState:Bs,useDebugValue:Bs,useDeferredValue:Bs,useTransition:Bs,useMutableSource:Bs,useSyncExternalStore:Bs,useId:Bs,unstable_isNewReconciler:!1},pC={readContext:Tn,useCallback:function(i,o){return ca().memoizedState=[i,o===void 0?null:o],i},useContext:Tn,useEffect:Lg,useImperativeHandle:function(i,o,p){return p=p!=null?p.concat([i]):null,_d(4194308,4,Ig.bind(null,o,i),p)},useLayoutEffect:function(i,o){return _d(4194308,4,i,o)},useInsertionEffect:function(i,o){return _d(4,2,i,o)},useMemo:function(i,o){var p=ca();return o=o===void 0?null:o,i=i(),p.memoizedState=[i,o],i},useReducer:function(i,o,p){var b=ca();return o=p!==void 0?p(o):o,b.memoizedState=b.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},b.queue=i,i=i.dispatch=uC.bind(null,Kr,i),[b.memoizedState,i]},useRef:function(i){var o=ca();return i={current:i},o.memoizedState=i},useState:Rg,useDebugValue:Ip,useDeferredValue:function(i){return ca().memoizedState=i},useTransition:function(){var i=Rg(!1),o=i[0];return i=dC.bind(null,i[1]),ca().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,p){var b=Kr,E=ca();if(Wr){if(p===void 0)throw Error(s(407));p=p()}else{if(p=o(),ks===null)throw Error(s(349));(Mi&30)!==0||Eg(b,o,p)}E.memoizedState=p;var O={value:p,getSnapshot:o};return E.queue=O,Lg(Ag.bind(null,b,O,i),[i]),b.flags|=2048,Qo(9,Pg.bind(null,b,O,p,o),void 0,null),p},useId:function(){var i=ca(),o=ks.identifierPrefix;if(Wr){var p=Aa,b=Pa;p=(b&~(1<<32-Te(b)-1)).toString(32)+p,o=":"+o+"R"+p,p=zo++,0<p&&(o+="H"+p.toString(32)),o+=":"}else p=cC++,o=":"+o+"r"+p.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},xC={readContext:Tn,useCallback:Bg,useContext:Tn,useEffect:Mp,useImperativeHandle:qg,useInsertionEffect:Fg,useLayoutEffect:Mg,useMemo:zg,useReducer:Lp,useRef:Dg,useState:function(){return Lp($o)},useDebugValue:Ip,useDeferredValue:function(i){var o=On();return $g(o,vs.memoizedState,i)},useTransition:function(){var i=Lp($o)[0],o=On().memoizedState;return[i,o]},useMutableSource:Cg,useSyncExternalStore:_g,useId:Qg,unstable_isNewReconciler:!1},hC={readContext:Tn,useCallback:Bg,useContext:Tn,useEffect:Mp,useImperativeHandle:qg,useInsertionEffect:Fg,useLayoutEffect:Mg,useMemo:zg,useReducer:Fp,useRef:Dg,useState:function(){return Fp($o)},useDebugValue:Ip,useDeferredValue:function(i){var o=On();return vs===null?o.memoizedState=i:$g(o,vs.memoizedState,i)},useTransition:function(){var i=Fp($o)[0],o=On().memoizedState;return[i,o]},useMutableSource:Cg,useSyncExternalStore:_g,useId:Qg,unstable_isNewReconciler:!1};function zn(i,o){if(i&&i.defaultProps){o=pe({},o),i=i.defaultProps;for(var p in i)o[p]===void 0&&(o[p]=i[p]);return o}return o}function qp(i,o,p,b){o=i.memoizedState,p=p(b,o),p=p==null?o:pe({},o,p),i.memoizedState=p,i.lanes===0&&(i.updateQueue.baseState=p)}var Ad={isMounted:function(i){return(i=i._reactInternals)?oe(i)===i:!1},enqueueSetState:function(i,o,p){i=i._reactInternals;var b=Gs(),E=di(i),O=Oa(b,E);O.payload=o,p!=null&&(O.callback=p),o=ii(i,O,E),o!==null&&(Un(o,i,E,b),Nd(o,i,E))},enqueueReplaceState:function(i,o,p){i=i._reactInternals;var b=Gs(),E=di(i),O=Oa(b,E);O.tag=1,O.payload=o,p!=null&&(O.callback=p),o=ii(i,O,E),o!==null&&(Un(o,i,E,b),Nd(o,i,E))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var p=Gs(),b=di(i),E=Oa(p,b);E.tag=2,o!=null&&(E.callback=o),o=ii(i,E,b),o!==null&&(Un(o,i,b,p),Nd(o,i,b))}};function Gg(i,o,p,b,E,O,H){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(b,O,H):o.prototype&&o.prototype.isPureReactComponent?!Po(p,b)||!Po(E,O):!0}function Hg(i,o,p){var b=!1,E=si,O=o.contextType;return typeof O=="object"&&O!==null?O=Tn(O):(E=rn(o)?Oi:qs.current,b=o.contextTypes,O=(b=b!=null)?Nl(i,E):si),o=new o(p,O),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Ad,i.stateNode=o,o._reactInternals=i,b&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=E,i.__reactInternalMemoizedMaskedChildContext=O),o}function Yg(i,o,p,b){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(p,b),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(p,b),o.state!==i&&Ad.enqueueReplaceState(o,o.state,null)}function Bp(i,o,p,b){var E=i.stateNode;E.props=p,E.state=i.memoizedState,E.refs={},Cp(i);var O=o.contextType;typeof O=="object"&&O!==null?E.context=Tn(O):(O=rn(o)?Oi:qs.current,E.context=Nl(i,O)),E.state=i.memoizedState,O=o.getDerivedStateFromProps,typeof O=="function"&&(qp(i,o,O,p),E.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(o=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),o!==E.state&&Ad.enqueueReplaceState(E,E.state,null),jd(i,p,E,b),E.state=i.memoizedState),typeof E.componentDidMount=="function"&&(i.flags|=4194308)}function Al(i,o){try{var p="",b=o;do p+=ne(b),b=b.return;while(b);var E=p}catch(O){E=`
Error generating stack: `+O.message+`
`+O.stack}return{value:i,source:o,stack:E,digest:null}}function zp(i,o,p){return{value:i,source:null,stack:p??null,digest:o??null}}function $p(i,o){try{console.error(o.value)}catch(p){setTimeout(function(){throw p})}}var fC=typeof WeakMap=="function"?WeakMap:Map;function Kg(i,o,p){p=Oa(-1,p),p.tag=3,p.payload={element:null};var b=o.value;return p.callback=function(){Md||(Md=!0,s0=b),$p(i,o)},p}function Xg(i,o,p){p=Oa(-1,p),p.tag=3;var b=i.type.getDerivedStateFromError;if(typeof b=="function"){var E=o.value;p.payload=function(){return b(E)},p.callback=function(){$p(i,o)}}var O=i.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(p.callback=function(){$p(i,o),typeof b!="function"&&(oi===null?oi=new Set([this]):oi.add(this));var H=o.stack;this.componentDidCatch(o.value,{componentStack:H!==null?H:""})}),p}function Jg(i,o,p){var b=i.pingCache;if(b===null){b=i.pingCache=new fC;var E=new Set;b.set(o,E)}else E=b.get(o),E===void 0&&(E=new Set,b.set(o,E));E.has(p)||(E.add(p),i=AC.bind(null,i,o,p),o.then(i,i))}function Zg(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function ey(i,o,p,b,E){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(o=Oa(-1,1),o.tag=2,ii(p,o,1))),p.lanes|=1),i):(i.flags|=65536,i.lanes=E,i)}var gC=q.ReactCurrentOwner,sn=!1;function Ws(i,o,p,b){o.child=i===null?bg(o,null,p,b):Cl(o,i.child,p,b)}function ty(i,o,p,b,E){p=p.render;var O=o.ref;return El(o,E),b=Rp(i,o,p,b,O,E),p=Dp(),i!==null&&!sn?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~E,Ra(i,o,E)):(Wr&&p&&fp(o),o.flags|=1,Ws(i,o,b,E),o.child)}function ry(i,o,p,b,E){if(i===null){var O=p.type;return typeof O=="function"&&!d0(O)&&O.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(o.tag=15,o.type=O,sy(i,o,O,b,E)):(i=Qd(p.type,null,b,o,o.mode,E),i.ref=o.ref,i.return=o,o.child=i)}if(O=i.child,(i.lanes&E)===0){var H=O.memoizedProps;if(p=p.compare,p=p!==null?p:Po,p(H,b)&&i.ref===o.ref)return Ra(i,o,E)}return o.flags|=1,i=mi(O,b),i.ref=o.ref,i.return=o,o.child=i}function sy(i,o,p,b,E){if(i!==null){var O=i.memoizedProps;if(Po(O,b)&&i.ref===o.ref)if(sn=!1,o.pendingProps=b=O,(i.lanes&E)!==0)(i.flags&131072)!==0&&(sn=!0);else return o.lanes=i.lanes,Ra(i,o,E)}return Qp(i,o,p,b,E)}function ny(i,o,p){var b=o.pendingProps,E=b.children,O=i!==null?i.memoizedState:null;if(b.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},qr(Ol,vn),vn|=p;else{if((p&1073741824)===0)return i=O!==null?O.baseLanes|p:p,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,qr(Ol,vn),vn|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},b=O!==null?O.baseLanes:p,qr(Ol,vn),vn|=b}else O!==null?(b=O.baseLanes|p,o.memoizedState=null):b=p,qr(Ol,vn),vn|=b;return Ws(i,o,E,p),o.child}function ay(i,o){var p=o.ref;(i===null&&p!==null||i!==null&&i.ref!==p)&&(o.flags|=512,o.flags|=2097152)}function Qp(i,o,p,b,E){var O=rn(p)?Oi:qs.current;return O=Nl(o,O),El(o,E),p=Rp(i,o,p,b,O,E),b=Dp(),i!==null&&!sn?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~E,Ra(i,o,E)):(Wr&&b&&fp(o),o.flags|=1,Ws(i,o,p,E),o.child)}function iy(i,o,p,b,E){if(rn(p)){var O=!0;xd(o)}else O=!1;if(El(o,E),o.stateNode===null)Od(i,o),Hg(o,p,b),Bp(o,p,b,E),b=!0;else if(i===null){var H=o.stateNode,be=o.memoizedProps;H.props=be;var Pe=H.context,Ye=p.contextType;typeof Ye=="object"&&Ye!==null?Ye=Tn(Ye):(Ye=rn(p)?Oi:qs.current,Ye=Nl(o,Ye));var ht=p.getDerivedStateFromProps,wt=typeof ht=="function"||typeof H.getSnapshotBeforeUpdate=="function";wt||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(be!==b||Pe!==Ye)&&Yg(o,H,b,Ye),ai=!1;var pt=o.memoizedState;H.state=pt,jd(o,b,H,E),Pe=o.memoizedState,be!==b||pt!==Pe||tn.current||ai?(typeof ht=="function"&&(qp(o,p,ht,b),Pe=o.memoizedState),(be=ai||Gg(o,p,be,b,pt,Pe,Ye))?(wt||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount()),typeof H.componentDidMount=="function"&&(o.flags|=4194308)):(typeof H.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=b,o.memoizedState=Pe),H.props=b,H.state=Pe,H.context=Ye,b=be):(typeof H.componentDidMount=="function"&&(o.flags|=4194308),b=!1)}else{H=o.stateNode,Ng(i,o),be=o.memoizedProps,Ye=o.type===o.elementType?be:zn(o.type,be),H.props=Ye,wt=o.pendingProps,pt=H.context,Pe=p.contextType,typeof Pe=="object"&&Pe!==null?Pe=Tn(Pe):(Pe=rn(p)?Oi:qs.current,Pe=Nl(o,Pe));var Wt=p.getDerivedStateFromProps;(ht=typeof Wt=="function"||typeof H.getSnapshotBeforeUpdate=="function")||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(be!==wt||pt!==Pe)&&Yg(o,H,b,Pe),ai=!1,pt=o.memoizedState,H.state=pt,jd(o,b,H,E);var Kt=o.memoizedState;be!==wt||pt!==Kt||tn.current||ai?(typeof Wt=="function"&&(qp(o,p,Wt,b),Kt=o.memoizedState),(Ye=ai||Gg(o,p,Ye,b,pt,Kt,Pe)||!1)?(ht||typeof H.UNSAFE_componentWillUpdate!="function"&&typeof H.componentWillUpdate!="function"||(typeof H.componentWillUpdate=="function"&&H.componentWillUpdate(b,Kt,Pe),typeof H.UNSAFE_componentWillUpdate=="function"&&H.UNSAFE_componentWillUpdate(b,Kt,Pe)),typeof H.componentDidUpdate=="function"&&(o.flags|=4),typeof H.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof H.componentDidUpdate!="function"||be===i.memoizedProps&&pt===i.memoizedState||(o.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||be===i.memoizedProps&&pt===i.memoizedState||(o.flags|=1024),o.memoizedProps=b,o.memoizedState=Kt),H.props=b,H.state=Kt,H.context=Pe,b=Ye):(typeof H.componentDidUpdate!="function"||be===i.memoizedProps&&pt===i.memoizedState||(o.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||be===i.memoizedProps&&pt===i.memoizedState||(o.flags|=1024),b=!1)}return Up(i,o,p,b,O,E)}function Up(i,o,p,b,E,O){ay(i,o);var H=(o.flags&128)!==0;if(!b&&!H)return E&&ug(o,p,!1),Ra(i,o,O);b=o.stateNode,gC.current=o;var be=H&&typeof p.getDerivedStateFromError!="function"?null:b.render();return o.flags|=1,i!==null&&H?(o.child=Cl(o,i.child,null,O),o.child=Cl(o,null,be,O)):Ws(i,o,be,O),o.memoizedState=b.state,E&&ug(o,p,!0),o.child}function ly(i){var o=i.stateNode;o.pendingContext?cg(i,o.pendingContext,o.pendingContext!==o.context):o.context&&cg(i,o.context,!1),_p(i,o.containerInfo)}function oy(i,o,p,b,E){return kl(),bp(E),o.flags|=256,Ws(i,o,p,b),o.child}var Vp={dehydrated:null,treeContext:null,retryLane:0};function Wp(i){return{baseLanes:i,cachePool:null,transitions:null}}function cy(i,o,p){var b=o.pendingProps,E=Yr.current,O=!1,H=(o.flags&128)!==0,be;if((be=H)||(be=i!==null&&i.memoizedState===null?!1:(E&2)!==0),be?(O=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(E|=1),qr(Yr,E&1),i===null)return vp(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(H=b.children,i=b.fallback,O?(b=o.mode,O=o.child,H={mode:"hidden",children:H},(b&1)===0&&O!==null?(O.childLanes=0,O.pendingProps=H):O=Ud(H,b,0,null),i=$i(i,b,p,null),O.return=o,i.return=o,O.sibling=i,o.child=O,o.child.memoizedState=Wp(p),o.memoizedState=Vp,i):Gp(o,H));if(E=i.memoizedState,E!==null&&(be=E.dehydrated,be!==null))return yC(i,o,H,b,be,E,p);if(O){O=b.fallback,H=o.mode,E=i.child,be=E.sibling;var Pe={mode:"hidden",children:b.children};return(H&1)===0&&o.child!==E?(b=o.child,b.childLanes=0,b.pendingProps=Pe,o.deletions=null):(b=mi(E,Pe),b.subtreeFlags=E.subtreeFlags&14680064),be!==null?O=mi(be,O):(O=$i(O,H,p,null),O.flags|=2),O.return=o,b.return=o,b.sibling=O,o.child=b,b=O,O=o.child,H=i.child.memoizedState,H=H===null?Wp(p):{baseLanes:H.baseLanes|p,cachePool:null,transitions:H.transitions},O.memoizedState=H,O.childLanes=i.childLanes&~p,o.memoizedState=Vp,b}return O=i.child,i=O.sibling,b=mi(O,{mode:"visible",children:b.children}),(o.mode&1)===0&&(b.lanes=p),b.return=o,b.sibling=null,i!==null&&(p=o.deletions,p===null?(o.deletions=[i],o.flags|=16):p.push(i)),o.child=b,o.memoizedState=null,b}function Gp(i,o){return o=Ud({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Td(i,o,p,b){return b!==null&&bp(b),Cl(o,i.child,null,p),i=Gp(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function yC(i,o,p,b,E,O,H){if(p)return o.flags&256?(o.flags&=-257,b=zp(Error(s(422))),Td(i,o,H,b)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(O=b.fallback,E=o.mode,b=Ud({mode:"visible",children:b.children},E,0,null),O=$i(O,E,H,null),O.flags|=2,b.return=o,O.return=o,b.sibling=O,o.child=b,(o.mode&1)!==0&&Cl(o,i.child,null,H),o.child.memoizedState=Wp(H),o.memoizedState=Vp,O);if((o.mode&1)===0)return Td(i,o,H,null);if(E.data==="$!"){if(b=E.nextSibling&&E.nextSibling.dataset,b)var be=b.dgst;return b=be,O=Error(s(419)),b=zp(O,b,void 0),Td(i,o,H,b)}if(be=(H&i.childLanes)!==0,sn||be){if(b=ks,b!==null){switch(H&-H){case 4:E=2;break;case 16:E=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:E=32;break;case 536870912:E=268435456;break;default:E=0}E=(E&(b.suspendedLanes|H))!==0?0:E,E!==0&&E!==O.retryLane&&(O.retryLane=E,Ta(i,E),Un(b,i,E,-1))}return c0(),b=zp(Error(s(421))),Td(i,o,H,b)}return E.data==="$?"?(o.flags|=128,o.child=i.child,o=TC.bind(null,i),E._reactRetry=o,null):(i=O.treeContext,yn=ti(E.nextSibling),gn=o,Wr=!0,Bn=null,i!==null&&(Pn[An++]=Pa,Pn[An++]=Aa,Pn[An++]=Ri,Pa=i.id,Aa=i.overflow,Ri=o),o=Gp(o,b.children),o.flags|=4096,o)}function dy(i,o,p){i.lanes|=o;var b=i.alternate;b!==null&&(b.lanes|=o),Sp(i.return,o,p)}function Hp(i,o,p,b,E){var O=i.memoizedState;O===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:b,tail:p,tailMode:E}:(O.isBackwards=o,O.rendering=null,O.renderingStartTime=0,O.last=b,O.tail=p,O.tailMode=E)}function uy(i,o,p){var b=o.pendingProps,E=b.revealOrder,O=b.tail;if(Ws(i,o,b.children,p),b=Yr.current,(b&2)!==0)b=b&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&dy(i,p,o);else if(i.tag===19)dy(i,p,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}b&=1}if(qr(Yr,b),(o.mode&1)===0)o.memoizedState=null;else switch(E){case"forwards":for(p=o.child,E=null;p!==null;)i=p.alternate,i!==null&&Sd(i)===null&&(E=p),p=p.sibling;p=E,p===null?(E=o.child,o.child=null):(E=p.sibling,p.sibling=null),Hp(o,!1,E,p,O);break;case"backwards":for(p=null,E=o.child,o.child=null;E!==null;){if(i=E.alternate,i!==null&&Sd(i)===null){o.child=E;break}i=E.sibling,E.sibling=p,p=E,E=i}Hp(o,!0,p,null,O);break;case"together":Hp(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Od(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function Ra(i,o,p){if(i!==null&&(o.dependencies=i.dependencies),Ii|=o.lanes,(p&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(s(153));if(o.child!==null){for(i=o.child,p=mi(i,i.pendingProps),o.child=p,p.return=o;i.sibling!==null;)i=i.sibling,p=p.sibling=mi(i,i.pendingProps),p.return=o;p.sibling=null}return o.child}function vC(i,o,p){switch(o.tag){case 3:ly(o),kl();break;case 5:kg(o);break;case 1:rn(o.type)&&xd(o);break;case 4:_p(o,o.stateNode.containerInfo);break;case 10:var b=o.type._context,E=o.memoizedProps.value;qr(bd,b._currentValue),b._currentValue=E;break;case 13:if(b=o.memoizedState,b!==null)return b.dehydrated!==null?(qr(Yr,Yr.current&1),o.flags|=128,null):(p&o.child.childLanes)!==0?cy(i,o,p):(qr(Yr,Yr.current&1),i=Ra(i,o,p),i!==null?i.sibling:null);qr(Yr,Yr.current&1);break;case 19:if(b=(p&o.childLanes)!==0,(i.flags&128)!==0){if(b)return uy(i,o,p);o.flags|=128}if(E=o.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),qr(Yr,Yr.current),b)break;return null;case 22:case 23:return o.lanes=0,ny(i,o,p)}return Ra(i,o,p)}var my,Yp,py,xy;my=function(i,o){for(var p=o.child;p!==null;){if(p.tag===5||p.tag===6)i.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===o)break;for(;p.sibling===null;){if(p.return===null||p.return===o)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Yp=function(){},py=function(i,o,p,b){var E=i.memoizedProps;if(E!==b){i=o.stateNode,Fi(oa.current);var O=null;switch(p){case"input":E=lt(i,E),b=lt(i,b),O=[];break;case"select":E=pe({},E,{value:void 0}),b=pe({},b,{value:void 0}),O=[];break;case"textarea":E=xe(i,E),b=xe(i,b),O=[];break;default:typeof E.onClick!="function"&&typeof b.onClick=="function"&&(i.onclick=ud)}kt(p,b);var H;p=null;for(Ye in E)if(!b.hasOwnProperty(Ye)&&E.hasOwnProperty(Ye)&&E[Ye]!=null)if(Ye==="style"){var be=E[Ye];for(H in be)be.hasOwnProperty(H)&&(p||(p={}),p[H]="")}else Ye!=="dangerouslySetInnerHTML"&&Ye!=="children"&&Ye!=="suppressContentEditableWarning"&&Ye!=="suppressHydrationWarning"&&Ye!=="autoFocus"&&(a.hasOwnProperty(Ye)?O||(O=[]):(O=O||[]).push(Ye,null));for(Ye in b){var Pe=b[Ye];if(be=E?.[Ye],b.hasOwnProperty(Ye)&&Pe!==be&&(Pe!=null||be!=null))if(Ye==="style")if(be){for(H in be)!be.hasOwnProperty(H)||Pe&&Pe.hasOwnProperty(H)||(p||(p={}),p[H]="");for(H in Pe)Pe.hasOwnProperty(H)&&be[H]!==Pe[H]&&(p||(p={}),p[H]=Pe[H])}else p||(O||(O=[]),O.push(Ye,p)),p=Pe;else Ye==="dangerouslySetInnerHTML"?(Pe=Pe?Pe.__html:void 0,be=be?be.__html:void 0,Pe!=null&&be!==Pe&&(O=O||[]).push(Ye,Pe)):Ye==="children"?typeof Pe!="string"&&typeof Pe!="number"||(O=O||[]).push(Ye,""+Pe):Ye!=="suppressContentEditableWarning"&&Ye!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ye)?(Pe!=null&&Ye==="onScroll"&&$r("scroll",i),O||be===Pe||(O=[])):(O=O||[]).push(Ye,Pe))}p&&(O=O||[]).push("style",p);var Ye=O;(o.updateQueue=Ye)&&(o.flags|=4)}},xy=function(i,o,p,b){p!==b&&(o.flags|=4)};function Uo(i,o){if(!Wr)switch(i.tailMode){case"hidden":o=i.tail;for(var p=null;o!==null;)o.alternate!==null&&(p=o),o=o.sibling;p===null?i.tail=null:p.sibling=null;break;case"collapsed":p=i.tail;for(var b=null;p!==null;)p.alternate!==null&&(b=p),p=p.sibling;b===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:b.sibling=null}}function zs(i){var o=i.alternate!==null&&i.alternate.child===i.child,p=0,b=0;if(o)for(var E=i.child;E!==null;)p|=E.lanes|E.childLanes,b|=E.subtreeFlags&14680064,b|=E.flags&14680064,E.return=i,E=E.sibling;else for(E=i.child;E!==null;)p|=E.lanes|E.childLanes,b|=E.subtreeFlags,b|=E.flags,E.return=i,E=E.sibling;return i.subtreeFlags|=b,i.childLanes=p,o}function bC(i,o,p){var b=o.pendingProps;switch(gp(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zs(o),null;case 1:return rn(o.type)&&pd(),zs(o),null;case 3:return b=o.stateNode,Pl(),Qr(tn),Qr(qs),Ap(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(i===null||i.child===null)&&(yd(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Bn!==null&&(i0(Bn),Bn=null))),Yp(i,o),zs(o),null;case 5:Ep(o);var E=Fi(qo.current);if(p=o.type,i!==null&&o.stateNode!=null)py(i,o,p,b,E),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!b){if(o.stateNode===null)throw Error(s(166));return zs(o),null}if(i=Fi(oa.current),yd(o)){b=o.stateNode,p=o.type;var O=o.memoizedProps;switch(b[la]=o,b[Do]=O,i=(o.mode&1)!==0,p){case"dialog":$r("cancel",b),$r("close",b);break;case"iframe":case"object":case"embed":$r("load",b);break;case"video":case"audio":for(E=0;E<To.length;E++)$r(To[E],b);break;case"source":$r("error",b);break;case"img":case"image":case"link":$r("error",b),$r("load",b);break;case"details":$r("toggle",b);break;case"input":$t(b,O),$r("invalid",b);break;case"select":b._wrapperState={wasMultiple:!!O.multiple},$r("invalid",b);break;case"textarea":Ge(b,O),$r("invalid",b)}kt(p,O),E=null;for(var H in O)if(O.hasOwnProperty(H)){var be=O[H];H==="children"?typeof be=="string"?b.textContent!==be&&(O.suppressHydrationWarning!==!0&&dd(b.textContent,be,i),E=["children",be]):typeof be=="number"&&b.textContent!==""+be&&(O.suppressHydrationWarning!==!0&&dd(b.textContent,be,i),E=["children",""+be]):a.hasOwnProperty(H)&&be!=null&&H==="onScroll"&&$r("scroll",b)}switch(p){case"input":Ve(b),ut(b,O,!0);break;case"textarea":Ve(b),et(b);break;case"select":case"option":break;default:typeof O.onClick=="function"&&(b.onclick=ud)}b=E,o.updateQueue=b,b!==null&&(o.flags|=4)}else{H=E.nodeType===9?E:E.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=He(p)),i==="http://www.w3.org/1999/xhtml"?p==="script"?(i=H.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof b.is=="string"?i=H.createElement(p,{is:b.is}):(i=H.createElement(p),p==="select"&&(H=i,b.multiple?H.multiple=!0:b.size&&(H.size=b.size))):i=H.createElementNS(i,p),i[la]=o,i[Do]=b,my(i,o,!1,!1),o.stateNode=i;e:{switch(H=vt(p,b),p){case"dialog":$r("cancel",i),$r("close",i),E=b;break;case"iframe":case"object":case"embed":$r("load",i),E=b;break;case"video":case"audio":for(E=0;E<To.length;E++)$r(To[E],i);E=b;break;case"source":$r("error",i),E=b;break;case"img":case"image":case"link":$r("error",i),$r("load",i),E=b;break;case"details":$r("toggle",i),E=b;break;case"input":$t(i,b),E=lt(i,b),$r("invalid",i);break;case"option":E=b;break;case"select":i._wrapperState={wasMultiple:!!b.multiple},E=pe({},b,{value:void 0}),$r("invalid",i);break;case"textarea":Ge(i,b),E=xe(i,b),$r("invalid",i);break;default:E=b}kt(p,E),be=E;for(O in be)if(be.hasOwnProperty(O)){var Pe=be[O];O==="style"?at(i,Pe):O==="dangerouslySetInnerHTML"?(Pe=Pe?Pe.__html:void 0,Pe!=null&&St(i,Pe)):O==="children"?typeof Pe=="string"?(p!=="textarea"||Pe!=="")&&ct(i,Pe):typeof Pe=="number"&&ct(i,""+Pe):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(a.hasOwnProperty(O)?Pe!=null&&O==="onScroll"&&$r("scroll",i):Pe!=null&&B(i,O,Pe,H))}switch(p){case"input":Ve(i),ut(i,b,!1);break;case"textarea":Ve(i),et(i);break;case"option":b.value!=null&&i.setAttribute("value",""+Ce(b.value));break;case"select":i.multiple=!!b.multiple,O=b.value,O!=null?mt(i,!!b.multiple,O,!1):b.defaultValue!=null&&mt(i,!!b.multiple,b.defaultValue,!0);break;default:typeof E.onClick=="function"&&(i.onclick=ud)}switch(p){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}}b&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return zs(o),null;case 6:if(i&&o.stateNode!=null)xy(i,o,i.memoizedProps,b);else{if(typeof b!="string"&&o.stateNode===null)throw Error(s(166));if(p=Fi(qo.current),Fi(oa.current),yd(o)){if(b=o.stateNode,p=o.memoizedProps,b[la]=o,(O=b.nodeValue!==p)&&(i=gn,i!==null))switch(i.tag){case 3:dd(b.nodeValue,p,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&dd(b.nodeValue,p,(i.mode&1)!==0)}O&&(o.flags|=4)}else b=(p.nodeType===9?p:p.ownerDocument).createTextNode(b),b[la]=o,o.stateNode=b}return zs(o),null;case 13:if(Qr(Yr),b=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Wr&&yn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)gg(),kl(),o.flags|=98560,O=!1;else if(O=yd(o),b!==null&&b.dehydrated!==null){if(i===null){if(!O)throw Error(s(318));if(O=o.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(s(317));O[la]=o}else kl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;zs(o),O=!1}else Bn!==null&&(i0(Bn),Bn=null),O=!0;if(!O)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=p,o):(b=b!==null,b!==(i!==null&&i.memoizedState!==null)&&b&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(Yr.current&1)!==0?bs===0&&(bs=3):c0())),o.updateQueue!==null&&(o.flags|=4),zs(o),null);case 4:return Pl(),Yp(i,o),i===null&&Oo(o.stateNode.containerInfo),zs(o),null;case 10:return jp(o.type._context),zs(o),null;case 17:return rn(o.type)&&pd(),zs(o),null;case 19:if(Qr(Yr),O=o.memoizedState,O===null)return zs(o),null;if(b=(o.flags&128)!==0,H=O.rendering,H===null)if(b)Uo(O,!1);else{if(bs!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(H=Sd(i),H!==null){for(o.flags|=128,Uo(O,!1),b=H.updateQueue,b!==null&&(o.updateQueue=b,o.flags|=4),o.subtreeFlags=0,b=p,p=o.child;p!==null;)O=p,i=b,O.flags&=14680066,H=O.alternate,H===null?(O.childLanes=0,O.lanes=i,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=H.childLanes,O.lanes=H.lanes,O.child=H.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=H.memoizedProps,O.memoizedState=H.memoizedState,O.updateQueue=H.updateQueue,O.type=H.type,i=H.dependencies,O.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),p=p.sibling;return qr(Yr,Yr.current&1|2),o.child}i=i.sibling}O.tail!==null&&T()>Rl&&(o.flags|=128,b=!0,Uo(O,!1),o.lanes=4194304)}else{if(!b)if(i=Sd(H),i!==null){if(o.flags|=128,b=!0,p=i.updateQueue,p!==null&&(o.updateQueue=p,o.flags|=4),Uo(O,!0),O.tail===null&&O.tailMode==="hidden"&&!H.alternate&&!Wr)return zs(o),null}else 2*T()-O.renderingStartTime>Rl&&p!==1073741824&&(o.flags|=128,b=!0,Uo(O,!1),o.lanes=4194304);O.isBackwards?(H.sibling=o.child,o.child=H):(p=O.last,p!==null?p.sibling=H:o.child=H,O.last=H)}return O.tail!==null?(o=O.tail,O.rendering=o,O.tail=o.sibling,O.renderingStartTime=T(),o.sibling=null,p=Yr.current,qr(Yr,b?p&1|2:p&1),o):(zs(o),null);case 22:case 23:return o0(),b=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==b&&(o.flags|=8192),b&&(o.mode&1)!==0?(vn&1073741824)!==0&&(zs(o),o.subtreeFlags&6&&(o.flags|=8192)):zs(o),null;case 24:return null;case 25:return null}throw Error(s(156,o.tag))}function wC(i,o){switch(gp(o),o.tag){case 1:return rn(o.type)&&pd(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Pl(),Qr(tn),Qr(qs),Ap(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return Ep(o),null;case 13:if(Qr(Yr),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(s(340));kl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Qr(Yr),null;case 4:return Pl(),null;case 10:return jp(o.type._context),null;case 22:case 23:return o0(),null;case 24:return null;default:return null}}var Rd=!1,$s=!1,NC=typeof WeakSet=="function"?WeakSet:Set,Ht=null;function Tl(i,o){var p=i.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(b){Zr(i,o,b)}else p.current=null}function Kp(i,o,p){try{p()}catch(b){Zr(i,o,b)}}var hy=!1;function jC(i,o){if(op=Zc,i=Gf(),ep(i)){if("selectionStart"in i)var p={start:i.selectionStart,end:i.selectionEnd};else e:{p=(p=i.ownerDocument)&&p.defaultView||window;var b=p.getSelection&&p.getSelection();if(b&&b.rangeCount!==0){p=b.anchorNode;var E=b.anchorOffset,O=b.focusNode;b=b.focusOffset;try{p.nodeType,O.nodeType}catch{p=null;break e}var H=0,be=-1,Pe=-1,Ye=0,ht=0,wt=i,pt=null;t:for(;;){for(var Wt;wt!==p||E!==0&&wt.nodeType!==3||(be=H+E),wt!==O||b!==0&&wt.nodeType!==3||(Pe=H+b),wt.nodeType===3&&(H+=wt.nodeValue.length),(Wt=wt.firstChild)!==null;)pt=wt,wt=Wt;for(;;){if(wt===i)break t;if(pt===p&&++Ye===E&&(be=H),pt===O&&++ht===b&&(Pe=H),(Wt=wt.nextSibling)!==null)break;wt=pt,pt=wt.parentNode}wt=Wt}p=be===-1||Pe===-1?null:{start:be,end:Pe}}else p=null}p=p||{start:0,end:0}}else p=null;for(cp={focusedElem:i,selectionRange:p},Zc=!1,Ht=o;Ht!==null;)if(o=Ht,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,Ht=i;else for(;Ht!==null;){o=Ht;try{var Kt=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Kt!==null){var tr=Kt.memoizedProps,cs=Kt.memoizedState,ze=o.stateNode,Re=ze.getSnapshotBeforeUpdate(o.elementType===o.type?tr:zn(o.type,tr),cs);ze.__reactInternalSnapshotBeforeUpdate=Re}break;case 3:var Qe=o.stateNode.containerInfo;Qe.nodeType===1?Qe.textContent="":Qe.nodeType===9&&Qe.documentElement&&Qe.removeChild(Qe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(s(163))}}catch(_t){Zr(o,o.return,_t)}if(i=o.sibling,i!==null){i.return=o.return,Ht=i;break}Ht=o.return}return Kt=hy,hy=!1,Kt}function Vo(i,o,p){var b=o.updateQueue;if(b=b!==null?b.lastEffect:null,b!==null){var E=b=b.next;do{if((E.tag&i)===i){var O=E.destroy;E.destroy=void 0,O!==void 0&&Kp(o,p,O)}E=E.next}while(E!==b)}}function Dd(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var p=o=o.next;do{if((p.tag&i)===i){var b=p.create;p.destroy=b()}p=p.next}while(p!==o)}}function Xp(i){var o=i.ref;if(o!==null){var p=i.stateNode;switch(i.tag){case 5:i=p;break;default:i=p}typeof o=="function"?o(i):o.current=i}}function fy(i){var o=i.alternate;o!==null&&(i.alternate=null,fy(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[la],delete o[Do],delete o[pp],delete o[aC],delete o[iC])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function gy(i){return i.tag===5||i.tag===3||i.tag===4}function yy(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||gy(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Jp(i,o,p){var b=i.tag;if(b===5||b===6)i=i.stateNode,o?p.nodeType===8?p.parentNode.insertBefore(i,o):p.insertBefore(i,o):(p.nodeType===8?(o=p.parentNode,o.insertBefore(i,p)):(o=p,o.appendChild(i)),p=p._reactRootContainer,p!=null||o.onclick!==null||(o.onclick=ud));else if(b!==4&&(i=i.child,i!==null))for(Jp(i,o,p),i=i.sibling;i!==null;)Jp(i,o,p),i=i.sibling}function Zp(i,o,p){var b=i.tag;if(b===5||b===6)i=i.stateNode,o?p.insertBefore(i,o):p.appendChild(i);else if(b!==4&&(i=i.child,i!==null))for(Zp(i,o,p),i=i.sibling;i!==null;)Zp(i,o,p),i=i.sibling}var As=null,$n=!1;function li(i,o,p){for(p=p.child;p!==null;)vy(i,o,p),p=p.sibling}function vy(i,o,p){if(R&&typeof R.onCommitFiberUnmount=="function")try{R.onCommitFiberUnmount(A,p)}catch{}switch(p.tag){case 5:$s||Tl(p,o);case 6:var b=As,E=$n;As=null,li(i,o,p),As=b,$n=E,As!==null&&($n?(i=As,p=p.stateNode,i.nodeType===8?i.parentNode.removeChild(p):i.removeChild(p)):As.removeChild(p.stateNode));break;case 18:As!==null&&($n?(i=As,p=p.stateNode,i.nodeType===8?mp(i.parentNode,p):i.nodeType===1&&mp(i,p),jo(i)):mp(As,p.stateNode));break;case 4:b=As,E=$n,As=p.stateNode.containerInfo,$n=!0,li(i,o,p),As=b,$n=E;break;case 0:case 11:case 14:case 15:if(!$s&&(b=p.updateQueue,b!==null&&(b=b.lastEffect,b!==null))){E=b=b.next;do{var O=E,H=O.destroy;O=O.tag,H!==void 0&&((O&2)!==0||(O&4)!==0)&&Kp(p,o,H),E=E.next}while(E!==b)}li(i,o,p);break;case 1:if(!$s&&(Tl(p,o),b=p.stateNode,typeof b.componentWillUnmount=="function"))try{b.props=p.memoizedProps,b.state=p.memoizedState,b.componentWillUnmount()}catch(be){Zr(p,o,be)}li(i,o,p);break;case 21:li(i,o,p);break;case 22:p.mode&1?($s=(b=$s)||p.memoizedState!==null,li(i,o,p),$s=b):li(i,o,p);break;default:li(i,o,p)}}function by(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var p=i.stateNode;p===null&&(p=i.stateNode=new NC),o.forEach(function(b){var E=OC.bind(null,i,b);p.has(b)||(p.add(b),b.then(E,E))})}}function Qn(i,o){var p=o.deletions;if(p!==null)for(var b=0;b<p.length;b++){var E=p[b];try{var O=i,H=o,be=H;e:for(;be!==null;){switch(be.tag){case 5:As=be.stateNode,$n=!1;break e;case 3:As=be.stateNode.containerInfo,$n=!0;break e;case 4:As=be.stateNode.containerInfo,$n=!0;break e}be=be.return}if(As===null)throw Error(s(160));vy(O,H,E),As=null,$n=!1;var Pe=E.alternate;Pe!==null&&(Pe.return=null),E.return=null}catch(Ye){Zr(E,o,Ye)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)wy(o,i),o=o.sibling}function wy(i,o){var p=i.alternate,b=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Qn(o,i),da(i),b&4){try{Vo(3,i,i.return),Dd(3,i)}catch(tr){Zr(i,i.return,tr)}try{Vo(5,i,i.return)}catch(tr){Zr(i,i.return,tr)}}break;case 1:Qn(o,i),da(i),b&512&&p!==null&&Tl(p,p.return);break;case 5:if(Qn(o,i),da(i),b&512&&p!==null&&Tl(p,p.return),i.flags&32){var E=i.stateNode;try{ct(E,"")}catch(tr){Zr(i,i.return,tr)}}if(b&4&&(E=i.stateNode,E!=null)){var O=i.memoizedProps,H=p!==null?p.memoizedProps:O,be=i.type,Pe=i.updateQueue;if(i.updateQueue=null,Pe!==null)try{be==="input"&&O.type==="radio"&&O.name!=null&&qe(E,O),vt(be,H);var Ye=vt(be,O);for(H=0;H<Pe.length;H+=2){var ht=Pe[H],wt=Pe[H+1];ht==="style"?at(E,wt):ht==="dangerouslySetInnerHTML"?St(E,wt):ht==="children"?ct(E,wt):B(E,ht,wt,Ye)}switch(be){case"input":Ie(E,O);break;case"textarea":ot(E,O);break;case"select":var pt=E._wrapperState.wasMultiple;E._wrapperState.wasMultiple=!!O.multiple;var Wt=O.value;Wt!=null?mt(E,!!O.multiple,Wt,!1):pt!==!!O.multiple&&(O.defaultValue!=null?mt(E,!!O.multiple,O.defaultValue,!0):mt(E,!!O.multiple,O.multiple?[]:"",!1))}E[Do]=O}catch(tr){Zr(i,i.return,tr)}}break;case 6:if(Qn(o,i),da(i),b&4){if(i.stateNode===null)throw Error(s(162));E=i.stateNode,O=i.memoizedProps;try{E.nodeValue=O}catch(tr){Zr(i,i.return,tr)}}break;case 3:if(Qn(o,i),da(i),b&4&&p!==null&&p.memoizedState.isDehydrated)try{jo(o.containerInfo)}catch(tr){Zr(i,i.return,tr)}break;case 4:Qn(o,i),da(i);break;case 13:Qn(o,i),da(i),E=i.child,E.flags&8192&&(O=E.memoizedState!==null,E.stateNode.isHidden=O,!O||E.alternate!==null&&E.alternate.memoizedState!==null||(r0=T())),b&4&&by(i);break;case 22:if(ht=p!==null&&p.memoizedState!==null,i.mode&1?($s=(Ye=$s)||ht,Qn(o,i),$s=Ye):Qn(o,i),da(i),b&8192){if(Ye=i.memoizedState!==null,(i.stateNode.isHidden=Ye)&&!ht&&(i.mode&1)!==0)for(Ht=i,ht=i.child;ht!==null;){for(wt=Ht=ht;Ht!==null;){switch(pt=Ht,Wt=pt.child,pt.tag){case 0:case 11:case 14:case 15:Vo(4,pt,pt.return);break;case 1:Tl(pt,pt.return);var Kt=pt.stateNode;if(typeof Kt.componentWillUnmount=="function"){b=pt,p=pt.return;try{o=b,Kt.props=o.memoizedProps,Kt.state=o.memoizedState,Kt.componentWillUnmount()}catch(tr){Zr(b,p,tr)}}break;case 5:Tl(pt,pt.return);break;case 22:if(pt.memoizedState!==null){Sy(wt);continue}}Wt!==null?(Wt.return=pt,Ht=Wt):Sy(wt)}ht=ht.sibling}e:for(ht=null,wt=i;;){if(wt.tag===5){if(ht===null){ht=wt;try{E=wt.stateNode,Ye?(O=E.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none"):(be=wt.stateNode,Pe=wt.memoizedProps.style,H=Pe!=null&&Pe.hasOwnProperty("display")?Pe.display:null,be.style.display=Ze("display",H))}catch(tr){Zr(i,i.return,tr)}}}else if(wt.tag===6){if(ht===null)try{wt.stateNode.nodeValue=Ye?"":wt.memoizedProps}catch(tr){Zr(i,i.return,tr)}}else if((wt.tag!==22&&wt.tag!==23||wt.memoizedState===null||wt===i)&&wt.child!==null){wt.child.return=wt,wt=wt.child;continue}if(wt===i)break e;for(;wt.sibling===null;){if(wt.return===null||wt.return===i)break e;ht===wt&&(ht=null),wt=wt.return}ht===wt&&(ht=null),wt.sibling.return=wt.return,wt=wt.sibling}}break;case 19:Qn(o,i),da(i),b&4&&by(i);break;case 21:break;default:Qn(o,i),da(i)}}function da(i){var o=i.flags;if(o&2){try{e:{for(var p=i.return;p!==null;){if(gy(p)){var b=p;break e}p=p.return}throw Error(s(160))}switch(b.tag){case 5:var E=b.stateNode;b.flags&32&&(ct(E,""),b.flags&=-33);var O=yy(i);Zp(i,O,E);break;case 3:case 4:var H=b.stateNode.containerInfo,be=yy(i);Jp(i,be,H);break;default:throw Error(s(161))}}catch(Pe){Zr(i,i.return,Pe)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function SC(i,o,p){Ht=i,Ny(i)}function Ny(i,o,p){for(var b=(i.mode&1)!==0;Ht!==null;){var E=Ht,O=E.child;if(E.tag===22&&b){var H=E.memoizedState!==null||Rd;if(!H){var be=E.alternate,Pe=be!==null&&be.memoizedState!==null||$s;be=Rd;var Ye=$s;if(Rd=H,($s=Pe)&&!Ye)for(Ht=E;Ht!==null;)H=Ht,Pe=H.child,H.tag===22&&H.memoizedState!==null?ky(E):Pe!==null?(Pe.return=H,Ht=Pe):ky(E);for(;O!==null;)Ht=O,Ny(O),O=O.sibling;Ht=E,Rd=be,$s=Ye}jy(i)}else(E.subtreeFlags&8772)!==0&&O!==null?(O.return=E,Ht=O):jy(i)}}function jy(i){for(;Ht!==null;){var o=Ht;if((o.flags&8772)!==0){var p=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:$s||Dd(5,o);break;case 1:var b=o.stateNode;if(o.flags&4&&!$s)if(p===null)b.componentDidMount();else{var E=o.elementType===o.type?p.memoizedProps:zn(o.type,p.memoizedProps);b.componentDidUpdate(E,p.memoizedState,b.__reactInternalSnapshotBeforeUpdate)}var O=o.updateQueue;O!==null&&Sg(o,O,b);break;case 3:var H=o.updateQueue;if(H!==null){if(p=null,o.child!==null)switch(o.child.tag){case 5:p=o.child.stateNode;break;case 1:p=o.child.stateNode}Sg(o,H,p)}break;case 5:var be=o.stateNode;if(p===null&&o.flags&4){p=be;var Pe=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":Pe.autoFocus&&p.focus();break;case"img":Pe.src&&(p.src=Pe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Ye=o.alternate;if(Ye!==null){var ht=Ye.memoizedState;if(ht!==null){var wt=ht.dehydrated;wt!==null&&jo(wt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(s(163))}$s||o.flags&512&&Xp(o)}catch(pt){Zr(o,o.return,pt)}}if(o===i){Ht=null;break}if(p=o.sibling,p!==null){p.return=o.return,Ht=p;break}Ht=o.return}}function Sy(i){for(;Ht!==null;){var o=Ht;if(o===i){Ht=null;break}var p=o.sibling;if(p!==null){p.return=o.return,Ht=p;break}Ht=o.return}}function ky(i){for(;Ht!==null;){var o=Ht;try{switch(o.tag){case 0:case 11:case 15:var p=o.return;try{Dd(4,o)}catch(Pe){Zr(o,p,Pe)}break;case 1:var b=o.stateNode;if(typeof b.componentDidMount=="function"){var E=o.return;try{b.componentDidMount()}catch(Pe){Zr(o,E,Pe)}}var O=o.return;try{Xp(o)}catch(Pe){Zr(o,O,Pe)}break;case 5:var H=o.return;try{Xp(o)}catch(Pe){Zr(o,H,Pe)}}}catch(Pe){Zr(o,o.return,Pe)}if(o===i){Ht=null;break}var be=o.sibling;if(be!==null){be.return=o.return,Ht=be;break}Ht=o.return}}var kC=Math.ceil,Ld=q.ReactCurrentDispatcher,e0=q.ReactCurrentOwner,Rn=q.ReactCurrentBatchConfig,jr=0,ks=null,ps=null,Ts=0,vn=0,Ol=ri(0),bs=0,Wo=null,Ii=0,Fd=0,t0=0,Go=null,nn=null,r0=0,Rl=1/0,Da=null,Md=!1,s0=null,oi=null,Id=!1,ci=null,qd=0,Ho=0,n0=null,Bd=-1,zd=0;function Gs(){return(jr&6)!==0?T():Bd!==-1?Bd:Bd=T()}function di(i){return(i.mode&1)===0?1:(jr&2)!==0&&Ts!==0?Ts&-Ts:oC.transition!==null?(zd===0&&(zd=Ca()),zd):(i=Tr,i!==0||(i=window.event,i=i===void 0?16:_f(i.type)),i)}function Un(i,o,p,b){if(50<Ho)throw Ho=0,n0=null,Error(s(185));yo(i,p,b),((jr&2)===0||i!==ks)&&(i===ks&&((jr&2)===0&&(Fd|=p),bs===4&&ui(i,Ts)),an(i,b),p===1&&jr===0&&(o.mode&1)===0&&(Rl=T()+500,hd&&ni()))}function an(i,o){var p=i.callbackNode;mr(i,o);var b=ft(i,i===ks?Ts:0);if(b===0)p!==null&&We(p),i.callbackNode=null,i.callbackPriority=0;else if(o=b&-b,i.callbackPriority!==o){if(p!=null&&We(p),o===1)i.tag===0?lC(_y.bind(null,i)):mg(_y.bind(null,i)),sC(function(){(jr&6)===0&&ni()}),p=null;else{switch(vf(b)){case 1:p=P;break;case 4:p=g;break;case 16:p=m;break;case 536870912:p=N;break;default:p=m}p=Ly(p,Cy.bind(null,i))}i.callbackPriority=o,i.callbackNode=p}}function Cy(i,o){if(Bd=-1,zd=0,(jr&6)!==0)throw Error(s(327));var p=i.callbackNode;if(Dl()&&i.callbackNode!==p)return null;var b=ft(i,i===ks?Ts:0);if(b===0)return null;if((b&30)!==0||(b&i.expiredLanes)!==0||o)o=$d(i,b);else{o=b;var E=jr;jr|=2;var O=Py();(ks!==i||Ts!==o)&&(Da=null,Rl=T()+500,Bi(i,o));do try{EC();break}catch(be){Ey(i,be)}while(!0);Np(),Ld.current=O,jr=E,ps!==null?o=0:(ks=null,Ts=0,o=bs)}if(o!==0){if(o===2&&(E=en(i),E!==0&&(b=E,o=a0(i,E))),o===1)throw p=Wo,Bi(i,0),ui(i,b),an(i,T()),p;if(o===6)ui(i,b);else{if(E=i.current.alternate,(b&30)===0&&!CC(E)&&(o=$d(i,b),o===2&&(O=en(i),O!==0&&(b=O,o=a0(i,O))),o===1))throw p=Wo,Bi(i,0),ui(i,b),an(i,T()),p;switch(i.finishedWork=E,i.finishedLanes=b,o){case 0:case 1:throw Error(s(345));case 2:zi(i,nn,Da);break;case 3:if(ui(i,b),(b&130023424)===b&&(o=r0+500-T(),10<o)){if(ft(i,0)!==0)break;if(E=i.suspendedLanes,(E&b)!==b){Gs(),i.pingedLanes|=i.suspendedLanes&E;break}i.timeoutHandle=up(zi.bind(null,i,nn,Da),o);break}zi(i,nn,Da);break;case 4:if(ui(i,b),(b&4194240)===b)break;for(o=i.eventTimes,E=-1;0<b;){var H=31-Te(b);O=1<<H,H=o[H],H>E&&(E=H),b&=~O}if(b=E,b=T()-b,b=(120>b?120:480>b?480:1080>b?1080:1920>b?1920:3e3>b?3e3:4320>b?4320:1960*kC(b/1960))-b,10<b){i.timeoutHandle=up(zi.bind(null,i,nn,Da),b);break}zi(i,nn,Da);break;case 5:zi(i,nn,Da);break;default:throw Error(s(329))}}}return an(i,T()),i.callbackNode===p?Cy.bind(null,i):null}function a0(i,o){var p=Go;return i.current.memoizedState.isDehydrated&&(Bi(i,o).flags|=256),i=$d(i,o),i!==2&&(o=nn,nn=p,o!==null&&i0(o)),i}function i0(i){nn===null?nn=i:nn.push.apply(nn,i)}function CC(i){for(var o=i;;){if(o.flags&16384){var p=o.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var b=0;b<p.length;b++){var E=p[b],O=E.getSnapshot;E=E.value;try{if(!qn(O(),E))return!1}catch{return!1}}}if(p=o.child,o.subtreeFlags&16384&&p!==null)p.return=o,o=p;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ui(i,o){for(o&=~t0,o&=~Fd,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var p=31-Te(o),b=1<<p;i[p]=-1,o&=~b}}function _y(i){if((jr&6)!==0)throw Error(s(327));Dl();var o=ft(i,0);if((o&1)===0)return an(i,T()),null;var p=$d(i,o);if(i.tag!==0&&p===2){var b=en(i);b!==0&&(o=b,p=a0(i,b))}if(p===1)throw p=Wo,Bi(i,0),ui(i,o),an(i,T()),p;if(p===6)throw Error(s(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,zi(i,nn,Da),an(i,T()),null}function l0(i,o){var p=jr;jr|=1;try{return i(o)}finally{jr=p,jr===0&&(Rl=T()+500,hd&&ni())}}function qi(i){ci!==null&&ci.tag===0&&(jr&6)===0&&Dl();var o=jr;jr|=1;var p=Rn.transition,b=Tr;try{if(Rn.transition=null,Tr=1,i)return i()}finally{Tr=b,Rn.transition=p,jr=o,(jr&6)===0&&ni()}}function o0(){vn=Ol.current,Qr(Ol)}function Bi(i,o){i.finishedWork=null,i.finishedLanes=0;var p=i.timeoutHandle;if(p!==-1&&(i.timeoutHandle=-1,rC(p)),ps!==null)for(p=ps.return;p!==null;){var b=p;switch(gp(b),b.tag){case 1:b=b.type.childContextTypes,b!=null&&pd();break;case 3:Pl(),Qr(tn),Qr(qs),Ap();break;case 5:Ep(b);break;case 4:Pl();break;case 13:Qr(Yr);break;case 19:Qr(Yr);break;case 10:jp(b.type._context);break;case 22:case 23:o0()}p=p.return}if(ks=i,ps=i=mi(i.current,null),Ts=vn=o,bs=0,Wo=null,t0=Fd=Ii=0,nn=Go=null,Li!==null){for(o=0;o<Li.length;o++)if(p=Li[o],b=p.interleaved,b!==null){p.interleaved=null;var E=b.next,O=p.pending;if(O!==null){var H=O.next;O.next=E,b.next=H}p.pending=b}Li=null}return i}function Ey(i,o){do{var p=ps;try{if(Np(),kd.current=Pd,Cd){for(var b=Kr.memoizedState;b!==null;){var E=b.queue;E!==null&&(E.pending=null),b=b.next}Cd=!1}if(Mi=0,Ss=vs=Kr=null,Bo=!1,zo=0,e0.current=null,p===null||p.return===null){bs=1,Wo=o,ps=null;break}e:{var O=i,H=p.return,be=p,Pe=o;if(o=Ts,be.flags|=32768,Pe!==null&&typeof Pe=="object"&&typeof Pe.then=="function"){var Ye=Pe,ht=be,wt=ht.tag;if((ht.mode&1)===0&&(wt===0||wt===11||wt===15)){var pt=ht.alternate;pt?(ht.updateQueue=pt.updateQueue,ht.memoizedState=pt.memoizedState,ht.lanes=pt.lanes):(ht.updateQueue=null,ht.memoizedState=null)}var Wt=Zg(H);if(Wt!==null){Wt.flags&=-257,ey(Wt,H,be,O,o),Wt.mode&1&&Jg(O,Ye,o),o=Wt,Pe=Ye;var Kt=o.updateQueue;if(Kt===null){var tr=new Set;tr.add(Pe),o.updateQueue=tr}else Kt.add(Pe);break e}else{if((o&1)===0){Jg(O,Ye,o),c0();break e}Pe=Error(s(426))}}else if(Wr&&be.mode&1){var cs=Zg(H);if(cs!==null){(cs.flags&65536)===0&&(cs.flags|=256),ey(cs,H,be,O,o),bp(Al(Pe,be));break e}}O=Pe=Al(Pe,be),bs!==4&&(bs=2),Go===null?Go=[O]:Go.push(O),O=H;do{switch(O.tag){case 3:O.flags|=65536,o&=-o,O.lanes|=o;var ze=Kg(O,Pe,o);jg(O,ze);break e;case 1:be=Pe;var Re=O.type,Qe=O.stateNode;if((O.flags&128)===0&&(typeof Re.getDerivedStateFromError=="function"||Qe!==null&&typeof Qe.componentDidCatch=="function"&&(oi===null||!oi.has(Qe)))){O.flags|=65536,o&=-o,O.lanes|=o;var _t=Xg(O,be,o);jg(O,_t);break e}}O=O.return}while(O!==null)}Ty(p)}catch(sr){o=sr,ps===p&&p!==null&&(ps=p=p.return);continue}break}while(!0)}function Py(){var i=Ld.current;return Ld.current=Pd,i===null?Pd:i}function c0(){(bs===0||bs===3||bs===2)&&(bs=4),ks===null||(Ii&268435455)===0&&(Fd&268435455)===0||ui(ks,Ts)}function $d(i,o){var p=jr;jr|=2;var b=Py();(ks!==i||Ts!==o)&&(Da=null,Bi(i,o));do try{_C();break}catch(E){Ey(i,E)}while(!0);if(Np(),jr=p,Ld.current=b,ps!==null)throw Error(s(261));return ks=null,Ts=0,bs}function _C(){for(;ps!==null;)Ay(ps)}function EC(){for(;ps!==null&&!ge();)Ay(ps)}function Ay(i){var o=Dy(i.alternate,i,vn);i.memoizedProps=i.pendingProps,o===null?Ty(i):ps=o,e0.current=null}function Ty(i){var o=i;do{var p=o.alternate;if(i=o.return,(o.flags&32768)===0){if(p=bC(p,o,vn),p!==null){ps=p;return}}else{if(p=wC(p,o),p!==null){p.flags&=32767,ps=p;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{bs=6,ps=null;return}}if(o=o.sibling,o!==null){ps=o;return}ps=o=i}while(o!==null);bs===0&&(bs=5)}function zi(i,o,p){var b=Tr,E=Rn.transition;try{Rn.transition=null,Tr=1,PC(i,o,p,b)}finally{Rn.transition=E,Tr=b}return null}function PC(i,o,p,b){do Dl();while(ci!==null);if((jr&6)!==0)throw Error(s(327));p=i.finishedWork;var E=i.finishedLanes;if(p===null)return null;if(i.finishedWork=null,i.finishedLanes=0,p===i.current)throw Error(s(177));i.callbackNode=null,i.callbackPriority=0;var O=p.lanes|p.childLanes;if(ck(i,O),i===ks&&(ps=ks=null,Ts=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Id||(Id=!0,Ly(m,function(){return Dl(),null})),O=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||O){O=Rn.transition,Rn.transition=null;var H=Tr;Tr=1;var be=jr;jr|=4,e0.current=null,jC(i,p),wy(p,i),Yk(cp),Zc=!!op,cp=op=null,i.current=p,SC(p),W(),jr=be,Tr=H,Rn.transition=O}else i.current=p;if(Id&&(Id=!1,ci=i,qd=E),O=i.pendingLanes,O===0&&(oi=null),D(p.stateNode),an(i,T()),o!==null)for(b=i.onRecoverableError,p=0;p<o.length;p++)E=o[p],b(E.value,{componentStack:E.stack,digest:E.digest});if(Md)throw Md=!1,i=s0,s0=null,i;return(qd&1)!==0&&i.tag!==0&&Dl(),O=i.pendingLanes,(O&1)!==0?i===n0?Ho++:(Ho=0,n0=i):Ho=0,ni(),null}function Dl(){if(ci!==null){var i=vf(qd),o=Rn.transition,p=Tr;try{if(Rn.transition=null,Tr=16>i?16:i,ci===null)var b=!1;else{if(i=ci,ci=null,qd=0,(jr&6)!==0)throw Error(s(331));var E=jr;for(jr|=4,Ht=i.current;Ht!==null;){var O=Ht,H=O.child;if((Ht.flags&16)!==0){var be=O.deletions;if(be!==null){for(var Pe=0;Pe<be.length;Pe++){var Ye=be[Pe];for(Ht=Ye;Ht!==null;){var ht=Ht;switch(ht.tag){case 0:case 11:case 15:Vo(8,ht,O)}var wt=ht.child;if(wt!==null)wt.return=ht,Ht=wt;else for(;Ht!==null;){ht=Ht;var pt=ht.sibling,Wt=ht.return;if(fy(ht),ht===Ye){Ht=null;break}if(pt!==null){pt.return=Wt,Ht=pt;break}Ht=Wt}}}var Kt=O.alternate;if(Kt!==null){var tr=Kt.child;if(tr!==null){Kt.child=null;do{var cs=tr.sibling;tr.sibling=null,tr=cs}while(tr!==null)}}Ht=O}}if((O.subtreeFlags&2064)!==0&&H!==null)H.return=O,Ht=H;else e:for(;Ht!==null;){if(O=Ht,(O.flags&2048)!==0)switch(O.tag){case 0:case 11:case 15:Vo(9,O,O.return)}var ze=O.sibling;if(ze!==null){ze.return=O.return,Ht=ze;break e}Ht=O.return}}var Re=i.current;for(Ht=Re;Ht!==null;){H=Ht;var Qe=H.child;if((H.subtreeFlags&2064)!==0&&Qe!==null)Qe.return=H,Ht=Qe;else e:for(H=Re;Ht!==null;){if(be=Ht,(be.flags&2048)!==0)try{switch(be.tag){case 0:case 11:case 15:Dd(9,be)}}catch(sr){Zr(be,be.return,sr)}if(be===H){Ht=null;break e}var _t=be.sibling;if(_t!==null){_t.return=be.return,Ht=_t;break e}Ht=be.return}}if(jr=E,ni(),R&&typeof R.onPostCommitFiberRoot=="function")try{R.onPostCommitFiberRoot(A,i)}catch{}b=!0}return b}finally{Tr=p,Rn.transition=o}}return!1}function Oy(i,o,p){o=Al(p,o),o=Kg(i,o,1),i=ii(i,o,1),o=Gs(),i!==null&&(yo(i,1,o),an(i,o))}function Zr(i,o,p){if(i.tag===3)Oy(i,i,p);else for(;o!==null;){if(o.tag===3){Oy(o,i,p);break}else if(o.tag===1){var b=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(oi===null||!oi.has(b))){i=Al(p,i),i=Xg(o,i,1),o=ii(o,i,1),i=Gs(),o!==null&&(yo(o,1,i),an(o,i));break}}o=o.return}}function AC(i,o,p){var b=i.pingCache;b!==null&&b.delete(o),o=Gs(),i.pingedLanes|=i.suspendedLanes&p,ks===i&&(Ts&p)===p&&(bs===4||bs===3&&(Ts&130023424)===Ts&&500>T()-r0?Bi(i,0):t0|=p),an(i,o)}function Ry(i,o){o===0&&((i.mode&1)===0?o=1:(o=Se,Se<<=1,(Se&130023424)===0&&(Se=4194304)));var p=Gs();i=Ta(i,o),i!==null&&(yo(i,o,p),an(i,p))}function TC(i){var o=i.memoizedState,p=0;o!==null&&(p=o.retryLane),Ry(i,p)}function OC(i,o){var p=0;switch(i.tag){case 13:var b=i.stateNode,E=i.memoizedState;E!==null&&(p=E.retryLane);break;case 19:b=i.stateNode;break;default:throw Error(s(314))}b!==null&&b.delete(o),Ry(i,p)}var Dy;Dy=function(i,o,p){if(i!==null)if(i.memoizedProps!==o.pendingProps||tn.current)sn=!0;else{if((i.lanes&p)===0&&(o.flags&128)===0)return sn=!1,vC(i,o,p);sn=(i.flags&131072)!==0}else sn=!1,Wr&&(o.flags&1048576)!==0&&pg(o,gd,o.index);switch(o.lanes=0,o.tag){case 2:var b=o.type;Od(i,o),i=o.pendingProps;var E=Nl(o,qs.current);El(o,p),E=Rp(null,o,b,i,E,p);var O=Dp();return o.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,rn(b)?(O=!0,xd(o)):O=!1,o.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,Cp(o),E.updater=Ad,o.stateNode=E,E._reactInternals=o,Bp(o,b,i,p),o=Up(null,o,b,!0,O,p)):(o.tag=0,Wr&&O&&fp(o),Ws(null,o,E,p),o=o.child),o;case 16:b=o.elementType;e:{switch(Od(i,o),i=o.pendingProps,E=b._init,b=E(b._payload),o.type=b,E=o.tag=DC(b),i=zn(b,i),E){case 0:o=Qp(null,o,b,i,p);break e;case 1:o=iy(null,o,b,i,p);break e;case 11:o=ty(null,o,b,i,p);break e;case 14:o=ry(null,o,b,zn(b.type,i),p);break e}throw Error(s(306,b,""))}return o;case 0:return b=o.type,E=o.pendingProps,E=o.elementType===b?E:zn(b,E),Qp(i,o,b,E,p);case 1:return b=o.type,E=o.pendingProps,E=o.elementType===b?E:zn(b,E),iy(i,o,b,E,p);case 3:e:{if(ly(o),i===null)throw Error(s(387));b=o.pendingProps,O=o.memoizedState,E=O.element,Ng(i,o),jd(o,b,null,p);var H=o.memoizedState;if(b=H.element,O.isDehydrated)if(O={element:b,isDehydrated:!1,cache:H.cache,pendingSuspenseBoundaries:H.pendingSuspenseBoundaries,transitions:H.transitions},o.updateQueue.baseState=O,o.memoizedState=O,o.flags&256){E=Al(Error(s(423)),o),o=oy(i,o,b,p,E);break e}else if(b!==E){E=Al(Error(s(424)),o),o=oy(i,o,b,p,E);break e}else for(yn=ti(o.stateNode.containerInfo.firstChild),gn=o,Wr=!0,Bn=null,p=bg(o,null,b,p),o.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(kl(),b===E){o=Ra(i,o,p);break e}Ws(i,o,b,p)}o=o.child}return o;case 5:return kg(o),i===null&&vp(o),b=o.type,E=o.pendingProps,O=i!==null?i.memoizedProps:null,H=E.children,dp(b,E)?H=null:O!==null&&dp(b,O)&&(o.flags|=32),ay(i,o),Ws(i,o,H,p),o.child;case 6:return i===null&&vp(o),null;case 13:return cy(i,o,p);case 4:return _p(o,o.stateNode.containerInfo),b=o.pendingProps,i===null?o.child=Cl(o,null,b,p):Ws(i,o,b,p),o.child;case 11:return b=o.type,E=o.pendingProps,E=o.elementType===b?E:zn(b,E),ty(i,o,b,E,p);case 7:return Ws(i,o,o.pendingProps,p),o.child;case 8:return Ws(i,o,o.pendingProps.children,p),o.child;case 12:return Ws(i,o,o.pendingProps.children,p),o.child;case 10:e:{if(b=o.type._context,E=o.pendingProps,O=o.memoizedProps,H=E.value,qr(bd,b._currentValue),b._currentValue=H,O!==null)if(qn(O.value,H)){if(O.children===E.children&&!tn.current){o=Ra(i,o,p);break e}}else for(O=o.child,O!==null&&(O.return=o);O!==null;){var be=O.dependencies;if(be!==null){H=O.child;for(var Pe=be.firstContext;Pe!==null;){if(Pe.context===b){if(O.tag===1){Pe=Oa(-1,p&-p),Pe.tag=2;var Ye=O.updateQueue;if(Ye!==null){Ye=Ye.shared;var ht=Ye.pending;ht===null?Pe.next=Pe:(Pe.next=ht.next,ht.next=Pe),Ye.pending=Pe}}O.lanes|=p,Pe=O.alternate,Pe!==null&&(Pe.lanes|=p),Sp(O.return,p,o),be.lanes|=p;break}Pe=Pe.next}}else if(O.tag===10)H=O.type===o.type?null:O.child;else if(O.tag===18){if(H=O.return,H===null)throw Error(s(341));H.lanes|=p,be=H.alternate,be!==null&&(be.lanes|=p),Sp(H,p,o),H=O.sibling}else H=O.child;if(H!==null)H.return=O;else for(H=O;H!==null;){if(H===o){H=null;break}if(O=H.sibling,O!==null){O.return=H.return,H=O;break}H=H.return}O=H}Ws(i,o,E.children,p),o=o.child}return o;case 9:return E=o.type,b=o.pendingProps.children,El(o,p),E=Tn(E),b=b(E),o.flags|=1,Ws(i,o,b,p),o.child;case 14:return b=o.type,E=zn(b,o.pendingProps),E=zn(b.type,E),ry(i,o,b,E,p);case 15:return sy(i,o,o.type,o.pendingProps,p);case 17:return b=o.type,E=o.pendingProps,E=o.elementType===b?E:zn(b,E),Od(i,o),o.tag=1,rn(b)?(i=!0,xd(o)):i=!1,El(o,p),Hg(o,b,E),Bp(o,b,E,p),Up(null,o,b,!0,i,p);case 19:return uy(i,o,p);case 22:return ny(i,o,p)}throw Error(s(156,o.tag))};function Ly(i,o){return Me(i,o)}function RC(i,o,p,b){this.tag=i,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dn(i,o,p,b){return new RC(i,o,p,b)}function d0(i){return i=i.prototype,!(!i||!i.isReactComponent)}function DC(i){if(typeof i=="function")return d0(i)?1:0;if(i!=null){if(i=i.$$typeof,i===ce)return 11;if(i===Fe)return 14}return 2}function mi(i,o){var p=i.alternate;return p===null?(p=Dn(i.tag,o,i.key,i.mode),p.elementType=i.elementType,p.type=i.type,p.stateNode=i.stateNode,p.alternate=i,i.alternate=p):(p.pendingProps=o,p.type=i.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=i.flags&14680064,p.childLanes=i.childLanes,p.lanes=i.lanes,p.child=i.child,p.memoizedProps=i.memoizedProps,p.memoizedState=i.memoizedState,p.updateQueue=i.updateQueue,o=i.dependencies,p.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},p.sibling=i.sibling,p.index=i.index,p.ref=i.ref,p}function Qd(i,o,p,b,E,O){var H=2;if(b=i,typeof i=="function")d0(i)&&(H=1);else if(typeof i=="string")H=5;else e:switch(i){case M:return $i(p.children,E,O,o);case G:H=8,E|=8;break;case le:return i=Dn(12,p,o,E|2),i.elementType=le,i.lanes=O,i;case ke:return i=Dn(13,p,o,E),i.elementType=ke,i.lanes=O,i;case Ee:return i=Dn(19,p,o,E),i.elementType=Ee,i.lanes=O,i;case ye:return Ud(p,E,O,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Z:H=10;break e;case he:H=9;break e;case ce:H=11;break e;case Fe:H=14;break e;case X:H=16,b=null;break e}throw Error(s(130,i==null?i:typeof i,""))}return o=Dn(H,p,o,E),o.elementType=i,o.type=b,o.lanes=O,o}function $i(i,o,p,b){return i=Dn(7,i,b,o),i.lanes=p,i}function Ud(i,o,p,b){return i=Dn(22,i,b,o),i.elementType=ye,i.lanes=p,i.stateNode={isHidden:!1},i}function u0(i,o,p){return i=Dn(6,i,null,o),i.lanes=p,i}function m0(i,o,p){return o=Dn(4,i.children!==null?i.children:[],i.key,o),o.lanes=p,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function LC(i,o,p,b,E){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qm(0),this.expirationTimes=qm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qm(0),this.identifierPrefix=b,this.onRecoverableError=E,this.mutableSourceEagerHydrationData=null}function p0(i,o,p,b,E,O,H,be,Pe){return i=new LC(i,o,p,be,Pe),o===1?(o=1,O===!0&&(o|=8)):o=0,O=Dn(3,null,null,o),i.current=O,O.stateNode=i,O.memoizedState={element:b,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cp(O),i}function FC(i,o,p){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:re,key:b==null?null:""+b,children:i,containerInfo:o,implementation:p}}function Fy(i){if(!i)return si;i=i._reactInternals;e:{if(oe(i)!==i||i.tag!==1)throw Error(s(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(rn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(s(171))}if(i.tag===1){var p=i.type;if(rn(p))return dg(i,p,o)}return o}function My(i,o,p,b,E,O,H,be,Pe){return i=p0(p,b,!0,i,E,O,H,be,Pe),i.context=Fy(null),p=i.current,b=Gs(),E=di(p),O=Oa(b,E),O.callback=o??null,ii(p,O,E),i.current.lanes=E,yo(i,E,b),an(i,b),i}function Vd(i,o,p,b){var E=o.current,O=Gs(),H=di(E);return p=Fy(p),o.context===null?o.context=p:o.pendingContext=p,o=Oa(O,H),o.payload={element:i},b=b===void 0?null:b,b!==null&&(o.callback=b),i=ii(E,o,H),i!==null&&(Un(i,E,H,O),Nd(i,E,H)),H}function Wd(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Iy(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var p=i.retryLane;i.retryLane=p!==0&&p<o?p:o}}function x0(i,o){Iy(i,o),(i=i.alternate)&&Iy(i,o)}function MC(){return null}var qy=typeof reportError=="function"?reportError:function(i){console.error(i)};function h0(i){this._internalRoot=i}Gd.prototype.render=h0.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(s(409));Vd(i,o,null,null)},Gd.prototype.unmount=h0.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;qi(function(){Vd(null,i,null,null)}),o[_a]=null}};function Gd(i){this._internalRoot=i}Gd.prototype.unstable_scheduleHydration=function(i){if(i){var o=Nf();i={blockedOn:null,target:i,priority:o};for(var p=0;p<Ja.length&&o!==0&&o<Ja[p].priority;p++);Ja.splice(p,0,i),p===0&&kf(i)}};function f0(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Hd(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function By(){}function IC(i,o,p,b,E){if(E){if(typeof b=="function"){var O=b;b=function(){var Ye=Wd(H);O.call(Ye)}}var H=My(o,b,i,0,null,!1,!1,"",By);return i._reactRootContainer=H,i[_a]=H.current,Oo(i.nodeType===8?i.parentNode:i),qi(),H}for(;E=i.lastChild;)i.removeChild(E);if(typeof b=="function"){var be=b;b=function(){var Ye=Wd(Pe);be.call(Ye)}}var Pe=p0(i,0,!1,null,null,!1,!1,"",By);return i._reactRootContainer=Pe,i[_a]=Pe.current,Oo(i.nodeType===8?i.parentNode:i),qi(function(){Vd(o,Pe,p,b)}),Pe}function Yd(i,o,p,b,E){var O=p._reactRootContainer;if(O){var H=O;if(typeof E=="function"){var be=E;E=function(){var Pe=Wd(H);be.call(Pe)}}Vd(o,H,i,E)}else H=IC(p,o,i,E,b);return Wd(H)}bf=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var p=Je(o.pendingLanes);p!==0&&(Bm(o,p|1),an(o,T()),(jr&6)===0&&(Rl=T()+500,ni()))}break;case 13:qi(function(){var b=Ta(i,1);if(b!==null){var E=Gs();Un(b,i,1,E)}}),x0(i,1)}},zm=function(i){if(i.tag===13){var o=Ta(i,134217728);if(o!==null){var p=Gs();Un(o,i,134217728,p)}x0(i,134217728)}},wf=function(i){if(i.tag===13){var o=di(i),p=Ta(i,o);if(p!==null){var b=Gs();Un(p,i,o,b)}x0(i,o)}},Nf=function(){return Tr},jf=function(i,o){var p=Tr;try{return Tr=i,o()}finally{Tr=p}},Qt=function(i,o,p){switch(o){case"input":if(Ie(i,p),o=p.name,p.type==="radio"&&o!=null){for(p=i;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<p.length;o++){var b=p[o];if(b!==i&&b.form===i.form){var E=md(b);if(!E)throw Error(s(90));tt(b),Ie(b,E)}}}break;case"textarea":ot(i,p);break;case"select":o=p.value,o!=null&&mt(i,!!p.multiple,o,!1)}},er=l0,At=qi;var qC={usingClientEntryPoint:!1,Events:[Lo,bl,md,gt,Pt,l0]},Yo={findFiberByHostInstance:Ti,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},BC={bundleType:Yo.bundleType,version:Yo.version,rendererPackageName:Yo.rendererPackageName,rendererConfig:Yo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:q.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Ne(i),i===null?null:i.stateNode},findFiberByHostInstance:Yo.findFiberByHostInstance||MC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Kd.isDisabled&&Kd.supportsFiber)try{A=Kd.inject(BC),R=Kd}catch{}}return ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qC,ln.createPortal=function(i,o){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f0(o))throw Error(s(200));return FC(i,o,null,p)},ln.createRoot=function(i,o){if(!f0(i))throw Error(s(299));var p=!1,b="",E=qy;return o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(b=o.identifierPrefix),o.onRecoverableError!==void 0&&(E=o.onRecoverableError)),o=p0(i,1,!1,null,null,p,!1,b,E),i[_a]=o.current,Oo(i.nodeType===8?i.parentNode:i),new h0(o)},ln.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(s(188)):(i=Object.keys(i).join(","),Error(s(268,i)));return i=Ne(o),i=i===null?null:i.stateNode,i},ln.flushSync=function(i){return qi(i)},ln.hydrate=function(i,o,p){if(!Hd(o))throw Error(s(200));return Yd(null,i,o,!0,p)},ln.hydrateRoot=function(i,o,p){if(!f0(i))throw Error(s(405));var b=p!=null&&p.hydratedSources||null,E=!1,O="",H=qy;if(p!=null&&(p.unstable_strictMode===!0&&(E=!0),p.identifierPrefix!==void 0&&(O=p.identifierPrefix),p.onRecoverableError!==void 0&&(H=p.onRecoverableError)),o=My(o,null,i,1,p??null,E,!1,O,H),i[_a]=o.current,Oo(i),b)for(i=0;i<b.length;i++)p=b[i],E=p._getVersion,E=E(p._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[p,E]:o.mutableSourceEagerHydrationData.push(p,E);return new Gd(o)},ln.render=function(i,o,p){if(!Hd(o))throw Error(s(200));return Yd(null,i,o,!1,p)},ln.unmountComponentAtNode=function(i){if(!Hd(i))throw Error(s(40));return i._reactRootContainer?(qi(function(){Yd(null,null,i,!1,function(){i._reactRootContainer=null,i[_a]=null})}),!0):!1},ln.unstable_batchedUpdates=l0,ln.unstable_renderSubtreeIntoContainer=function(i,o,p,b){if(!Hd(p))throw Error(s(200));if(i==null||i._reactInternals===void 0)throw Error(s(38));return Yd(i,o,p,!1,b)},ln.version="18.3.1-next-f1338f8080-20240426",ln}var Hy;function i1(){if(Hy)return v0.exports;Hy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),v0.exports=HC(),v0.exports}var Yy;function YC(){if(Yy)return Jd;Yy=1;var t=i1();return Jd.createRoot=t.createRoot,Jd.hydrateRoot=t.hydrateRoot,Jd}var KC=YC(),d=nm();const gi=a1(d),Tx=$C({__proto__:null,default:gi},[d]);/**
 * react-router v7.9.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Ky="popstate";function XC(t={}){function r(n,a){let{pathname:l,search:c,hash:u}=n.location;return nx("",{pathname:l,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function s(n,a){return typeof a=="string"?a:mc(a)}return ZC(r,s,null,t)}function Gr(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function Xn(t,r){if(!t){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function JC(){return Math.random().toString(36).substring(2,10)}function Xy(t,r){return{usr:t.state,key:t.key,idx:r}}function nx(t,r,s=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof r=="string"?ro(r):r,state:s,key:r&&r.key||n||JC()}}function mc({pathname:t="/",search:r="",hash:s=""}){return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function ro(t){let r={};if(t){let s=t.indexOf("#");s>=0&&(r.hash=t.substring(s),t=t.substring(0,s));let n=t.indexOf("?");n>=0&&(r.search=t.substring(n),t=t.substring(0,n)),t&&(r.pathname=t)}return r}function ZC(t,r,s,n={}){let{window:a=document.defaultView,v5Compat:l=!1}=n,c=a.history,u="POP",f=null,h=y();h==null&&(h=0,c.replaceState({...c.state,idx:h},""));function y(){return(c.state||{idx:null}).idx}function w(){u="POP";let _=y(),I=_==null?null:_-h;h=_,f&&f({action:u,location:S.location,delta:I})}function j(_,I){u="PUSH";let F=nx(S.location,_,I);h=y()+1;let B=Xy(F,h),q=S.createHref(F);try{c.pushState(B,"",q)}catch(me){if(me instanceof DOMException&&me.name==="DataCloneError")throw me;a.location.assign(q)}l&&f&&f({action:u,location:S.location,delta:1})}function C(_,I){u="REPLACE";let F=nx(S.location,_,I);h=y();let B=Xy(F,h),q=S.createHref(F);c.replaceState(B,"",q),l&&f&&f({action:u,location:S.location,delta:0})}function k(_){return e_(_)}let S={get action(){return u},get location(){return t(a,c)},listen(_){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(Ky,w),f=_,()=>{a.removeEventListener(Ky,w),f=null}},createHref(_){return r(a,_)},createURL:k,encodeLocation(_){let I=k(_);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:j,replace:C,go(_){return c.go(_)}};return S}function e_(t,r=!1){let s="http://localhost";typeof window<"u"&&(s=window.location.origin!=="null"?window.location.origin:window.location.href),Gr(s,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:mc(t);return n=n.replace(/ $/,"%20"),!r&&n.startsWith("//")&&(n=s+n),new URL(n,s)}function l1(t,r,s="/"){return t_(t,r,s,!1)}function t_(t,r,s,n){let a=typeof r=="string"?ro(r):r,l=$a(a.pathname||"/",s);if(l==null)return null;let c=o1(t);r_(c);let u=null;for(let f=0;u==null&&f<c.length;++f){let h=p_(l);u=u_(c[f],h,n)}return u}function o1(t,r=[],s=[],n="",a=!1){let l=(c,u,f=a,h)=>{let y={relativePath:h===void 0?c.path||"":h,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(y.relativePath.startsWith("/")){if(!y.relativePath.startsWith(n)&&f)return;Gr(y.relativePath.startsWith(n),`Absolute route path "${y.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),y.relativePath=y.relativePath.slice(n.length)}let w=Ia([n,y.relativePath]),j=s.concat(y);c.children&&c.children.length>0&&(Gr(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${w}".`),o1(c.children,r,j,w,f)),!(c.path==null&&!c.index)&&r.push({path:w,score:c_(w,c.index),routesMeta:j})};return t.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))l(c,u);else for(let f of c1(c.path))l(c,u,!0,f)}),r}function c1(t){let r=t.split("/");if(r.length===0)return[];let[s,...n]=r,a=s.endsWith("?"),l=s.replace(/\?$/,"");if(n.length===0)return a?[l,""]:[l];let c=c1(n.join("/")),u=[];return u.push(...c.map(f=>f===""?l:[l,f].join("/"))),a&&u.push(...c),u.map(f=>t.startsWith("/")&&f===""?"/":f)}function r_(t){t.sort((r,s)=>r.score!==s.score?s.score-r.score:d_(r.routesMeta.map(n=>n.childrenIndex),s.routesMeta.map(n=>n.childrenIndex)))}var s_=/^:[\w-]+$/,n_=3,a_=2,i_=1,l_=10,o_=-2,Jy=t=>t==="*";function c_(t,r){let s=t.split("/"),n=s.length;return s.some(Jy)&&(n+=o_),r&&(n+=a_),s.filter(a=>!Jy(a)).reduce((a,l)=>a+(s_.test(l)?n_:l===""?i_:l_),n)}function d_(t,r){return t.length===r.length&&t.slice(0,-1).every((n,a)=>n===r[a])?t[t.length-1]-r[r.length-1]:0}function u_(t,r,s=!1){let{routesMeta:n}=t,a={},l="/",c=[];for(let u=0;u<n.length;++u){let f=n[u],h=u===n.length-1,y=l==="/"?r:r.slice(l.length)||"/",w=Eu({path:f.relativePath,caseSensitive:f.caseSensitive,end:h},y),j=f.route;if(!w&&h&&s&&!n[n.length-1].route.index&&(w=Eu({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},y)),!w)return null;Object.assign(a,w.params),c.push({params:a,pathname:Ia([l,w.pathname]),pathnameBase:g_(Ia([l,w.pathnameBase])),route:j}),w.pathnameBase!=="/"&&(l=Ia([l,w.pathnameBase]))}return c}function Eu(t,r){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,n]=m_(t.path,t.caseSensitive,t.end),a=r.match(s);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((h,{paramName:y,isOptional:w},j)=>{if(y==="*"){let k=u[j]||"";c=l.slice(0,l.length-k.length).replace(/(.)\/+$/,"$1")}const C=u[j];return w&&!C?h[y]=void 0:h[y]=(C||"").replace(/%2F/g,"/"),h},{}),pathname:l,pathnameBase:c,pattern:t}}function m_(t,r=!1,s=!0){Xn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,f)=>(n.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,r?void 0:"i"),n]}function p_(t){try{return t.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Xn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),t}}function $a(t,r){if(r==="/")return t;if(!t.toLowerCase().startsWith(r.toLowerCase()))return null;let s=r.endsWith("/")?r.length-1:r.length,n=t.charAt(s);return n&&n!=="/"?null:t.slice(s)||"/"}function x_(t,r="/"){let{pathname:s,search:n="",hash:a=""}=typeof t=="string"?ro(t):t;return{pathname:s?s.startsWith("/")?s:h_(s,r):r,search:y_(n),hash:v_(a)}}function h_(t,r){let s=r.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?s.length>1&&s.pop():a!=="."&&s.push(a)}),s.length>1?s.join("/"):"/"}function N0(t,r,s,n){return`Cannot include a '${t}' character in a manually specified \`to.${r}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${s}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function f_(t){return t.filter((r,s)=>s===0||r.route.path&&r.route.path.length>0)}function Ox(t){let r=f_(t);return r.map((s,n)=>n===r.length-1?s.pathname:s.pathnameBase)}function Rx(t,r,s,n=!1){let a;typeof t=="string"?a=ro(t):(a={...t},Gr(!a.pathname||!a.pathname.includes("?"),N0("?","pathname","search",a)),Gr(!a.pathname||!a.pathname.includes("#"),N0("#","pathname","hash",a)),Gr(!a.search||!a.search.includes("#"),N0("#","search","hash",a)));let l=t===""||a.pathname==="",c=l?"/":a.pathname,u;if(c==null)u=s;else{let w=r.length-1;if(!n&&c.startsWith("..")){let j=c.split("/");for(;j[0]==="..";)j.shift(),w-=1;a.pathname=j.join("/")}u=w>=0?r[w]:"/"}let f=x_(a,u),h=c&&c!=="/"&&c.endsWith("/"),y=(l||c===".")&&s.endsWith("/");return!f.pathname.endsWith("/")&&(h||y)&&(f.pathname+="/"),f}var Ia=t=>t.join("/").replace(/\/\/+/g,"/"),g_=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),y_=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,v_=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function b_(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var d1=["POST","PUT","PATCH","DELETE"];new Set(d1);var w_=["GET",...d1];new Set(w_);var so=d.createContext(null);so.displayName="DataRouter";var am=d.createContext(null);am.displayName="DataRouterState";d.createContext(!1);var u1=d.createContext({isTransitioning:!1});u1.displayName="ViewTransition";var N_=d.createContext(new Map);N_.displayName="Fetchers";var j_=d.createContext(null);j_.displayName="Await";var sa=d.createContext(null);sa.displayName="Navigation";var kc=d.createContext(null);kc.displayName="Location";var Na=d.createContext({outlet:null,matches:[],isDataRoute:!1});Na.displayName="Route";var Dx=d.createContext(null);Dx.displayName="RouteError";function S_(t,{relative:r}={}){Gr(no(),"useHref() may be used only in the context of a <Router> component.");let{basename:s,navigator:n}=d.useContext(sa),{hash:a,pathname:l,search:c}=Cc(t,{relative:r}),u=l;return s!=="/"&&(u=l==="/"?s:Ia([s,l])),n.createHref({pathname:u,search:c,hash:a})}function no(){return d.useContext(kc)!=null}function ja(){return Gr(no(),"useLocation() may be used only in the context of a <Router> component."),d.useContext(kc).location}var m1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function p1(t){d.useContext(sa).static||d.useLayoutEffect(t)}function En(){let{isDataRoute:t}=d.useContext(Na);return t?M_():k_()}function k_(){Gr(no(),"useNavigate() may be used only in the context of a <Router> component.");let t=d.useContext(so),{basename:r,navigator:s}=d.useContext(sa),{matches:n}=d.useContext(Na),{pathname:a}=ja(),l=JSON.stringify(Ox(n)),c=d.useRef(!1);return p1(()=>{c.current=!0}),d.useCallback((f,h={})=>{if(Xn(c.current,m1),!c.current)return;if(typeof f=="number"){s.go(f);return}let y=Rx(f,JSON.parse(l),a,h.relative==="path");t==null&&r!=="/"&&(y.pathname=y.pathname==="/"?r:Ia([r,y.pathname])),(h.replace?s.replace:s.push)(y,h.state,h)},[r,s,l,a,t])}d.createContext(null);function Cc(t,{relative:r}={}){let{matches:s}=d.useContext(Na),{pathname:n}=ja(),a=JSON.stringify(Ox(s));return d.useMemo(()=>Rx(t,JSON.parse(a),n,r==="path"),[t,a,n,r])}function C_(t,r){return x1(t,r)}function x1(t,r,s,n,a){Gr(no(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=d.useContext(sa),{matches:c}=d.useContext(Na),u=c[c.length-1],f=u?u.params:{},h=u?u.pathname:"/",y=u?u.pathnameBase:"/",w=u&&u.route;{let F=w&&w.path||"";h1(h,!w||F.endsWith("*")||F.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${F}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${F}"> to <Route path="${F==="/"?"*":`${F}/*`}">.`)}let j=ja(),C;if(r){let F=typeof r=="string"?ro(r):r;Gr(y==="/"||F.pathname?.startsWith(y),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${y}" but pathname "${F.pathname}" was given in the \`location\` prop.`),C=F}else C=j;let k=C.pathname||"/",S=k;if(y!=="/"){let F=y.replace(/^\//,"").split("/");S="/"+k.replace(/^\//,"").split("/").slice(F.length).join("/")}let _=l1(t,{pathname:S});Xn(w||_!=null,`No routes matched location "${C.pathname}${C.search}${C.hash}" `),Xn(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${C.pathname}${C.search}${C.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let I=T_(_&&_.map(F=>Object.assign({},F,{params:Object.assign({},f,F.params),pathname:Ia([y,l.encodeLocation?l.encodeLocation(F.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:F.pathname]),pathnameBase:F.pathnameBase==="/"?y:Ia([y,l.encodeLocation?l.encodeLocation(F.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:F.pathnameBase])})),c,s,n,a);return r&&I?d.createElement(kc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...C},navigationType:"POP"}},I):I}function __(){let t=F_(),r=b_(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},l={padding:"2px 4px",backgroundColor:n},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=d.createElement(d.Fragment,null,d.createElement("p",null," Hey developer "),d.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",d.createElement("code",{style:l},"ErrorBoundary")," or"," ",d.createElement("code",{style:l},"errorElement")," prop on your route.")),d.createElement(d.Fragment,null,d.createElement("h2",null,"Unexpected Application Error!"),d.createElement("h3",{style:{fontStyle:"italic"}},r),s?d.createElement("pre",{style:a},s):null,c)}var E_=d.createElement(__,null),P_=class extends d.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){this.props.unstable_onError?this.props.unstable_onError(t,r):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?d.createElement(Na.Provider,{value:this.props.routeContext},d.createElement(Dx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function A_({routeContext:t,match:r,children:s}){let n=d.useContext(so);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),d.createElement(Na.Provider,{value:t},s)}function T_(t,r=[],s=null,n=null,a=null){if(t==null){if(!s)return null;if(s.errors)t=s.matches;else if(r.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let l=t,c=s?.errors;if(c!=null){let h=l.findIndex(y=>y.route.id&&c?.[y.route.id]!==void 0);Gr(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,h+1))}let u=!1,f=-1;if(s)for(let h=0;h<l.length;h++){let y=l[h];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(f=h),y.route.id){let{loaderData:w,errors:j}=s,C=y.route.loader&&!w.hasOwnProperty(y.route.id)&&(!j||j[y.route.id]===void 0);if(y.route.lazy||C){u=!0,f>=0?l=l.slice(0,f+1):l=[l[0]];break}}}return l.reduceRight((h,y,w)=>{let j,C=!1,k=null,S=null;s&&(j=c&&y.route.id?c[y.route.id]:void 0,k=y.route.errorElement||E_,u&&(f<0&&w===0?(h1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),C=!0,S=null):f===w&&(C=!0,S=y.route.hydrateFallbackElement||null)));let _=r.concat(l.slice(0,w+1)),I=()=>{let F;return j?F=k:C?F=S:y.route.Component?F=d.createElement(y.route.Component,null):y.route.element?F=y.route.element:F=h,d.createElement(A_,{match:y,routeContext:{outlet:h,matches:_,isDataRoute:s!=null},children:F})};return s&&(y.route.ErrorBoundary||y.route.errorElement||w===0)?d.createElement(P_,{location:s.location,revalidation:s.revalidation,component:k,error:j,children:I(),routeContext:{outlet:null,matches:_,isDataRoute:!0},unstable_onError:n}):I()},null)}function Lx(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function O_(t){let r=d.useContext(so);return Gr(r,Lx(t)),r}function R_(t){let r=d.useContext(am);return Gr(r,Lx(t)),r}function D_(t){let r=d.useContext(Na);return Gr(r,Lx(t)),r}function Fx(t){let r=D_(t),s=r.matches[r.matches.length-1];return Gr(s.route.id,`${t} can only be used on routes that contain a unique "id"`),s.route.id}function L_(){return Fx("useRouteId")}function F_(){let t=d.useContext(Dx),r=R_("useRouteError"),s=Fx("useRouteError");return t!==void 0?t:r.errors?.[s]}function M_(){let{router:t}=O_("useNavigate"),r=Fx("useNavigate"),s=d.useRef(!1);return p1(()=>{s.current=!0}),d.useCallback(async(a,l={})=>{Xn(s.current,m1),s.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:r,...l}))},[t,r])}var Zy={};function h1(t,r,s){!r&&!Zy[t]&&(Zy[t]=!0,Xn(!1,s))}d.memo(I_);function I_({routes:t,future:r,state:s,unstable_onError:n}){return x1(t,void 0,s,n,r)}function Pu({to:t,replace:r,state:s,relative:n}){Gr(no(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=d.useContext(sa);Xn(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=d.useContext(Na),{pathname:c}=ja(),u=En(),f=Rx(t,Ox(l),c,n==="path"),h=JSON.stringify(f);return d.useEffect(()=>{u(JSON.parse(h),{replace:r,state:s,relative:n})},[u,h,n,r,s]),null}function Br(t){Gr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function q_({basename:t="/",children:r=null,location:s,navigationType:n="POP",navigator:a,static:l=!1}){Gr(!no(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),u=d.useMemo(()=>({basename:c,navigator:a,static:l,future:{}}),[c,a,l]);typeof s=="string"&&(s=ro(s));let{pathname:f="/",search:h="",hash:y="",state:w=null,key:j="default"}=s,C=d.useMemo(()=>{let k=$a(f,c);return k==null?null:{location:{pathname:k,search:h,hash:y,state:w,key:j},navigationType:n}},[c,f,h,y,w,j,n]);return Xn(C!=null,`<Router basename="${c}"> is not able to match the URL "${f}${h}${y}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:d.createElement(sa.Provider,{value:u},d.createElement(kc.Provider,{children:r,value:C}))}function B_({children:t,location:r}){return C_(ax(t),r)}function ax(t,r=[]){let s=[];return d.Children.forEach(t,(n,a)=>{if(!d.isValidElement(n))return;let l=[...r,a];if(n.type===d.Fragment){s.push.apply(s,ax(n.props.children,l));return}Gr(n.type===Br,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Gr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let c={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=ax(n.props.children,l)),s.push(c)}),s}var gu="get",yu="application/x-www-form-urlencoded";function im(t){return t!=null&&typeof t.tagName=="string"}function z_(t){return im(t)&&t.tagName.toLowerCase()==="button"}function $_(t){return im(t)&&t.tagName.toLowerCase()==="form"}function Q_(t){return im(t)&&t.tagName.toLowerCase()==="input"}function U_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function V_(t,r){return t.button===0&&(!r||r==="_self")&&!U_(t)}var Zd=null;function W_(){if(Zd===null)try{new FormData(document.createElement("form"),0),Zd=!1}catch{Zd=!0}return Zd}var G_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function j0(t){return t!=null&&!G_.has(t)?(Xn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${yu}"`),null):t}function H_(t,r){let s,n,a,l,c;if($_(t)){let u=t.getAttribute("action");n=u?$a(u,r):null,s=t.getAttribute("method")||gu,a=j0(t.getAttribute("enctype"))||yu,l=new FormData(t)}else if(z_(t)||Q_(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||u.getAttribute("action");if(n=f?$a(f,r):null,s=t.getAttribute("formmethod")||u.getAttribute("method")||gu,a=j0(t.getAttribute("formenctype"))||j0(u.getAttribute("enctype"))||yu,l=new FormData(u,t),!W_()){let{name:h,type:y,value:w}=t;if(y==="image"){let j=h?`${h}.`:"";l.append(`${j}x`,"0"),l.append(`${j}y`,"0")}else h&&l.append(h,w)}}else{if(im(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');s=gu,n=null,a=yu,c=t}return l&&a==="text/plain"&&(c=l,l=void 0),{action:n,method:s.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Mx(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function Y_(t,r,s){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${s}`:r&&$a(n.pathname,r)==="/"?n.pathname=`${r.replace(/\/$/,"")}/_root.${s}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${s}`,n}async function K_(t,r){if(t.id in r)return r[t.id];try{let s=await import(t.module);return r[t.id]=s,s}catch(s){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(s),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function X_(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function J_(t,r,s){let n=await Promise.all(t.map(async a=>{let l=r.routes[a.route.id];if(l){let c=await K_(l,s);return c.links?c.links():[]}return[]}));return r3(n.flat(1).filter(X_).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function ev(t,r,s,n,a,l){let c=(f,h)=>s[h]?f.route.id!==s[h].route.id:!0,u=(f,h)=>s[h].pathname!==f.pathname||s[h].route.path?.endsWith("*")&&s[h].params["*"]!==f.params["*"];return l==="assets"?r.filter((f,h)=>c(f,h)||u(f,h)):l==="data"?r.filter((f,h)=>{let y=n.routes[f.route.id];if(!y||!y.hasLoader)return!1;if(c(f,h)||u(f,h))return!0;if(f.route.shouldRevalidate){let w=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:s[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function Z_(t,r,{includeHydrateFallback:s}={}){return e3(t.map(n=>{let a=r.routes[n.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),s&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function e3(t){return[...new Set(t)]}function t3(t){let r={},s=Object.keys(t).sort();for(let n of s)r[n]=t[n];return r}function r3(t,r){let s=new Set;return new Set(r),t.reduce((n,a)=>{let l=JSON.stringify(t3(a));return s.has(l)||(s.add(l),n.push({key:l,link:a})),n},[])}function f1(){let t=d.useContext(so);return Mx(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function s3(){let t=d.useContext(am);return Mx(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Ix=d.createContext(void 0);Ix.displayName="FrameworkContext";function g1(){let t=d.useContext(Ix);return Mx(t,"You must render this element inside a <HydratedRouter> element"),t}function n3(t,r){let s=d.useContext(Ix),[n,a]=d.useState(!1),[l,c]=d.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:h,onMouseLeave:y,onTouchStart:w}=r,j=d.useRef(null);d.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let S=I=>{I.forEach(F=>{c(F.isIntersecting)})},_=new IntersectionObserver(S,{threshold:.5});return j.current&&_.observe(j.current),()=>{_.disconnect()}}},[t]),d.useEffect(()=>{if(n){let S=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(S)}}},[n]);let C=()=>{a(!0)},k=()=>{a(!1),c(!1)};return s?t!=="intent"?[l,j,{}]:[l,j,{onFocus:Xo(u,C),onBlur:Xo(f,k),onMouseEnter:Xo(h,C),onMouseLeave:Xo(y,k),onTouchStart:Xo(w,C)}]:[!1,j,{}]}function Xo(t,r){return s=>{t&&t(s),s.defaultPrevented||r(s)}}function a3({page:t,...r}){let{router:s}=f1(),n=d.useMemo(()=>l1(s.routes,t,s.basename),[s.routes,t,s.basename]);return n?d.createElement(l3,{page:t,matches:n,...r}):null}function i3(t){let{manifest:r,routeModules:s}=g1(),[n,a]=d.useState([]);return d.useEffect(()=>{let l=!1;return J_(t,r,s).then(c=>{l||a(c)}),()=>{l=!0}},[t,r,s]),n}function l3({page:t,matches:r,...s}){let n=ja(),{manifest:a,routeModules:l}=g1(),{basename:c}=f1(),{loaderData:u,matches:f}=s3(),h=d.useMemo(()=>ev(t,r,f,a,n,"data"),[t,r,f,a,n]),y=d.useMemo(()=>ev(t,r,f,a,n,"assets"),[t,r,f,a,n]),w=d.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let k=new Set,S=!1;if(r.forEach(I=>{let F=a.routes[I.route.id];!F||!F.hasLoader||(!h.some(B=>B.route.id===I.route.id)&&I.route.id in u&&l[I.route.id]?.shouldRevalidate||F.hasClientLoader?S=!0:k.add(I.route.id))}),k.size===0)return[];let _=Y_(t,c,"data");return S&&k.size>0&&_.searchParams.set("_routes",r.filter(I=>k.has(I.route.id)).map(I=>I.route.id).join(",")),[_.pathname+_.search]},[c,u,n,a,h,r,t,l]),j=d.useMemo(()=>Z_(y,a),[y,a]),C=i3(y);return d.createElement(d.Fragment,null,w.map(k=>d.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...s})),j.map(k=>d.createElement("link",{key:k,rel:"modulepreload",href:k,...s})),C.map(({key:k,link:S})=>d.createElement("link",{key:k,nonce:s.nonce,...S})))}function o3(...t){return r=>{t.forEach(s=>{typeof s=="function"?s(r):s!=null&&(s.current=r)})}}var y1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{y1&&(window.__reactRouterVersion="7.9.5")}catch{}function c3({basename:t,children:r,window:s}){let n=d.useRef();n.current==null&&(n.current=XC({window:s,v5Compat:!0}));let a=n.current,[l,c]=d.useState({action:a.action,location:a.location}),u=d.useCallback(f=>{d.startTransition(()=>c(f))},[c]);return d.useLayoutEffect(()=>a.listen(u),[a,u]),d.createElement(q_,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:a})}var v1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,b1=d.forwardRef(function({onClick:r,discover:s="render",prefetch:n="none",relative:a,reloadDocument:l,replace:c,state:u,target:f,to:h,preventScrollReset:y,viewTransition:w,...j},C){let{basename:k}=d.useContext(sa),S=typeof h=="string"&&v1.test(h),_,I=!1;if(typeof h=="string"&&S&&(_=h,y1))try{let le=new URL(window.location.href),Z=h.startsWith("//")?new URL(le.protocol+h):new URL(h),he=$a(Z.pathname,k);Z.origin===le.origin&&he!=null?h=he+Z.search+Z.hash:I=!0}catch{Xn(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let F=S_(h,{relative:a}),[B,q,me]=n3(n,j),re=p3(h,{replace:c,state:u,target:f,preventScrollReset:y,relative:a,viewTransition:w});function M(le){r&&r(le),le.defaultPrevented||re(le)}let G=d.createElement("a",{...j,...me,href:_||F,onClick:I||l?r:M,ref:o3(C,q),target:f,"data-discover":!S&&s==="render"?"true":void 0});return B&&!S?d.createElement(d.Fragment,null,G,d.createElement(a3,{page:F})):G});b1.displayName="Link";var d3=d.forwardRef(function({"aria-current":r="page",caseSensitive:s=!1,className:n="",end:a=!1,style:l,to:c,viewTransition:u,children:f,...h},y){let w=Cc(c,{relative:h.relative}),j=ja(),C=d.useContext(am),{navigator:k,basename:S}=d.useContext(sa),_=C!=null&&y3(w)&&u===!0,I=k.encodeLocation?k.encodeLocation(w).pathname:w.pathname,F=j.pathname,B=C&&C.navigation&&C.navigation.location?C.navigation.location.pathname:null;s||(F=F.toLowerCase(),B=B?B.toLowerCase():null,I=I.toLowerCase()),B&&S&&(B=$a(B,S)||B);const q=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let me=F===I||!a&&F.startsWith(I)&&F.charAt(q)==="/",re=B!=null&&(B===I||!a&&B.startsWith(I)&&B.charAt(I.length)==="/"),M={isActive:me,isPending:re,isTransitioning:_},G=me?r:void 0,le;typeof n=="function"?le=n(M):le=[n,me?"active":null,re?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let Z=typeof l=="function"?l(M):l;return d.createElement(b1,{...h,"aria-current":G,className:le,ref:y,style:Z,to:c,viewTransition:u},typeof f=="function"?f(M):f)});d3.displayName="NavLink";var u3=d.forwardRef(({discover:t="render",fetcherKey:r,navigate:s,reloadDocument:n,replace:a,state:l,method:c=gu,action:u,onSubmit:f,relative:h,preventScrollReset:y,viewTransition:w,...j},C)=>{let k=f3(),S=g3(u,{relative:h}),_=c.toLowerCase()==="get"?"get":"post",I=typeof u=="string"&&v1.test(u),F=B=>{if(f&&f(B),B.defaultPrevented)return;B.preventDefault();let q=B.nativeEvent.submitter,me=q?.getAttribute("formmethod")||c;k(q||B.currentTarget,{fetcherKey:r,method:me,navigate:s,replace:a,state:l,relative:h,preventScrollReset:y,viewTransition:w})};return d.createElement("form",{ref:C,method:_,action:S,onSubmit:n?f:F,...j,"data-discover":!I&&t==="render"?"true":void 0})});u3.displayName="Form";function m3(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function w1(t){let r=d.useContext(so);return Gr(r,m3(t)),r}function p3(t,{target:r,replace:s,state:n,preventScrollReset:a,relative:l,viewTransition:c}={}){let u=En(),f=ja(),h=Cc(t,{relative:l});return d.useCallback(y=>{if(V_(y,r)){y.preventDefault();let w=s!==void 0?s:mc(f)===mc(h);u(t,{replace:w,state:n,preventScrollReset:a,relative:l,viewTransition:c})}},[f,u,h,s,n,r,t,a,l,c])}var x3=0,h3=()=>`__${String(++x3)}__`;function f3(){let{router:t}=w1("useSubmit"),{basename:r}=d.useContext(sa),s=L_();return d.useCallback(async(n,a={})=>{let{action:l,method:c,encType:u,formData:f,body:h}=H_(n,r);if(a.navigate===!1){let y=a.fetcherKey||h3();await t.fetch(y,s,a.action||l,{preventScrollReset:a.preventScrollReset,formData:f,body:h,formMethod:a.method||c,formEncType:a.encType||u,flushSync:a.flushSync})}else await t.navigate(a.action||l,{preventScrollReset:a.preventScrollReset,formData:f,body:h,formMethod:a.method||c,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:s,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,r,s])}function g3(t,{relative:r}={}){let{basename:s}=d.useContext(sa),n=d.useContext(Na);Gr(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),l={...Cc(t||".",{relative:r})},c=ja();if(t==null){l.search=c.search;let u=new URLSearchParams(l.search),f=u.getAll("index");if(f.some(y=>y==="")){u.delete("index"),f.filter(w=>w).forEach(w=>u.append("index",w));let y=u.toString();l.search=y?`?${y}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),s!=="/"&&(l.pathname=l.pathname==="/"?s:Ia([s,l.pathname])),mc(l)}function y3(t,{relative:r}={}){let s=d.useContext(u1);Gr(s!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=w1("useViewTransitionState"),a=Cc(t,{relative:r});if(!s.isTransitioning)return!1;let l=$a(s.currentLocation.pathname,n)||s.currentLocation.pathname,c=$a(s.nextLocation.pathname,n)||s.nextLocation.pathname;return Eu(a.pathname,c)!=null||Eu(a.pathname,l)!=null}var _c=i1();const v3=a1(_c),b3="https://plan.gmvalve.in/backend/api";async function w3(t,r){const s=await fetch(`${b3}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:r})});if(!s.ok)throw new Error("Login failed");return s.json()}const qt="https://plan.gmvalve.in/backend/api";function N3(t){const r=t.toLowerCase();return r.startsWith("planning")?"planning":r.startsWith("materialissue")?"material-issue":r.startsWith("semiqc")?"semi-qc":r.startsWith("phospatingqc")?"phosphating-qc":r.startsWith("assembly")?"assembly":r.startsWith("testing")?"testing":r.startsWith("marking")?"marking":r.startsWith("svs")?"svs":r.startsWith("pdi")?"pdi":r.startsWith("tpi")?"tpi":r.startsWith("dispatch")?"dispatch":r.startsWith("admin")?"admin":"user"}function tv(t,r){if(typeof t=="function")return t(r);t!=null&&(t.current=r)}function Sa(...t){return r=>{let s=!1;const n=t.map(a=>{const l=tv(a,r);return!s&&typeof l=="function"&&(s=!0),l});if(s)return()=>{for(let a=0;a<n.length;a++){const l=n[a];typeof l=="function"?l():tv(t[a],null)}}}}function Ar(...t){return d.useCallback(Sa(...t),t)}var j3=Symbol.for("react.lazy"),Au=Tx[" use ".trim().toString()];function S3(t){return typeof t=="object"&&t!==null&&"then"in t}function N1(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===j3&&"_payload"in t&&S3(t._payload)}function qx(t){const r=k3(t),s=d.forwardRef((n,a)=>{let{children:l,...c}=n;N1(l)&&typeof Au=="function"&&(l=Au(l._payload));const u=d.Children.toArray(l),f=u.find(_3);if(f){const h=f.props.children,y=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(r,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,y):null})}return e.jsx(r,{...c,ref:a,children:l})});return s.displayName=`${t}.Slot`,s}var j1=qx("Slot");function k3(t){const r=d.forwardRef((s,n)=>{let{children:a,...l}=s;if(N1(a)&&typeof Au=="function"&&(a=Au(a._payload)),d.isValidElement(a)){const c=P3(a),u=E3(l,a.props);return a.type!==d.Fragment&&(u.ref=n?Sa(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var C3=Symbol("radix.slottable");function _3(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===C3}function E3(t,r){const s={...r};for(const n in r){const a=t[n],l=r[n];/^on[A-Z]/.test(n)?a&&l?s[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(s[n]=a):n==="style"?s[n]={...a,...l}:n==="className"&&(s[n]=[a,l].filter(Boolean).join(" "))}return{...t,...s}}function P3(t){let r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?t.ref:(r=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}function S1(t){var r,s,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(r=0;r<a;r++)t[r]&&(s=S1(t[r]))&&(n&&(n+=" "),n+=s)}else for(s in t)t[s]&&(n&&(n+=" "),n+=s);return n}function k1(){for(var t,r,s=0,n="",a=arguments.length;s<a;s++)(t=arguments[s])&&(r=S1(t))&&(n&&(n+=" "),n+=r);return n}const rv=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,sv=k1,C1=(t,r)=>s=>{var n;if(r?.variants==null)return sv(t,s?.class,s?.className);const{variants:a,defaultVariants:l}=r,c=Object.keys(a).map(h=>{const y=s?.[h],w=l?.[h];if(y===null)return null;const j=rv(y)||rv(w);return a[h][j]}),u=s&&Object.entries(s).reduce((h,y)=>{let[w,j]=y;return j===void 0||(h[w]=j),h},{}),f=r==null||(n=r.compoundVariants)===null||n===void 0?void 0:n.reduce((h,y)=>{let{class:w,className:j,...C}=y;return Object.entries(C).every(k=>{let[S,_]=k;return Array.isArray(_)?_.includes({...l,...u}[S]):{...l,...u}[S]===_})?[...h,w,j]:h},[]);return sv(t,c,f,s?.class,s?.className)},Bx="-",A3=t=>{const r=O3(t),{conflictingClassGroups:s,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:c=>{const u=c.split(Bx);return u[0]===""&&u.length!==1&&u.shift(),_1(u,r)||T3(c)},getConflictingClassGroupIds:(c,u)=>{const f=s[c]||[];return u&&n[c]?[...f,...n[c]]:f}}},_1=(t,r)=>{if(t.length===0)return r.classGroupId;const s=t[0],n=r.nextPart.get(s),a=n?_1(t.slice(1),n):void 0;if(a)return a;if(r.validators.length===0)return;const l=t.join(Bx);return r.validators.find(({validator:c})=>c(l))?.classGroupId},nv=/^\[(.+)\]$/,T3=t=>{if(nv.test(t)){const r=nv.exec(t)[1],s=r?.substring(0,r.indexOf(":"));if(s)return"arbitrary.."+s}},O3=t=>{const{theme:r,classGroups:s}=t,n={nextPart:new Map,validators:[]};for(const a in s)ix(s[a],n,a,r);return n},ix=(t,r,s,n)=>{t.forEach(a=>{if(typeof a=="string"){const l=a===""?r:av(r,a);l.classGroupId=s;return}if(typeof a=="function"){if(R3(a)){ix(a(n),r,s,n);return}r.validators.push({validator:a,classGroupId:s});return}Object.entries(a).forEach(([l,c])=>{ix(c,av(r,l),s,n)})})},av=(t,r)=>{let s=t;return r.split(Bx).forEach(n=>{s.nextPart.has(n)||s.nextPart.set(n,{nextPart:new Map,validators:[]}),s=s.nextPart.get(n)}),s},R3=t=>t.isThemeGetter,D3=t=>{if(t<1)return{get:()=>{},set:()=>{}};let r=0,s=new Map,n=new Map;const a=(l,c)=>{s.set(l,c),r++,r>t&&(r=0,n=s,s=new Map)};return{get(l){let c=s.get(l);if(c!==void 0)return c;if((c=n.get(l))!==void 0)return a(l,c),c},set(l,c){s.has(l)?s.set(l,c):a(l,c)}}},lx="!",ox=":",L3=ox.length,F3=t=>{const{prefix:r,experimentalParseClassName:s}=t;let n=a=>{const l=[];let c=0,u=0,f=0,h;for(let k=0;k<a.length;k++){let S=a[k];if(c===0&&u===0){if(S===ox){l.push(a.slice(f,k)),f=k+L3;continue}if(S==="/"){h=k;continue}}S==="["?c++:S==="]"?c--:S==="("?u++:S===")"&&u--}const y=l.length===0?a:a.substring(f),w=M3(y),j=w!==y,C=h&&h>f?h-f:void 0;return{modifiers:l,hasImportantModifier:j,baseClassName:w,maybePostfixModifierPosition:C}};if(r){const a=r+ox,l=n;n=c=>c.startsWith(a)?l(c.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:c,maybePostfixModifierPosition:void 0}}if(s){const a=n;n=l=>s({className:l,parseClassName:a})}return n},M3=t=>t.endsWith(lx)?t.substring(0,t.length-1):t.startsWith(lx)?t.substring(1):t,I3=t=>{const r=Object.fromEntries(t.orderSensitiveModifiers.map(n=>[n,!0]));return n=>{if(n.length<=1)return n;const a=[];let l=[];return n.forEach(c=>{c[0]==="["||r[c]?(a.push(...l.sort(),c),l=[]):l.push(c)}),a.push(...l.sort()),a}},q3=t=>({cache:D3(t.cacheSize),parseClassName:F3(t),sortModifiers:I3(t),...A3(t)}),B3=/\s+/,z3=(t,r)=>{const{parseClassName:s,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:l}=r,c=[],u=t.trim().split(B3);let f="";for(let h=u.length-1;h>=0;h-=1){const y=u[h],{isExternal:w,modifiers:j,hasImportantModifier:C,baseClassName:k,maybePostfixModifierPosition:S}=s(y);if(w){f=y+(f.length>0?" "+f:f);continue}let _=!!S,I=n(_?k.substring(0,S):k);if(!I){if(!_){f=y+(f.length>0?" "+f:f);continue}if(I=n(k),!I){f=y+(f.length>0?" "+f:f);continue}_=!1}const F=l(j).join(":"),B=C?F+lx:F,q=B+I;if(c.includes(q))continue;c.push(q);const me=a(I,_);for(let re=0;re<me.length;++re){const M=me[re];c.push(B+M)}f=y+(f.length>0?" "+f:f)}return f};function $3(){let t=0,r,s,n="";for(;t<arguments.length;)(r=arguments[t++])&&(s=E1(r))&&(n&&(n+=" "),n+=s);return n}const E1=t=>{if(typeof t=="string")return t;let r,s="";for(let n=0;n<t.length;n++)t[n]&&(r=E1(t[n]))&&(s&&(s+=" "),s+=r);return s};function Q3(t,...r){let s,n,a,l=c;function c(f){const h=r.reduce((y,w)=>w(y),t());return s=q3(h),n=s.cache.get,a=s.cache.set,l=u,u(f)}function u(f){const h=n(f);if(h)return h;const y=z3(f,s);return a(f,y),y}return function(){return l($3.apply(null,arguments))}}const ws=t=>{const r=s=>s[t]||[];return r.isThemeGetter=!0,r},P1=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,A1=/^\((?:(\w[\w-]*):)?(.+)\)$/i,U3=/^\d+\/\d+$/,V3=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,W3=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,G3=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,H3=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Y3=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ll=t=>U3.test(t),yr=t=>!!t&&!Number.isNaN(Number(t)),xi=t=>!!t&&Number.isInteger(Number(t)),S0=t=>t.endsWith("%")&&yr(t.slice(0,-1)),La=t=>V3.test(t),K3=()=>!0,X3=t=>W3.test(t)&&!G3.test(t),T1=()=>!1,J3=t=>H3.test(t),Z3=t=>Y3.test(t),eE=t=>!Xt(t)&&!Jt(t),tE=t=>ao(t,D1,T1),Xt=t=>P1.test(t),Qi=t=>ao(t,L1,X3),k0=t=>ao(t,iE,yr),iv=t=>ao(t,O1,T1),rE=t=>ao(t,R1,Z3),eu=t=>ao(t,F1,J3),Jt=t=>A1.test(t),Jo=t=>io(t,L1),sE=t=>io(t,lE),lv=t=>io(t,O1),nE=t=>io(t,D1),aE=t=>io(t,R1),tu=t=>io(t,F1,!0),ao=(t,r,s)=>{const n=P1.exec(t);return n?n[1]?r(n[1]):s(n[2]):!1},io=(t,r,s=!1)=>{const n=A1.exec(t);return n?n[1]?r(n[1]):s:!1},O1=t=>t==="position"||t==="percentage",R1=t=>t==="image"||t==="url",D1=t=>t==="length"||t==="size"||t==="bg-size",L1=t=>t==="length",iE=t=>t==="number",lE=t=>t==="family-name",F1=t=>t==="shadow",oE=()=>{const t=ws("color"),r=ws("font"),s=ws("text"),n=ws("font-weight"),a=ws("tracking"),l=ws("leading"),c=ws("breakpoint"),u=ws("container"),f=ws("spacing"),h=ws("radius"),y=ws("shadow"),w=ws("inset-shadow"),j=ws("text-shadow"),C=ws("drop-shadow"),k=ws("blur"),S=ws("perspective"),_=ws("aspect"),I=ws("ease"),F=ws("animate"),B=()=>["auto","avoid","all","avoid-page","page","left","right","column"],q=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],me=()=>[...q(),Jt,Xt],re=()=>["auto","hidden","clip","visible","scroll"],M=()=>["auto","contain","none"],G=()=>[Jt,Xt,f],le=()=>[Ll,"full","auto",...G()],Z=()=>[xi,"none","subgrid",Jt,Xt],he=()=>["auto",{span:["full",xi,Jt,Xt]},xi,Jt,Xt],ce=()=>[xi,"auto",Jt,Xt],ke=()=>["auto","min","max","fr",Jt,Xt],Ee=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Fe=()=>["start","end","center","stretch","center-safe","end-safe"],X=()=>["auto",...G()],ye=()=>[Ll,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...G()],Q=()=>[t,Jt,Xt],we=()=>[...q(),lv,iv,{position:[Jt,Xt]}],pe=()=>["no-repeat",{repeat:["","x","y","space","round"]}],se=()=>["auto","cover","contain",nE,tE,{size:[Jt,Xt]}],U=()=>[S0,Jo,Qi],ue=()=>["","none","full",h,Jt,Xt],z=()=>["",yr,Jo,Qi],ne=()=>["solid","dashed","dotted","double"],ve=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],fe=()=>[yr,S0,lv,iv],Ce=()=>["","none",k,Jt,Xt],Le=()=>["none",yr,Jt,Xt],De=()=>["none",yr,Jt,Xt],Ve=()=>[yr,Jt,Xt],tt=()=>[Ll,"full",...G()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[La],breakpoint:[La],color:[K3],container:[La],"drop-shadow":[La],ease:["in","out","in-out"],font:[eE],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[La],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[La],shadow:[La],spacing:["px",yr],text:[La],"text-shadow":[La],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ll,Xt,Jt,_]}],container:["container"],columns:[{columns:[yr,Xt,Jt,u]}],"break-after":[{"break-after":B()}],"break-before":[{"break-before":B()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:me()}],overflow:[{overflow:re()}],"overflow-x":[{"overflow-x":re()}],"overflow-y":[{"overflow-y":re()}],overscroll:[{overscroll:M()}],"overscroll-x":[{"overscroll-x":M()}],"overscroll-y":[{"overscroll-y":M()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:le()}],"inset-x":[{"inset-x":le()}],"inset-y":[{"inset-y":le()}],start:[{start:le()}],end:[{end:le()}],top:[{top:le()}],right:[{right:le()}],bottom:[{bottom:le()}],left:[{left:le()}],visibility:["visible","invisible","collapse"],z:[{z:[xi,"auto",Jt,Xt]}],basis:[{basis:[Ll,"full","auto",u,...G()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[yr,Ll,"auto","initial","none",Xt]}],grow:[{grow:["",yr,Jt,Xt]}],shrink:[{shrink:["",yr,Jt,Xt]}],order:[{order:[xi,"first","last","none",Jt,Xt]}],"grid-cols":[{"grid-cols":Z()}],"col-start-end":[{col:he()}],"col-start":[{"col-start":ce()}],"col-end":[{"col-end":ce()}],"grid-rows":[{"grid-rows":Z()}],"row-start-end":[{row:he()}],"row-start":[{"row-start":ce()}],"row-end":[{"row-end":ce()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":ke()}],"auto-rows":[{"auto-rows":ke()}],gap:[{gap:G()}],"gap-x":[{"gap-x":G()}],"gap-y":[{"gap-y":G()}],"justify-content":[{justify:[...Ee(),"normal"]}],"justify-items":[{"justify-items":[...Fe(),"normal"]}],"justify-self":[{"justify-self":["auto",...Fe()]}],"align-content":[{content:["normal",...Ee()]}],"align-items":[{items:[...Fe(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Fe(),{baseline:["","last"]}]}],"place-content":[{"place-content":Ee()}],"place-items":[{"place-items":[...Fe(),"baseline"]}],"place-self":[{"place-self":["auto",...Fe()]}],p:[{p:G()}],px:[{px:G()}],py:[{py:G()}],ps:[{ps:G()}],pe:[{pe:G()}],pt:[{pt:G()}],pr:[{pr:G()}],pb:[{pb:G()}],pl:[{pl:G()}],m:[{m:X()}],mx:[{mx:X()}],my:[{my:X()}],ms:[{ms:X()}],me:[{me:X()}],mt:[{mt:X()}],mr:[{mr:X()}],mb:[{mb:X()}],ml:[{ml:X()}],"space-x":[{"space-x":G()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":G()}],"space-y-reverse":["space-y-reverse"],size:[{size:ye()}],w:[{w:[u,"screen",...ye()]}],"min-w":[{"min-w":[u,"screen","none",...ye()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[c]},...ye()]}],h:[{h:["screen","lh",...ye()]}],"min-h":[{"min-h":["screen","lh","none",...ye()]}],"max-h":[{"max-h":["screen","lh",...ye()]}],"font-size":[{text:["base",s,Jo,Qi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,Jt,k0]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",S0,Xt]}],"font-family":[{font:[sE,Xt,r]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,Jt,Xt]}],"line-clamp":[{"line-clamp":[yr,"none",Jt,k0]}],leading:[{leading:[l,...G()]}],"list-image":[{"list-image":["none",Jt,Xt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Jt,Xt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:Q()}],"text-color":[{text:Q()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ne(),"wavy"]}],"text-decoration-thickness":[{decoration:[yr,"from-font","auto",Jt,Qi]}],"text-decoration-color":[{decoration:Q()}],"underline-offset":[{"underline-offset":[yr,"auto",Jt,Xt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:G()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Jt,Xt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Jt,Xt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:we()}],"bg-repeat":[{bg:pe()}],"bg-size":[{bg:se()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},xi,Jt,Xt],radial:["",Jt,Xt],conic:[xi,Jt,Xt]},aE,rE]}],"bg-color":[{bg:Q()}],"gradient-from-pos":[{from:U()}],"gradient-via-pos":[{via:U()}],"gradient-to-pos":[{to:U()}],"gradient-from":[{from:Q()}],"gradient-via":[{via:Q()}],"gradient-to":[{to:Q()}],rounded:[{rounded:ue()}],"rounded-s":[{"rounded-s":ue()}],"rounded-e":[{"rounded-e":ue()}],"rounded-t":[{"rounded-t":ue()}],"rounded-r":[{"rounded-r":ue()}],"rounded-b":[{"rounded-b":ue()}],"rounded-l":[{"rounded-l":ue()}],"rounded-ss":[{"rounded-ss":ue()}],"rounded-se":[{"rounded-se":ue()}],"rounded-ee":[{"rounded-ee":ue()}],"rounded-es":[{"rounded-es":ue()}],"rounded-tl":[{"rounded-tl":ue()}],"rounded-tr":[{"rounded-tr":ue()}],"rounded-br":[{"rounded-br":ue()}],"rounded-bl":[{"rounded-bl":ue()}],"border-w":[{border:z()}],"border-w-x":[{"border-x":z()}],"border-w-y":[{"border-y":z()}],"border-w-s":[{"border-s":z()}],"border-w-e":[{"border-e":z()}],"border-w-t":[{"border-t":z()}],"border-w-r":[{"border-r":z()}],"border-w-b":[{"border-b":z()}],"border-w-l":[{"border-l":z()}],"divide-x":[{"divide-x":z()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":z()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ne(),"hidden","none"]}],"divide-style":[{divide:[...ne(),"hidden","none"]}],"border-color":[{border:Q()}],"border-color-x":[{"border-x":Q()}],"border-color-y":[{"border-y":Q()}],"border-color-s":[{"border-s":Q()}],"border-color-e":[{"border-e":Q()}],"border-color-t":[{"border-t":Q()}],"border-color-r":[{"border-r":Q()}],"border-color-b":[{"border-b":Q()}],"border-color-l":[{"border-l":Q()}],"divide-color":[{divide:Q()}],"outline-style":[{outline:[...ne(),"none","hidden"]}],"outline-offset":[{"outline-offset":[yr,Jt,Xt]}],"outline-w":[{outline:["",yr,Jo,Qi]}],"outline-color":[{outline:Q()}],shadow:[{shadow:["","none",y,tu,eu]}],"shadow-color":[{shadow:Q()}],"inset-shadow":[{"inset-shadow":["none",w,tu,eu]}],"inset-shadow-color":[{"inset-shadow":Q()}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:Q()}],"ring-offset-w":[{"ring-offset":[yr,Qi]}],"ring-offset-color":[{"ring-offset":Q()}],"inset-ring-w":[{"inset-ring":z()}],"inset-ring-color":[{"inset-ring":Q()}],"text-shadow":[{"text-shadow":["none",j,tu,eu]}],"text-shadow-color":[{"text-shadow":Q()}],opacity:[{opacity:[yr,Jt,Xt]}],"mix-blend":[{"mix-blend":[...ve(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ve()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[yr]}],"mask-image-linear-from-pos":[{"mask-linear-from":fe()}],"mask-image-linear-to-pos":[{"mask-linear-to":fe()}],"mask-image-linear-from-color":[{"mask-linear-from":Q()}],"mask-image-linear-to-color":[{"mask-linear-to":Q()}],"mask-image-t-from-pos":[{"mask-t-from":fe()}],"mask-image-t-to-pos":[{"mask-t-to":fe()}],"mask-image-t-from-color":[{"mask-t-from":Q()}],"mask-image-t-to-color":[{"mask-t-to":Q()}],"mask-image-r-from-pos":[{"mask-r-from":fe()}],"mask-image-r-to-pos":[{"mask-r-to":fe()}],"mask-image-r-from-color":[{"mask-r-from":Q()}],"mask-image-r-to-color":[{"mask-r-to":Q()}],"mask-image-b-from-pos":[{"mask-b-from":fe()}],"mask-image-b-to-pos":[{"mask-b-to":fe()}],"mask-image-b-from-color":[{"mask-b-from":Q()}],"mask-image-b-to-color":[{"mask-b-to":Q()}],"mask-image-l-from-pos":[{"mask-l-from":fe()}],"mask-image-l-to-pos":[{"mask-l-to":fe()}],"mask-image-l-from-color":[{"mask-l-from":Q()}],"mask-image-l-to-color":[{"mask-l-to":Q()}],"mask-image-x-from-pos":[{"mask-x-from":fe()}],"mask-image-x-to-pos":[{"mask-x-to":fe()}],"mask-image-x-from-color":[{"mask-x-from":Q()}],"mask-image-x-to-color":[{"mask-x-to":Q()}],"mask-image-y-from-pos":[{"mask-y-from":fe()}],"mask-image-y-to-pos":[{"mask-y-to":fe()}],"mask-image-y-from-color":[{"mask-y-from":Q()}],"mask-image-y-to-color":[{"mask-y-to":Q()}],"mask-image-radial":[{"mask-radial":[Jt,Xt]}],"mask-image-radial-from-pos":[{"mask-radial-from":fe()}],"mask-image-radial-to-pos":[{"mask-radial-to":fe()}],"mask-image-radial-from-color":[{"mask-radial-from":Q()}],"mask-image-radial-to-color":[{"mask-radial-to":Q()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":q()}],"mask-image-conic-pos":[{"mask-conic":[yr]}],"mask-image-conic-from-pos":[{"mask-conic-from":fe()}],"mask-image-conic-to-pos":[{"mask-conic-to":fe()}],"mask-image-conic-from-color":[{"mask-conic-from":Q()}],"mask-image-conic-to-color":[{"mask-conic-to":Q()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:we()}],"mask-repeat":[{mask:pe()}],"mask-size":[{mask:se()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Jt,Xt]}],filter:[{filter:["","none",Jt,Xt]}],blur:[{blur:Ce()}],brightness:[{brightness:[yr,Jt,Xt]}],contrast:[{contrast:[yr,Jt,Xt]}],"drop-shadow":[{"drop-shadow":["","none",C,tu,eu]}],"drop-shadow-color":[{"drop-shadow":Q()}],grayscale:[{grayscale:["",yr,Jt,Xt]}],"hue-rotate":[{"hue-rotate":[yr,Jt,Xt]}],invert:[{invert:["",yr,Jt,Xt]}],saturate:[{saturate:[yr,Jt,Xt]}],sepia:[{sepia:["",yr,Jt,Xt]}],"backdrop-filter":[{"backdrop-filter":["","none",Jt,Xt]}],"backdrop-blur":[{"backdrop-blur":Ce()}],"backdrop-brightness":[{"backdrop-brightness":[yr,Jt,Xt]}],"backdrop-contrast":[{"backdrop-contrast":[yr,Jt,Xt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",yr,Jt,Xt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[yr,Jt,Xt]}],"backdrop-invert":[{"backdrop-invert":["",yr,Jt,Xt]}],"backdrop-opacity":[{"backdrop-opacity":[yr,Jt,Xt]}],"backdrop-saturate":[{"backdrop-saturate":[yr,Jt,Xt]}],"backdrop-sepia":[{"backdrop-sepia":["",yr,Jt,Xt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":G()}],"border-spacing-x":[{"border-spacing-x":G()}],"border-spacing-y":[{"border-spacing-y":G()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Jt,Xt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[yr,"initial",Jt,Xt]}],ease:[{ease:["linear","initial",I,Jt,Xt]}],delay:[{delay:[yr,Jt,Xt]}],animate:[{animate:["none",F,Jt,Xt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[S,Jt,Xt]}],"perspective-origin":[{"perspective-origin":me()}],rotate:[{rotate:Le()}],"rotate-x":[{"rotate-x":Le()}],"rotate-y":[{"rotate-y":Le()}],"rotate-z":[{"rotate-z":Le()}],scale:[{scale:De()}],"scale-x":[{"scale-x":De()}],"scale-y":[{"scale-y":De()}],"scale-z":[{"scale-z":De()}],"scale-3d":["scale-3d"],skew:[{skew:Ve()}],"skew-x":[{"skew-x":Ve()}],"skew-y":[{"skew-y":Ve()}],transform:[{transform:[Jt,Xt,"","none","gpu","cpu"]}],"transform-origin":[{origin:me()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:tt()}],"translate-x":[{"translate-x":tt()}],"translate-y":[{"translate-y":tt()}],"translate-z":[{"translate-z":tt()}],"translate-none":["translate-none"],accent:[{accent:Q()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:Q()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Jt,Xt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":G()}],"scroll-mx":[{"scroll-mx":G()}],"scroll-my":[{"scroll-my":G()}],"scroll-ms":[{"scroll-ms":G()}],"scroll-me":[{"scroll-me":G()}],"scroll-mt":[{"scroll-mt":G()}],"scroll-mr":[{"scroll-mr":G()}],"scroll-mb":[{"scroll-mb":G()}],"scroll-ml":[{"scroll-ml":G()}],"scroll-p":[{"scroll-p":G()}],"scroll-px":[{"scroll-px":G()}],"scroll-py":[{"scroll-py":G()}],"scroll-ps":[{"scroll-ps":G()}],"scroll-pe":[{"scroll-pe":G()}],"scroll-pt":[{"scroll-pt":G()}],"scroll-pr":[{"scroll-pr":G()}],"scroll-pb":[{"scroll-pb":G()}],"scroll-pl":[{"scroll-pl":G()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Jt,Xt]}],fill:[{fill:["none",...Q()]}],"stroke-w":[{stroke:[yr,Jo,Qi,k0]}],stroke:[{stroke:["none",...Q()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},cE=Q3(oE);function Nr(...t){return cE(k1(t))}const Tu=C1("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all duration-200 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive relative overflow-hidden active:scale-95",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm hover:shadow-md",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60 shadow-sm hover:shadow-md",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50 hover:border-accent-foreground/20",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm hover:shadow-md",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),ee=d.forwardRef(({className:t,variant:r,size:s,asChild:n=!1,...a},l)=>{const c=n?j1:"button";return e.jsx(c,{"data-slot":"button",className:Nr(Tu({variant:r,size:s,className:t})),ref:l,...a})});ee.displayName="Button";function Xr({className:t,type:r,...s}){return e.jsx("input",{type:r,"data-slot":"input",className:Nr("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-all duration-200 outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] focus-visible:shadow-sm","hover:border-ring/50","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...s})}function dE(t,r){const s=d.createContext(r),n=l=>{const{children:c,...u}=l,f=d.useMemo(()=>u,Object.values(u));return e.jsx(s.Provider,{value:f,children:c})};n.displayName=t+"Provider";function a(l){const c=d.useContext(s);if(c)return c;if(r!==void 0)return r;throw new Error(`\`${l}\` must be used within \`${t}\``)}return[n,a]}function Ga(t,r=[]){let s=[];function n(l,c){const u=d.createContext(c),f=s.length;s=[...s,c];const h=w=>{const{scope:j,children:C,...k}=w,S=j?.[t]?.[f]||u,_=d.useMemo(()=>k,Object.values(k));return e.jsx(S.Provider,{value:_,children:C})};h.displayName=l+"Provider";function y(w,j){const C=j?.[t]?.[f]||u,k=d.useContext(C);if(k)return k;if(c!==void 0)return c;throw new Error(`\`${w}\` must be used within \`${l}\``)}return[h,y]}const a=()=>{const l=s.map(c=>d.createContext(c));return function(u){const f=u?.[t]||l;return d.useMemo(()=>({[`__scope${t}`]:{...u,[t]:f}}),[u,f])}};return a.scopeName=t,[n,uE(a,...r)]}function uE(...t){const r=t[0];if(t.length===1)return r;const s=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const c=n.reduce((u,{useScope:f,scopeName:h})=>{const w=f(l)[`__scope${h}`];return{...u,...w}},{});return d.useMemo(()=>({[`__scope${r.scopeName}`]:c}),[c])}};return s.scopeName=r.scopeName,s}function Zt(t,r,{checkForDefaultPrevented:s=!0}={}){return function(a){if(t?.(a),s===!1||!a.defaultPrevented)return r?.(a)}}var js=globalThis?.document?d.useLayoutEffect:()=>{},mE=Tx[" useInsertionEffect ".trim().toString()]||js;function Ki({prop:t,defaultProp:r,onChange:s=()=>{},caller:n}){const[a,l,c]=pE({defaultProp:r,onChange:s}),u=t!==void 0,f=u?t:a;{const y=d.useRef(t!==void 0);d.useEffect(()=>{const w=y.current;w!==u&&console.warn(`${n} is changing from ${w?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),y.current=u},[u,n])}const h=d.useCallback(y=>{if(u){const w=xE(y)?y(t):y;w!==t&&c.current?.(w)}else l(y)},[u,t,l,c]);return[f,h]}function pE({defaultProp:t,onChange:r}){const[s,n]=d.useState(t),a=d.useRef(s),l=d.useRef(r);return mE(()=>{l.current=r},[r]),d.useEffect(()=>{a.current!==s&&(l.current?.(s),a.current=s)},[s,a]),[s,n,l]}function xE(t){return typeof t=="function"}function M1(t){const r=d.useRef({value:t,previous:t});return d.useMemo(()=>(r.current.value!==t&&(r.current.previous=r.current.value,r.current.value=t),r.current.previous),[t])}function I1(t){const[r,s]=d.useState(void 0);return js(()=>{if(t){s({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const l=a[0];let c,u;if("borderBoxSize"in l){const f=l.borderBoxSize,h=Array.isArray(f)?f[0]:f;c=h.inlineSize,u=h.blockSize}else c=t.offsetWidth,u=t.offsetHeight;s({width:c,height:u})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else s(void 0)},[t]),r}function hE(t,r){return d.useReducer((s,n)=>r[s][n]??s,t)}var na=t=>{const{present:r,children:s}=t,n=fE(r),a=typeof s=="function"?s({present:n.isPresent}):d.Children.only(s),l=Ar(n.ref,gE(a));return typeof s=="function"||n.isPresent?d.cloneElement(a,{ref:l}):null};na.displayName="Presence";function fE(t){const[r,s]=d.useState(),n=d.useRef(null),a=d.useRef(t),l=d.useRef("none"),c=t?"mounted":"unmounted",[u,f]=hE(c,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return d.useEffect(()=>{const h=ru(n.current);l.current=u==="mounted"?h:"none"},[u]),js(()=>{const h=n.current,y=a.current;if(y!==t){const j=l.current,C=ru(h);t?f("MOUNT"):C==="none"||h?.display==="none"?f("UNMOUNT"):f(y&&j!==C?"ANIMATION_OUT":"UNMOUNT"),a.current=t}},[t,f]),js(()=>{if(r){let h;const y=r.ownerDocument.defaultView??window,w=C=>{const S=ru(n.current).includes(CSS.escape(C.animationName));if(C.target===r&&S&&(f("ANIMATION_END"),!a.current)){const _=r.style.animationFillMode;r.style.animationFillMode="forwards",h=y.setTimeout(()=>{r.style.animationFillMode==="forwards"&&(r.style.animationFillMode=_)})}},j=C=>{C.target===r&&(l.current=ru(n.current))};return r.addEventListener("animationstart",j),r.addEventListener("animationcancel",w),r.addEventListener("animationend",w),()=>{y.clearTimeout(h),r.removeEventListener("animationstart",j),r.removeEventListener("animationcancel",w),r.removeEventListener("animationend",w)}}else f("ANIMATION_END")},[r,f]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:d.useCallback(h=>{n.current=h?getComputedStyle(h):null,s(h)},[])}}function ru(t){return t?.animationName||"none"}function gE(t){let r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?t.ref:(r=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}function yE(t){const r=vE(t),s=d.forwardRef((n,a)=>{const{children:l,...c}=n,u=d.Children.toArray(l),f=u.find(wE);if(f){const h=f.props.children,y=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(r,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,y):null})}return e.jsx(r,{...c,ref:a,children:l})});return s.displayName=`${t}.Slot`,s}function vE(t){const r=d.forwardRef((s,n)=>{const{children:a,...l}=s;if(d.isValidElement(a)){const c=jE(a),u=NE(l,a.props);return a.type!==d.Fragment&&(u.ref=n?Sa(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var bE=Symbol("radix.slottable");function wE(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===bE}function NE(t,r){const s={...r};for(const n in r){const a=t[n],l=r[n];/^on[A-Z]/.test(n)?a&&l?s[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(s[n]=a):n==="style"?s[n]={...a,...l}:n==="className"&&(s[n]=[a,l].filter(Boolean).join(" "))}return{...t,...s}}function jE(t){let r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?t.ref:(r=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var SE=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],vr=SE.reduce((t,r)=>{const s=yE(`Primitive.${r}`),n=d.forwardRef((a,l)=>{const{asChild:c,...u}=a,f=c?s:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(f,{...u,ref:l})});return n.displayName=`Primitive.${r}`,{...t,[r]:n}},{});function q1(t,r){t&&_c.flushSync(()=>t.dispatchEvent(r))}var lm="Checkbox",[kE]=Ga(lm),[CE,zx]=kE(lm);function _E(t){const{__scopeCheckbox:r,checked:s,children:n,defaultChecked:a,disabled:l,form:c,name:u,onCheckedChange:f,required:h,value:y="on",internal_do_not_use_render:w}=t,[j,C]=Ki({prop:s,defaultProp:a??!1,onChange:f,caller:lm}),[k,S]=d.useState(null),[_,I]=d.useState(null),F=d.useRef(!1),B=k?!!c||!!k.closest("form"):!0,q={checked:j,disabled:l,setChecked:C,control:k,setControl:S,name:u,form:c,value:y,hasConsumerStoppedPropagationRef:F,required:h,defaultChecked:wi(a)?!1:a,isFormControl:B,bubbleInput:_,setBubbleInput:I};return e.jsx(CE,{scope:r,...q,children:EE(w)?w(q):n})}var B1="CheckboxTrigger",z1=d.forwardRef(({__scopeCheckbox:t,onKeyDown:r,onClick:s,...n},a)=>{const{control:l,value:c,disabled:u,checked:f,required:h,setControl:y,setChecked:w,hasConsumerStoppedPropagationRef:j,isFormControl:C,bubbleInput:k}=zx(B1,t),S=Ar(a,y),_=d.useRef(f);return d.useEffect(()=>{const I=l?.form;if(I){const F=()=>w(_.current);return I.addEventListener("reset",F),()=>I.removeEventListener("reset",F)}},[l,w]),e.jsx(vr.button,{type:"button",role:"checkbox","aria-checked":wi(f)?"mixed":f,"aria-required":h,"data-state":G1(f),"data-disabled":u?"":void 0,disabled:u,value:c,...n,ref:S,onKeyDown:Zt(r,I=>{I.key==="Enter"&&I.preventDefault()}),onClick:Zt(s,I=>{w(F=>wi(F)?!0:!F),k&&C&&(j.current=I.isPropagationStopped(),j.current||I.stopPropagation())})})});z1.displayName=B1;var $1=d.forwardRef((t,r)=>{const{__scopeCheckbox:s,name:n,checked:a,defaultChecked:l,required:c,disabled:u,value:f,onCheckedChange:h,form:y,...w}=t;return e.jsx(_E,{__scopeCheckbox:s,checked:a,defaultChecked:l,disabled:u,required:c,onCheckedChange:h,name:n,form:y,value:f,internal_do_not_use_render:({isFormControl:j})=>e.jsxs(e.Fragment,{children:[e.jsx(z1,{...w,ref:r,__scopeCheckbox:s}),j&&e.jsx(W1,{__scopeCheckbox:s})]})})});$1.displayName=lm;var Q1="CheckboxIndicator",U1=d.forwardRef((t,r)=>{const{__scopeCheckbox:s,forceMount:n,...a}=t,l=zx(Q1,s);return e.jsx(na,{present:n||wi(l.checked)||l.checked===!0,children:e.jsx(vr.span,{"data-state":G1(l.checked),"data-disabled":l.disabled?"":void 0,...a,ref:r,style:{pointerEvents:"none",...t.style}})})});U1.displayName=Q1;var V1="CheckboxBubbleInput",W1=d.forwardRef(({__scopeCheckbox:t,...r},s)=>{const{control:n,hasConsumerStoppedPropagationRef:a,checked:l,defaultChecked:c,required:u,disabled:f,name:h,value:y,form:w,bubbleInput:j,setBubbleInput:C}=zx(V1,t),k=Ar(s,C),S=M1(l),_=I1(n);d.useEffect(()=>{const F=j;if(!F)return;const B=window.HTMLInputElement.prototype,me=Object.getOwnPropertyDescriptor(B,"checked").set,re=!a.current;if(S!==l&&me){const M=new Event("click",{bubbles:re});F.indeterminate=wi(l),me.call(F,wi(l)?!1:l),F.dispatchEvent(M)}},[j,S,l,a]);const I=d.useRef(wi(l)?!1:l);return e.jsx(vr.input,{type:"checkbox","aria-hidden":!0,defaultChecked:c??I.current,required:u,disabled:f,name:h,value:y,form:w,...r,tabIndex:-1,ref:k,style:{...r.style,..._,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});W1.displayName=V1;function EE(t){return typeof t=="function"}function wi(t){return t==="indeterminate"}function G1(t){return wi(t)?"indeterminate":t?"checked":"unchecked"}/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AE=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,s,n)=>n?n.toUpperCase():s.toLowerCase()),ov=t=>{const r=AE(t);return r.charAt(0).toUpperCase()+r.slice(1)},H1=(...t)=>t.filter((r,s,n)=>!!r&&r.trim()!==""&&n.indexOf(r)===s).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var TE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=d.forwardRef(({color:t="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:a="",children:l,iconNode:c,...u},f)=>d.createElement("svg",{ref:f,...TE,width:r,height:r,stroke:t,strokeWidth:n?Number(s)*24/Number(r):s,className:H1("lucide",a),...u},[...c.map(([h,y])=>d.createElement(h,y)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=(t,r)=>{const s=d.forwardRef(({className:n,...a},l)=>d.createElement(OE,{ref:l,iconNode:r,className:H1(`lucide-${PE(ov(t))}`,`lucide-${t}`,n),...a}));return s.displayName=ov(t),s};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],om=_r("arrow-left",RE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Is=_r("arrow-right",DE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],FE=_r("bell",LE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],IE=_r("calendar",ME);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Y1=_r("check",qE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],$x=_r("chevron-down",BE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zE=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],K1=_r("chevron-left",zE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],X1=_r("chevron-right",$E);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QE=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],J1=_r("chevron-up",QE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],cv=_r("circle-alert",UE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],WE=_r("circle-check-big",VE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Z1=_r("circle-check",GE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],ew=_r("circle-x",HE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],vu=_r("clock",YE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KE=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],hr=_r("download",KE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XE=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],JE=_r("eye-off",XE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Hr=_r("eye",ZE);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e4=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],dv=_r("file-spreadsheet",e4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t4=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],r4=_r("file-text",t4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s4=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],uv=_r("history",s4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n4=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],a4=_r("log-out",n4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i4=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],is=_r("message-square-plus",i4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l4=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Wi=_r("package",l4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],mv=_r("plus",o4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],xr=_r("printer",c4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],tw=_r("refresh-cw",d4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],rw=_r("search",u4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4=[["path",{d:"M7 18v-6a5 5 0 1 1 10 0v6",key:"pcx96s"}],["path",{d:"M5 21a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-1a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2z",key:"1b4s83"}],["path",{d:"M21 12h1",key:"jtio3y"}],["path",{d:"M18.5 4.5 18 5",key:"g5sp9y"}],["path",{d:"M2 12h1",key:"1uaihz"}],["path",{d:"M12 2v1",key:"11qlp1"}],["path",{d:"m4.929 4.929.707.707",key:"1i51kw"}],["path",{d:"M12 12v6",key:"3ahymv"}]],gr=_r("siren",m4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],x4=_r("sliders-horizontal",p4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],f4=_r("triangle-alert",h4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g4=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],y4=_r("upload",g4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v4=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Qx=_r("x",v4);function Ur({className:t,...r}){return e.jsx($1,{"data-slot":"checkbox",className:Nr("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:e.jsx(U1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(Y1,{className:"size-3.5"})})})}const sw="/assets/gm-logo-CDaWe3Uk.png",b4=({onLogin:t})=>{const[r,s]=d.useState(!1),[n,a]=d.useState(!1),[l,c]=d.useState(""),[u,f]=d.useState(""),[h,y]=d.useState(""),[w,j]=d.useState(!1),[C,k]=d.useState(""),S=En(),_=async F=>{F.preventDefault(),j(!0),k("");try{const B=await w3(u,h);if(B?.status===!0&&B?.data){const{user:q,token:me}=B.data;localStorage.setItem("user",JSON.stringify(q)),localStorage.setItem("token",me);const re=q&&(q.role?.name||q.role)||"",M=I(String(re),l);t&&t(),S(`/${M}`)}else k("Invalid username or password")}catch{k("Invalid username or password")}finally{j(!1)}};function I(F,B){const q=(F||"").toLowerCase().replace(/\s+/g,"-"),me=N3(B),re=[q,me];for(const M of re)if(M){if(M==="admin")return"admin";if(M==="planning"||M.startsWith("planning"))return"planning";if(M==="material-issue"||M.startsWith("materialissue"))return"material-issue";if(M==="semi-qc"||M.startsWith("semiqc"))return"semi-qc";if(M==="phosphating"||M==="phosphating-qc"||M.startsWith("phosp"))return"phosphating";if(M==="assembly-a"||M.startsWith("assembly-a"))return"assembly-a";if(M==="assembly-b"||M.startsWith("assembly-b"))return"assembly-b";if(M==="assembly-c"||M.startsWith("assembly-c"))return"assembly-c";if(M==="assembly-d"||M.startsWith("assembly-d"))return"assembly-d";if(M==="assembly")return"assembly-a";if(M==="svs"||M.startsWith("svs"))return"svs";if(M==="tpi"||M.startsWith("tpi"))return"tpi";if(M==="dispatch"||M.startsWith("dispatch"))return"dispatch";if(M==="testing"||M==="testing1"||M.startsWith("testing1"))return"testing1";if(M==="testing2"||M.startsWith("testing2"))return"testing2";if(M==="marking"||M==="marking1"||M.startsWith("marking1"))return"marking1";if(M==="marking2"||M.startsWith("marking2"))return"marking2";if(M==="pdi"||M==="pdi1"||M.startsWith("pdi1"))return"pdi1";if(M==="pdi2"||M.startsWith("pdi2"))return"pdi2";if(M==="customer-support"||M.startsWith("customersupport"))return"customer-support"}return"planning"}return e.jsxs("form",{onSubmit:_,className:"space-y-6 animate-fade-in",children:[e.jsx("div",{className:"mb-2 animate-fade-in",children:e.jsx("img",{src:sw,alt:"GM Logo",className:"h-16 w-auto object-contain hover:scale-110 transition-transform duration-300"})}),e.jsxs("div",{className:"space-y-2 animate-fade-in-up",style:{animationDelay:"0.1s"},children:[e.jsx("h1",{className:"text-gray-900 font-semibold text-xl",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-600",children:"Log in to continue to your workspace."})]}),C&&e.jsx("p",{className:"text-red-500 bg-red-50 border border-red-200 rounded-lg py-2 text-center animate-fade-in-up",children:C}),e.jsxs("div",{className:"space-y-2 animate-fade-in-up",style:{animationDelay:"0.1s"},children:[e.jsx("label",{htmlFor:"email",className:"text-gray-700 text-sm font-medium",children:"Username or Email"}),e.jsx(Xr,{type:"text",placeholder:"Enter username or email",value:u,onChange:F=>f(F.target.value),required:!0,className:"rounded-3xl h-12 px-4 bg-white/80 border-2 border-gray-200 hover:border-[#174a9f]/50 focus:border-[#174a9f] focus:ring-2 focus:ring-[#174a9f]/20 transition-all duration-300 shadow-sm hover:shadow-md"})]}),e.jsxs("div",{className:"space-y-2 animate-fade-in-up",style:{animationDelay:"0.2s"},children:[e.jsx("label",{htmlFor:"password",className:"text-gray-700 text-sm font-medium",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Xr,{id:"password",type:r?"text":"password",placeholder:"Enter your password",value:h,onChange:F=>y(F.target.value),required:!0,className:"rounded-3xl h-12 px-4 pr-12 bg-white/80 border-2 border-gray-200 hover:border-[#174a9f]/50 focus:border-[#174a9f] focus:ring-2 focus:ring-[#174a9f]/20 transition-all duration-300 shadow-sm hover:shadow-md"}),e.jsx("button",{type:"button",onClick:()=>s(!r),className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-[#174a9f] transition-all duration-300 hover:scale-110",children:r?e.jsx(JE,{size:20}):e.jsx(Hr,{size:20})})]})]}),e.jsx("div",{className:"flex items-center justify-between animate-fade-in-up",style:{animationDelay:"0.25s"},children:e.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer group",children:[e.jsx(Ur,{checked:n,onCheckedChange:a,className:"rounded border-2 hover:border-[#174a9f] transition-all duration-300"}),e.jsx("span",{className:"text-gray-600 group-hover:text-[#174a9f] transition-colors duration-300",children:"Remember me"})]})}),e.jsxs(ee,{type:"submit",className:"w-full h-12 rounded-3xl bg-gradient-to-r from-[#2461c7] to-[#174a9f] hover:from-[#174a9f] hover:to-[#123a7f] text-white border-0 shadow-lg hover:shadow-2xl transition-all duration-300 relative overflow-hidden group hover:-translate-y-1 active:translate-y-0 animate-fade-in-up",style:{animationDelay:"0.3s"},children:[e.jsx("span",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"}),e.jsxs("span",{className:"relative z-10 flex items-center justify-center gap-2",children:[w?"Logging in...":"Sign In",e.jsx("span",{className:"text-lg group-hover:translate-x-1 transition-transform duration-300",children:""})]})]})]})},w4="/assets/8d0931fbd565c8647b87305fabaa79cd19ae515f-nOF_erTR.png";function N4(){return e.jsxs("div",{className:"relative h-full w-full overflow-hidden bg-gradient-to-br from-[#0d2a5f] via-[#174a9f] to-[#2461c7]",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat transform hover:scale-105 transition-transform duration-700",style:{backgroundImage:`url('${w4}')`}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#174a9f]/30 via-[#0d2a5f]/40 to-[#174a9f]/50"}),e.jsx("div",{className:"absolute top-20 right-20 w-64 h-64 bg-white/5 rounded-full blur-3xl animate-pulse-soft"}),e.jsx("div",{className:"absolute bottom-40 left-20 w-96 h-96 bg-indigo-400/10 rounded-full blur-3xl animate-float"}),e.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:`linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px),
                         linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)`,backgroundSize:"50px 50px"}}),e.jsxs("div",{className:"absolute bottom-12 left-12 text-white space-y-6 max-w-lg",children:[e.jsxs("div",{className:"space-y-3 animate-fade-in-up",children:[e.jsx("div",{className:"inline-block px-4 py-2 bg-white/10 backdrop-blur-md rounded-full border border-white/20 text-sm",children:" Manufacturing Excellence"}),e.jsx("h2",{className:"text-5xl mb-3 leading-tight bg-gradient-to-r from-white to-blue-100 bg-clip-text text-transparent",children:"Industrial Excellence"}),e.jsx("p",{className:"text-white/90 text-xl",children:"Precision Engineering Solutions"})]}),e.jsxs("div",{className:"flex gap-3 animate-fade-in-up",style:{animationDelay:"0.2s"},children:[e.jsx("div",{className:"px-4 py-2 bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 text-sm hover:bg-white/20 transition-all duration-300 hover:-translate-y-1",children:" Real-time Tracking"}),e.jsx("div",{className:"px-4 py-2 bg-white/10 backdrop-blur-sm rounded-lg border border-white/20 text-sm hover:bg-white/20 transition-all duration-300 hover:-translate-y-1",children:" Quality Control"})]})]}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-white/10 to-transparent"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-gradient-to-tr from-white/10 to-transparent"})]})}function j4({onLogin:t}){return e.jsxs("div",{className:"min-h-screen flex",children:[e.jsx("div",{className:"flex-1 relative hidden lg:block",children:e.jsx(N4,{})}),e.jsxs("div",{className:"flex-1 flex items-center justify-center px-8 py-12 background-accent-blue relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 background-accent-blue"}),e.jsx("div",{className:"background-glow-top animate-pulse-soft"}),e.jsx("div",{className:"background-glow-bottom animate-pulse-soft",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/4 left-1/4 w-32 h-32 bg-[#174a9f]/10 rounded-full blur-3xl animate-float"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-40 h-40 bg-indigo-400/10 rounded-full blur-3xl animate-float",style:{animationDelay:"1.5s"}}),e.jsx("div",{className:"relative w-full max-w-md form-card animate-scale-in hover:shadow-2xl transition-shadow duration-500",children:e.jsx(b4,{onLogin:t})})]})]})}const nw=d.createContext(void 0);function S4({children:t}){const[r,s]=d.useState({}),[n,a]=d.useState({}),l=(h,y)=>{s(w=>({...w,[h]:y}))},c=h=>{a(y=>({...y,[h]:!y[h]}))},u=h=>r[h]||"",f=h=>n[h]||!1;return e.jsx(nw.Provider,{value:{remarks:r,alertStatuses:n,updateRemark:l,toggleAlertStatus:c,getRemark:u,getAlertStatus:f},children:t})}function gs(){const t=d.useContext(nw);if(t===void 0)throw new Error("useOrderContext must be used within an OrderProvider");return t}const xs=({allowedRole:t,children:r})=>{const s=localStorage.getItem("user");if(!s)return e.jsx(Pu,{to:"/login",replace:!0});const n=JSON.parse(s),a=typeof n.role=="object"?n.role.name:n.role,l=y=>(y||"").toLowerCase().replace(/\s+/g,"-"),u=(y=>{switch(y){case"phosphating-qc":return"phosphating";case"assemblya":return"assembly-a";case"assemblyb":return"assembly-b";case"assemblyc":return"assembly-c";case"assemblyd":return"assembly-d";default:return y}})(l(a)),f=l(t);return u==="admin"||u==="planning"?e.jsx(e.Fragment,{children:r}):u===f?e.jsx(e.Fragment,{children:r}):((y,w)=>!!(y==="testing"&&(w==="testing1"||w==="testing2")||y==="marking"&&(w==="marking1"||w==="marking2")||y==="pdi"&&(w==="pdi1"||w==="pdi2")||y==="testing1"&&w==="assembly-a"||y==="assembly-a"&&w==="testing1"||y.startsWith("assembly-")&&w==="assembly-shared"))(u,f)?e.jsx(e.Fragment,{children:r}):u!==f?e.jsx(Pu,{to:"/login",replace:!0}):e.jsx(e.Fragment,{children:r})},k4=({children:t})=>localStorage.getItem("user")?e.jsx(e.Fragment,{children:t}):e.jsx(Pu,{to:"/login",replace:!0});function aw(t,r){return function(){return t.apply(r,arguments)}}const{toString:C4}=Object.prototype,{getPrototypeOf:Ux}=Object,{iterator:cm,toStringTag:iw}=Symbol,dm=(t=>r=>{const s=C4.call(r);return t[s]||(t[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),aa=t=>(t=t.toLowerCase(),r=>dm(r)===t),um=t=>r=>typeof r===t,{isArray:lo}=Array,Xl=um("undefined");function Ec(t){return t!==null&&!Xl(t)&&t.constructor!==null&&!Xl(t.constructor)&&cn(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const lw=aa("ArrayBuffer");function _4(t){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(t):r=t&&t.buffer&&lw(t.buffer),r}const E4=um("string"),cn=um("function"),ow=um("number"),Pc=t=>t!==null&&typeof t=="object",P4=t=>t===!0||t===!1,bu=t=>{if(dm(t)!=="object")return!1;const r=Ux(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(iw in t)&&!(cm in t)},A4=t=>{if(!Pc(t)||Ec(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},T4=aa("Date"),O4=aa("File"),R4=aa("Blob"),D4=aa("FileList"),L4=t=>Pc(t)&&cn(t.pipe),F4=t=>{let r;return t&&(typeof FormData=="function"&&t instanceof FormData||cn(t.append)&&((r=dm(t))==="formdata"||r==="object"&&cn(t.toString)&&t.toString()==="[object FormData]"))},M4=aa("URLSearchParams"),[I4,q4,B4,z4]=["ReadableStream","Request","Response","Headers"].map(aa),$4=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ac(t,r,{allOwnKeys:s=!1}={}){if(t===null||typeof t>"u")return;let n,a;if(typeof t!="object"&&(t=[t]),lo(t))for(n=0,a=t.length;n<a;n++)r.call(null,t[n],n,t);else{if(Ec(t))return;const l=s?Object.getOwnPropertyNames(t):Object.keys(t),c=l.length;let u;for(n=0;n<c;n++)u=l[n],r.call(null,t[u],u,t)}}function cw(t,r){if(Ec(t))return null;r=r.toLowerCase();const s=Object.keys(t);let n=s.length,a;for(;n-- >0;)if(a=s[n],r===a.toLowerCase())return a;return null}const Gi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,dw=t=>!Xl(t)&&t!==Gi;function cx(){const{caseless:t,skipUndefined:r}=dw(this)&&this||{},s={},n=(a,l)=>{const c=t&&cw(s,l)||l;bu(s[c])&&bu(a)?s[c]=cx(s[c],a):bu(a)?s[c]=cx({},a):lo(a)?s[c]=a.slice():(!r||!Xl(a))&&(s[c]=a)};for(let a=0,l=arguments.length;a<l;a++)arguments[a]&&Ac(arguments[a],n);return s}const Q4=(t,r,s,{allOwnKeys:n}={})=>(Ac(r,(a,l)=>{s&&cn(a)?t[l]=aw(a,s):t[l]=a},{allOwnKeys:n}),t),U4=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),V4=(t,r,s,n)=>{t.prototype=Object.create(r.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:r.prototype}),s&&Object.assign(t.prototype,s)},W4=(t,r,s,n)=>{let a,l,c;const u={};if(r=r||{},t==null)return r;do{for(a=Object.getOwnPropertyNames(t),l=a.length;l-- >0;)c=a[l],(!n||n(c,t,r))&&!u[c]&&(r[c]=t[c],u[c]=!0);t=s!==!1&&Ux(t)}while(t&&(!s||s(t,r))&&t!==Object.prototype);return r},G4=(t,r,s)=>{t=String(t),(s===void 0||s>t.length)&&(s=t.length),s-=r.length;const n=t.indexOf(r,s);return n!==-1&&n===s},H4=t=>{if(!t)return null;if(lo(t))return t;let r=t.length;if(!ow(r))return null;const s=new Array(r);for(;r-- >0;)s[r]=t[r];return s},Y4=(t=>r=>t&&r instanceof t)(typeof Uint8Array<"u"&&Ux(Uint8Array)),K4=(t,r)=>{const n=(t&&t[cm]).call(t);let a;for(;(a=n.next())&&!a.done;){const l=a.value;r.call(t,l[0],l[1])}},X4=(t,r)=>{let s;const n=[];for(;(s=t.exec(r))!==null;)n.push(s);return n},J4=aa("HTMLFormElement"),Z4=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,n,a){return n.toUpperCase()+a}),pv=(({hasOwnProperty:t})=>(r,s)=>t.call(r,s))(Object.prototype),eP=aa("RegExp"),uw=(t,r)=>{const s=Object.getOwnPropertyDescriptors(t),n={};Ac(s,(a,l)=>{let c;(c=r(a,l,t))!==!1&&(n[l]=c||a)}),Object.defineProperties(t,n)},tP=t=>{uw(t,(r,s)=>{if(cn(t)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const n=t[s];if(cn(n)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},rP=(t,r)=>{const s={},n=a=>{a.forEach(l=>{s[l]=!0})};return lo(t)?n(t):n(String(t).split(r)),s},sP=()=>{},nP=(t,r)=>t!=null&&Number.isFinite(t=+t)?t:r;function aP(t){return!!(t&&cn(t.append)&&t[iw]==="FormData"&&t[cm])}const iP=t=>{const r=new Array(10),s=(n,a)=>{if(Pc(n)){if(r.indexOf(n)>=0)return;if(Ec(n))return n;if(!("toJSON"in n)){r[a]=n;const l=lo(n)?[]:{};return Ac(n,(c,u)=>{const f=s(c,a+1);!Xl(f)&&(l[u]=f)}),r[a]=void 0,l}}return n};return s(t,0)},lP=aa("AsyncFunction"),oP=t=>t&&(Pc(t)||cn(t))&&cn(t.then)&&cn(t.catch),mw=((t,r)=>t?setImmediate:r?((s,n)=>(Gi.addEventListener("message",({source:a,data:l})=>{a===Gi&&l===s&&n.length&&n.shift()()},!1),a=>{n.push(a),Gi.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",cn(Gi.postMessage)),cP=typeof queueMicrotask<"u"?queueMicrotask.bind(Gi):typeof process<"u"&&process.nextTick||mw,dP=t=>t!=null&&cn(t[cm]),Xe={isArray:lo,isArrayBuffer:lw,isBuffer:Ec,isFormData:F4,isArrayBufferView:_4,isString:E4,isNumber:ow,isBoolean:P4,isObject:Pc,isPlainObject:bu,isEmptyObject:A4,isReadableStream:I4,isRequest:q4,isResponse:B4,isHeaders:z4,isUndefined:Xl,isDate:T4,isFile:O4,isBlob:R4,isRegExp:eP,isFunction:cn,isStream:L4,isURLSearchParams:M4,isTypedArray:Y4,isFileList:D4,forEach:Ac,merge:cx,extend:Q4,trim:$4,stripBOM:U4,inherits:V4,toFlatObject:W4,kindOf:dm,kindOfTest:aa,endsWith:G4,toArray:H4,forEachEntry:K4,matchAll:X4,isHTMLForm:J4,hasOwnProperty:pv,hasOwnProp:pv,reduceDescriptors:uw,freezeMethods:tP,toObjectSet:rP,toCamelCase:Z4,noop:sP,toFiniteNumber:nP,findKey:cw,global:Gi,isContextDefined:dw,isSpecCompliantForm:aP,toJSONObject:iP,isAsyncFn:lP,isThenable:oP,setImmediate:mw,asap:cP,isIterable:dP};function pr(t,r,s,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",r&&(this.code=r),s&&(this.config=s),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}Xe.inherits(pr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Xe.toJSONObject(this.config),code:this.code,status:this.status}}});const pw=pr.prototype,xw={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{xw[t]={value:t}});Object.defineProperties(pr,xw);Object.defineProperty(pw,"isAxiosError",{value:!0});pr.from=(t,r,s,n,a,l)=>{const c=Object.create(pw);Xe.toFlatObject(t,c,function(y){return y!==Error.prototype},h=>h!=="isAxiosError");const u=t&&t.message?t.message:"Error",f=r==null&&t?t.code:r;return pr.call(c,u,f,s,n,a),t&&c.cause==null&&Object.defineProperty(c,"cause",{value:t,configurable:!0}),c.name=t&&t.name||"Error",l&&Object.assign(c,l),c};const uP=null;function dx(t){return Xe.isPlainObject(t)||Xe.isArray(t)}function hw(t){return Xe.endsWith(t,"[]")?t.slice(0,-2):t}function xv(t,r,s){return t?t.concat(r).map(function(a,l){return a=hw(a),!s&&l?"["+a+"]":a}).join(s?".":""):r}function mP(t){return Xe.isArray(t)&&!t.some(dx)}const pP=Xe.toFlatObject(Xe,{},null,function(r){return/^is[A-Z]/.test(r)});function mm(t,r,s){if(!Xe.isObject(t))throw new TypeError("target must be an object");r=r||new FormData,s=Xe.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,_){return!Xe.isUndefined(_[S])});const n=s.metaTokens,a=s.visitor||y,l=s.dots,c=s.indexes,f=(s.Blob||typeof Blob<"u"&&Blob)&&Xe.isSpecCompliantForm(r);if(!Xe.isFunction(a))throw new TypeError("visitor must be a function");function h(k){if(k===null)return"";if(Xe.isDate(k))return k.toISOString();if(Xe.isBoolean(k))return k.toString();if(!f&&Xe.isBlob(k))throw new pr("Blob is not supported. Use a Buffer instead.");return Xe.isArrayBuffer(k)||Xe.isTypedArray(k)?f&&typeof Blob=="function"?new Blob([k]):Buffer.from(k):k}function y(k,S,_){let I=k;if(k&&!_&&typeof k=="object"){if(Xe.endsWith(S,"{}"))S=n?S:S.slice(0,-2),k=JSON.stringify(k);else if(Xe.isArray(k)&&mP(k)||(Xe.isFileList(k)||Xe.endsWith(S,"[]"))&&(I=Xe.toArray(k)))return S=hw(S),I.forEach(function(B,q){!(Xe.isUndefined(B)||B===null)&&r.append(c===!0?xv([S],q,l):c===null?S:S+"[]",h(B))}),!1}return dx(k)?!0:(r.append(xv(_,S,l),h(k)),!1)}const w=[],j=Object.assign(pP,{defaultVisitor:y,convertValue:h,isVisitable:dx});function C(k,S){if(!Xe.isUndefined(k)){if(w.indexOf(k)!==-1)throw Error("Circular reference detected in "+S.join("."));w.push(k),Xe.forEach(k,function(I,F){(!(Xe.isUndefined(I)||I===null)&&a.call(r,I,Xe.isString(F)?F.trim():F,S,j))===!0&&C(I,S?S.concat(F):[F])}),w.pop()}}if(!Xe.isObject(t))throw new TypeError("data must be an object");return C(t),r}function hv(t){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return r[n]})}function Vx(t,r){this._pairs=[],t&&mm(t,this,r)}const fw=Vx.prototype;fw.append=function(r,s){this._pairs.push([r,s])};fw.toString=function(r){const s=r?function(n){return r.call(this,n,hv)}:hv;return this._pairs.map(function(a){return s(a[0])+"="+s(a[1])},"").join("&")};function xP(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function gw(t,r,s){if(!r)return t;const n=s&&s.encode||xP;Xe.isFunction(s)&&(s={serialize:s});const a=s&&s.serialize;let l;if(a?l=a(r,s):l=Xe.isURLSearchParams(r)?r.toString():new Vx(r,s).toString(n),l){const c=t.indexOf("#");c!==-1&&(t=t.slice(0,c)),t+=(t.indexOf("?")===-1?"?":"&")+l}return t}class fv{constructor(){this.handlers=[]}use(r,s,n){return this.handlers.push({fulfilled:r,rejected:s,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){Xe.forEach(this.handlers,function(n){n!==null&&r(n)})}}const yw={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},hP=typeof URLSearchParams<"u"?URLSearchParams:Vx,fP=typeof FormData<"u"?FormData:null,gP=typeof Blob<"u"?Blob:null,yP={isBrowser:!0,classes:{URLSearchParams:hP,FormData:fP,Blob:gP},protocols:["http","https","file","blob","url","data"]},Wx=typeof window<"u"&&typeof document<"u",ux=typeof navigator=="object"&&navigator||void 0,vP=Wx&&(!ux||["ReactNative","NativeScript","NS"].indexOf(ux.product)<0),bP=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",wP=Wx&&window.location.href||"http://localhost",NP=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Wx,hasStandardBrowserEnv:vP,hasStandardBrowserWebWorkerEnv:bP,navigator:ux,origin:wP},Symbol.toStringTag,{value:"Module"})),Qs={...NP,...yP};function jP(t,r){return mm(t,new Qs.classes.URLSearchParams,{visitor:function(s,n,a,l){return Qs.isNode&&Xe.isBuffer(s)?(this.append(n,s.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...r})}function SP(t){return Xe.matchAll(/\w+|\[(\w*)]/g,t).map(r=>r[0]==="[]"?"":r[1]||r[0])}function kP(t){const r={},s=Object.keys(t);let n;const a=s.length;let l;for(n=0;n<a;n++)l=s[n],r[l]=t[l];return r}function vw(t){function r(s,n,a,l){let c=s[l++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),f=l>=s.length;return c=!c&&Xe.isArray(a)?a.length:c,f?(Xe.hasOwnProp(a,c)?a[c]=[a[c],n]:a[c]=n,!u):((!a[c]||!Xe.isObject(a[c]))&&(a[c]=[]),r(s,n,a[c],l)&&Xe.isArray(a[c])&&(a[c]=kP(a[c])),!u)}if(Xe.isFormData(t)&&Xe.isFunction(t.entries)){const s={};return Xe.forEachEntry(t,(n,a)=>{r(SP(n),a,s,0)}),s}return null}function CP(t,r,s){if(Xe.isString(t))try{return(r||JSON.parse)(t),Xe.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(s||JSON.stringify)(t)}const Tc={transitional:yw,adapter:["xhr","http","fetch"],transformRequest:[function(r,s){const n=s.getContentType()||"",a=n.indexOf("application/json")>-1,l=Xe.isObject(r);if(l&&Xe.isHTMLForm(r)&&(r=new FormData(r)),Xe.isFormData(r))return a?JSON.stringify(vw(r)):r;if(Xe.isArrayBuffer(r)||Xe.isBuffer(r)||Xe.isStream(r)||Xe.isFile(r)||Xe.isBlob(r)||Xe.isReadableStream(r))return r;if(Xe.isArrayBufferView(r))return r.buffer;if(Xe.isURLSearchParams(r))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let u;if(l){if(n.indexOf("application/x-www-form-urlencoded")>-1)return jP(r,this.formSerializer).toString();if((u=Xe.isFileList(r))||n.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return mm(u?{"files[]":r}:r,f&&new f,this.formSerializer)}}return l||a?(s.setContentType("application/json",!1),CP(r)):r}],transformResponse:[function(r){const s=this.transitional||Tc.transitional,n=s&&s.forcedJSONParsing,a=this.responseType==="json";if(Xe.isResponse(r)||Xe.isReadableStream(r))return r;if(r&&Xe.isString(r)&&(n&&!this.responseType||a)){const c=!(s&&s.silentJSONParsing)&&a;try{return JSON.parse(r,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?pr.from(u,pr.ERR_BAD_RESPONSE,this,null,this.response):u}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Qs.classes.FormData,Blob:Qs.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Xe.forEach(["delete","get","head","post","put","patch"],t=>{Tc.headers[t]={}});const _P=Xe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),EP=t=>{const r={};let s,n,a;return t&&t.split(`
`).forEach(function(c){a=c.indexOf(":"),s=c.substring(0,a).trim().toLowerCase(),n=c.substring(a+1).trim(),!(!s||r[s]&&_P[s])&&(s==="set-cookie"?r[s]?r[s].push(n):r[s]=[n]:r[s]=r[s]?r[s]+", "+n:n)}),r},gv=Symbol("internals");function Zo(t){return t&&String(t).trim().toLowerCase()}function wu(t){return t===!1||t==null?t:Xe.isArray(t)?t.map(wu):String(t)}function PP(t){const r=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=s.exec(t);)r[n[1]]=n[2];return r}const AP=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function C0(t,r,s,n,a){if(Xe.isFunction(n))return n.call(this,r,s);if(a&&(r=s),!!Xe.isString(r)){if(Xe.isString(n))return r.indexOf(n)!==-1;if(Xe.isRegExp(n))return n.test(r)}}function TP(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,s,n)=>s.toUpperCase()+n)}function OP(t,r){const s=Xe.toCamelCase(" "+r);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+s,{value:function(a,l,c){return this[n].call(this,r,a,l,c)},configurable:!0})})}let dn=class{constructor(r){r&&this.set(r)}set(r,s,n){const a=this;function l(u,f,h){const y=Zo(f);if(!y)throw new Error("header name must be a non-empty string");const w=Xe.findKey(a,y);(!w||a[w]===void 0||h===!0||h===void 0&&a[w]!==!1)&&(a[w||f]=wu(u))}const c=(u,f)=>Xe.forEach(u,(h,y)=>l(h,y,f));if(Xe.isPlainObject(r)||r instanceof this.constructor)c(r,s);else if(Xe.isString(r)&&(r=r.trim())&&!AP(r))c(EP(r),s);else if(Xe.isObject(r)&&Xe.isIterable(r)){let u={},f,h;for(const y of r){if(!Xe.isArray(y))throw TypeError("Object iterator must return a key-value pair");u[h=y[0]]=(f=u[h])?Xe.isArray(f)?[...f,y[1]]:[f,y[1]]:y[1]}c(u,s)}else r!=null&&l(s,r,n);return this}get(r,s){if(r=Zo(r),r){const n=Xe.findKey(this,r);if(n){const a=this[n];if(!s)return a;if(s===!0)return PP(a);if(Xe.isFunction(s))return s.call(this,a,n);if(Xe.isRegExp(s))return s.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,s){if(r=Zo(r),r){const n=Xe.findKey(this,r);return!!(n&&this[n]!==void 0&&(!s||C0(this,this[n],n,s)))}return!1}delete(r,s){const n=this;let a=!1;function l(c){if(c=Zo(c),c){const u=Xe.findKey(n,c);u&&(!s||C0(n,n[u],u,s))&&(delete n[u],a=!0)}}return Xe.isArray(r)?r.forEach(l):l(r),a}clear(r){const s=Object.keys(this);let n=s.length,a=!1;for(;n--;){const l=s[n];(!r||C0(this,this[l],l,r,!0))&&(delete this[l],a=!0)}return a}normalize(r){const s=this,n={};return Xe.forEach(this,(a,l)=>{const c=Xe.findKey(n,l);if(c){s[c]=wu(a),delete s[l];return}const u=r?TP(l):String(l).trim();u!==l&&delete s[l],s[u]=wu(a),n[u]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const s=Object.create(null);return Xe.forEach(this,(n,a)=>{n!=null&&n!==!1&&(s[a]=r&&Xe.isArray(n)?n.join(", "):n)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,s])=>r+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...s){const n=new this(r);return s.forEach(a=>n.set(a)),n}static accessor(r){const n=(this[gv]=this[gv]={accessors:{}}).accessors,a=this.prototype;function l(c){const u=Zo(c);n[u]||(OP(a,c),n[u]=!0)}return Xe.isArray(r)?r.forEach(l):l(r),this}};dn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Xe.reduceDescriptors(dn.prototype,({value:t},r)=>{let s=r[0].toUpperCase()+r.slice(1);return{get:()=>t,set(n){this[s]=n}}});Xe.freezeMethods(dn);function _0(t,r){const s=this||Tc,n=r||s,a=dn.from(n.headers);let l=n.data;return Xe.forEach(t,function(u){l=u.call(s,l,a.normalize(),r?r.status:void 0)}),a.normalize(),l}function bw(t){return!!(t&&t.__CANCEL__)}function oo(t,r,s){pr.call(this,t??"canceled",pr.ERR_CANCELED,r,s),this.name="CanceledError"}Xe.inherits(oo,pr,{__CANCEL__:!0});function ww(t,r,s){const n=s.config.validateStatus;!s.status||!n||n(s.status)?t(s):r(new pr("Request failed with status code "+s.status,[pr.ERR_BAD_REQUEST,pr.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function RP(t){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return r&&r[1]||""}function DP(t,r){t=t||10;const s=new Array(t),n=new Array(t);let a=0,l=0,c;return r=r!==void 0?r:1e3,function(f){const h=Date.now(),y=n[l];c||(c=h),s[a]=f,n[a]=h;let w=l,j=0;for(;w!==a;)j+=s[w++],w=w%t;if(a=(a+1)%t,a===l&&(l=(l+1)%t),h-c<r)return;const C=y&&h-y;return C?Math.round(j*1e3/C):void 0}}function LP(t,r){let s=0,n=1e3/r,a,l;const c=(h,y=Date.now())=>{s=y,a=null,l&&(clearTimeout(l),l=null),t(...h)};return[(...h)=>{const y=Date.now(),w=y-s;w>=n?c(h,y):(a=h,l||(l=setTimeout(()=>{l=null,c(a)},n-w)))},()=>a&&c(a)]}const Ou=(t,r,s=3)=>{let n=0;const a=DP(50,250);return LP(l=>{const c=l.loaded,u=l.lengthComputable?l.total:void 0,f=c-n,h=a(f),y=c<=u;n=c;const w={loaded:c,total:u,progress:u?c/u:void 0,bytes:f,rate:h||void 0,estimated:h&&u&&y?(u-c)/h:void 0,event:l,lengthComputable:u!=null,[r?"download":"upload"]:!0};t(w)},s)},yv=(t,r)=>{const s=t!=null;return[n=>r[0]({lengthComputable:s,total:t,loaded:n}),r[1]]},vv=t=>(...r)=>Xe.asap(()=>t(...r)),FP=Qs.hasStandardBrowserEnv?((t,r)=>s=>(s=new URL(s,Qs.origin),t.protocol===s.protocol&&t.host===s.host&&(r||t.port===s.port)))(new URL(Qs.origin),Qs.navigator&&/(msie|trident)/i.test(Qs.navigator.userAgent)):()=>!0,MP=Qs.hasStandardBrowserEnv?{write(t,r,s,n,a,l,c){if(typeof document>"u")return;const u=[`${t}=${encodeURIComponent(r)}`];Xe.isNumber(s)&&u.push(`expires=${new Date(s).toUTCString()}`),Xe.isString(n)&&u.push(`path=${n}`),Xe.isString(a)&&u.push(`domain=${a}`),l===!0&&u.push("secure"),Xe.isString(c)&&u.push(`SameSite=${c}`),document.cookie=u.join("; ")},read(t){if(typeof document>"u")return null;const r=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return r?decodeURIComponent(r[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function IP(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function qP(t,r){return r?t.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):t}function Nw(t,r,s){let n=!IP(r);return t&&(n||s==!1)?qP(t,r):r}const bv=t=>t instanceof dn?{...t}:t;function Xi(t,r){r=r||{};const s={};function n(h,y,w,j){return Xe.isPlainObject(h)&&Xe.isPlainObject(y)?Xe.merge.call({caseless:j},h,y):Xe.isPlainObject(y)?Xe.merge({},y):Xe.isArray(y)?y.slice():y}function a(h,y,w,j){if(Xe.isUndefined(y)){if(!Xe.isUndefined(h))return n(void 0,h,w,j)}else return n(h,y,w,j)}function l(h,y){if(!Xe.isUndefined(y))return n(void 0,y)}function c(h,y){if(Xe.isUndefined(y)){if(!Xe.isUndefined(h))return n(void 0,h)}else return n(void 0,y)}function u(h,y,w){if(w in r)return n(h,y);if(w in t)return n(void 0,h)}const f={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(h,y,w)=>a(bv(h),bv(y),w,!0)};return Xe.forEach(Object.keys({...t,...r}),function(y){const w=f[y]||a,j=w(t[y],r[y],y);Xe.isUndefined(j)&&w!==u||(s[y]=j)}),s}const jw=t=>{const r=Xi({},t);let{data:s,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:l,headers:c,auth:u}=r;if(r.headers=c=dn.from(c),r.url=gw(Nw(r.baseURL,r.url,r.allowAbsoluteUrls),t.params,t.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),Xe.isFormData(s)){if(Qs.hasStandardBrowserEnv||Qs.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(Xe.isFunction(s.getHeaders)){const f=s.getHeaders(),h=["content-type","content-length"];Object.entries(f).forEach(([y,w])=>{h.includes(y.toLowerCase())&&c.set(y,w)})}}if(Qs.hasStandardBrowserEnv&&(n&&Xe.isFunction(n)&&(n=n(r)),n||n!==!1&&FP(r.url))){const f=a&&l&&MP.read(l);f&&c.set(a,f)}return r},BP=typeof XMLHttpRequest<"u",zP=BP&&function(t){return new Promise(function(s,n){const a=jw(t);let l=a.data;const c=dn.from(a.headers).normalize();let{responseType:u,onUploadProgress:f,onDownloadProgress:h}=a,y,w,j,C,k;function S(){C&&C(),k&&k(),a.cancelToken&&a.cancelToken.unsubscribe(y),a.signal&&a.signal.removeEventListener("abort",y)}let _=new XMLHttpRequest;_.open(a.method.toUpperCase(),a.url,!0),_.timeout=a.timeout;function I(){if(!_)return;const B=dn.from("getAllResponseHeaders"in _&&_.getAllResponseHeaders()),me={data:!u||u==="text"||u==="json"?_.responseText:_.response,status:_.status,statusText:_.statusText,headers:B,config:t,request:_};ww(function(M){s(M),S()},function(M){n(M),S()},me),_=null}"onloadend"in _?_.onloadend=I:_.onreadystatechange=function(){!_||_.readyState!==4||_.status===0&&!(_.responseURL&&_.responseURL.indexOf("file:")===0)||setTimeout(I)},_.onabort=function(){_&&(n(new pr("Request aborted",pr.ECONNABORTED,t,_)),_=null)},_.onerror=function(q){const me=q&&q.message?q.message:"Network Error",re=new pr(me,pr.ERR_NETWORK,t,_);re.event=q||null,n(re),_=null},_.ontimeout=function(){let q=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const me=a.transitional||yw;a.timeoutErrorMessage&&(q=a.timeoutErrorMessage),n(new pr(q,me.clarifyTimeoutError?pr.ETIMEDOUT:pr.ECONNABORTED,t,_)),_=null},l===void 0&&c.setContentType(null),"setRequestHeader"in _&&Xe.forEach(c.toJSON(),function(q,me){_.setRequestHeader(me,q)}),Xe.isUndefined(a.withCredentials)||(_.withCredentials=!!a.withCredentials),u&&u!=="json"&&(_.responseType=a.responseType),h&&([j,k]=Ou(h,!0),_.addEventListener("progress",j)),f&&_.upload&&([w,C]=Ou(f),_.upload.addEventListener("progress",w),_.upload.addEventListener("loadend",C)),(a.cancelToken||a.signal)&&(y=B=>{_&&(n(!B||B.type?new oo(null,t,_):B),_.abort(),_=null)},a.cancelToken&&a.cancelToken.subscribe(y),a.signal&&(a.signal.aborted?y():a.signal.addEventListener("abort",y)));const F=RP(a.url);if(F&&Qs.protocols.indexOf(F)===-1){n(new pr("Unsupported protocol "+F+":",pr.ERR_BAD_REQUEST,t));return}_.send(l||null)})},$P=(t,r)=>{const{length:s}=t=t?t.filter(Boolean):[];if(r||s){let n=new AbortController,a;const l=function(h){if(!a){a=!0,u();const y=h instanceof Error?h:this.reason;n.abort(y instanceof pr?y:new oo(y instanceof Error?y.message:y))}};let c=r&&setTimeout(()=>{c=null,l(new pr(`timeout ${r} of ms exceeded`,pr.ETIMEDOUT))},r);const u=()=>{t&&(c&&clearTimeout(c),c=null,t.forEach(h=>{h.unsubscribe?h.unsubscribe(l):h.removeEventListener("abort",l)}),t=null)};t.forEach(h=>h.addEventListener("abort",l));const{signal:f}=n;return f.unsubscribe=()=>Xe.asap(u),f}},QP=function*(t,r){let s=t.byteLength;if(s<r){yield t;return}let n=0,a;for(;n<s;)a=n+r,yield t.slice(n,a),n=a},UP=async function*(t,r){for await(const s of VP(t))yield*QP(s,r)},VP=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const r=t.getReader();try{for(;;){const{done:s,value:n}=await r.read();if(s)break;yield n}}finally{await r.cancel()}},wv=(t,r,s,n)=>{const a=UP(t,r);let l=0,c,u=f=>{c||(c=!0,n&&n(f))};return new ReadableStream({async pull(f){try{const{done:h,value:y}=await a.next();if(h){u(),f.close();return}let w=y.byteLength;if(s){let j=l+=w;s(j)}f.enqueue(new Uint8Array(y))}catch(h){throw u(h),h}},cancel(f){return u(f),a.return()}},{highWaterMark:2})},Nv=64*1024,{isFunction:su}=Xe,WP=(({Request:t,Response:r})=>({Request:t,Response:r}))(Xe.global),{ReadableStream:jv,TextEncoder:Sv}=Xe.global,kv=(t,...r)=>{try{return!!t(...r)}catch{return!1}},GP=t=>{t=Xe.merge.call({skipUndefined:!0},WP,t);const{fetch:r,Request:s,Response:n}=t,a=r?su(r):typeof fetch=="function",l=su(s),c=su(n);if(!a)return!1;const u=a&&su(jv),f=a&&(typeof Sv=="function"?(k=>S=>k.encode(S))(new Sv):async k=>new Uint8Array(await new s(k).arrayBuffer())),h=l&&u&&kv(()=>{let k=!1;const S=new s(Qs.origin,{body:new jv,method:"POST",get duplex(){return k=!0,"half"}}).headers.has("Content-Type");return k&&!S}),y=c&&u&&kv(()=>Xe.isReadableStream(new n("").body)),w={stream:y&&(k=>k.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(k=>{!w[k]&&(w[k]=(S,_)=>{let I=S&&S[k];if(I)return I.call(S);throw new pr(`Response type '${k}' is not supported`,pr.ERR_NOT_SUPPORT,_)})});const j=async k=>{if(k==null)return 0;if(Xe.isBlob(k))return k.size;if(Xe.isSpecCompliantForm(k))return(await new s(Qs.origin,{method:"POST",body:k}).arrayBuffer()).byteLength;if(Xe.isArrayBufferView(k)||Xe.isArrayBuffer(k))return k.byteLength;if(Xe.isURLSearchParams(k)&&(k=k+""),Xe.isString(k))return(await f(k)).byteLength},C=async(k,S)=>{const _=Xe.toFiniteNumber(k.getContentLength());return _??j(S)};return async k=>{let{url:S,method:_,data:I,signal:F,cancelToken:B,timeout:q,onDownloadProgress:me,onUploadProgress:re,responseType:M,headers:G,withCredentials:le="same-origin",fetchOptions:Z}=jw(k),he=r||fetch;M=M?(M+"").toLowerCase():"text";let ce=$P([F,B&&B.toAbortSignal()],q),ke=null;const Ee=ce&&ce.unsubscribe&&(()=>{ce.unsubscribe()});let Fe;try{if(re&&h&&_!=="get"&&_!=="head"&&(Fe=await C(G,I))!==0){let se=new s(S,{method:"POST",body:I,duplex:"half"}),U;if(Xe.isFormData(I)&&(U=se.headers.get("content-type"))&&G.setContentType(U),se.body){const[ue,z]=yv(Fe,Ou(vv(re)));I=wv(se.body,Nv,ue,z)}}Xe.isString(le)||(le=le?"include":"omit");const X=l&&"credentials"in s.prototype,ye={...Z,signal:ce,method:_.toUpperCase(),headers:G.normalize().toJSON(),body:I,duplex:"half",credentials:X?le:void 0};ke=l&&new s(S,ye);let Q=await(l?he(ke,Z):he(S,ye));const we=y&&(M==="stream"||M==="response");if(y&&(me||we&&Ee)){const se={};["status","statusText","headers"].forEach(ne=>{se[ne]=Q[ne]});const U=Xe.toFiniteNumber(Q.headers.get("content-length")),[ue,z]=me&&yv(U,Ou(vv(me),!0))||[];Q=new n(wv(Q.body,Nv,ue,()=>{z&&z(),Ee&&Ee()}),se)}M=M||"text";let pe=await w[Xe.findKey(w,M)||"text"](Q,k);return!we&&Ee&&Ee(),await new Promise((se,U)=>{ww(se,U,{data:pe,headers:dn.from(Q.headers),status:Q.status,statusText:Q.statusText,config:k,request:ke})})}catch(X){throw Ee&&Ee(),X&&X.name==="TypeError"&&/Load failed|fetch/i.test(X.message)?Object.assign(new pr("Network Error",pr.ERR_NETWORK,k,ke),{cause:X.cause||X}):pr.from(X,X&&X.code,k,ke)}}},HP=new Map,Sw=t=>{let r=t&&t.env||{};const{fetch:s,Request:n,Response:a}=r,l=[n,a,s];let c=l.length,u=c,f,h,y=HP;for(;u--;)f=l[u],h=y.get(f),h===void 0&&y.set(f,h=u?new Map:GP(r)),y=h;return h};Sw();const Gx={http:uP,xhr:zP,fetch:{get:Sw}};Xe.forEach(Gx,(t,r)=>{if(t){try{Object.defineProperty(t,"name",{value:r})}catch{}Object.defineProperty(t,"adapterName",{value:r})}});const Cv=t=>`- ${t}`,YP=t=>Xe.isFunction(t)||t===null||t===!1;function KP(t,r){t=Xe.isArray(t)?t:[t];const{length:s}=t;let n,a;const l={};for(let c=0;c<s;c++){n=t[c];let u;if(a=n,!YP(n)&&(a=Gx[(u=String(n)).toLowerCase()],a===void 0))throw new pr(`Unknown adapter '${u}'`);if(a&&(Xe.isFunction(a)||(a=a.get(r))))break;l[u||"#"+c]=a}if(!a){const c=Object.entries(l).map(([f,h])=>`adapter ${f} `+(h===!1?"is not supported by the environment":"is not available in the build"));let u=s?c.length>1?`since :
`+c.map(Cv).join(`
`):" "+Cv(c[0]):"as no adapter specified";throw new pr("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return a}const kw={getAdapter:KP,adapters:Gx};function E0(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new oo(null,t)}function _v(t){return E0(t),t.headers=dn.from(t.headers),t.data=_0.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),kw.getAdapter(t.adapter||Tc.adapter,t)(t).then(function(n){return E0(t),n.data=_0.call(t,t.transformResponse,n),n.headers=dn.from(n.headers),n},function(n){return bw(n)||(E0(t),n&&n.response&&(n.response.data=_0.call(t,t.transformResponse,n.response),n.response.headers=dn.from(n.response.headers))),Promise.reject(n)})}const Cw="1.13.2",pm={};["object","boolean","number","function","string","symbol"].forEach((t,r)=>{pm[t]=function(n){return typeof n===t||"a"+(r<1?"n ":" ")+t}});const Ev={};pm.transitional=function(r,s,n){function a(l,c){return"[Axios v"+Cw+"] Transitional option '"+l+"'"+c+(n?". "+n:"")}return(l,c,u)=>{if(r===!1)throw new pr(a(c," has been removed"+(s?" in "+s:"")),pr.ERR_DEPRECATED);return s&&!Ev[c]&&(Ev[c]=!0,console.warn(a(c," has been deprecated since v"+s+" and will be removed in the near future"))),r?r(l,c,u):!0}};pm.spelling=function(r){return(s,n)=>(console.warn(`${n} is likely a misspelling of ${r}`),!0)};function XP(t,r,s){if(typeof t!="object")throw new pr("options must be an object",pr.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let a=n.length;for(;a-- >0;){const l=n[a],c=r[l];if(c){const u=t[l],f=u===void 0||c(u,l,t);if(f!==!0)throw new pr("option "+l+" must be "+f,pr.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new pr("Unknown option "+l,pr.ERR_BAD_OPTION)}}const Nu={assertOptions:XP,validators:pm},ua=Nu.validators;let Hi=class{constructor(r){this.defaults=r||{},this.interceptors={request:new fv,response:new fv}}async request(r,s){try{return await this._request(r,s)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const l=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?l&&!String(n.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+l):n.stack=l}catch{}}throw n}}_request(r,s){typeof r=="string"?(s=s||{},s.url=r):s=r||{},s=Xi(this.defaults,s);const{transitional:n,paramsSerializer:a,headers:l}=s;n!==void 0&&Nu.assertOptions(n,{silentJSONParsing:ua.transitional(ua.boolean),forcedJSONParsing:ua.transitional(ua.boolean),clarifyTimeoutError:ua.transitional(ua.boolean)},!1),a!=null&&(Xe.isFunction(a)?s.paramsSerializer={serialize:a}:Nu.assertOptions(a,{encode:ua.function,serialize:ua.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),Nu.assertOptions(s,{baseUrl:ua.spelling("baseURL"),withXsrfToken:ua.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let c=l&&Xe.merge(l.common,l[s.method]);l&&Xe.forEach(["delete","get","head","post","put","patch","common"],k=>{delete l[k]}),s.headers=dn.concat(c,l);const u=[];let f=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(s)===!1||(f=f&&S.synchronous,u.unshift(S.fulfilled,S.rejected))});const h=[];this.interceptors.response.forEach(function(S){h.push(S.fulfilled,S.rejected)});let y,w=0,j;if(!f){const k=[_v.bind(this),void 0];for(k.unshift(...u),k.push(...h),j=k.length,y=Promise.resolve(s);w<j;)y=y.then(k[w++],k[w++]);return y}j=u.length;let C=s;for(;w<j;){const k=u[w++],S=u[w++];try{C=k(C)}catch(_){S.call(this,_);break}}try{y=_v.call(this,C)}catch(k){return Promise.reject(k)}for(w=0,j=h.length;w<j;)y=y.then(h[w++],h[w++]);return y}getUri(r){r=Xi(this.defaults,r);const s=Nw(r.baseURL,r.url,r.allowAbsoluteUrls);return gw(s,r.params,r.paramsSerializer)}};Xe.forEach(["delete","get","head","options"],function(r){Hi.prototype[r]=function(s,n){return this.request(Xi(n||{},{method:r,url:s,data:(n||{}).data}))}});Xe.forEach(["post","put","patch"],function(r){function s(n){return function(l,c,u){return this.request(Xi(u||{},{method:r,headers:n?{"Content-Type":"multipart/form-data"}:{},url:l,data:c}))}}Hi.prototype[r]=s(),Hi.prototype[r+"Form"]=s(!0)});let JP=class _w{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(l){s=l});const n=this;this.promise.then(a=>{if(!n._listeners)return;let l=n._listeners.length;for(;l-- >0;)n._listeners[l](a);n._listeners=null}),this.promise.then=a=>{let l;const c=new Promise(u=>{n.subscribe(u),l=u}).then(a);return c.cancel=function(){n.unsubscribe(l)},c},r(function(l,c,u){n.reason||(n.reason=new oo(l,c,u),s(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const s=this._listeners.indexOf(r);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const r=new AbortController,s=n=>{r.abort(n)};return this.subscribe(s),r.signal.unsubscribe=()=>this.unsubscribe(s),r.signal}static source(){let r;return{token:new _w(function(a){r=a}),cancel:r}}};function ZP(t){return function(s){return t.apply(null,s)}}function eA(t){return Xe.isObject(t)&&t.isAxiosError===!0}const mx={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(mx).forEach(([t,r])=>{mx[r]=t});function Ew(t){const r=new Hi(t),s=aw(Hi.prototype.request,r);return Xe.extend(s,Hi.prototype,r,{allOwnKeys:!0}),Xe.extend(s,r,null,{allOwnKeys:!0}),s.create=function(a){return Ew(Xi(t,a))},s}const xt=Ew(Tc);xt.Axios=Hi;xt.CanceledError=oo;xt.CancelToken=JP;xt.isCancel=bw;xt.VERSION=Cw;xt.toFormData=mm;xt.AxiosError=pr;xt.Cancel=xt.CanceledError;xt.all=function(r){return Promise.all(r)};xt.spread=ZP;xt.isAxiosError=eA;xt.mergeConfig=Xi;xt.AxiosHeaders=dn;xt.formToJSON=t=>vw(Xe.isHTMLForm(t)?new FormData(t):t);xt.getAdapter=kw.getAdapter;xt.HttpStatusCode=mx;xt.default=xt;const{Axios:s$,AxiosError:n$,CanceledError:a$,isCancel:i$,CancelToken:l$,VERSION:o$,all:c$,Cancel:d$,isAxiosError:u$,spread:m$,toFormData:p$,AxiosHeaders:x$,HttpStatusCode:h$,formToJSON:f$,getAdapter:g$,mergeConfig:y$}=xt,tA=C1("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function Ir({className:t,variant:r,asChild:s=!1,...n}){const a=s?j1:"span";return e.jsx(a,{"data-slot":"badge",className:Nr(tA({variant:r}),t),...n})}var rA=Tx[" useId ".trim().toString()]||(()=>{}),sA=0;function ga(t){const[r,s]=d.useState(rA());return js(()=>{s(n=>n??String(sA++))},[t]),t||(r?`radix-${r}`:"")}function Jn(t){const r=d.useRef(t);return d.useEffect(()=>{r.current=t}),d.useMemo(()=>(...s)=>r.current?.(...s),[])}function nA(t,r=globalThis?.document){const s=Jn(t);d.useEffect(()=>{const n=a=>{a.key==="Escape"&&s(a)};return r.addEventListener("keydown",n,{capture:!0}),()=>r.removeEventListener("keydown",n,{capture:!0})},[s,r])}var aA="DismissableLayer",px="dismissableLayer.update",iA="dismissableLayer.pointerDownOutside",lA="dismissableLayer.focusOutside",Pv,Pw=d.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Oc=d.forwardRef((t,r)=>{const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:l,onInteractOutside:c,onDismiss:u,...f}=t,h=d.useContext(Pw),[y,w]=d.useState(null),j=y?.ownerDocument??globalThis?.document,[,C]=d.useState({}),k=Ar(r,M=>w(M)),S=Array.from(h.layers),[_]=[...h.layersWithOutsidePointerEventsDisabled].slice(-1),I=S.indexOf(_),F=y?S.indexOf(y):-1,B=h.layersWithOutsidePointerEventsDisabled.size>0,q=F>=I,me=dA(M=>{const G=M.target,le=[...h.branches].some(Z=>Z.contains(G));!q||le||(a?.(M),c?.(M),M.defaultPrevented||u?.())},j),re=uA(M=>{const G=M.target;[...h.branches].some(Z=>Z.contains(G))||(l?.(M),c?.(M),M.defaultPrevented||u?.())},j);return nA(M=>{F===h.layers.size-1&&(n?.(M),!M.defaultPrevented&&u&&(M.preventDefault(),u()))},j),d.useEffect(()=>{if(y)return s&&(h.layersWithOutsidePointerEventsDisabled.size===0&&(Pv=j.body.style.pointerEvents,j.body.style.pointerEvents="none"),h.layersWithOutsidePointerEventsDisabled.add(y)),h.layers.add(y),Av(),()=>{s&&h.layersWithOutsidePointerEventsDisabled.size===1&&(j.body.style.pointerEvents=Pv)}},[y,j,s,h]),d.useEffect(()=>()=>{y&&(h.layers.delete(y),h.layersWithOutsidePointerEventsDisabled.delete(y),Av())},[y,h]),d.useEffect(()=>{const M=()=>C({});return document.addEventListener(px,M),()=>document.removeEventListener(px,M)},[]),e.jsx(vr.div,{...f,ref:k,style:{pointerEvents:B?q?"auto":"none":void 0,...t.style},onFocusCapture:Zt(t.onFocusCapture,re.onFocusCapture),onBlurCapture:Zt(t.onBlurCapture,re.onBlurCapture),onPointerDownCapture:Zt(t.onPointerDownCapture,me.onPointerDownCapture)})});Oc.displayName=aA;var oA="DismissableLayerBranch",cA=d.forwardRef((t,r)=>{const s=d.useContext(Pw),n=d.useRef(null),a=Ar(r,n);return d.useEffect(()=>{const l=n.current;if(l)return s.branches.add(l),()=>{s.branches.delete(l)}},[s.branches]),e.jsx(vr.div,{...t,ref:a})});cA.displayName=oA;function dA(t,r=globalThis?.document){const s=Jn(t),n=d.useRef(!1),a=d.useRef(()=>{});return d.useEffect(()=>{const l=u=>{if(u.target&&!n.current){let f=function(){Aw(iA,s,h,{discrete:!0})};const h={originalEvent:u};u.pointerType==="touch"?(r.removeEventListener("click",a.current),a.current=f,r.addEventListener("click",a.current,{once:!0})):f()}else r.removeEventListener("click",a.current);n.current=!1},c=window.setTimeout(()=>{r.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(c),r.removeEventListener("pointerdown",l),r.removeEventListener("click",a.current)}},[r,s]),{onPointerDownCapture:()=>n.current=!0}}function uA(t,r=globalThis?.document){const s=Jn(t),n=d.useRef(!1);return d.useEffect(()=>{const a=l=>{l.target&&!n.current&&Aw(lA,s,{originalEvent:l},{discrete:!1})};return r.addEventListener("focusin",a),()=>r.removeEventListener("focusin",a)},[r,s]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Av(){const t=new CustomEvent(px);document.dispatchEvent(t)}function Aw(t,r,s,{discrete:n}){const a=s.originalEvent.target,l=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:s});r&&a.addEventListener(t,r,{once:!0}),n?q1(a,l):a.dispatchEvent(l)}var P0="focusScope.autoFocusOnMount",A0="focusScope.autoFocusOnUnmount",Tv={bubbles:!1,cancelable:!0},mA="FocusScope",Rc=d.forwardRef((t,r)=>{const{loop:s=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:l,...c}=t,[u,f]=d.useState(null),h=Jn(a),y=Jn(l),w=d.useRef(null),j=Ar(r,S=>f(S)),C=d.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;d.useEffect(()=>{if(n){let S=function(B){if(C.paused||!u)return;const q=B.target;u.contains(q)?w.current=q:yi(w.current,{select:!0})},_=function(B){if(C.paused||!u)return;const q=B.relatedTarget;q!==null&&(u.contains(q)||yi(w.current,{select:!0}))},I=function(B){if(document.activeElement===document.body)for(const me of B)me.removedNodes.length>0&&yi(u)};document.addEventListener("focusin",S),document.addEventListener("focusout",_);const F=new MutationObserver(I);return u&&F.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",S),document.removeEventListener("focusout",_),F.disconnect()}}},[n,u,C.paused]),d.useEffect(()=>{if(u){Rv.add(C);const S=document.activeElement;if(!u.contains(S)){const I=new CustomEvent(P0,Tv);u.addEventListener(P0,h),u.dispatchEvent(I),I.defaultPrevented||(pA(yA(Tw(u)),{select:!0}),document.activeElement===S&&yi(u))}return()=>{u.removeEventListener(P0,h),setTimeout(()=>{const I=new CustomEvent(A0,Tv);u.addEventListener(A0,y),u.dispatchEvent(I),I.defaultPrevented||yi(S??document.body,{select:!0}),u.removeEventListener(A0,y),Rv.remove(C)},0)}}},[u,h,y,C]);const k=d.useCallback(S=>{if(!s&&!n||C.paused)return;const _=S.key==="Tab"&&!S.altKey&&!S.ctrlKey&&!S.metaKey,I=document.activeElement;if(_&&I){const F=S.currentTarget,[B,q]=xA(F);B&&q?!S.shiftKey&&I===q?(S.preventDefault(),s&&yi(B,{select:!0})):S.shiftKey&&I===B&&(S.preventDefault(),s&&yi(q,{select:!0})):I===F&&S.preventDefault()}},[s,n,C.paused]);return e.jsx(vr.div,{tabIndex:-1,...c,ref:j,onKeyDown:k})});Rc.displayName=mA;function pA(t,{select:r=!1}={}){const s=document.activeElement;for(const n of t)if(yi(n,{select:r}),document.activeElement!==s)return}function xA(t){const r=Tw(t),s=Ov(r,t),n=Ov(r.reverse(),t);return[s,n]}function Tw(t){const r=[],s=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)r.push(s.currentNode);return r}function Ov(t,r){for(const s of t)if(!hA(s,{upTo:r}))return s}function hA(t,{upTo:r}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(r!==void 0&&t===r)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function fA(t){return t instanceof HTMLInputElement&&"select"in t}function yi(t,{select:r=!1}={}){if(t&&t.focus){const s=document.activeElement;t.focus({preventScroll:!0}),t!==s&&fA(t)&&r&&t.select()}}var Rv=gA();function gA(){let t=[];return{add(r){const s=t[0];r!==s&&s?.pause(),t=Dv(t,r),t.unshift(r)},remove(r){t=Dv(t,r),t[0]?.resume()}}}function Dv(t,r){const s=[...t],n=s.indexOf(r);return n!==-1&&s.splice(n,1),s}function yA(t){return t.filter(r=>r.tagName!=="A")}var vA="Portal",Dc=d.forwardRef((t,r)=>{const{container:s,...n}=t,[a,l]=d.useState(!1);js(()=>l(!0),[]);const c=s||a&&globalThis?.document?.body;return c?v3.createPortal(e.jsx(vr.div,{...n,ref:r}),c):null});Dc.displayName=vA;var T0=0;function xm(){d.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Lv()),document.body.insertAdjacentElement("beforeend",t[1]??Lv()),T0++,()=>{T0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),T0--}},[])}function Lv(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var xa=function(){return xa=Object.assign||function(r){for(var s,n=1,a=arguments.length;n<a;n++){s=arguments[n];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(r[l]=s[l])}return r},xa.apply(this,arguments)};function Ow(t,r){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(s[n[a]]=t[n[a]]);return s}function bA(t,r,s){if(s||arguments.length===2)for(var n=0,a=r.length,l;n<a;n++)(l||!(n in r))&&(l||(l=Array.prototype.slice.call(r,0,n)),l[n]=r[n]);return t.concat(l||Array.prototype.slice.call(r))}var ju="right-scroll-bar-position",Su="width-before-scroll-bar",wA="with-scroll-bars-hidden",NA="--removed-body-scroll-bar-size";function O0(t,r){return typeof t=="function"?t(r):t&&(t.current=r),t}function jA(t,r){var s=d.useState(function(){return{value:t,callback:r,facade:{get current(){return s.value},set current(n){var a=s.value;a!==n&&(s.value=n,s.callback(n,a))}}}})[0];return s.callback=r,s.facade}var SA=typeof window<"u"?d.useLayoutEffect:d.useEffect,Fv=new WeakMap;function kA(t,r){var s=jA(null,function(n){return t.forEach(function(a){return O0(a,n)})});return SA(function(){var n=Fv.get(s);if(n){var a=new Set(n),l=new Set(t),c=s.current;a.forEach(function(u){l.has(u)||O0(u,null)}),l.forEach(function(u){a.has(u)||O0(u,c)})}Fv.set(s,t)},[t]),s}function CA(t){return t}function _A(t,r){r===void 0&&(r=CA);var s=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return s.length?s[s.length-1]:t},useMedium:function(l){var c=r(l,n);return s.push(c),function(){s=s.filter(function(u){return u!==c})}},assignSyncMedium:function(l){for(n=!0;s.length;){var c=s;s=[],c.forEach(l)}s={push:function(u){return l(u)},filter:function(){return s}}},assignMedium:function(l){n=!0;var c=[];if(s.length){var u=s;s=[],u.forEach(l),c=s}var f=function(){var y=c;c=[],y.forEach(l)},h=function(){return Promise.resolve().then(f)};h(),s={push:function(y){c.push(y),h()},filter:function(y){return c=c.filter(y),s}}}};return a}function EA(t){t===void 0&&(t={});var r=_A(null);return r.options=xa({async:!0,ssr:!1},t),r}var Rw=function(t){var r=t.sideCar,s=Ow(t,["sideCar"]);if(!r)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=r.read();if(!n)throw new Error("Sidecar medium not found");return d.createElement(n,xa({},s))};Rw.isSideCarExport=!0;function PA(t,r){return t.useMedium(r),Rw}var Dw=EA(),R0=function(){},hm=d.forwardRef(function(t,r){var s=d.useRef(null),n=d.useState({onScrollCapture:R0,onWheelCapture:R0,onTouchMoveCapture:R0}),a=n[0],l=n[1],c=t.forwardProps,u=t.children,f=t.className,h=t.removeScrollBar,y=t.enabled,w=t.shards,j=t.sideCar,C=t.noRelative,k=t.noIsolation,S=t.inert,_=t.allowPinchZoom,I=t.as,F=I===void 0?"div":I,B=t.gapMode,q=Ow(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),me=j,re=kA([s,r]),M=xa(xa({},q),a);return d.createElement(d.Fragment,null,y&&d.createElement(me,{sideCar:Dw,removeScrollBar:h,shards:w,noRelative:C,noIsolation:k,inert:S,setCallbacks:l,allowPinchZoom:!!_,lockRef:s,gapMode:B}),c?d.cloneElement(d.Children.only(u),xa(xa({},M),{ref:re})):d.createElement(F,xa({},M,{className:f,ref:re}),u))});hm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};hm.classNames={fullWidth:Su,zeroRight:ju};var AA=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function TA(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var r=AA();return r&&t.setAttribute("nonce",r),t}function OA(t,r){t.styleSheet?t.styleSheet.cssText=r:t.appendChild(document.createTextNode(r))}function RA(t){var r=document.head||document.getElementsByTagName("head")[0];r.appendChild(t)}var DA=function(){var t=0,r=null;return{add:function(s){t==0&&(r=TA())&&(OA(r,s),RA(r)),t++},remove:function(){t--,!t&&r&&(r.parentNode&&r.parentNode.removeChild(r),r=null)}}},LA=function(){var t=DA();return function(r,s){d.useEffect(function(){return t.add(r),function(){t.remove()}},[r&&s])}},Lw=function(){var t=LA(),r=function(s){var n=s.styles,a=s.dynamic;return t(n,a),null};return r},FA={left:0,top:0,right:0,gap:0},D0=function(t){return parseInt(t||"",10)||0},MA=function(t){var r=window.getComputedStyle(document.body),s=r[t==="padding"?"paddingLeft":"marginLeft"],n=r[t==="padding"?"paddingTop":"marginTop"],a=r[t==="padding"?"paddingRight":"marginRight"];return[D0(s),D0(n),D0(a)]},IA=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return FA;var r=MA(t),s=document.documentElement.clientWidth,n=window.innerWidth;return{left:r[0],top:r[1],right:r[2],gap:Math.max(0,n-s+r[2]-r[0])}},qA=Lw(),Vl="data-scroll-locked",BA=function(t,r,s,n){var a=t.left,l=t.top,c=t.right,u=t.gap;return s===void 0&&(s="margin"),`
  .`.concat(wA,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(u,"px ").concat(n,`;
  }
  body[`).concat(Vl,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([r&&"position: relative ".concat(n,";"),s==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(c,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(u,"px ").concat(n,`;
    `),s==="padding"&&"padding-right: ".concat(u,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(ju,` {
    right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(Su,` {
    margin-right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(ju," .").concat(ju,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Su," .").concat(Su,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Vl,`] {
    `).concat(NA,": ").concat(u,`px;
  }
`)},Mv=function(){var t=parseInt(document.body.getAttribute(Vl)||"0",10);return isFinite(t)?t:0},zA=function(){d.useEffect(function(){return document.body.setAttribute(Vl,(Mv()+1).toString()),function(){var t=Mv()-1;t<=0?document.body.removeAttribute(Vl):document.body.setAttribute(Vl,t.toString())}},[])},$A=function(t){var r=t.noRelative,s=t.noImportant,n=t.gapMode,a=n===void 0?"margin":n;zA();var l=d.useMemo(function(){return IA(a)},[a]);return d.createElement(qA,{styles:BA(l,!r,a,s?"":"!important")})},xx=!1;if(typeof window<"u")try{var nu=Object.defineProperty({},"passive",{get:function(){return xx=!0,!0}});window.addEventListener("test",nu,nu),window.removeEventListener("test",nu,nu)}catch{xx=!1}var Fl=xx?{passive:!1}:!1,QA=function(t){return t.tagName==="TEXTAREA"},Fw=function(t,r){if(!(t instanceof Element))return!1;var s=window.getComputedStyle(t);return s[r]!=="hidden"&&!(s.overflowY===s.overflowX&&!QA(t)&&s[r]==="visible")},UA=function(t){return Fw(t,"overflowY")},VA=function(t){return Fw(t,"overflowX")},Iv=function(t,r){var s=r.ownerDocument,n=r;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=Mw(t,n);if(a){var l=Iw(t,n),c=l[1],u=l[2];if(c>u)return!0}n=n.parentNode}while(n&&n!==s.body);return!1},WA=function(t){var r=t.scrollTop,s=t.scrollHeight,n=t.clientHeight;return[r,s,n]},GA=function(t){var r=t.scrollLeft,s=t.scrollWidth,n=t.clientWidth;return[r,s,n]},Mw=function(t,r){return t==="v"?UA(r):VA(r)},Iw=function(t,r){return t==="v"?WA(r):GA(r)},HA=function(t,r){return t==="h"&&r==="rtl"?-1:1},YA=function(t,r,s,n,a){var l=HA(t,window.getComputedStyle(r).direction),c=l*n,u=s.target,f=r.contains(u),h=!1,y=c>0,w=0,j=0;do{if(!u)break;var C=Iw(t,u),k=C[0],S=C[1],_=C[2],I=S-_-l*k;(k||I)&&Mw(t,u)&&(w+=I,j+=k);var F=u.parentNode;u=F&&F.nodeType===Node.DOCUMENT_FRAGMENT_NODE?F.host:F}while(!f&&u!==document.body||f&&(r.contains(u)||r===u));return(y&&Math.abs(w)<1||!y&&Math.abs(j)<1)&&(h=!0),h},au=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},qv=function(t){return[t.deltaX,t.deltaY]},Bv=function(t){return t&&"current"in t?t.current:t},KA=function(t,r){return t[0]===r[0]&&t[1]===r[1]},XA=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},JA=0,Ml=[];function ZA(t){var r=d.useRef([]),s=d.useRef([0,0]),n=d.useRef(),a=d.useState(JA++)[0],l=d.useState(Lw)[0],c=d.useRef(t);d.useEffect(function(){c.current=t},[t]),d.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var S=bA([t.lockRef.current],(t.shards||[]).map(Bv),!0).filter(Boolean);return S.forEach(function(_){return _.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),S.forEach(function(_){return _.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var u=d.useCallback(function(S,_){if("touches"in S&&S.touches.length===2||S.type==="wheel"&&S.ctrlKey)return!c.current.allowPinchZoom;var I=au(S),F=s.current,B="deltaX"in S?S.deltaX:F[0]-I[0],q="deltaY"in S?S.deltaY:F[1]-I[1],me,re=S.target,M=Math.abs(B)>Math.abs(q)?"h":"v";if("touches"in S&&M==="h"&&re.type==="range")return!1;var G=Iv(M,re);if(!G)return!0;if(G?me=M:(me=M==="v"?"h":"v",G=Iv(M,re)),!G)return!1;if(!n.current&&"changedTouches"in S&&(B||q)&&(n.current=me),!me)return!0;var le=n.current||me;return YA(le,_,S,le==="h"?B:q)},[]),f=d.useCallback(function(S){var _=S;if(!(!Ml.length||Ml[Ml.length-1]!==l)){var I="deltaY"in _?qv(_):au(_),F=r.current.filter(function(me){return me.name===_.type&&(me.target===_.target||_.target===me.shadowParent)&&KA(me.delta,I)})[0];if(F&&F.should){_.cancelable&&_.preventDefault();return}if(!F){var B=(c.current.shards||[]).map(Bv).filter(Boolean).filter(function(me){return me.contains(_.target)}),q=B.length>0?u(_,B[0]):!c.current.noIsolation;q&&_.cancelable&&_.preventDefault()}}},[]),h=d.useCallback(function(S,_,I,F){var B={name:S,delta:_,target:I,should:F,shadowParent:e5(I)};r.current.push(B),setTimeout(function(){r.current=r.current.filter(function(q){return q!==B})},1)},[]),y=d.useCallback(function(S){s.current=au(S),n.current=void 0},[]),w=d.useCallback(function(S){h(S.type,qv(S),S.target,u(S,t.lockRef.current))},[]),j=d.useCallback(function(S){h(S.type,au(S),S.target,u(S,t.lockRef.current))},[]);d.useEffect(function(){return Ml.push(l),t.setCallbacks({onScrollCapture:w,onWheelCapture:w,onTouchMoveCapture:j}),document.addEventListener("wheel",f,Fl),document.addEventListener("touchmove",f,Fl),document.addEventListener("touchstart",y,Fl),function(){Ml=Ml.filter(function(S){return S!==l}),document.removeEventListener("wheel",f,Fl),document.removeEventListener("touchmove",f,Fl),document.removeEventListener("touchstart",y,Fl)}},[]);var C=t.removeScrollBar,k=t.inert;return d.createElement(d.Fragment,null,k?d.createElement(l,{styles:XA(a)}):null,C?d.createElement($A,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function e5(t){for(var r=null;t!==null;)t instanceof ShadowRoot&&(r=t.host,t=t.host),t=t.parentNode;return r}const t5=PA(Dw,ZA);var Lc=d.forwardRef(function(t,r){return d.createElement(hm,xa({},t,{ref:r,sideCar:t5}))});Lc.classNames=hm.classNames;var r5=function(t){if(typeof document>"u")return null;var r=Array.isArray(t)?t[0]:t;return r.ownerDocument.body},Il=new WeakMap,iu=new WeakMap,lu={},L0=0,qw=function(t){return t&&(t.host||qw(t.parentNode))},s5=function(t,r){return r.map(function(s){if(t.contains(s))return s;var n=qw(s);return n&&t.contains(n)?n:(console.error("aria-hidden",s,"in not contained inside",t,". Doing nothing"),null)}).filter(function(s){return!!s})},n5=function(t,r,s,n){var a=s5(r,Array.isArray(t)?t:[t]);lu[s]||(lu[s]=new WeakMap);var l=lu[s],c=[],u=new Set,f=new Set(a),h=function(w){!w||u.has(w)||(u.add(w),h(w.parentNode))};a.forEach(h);var y=function(w){!w||f.has(w)||Array.prototype.forEach.call(w.children,function(j){if(u.has(j))y(j);else try{var C=j.getAttribute(n),k=C!==null&&C!=="false",S=(Il.get(j)||0)+1,_=(l.get(j)||0)+1;Il.set(j,S),l.set(j,_),c.push(j),S===1&&k&&iu.set(j,!0),_===1&&j.setAttribute(s,"true"),k||j.setAttribute(n,"true")}catch(I){console.error("aria-hidden: cannot operate on ",j,I)}})};return y(r),u.clear(),L0++,function(){c.forEach(function(w){var j=Il.get(w)-1,C=l.get(w)-1;Il.set(w,j),l.set(w,C),j||(iu.has(w)||w.removeAttribute(n),iu.delete(w)),C||w.removeAttribute(s)}),L0--,L0||(Il=new WeakMap,Il=new WeakMap,iu=new WeakMap,lu={})}},fm=function(t,r,s){s===void 0&&(s="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),a=r5(t);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),n5(n,a,s,"aria-hidden")):function(){return null}};function a5(t){const r=i5(t),s=d.forwardRef((n,a)=>{const{children:l,...c}=n,u=d.Children.toArray(l),f=u.find(o5);if(f){const h=f.props.children,y=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(r,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,y):null})}return e.jsx(r,{...c,ref:a,children:l})});return s.displayName=`${t}.Slot`,s}function i5(t){const r=d.forwardRef((s,n)=>{const{children:a,...l}=s;if(d.isValidElement(a)){const c=d5(a),u=c5(l,a.props);return a.type!==d.Fragment&&(u.ref=n?Sa(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var l5=Symbol("radix.slottable");function o5(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===l5}function c5(t,r){const s={...r};for(const n in r){const a=t[n],l=r[n];/^on[A-Z]/.test(n)?a&&l?s[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(s[n]=a):n==="style"?s[n]={...a,...l}:n==="className"&&(s[n]=[a,l].filter(Boolean).join(" "))}return{...t,...s}}function d5(t){let r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?t.ref:(r=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var gm="Dialog",[Bw]=Ga(gm),[u5,ia]=Bw(gm),zw=t=>{const{__scopeDialog:r,children:s,open:n,defaultOpen:a,onOpenChange:l,modal:c=!0}=t,u=d.useRef(null),f=d.useRef(null),[h,y]=Ki({prop:n,defaultProp:a??!1,onChange:l,caller:gm});return e.jsx(u5,{scope:r,triggerRef:u,contentRef:f,contentId:ga(),titleId:ga(),descriptionId:ga(),open:h,onOpenChange:y,onOpenToggle:d.useCallback(()=>y(w=>!w),[y]),modal:c,children:s})};zw.displayName=gm;var $w="DialogTrigger",m5=d.forwardRef((t,r)=>{const{__scopeDialog:s,...n}=t,a=ia($w,s),l=Ar(r,a.triggerRef);return e.jsx(vr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Kx(a.open),...n,ref:l,onClick:Zt(t.onClick,a.onOpenToggle)})});m5.displayName=$w;var Hx="DialogPortal",[p5,Qw]=Bw(Hx,{forceMount:void 0}),Uw=t=>{const{__scopeDialog:r,forceMount:s,children:n,container:a}=t,l=ia(Hx,r);return e.jsx(p5,{scope:r,forceMount:s,children:d.Children.map(n,c=>e.jsx(na,{present:s||l.open,children:e.jsx(Dc,{asChild:!0,container:a,children:c})}))})};Uw.displayName=Hx;var Ru="DialogOverlay",Vw=d.forwardRef((t,r)=>{const s=Qw(Ru,t.__scopeDialog),{forceMount:n=s.forceMount,...a}=t,l=ia(Ru,t.__scopeDialog);return l.modal?e.jsx(na,{present:n||l.open,children:e.jsx(h5,{...a,ref:r})}):null});Vw.displayName=Ru;var x5=a5("DialogOverlay.RemoveScroll"),h5=d.forwardRef((t,r)=>{const{__scopeDialog:s,...n}=t,a=ia(Ru,s);return e.jsx(Lc,{as:x5,allowPinchZoom:!0,shards:[a.contentRef],children:e.jsx(vr.div,{"data-state":Kx(a.open),...n,ref:r,style:{pointerEvents:"auto",...n.style}})})}),Ji="DialogContent",Ww=d.forwardRef((t,r)=>{const s=Qw(Ji,t.__scopeDialog),{forceMount:n=s.forceMount,...a}=t,l=ia(Ji,t.__scopeDialog);return e.jsx(na,{present:n||l.open,children:l.modal?e.jsx(f5,{...a,ref:r}):e.jsx(g5,{...a,ref:r})})});Ww.displayName=Ji;var f5=d.forwardRef((t,r)=>{const s=ia(Ji,t.__scopeDialog),n=d.useRef(null),a=Ar(r,s.contentRef,n);return d.useEffect(()=>{const l=n.current;if(l)return fm(l)},[]),e.jsx(Gw,{...t,ref:a,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Zt(t.onCloseAutoFocus,l=>{l.preventDefault(),s.triggerRef.current?.focus()}),onPointerDownOutside:Zt(t.onPointerDownOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0;(c.button===2||u)&&l.preventDefault()}),onFocusOutside:Zt(t.onFocusOutside,l=>l.preventDefault())})}),g5=d.forwardRef((t,r)=>{const s=ia(Ji,t.__scopeDialog),n=d.useRef(!1),a=d.useRef(!1);return e.jsx(Gw,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{t.onCloseAutoFocus?.(l),l.defaultPrevented||(n.current||s.triggerRef.current?.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{t.onInteractOutside?.(l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const c=l.target;s.triggerRef.current?.contains(c)&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),Gw=d.forwardRef((t,r)=>{const{__scopeDialog:s,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,...c}=t,u=ia(Ji,s),f=d.useRef(null),h=Ar(r,f);return xm(),e.jsxs(e.Fragment,{children:[e.jsx(Rc,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:e.jsx(Oc,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":Kx(u.open),...c,ref:h,onDismiss:()=>u.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(y5,{titleId:u.titleId}),e.jsx(b5,{contentRef:f,descriptionId:u.descriptionId})]})]})}),Yx="DialogTitle",Hw=d.forwardRef((t,r)=>{const{__scopeDialog:s,...n}=t,a=ia(Yx,s);return e.jsx(vr.h2,{id:a.titleId,...n,ref:r})});Hw.displayName=Yx;var Yw="DialogDescription",Kw=d.forwardRef((t,r)=>{const{__scopeDialog:s,...n}=t,a=ia(Yw,s);return e.jsx(vr.p,{id:a.descriptionId,...n,ref:r})});Kw.displayName=Yw;var Xw="DialogClose",Jw=d.forwardRef((t,r)=>{const{__scopeDialog:s,...n}=t,a=ia(Xw,s);return e.jsx(vr.button,{type:"button",...n,ref:r,onClick:Zt(t.onClick,()=>a.onOpenChange(!1))})});Jw.displayName=Xw;function Kx(t){return t?"open":"closed"}var Zw="DialogTitleWarning",[v$,eN]=dE(Zw,{contentName:Ji,titleName:Yx,docsSlug:"dialog"}),y5=({titleId:t})=>{const r=eN(Zw),s=`\`${r.contentName}\` requires a \`${r.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${r.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${r.docsSlug}`;return d.useEffect(()=>{t&&(document.getElementById(t)||console.error(s))},[s,t]),null},v5="DialogDescriptionWarning",b5=({contentRef:t,descriptionId:r})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${eN(v5).contentName}}.`;return d.useEffect(()=>{const a=t.current?.getAttribute("aria-describedby");r&&a&&(document.getElementById(r)||console.warn(n))},[n,t,r]),null},w5=zw,N5=Uw,tN=Vw,rN=Ww,j5=Hw,S5=Kw,k5=Jw;function Ot({...t}){return e.jsx(w5,{"data-slot":"dialog",...t})}function C5({...t}){return e.jsx(N5,{"data-slot":"dialog-portal",...t})}const sN=d.forwardRef(({className:t,...r},s)=>e.jsx(tN,{ref:s,"data-slot":"dialog-overlay",className:Nr("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...r}));sN.displayName=tN.displayName;const Tt=d.forwardRef(({className:t,children:r,...s},n)=>e.jsxs(C5,{"data-slot":"dialog-portal",children:[e.jsx(sN,{}),e.jsxs(rN,{ref:n,"data-slot":"dialog-content",className:Nr("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...s,children:[r,e.jsxs(k5,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(Qx,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Tt.displayName=rN.displayName;function Rt({className:t,...r}){return e.jsx("div",{"data-slot":"dialog-header",className:Nr("flex flex-col gap-2 text-center sm:text-left",t),...r})}function Dt({className:t,...r}){return e.jsx(j5,{"data-slot":"dialog-title",className:Nr("text-lg leading-none font-semibold",t),...r})}function Ft({className:t,...r}){return e.jsx(S5,{"data-slot":"dialog-description",className:Nr("text-muted-foreground text-sm",t),...r})}function ds({className:t,...r}){return e.jsx("textarea",{"data-slot":"textarea",className:Nr("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...r})}var _5=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],E5=_5.reduce((t,r)=>{const s=qx(`Primitive.${r}`),n=d.forwardRef((a,l)=>{const{asChild:c,...u}=a,f=c?s:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(f,{...u,ref:l})});return n.displayName=`Primitive.${r}`,{...t,[r]:n}},{}),P5="Label",nN=d.forwardRef((t,r)=>e.jsx(E5.label,{...t,ref:r,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(t.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));nN.displayName=P5;var A5=nN;function L({className:t,...r}){return e.jsx(A5,{"data-slot":"label",className:Nr("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...r})}function zv(t,[r,s]){return Math.min(s,Math.max(r,t))}function $v(t){const r=T5(t),s=d.forwardRef((n,a)=>{const{children:l,...c}=n,u=d.Children.toArray(l),f=u.find(R5);if(f){const h=f.props.children,y=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(r,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,y):null})}return e.jsx(r,{...c,ref:a,children:l})});return s.displayName=`${t}.Slot`,s}function T5(t){const r=d.forwardRef((s,n)=>{const{children:a,...l}=s;if(d.isValidElement(a)){const c=L5(a),u=D5(l,a.props);return a.type!==d.Fragment&&(u.ref=n?Sa(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var O5=Symbol("radix.slottable");function R5(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===O5}function D5(t,r){const s={...r};for(const n in r){const a=t[n],l=r[n];/^on[A-Z]/.test(n)?a&&l?s[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(s[n]=a):n==="style"?s[n]={...a,...l}:n==="className"&&(s[n]=[a,l].filter(Boolean).join(" "))}return{...t,...s}}function L5(t){let r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?t.ref:(r=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}function Xx(t){const r=t+"CollectionProvider",[s,n]=Ga(r),[a,l]=s(r,{collectionRef:{current:null},itemMap:new Map}),c=S=>{const{scope:_,children:I}=S,F=gi.useRef(null),B=gi.useRef(new Map).current;return e.jsx(a,{scope:_,itemMap:B,collectionRef:F,children:I})};c.displayName=r;const u=t+"CollectionSlot",f=$v(u),h=gi.forwardRef((S,_)=>{const{scope:I,children:F}=S,B=l(u,I),q=Ar(_,B.collectionRef);return e.jsx(f,{ref:q,children:F})});h.displayName=u;const y=t+"CollectionItemSlot",w="data-radix-collection-item",j=$v(y),C=gi.forwardRef((S,_)=>{const{scope:I,children:F,...B}=S,q=gi.useRef(null),me=Ar(_,q),re=l(y,I);return gi.useEffect(()=>(re.itemMap.set(q,{ref:q,...B}),()=>void re.itemMap.delete(q))),e.jsx(j,{[w]:"",ref:me,children:F})});C.displayName=y;function k(S){const _=l(t+"CollectionConsumer",S);return gi.useCallback(()=>{const F=_.collectionRef.current;if(!F)return[];const B=Array.from(F.querySelectorAll(`[${w}]`));return Array.from(_.itemMap.values()).sort((re,M)=>B.indexOf(re.ref.current)-B.indexOf(M.ref.current))},[_.collectionRef,_.itemMap])}return[{Provider:c,Slot:h,ItemSlot:C},k,n]}var F5=d.createContext(void 0);function Jx(t){const r=d.useContext(F5);return t||r||"ltr"}const M5=["top","right","bottom","left"],Ni=Math.min,Nn=Math.max,Du=Math.round,ou=Math.floor,ya=t=>({x:t,y:t}),I5={left:"right",right:"left",bottom:"top",top:"bottom"},q5={start:"end",end:"start"};function hx(t,r,s){return Nn(t,Ni(r,s))}function Qa(t,r){return typeof t=="function"?t(r):t}function Ua(t){return t.split("-")[0]}function co(t){return t.split("-")[1]}function Zx(t){return t==="x"?"y":"x"}function eh(t){return t==="y"?"height":"width"}const B5=new Set(["top","bottom"]);function ha(t){return B5.has(Ua(t))?"y":"x"}function th(t){return Zx(ha(t))}function z5(t,r,s){s===void 0&&(s=!1);const n=co(t),a=th(t),l=eh(a);let c=a==="x"?n===(s?"end":"start")?"right":"left":n==="start"?"bottom":"top";return r.reference[l]>r.floating[l]&&(c=Lu(c)),[c,Lu(c)]}function $5(t){const r=Lu(t);return[fx(t),r,fx(r)]}function fx(t){return t.replace(/start|end/g,r=>q5[r])}const Qv=["left","right"],Uv=["right","left"],Q5=["top","bottom"],U5=["bottom","top"];function V5(t,r,s){switch(t){case"top":case"bottom":return s?r?Uv:Qv:r?Qv:Uv;case"left":case"right":return r?Q5:U5;default:return[]}}function W5(t,r,s,n){const a=co(t);let l=V5(Ua(t),s==="start",n);return a&&(l=l.map(c=>c+"-"+a),r&&(l=l.concat(l.map(fx)))),l}function Lu(t){return t.replace(/left|right|bottom|top/g,r=>I5[r])}function G5(t){return{top:0,right:0,bottom:0,left:0,...t}}function aN(t){return typeof t!="number"?G5(t):{top:t,right:t,bottom:t,left:t}}function Fu(t){const{x:r,y:s,width:n,height:a}=t;return{width:n,height:a,top:s,left:r,right:r+n,bottom:s+a,x:r,y:s}}function Vv(t,r,s){let{reference:n,floating:a}=t;const l=ha(r),c=th(r),u=eh(c),f=Ua(r),h=l==="y",y=n.x+n.width/2-a.width/2,w=n.y+n.height/2-a.height/2,j=n[u]/2-a[u]/2;let C;switch(f){case"top":C={x:y,y:n.y-a.height};break;case"bottom":C={x:y,y:n.y+n.height};break;case"right":C={x:n.x+n.width,y:w};break;case"left":C={x:n.x-a.width,y:w};break;default:C={x:n.x,y:n.y}}switch(co(r)){case"start":C[c]-=j*(s&&h?-1:1);break;case"end":C[c]+=j*(s&&h?-1:1);break}return C}const H5=async(t,r,s)=>{const{placement:n="bottom",strategy:a="absolute",middleware:l=[],platform:c}=s,u=l.filter(Boolean),f=await(c.isRTL==null?void 0:c.isRTL(r));let h=await c.getElementRects({reference:t,floating:r,strategy:a}),{x:y,y:w}=Vv(h,n,f),j=n,C={},k=0;for(let S=0;S<u.length;S++){const{name:_,fn:I}=u[S],{x:F,y:B,data:q,reset:me}=await I({x:y,y:w,initialPlacement:n,placement:j,strategy:a,middlewareData:C,rects:h,platform:c,elements:{reference:t,floating:r}});y=F??y,w=B??w,C={...C,[_]:{...C[_],...q}},me&&k<=50&&(k++,typeof me=="object"&&(me.placement&&(j=me.placement),me.rects&&(h=me.rects===!0?await c.getElementRects({reference:t,floating:r,strategy:a}):me.rects),{x:y,y:w}=Vv(h,j,f)),S=-1)}return{x:y,y:w,placement:j,strategy:a,middlewareData:C}};async function pc(t,r){var s;r===void 0&&(r={});const{x:n,y:a,platform:l,rects:c,elements:u,strategy:f}=t,{boundary:h="clippingAncestors",rootBoundary:y="viewport",elementContext:w="floating",altBoundary:j=!1,padding:C=0}=Qa(r,t),k=aN(C),_=u[j?w==="floating"?"reference":"floating":w],I=Fu(await l.getClippingRect({element:(s=await(l.isElement==null?void 0:l.isElement(_)))==null||s?_:_.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(u.floating)),boundary:h,rootBoundary:y,strategy:f})),F=w==="floating"?{x:n,y:a,width:c.floating.width,height:c.floating.height}:c.reference,B=await(l.getOffsetParent==null?void 0:l.getOffsetParent(u.floating)),q=await(l.isElement==null?void 0:l.isElement(B))?await(l.getScale==null?void 0:l.getScale(B))||{x:1,y:1}:{x:1,y:1},me=Fu(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:F,offsetParent:B,strategy:f}):F);return{top:(I.top-me.top+k.top)/q.y,bottom:(me.bottom-I.bottom+k.bottom)/q.y,left:(I.left-me.left+k.left)/q.x,right:(me.right-I.right+k.right)/q.x}}const Y5=t=>({name:"arrow",options:t,async fn(r){const{x:s,y:n,placement:a,rects:l,platform:c,elements:u,middlewareData:f}=r,{element:h,padding:y=0}=Qa(t,r)||{};if(h==null)return{};const w=aN(y),j={x:s,y:n},C=th(a),k=eh(C),S=await c.getDimensions(h),_=C==="y",I=_?"top":"left",F=_?"bottom":"right",B=_?"clientHeight":"clientWidth",q=l.reference[k]+l.reference[C]-j[C]-l.floating[k],me=j[C]-l.reference[C],re=await(c.getOffsetParent==null?void 0:c.getOffsetParent(h));let M=re?re[B]:0;(!M||!await(c.isElement==null?void 0:c.isElement(re)))&&(M=u.floating[B]||l.floating[k]);const G=q/2-me/2,le=M/2-S[k]/2-1,Z=Ni(w[I],le),he=Ni(w[F],le),ce=Z,ke=M-S[k]-he,Ee=M/2-S[k]/2+G,Fe=hx(ce,Ee,ke),X=!f.arrow&&co(a)!=null&&Ee!==Fe&&l.reference[k]/2-(Ee<ce?Z:he)-S[k]/2<0,ye=X?Ee<ce?Ee-ce:Ee-ke:0;return{[C]:j[C]+ye,data:{[C]:Fe,centerOffset:Ee-Fe-ye,...X&&{alignmentOffset:ye}},reset:X}}}),K5=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(r){var s,n;const{placement:a,middlewareData:l,rects:c,initialPlacement:u,platform:f,elements:h}=r,{mainAxis:y=!0,crossAxis:w=!0,fallbackPlacements:j,fallbackStrategy:C="bestFit",fallbackAxisSideDirection:k="none",flipAlignment:S=!0,..._}=Qa(t,r);if((s=l.arrow)!=null&&s.alignmentOffset)return{};const I=Ua(a),F=ha(u),B=Ua(u)===u,q=await(f.isRTL==null?void 0:f.isRTL(h.floating)),me=j||(B||!S?[Lu(u)]:$5(u)),re=k!=="none";!j&&re&&me.push(...W5(u,S,k,q));const M=[u,...me],G=await pc(r,_),le=[];let Z=((n=l.flip)==null?void 0:n.overflows)||[];if(y&&le.push(G[I]),w){const Ee=z5(a,c,q);le.push(G[Ee[0]],G[Ee[1]])}if(Z=[...Z,{placement:a,overflows:le}],!le.every(Ee=>Ee<=0)){var he,ce;const Ee=(((he=l.flip)==null?void 0:he.index)||0)+1,Fe=M[Ee];if(Fe&&(!(w==="alignment"?F!==ha(Fe):!1)||Z.every(Q=>ha(Q.placement)===F?Q.overflows[0]>0:!0)))return{data:{index:Ee,overflows:Z},reset:{placement:Fe}};let X=(ce=Z.filter(ye=>ye.overflows[0]<=0).sort((ye,Q)=>ye.overflows[1]-Q.overflows[1])[0])==null?void 0:ce.placement;if(!X)switch(C){case"bestFit":{var ke;const ye=(ke=Z.filter(Q=>{if(re){const we=ha(Q.placement);return we===F||we==="y"}return!0}).map(Q=>[Q.placement,Q.overflows.filter(we=>we>0).reduce((we,pe)=>we+pe,0)]).sort((Q,we)=>Q[1]-we[1])[0])==null?void 0:ke[0];ye&&(X=ye);break}case"initialPlacement":X=u;break}if(a!==X)return{reset:{placement:X}}}return{}}}};function Wv(t,r){return{top:t.top-r.height,right:t.right-r.width,bottom:t.bottom-r.height,left:t.left-r.width}}function Gv(t){return M5.some(r=>t[r]>=0)}const X5=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(r){const{rects:s}=r,{strategy:n="referenceHidden",...a}=Qa(t,r);switch(n){case"referenceHidden":{const l=await pc(r,{...a,elementContext:"reference"}),c=Wv(l,s.reference);return{data:{referenceHiddenOffsets:c,referenceHidden:Gv(c)}}}case"escaped":{const l=await pc(r,{...a,altBoundary:!0}),c=Wv(l,s.floating);return{data:{escapedOffsets:c,escaped:Gv(c)}}}default:return{}}}}},iN=new Set(["left","top"]);async function J5(t,r){const{placement:s,platform:n,elements:a}=t,l=await(n.isRTL==null?void 0:n.isRTL(a.floating)),c=Ua(s),u=co(s),f=ha(s)==="y",h=iN.has(c)?-1:1,y=l&&f?-1:1,w=Qa(r,t);let{mainAxis:j,crossAxis:C,alignmentAxis:k}=typeof w=="number"?{mainAxis:w,crossAxis:0,alignmentAxis:null}:{mainAxis:w.mainAxis||0,crossAxis:w.crossAxis||0,alignmentAxis:w.alignmentAxis};return u&&typeof k=="number"&&(C=u==="end"?k*-1:k),f?{x:C*y,y:j*h}:{x:j*h,y:C*y}}const Z5=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(r){var s,n;const{x:a,y:l,placement:c,middlewareData:u}=r,f=await J5(r,t);return c===((s=u.offset)==null?void 0:s.placement)&&(n=u.arrow)!=null&&n.alignmentOffset?{}:{x:a+f.x,y:l+f.y,data:{...f,placement:c}}}}},eT=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(r){const{x:s,y:n,placement:a}=r,{mainAxis:l=!0,crossAxis:c=!1,limiter:u={fn:_=>{let{x:I,y:F}=_;return{x:I,y:F}}},...f}=Qa(t,r),h={x:s,y:n},y=await pc(r,f),w=ha(Ua(a)),j=Zx(w);let C=h[j],k=h[w];if(l){const _=j==="y"?"top":"left",I=j==="y"?"bottom":"right",F=C+y[_],B=C-y[I];C=hx(F,C,B)}if(c){const _=w==="y"?"top":"left",I=w==="y"?"bottom":"right",F=k+y[_],B=k-y[I];k=hx(F,k,B)}const S=u.fn({...r,[j]:C,[w]:k});return{...S,data:{x:S.x-s,y:S.y-n,enabled:{[j]:l,[w]:c}}}}}},tT=function(t){return t===void 0&&(t={}),{options:t,fn(r){const{x:s,y:n,placement:a,rects:l,middlewareData:c}=r,{offset:u=0,mainAxis:f=!0,crossAxis:h=!0}=Qa(t,r),y={x:s,y:n},w=ha(a),j=Zx(w);let C=y[j],k=y[w];const S=Qa(u,r),_=typeof S=="number"?{mainAxis:S,crossAxis:0}:{mainAxis:0,crossAxis:0,...S};if(f){const B=j==="y"?"height":"width",q=l.reference[j]-l.floating[B]+_.mainAxis,me=l.reference[j]+l.reference[B]-_.mainAxis;C<q?C=q:C>me&&(C=me)}if(h){var I,F;const B=j==="y"?"width":"height",q=iN.has(Ua(a)),me=l.reference[w]-l.floating[B]+(q&&((I=c.offset)==null?void 0:I[w])||0)+(q?0:_.crossAxis),re=l.reference[w]+l.reference[B]+(q?0:((F=c.offset)==null?void 0:F[w])||0)-(q?_.crossAxis:0);k<me?k=me:k>re&&(k=re)}return{[j]:C,[w]:k}}}},rT=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(r){var s,n;const{placement:a,rects:l,platform:c,elements:u}=r,{apply:f=()=>{},...h}=Qa(t,r),y=await pc(r,h),w=Ua(a),j=co(a),C=ha(a)==="y",{width:k,height:S}=l.floating;let _,I;w==="top"||w==="bottom"?(_=w,I=j===(await(c.isRTL==null?void 0:c.isRTL(u.floating))?"start":"end")?"left":"right"):(I=w,_=j==="end"?"top":"bottom");const F=S-y.top-y.bottom,B=k-y.left-y.right,q=Ni(S-y[_],F),me=Ni(k-y[I],B),re=!r.middlewareData.shift;let M=q,G=me;if((s=r.middlewareData.shift)!=null&&s.enabled.x&&(G=B),(n=r.middlewareData.shift)!=null&&n.enabled.y&&(M=F),re&&!j){const Z=Nn(y.left,0),he=Nn(y.right,0),ce=Nn(y.top,0),ke=Nn(y.bottom,0);C?G=k-2*(Z!==0||he!==0?Z+he:Nn(y.left,y.right)):M=S-2*(ce!==0||ke!==0?ce+ke:Nn(y.top,y.bottom))}await f({...r,availableWidth:G,availableHeight:M});const le=await c.getDimensions(u.floating);return k!==le.width||S!==le.height?{reset:{rects:!0}}:{}}}};function ym(){return typeof window<"u"}function uo(t){return lN(t)?(t.nodeName||"").toLowerCase():"#document"}function kn(t){var r;return(t==null||(r=t.ownerDocument)==null?void 0:r.defaultView)||window}function ka(t){var r;return(r=(lN(t)?t.ownerDocument:t.document)||window.document)==null?void 0:r.documentElement}function lN(t){return ym()?t instanceof Node||t instanceof kn(t).Node:!1}function Zn(t){return ym()?t instanceof Element||t instanceof kn(t).Element:!1}function va(t){return ym()?t instanceof HTMLElement||t instanceof kn(t).HTMLElement:!1}function Hv(t){return!ym()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof kn(t).ShadowRoot}const sT=new Set(["inline","contents"]);function Fc(t){const{overflow:r,overflowX:s,overflowY:n,display:a}=ea(t);return/auto|scroll|overlay|hidden|clip/.test(r+n+s)&&!sT.has(a)}const nT=new Set(["table","td","th"]);function aT(t){return nT.has(uo(t))}const iT=[":popover-open",":modal"];function vm(t){return iT.some(r=>{try{return t.matches(r)}catch{return!1}})}const lT=["transform","translate","scale","rotate","perspective"],oT=["transform","translate","scale","rotate","perspective","filter"],cT=["paint","layout","strict","content"];function rh(t){const r=sh(),s=Zn(t)?ea(t):t;return lT.some(n=>s[n]?s[n]!=="none":!1)||(s.containerType?s.containerType!=="normal":!1)||!r&&(s.backdropFilter?s.backdropFilter!=="none":!1)||!r&&(s.filter?s.filter!=="none":!1)||oT.some(n=>(s.willChange||"").includes(n))||cT.some(n=>(s.contain||"").includes(n))}function dT(t){let r=ji(t);for(;va(r)&&!Jl(r);){if(rh(r))return r;if(vm(r))return null;r=ji(r)}return null}function sh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const uT=new Set(["html","body","#document"]);function Jl(t){return uT.has(uo(t))}function ea(t){return kn(t).getComputedStyle(t)}function bm(t){return Zn(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ji(t){if(uo(t)==="html")return t;const r=t.assignedSlot||t.parentNode||Hv(t)&&t.host||ka(t);return Hv(r)?r.host:r}function oN(t){const r=ji(t);return Jl(r)?t.ownerDocument?t.ownerDocument.body:t.body:va(r)&&Fc(r)?r:oN(r)}function xc(t,r,s){var n;r===void 0&&(r=[]),s===void 0&&(s=!0);const a=oN(t),l=a===((n=t.ownerDocument)==null?void 0:n.body),c=kn(a);if(l){const u=gx(c);return r.concat(c,c.visualViewport||[],Fc(a)?a:[],u&&s?xc(u):[])}return r.concat(a,xc(a,[],s))}function gx(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function cN(t){const r=ea(t);let s=parseFloat(r.width)||0,n=parseFloat(r.height)||0;const a=va(t),l=a?t.offsetWidth:s,c=a?t.offsetHeight:n,u=Du(s)!==l||Du(n)!==c;return u&&(s=l,n=c),{width:s,height:n,$:u}}function nh(t){return Zn(t)?t:t.contextElement}function Wl(t){const r=nh(t);if(!va(r))return ya(1);const s=r.getBoundingClientRect(),{width:n,height:a,$:l}=cN(r);let c=(l?Du(s.width):s.width)/n,u=(l?Du(s.height):s.height)/a;return(!c||!Number.isFinite(c))&&(c=1),(!u||!Number.isFinite(u))&&(u=1),{x:c,y:u}}const mT=ya(0);function dN(t){const r=kn(t);return!sh()||!r.visualViewport?mT:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function pT(t,r,s){return r===void 0&&(r=!1),!s||r&&s!==kn(t)?!1:r}function Zi(t,r,s,n){r===void 0&&(r=!1),s===void 0&&(s=!1);const a=t.getBoundingClientRect(),l=nh(t);let c=ya(1);r&&(n?Zn(n)&&(c=Wl(n)):c=Wl(t));const u=pT(l,s,n)?dN(l):ya(0);let f=(a.left+u.x)/c.x,h=(a.top+u.y)/c.y,y=a.width/c.x,w=a.height/c.y;if(l){const j=kn(l),C=n&&Zn(n)?kn(n):n;let k=j,S=gx(k);for(;S&&n&&C!==k;){const _=Wl(S),I=S.getBoundingClientRect(),F=ea(S),B=I.left+(S.clientLeft+parseFloat(F.paddingLeft))*_.x,q=I.top+(S.clientTop+parseFloat(F.paddingTop))*_.y;f*=_.x,h*=_.y,y*=_.x,w*=_.y,f+=B,h+=q,k=kn(S),S=gx(k)}}return Fu({width:y,height:w,x:f,y:h})}function wm(t,r){const s=bm(t).scrollLeft;return r?r.left+s:Zi(ka(t)).left+s}function uN(t,r){const s=t.getBoundingClientRect(),n=s.left+r.scrollLeft-wm(t,s),a=s.top+r.scrollTop;return{x:n,y:a}}function xT(t){let{elements:r,rect:s,offsetParent:n,strategy:a}=t;const l=a==="fixed",c=ka(n),u=r?vm(r.floating):!1;if(n===c||u&&l)return s;let f={scrollLeft:0,scrollTop:0},h=ya(1);const y=ya(0),w=va(n);if((w||!w&&!l)&&((uo(n)!=="body"||Fc(c))&&(f=bm(n)),va(n))){const C=Zi(n);h=Wl(n),y.x=C.x+n.clientLeft,y.y=C.y+n.clientTop}const j=c&&!w&&!l?uN(c,f):ya(0);return{width:s.width*h.x,height:s.height*h.y,x:s.x*h.x-f.scrollLeft*h.x+y.x+j.x,y:s.y*h.y-f.scrollTop*h.y+y.y+j.y}}function hT(t){return Array.from(t.getClientRects())}function fT(t){const r=ka(t),s=bm(t),n=t.ownerDocument.body,a=Nn(r.scrollWidth,r.clientWidth,n.scrollWidth,n.clientWidth),l=Nn(r.scrollHeight,r.clientHeight,n.scrollHeight,n.clientHeight);let c=-s.scrollLeft+wm(t);const u=-s.scrollTop;return ea(n).direction==="rtl"&&(c+=Nn(r.clientWidth,n.clientWidth)-a),{width:a,height:l,x:c,y:u}}const Yv=25;function gT(t,r){const s=kn(t),n=ka(t),a=s.visualViewport;let l=n.clientWidth,c=n.clientHeight,u=0,f=0;if(a){l=a.width,c=a.height;const y=sh();(!y||y&&r==="fixed")&&(u=a.offsetLeft,f=a.offsetTop)}const h=wm(n);if(h<=0){const y=n.ownerDocument,w=y.body,j=getComputedStyle(w),C=y.compatMode==="CSS1Compat"&&parseFloat(j.marginLeft)+parseFloat(j.marginRight)||0,k=Math.abs(n.clientWidth-w.clientWidth-C);k<=Yv&&(l-=k)}else h<=Yv&&(l+=h);return{width:l,height:c,x:u,y:f}}const yT=new Set(["absolute","fixed"]);function vT(t,r){const s=Zi(t,!0,r==="fixed"),n=s.top+t.clientTop,a=s.left+t.clientLeft,l=va(t)?Wl(t):ya(1),c=t.clientWidth*l.x,u=t.clientHeight*l.y,f=a*l.x,h=n*l.y;return{width:c,height:u,x:f,y:h}}function Kv(t,r,s){let n;if(r==="viewport")n=gT(t,s);else if(r==="document")n=fT(ka(t));else if(Zn(r))n=vT(r,s);else{const a=dN(t);n={x:r.x-a.x,y:r.y-a.y,width:r.width,height:r.height}}return Fu(n)}function mN(t,r){const s=ji(t);return s===r||!Zn(s)||Jl(s)?!1:ea(s).position==="fixed"||mN(s,r)}function bT(t,r){const s=r.get(t);if(s)return s;let n=xc(t,[],!1).filter(u=>Zn(u)&&uo(u)!=="body"),a=null;const l=ea(t).position==="fixed";let c=l?ji(t):t;for(;Zn(c)&&!Jl(c);){const u=ea(c),f=rh(c);!f&&u.position==="fixed"&&(a=null),(l?!f&&!a:!f&&u.position==="static"&&!!a&&yT.has(a.position)||Fc(c)&&!f&&mN(t,c))?n=n.filter(y=>y!==c):a=u,c=ji(c)}return r.set(t,n),n}function wT(t){let{element:r,boundary:s,rootBoundary:n,strategy:a}=t;const c=[...s==="clippingAncestors"?vm(r)?[]:bT(r,this._c):[].concat(s),n],u=c[0],f=c.reduce((h,y)=>{const w=Kv(r,y,a);return h.top=Nn(w.top,h.top),h.right=Ni(w.right,h.right),h.bottom=Ni(w.bottom,h.bottom),h.left=Nn(w.left,h.left),h},Kv(r,u,a));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function NT(t){const{width:r,height:s}=cN(t);return{width:r,height:s}}function jT(t,r,s){const n=va(r),a=ka(r),l=s==="fixed",c=Zi(t,!0,l,r);let u={scrollLeft:0,scrollTop:0};const f=ya(0);function h(){f.x=wm(a)}if(n||!n&&!l)if((uo(r)!=="body"||Fc(a))&&(u=bm(r)),n){const C=Zi(r,!0,l,r);f.x=C.x+r.clientLeft,f.y=C.y+r.clientTop}else a&&h();l&&!n&&a&&h();const y=a&&!n&&!l?uN(a,u):ya(0),w=c.left+u.scrollLeft-f.x-y.x,j=c.top+u.scrollTop-f.y-y.y;return{x:w,y:j,width:c.width,height:c.height}}function F0(t){return ea(t).position==="static"}function Xv(t,r){if(!va(t)||ea(t).position==="fixed")return null;if(r)return r(t);let s=t.offsetParent;return ka(t)===s&&(s=s.ownerDocument.body),s}function pN(t,r){const s=kn(t);if(vm(t))return s;if(!va(t)){let a=ji(t);for(;a&&!Jl(a);){if(Zn(a)&&!F0(a))return a;a=ji(a)}return s}let n=Xv(t,r);for(;n&&aT(n)&&F0(n);)n=Xv(n,r);return n&&Jl(n)&&F0(n)&&!rh(n)?s:n||dT(t)||s}const ST=async function(t){const r=this.getOffsetParent||pN,s=this.getDimensions,n=await s(t.floating);return{reference:jT(t.reference,await r(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function kT(t){return ea(t).direction==="rtl"}const CT={convertOffsetParentRelativeRectToViewportRelativeRect:xT,getDocumentElement:ka,getClippingRect:wT,getOffsetParent:pN,getElementRects:ST,getClientRects:hT,getDimensions:NT,getScale:Wl,isElement:Zn,isRTL:kT};function xN(t,r){return t.x===r.x&&t.y===r.y&&t.width===r.width&&t.height===r.height}function _T(t,r){let s=null,n;const a=ka(t);function l(){var u;clearTimeout(n),(u=s)==null||u.disconnect(),s=null}function c(u,f){u===void 0&&(u=!1),f===void 0&&(f=1),l();const h=t.getBoundingClientRect(),{left:y,top:w,width:j,height:C}=h;if(u||r(),!j||!C)return;const k=ou(w),S=ou(a.clientWidth-(y+j)),_=ou(a.clientHeight-(w+C)),I=ou(y),B={rootMargin:-k+"px "+-S+"px "+-_+"px "+-I+"px",threshold:Nn(0,Ni(1,f))||1};let q=!0;function me(re){const M=re[0].intersectionRatio;if(M!==f){if(!q)return c();M?c(!1,M):n=setTimeout(()=>{c(!1,1e-7)},1e3)}M===1&&!xN(h,t.getBoundingClientRect())&&c(),q=!1}try{s=new IntersectionObserver(me,{...B,root:a.ownerDocument})}catch{s=new IntersectionObserver(me,B)}s.observe(t)}return c(!0),l}function ET(t,r,s,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:f=!1}=n,h=nh(t),y=a||l?[...h?xc(h):[],...xc(r)]:[];y.forEach(I=>{a&&I.addEventListener("scroll",s,{passive:!0}),l&&I.addEventListener("resize",s)});const w=h&&u?_T(h,s):null;let j=-1,C=null;c&&(C=new ResizeObserver(I=>{let[F]=I;F&&F.target===h&&C&&(C.unobserve(r),cancelAnimationFrame(j),j=requestAnimationFrame(()=>{var B;(B=C)==null||B.observe(r)})),s()}),h&&!f&&C.observe(h),C.observe(r));let k,S=f?Zi(t):null;f&&_();function _(){const I=Zi(t);S&&!xN(S,I)&&s(),S=I,k=requestAnimationFrame(_)}return s(),()=>{var I;y.forEach(F=>{a&&F.removeEventListener("scroll",s),l&&F.removeEventListener("resize",s)}),w?.(),(I=C)==null||I.disconnect(),C=null,f&&cancelAnimationFrame(k)}}const PT=Z5,AT=eT,TT=K5,OT=rT,RT=X5,Jv=Y5,DT=tT,LT=(t,r,s)=>{const n=new Map,a={platform:CT,...s},l={...a.platform,_c:n};return H5(t,r,{...a,platform:l})};var FT=typeof document<"u",MT=function(){},ku=FT?d.useLayoutEffect:MT;function Mu(t,r){if(t===r)return!0;if(typeof t!=typeof r)return!1;if(typeof t=="function"&&t.toString()===r.toString())return!0;let s,n,a;if(t&&r&&typeof t=="object"){if(Array.isArray(t)){if(s=t.length,s!==r.length)return!1;for(n=s;n--!==0;)if(!Mu(t[n],r[n]))return!1;return!0}if(a=Object.keys(t),s=a.length,s!==Object.keys(r).length)return!1;for(n=s;n--!==0;)if(!{}.hasOwnProperty.call(r,a[n]))return!1;for(n=s;n--!==0;){const l=a[n];if(!(l==="_owner"&&t.$$typeof)&&!Mu(t[l],r[l]))return!1}return!0}return t!==t&&r!==r}function hN(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Zv(t,r){const s=hN(t);return Math.round(r*s)/s}function M0(t){const r=d.useRef(t);return ku(()=>{r.current=t}),r}function IT(t){t===void 0&&(t={});const{placement:r="bottom",strategy:s="absolute",middleware:n=[],platform:a,elements:{reference:l,floating:c}={},transform:u=!0,whileElementsMounted:f,open:h}=t,[y,w]=d.useState({x:0,y:0,strategy:s,placement:r,middlewareData:{},isPositioned:!1}),[j,C]=d.useState(n);Mu(j,n)||C(n);const[k,S]=d.useState(null),[_,I]=d.useState(null),F=d.useCallback(Q=>{Q!==re.current&&(re.current=Q,S(Q))},[]),B=d.useCallback(Q=>{Q!==M.current&&(M.current=Q,I(Q))},[]),q=l||k,me=c||_,re=d.useRef(null),M=d.useRef(null),G=d.useRef(y),le=f!=null,Z=M0(f),he=M0(a),ce=M0(h),ke=d.useCallback(()=>{if(!re.current||!M.current)return;const Q={placement:r,strategy:s,middleware:j};he.current&&(Q.platform=he.current),LT(re.current,M.current,Q).then(we=>{const pe={...we,isPositioned:ce.current!==!1};Ee.current&&!Mu(G.current,pe)&&(G.current=pe,_c.flushSync(()=>{w(pe)}))})},[j,r,s,he,ce]);ku(()=>{h===!1&&G.current.isPositioned&&(G.current.isPositioned=!1,w(Q=>({...Q,isPositioned:!1})))},[h]);const Ee=d.useRef(!1);ku(()=>(Ee.current=!0,()=>{Ee.current=!1}),[]),ku(()=>{if(q&&(re.current=q),me&&(M.current=me),q&&me){if(Z.current)return Z.current(q,me,ke);ke()}},[q,me,ke,Z,le]);const Fe=d.useMemo(()=>({reference:re,floating:M,setReference:F,setFloating:B}),[F,B]),X=d.useMemo(()=>({reference:q,floating:me}),[q,me]),ye=d.useMemo(()=>{const Q={position:s,left:0,top:0};if(!X.floating)return Q;const we=Zv(X.floating,y.x),pe=Zv(X.floating,y.y);return u?{...Q,transform:"translate("+we+"px, "+pe+"px)",...hN(X.floating)>=1.5&&{willChange:"transform"}}:{position:s,left:we,top:pe}},[s,u,X.floating,y.x,y.y]);return d.useMemo(()=>({...y,update:ke,refs:Fe,elements:X,floatingStyles:ye}),[y,ke,Fe,X,ye])}const qT=t=>{function r(s){return{}.hasOwnProperty.call(s,"current")}return{name:"arrow",options:t,fn(s){const{element:n,padding:a}=typeof t=="function"?t(s):t;return n&&r(n)?n.current!=null?Jv({element:n.current,padding:a}).fn(s):{}:n?Jv({element:n,padding:a}).fn(s):{}}}},BT=(t,r)=>({...PT(t),options:[t,r]}),zT=(t,r)=>({...AT(t),options:[t,r]}),$T=(t,r)=>({...DT(t),options:[t,r]}),QT=(t,r)=>({...TT(t),options:[t,r]}),UT=(t,r)=>({...OT(t),options:[t,r]}),VT=(t,r)=>({...RT(t),options:[t,r]}),WT=(t,r)=>({...qT(t),options:[t,r]});var GT="Arrow",fN=d.forwardRef((t,r)=>{const{children:s,width:n=10,height:a=5,...l}=t;return e.jsx(vr.svg,{...l,ref:r,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?s:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});fN.displayName=GT;var HT=fN,ah="Popper",[gN,mo]=Ga(ah),[YT,yN]=gN(ah),vN=t=>{const{__scopePopper:r,children:s}=t,[n,a]=d.useState(null);return e.jsx(YT,{scope:r,anchor:n,onAnchorChange:a,children:s})};vN.displayName=ah;var bN="PopperAnchor",wN=d.forwardRef((t,r)=>{const{__scopePopper:s,virtualRef:n,...a}=t,l=yN(bN,s),c=d.useRef(null),u=Ar(r,c),f=d.useRef(null);return d.useEffect(()=>{const h=f.current;f.current=n?.current||c.current,h!==f.current&&l.onAnchorChange(f.current)}),n?null:e.jsx(vr.div,{...a,ref:u})});wN.displayName=bN;var ih="PopperContent",[KT,XT]=gN(ih),NN=d.forwardRef((t,r)=>{const{__scopePopper:s,side:n="bottom",sideOffset:a=0,align:l="center",alignOffset:c=0,arrowPadding:u=0,avoidCollisions:f=!0,collisionBoundary:h=[],collisionPadding:y=0,sticky:w="partial",hideWhenDetached:j=!1,updatePositionStrategy:C="optimized",onPlaced:k,...S}=t,_=yN(ih,s),[I,F]=d.useState(null),B=Ar(r,fe=>F(fe)),[q,me]=d.useState(null),re=I1(q),M=re?.width??0,G=re?.height??0,le=n+(l!=="center"?"-"+l:""),Z=typeof y=="number"?y:{top:0,right:0,bottom:0,left:0,...y},he=Array.isArray(h)?h:[h],ce=he.length>0,ke={padding:Z,boundary:he.filter(ZT),altBoundary:ce},{refs:Ee,floatingStyles:Fe,placement:X,isPositioned:ye,middlewareData:Q}=IT({strategy:"fixed",placement:le,whileElementsMounted:(...fe)=>ET(...fe,{animationFrame:C==="always"}),elements:{reference:_.anchor},middleware:[BT({mainAxis:a+G,alignmentAxis:c}),f&&zT({mainAxis:!0,crossAxis:!1,limiter:w==="partial"?$T():void 0,...ke}),f&&QT({...ke}),UT({...ke,apply:({elements:fe,rects:Ce,availableWidth:Le,availableHeight:De})=>{const{width:Ve,height:tt}=Ce.reference,Nt=fe.floating.style;Nt.setProperty("--radix-popper-available-width",`${Le}px`),Nt.setProperty("--radix-popper-available-height",`${De}px`),Nt.setProperty("--radix-popper-anchor-width",`${Ve}px`),Nt.setProperty("--radix-popper-anchor-height",`${tt}px`)}}),q&&WT({element:q,padding:u}),eO({arrowWidth:M,arrowHeight:G}),j&&VT({strategy:"referenceHidden",...ke})]}),[we,pe]=kN(X),se=Jn(k);js(()=>{ye&&se?.()},[ye,se]);const U=Q.arrow?.x,ue=Q.arrow?.y,z=Q.arrow?.centerOffset!==0,[ne,ve]=d.useState();return js(()=>{I&&ve(window.getComputedStyle(I).zIndex)},[I]),e.jsx("div",{ref:Ee.setFloating,"data-radix-popper-content-wrapper":"",style:{...Fe,transform:ye?Fe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ne,"--radix-popper-transform-origin":[Q.transformOrigin?.x,Q.transformOrigin?.y].join(" "),...Q.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:e.jsx(KT,{scope:s,placedSide:we,onArrowChange:me,arrowX:U,arrowY:ue,shouldHideArrow:z,children:e.jsx(vr.div,{"data-side":we,"data-align":pe,...S,ref:B,style:{...S.style,animation:ye?void 0:"none"}})})})});NN.displayName=ih;var jN="PopperArrow",JT={top:"bottom",right:"left",bottom:"top",left:"right"},SN=d.forwardRef(function(r,s){const{__scopePopper:n,...a}=r,l=XT(jN,n),c=JT[l.placedSide];return e.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:e.jsx(HT,{...a,ref:s,style:{...a.style,display:"block"}})})});SN.displayName=jN;function ZT(t){return t!==null}var eO=t=>({name:"transformOrigin",options:t,fn(r){const{placement:s,rects:n,middlewareData:a}=r,c=a.arrow?.centerOffset!==0,u=c?0:t.arrowWidth,f=c?0:t.arrowHeight,[h,y]=kN(s),w={start:"0%",center:"50%",end:"100%"}[y],j=(a.arrow?.x??0)+u/2,C=(a.arrow?.y??0)+f/2;let k="",S="";return h==="bottom"?(k=c?w:`${j}px`,S=`${-f}px`):h==="top"?(k=c?w:`${j}px`,S=`${n.floating.height+f}px`):h==="right"?(k=`${-f}px`,S=c?w:`${C}px`):h==="left"&&(k=`${n.floating.width+f}px`,S=c?w:`${C}px`),{data:{x:k,y:S}}}});function kN(t){const[r,s="center"]=t.split("-");return[r,s]}var lh=vN,Nm=wN,oh=NN,ch=SN;function tO(t){const r=rO(t),s=d.forwardRef((n,a)=>{const{children:l,...c}=n,u=d.Children.toArray(l),f=u.find(nO);if(f){const h=f.props.children,y=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(r,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,y):null})}return e.jsx(r,{...c,ref:a,children:l})});return s.displayName=`${t}.Slot`,s}function rO(t){const r=d.forwardRef((s,n)=>{const{children:a,...l}=s;if(d.isValidElement(a)){const c=iO(a),u=aO(l,a.props);return a.type!==d.Fragment&&(u.ref=n?Sa(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var sO=Symbol("radix.slottable");function nO(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===sO}function aO(t,r){const s={...r};for(const n in r){const a=t[n],l=r[n];/^on[A-Z]/.test(n)?a&&l?s[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(s[n]=a):n==="style"?s[n]={...a,...l}:n==="className"&&(s[n]=[a,l].filter(Boolean).join(" "))}return{...t,...s}}function iO(t){let r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?t.ref:(r=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var CN=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),lO="VisuallyHidden",oO=d.forwardRef((t,r)=>e.jsx(vr.span,{...t,ref:r,style:{...CN,...t.style}}));oO.displayName=lO;var cO=[" ","Enter","ArrowUp","ArrowDown"],dO=[" ","Enter"],el="Select",[jm,Sm,uO]=Xx(el),[po]=Ga(el,[uO,mo]),km=mo(),[mO,_i]=po(el),[pO,xO]=po(el),_N=t=>{const{__scopeSelect:r,children:s,open:n,defaultOpen:a,onOpenChange:l,value:c,defaultValue:u,onValueChange:f,dir:h,name:y,autoComplete:w,disabled:j,required:C,form:k}=t,S=km(r),[_,I]=d.useState(null),[F,B]=d.useState(null),[q,me]=d.useState(!1),re=Jx(h),[M,G]=Ki({prop:n,defaultProp:a??!1,onChange:l,caller:el}),[le,Z]=Ki({prop:c,defaultProp:u,onChange:f,caller:el}),he=d.useRef(null),ce=_?k||!!_.closest("form"):!0,[ke,Ee]=d.useState(new Set),Fe=Array.from(ke).map(X=>X.props.value).join(";");return e.jsx(lh,{...S,children:e.jsxs(mO,{required:C,scope:r,trigger:_,onTriggerChange:I,valueNode:F,onValueNodeChange:B,valueNodeHasChildren:q,onValueNodeHasChildrenChange:me,contentId:ga(),value:le,onValueChange:Z,open:M,onOpenChange:G,dir:re,triggerPointerDownPosRef:he,disabled:j,children:[e.jsx(jm.Provider,{scope:r,children:e.jsx(pO,{scope:t.__scopeSelect,onNativeOptionAdd:d.useCallback(X=>{Ee(ye=>new Set(ye).add(X))},[]),onNativeOptionRemove:d.useCallback(X=>{Ee(ye=>{const Q=new Set(ye);return Q.delete(X),Q})},[]),children:s})}),ce?e.jsxs(YN,{"aria-hidden":!0,required:C,tabIndex:-1,name:y,autoComplete:w,value:le,onChange:X=>Z(X.target.value),disabled:j,form:k,children:[le===void 0?e.jsx("option",{value:""}):null,Array.from(ke)]},Fe):null]})})};_N.displayName=el;var EN="SelectTrigger",PN=d.forwardRef((t,r)=>{const{__scopeSelect:s,disabled:n=!1,...a}=t,l=km(s),c=_i(EN,s),u=c.disabled||n,f=Ar(r,c.onTriggerChange),h=Sm(s),y=d.useRef("touch"),[w,j,C]=XN(S=>{const _=h().filter(B=>!B.disabled),I=_.find(B=>B.value===c.value),F=JN(_,S,I);F!==void 0&&c.onValueChange(F.value)}),k=S=>{u||(c.onOpenChange(!0),C()),S&&(c.triggerPointerDownPosRef.current={x:Math.round(S.pageX),y:Math.round(S.pageY)})};return e.jsx(Nm,{asChild:!0,...l,children:e.jsx(vr.button,{type:"button",role:"combobox","aria-controls":c.contentId,"aria-expanded":c.open,"aria-required":c.required,"aria-autocomplete":"none",dir:c.dir,"data-state":c.open?"open":"closed",disabled:u,"data-disabled":u?"":void 0,"data-placeholder":KN(c.value)?"":void 0,...a,ref:f,onClick:Zt(a.onClick,S=>{S.currentTarget.focus(),y.current!=="mouse"&&k(S)}),onPointerDown:Zt(a.onPointerDown,S=>{y.current=S.pointerType;const _=S.target;_.hasPointerCapture(S.pointerId)&&_.releasePointerCapture(S.pointerId),S.button===0&&S.ctrlKey===!1&&S.pointerType==="mouse"&&(k(S),S.preventDefault())}),onKeyDown:Zt(a.onKeyDown,S=>{const _=w.current!=="";!(S.ctrlKey||S.altKey||S.metaKey)&&S.key.length===1&&j(S.key),!(_&&S.key===" ")&&cO.includes(S.key)&&(k(),S.preventDefault())})})})});PN.displayName=EN;var AN="SelectValue",TN=d.forwardRef((t,r)=>{const{__scopeSelect:s,className:n,style:a,children:l,placeholder:c="",...u}=t,f=_i(AN,s),{onValueNodeHasChildrenChange:h}=f,y=l!==void 0,w=Ar(r,f.onValueNodeChange);return js(()=>{h(y)},[h,y]),e.jsx(vr.span,{...u,ref:w,style:{pointerEvents:"none"},children:KN(f.value)?e.jsx(e.Fragment,{children:c}):l})});TN.displayName=AN;var hO="SelectIcon",ON=d.forwardRef((t,r)=>{const{__scopeSelect:s,children:n,...a}=t;return e.jsx(vr.span,{"aria-hidden":!0,...a,ref:r,children:n||""})});ON.displayName=hO;var fO="SelectPortal",RN=t=>e.jsx(Dc,{asChild:!0,...t});RN.displayName=fO;var tl="SelectContent",DN=d.forwardRef((t,r)=>{const s=_i(tl,t.__scopeSelect),[n,a]=d.useState();if(js(()=>{a(new DocumentFragment)},[]),!s.open){const l=n;return l?_c.createPortal(e.jsx(LN,{scope:t.__scopeSelect,children:e.jsx(jm.Slot,{scope:t.__scopeSelect,children:e.jsx("div",{children:t.children})})}),l):null}return e.jsx(FN,{...t,ref:r})});DN.displayName=tl;var Gn=10,[LN,Ei]=po(tl),gO="SelectContentImpl",yO=tO("SelectContent.RemoveScroll"),FN=d.forwardRef((t,r)=>{const{__scopeSelect:s,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:l,onPointerDownOutside:c,side:u,sideOffset:f,align:h,alignOffset:y,arrowPadding:w,collisionBoundary:j,collisionPadding:C,sticky:k,hideWhenDetached:S,avoidCollisions:_,...I}=t,F=_i(tl,s),[B,q]=d.useState(null),[me,re]=d.useState(null),M=Ar(r,fe=>q(fe)),[G,le]=d.useState(null),[Z,he]=d.useState(null),ce=Sm(s),[ke,Ee]=d.useState(!1),Fe=d.useRef(!1);d.useEffect(()=>{if(B)return fm(B)},[B]),xm();const X=d.useCallback(fe=>{const[Ce,...Le]=ce().map(tt=>tt.ref.current),[De]=Le.slice(-1),Ve=document.activeElement;for(const tt of fe)if(tt===Ve||(tt?.scrollIntoView({block:"nearest"}),tt===Ce&&me&&(me.scrollTop=0),tt===De&&me&&(me.scrollTop=me.scrollHeight),tt?.focus(),document.activeElement!==Ve))return},[ce,me]),ye=d.useCallback(()=>X([G,B]),[X,G,B]);d.useEffect(()=>{ke&&ye()},[ke,ye]);const{onOpenChange:Q,triggerPointerDownPosRef:we}=F;d.useEffect(()=>{if(B){let fe={x:0,y:0};const Ce=De=>{fe={x:Math.abs(Math.round(De.pageX)-(we.current?.x??0)),y:Math.abs(Math.round(De.pageY)-(we.current?.y??0))}},Le=De=>{fe.x<=10&&fe.y<=10?De.preventDefault():B.contains(De.target)||Q(!1),document.removeEventListener("pointermove",Ce),we.current=null};return we.current!==null&&(document.addEventListener("pointermove",Ce),document.addEventListener("pointerup",Le,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Ce),document.removeEventListener("pointerup",Le,{capture:!0})}}},[B,Q,we]),d.useEffect(()=>{const fe=()=>Q(!1);return window.addEventListener("blur",fe),window.addEventListener("resize",fe),()=>{window.removeEventListener("blur",fe),window.removeEventListener("resize",fe)}},[Q]);const[pe,se]=XN(fe=>{const Ce=ce().filter(Ve=>!Ve.disabled),Le=Ce.find(Ve=>Ve.ref.current===document.activeElement),De=JN(Ce,fe,Le);De&&setTimeout(()=>De.ref.current.focus())}),U=d.useCallback((fe,Ce,Le)=>{const De=!Fe.current&&!Le;(F.value!==void 0&&F.value===Ce||De)&&(le(fe),De&&(Fe.current=!0))},[F.value]),ue=d.useCallback(()=>B?.focus(),[B]),z=d.useCallback((fe,Ce,Le)=>{const De=!Fe.current&&!Le;(F.value!==void 0&&F.value===Ce||De)&&he(fe)},[F.value]),ne=n==="popper"?yx:MN,ve=ne===yx?{side:u,sideOffset:f,align:h,alignOffset:y,arrowPadding:w,collisionBoundary:j,collisionPadding:C,sticky:k,hideWhenDetached:S,avoidCollisions:_}:{};return e.jsx(LN,{scope:s,content:B,viewport:me,onViewportChange:re,itemRefCallback:U,selectedItem:G,onItemLeave:ue,itemTextRefCallback:z,focusSelectedItem:ye,selectedItemText:Z,position:n,isPositioned:ke,searchRef:pe,children:e.jsx(Lc,{as:yO,allowPinchZoom:!0,children:e.jsx(Rc,{asChild:!0,trapped:F.open,onMountAutoFocus:fe=>{fe.preventDefault()},onUnmountAutoFocus:Zt(a,fe=>{F.trigger?.focus({preventScroll:!0}),fe.preventDefault()}),children:e.jsx(Oc,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:fe=>fe.preventDefault(),onDismiss:()=>F.onOpenChange(!1),children:e.jsx(ne,{role:"listbox",id:F.contentId,"data-state":F.open?"open":"closed",dir:F.dir,onContextMenu:fe=>fe.preventDefault(),...I,...ve,onPlaced:()=>Ee(!0),ref:M,style:{display:"flex",flexDirection:"column",outline:"none",...I.style},onKeyDown:Zt(I.onKeyDown,fe=>{const Ce=fe.ctrlKey||fe.altKey||fe.metaKey;if(fe.key==="Tab"&&fe.preventDefault(),!Ce&&fe.key.length===1&&se(fe.key),["ArrowUp","ArrowDown","Home","End"].includes(fe.key)){let De=ce().filter(Ve=>!Ve.disabled).map(Ve=>Ve.ref.current);if(["ArrowUp","End"].includes(fe.key)&&(De=De.slice().reverse()),["ArrowUp","ArrowDown"].includes(fe.key)){const Ve=fe.target,tt=De.indexOf(Ve);De=De.slice(tt+1)}setTimeout(()=>X(De)),fe.preventDefault()}})})})})})})});FN.displayName=gO;var vO="SelectItemAlignedPosition",MN=d.forwardRef((t,r)=>{const{__scopeSelect:s,onPlaced:n,...a}=t,l=_i(tl,s),c=Ei(tl,s),[u,f]=d.useState(null),[h,y]=d.useState(null),w=Ar(r,M=>y(M)),j=Sm(s),C=d.useRef(!1),k=d.useRef(!0),{viewport:S,selectedItem:_,selectedItemText:I,focusSelectedItem:F}=c,B=d.useCallback(()=>{if(l.trigger&&l.valueNode&&u&&h&&S&&_&&I){const M=l.trigger.getBoundingClientRect(),G=h.getBoundingClientRect(),le=l.valueNode.getBoundingClientRect(),Z=I.getBoundingClientRect();if(l.dir!=="rtl"){const Ve=Z.left-G.left,tt=le.left-Ve,Nt=M.left-tt,lt=M.width+Nt,$t=Math.max(lt,G.width),qe=window.innerWidth-Gn,Ie=zv(tt,[Gn,Math.max(Gn,qe-$t)]);u.style.minWidth=lt+"px",u.style.left=Ie+"px"}else{const Ve=G.right-Z.right,tt=window.innerWidth-le.right-Ve,Nt=window.innerWidth-M.right-tt,lt=M.width+Nt,$t=Math.max(lt,G.width),qe=window.innerWidth-Gn,Ie=zv(tt,[Gn,Math.max(Gn,qe-$t)]);u.style.minWidth=lt+"px",u.style.right=Ie+"px"}const he=j(),ce=window.innerHeight-Gn*2,ke=S.scrollHeight,Ee=window.getComputedStyle(h),Fe=parseInt(Ee.borderTopWidth,10),X=parseInt(Ee.paddingTop,10),ye=parseInt(Ee.borderBottomWidth,10),Q=parseInt(Ee.paddingBottom,10),we=Fe+X+ke+Q+ye,pe=Math.min(_.offsetHeight*5,we),se=window.getComputedStyle(S),U=parseInt(se.paddingTop,10),ue=parseInt(se.paddingBottom,10),z=M.top+M.height/2-Gn,ne=ce-z,ve=_.offsetHeight/2,fe=_.offsetTop+ve,Ce=Fe+X+fe,Le=we-Ce;if(Ce<=z){const Ve=he.length>0&&_===he[he.length-1].ref.current;u.style.bottom="0px";const tt=h.clientHeight-S.offsetTop-S.offsetHeight,Nt=Math.max(ne,ve+(Ve?ue:0)+tt+ye),lt=Ce+Nt;u.style.height=lt+"px"}else{const Ve=he.length>0&&_===he[0].ref.current;u.style.top="0px";const Nt=Math.max(z,Fe+S.offsetTop+(Ve?U:0)+ve)+Le;u.style.height=Nt+"px",S.scrollTop=Ce-z+S.offsetTop}u.style.margin=`${Gn}px 0`,u.style.minHeight=pe+"px",u.style.maxHeight=ce+"px",n?.(),requestAnimationFrame(()=>C.current=!0)}},[j,l.trigger,l.valueNode,u,h,S,_,I,l.dir,n]);js(()=>B(),[B]);const[q,me]=d.useState();js(()=>{h&&me(window.getComputedStyle(h).zIndex)},[h]);const re=d.useCallback(M=>{M&&k.current===!0&&(B(),F?.(),k.current=!1)},[B,F]);return e.jsx(wO,{scope:s,contentWrapper:u,shouldExpandOnScrollRef:C,onScrollButtonChange:re,children:e.jsx("div",{ref:f,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:q},children:e.jsx(vr.div,{...a,ref:w,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});MN.displayName=vO;var bO="SelectPopperPosition",yx=d.forwardRef((t,r)=>{const{__scopeSelect:s,align:n="start",collisionPadding:a=Gn,...l}=t,c=km(s);return e.jsx(oh,{...c,...l,ref:r,align:n,collisionPadding:a,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});yx.displayName=bO;var[wO,dh]=po(tl,{}),vx="SelectViewport",IN=d.forwardRef((t,r)=>{const{__scopeSelect:s,nonce:n,...a}=t,l=Ei(vx,s),c=dh(vx,s),u=Ar(r,l.onViewportChange),f=d.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(jm.Slot,{scope:s,children:e.jsx(vr.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:u,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Zt(a.onScroll,h=>{const y=h.currentTarget,{contentWrapper:w,shouldExpandOnScrollRef:j}=c;if(j?.current&&w){const C=Math.abs(f.current-y.scrollTop);if(C>0){const k=window.innerHeight-Gn*2,S=parseFloat(w.style.minHeight),_=parseFloat(w.style.height),I=Math.max(S,_);if(I<k){const F=I+C,B=Math.min(k,F),q=F-B;w.style.height=B+"px",w.style.bottom==="0px"&&(y.scrollTop=q>0?q:0,w.style.justifyContent="flex-end")}}}f.current=y.scrollTop})})})]})});IN.displayName=vx;var qN="SelectGroup",[NO,jO]=po(qN),SO=d.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t,a=ga();return e.jsx(NO,{scope:s,id:a,children:e.jsx(vr.div,{role:"group","aria-labelledby":a,...n,ref:r})})});SO.displayName=qN;var BN="SelectLabel",kO=d.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t,a=jO(BN,s);return e.jsx(vr.div,{id:a.id,...n,ref:r})});kO.displayName=BN;var Iu="SelectItem",[CO,zN]=po(Iu),$N=d.forwardRef((t,r)=>{const{__scopeSelect:s,value:n,disabled:a=!1,textValue:l,...c}=t,u=_i(Iu,s),f=Ei(Iu,s),h=u.value===n,[y,w]=d.useState(l??""),[j,C]=d.useState(!1),k=Ar(r,F=>f.itemRefCallback?.(F,n,a)),S=ga(),_=d.useRef("touch"),I=()=>{a||(u.onValueChange(n),u.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(CO,{scope:s,value:n,disabled:a,textId:S,isSelected:h,onItemTextChange:d.useCallback(F=>{w(B=>B||(F?.textContent??"").trim())},[]),children:e.jsx(jm.ItemSlot,{scope:s,value:n,disabled:a,textValue:y,children:e.jsx(vr.div,{role:"option","aria-labelledby":S,"data-highlighted":j?"":void 0,"aria-selected":h&&j,"data-state":h?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...c,ref:k,onFocus:Zt(c.onFocus,()=>C(!0)),onBlur:Zt(c.onBlur,()=>C(!1)),onClick:Zt(c.onClick,()=>{_.current!=="mouse"&&I()}),onPointerUp:Zt(c.onPointerUp,()=>{_.current==="mouse"&&I()}),onPointerDown:Zt(c.onPointerDown,F=>{_.current=F.pointerType}),onPointerMove:Zt(c.onPointerMove,F=>{_.current=F.pointerType,a?f.onItemLeave?.():_.current==="mouse"&&F.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Zt(c.onPointerLeave,F=>{F.currentTarget===document.activeElement&&f.onItemLeave?.()}),onKeyDown:Zt(c.onKeyDown,F=>{f.searchRef?.current!==""&&F.key===" "||(dO.includes(F.key)&&I(),F.key===" "&&F.preventDefault())})})})})});$N.displayName=Iu;var sc="SelectItemText",QN=d.forwardRef((t,r)=>{const{__scopeSelect:s,className:n,style:a,...l}=t,c=_i(sc,s),u=Ei(sc,s),f=zN(sc,s),h=xO(sc,s),[y,w]=d.useState(null),j=Ar(r,I=>w(I),f.onItemTextChange,I=>u.itemTextRefCallback?.(I,f.value,f.disabled)),C=y?.textContent,k=d.useMemo(()=>e.jsx("option",{value:f.value,disabled:f.disabled,children:C},f.value),[f.disabled,f.value,C]),{onNativeOptionAdd:S,onNativeOptionRemove:_}=h;return js(()=>(S(k),()=>_(k)),[S,_,k]),e.jsxs(e.Fragment,{children:[e.jsx(vr.span,{id:f.textId,...l,ref:j}),f.isSelected&&c.valueNode&&!c.valueNodeHasChildren?_c.createPortal(l.children,c.valueNode):null]})});QN.displayName=sc;var UN="SelectItemIndicator",VN=d.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t;return zN(UN,s).isSelected?e.jsx(vr.span,{"aria-hidden":!0,...n,ref:r}):null});VN.displayName=UN;var bx="SelectScrollUpButton",WN=d.forwardRef((t,r)=>{const s=Ei(bx,t.__scopeSelect),n=dh(bx,t.__scopeSelect),[a,l]=d.useState(!1),c=Ar(r,n.onScrollButtonChange);return js(()=>{if(s.viewport&&s.isPositioned){let u=function(){const h=f.scrollTop>0;l(h)};const f=s.viewport;return u(),f.addEventListener("scroll",u),()=>f.removeEventListener("scroll",u)}},[s.viewport,s.isPositioned]),a?e.jsx(HN,{...t,ref:c,onAutoScroll:()=>{const{viewport:u,selectedItem:f}=s;u&&f&&(u.scrollTop=u.scrollTop-f.offsetHeight)}}):null});WN.displayName=bx;var wx="SelectScrollDownButton",GN=d.forwardRef((t,r)=>{const s=Ei(wx,t.__scopeSelect),n=dh(wx,t.__scopeSelect),[a,l]=d.useState(!1),c=Ar(r,n.onScrollButtonChange);return js(()=>{if(s.viewport&&s.isPositioned){let u=function(){const h=f.scrollHeight-f.clientHeight,y=Math.ceil(f.scrollTop)<h;l(y)};const f=s.viewport;return u(),f.addEventListener("scroll",u),()=>f.removeEventListener("scroll",u)}},[s.viewport,s.isPositioned]),a?e.jsx(HN,{...t,ref:c,onAutoScroll:()=>{const{viewport:u,selectedItem:f}=s;u&&f&&(u.scrollTop=u.scrollTop+f.offsetHeight)}}):null});GN.displayName=wx;var HN=d.forwardRef((t,r)=>{const{__scopeSelect:s,onAutoScroll:n,...a}=t,l=Ei("SelectScrollButton",s),c=d.useRef(null),u=Sm(s),f=d.useCallback(()=>{c.current!==null&&(window.clearInterval(c.current),c.current=null)},[]);return d.useEffect(()=>()=>f(),[f]),js(()=>{u().find(y=>y.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[u]),e.jsx(vr.div,{"aria-hidden":!0,...a,ref:r,style:{flexShrink:0,...a.style},onPointerDown:Zt(a.onPointerDown,()=>{c.current===null&&(c.current=window.setInterval(n,50))}),onPointerMove:Zt(a.onPointerMove,()=>{l.onItemLeave?.(),c.current===null&&(c.current=window.setInterval(n,50))}),onPointerLeave:Zt(a.onPointerLeave,()=>{f()})})}),_O="SelectSeparator",EO=d.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t;return e.jsx(vr.div,{"aria-hidden":!0,...n,ref:r})});EO.displayName=_O;var Nx="SelectArrow",PO=d.forwardRef((t,r)=>{const{__scopeSelect:s,...n}=t,a=km(s),l=_i(Nx,s),c=Ei(Nx,s);return l.open&&c.position==="popper"?e.jsx(ch,{...a,...n,ref:r}):null});PO.displayName=Nx;var AO="SelectBubbleInput",YN=d.forwardRef(({__scopeSelect:t,value:r,...s},n)=>{const a=d.useRef(null),l=Ar(n,a),c=M1(r);return d.useEffect(()=>{const u=a.current;if(!u)return;const f=window.HTMLSelectElement.prototype,y=Object.getOwnPropertyDescriptor(f,"value").set;if(c!==r&&y){const w=new Event("change",{bubbles:!0});y.call(u,r),u.dispatchEvent(w)}},[c,r]),e.jsx(vr.select,{...s,style:{...CN,...s.style},ref:l,defaultValue:r})});YN.displayName=AO;function KN(t){return t===""||t===void 0}function XN(t){const r=Jn(t),s=d.useRef(""),n=d.useRef(0),a=d.useCallback(c=>{const u=s.current+c;r(u),(function f(h){s.current=h,window.clearTimeout(n.current),h!==""&&(n.current=window.setTimeout(()=>f(""),1e3))})(u)},[r]),l=d.useCallback(()=>{s.current="",window.clearTimeout(n.current)},[]);return d.useEffect(()=>()=>window.clearTimeout(n.current),[]),[s,a,l]}function JN(t,r,s){const a=r.length>1&&Array.from(r).every(h=>h===r[0])?r[0]:r,l=s?t.indexOf(s):-1;let c=TO(t,Math.max(l,0));a.length===1&&(c=c.filter(h=>h!==s));const f=c.find(h=>h.textValue.toLowerCase().startsWith(a.toLowerCase()));return f!==s?f:void 0}function TO(t,r){return t.map((s,n)=>t[(r+n)%t.length])}var OO=_N,RO=PN,DO=TN,LO=ON,FO=RN,MO=DN,IO=IN,qO=$N,BO=QN,zO=VN,$O=WN,QO=GN;function ts({...t}){return e.jsx(OO,{"data-slot":"select",...t})}function rs({...t}){return e.jsx(DO,{"data-slot":"select-value",...t})}function ss({className:t,size:r="default",children:s,...n}){return e.jsxs(RO,{"data-slot":"select-trigger","data-size":r,className:Nr("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-all duration-200 outline-none focus-visible:ring-[3px] focus-visible:shadow-sm hover:border-ring/50 disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[s,e.jsx(LO,{asChild:!0,children:e.jsx($x,{className:"size-4 opacity-50"})})]})}function ns({className:t,children:r,position:s="popper",...n}){return e.jsx(FO,{children:e.jsxs(MO,{"data-slot":"select-content",className:Nr("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s,...n,children:[e.jsx(UO,{}),e.jsx(IO,{className:Nr("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:r}),e.jsx(VO,{})]})})}function Pr({className:t,children:r,...s}){return e.jsxs(qO,{"data-slot":"select-item",className:Nr("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...s,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(zO,{children:e.jsx(Y1,{className:"size-4"})})}),e.jsx(BO,{children:r})]})}function UO({className:t,...r}){return e.jsx($O,{"data-slot":"select-scroll-up-button",className:Nr("flex cursor-default items-center justify-center py-1",t),...r,children:e.jsx(J1,{className:"size-4"})})}function VO({className:t,...r}){return e.jsx(QO,{"data-slot":"select-scroll-down-button",className:Nr("flex cursor-default items-center justify-center py-1",t),...r,children:e.jsx($x,{className:"size-4"})})}function Sr(t){const r=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&r==="[object Date]"?new t.constructor(+t):typeof t=="number"||r==="[object Number]"||typeof t=="string"||r==="[object String]"?new Date(t):new Date(NaN)}function Cn(t,r){return t instanceof Date?new t.constructor(r):new Date(r)}function Hs(t,r){const s=Sr(t);return isNaN(r)?Cn(t,NaN):(r&&s.setDate(s.getDate()+r),s)}function ta(t,r){const s=Sr(t);if(isNaN(r))return Cn(t,NaN);if(!r)return s;const n=s.getDate(),a=Cn(t,s.getTime());a.setMonth(s.getMonth()+r+1,0);const l=a.getDate();return n>=l?a:(s.setFullYear(a.getFullYear(),a.getMonth(),n),s)}const uh=6048e5,WO=864e5;let GO={};function Mc(){return GO}function ba(t,r){const s=Mc(),n=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??s.weekStartsOn??s.locale?.options?.weekStartsOn??0,a=Sr(t),l=a.getDay(),c=(l<n?7:0)+l-n;return a.setDate(a.getDate()-c),a.setHours(0,0,0,0),a}function rl(t){return ba(t,{weekStartsOn:1})}function ZN(t){const r=Sr(t),s=r.getFullYear(),n=Cn(t,0);n.setFullYear(s+1,0,4),n.setHours(0,0,0,0);const a=rl(n),l=Cn(t,0);l.setFullYear(s,0,4),l.setHours(0,0,0,0);const c=rl(l);return r.getTime()>=a.getTime()?s+1:r.getTime()>=c.getTime()?s:s-1}function Zl(t){const r=Sr(t);return r.setHours(0,0,0,0),r}function qu(t){const r=Sr(t),s=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return s.setUTCFullYear(r.getFullYear()),+t-+s}function fa(t,r){const s=Zl(t),n=Zl(r),a=+s-qu(s),l=+n-qu(n);return Math.round((a-l)/WO)}function HO(t){const r=ZN(t),s=Cn(t,0);return s.setFullYear(r,0,4),s.setHours(0,0,0,0),rl(s)}function jx(t,r){const s=r*7;return Hs(t,s)}function YO(t,r){return ta(t,r*12)}function KO(t){let r;return t.forEach(function(s){const n=Sr(s);(r===void 0||r<n||isNaN(Number(n)))&&(r=n)}),r||new Date(NaN)}function XO(t){let r;return t.forEach(s=>{const n=Sr(s);(!r||r>n||isNaN(+n))&&(r=n)}),r||new Date(NaN)}function on(t,r){const s=Zl(t),n=Zl(r);return+s==+n}function mh(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function JO(t){if(!mh(t)&&typeof t!="number")return!1;const r=Sr(t);return!isNaN(Number(r))}function hc(t,r){const s=Sr(t),n=Sr(r),a=s.getFullYear()-n.getFullYear(),l=s.getMonth()-n.getMonth();return a*12+l}function ZO(t,r,s){const n=ba(t,s),a=ba(r,s),l=+n-qu(n),c=+a-qu(a);return Math.round((l-c)/uh)}function ph(t){const r=Sr(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(23,59,59,999),r}function un(t){const r=Sr(t);return r.setDate(1),r.setHours(0,0,0,0),r}function ej(t){const r=Sr(t),s=Cn(t,0);return s.setFullYear(r.getFullYear(),0,1),s.setHours(0,0,0,0),s}function xh(t,r){const s=Mc(),n=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??s.weekStartsOn??s.locale?.options?.weekStartsOn??0,a=Sr(t),l=a.getDay(),c=(l<n?-7:0)+6-(l-n);return a.setDate(a.getDate()+c),a.setHours(23,59,59,999),a}function tj(t){return xh(t,{weekStartsOn:1})}const eR={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},tR=(t,r,s)=>{let n;const a=eR[t];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),s?.addSuffix?s.comparison&&s.comparison>0?"in "+n:n+" ago":n};function I0(t){return(r={})=>{const s=r.width?String(r.width):t.defaultWidth;return t.formats[s]||t.formats[t.defaultWidth]}}const rR={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},sR={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},nR={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},aR={date:I0({formats:rR,defaultWidth:"full"}),time:I0({formats:sR,defaultWidth:"full"}),dateTime:I0({formats:nR,defaultWidth:"full"})},iR={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},lR=(t,r,s,n)=>iR[t];function ec(t){return(r,s)=>{const n=s?.context?String(s.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const c=t.defaultFormattingWidth||t.defaultWidth,u=s?.width?String(s.width):c;a=t.formattingValues[u]||t.formattingValues[c]}else{const c=t.defaultWidth,u=s?.width?String(s.width):t.defaultWidth;a=t.values[u]||t.values[c]}const l=t.argumentCallback?t.argumentCallback(r):r;return a[l]}}const oR={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},cR={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},dR={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},uR={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},mR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},pR={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},xR=(t,r)=>{const s=Number(t),n=s%100;if(n>20||n<10)switch(n%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},hR={ordinalNumber:xR,era:ec({values:oR,defaultWidth:"wide"}),quarter:ec({values:cR,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ec({values:dR,defaultWidth:"wide"}),day:ec({values:uR,defaultWidth:"wide"}),dayPeriod:ec({values:mR,defaultWidth:"wide",formattingValues:pR,defaultFormattingWidth:"wide"})};function tc(t){return(r,s={})=>{const n=s.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],l=r.match(a);if(!l)return null;const c=l[0],u=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],f=Array.isArray(u)?gR(u,w=>w.test(c)):fR(u,w=>w.test(c));let h;h=t.valueCallback?t.valueCallback(f):f,h=s.valueCallback?s.valueCallback(h):h;const y=r.slice(c.length);return{value:h,rest:y}}}function fR(t,r){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&r(t[s]))return s}function gR(t,r){for(let s=0;s<t.length;s++)if(r(t[s]))return s}function yR(t){return(r,s={})=>{const n=r.match(t.matchPattern);if(!n)return null;const a=n[0],l=r.match(t.parsePattern);if(!l)return null;let c=t.valueCallback?t.valueCallback(l[0]):l[0];c=s.valueCallback?s.valueCallback(c):c;const u=r.slice(a.length);return{value:c,rest:u}}}const vR=/^(\d+)(th|st|nd|rd)?/i,bR=/\d+/i,wR={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},NR={any:[/^b/i,/^(a|c)/i]},jR={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},SR={any:[/1/i,/2/i,/3/i,/4/i]},kR={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},CR={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_R={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ER={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},PR={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},AR={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},TR={ordinalNumber:yR({matchPattern:vR,parsePattern:bR,valueCallback:t=>parseInt(t,10)}),era:tc({matchPatterns:wR,defaultMatchWidth:"wide",parsePatterns:NR,defaultParseWidth:"any"}),quarter:tc({matchPatterns:jR,defaultMatchWidth:"wide",parsePatterns:SR,defaultParseWidth:"any",valueCallback:t=>t+1}),month:tc({matchPatterns:kR,defaultMatchWidth:"wide",parsePatterns:CR,defaultParseWidth:"any"}),day:tc({matchPatterns:_R,defaultMatchWidth:"wide",parsePatterns:ER,defaultParseWidth:"any"}),dayPeriod:tc({matchPatterns:PR,defaultMatchWidth:"any",parsePatterns:AR,defaultParseWidth:"any"})},rj={code:"en-US",formatDistance:tR,formatLong:aR,formatRelative:lR,localize:hR,match:TR,options:{weekStartsOn:0,firstWeekContainsDate:1}};function OR(t){const r=Sr(t);return fa(r,ej(r))+1}function sj(t){const r=Sr(t),s=+rl(r)-+HO(r);return Math.round(s/uh)+1}function nj(t,r){const s=Sr(t),n=s.getFullYear(),a=Mc(),l=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,c=Cn(t,0);c.setFullYear(n+1,0,l),c.setHours(0,0,0,0);const u=ba(c,r),f=Cn(t,0);f.setFullYear(n,0,l),f.setHours(0,0,0,0);const h=ba(f,r);return s.getTime()>=u.getTime()?n+1:s.getTime()>=h.getTime()?n:n-1}function RR(t,r){const s=Mc(),n=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,a=nj(t,r),l=Cn(t,0);return l.setFullYear(a,0,n),l.setHours(0,0,0,0),ba(l,r)}function aj(t,r){const s=Sr(t),n=+ba(s,r)-+RR(s,r);return Math.round(n/uh)+1}function Rr(t,r){const s=t<0?"-":"",n=Math.abs(t).toString().padStart(r,"0");return s+n}const hi={y(t,r){const s=t.getFullYear(),n=s>0?s:1-s;return Rr(r==="yy"?n%100:n,r.length)},M(t,r){const s=t.getMonth();return r==="M"?String(s+1):Rr(s+1,2)},d(t,r){return Rr(t.getDate(),r.length)},a(t,r){const s=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];case"aaaa":default:return s==="am"?"a.m.":"p.m."}},h(t,r){return Rr(t.getHours()%12||12,r.length)},H(t,r){return Rr(t.getHours(),r.length)},m(t,r){return Rr(t.getMinutes(),r.length)},s(t,r){return Rr(t.getSeconds(),r.length)},S(t,r){const s=r.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,s-3));return Rr(a,r.length)}},ql={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},eb={G:function(t,r,s){const n=t.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return s.era(n,{width:"abbreviated"});case"GGGGG":return s.era(n,{width:"narrow"});case"GGGG":default:return s.era(n,{width:"wide"})}},y:function(t,r,s){if(r==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return s.ordinalNumber(a,{unit:"year"})}return hi.y(t,r)},Y:function(t,r,s,n){const a=nj(t,n),l=a>0?a:1-a;if(r==="YY"){const c=l%100;return Rr(c,2)}return r==="Yo"?s.ordinalNumber(l,{unit:"year"}):Rr(l,r.length)},R:function(t,r){const s=ZN(t);return Rr(s,r.length)},u:function(t,r){const s=t.getFullYear();return Rr(s,r.length)},Q:function(t,r,s){const n=Math.ceil((t.getMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return Rr(n,2);case"Qo":return s.ordinalNumber(n,{unit:"quarter"});case"QQQ":return s.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,r,s){const n=Math.ceil((t.getMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return Rr(n,2);case"qo":return s.ordinalNumber(n,{unit:"quarter"});case"qqq":return s.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,r,s){const n=t.getMonth();switch(r){case"M":case"MM":return hi.M(t,r);case"Mo":return s.ordinalNumber(n+1,{unit:"month"});case"MMM":return s.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(n,{width:"wide",context:"formatting"})}},L:function(t,r,s){const n=t.getMonth();switch(r){case"L":return String(n+1);case"LL":return Rr(n+1,2);case"Lo":return s.ordinalNumber(n+1,{unit:"month"});case"LLL":return s.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(n,{width:"wide",context:"standalone"})}},w:function(t,r,s,n){const a=aj(t,n);return r==="wo"?s.ordinalNumber(a,{unit:"week"}):Rr(a,r.length)},I:function(t,r,s){const n=sj(t);return r==="Io"?s.ordinalNumber(n,{unit:"week"}):Rr(n,r.length)},d:function(t,r,s){return r==="do"?s.ordinalNumber(t.getDate(),{unit:"date"}):hi.d(t,r)},D:function(t,r,s){const n=OR(t);return r==="Do"?s.ordinalNumber(n,{unit:"dayOfYear"}):Rr(n,r.length)},E:function(t,r,s){const n=t.getDay();switch(r){case"E":case"EE":case"EEE":return s.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(n,{width:"short",context:"formatting"});case"EEEE":default:return s.day(n,{width:"wide",context:"formatting"})}},e:function(t,r,s,n){const a=t.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(l);case"ee":return Rr(l,2);case"eo":return s.ordinalNumber(l,{unit:"day"});case"eee":return s.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(a,{width:"short",context:"formatting"});case"eeee":default:return s.day(a,{width:"wide",context:"formatting"})}},c:function(t,r,s,n){const a=t.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(l);case"cc":return Rr(l,r.length);case"co":return s.ordinalNumber(l,{unit:"day"});case"ccc":return s.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(a,{width:"narrow",context:"standalone"});case"cccccc":return s.day(a,{width:"short",context:"standalone"});case"cccc":default:return s.day(a,{width:"wide",context:"standalone"})}},i:function(t,r,s){const n=t.getDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return Rr(a,r.length);case"io":return s.ordinalNumber(a,{unit:"day"});case"iii":return s.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(n,{width:"short",context:"formatting"});case"iiii":default:return s.day(n,{width:"wide",context:"formatting"})}},a:function(t,r,s){const a=t.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,r,s){const n=t.getHours();let a;switch(n===12?a=ql.noon:n===0?a=ql.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,r,s){const n=t.getHours();let a;switch(n>=17?a=ql.evening:n>=12?a=ql.afternoon:n>=4?a=ql.morning:a=ql.night,r){case"B":case"BB":case"BBB":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,r,s){if(r==="ho"){let n=t.getHours()%12;return n===0&&(n=12),s.ordinalNumber(n,{unit:"hour"})}return hi.h(t,r)},H:function(t,r,s){return r==="Ho"?s.ordinalNumber(t.getHours(),{unit:"hour"}):hi.H(t,r)},K:function(t,r,s){const n=t.getHours()%12;return r==="Ko"?s.ordinalNumber(n,{unit:"hour"}):Rr(n,r.length)},k:function(t,r,s){let n=t.getHours();return n===0&&(n=24),r==="ko"?s.ordinalNumber(n,{unit:"hour"}):Rr(n,r.length)},m:function(t,r,s){return r==="mo"?s.ordinalNumber(t.getMinutes(),{unit:"minute"}):hi.m(t,r)},s:function(t,r,s){return r==="so"?s.ordinalNumber(t.getSeconds(),{unit:"second"}):hi.s(t,r)},S:function(t,r){return hi.S(t,r)},X:function(t,r,s){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(r){case"X":return rb(n);case"XXXX":case"XX":return Ui(n);case"XXXXX":case"XXX":default:return Ui(n,":")}},x:function(t,r,s){const n=t.getTimezoneOffset();switch(r){case"x":return rb(n);case"xxxx":case"xx":return Ui(n);case"xxxxx":case"xxx":default:return Ui(n,":")}},O:function(t,r,s){const n=t.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+tb(n,":");case"OOOO":default:return"GMT"+Ui(n,":")}},z:function(t,r,s){const n=t.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+tb(n,":");case"zzzz":default:return"GMT"+Ui(n,":")}},t:function(t,r,s){const n=Math.trunc(t.getTime()/1e3);return Rr(n,r.length)},T:function(t,r,s){const n=t.getTime();return Rr(n,r.length)}};function tb(t,r=""){const s=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),l=n%60;return l===0?s+String(a):s+String(a)+r+Rr(l,2)}function rb(t,r){return t%60===0?(t>0?"-":"+")+Rr(Math.abs(t)/60,2):Ui(t,r)}function Ui(t,r=""){const s=t>0?"-":"+",n=Math.abs(t),a=Rr(Math.trunc(n/60),2),l=Rr(n%60,2);return s+a+r+l}const sb=(t,r)=>{switch(t){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},ij=(t,r)=>{switch(t){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},DR=(t,r)=>{const s=t.match(/(P+)(p+)?/)||[],n=s[1],a=s[2];if(!a)return sb(t,r);let l;switch(n){case"P":l=r.dateTime({width:"short"});break;case"PP":l=r.dateTime({width:"medium"});break;case"PPP":l=r.dateTime({width:"long"});break;case"PPPP":default:l=r.dateTime({width:"full"});break}return l.replace("{{date}}",sb(n,r)).replace("{{time}}",ij(a,r))},LR={p:ij,P:DR},FR=/^D+$/,MR=/^Y+$/,IR=["D","DD","YY","YYYY"];function qR(t){return FR.test(t)}function BR(t){return MR.test(t)}function zR(t,r,s){const n=$R(t,r,s);if(console.warn(n),IR.includes(t))throw new RangeError(n)}function $R(t,r,s){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${r}\`) for formatting ${n} to the input \`${s}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const QR=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,UR=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,VR=/^'([^]*?)'?$/,WR=/''/g,GR=/[a-zA-Z]/;function Ys(t,r,s){const n=Mc(),a=s?.locale??n.locale??rj,l=s?.firstWeekContainsDate??s?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,c=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,u=Sr(t);if(!JO(u))throw new RangeError("Invalid time value");let f=r.match(UR).map(y=>{const w=y[0];if(w==="p"||w==="P"){const j=LR[w];return j(y,a.formatLong)}return y}).join("").match(QR).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const w=y[0];if(w==="'")return{isToken:!1,value:HR(y)};if(eb[w])return{isToken:!0,value:y};if(w.match(GR))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:y}});a.localize.preprocessor&&(f=a.localize.preprocessor(u,f));const h={firstWeekContainsDate:l,weekStartsOn:c,locale:a};return f.map(y=>{if(!y.isToken)return y.value;const w=y.value;(!s?.useAdditionalWeekYearTokens&&BR(w)||!s?.useAdditionalDayOfYearTokens&&qR(w))&&zR(w,r,String(t));const j=eb[w[0]];return j(u,w,a.localize,h)}).join("")}function HR(t){const r=t.match(VR);return r?r[1].replace(WR,"'"):t}function YR(t){const r=Sr(t),s=r.getFullYear(),n=r.getMonth(),a=Cn(t,0);return a.setFullYear(s,n+1,0),a.setHours(0,0,0,0),a.getDate()}function KR(t){return Math.trunc(+Sr(t)/1e3)}function XR(t){const r=Sr(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(0,0,0,0),r}function JR(t,r){return ZO(XR(t),un(t),r)+1}function Sx(t,r){const s=Sr(t),n=Sr(r);return s.getTime()>n.getTime()}function lj(t,r){const s=Sr(t),n=Sr(r);return+s<+n}function hh(t,r){const s=Sr(t),n=Sr(r);return s.getFullYear()===n.getFullYear()&&s.getMonth()===n.getMonth()}function ZR(t,r){const s=Sr(t),n=Sr(r);return s.getFullYear()===n.getFullYear()}function q0(t,r){return Hs(t,-r)}function B0(t,r){const s=Sr(t),n=s.getFullYear(),a=s.getDate(),l=Cn(t,0);l.setFullYear(n,r,15),l.setHours(0,0,0,0);const c=YR(l);return s.setMonth(r,Math.min(a,c)),s}function nb(t,r){const s=Sr(t);return isNaN(+s)?Cn(t,NaN):(s.setFullYear(r),s)}function eD(t){const r=tD(t),s=d.forwardRef((n,a)=>{const{children:l,...c}=n,u=d.Children.toArray(l),f=u.find(sD);if(f){const h=f.props.children,y=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(r,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,y):null})}return e.jsx(r,{...c,ref:a,children:l})});return s.displayName=`${t}.Slot`,s}function tD(t){const r=d.forwardRef((s,n)=>{const{children:a,...l}=s;if(d.isValidElement(a)){const c=aD(a),u=nD(l,a.props);return a.type!==d.Fragment&&(u.ref=n?Sa(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var rD=Symbol("radix.slottable");function sD(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===rD}function nD(t,r){const s={...r};for(const n in r){const a=t[n],l=r[n];/^on[A-Z]/.test(n)?a&&l?s[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(s[n]=a):n==="style"?s[n]={...a,...l}:n==="className"&&(s[n]=[a,l].filter(Boolean).join(" "))}return{...t,...s}}function aD(t){let r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?t.ref:(r=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var Cm="Popover",[oj]=Ga(Cm,[mo]),Ic=mo(),[iD,Pi]=oj(Cm),cj=t=>{const{__scopePopover:r,children:s,open:n,defaultOpen:a,onOpenChange:l,modal:c=!1}=t,u=Ic(r),f=d.useRef(null),[h,y]=d.useState(!1),[w,j]=Ki({prop:n,defaultProp:a??!1,onChange:l,caller:Cm});return e.jsx(lh,{...u,children:e.jsx(iD,{scope:r,contentId:ga(),triggerRef:f,open:w,onOpenChange:j,onOpenToggle:d.useCallback(()=>j(C=>!C),[j]),hasCustomAnchor:h,onCustomAnchorAdd:d.useCallback(()=>y(!0),[]),onCustomAnchorRemove:d.useCallback(()=>y(!1),[]),modal:c,children:s})})};cj.displayName=Cm;var dj="PopoverAnchor",lD=d.forwardRef((t,r)=>{const{__scopePopover:s,...n}=t,a=Pi(dj,s),l=Ic(s),{onCustomAnchorAdd:c,onCustomAnchorRemove:u}=a;return d.useEffect(()=>(c(),()=>u()),[c,u]),e.jsx(Nm,{...l,...n,ref:r})});lD.displayName=dj;var uj="PopoverTrigger",mj=d.forwardRef((t,r)=>{const{__scopePopover:s,...n}=t,a=Pi(uj,s),l=Ic(s),c=Ar(r,a.triggerRef),u=e.jsx(vr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":gj(a.open),...n,ref:c,onClick:Zt(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?u:e.jsx(Nm,{asChild:!0,...l,children:u})});mj.displayName=uj;var fh="PopoverPortal",[oD,cD]=oj(fh,{forceMount:void 0}),pj=t=>{const{__scopePopover:r,forceMount:s,children:n,container:a}=t,l=Pi(fh,r);return e.jsx(oD,{scope:r,forceMount:s,children:e.jsx(na,{present:s||l.open,children:e.jsx(Dc,{asChild:!0,container:a,children:n})})})};pj.displayName=fh;var eo="PopoverContent",xj=d.forwardRef((t,r)=>{const s=cD(eo,t.__scopePopover),{forceMount:n=s.forceMount,...a}=t,l=Pi(eo,t.__scopePopover);return e.jsx(na,{present:n||l.open,children:l.modal?e.jsx(uD,{...a,ref:r}):e.jsx(mD,{...a,ref:r})})});xj.displayName=eo;var dD=eD("PopoverContent.RemoveScroll"),uD=d.forwardRef((t,r)=>{const s=Pi(eo,t.__scopePopover),n=d.useRef(null),a=Ar(r,n),l=d.useRef(!1);return d.useEffect(()=>{const c=n.current;if(c)return fm(c)},[]),e.jsx(Lc,{as:dD,allowPinchZoom:!0,children:e.jsx(hj,{...t,ref:a,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Zt(t.onCloseAutoFocus,c=>{c.preventDefault(),l.current||s.triggerRef.current?.focus()}),onPointerDownOutside:Zt(t.onPointerDownOutside,c=>{const u=c.detail.originalEvent,f=u.button===0&&u.ctrlKey===!0,h=u.button===2||f;l.current=h},{checkForDefaultPrevented:!1}),onFocusOutside:Zt(t.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1})})})}),mD=d.forwardRef((t,r)=>{const s=Pi(eo,t.__scopePopover),n=d.useRef(!1),a=d.useRef(!1);return e.jsx(hj,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{t.onCloseAutoFocus?.(l),l.defaultPrevented||(n.current||s.triggerRef.current?.focus(),l.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:l=>{t.onInteractOutside?.(l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const c=l.target;s.triggerRef.current?.contains(c)&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),hj=d.forwardRef((t,r)=>{const{__scopePopover:s,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:l,disableOutsidePointerEvents:c,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:h,onInteractOutside:y,...w}=t,j=Pi(eo,s),C=Ic(s);return xm(),e.jsx(Rc,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:l,children:e.jsx(Oc,{asChild:!0,disableOutsidePointerEvents:c,onInteractOutside:y,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:h,onDismiss:()=>j.onOpenChange(!1),children:e.jsx(oh,{"data-state":gj(j.open),role:"dialog",id:j.contentId,...C,...w,ref:r,style:{...w.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),fj="PopoverClose",pD=d.forwardRef((t,r)=>{const{__scopePopover:s,...n}=t,a=Pi(fj,s);return e.jsx(vr.button,{type:"button",...n,ref:r,onClick:Zt(t.onClick,()=>a.onOpenChange(!1))})});pD.displayName=fj;var xD="PopoverArrow",hD=d.forwardRef((t,r)=>{const{__scopePopover:s,...n}=t,a=Ic(s);return e.jsx(ch,{...a,...n,ref:r})});hD.displayName=xD;function gj(t){return t?"open":"closed"}var fD=cj,yj=mj,gD=pj,vj=xj;function yD({...t}){return e.jsx(fD,{"data-slot":"popover",...t})}const bj=d.forwardRef((t,r)=>e.jsx(yj,{ref:r,"data-slot":"popover-trigger",...t}));bj.displayName=yj.displayName;const wj=d.forwardRef(({className:t,align:r="center",sideOffset:s=4,...n},a)=>e.jsx(gD,{children:e.jsx(vj,{ref:a,"data-slot":"popover-content",align:r,sideOffset:s,className:Nr("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",t),...n})}));wj.displayName=vj.displayName;var dr=function(){return dr=Object.assign||function(r){for(var s,n=1,a=arguments.length;n<a;n++){s=arguments[n];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(r[l]=s[l])}return r},dr.apply(this,arguments)};function vD(t,r){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(s[n[a]]=t[n[a]]);return s}function Nj(t,r,s){for(var n=0,a=r.length,l;n<a;n++)(l||!(n in r))&&(l||(l=Array.prototype.slice.call(r,0,n)),l[n]=r[n]);return t.concat(l||Array.prototype.slice.call(r))}function qc(t){return t.mode==="multiple"}function Bc(t){return t.mode==="range"}function _m(t){return t.mode==="single"}var bD={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function wD(t,r){return Ys(t,"LLLL y",r)}function ND(t,r){return Ys(t,"d",r)}function jD(t,r){return Ys(t,"LLLL",r)}function SD(t){return"".concat(t)}function kD(t,r){return Ys(t,"cccccc",r)}function CD(t,r){return Ys(t,"yyyy",r)}var _D=Object.freeze({__proto__:null,formatCaption:wD,formatDay:ND,formatMonthCaption:jD,formatWeekNumber:SD,formatWeekdayName:kD,formatYearCaption:CD}),ED=function(t,r,s){return Ys(t,"do MMMM (EEEE)",s)},PD=function(){return"Month: "},AD=function(){return"Go to next month"},TD=function(){return"Go to previous month"},OD=function(t,r){return Ys(t,"cccc",r)},RD=function(t){return"Week n. ".concat(t)},DD=function(){return"Year: "},LD=Object.freeze({__proto__:null,labelDay:ED,labelMonthDropdown:PD,labelNext:AD,labelPrevious:TD,labelWeekNumber:RD,labelWeekday:OD,labelYearDropdown:DD});function FD(){var t="buttons",r=bD,s=rj,n={},a={},l=1,c={},u=new Date;return{captionLayout:t,classNames:r,formatters:_D,labels:LD,locale:s,modifiersClassNames:n,modifiers:a,numberOfMonths:l,styles:c,today:u,mode:"default"}}function MD(t){var r=t.fromYear,s=t.toYear,n=t.fromMonth,a=t.toMonth,l=t.fromDate,c=t.toDate;return n?l=un(n):r&&(l=new Date(r,0,1)),a?c=ph(a):s&&(c=new Date(s,11,31)),{fromDate:l?Zl(l):void 0,toDate:c?Zl(c):void 0}}var jj=d.createContext(void 0);function ID(t){var r,s=t.initialProps,n=FD(),a=MD(s),l=a.fromDate,c=a.toDate,u=(r=s.captionLayout)!==null&&r!==void 0?r:n.captionLayout;u!=="buttons"&&(!l||!c)&&(u="buttons");var f;(_m(s)||qc(s)||Bc(s))&&(f=s.onSelect);var h=dr(dr(dr({},n),s),{captionLayout:u,classNames:dr(dr({},n.classNames),s.classNames),components:dr({},s.components),formatters:dr(dr({},n.formatters),s.formatters),fromDate:l,labels:dr(dr({},n.labels),s.labels),mode:s.mode||n.mode,modifiers:dr(dr({},n.modifiers),s.modifiers),modifiersClassNames:dr(dr({},n.modifiersClassNames),s.modifiersClassNames),onSelect:f,styles:dr(dr({},n.styles),s.styles),toDate:c});return e.jsx(jj.Provider,{value:h,children:t.children})}function zr(){var t=d.useContext(jj);if(!t)throw new Error("useDayPicker must be used within a DayPickerProvider.");return t}function Sj(t){var r=zr(),s=r.locale,n=r.classNames,a=r.styles,l=r.formatters.formatCaption;return e.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:t.id,children:l(t.displayMonth,{locale:s})})}function qD(t){return e.jsx("svg",dr({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},t,{children:e.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function kj(t){var r,s,n=t.onChange,a=t.value,l=t.children,c=t.caption,u=t.className,f=t.style,h=zr(),y=(s=(r=h.components)===null||r===void 0?void 0:r.IconDropdown)!==null&&s!==void 0?s:qD;return e.jsxs("div",{className:u,style:f,children:[e.jsx("span",{className:h.classNames.vhidden,children:t["aria-label"]}),e.jsx("select",{name:t.name,"aria-label":t["aria-label"],className:h.classNames.dropdown,style:h.styles.dropdown,value:a,onChange:n,children:l}),e.jsxs("div",{className:h.classNames.caption_label,style:h.styles.caption_label,"aria-hidden":"true",children:[c,e.jsx(y,{className:h.classNames.dropdown_icon,style:h.styles.dropdown_icon})]})]})}function BD(t){var r,s=zr(),n=s.fromDate,a=s.toDate,l=s.styles,c=s.locale,u=s.formatters.formatMonthCaption,f=s.classNames,h=s.components,y=s.labels.labelMonthDropdown;if(!n)return e.jsx(e.Fragment,{});if(!a)return e.jsx(e.Fragment,{});var w=[];if(ZR(n,a))for(var j=un(n),C=n.getMonth();C<=a.getMonth();C++)w.push(B0(j,C));else for(var j=un(new Date),C=0;C<=11;C++)w.push(B0(j,C));var k=function(_){var I=Number(_.target.value),F=B0(un(t.displayMonth),I);t.onChange(F)},S=(r=h?.Dropdown)!==null&&r!==void 0?r:kj;return e.jsx(S,{name:"months","aria-label":y(),className:f.dropdown_month,style:l.dropdown_month,onChange:k,value:t.displayMonth.getMonth(),caption:u(t.displayMonth,{locale:c}),children:w.map(function(_){return e.jsx("option",{value:_.getMonth(),children:u(_,{locale:c})},_.getMonth())})})}function zD(t){var r,s=t.displayMonth,n=zr(),a=n.fromDate,l=n.toDate,c=n.locale,u=n.styles,f=n.classNames,h=n.components,y=n.formatters.formatYearCaption,w=n.labels.labelYearDropdown,j=[];if(!a)return e.jsx(e.Fragment,{});if(!l)return e.jsx(e.Fragment,{});for(var C=a.getFullYear(),k=l.getFullYear(),S=C;S<=k;S++)j.push(nb(ej(new Date),S));var _=function(F){var B=nb(un(s),Number(F.target.value));t.onChange(B)},I=(r=h?.Dropdown)!==null&&r!==void 0?r:kj;return e.jsx(I,{name:"years","aria-label":w(),className:f.dropdown_year,style:u.dropdown_year,onChange:_,value:s.getFullYear(),caption:y(s,{locale:c}),children:j.map(function(F){return e.jsx("option",{value:F.getFullYear(),children:y(F,{locale:c})},F.getFullYear())})})}function $D(t,r){var s=d.useState(t),n=s[0],a=s[1],l=r===void 0?n:r;return[l,a]}function QD(t){var r=t.month,s=t.defaultMonth,n=t.today,a=r||s||n||new Date,l=t.toDate,c=t.fromDate,u=t.numberOfMonths,f=u===void 0?1:u;if(l&&hc(l,a)<0){var h=-1*(f-1);a=ta(l,h)}return c&&hc(a,c)<0&&(a=c),un(a)}function UD(){var t=zr(),r=QD(t),s=$D(r,t.month),n=s[0],a=s[1],l=function(c){var u;if(!t.disableNavigation){var f=un(c);a(f),(u=t.onMonthChange)===null||u===void 0||u.call(t,f)}};return[n,l]}function VD(t,r){for(var s=r.reverseMonths,n=r.numberOfMonths,a=un(t),l=un(ta(a,n)),c=hc(l,a),u=[],f=0;f<c;f++){var h=ta(a,f);u.push(h)}return s&&(u=u.reverse()),u}function WD(t,r){if(!r.disableNavigation){var s=r.toDate,n=r.pagedNavigation,a=r.numberOfMonths,l=a===void 0?1:a,c=n?l:1,u=un(t);if(!s)return ta(u,c);var f=hc(s,t);if(!(f<l))return ta(u,c)}}function GD(t,r){if(!r.disableNavigation){var s=r.fromDate,n=r.pagedNavigation,a=r.numberOfMonths,l=a===void 0?1:a,c=n?l:1,u=un(t);if(!s)return ta(u,-c);var f=hc(u,s);if(!(f<=0))return ta(u,-c)}}var Cj=d.createContext(void 0);function HD(t){var r=zr(),s=UD(),n=s[0],a=s[1],l=VD(n,r),c=WD(n,r),u=GD(n,r),f=function(w){return l.some(function(j){return hh(w,j)})},h=function(w,j){f(w)||(j&&lj(w,j)?a(ta(w,1+r.numberOfMonths*-1)):a(w))},y={currentMonth:n,displayMonths:l,goToMonth:a,goToDate:h,previousMonth:u,nextMonth:c,isDateDisplayed:f};return e.jsx(Cj.Provider,{value:y,children:t.children})}function zc(){var t=d.useContext(Cj);if(!t)throw new Error("useNavigation must be used within a NavigationProvider");return t}function ab(t){var r,s=zr(),n=s.classNames,a=s.styles,l=s.components,c=zc().goToMonth,u=function(y){c(ta(y,t.displayIndex?-t.displayIndex:0))},f=(r=l?.CaptionLabel)!==null&&r!==void 0?r:Sj,h=e.jsx(f,{id:t.id,displayMonth:t.displayMonth});return e.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[e.jsx("div",{className:n.vhidden,children:h}),e.jsx(BD,{onChange:u,displayMonth:t.displayMonth}),e.jsx(zD,{onChange:u,displayMonth:t.displayMonth})]})}function YD(t){return e.jsx("svg",dr({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function KD(t){return e.jsx("svg",dr({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:e.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var Bu=d.forwardRef(function(t,r){var s=zr(),n=s.classNames,a=s.styles,l=[n.button_reset,n.button];t.className&&l.push(t.className);var c=l.join(" "),u=dr(dr({},a.button_reset),a.button);return t.style&&Object.assign(u,t.style),e.jsx("button",dr({},t,{ref:r,type:"button",className:c,style:u}))});function XD(t){var r,s,n=zr(),a=n.dir,l=n.locale,c=n.classNames,u=n.styles,f=n.labels,h=f.labelPrevious,y=f.labelNext,w=n.components;if(!t.nextMonth&&!t.previousMonth)return e.jsx(e.Fragment,{});var j=h(t.previousMonth,{locale:l}),C=[c.nav_button,c.nav_button_previous].join(" "),k=y(t.nextMonth,{locale:l}),S=[c.nav_button,c.nav_button_next].join(" "),_=(r=w?.IconRight)!==null&&r!==void 0?r:KD,I=(s=w?.IconLeft)!==null&&s!==void 0?s:YD;return e.jsxs("div",{className:c.nav,style:u.nav,children:[!t.hidePrevious&&e.jsx(Bu,{name:"previous-month","aria-label":j,className:C,style:u.nav_button_previous,disabled:!t.previousMonth,onClick:t.onPreviousClick,children:a==="rtl"?e.jsx(_,{className:c.nav_icon,style:u.nav_icon}):e.jsx(I,{className:c.nav_icon,style:u.nav_icon})}),!t.hideNext&&e.jsx(Bu,{name:"next-month","aria-label":k,className:S,style:u.nav_button_next,disabled:!t.nextMonth,onClick:t.onNextClick,children:a==="rtl"?e.jsx(I,{className:c.nav_icon,style:u.nav_icon}):e.jsx(_,{className:c.nav_icon,style:u.nav_icon})})]})}function ib(t){var r=zr().numberOfMonths,s=zc(),n=s.previousMonth,a=s.nextMonth,l=s.goToMonth,c=s.displayMonths,u=c.findIndex(function(k){return hh(t.displayMonth,k)}),f=u===0,h=u===c.length-1,y=r>1&&(f||!h),w=r>1&&(h||!f),j=function(){n&&l(n)},C=function(){a&&l(a)};return e.jsx(XD,{displayMonth:t.displayMonth,hideNext:y,hidePrevious:w,nextMonth:a,previousMonth:n,onPreviousClick:j,onNextClick:C})}function JD(t){var r,s=zr(),n=s.classNames,a=s.disableNavigation,l=s.styles,c=s.captionLayout,u=s.components,f=(r=u?.CaptionLabel)!==null&&r!==void 0?r:Sj,h;return a?h=e.jsx(f,{id:t.id,displayMonth:t.displayMonth}):c==="dropdown"?h=e.jsx(ab,{displayMonth:t.displayMonth,id:t.id}):c==="dropdown-buttons"?h=e.jsxs(e.Fragment,{children:[e.jsx(ab,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id}),e.jsx(ib,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id})]}):h=e.jsxs(e.Fragment,{children:[e.jsx(f,{id:t.id,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(ib,{displayMonth:t.displayMonth,id:t.id})]}),e.jsx("div",{className:n.caption,style:l.caption,children:h})}function ZD(t){var r=zr(),s=r.footer,n=r.styles,a=r.classNames.tfoot;return s?e.jsx("tfoot",{className:a,style:n.tfoot,children:e.jsx("tr",{children:e.jsx("td",{colSpan:8,children:s})})}):e.jsx(e.Fragment,{})}function eL(t,r,s){for(var n=s?rl(new Date):ba(new Date,{locale:t,weekStartsOn:r}),a=[],l=0;l<7;l++){var c=Hs(n,l);a.push(c)}return a}function tL(){var t=zr(),r=t.classNames,s=t.styles,n=t.showWeekNumber,a=t.locale,l=t.weekStartsOn,c=t.ISOWeek,u=t.formatters.formatWeekdayName,f=t.labels.labelWeekday,h=eL(a,l,c);return e.jsxs("tr",{style:s.head_row,className:r.head_row,children:[n&&e.jsx("td",{style:s.head_cell,className:r.head_cell}),h.map(function(y,w){return e.jsx("th",{scope:"col",className:r.head_cell,style:s.head_cell,"aria-label":f(y,{locale:a}),children:u(y,{locale:a})},w)})]})}function rL(){var t,r=zr(),s=r.classNames,n=r.styles,a=r.components,l=(t=a?.HeadRow)!==null&&t!==void 0?t:tL;return e.jsx("thead",{style:n.head,className:s.head,children:e.jsx(l,{})})}function sL(t){var r=zr(),s=r.locale,n=r.formatters.formatDay;return e.jsx(e.Fragment,{children:n(t.date,{locale:s})})}var gh=d.createContext(void 0);function nL(t){if(!qc(t.initialProps)){var r={selected:void 0,modifiers:{disabled:[]}};return e.jsx(gh.Provider,{value:r,children:t.children})}return e.jsx(aL,{initialProps:t.initialProps,children:t.children})}function aL(t){var r=t.initialProps,s=t.children,n=r.selected,a=r.min,l=r.max,c=function(h,y,w){var j,C;(j=r.onDayClick)===null||j===void 0||j.call(r,h,y,w);var k=!!(y.selected&&a&&n?.length===a);if(!k){var S=!!(!y.selected&&l&&n?.length===l);if(!S){var _=n?Nj([],n):[];if(y.selected){var I=_.findIndex(function(F){return on(h,F)});_.splice(I,1)}else _.push(h);(C=r.onSelect)===null||C===void 0||C.call(r,_,h,y,w)}}},u={disabled:[]};n&&u.disabled.push(function(h){var y=l&&n.length>l-1,w=n.some(function(j){return on(j,h)});return!!(y&&!w)});var f={selected:n,onDayClick:c,modifiers:u};return e.jsx(gh.Provider,{value:f,children:s})}function yh(){var t=d.useContext(gh);if(!t)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return t}function iL(t,r){var s=r||{},n=s.from,a=s.to;return n&&a?on(a,t)&&on(n,t)?void 0:on(a,t)?{from:a,to:void 0}:on(n,t)?void 0:Sx(n,t)?{from:t,to:a}:{from:n,to:t}:a?Sx(t,a)?{from:a,to:t}:{from:t,to:a}:n?lj(t,n)?{from:t,to:n}:{from:n,to:t}:{from:t,to:void 0}}var vh=d.createContext(void 0);function lL(t){if(!Bc(t.initialProps)){var r={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return e.jsx(vh.Provider,{value:r,children:t.children})}return e.jsx(oL,{initialProps:t.initialProps,children:t.children})}function oL(t){var r=t.initialProps,s=t.children,n=r.selected,a=n||{},l=a.from,c=a.to,u=r.min,f=r.max,h=function(C,k,S){var _,I;(_=r.onDayClick)===null||_===void 0||_.call(r,C,k,S);var F=iL(C,n);(I=r.onSelect)===null||I===void 0||I.call(r,F,C,k,S)},y={range_start:[],range_end:[],range_middle:[],disabled:[]};if(l?(y.range_start=[l],c?(y.range_end=[c],on(l,c)||(y.range_middle=[{after:l,before:c}])):y.range_end=[l]):c&&(y.range_start=[c],y.range_end=[c]),u&&(l&&!c&&y.disabled.push({after:q0(l,u-1),before:Hs(l,u-1)}),l&&c&&y.disabled.push({after:l,before:Hs(l,u-1)}),!l&&c&&y.disabled.push({after:q0(c,u-1),before:Hs(c,u-1)})),f){if(l&&!c&&(y.disabled.push({before:Hs(l,-f+1)}),y.disabled.push({after:Hs(l,f-1)})),l&&c){var w=fa(c,l)+1,j=f-w;y.disabled.push({before:q0(l,j)}),y.disabled.push({after:Hs(c,j)})}!l&&c&&(y.disabled.push({before:Hs(c,-f+1)}),y.disabled.push({after:Hs(c,f-1)}))}return e.jsx(vh.Provider,{value:{selected:n,onDayClick:h,modifiers:y},children:s})}function bh(){var t=d.useContext(vh);if(!t)throw new Error("useSelectRange must be used within a SelectRangeProvider");return t}function Cu(t){return Array.isArray(t)?Nj([],t):t!==void 0?[t]:[]}function cL(t){var r={};return Object.entries(t).forEach(function(s){var n=s[0],a=s[1];r[n]=Cu(a)}),r}var ra;(function(t){t.Outside="outside",t.Disabled="disabled",t.Selected="selected",t.Hidden="hidden",t.Today="today",t.RangeStart="range_start",t.RangeEnd="range_end",t.RangeMiddle="range_middle"})(ra||(ra={}));var dL=ra.Selected,Fa=ra.Disabled,uL=ra.Hidden,mL=ra.Today,z0=ra.RangeEnd,$0=ra.RangeMiddle,Q0=ra.RangeStart,pL=ra.Outside;function xL(t,r,s){var n,a=(n={},n[dL]=Cu(t.selected),n[Fa]=Cu(t.disabled),n[uL]=Cu(t.hidden),n[mL]=[t.today],n[z0]=[],n[$0]=[],n[Q0]=[],n[pL]=[],n);return t.fromDate&&a[Fa].push({before:t.fromDate}),t.toDate&&a[Fa].push({after:t.toDate}),qc(t)?a[Fa]=a[Fa].concat(r.modifiers[Fa]):Bc(t)&&(a[Fa]=a[Fa].concat(s.modifiers[Fa]),a[Q0]=s.modifiers[Q0],a[$0]=s.modifiers[$0],a[z0]=s.modifiers[z0]),a}var _j=d.createContext(void 0);function hL(t){var r=zr(),s=yh(),n=bh(),a=xL(r,s,n),l=cL(r.modifiers),c=dr(dr({},a),l);return e.jsx(_j.Provider,{value:c,children:t.children})}function Ej(){var t=d.useContext(_j);if(!t)throw new Error("useModifiers must be used within a ModifiersProvider");return t}function fL(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function gL(t){return!!(t&&typeof t=="object"&&"from"in t)}function yL(t){return!!(t&&typeof t=="object"&&"after"in t)}function vL(t){return!!(t&&typeof t=="object"&&"before"in t)}function bL(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function wL(t,r){var s,n=r.from,a=r.to;if(n&&a){var l=fa(a,n)<0;l&&(s=[a,n],n=s[0],a=s[1]);var c=fa(t,n)>=0&&fa(a,t)>=0;return c}return a?on(a,t):n?on(n,t):!1}function NL(t){return mh(t)}function jL(t){return Array.isArray(t)&&t.every(mh)}function SL(t,r){return r.some(function(s){if(typeof s=="boolean")return s;if(NL(s))return on(t,s);if(jL(s))return s.includes(t);if(gL(s))return wL(t,s);if(bL(s))return s.dayOfWeek.includes(t.getDay());if(fL(s)){var n=fa(s.before,t),a=fa(s.after,t),l=n>0,c=a<0,u=Sx(s.before,s.after);return u?c&&l:l||c}return yL(s)?fa(t,s.after)>0:vL(s)?fa(s.before,t)>0:typeof s=="function"?s(t):!1})}function wh(t,r,s){var n=Object.keys(r).reduce(function(l,c){var u=r[c];return SL(t,u)&&l.push(c),l},[]),a={};return n.forEach(function(l){return a[l]=!0}),s&&!hh(t,s)&&(a.outside=!0),a}function kL(t,r){for(var s=un(t[0]),n=ph(t[t.length-1]),a,l,c=s;c<=n;){var u=wh(c,r),f=!u.disabled&&!u.hidden;if(!f){c=Hs(c,1);continue}if(u.selected)return c;u.today&&!l&&(l=c),a||(a=c),c=Hs(c,1)}return l||a}var CL=365;function Pj(t,r){var s=r.moveBy,n=r.direction,a=r.context,l=r.modifiers,c=r.retry,u=c===void 0?{count:0,lastFocused:t}:c,f=a.weekStartsOn,h=a.fromDate,y=a.toDate,w=a.locale,j={day:Hs,week:jx,month:ta,year:YO,startOfWeek:function(_){return a.ISOWeek?rl(_):ba(_,{locale:w,weekStartsOn:f})},endOfWeek:function(_){return a.ISOWeek?tj(_):xh(_,{locale:w,weekStartsOn:f})}},C=j[s](t,n==="after"?1:-1);n==="before"&&h?C=KO([h,C]):n==="after"&&y&&(C=XO([y,C]));var k=!0;if(l){var S=wh(C,l);k=!S.disabled&&!S.hidden}return k?C:u.count>CL?u.lastFocused:Pj(C,{moveBy:s,direction:n,context:a,modifiers:l,retry:dr(dr({},u),{count:u.count+1})})}var Aj=d.createContext(void 0);function _L(t){var r=zc(),s=Ej(),n=d.useState(),a=n[0],l=n[1],c=d.useState(),u=c[0],f=c[1],h=kL(r.displayMonths,s),y=a??(u&&r.isDateDisplayed(u))?u:h,w=function(){f(a),l(void 0)},j=function(_){l(_)},C=zr(),k=function(_,I){if(a){var F=Pj(a,{moveBy:_,direction:I,context:C,modifiers:s});on(a,F)||(r.goToDate(F,a),j(F))}},S={focusedDay:a,focusTarget:y,blur:w,focus:j,focusDayAfter:function(){return k("day","after")},focusDayBefore:function(){return k("day","before")},focusWeekAfter:function(){return k("week","after")},focusWeekBefore:function(){return k("week","before")},focusMonthBefore:function(){return k("month","before")},focusMonthAfter:function(){return k("month","after")},focusYearBefore:function(){return k("year","before")},focusYearAfter:function(){return k("year","after")},focusStartOfWeek:function(){return k("startOfWeek","before")},focusEndOfWeek:function(){return k("endOfWeek","after")}};return e.jsx(Aj.Provider,{value:S,children:t.children})}function Nh(){var t=d.useContext(Aj);if(!t)throw new Error("useFocusContext must be used within a FocusProvider");return t}function EL(t,r){var s=Ej(),n=wh(t,s,r);return n}var jh=d.createContext(void 0);function PL(t){if(!_m(t.initialProps)){var r={selected:void 0};return e.jsx(jh.Provider,{value:r,children:t.children})}return e.jsx(AL,{initialProps:t.initialProps,children:t.children})}function AL(t){var r=t.initialProps,s=t.children,n=function(l,c,u){var f,h,y;if((f=r.onDayClick)===null||f===void 0||f.call(r,l,c,u),c.selected&&!r.required){(h=r.onSelect)===null||h===void 0||h.call(r,void 0,l,c,u);return}(y=r.onSelect)===null||y===void 0||y.call(r,l,l,c,u)},a={selected:r.selected,onDayClick:n};return e.jsx(jh.Provider,{value:a,children:s})}function Tj(){var t=d.useContext(jh);if(!t)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return t}function TL(t,r){var s=zr(),n=Tj(),a=yh(),l=bh(),c=Nh(),u=c.focusDayAfter,f=c.focusDayBefore,h=c.focusWeekAfter,y=c.focusWeekBefore,w=c.blur,j=c.focus,C=c.focusMonthBefore,k=c.focusMonthAfter,S=c.focusYearBefore,_=c.focusYearAfter,I=c.focusStartOfWeek,F=c.focusEndOfWeek,B=function(ye){var Q,we,pe,se;_m(s)?(Q=n.onDayClick)===null||Q===void 0||Q.call(n,t,r,ye):qc(s)?(we=a.onDayClick)===null||we===void 0||we.call(a,t,r,ye):Bc(s)?(pe=l.onDayClick)===null||pe===void 0||pe.call(l,t,r,ye):(se=s.onDayClick)===null||se===void 0||se.call(s,t,r,ye)},q=function(ye){var Q;j(t),(Q=s.onDayFocus)===null||Q===void 0||Q.call(s,t,r,ye)},me=function(ye){var Q;w(),(Q=s.onDayBlur)===null||Q===void 0||Q.call(s,t,r,ye)},re=function(ye){var Q;(Q=s.onDayMouseEnter)===null||Q===void 0||Q.call(s,t,r,ye)},M=function(ye){var Q;(Q=s.onDayMouseLeave)===null||Q===void 0||Q.call(s,t,r,ye)},G=function(ye){var Q;(Q=s.onDayPointerEnter)===null||Q===void 0||Q.call(s,t,r,ye)},le=function(ye){var Q;(Q=s.onDayPointerLeave)===null||Q===void 0||Q.call(s,t,r,ye)},Z=function(ye){var Q;(Q=s.onDayTouchCancel)===null||Q===void 0||Q.call(s,t,r,ye)},he=function(ye){var Q;(Q=s.onDayTouchEnd)===null||Q===void 0||Q.call(s,t,r,ye)},ce=function(ye){var Q;(Q=s.onDayTouchMove)===null||Q===void 0||Q.call(s,t,r,ye)},ke=function(ye){var Q;(Q=s.onDayTouchStart)===null||Q===void 0||Q.call(s,t,r,ye)},Ee=function(ye){var Q;(Q=s.onDayKeyUp)===null||Q===void 0||Q.call(s,t,r,ye)},Fe=function(ye){var Q;switch(ye.key){case"ArrowLeft":ye.preventDefault(),ye.stopPropagation(),s.dir==="rtl"?u():f();break;case"ArrowRight":ye.preventDefault(),ye.stopPropagation(),s.dir==="rtl"?f():u();break;case"ArrowDown":ye.preventDefault(),ye.stopPropagation(),h();break;case"ArrowUp":ye.preventDefault(),ye.stopPropagation(),y();break;case"PageUp":ye.preventDefault(),ye.stopPropagation(),ye.shiftKey?S():C();break;case"PageDown":ye.preventDefault(),ye.stopPropagation(),ye.shiftKey?_():k();break;case"Home":ye.preventDefault(),ye.stopPropagation(),I();break;case"End":ye.preventDefault(),ye.stopPropagation(),F();break}(Q=s.onDayKeyDown)===null||Q===void 0||Q.call(s,t,r,ye)},X={onClick:B,onFocus:q,onBlur:me,onKeyDown:Fe,onKeyUp:Ee,onMouseEnter:re,onMouseLeave:M,onPointerEnter:G,onPointerLeave:le,onTouchCancel:Z,onTouchEnd:he,onTouchMove:ce,onTouchStart:ke};return X}function OL(){var t=zr(),r=Tj(),s=yh(),n=bh(),a=_m(t)?r.selected:qc(t)?s.selected:Bc(t)?n.selected:void 0;return a}function RL(t){return Object.values(ra).includes(t)}function DL(t,r){var s=[t.classNames.day];return Object.keys(r).forEach(function(n){var a=t.modifiersClassNames[n];if(a)s.push(a);else if(RL(n)){var l=t.classNames["day_".concat(n)];l&&s.push(l)}}),s}function LL(t,r){var s=dr({},t.styles.day);return Object.keys(r).forEach(function(n){var a;s=dr(dr({},s),(a=t.modifiersStyles)===null||a===void 0?void 0:a[n])}),s}function FL(t,r,s){var n,a,l,c=zr(),u=Nh(),f=EL(t,r),h=TL(t,f),y=OL(),w=!!(c.onDayClick||c.mode!=="default");d.useEffect(function(){var re;f.outside||u.focusedDay&&w&&on(u.focusedDay,t)&&((re=s.current)===null||re===void 0||re.focus())},[u.focusedDay,t,s,w,f.outside]);var j=DL(c,f).join(" "),C=LL(c,f),k=!!(f.outside&&!c.showOutsideDays||f.hidden),S=(l=(a=c.components)===null||a===void 0?void 0:a.DayContent)!==null&&l!==void 0?l:sL,_=e.jsx(S,{date:t,displayMonth:r,activeModifiers:f}),I={style:C,className:j,children:_,role:"gridcell"},F=u.focusTarget&&on(u.focusTarget,t)&&!f.outside,B=u.focusedDay&&on(u.focusedDay,t),q=dr(dr(dr({},I),(n={disabled:f.disabled,role:"gridcell"},n["aria-selected"]=f.selected,n.tabIndex=B||F?0:-1,n)),h),me={isButton:w,isHidden:k,activeModifiers:f,selectedDays:y,buttonProps:q,divProps:I};return me}function ML(t){var r=d.useRef(null),s=FL(t.date,t.displayMonth,r);return s.isHidden?e.jsx("div",{role:"gridcell"}):s.isButton?e.jsx(Bu,dr({name:"day",ref:r},s.buttonProps)):e.jsx("div",dr({},s.divProps))}function IL(t){var r=t.number,s=t.dates,n=zr(),a=n.onWeekNumberClick,l=n.styles,c=n.classNames,u=n.locale,f=n.labels.labelWeekNumber,h=n.formatters.formatWeekNumber,y=h(Number(r),{locale:u});if(!a)return e.jsx("span",{className:c.weeknumber,style:l.weeknumber,children:y});var w=f(Number(r),{locale:u}),j=function(C){a(r,s,C)};return e.jsx(Bu,{name:"week-number","aria-label":w,className:c.weeknumber,style:l.weeknumber,onClick:j,children:y})}function qL(t){var r,s,n=zr(),a=n.styles,l=n.classNames,c=n.showWeekNumber,u=n.components,f=(r=u?.Day)!==null&&r!==void 0?r:ML,h=(s=u?.WeekNumber)!==null&&s!==void 0?s:IL,y;return c&&(y=e.jsx("td",{className:l.cell,style:a.cell,children:e.jsx(h,{number:t.weekNumber,dates:t.dates})})),e.jsxs("tr",{className:l.row,style:a.row,children:[y,t.dates.map(function(w){return e.jsx("td",{className:l.cell,style:a.cell,role:"presentation",children:e.jsx(f,{displayMonth:t.displayMonth,date:w})},KR(w))})]})}function lb(t,r,s){for(var n=s?.ISOWeek?tj(r):xh(r,s),a=s?.ISOWeek?rl(t):ba(t,s),l=fa(n,a),c=[],u=0;u<=l;u++)c.push(Hs(a,u));var f=c.reduce(function(h,y){var w=s?.ISOWeek?sj(y):aj(y,s),j=h.find(function(C){return C.weekNumber===w});return j?(j.dates.push(y),h):(h.push({weekNumber:w,dates:[y]}),h)},[]);return f}function BL(t,r){var s=lb(un(t),ph(t),r);if(r?.useFixedWeeks){var n=JR(t,r);if(n<6){var a=s[s.length-1],l=a.dates[a.dates.length-1],c=jx(l,6-n),u=lb(jx(l,1),c,r);s.push.apply(s,u)}}return s}function zL(t){var r,s,n,a=zr(),l=a.locale,c=a.classNames,u=a.styles,f=a.hideHead,h=a.fixedWeeks,y=a.components,w=a.weekStartsOn,j=a.firstWeekContainsDate,C=a.ISOWeek,k=BL(t.displayMonth,{useFixedWeeks:!!h,ISOWeek:C,locale:l,weekStartsOn:w,firstWeekContainsDate:j}),S=(r=y?.Head)!==null&&r!==void 0?r:rL,_=(s=y?.Row)!==null&&s!==void 0?s:qL,I=(n=y?.Footer)!==null&&n!==void 0?n:ZD;return e.jsxs("table",{id:t.id,className:c.table,style:u.table,role:"grid","aria-labelledby":t["aria-labelledby"],children:[!f&&e.jsx(S,{}),e.jsx("tbody",{className:c.tbody,style:u.tbody,children:k.map(function(F){return e.jsx(_,{displayMonth:t.displayMonth,dates:F.dates,weekNumber:F.weekNumber},F.weekNumber)})}),e.jsx(I,{displayMonth:t.displayMonth})]})}function $L(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var QL=$L()?d.useLayoutEffect:d.useEffect,U0=!1,UL=0;function ob(){return"react-day-picker-".concat(++UL)}function VL(t){var r,s=t??(U0?ob():null),n=d.useState(s),a=n[0],l=n[1];return QL(function(){a===null&&l(ob())},[]),d.useEffect(function(){U0===!1&&(U0=!0)},[]),(r=t??a)!==null&&r!==void 0?r:void 0}function WL(t){var r,s,n=zr(),a=n.dir,l=n.classNames,c=n.styles,u=n.components,f=zc().displayMonths,h=VL(n.id?"".concat(n.id,"-").concat(t.displayIndex):void 0),y=n.id?"".concat(n.id,"-grid-").concat(t.displayIndex):void 0,w=[l.month],j=c.month,C=t.displayIndex===0,k=t.displayIndex===f.length-1,S=!C&&!k;a==="rtl"&&(r=[C,k],k=r[0],C=r[1]),C&&(w.push(l.caption_start),j=dr(dr({},j),c.caption_start)),k&&(w.push(l.caption_end),j=dr(dr({},j),c.caption_end)),S&&(w.push(l.caption_between),j=dr(dr({},j),c.caption_between));var _=(s=u?.Caption)!==null&&s!==void 0?s:JD;return e.jsxs("div",{className:w.join(" "),style:j,children:[e.jsx(_,{id:h,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),e.jsx(zL,{id:y,"aria-labelledby":h,displayMonth:t.displayMonth})]},t.displayIndex)}function GL(t){var r=zr(),s=r.classNames,n=r.styles;return e.jsx("div",{className:s.months,style:n.months,children:t.children})}function HL(t){var r,s,n=t.initialProps,a=zr(),l=Nh(),c=zc(),u=d.useState(!1),f=u[0],h=u[1];d.useEffect(function(){a.initialFocus&&l.focusTarget&&(f||(l.focus(l.focusTarget),h(!0)))},[a.initialFocus,f,l.focus,l.focusTarget,l]);var y=[a.classNames.root,a.className];a.numberOfMonths>1&&y.push(a.classNames.multiple_months),a.showWeekNumber&&y.push(a.classNames.with_weeknumber);var w=dr(dr({},a.styles.root),a.style),j=Object.keys(n).filter(function(k){return k.startsWith("data-")}).reduce(function(k,S){var _;return dr(dr({},k),(_={},_[S]=n[S],_))},{}),C=(s=(r=n.components)===null||r===void 0?void 0:r.Months)!==null&&s!==void 0?s:GL;return e.jsx("div",dr({className:y.join(" "),style:w,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},j,{children:e.jsx(C,{children:c.displayMonths.map(function(k,S){return e.jsx(WL,{displayIndex:S,displayMonth:k},S)})})}))}function YL(t){var r=t.children,s=vD(t,["children"]);return e.jsx(ID,{initialProps:s,children:e.jsx(HD,{children:e.jsx(PL,{initialProps:s,children:e.jsx(nL,{initialProps:s,children:e.jsx(lL,{initialProps:s,children:e.jsx(hL,{children:e.jsx(_L,{children:r})})})})})})})}function KL(t){return e.jsx(YL,dr({},t,{children:e.jsx(HL,{initialProps:t})}))}function cb({className:t,classNames:r,showOutsideDays:s=!0,...n}){return e.jsx(KL,{showOutsideDays:s,className:Nr("p-3",t),classNames:{months:"flex flex-col sm:flex-row gap-2",month:"flex flex-col gap-4",caption:"flex justify-center pt-1 relative items-center w-full",caption_label:"text-sm font-medium",nav:"flex items-center gap-1",nav_button:Nr(Tu({variant:"outline"}),"size-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-x-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:Nr("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-range-end)]:rounded-r-md",n.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:Nr(Tu({variant:"ghost"}),"size-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start aria-selected:bg-primary aria-selected:text-primary-foreground",day_range_end:"day-range-end aria-selected:bg-primary aria-selected:text-primary-foreground",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:({className:a,...l})=>e.jsx(K1,{className:Nr("size-4",a),...l}),IconRight:({className:a,...l})=>e.jsx(X1,{className:Nr("size-4",a),...l})},...n})}function us({currentStage:t,searchTerm:r,setSearchTerm:s,assemblyLineFilter:n,setAssemblyLineFilter:a,dateFilterMode:l,setDateFilterMode:c,dateFrom:u,setDateFrom:f,dateTo:h,setDateTo:y,assemblyLines:w,onClearFilters:j,hasActiveFilters:C,disableAssemblyFilter:k}){const[S,_]=d.useState(!1),I=["assembly-a","assembly-b","assembly-c","assembly-d"];d.useEffect(()=>{t&&I.includes(t)&&a(t)},[t,a]);const F=I.includes(t||"")?[t]:w,B=()=>{if(l==="year"&&u)return Ys(u,"yyyy");if(l==="month"&&u)return Ys(u,"MMMM yyyy");if(l==="range"){if(u&&h)return`${Ys(u,"MMM dd, yyyy")}  ${Ys(h,"MMM dd, yyyy")}`;if(u)return`From ${Ys(u,"MMM dd, yyyy")}`;if(h)return`Until ${Ys(h,"MMM dd, yyyy")}`}return"Select date"},q=new Date().getFullYear(),me=Array.from({length:6},(M,G)=>q-G),re=[{value:0,label:"January"},{value:1,label:"February"},{value:2,label:"March"},{value:3,label:"April"},{value:4,label:"May"},{value:5,label:"June"},{value:6,label:"July"},{value:7,label:"August"},{value:8,label:"September"},{value:9,label:"October"},{value:10,label:"November"},{value:11,label:"December"}];return e.jsxs("div",{className:"bg-white border border-[#174a9f]/20 rounded-xl p-5 shadow-sm",children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(rw,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 z-10 pointer-events-none text-gray-400"}),e.jsx(Xr,{type:"text",placeholder:"Search by Unique Code, SOA No, Party, PO No, Code No, Product...",value:r,onChange:M=>s(M.target.value),className:"pl-10 w-full bg-white/80 backdrop-blur-sm border-gray-200/60 relative z-0 "})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4 border-b pb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#174a9f]",children:[e.jsx(x4,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Advanced Filters"})]}),e.jsx(ee,{variant:"ghost",size:"sm",onClick:()=>_(M=>!M),children:S?e.jsx(J1,{}):e.jsx($x,{})})]}),S&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[#174a9f]/70 pl-1",children:"Assembly Line"}),e.jsxs(ts,{value:n,onValueChange:a,disabled:k,children:[e.jsx(ss,{className:"h-10 bg-white/90 backdrop-blur-sm border-2 border-[#174a9f]/20 hover:border-[#174a9f]/40 focus:border-[#174a9f] transition-all duration-200 shadow-sm hover:shadow-md",children:e.jsx(rs,{placeholder:"Select Assembly"})}),e.jsxs(ns,{children:[!I.includes(t||"")&&e.jsx(Pr,{value:"all",children:"All"}),F.map(M=>e.jsx(Pr,{value:M,children:M.replace("assembly-","").toUpperCase()},M))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-[#174a9f]/70 pl-1",children:"Date Filter Type"}),e.jsxs(ts,{value:l,onValueChange:M=>{if(c(M),M==="year"){const G=new Date(q,0,1);f(G),y(new Date(q,11,31))}if(M==="month"){const G=new Date(q,new Date().getMonth(),1);f(G),y(new Date(G.getFullYear(),G.getMonth()+1,0))}M==="range"&&(f(void 0),y(void 0))},children:[e.jsx(ss,{className:"h-10 bg-white/90 backdrop-blur-sm border-2 border-[#174a9f]/20 hover:border-[#174a9f]/40 focus:border-[#174a9f] transition-all duration-200 shadow-sm hover:shadow-md",children:e.jsx(rs,{})}),e.jsxs(ns,{children:[e.jsx(Pr,{value:"year",children:"Year"}),e.jsx(Pr,{value:"month",children:"Month"}),e.jsx(Pr,{value:"range",children:"Range"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-xs text-[#174a9f]/70 pl-1",children:[l==="year"&&"Select Year",l==="month"&&"Select Month",l==="range"&&"Select Date Range"]}),e.jsxs(yD,{children:[e.jsx(bj,{asChild:!0,children:e.jsxs(ee,{variant:"outline",className:"h-10 w-full justify-start text-left bg-white/90 backdrop-blur-sm border-2 border-[#174a9f]/20 hover:border-[#174a9f]/40 hover:bg-white transition-all duration-200 shadow-sm hover:shadow-md",children:[e.jsx(IE,{className:"mr-2 h-4 w-4 text-[#174a9f]/70"}),e.jsx("span",{className:!u&&!h?"text-gray-500":"",children:B()})]})}),e.jsxs(wj,{className:"w-auto p-0 border-2 border-[#174a9f]/20",align:"start",children:[l==="year"&&e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("div",{className:"text-sm text-[#174a9f] mb-3",children:"Select Year"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:me.map(M=>e.jsx(ee,{variant:"outline",className:`h-10 ${u&&Ys(u,"yyyy")===M.toString()?"bg-[#174a9f] text-white hover:bg-[#174a9f]/90":"hover:bg-[#174a9f]/10"}`,onClick:()=>{const G=new Date(M,0,1);f(G),y(new Date(M,11,31))},children:M},M))})]}),l==="month"&&e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"text-sm text-[#174a9f] mb-2",children:"Select Month & Year"}),e.jsxs(ts,{value:u?Ys(u,"yyyy"):q.toString(),onValueChange:M=>{const G=parseInt(M),le=u?u.getMonth():0,Z=new Date(G,le,1);f(Z);const he=new Date(G,le+1,0).getDate();y(new Date(G,le,he))},children:[e.jsx(ss,{className:"w-full",children:e.jsx(rs,{})}),e.jsx(ns,{children:me.map(M=>e.jsx(Pr,{value:M.toString(),children:M},M))})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:re.map(({value:M,label:G})=>{const le=u?u.getFullYear():q,Z=u&&u.getMonth()===M&&u.getFullYear()===le;return e.jsx(ee,{variant:"outline",className:`h-9 text-xs ${Z?"bg-[#174a9f] text-white hover:bg-[#174a9f]/90":"hover:bg-[#174a9f]/10"}`,onClick:()=>{const he=new Date(le,M,1);f(he);const ce=new Date(le,M+1,0).getDate();y(new Date(le,M,ce))},children:G.slice(0,3)},M)})})]}),l==="range"&&e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"text-sm text-[#174a9f] mb-4",children:"Select Date Range"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-[#174a9f]/70 px-1",children:"Start Date"}),e.jsx(cb,{mode:"single",selected:u,onSelect:f,initialFocus:!0,defaultMonth:u??new Date})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-[#174a9f]/70 px-1",children:"End Date"}),e.jsx(cb,{mode:"single",selected:h,onSelect:y,disabled:M=>u?M<u:!1,defaultMonth:h||(u?new Date(u.getFullYear(),u.getMonth()+1,1):new Date(new Date().getFullYear(),new Date().getMonth()+1,1))})]})]})]})]})]})]})]}),C&&e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs(ee,{variant:"ghost",size:"sm",onClick:j,children:[e.jsx(Qx,{className:"h-4 w-4 mr-1"}),"Clear Filters"]})})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var zu={};zu.version="0.18.5";var Oj=1252,XL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Rj=function(t){XL.indexOf(t)!=-1&&(Oj=t)};function JL(){Rj(1252)}var fc=function(t){Rj(t)};function ZL(){fc(1200),JL()}var cu=function(r){return String.fromCharCode(r)},db=function(r){return String.fromCharCode(r)},$u,vi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function gc(t){for(var r="",s=0,n=0,a=0,l=0,c=0,u=0,f=0,h=0;h<t.length;)s=t.charCodeAt(h++),l=s>>2,n=t.charCodeAt(h++),c=(s&3)<<4|n>>4,a=t.charCodeAt(h++),u=(n&15)<<2|a>>6,f=a&63,isNaN(n)?u=f=64:isNaN(a)&&(f=64),r+=vi.charAt(l)+vi.charAt(c)+vi.charAt(u)+vi.charAt(f);return r}function Va(t){var r="",s=0,n=0,a=0,l=0,c=0,u=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)l=vi.indexOf(t.charAt(h++)),c=vi.indexOf(t.charAt(h++)),s=l<<2|c>>4,r+=String.fromCharCode(s),u=vi.indexOf(t.charAt(h++)),n=(c&15)<<4|u>>2,u!==64&&(r+=String.fromCharCode(n)),f=vi.indexOf(t.charAt(h++)),a=(u&3)<<6|f,f!==64&&(r+=String.fromCharCode(a));return r}var Er=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ha=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,s){return s?new Buffer(r,s):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function sl(t){return Er?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function ub(t){return Er?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Hn=function(r){return Er?Ha(r,"binary"):r.split("").map(function(s){return s.charCodeAt(0)&255})};function Em(t){if(typeof ArrayBuffer>"u")return Hn(t);for(var r=new ArrayBuffer(t.length),s=new Uint8Array(r),n=0;n!=t.length;++n)s[n]=t.charCodeAt(n)&255;return r}function $c(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],s=0;s<t.length;++s)r[s]=String.fromCharCode(t[s]);return r.join("")}function e9(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var Ds=Er?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:Ha(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,s=0;for(r=0;r<t.length;++r)s+=t[r].length;var n=new Uint8Array(s),a=0;for(r=0,s=0;r<t.length;s+=a,++r)if(a=t[r].length,t[r]instanceof Uint8Array)n.set(t[r],s);else{if(typeof t[r]=="string")throw"wtf";n.set(new Uint8Array(t[r]),s)}return n}return[].concat.apply([],t.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function t9(t){for(var r=[],s=0,n=t.length+250,a=sl(t.length+255),l=0;l<t.length;++l){var c=t.charCodeAt(l);if(c<128)a[s++]=c;else if(c<2048)a[s++]=192|c>>6&31,a[s++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=t.charCodeAt(++l)&1023;a[s++]=240|c>>8&7,a[s++]=128|c>>2&63,a[s++]=128|u>>6&15|(c&3)<<4,a[s++]=128|u&63}else a[s++]=224|c>>12&15,a[s++]=128|c>>6&63,a[s++]=128|c&63;s>n&&(r.push(a.slice(0,s)),s=0,a=sl(65535),n=65530)}return r.push(a.slice(0,s)),Ds(r)}var ic=/\u0000/g,du=/[\u0001-\u0006]/g;function Gl(t){for(var r="",s=t.length-1;s>=0;)r+=t.charAt(s--);return r}function Yn(t,r){var s=""+t;return s.length>=r?s:es("0",r-s.length)+s}function Sh(t,r){var s=""+t;return s.length>=r?s:es(" ",r-s.length)+s}function Qu(t,r){var s=""+t;return s.length>=r?s:s+es(" ",r-s.length)}function r9(t,r){var s=""+Math.round(t);return s.length>=r?s:es("0",r-s.length)+s}function s9(t,r){var s=""+t;return s.length>=r?s:es("0",r-s.length)+s}var mb=Math.pow(2,32);function Bl(t,r){if(t>mb||t<-mb)return r9(t,r);var s=Math.round(t);return s9(s,r)}function Uu(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var pb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],V0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function n9(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var as={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},xb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},a9={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Vu(t,r,s){for(var n=t<0?-1:1,a=t*n,l=0,c=1,u=0,f=1,h=0,y=0,w=Math.floor(a);h<r&&(w=Math.floor(a),u=w*c+l,y=w*h+f,!(a-w<5e-8));)a=1/(a-w),l=c,c=u,f=h,h=y;if(y>r&&(h>r?(y=f,u=l):(y=h,u=c)),!s)return[0,n*u,y];var j=Math.floor(n*u/y);return[j,n*u-j*y,y]}function uu(t,r,s){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),l=0,c=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),r&&r.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)c=s?[1317,10,29]:[1900,2,29],l=3;else if(n===0)c=s?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),c=[f.getFullYear(),f.getMonth()+1,f.getDate()],l=f.getDay(),n<60&&(l=(l+6)%7),s&&(l=m9(f,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=l,u}var Dj=new Date(1899,11,31,0,0,0),i9=Dj.getTime(),l9=new Date(1900,2,1,0,0,0);function Lj(t,r){var s=t.getTime();return r?s-=1461*24*60*60*1e3:t>=l9&&(s+=1440*60*1e3),(s-(i9+(t.getTimezoneOffset()-Dj.getTimezoneOffset())*6e4))/(1440*60*1e3)}function kh(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function o9(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function c9(t){var r=t<0?12:11,s=kh(t.toFixed(12));return s.length<=r||(s=t.toPrecision(10),s.length<=r)?s:t.toExponential(5)}function d9(t){var r=kh(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function u9(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),s;return r>=-4&&r<=-1?s=t.toPrecision(10+r):Math.abs(r)<=9?s=c9(t):r===10?s=t.toFixed(10).substr(0,12):s=d9(t),kh(o9(s.toUpperCase()))}function kx(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):u9(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Si(14,Lj(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function m9(t,r){r[0]-=581;var s=t.getDay();return t<60&&(s=(s+6)%7),s}function p9(t,r,s,n){var a="",l=0,c=0,u=s.y,f,h=0;switch(t){case 98:u=s.y+543;case 121:switch(r.length){case 1:case 2:f=u%100,h=2;break;default:f=u%1e4,h=4;break}break;case 109:switch(r.length){case 1:case 2:f=s.m,h=r.length;break;case 3:return V0[s.m-1][1];case 5:return V0[s.m-1][0];default:return V0[s.m-1][2]}break;case 100:switch(r.length){case 1:case 2:f=s.d,h=r.length;break;case 3:return pb[s.q][0];default:return pb[s.q][1]}break;case 104:switch(r.length){case 1:case 2:f=1+(s.H+11)%12,h=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:f=s.H,h=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:f=s.M,h=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return s.u===0&&(r=="s"||r=="ss")?Yn(s.S,r.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,l=Math.round(c*(s.S+s.u)),l>=60*c&&(l=0),r==="s"?l===0?"0":""+l/c:(a=Yn(l,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":f=s.D*24+s.H;break;case"[m]":case"[mm]":f=(s.D*24+s.H)*60+s.M;break;case"[s]":case"[ss]":f=((s.D*24+s.H)*60+s.M)*60+Math.round(s.S+s.u);break;default:throw"bad abstime format: "+r}h=r.length===3?1:2;break;case 101:f=u,h=1;break}var y=h>0?Yn(f,h):"";return y}function bi(t){var r=3;if(t.length<=r)return t;for(var s=t.length%r,n=t.substr(0,s);s!=t.length;s+=r)n+=(n.length>0?",":"")+t.substr(s,r);return n}var Fj=/%/g;function x9(t,r,s){var n=r.replace(Fj,""),a=r.length-n.length;return qa(t,n,s*Math.pow(10,2*a))+es("%",a)}function h9(t,r,s){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return qa(t,r.substr(0,n),s/Math.pow(10,3*(r.length-n)))}function Mj(t,r){var s,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Mj(t,-r);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%a;if(l<0&&(l+=a),s=(r/Math.pow(10,l)).toPrecision(n+1+(a+l)%a),s.indexOf("e")===-1){var c=Math.floor(Math.log(r)*Math.LOG10E);for(s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(c-s.length+l):s+="E+"+(c-l);s.substr(0,2)==="0.";)s=s.charAt(0)+s.substr(2,a)+"."+s.substr(2+a),s=s.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,h,y){return f+h+y.substr(0,(a+l)%a)+"."+y.substr(l)+"E"})}else s=r.toExponential(n);return t.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),t.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}var Ij=/# (\?+)( ?)\/( ?)(\d+)/;function f9(t,r,s){var n=parseInt(t[4],10),a=Math.round(r*n),l=Math.floor(a/n),c=a-l*n,u=n;return s+(l===0?"":""+l)+" "+(c===0?es(" ",t[1].length+1+t[4].length):Sh(c,t[1].length)+t[2]+"/"+t[3]+Yn(u,t[4].length))}function g9(t,r,s){return s+(r===0?"":""+r)+es(" ",t[1].length+2+t[4].length)}var qj=/^#*0*\.([0#]+)/,Bj=/\).*[0#]/,zj=/\(###\) ###\\?-####/;function Ks(t){for(var r="",s,n=0;n!=t.length;++n)switch(s=t.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(s)}return r}function hb(t,r){var s=Math.pow(10,r);return""+Math.round(t*s)/s}function fb(t,r){var s=t-Math.floor(t),n=Math.pow(10,r);return r<(""+Math.round(s*n)).length?0:Math.round(s*n)}function y9(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function v9(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ln(t,r,s){if(t.charCodeAt(0)===40&&!r.match(Bj)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?Ln("n",n,s):"("+Ln("n",n,-s)+")"}if(r.charCodeAt(r.length-1)===44)return h9(t,r,s);if(r.indexOf("%")!==-1)return x9(t,r,s);if(r.indexOf("E")!==-1)return Mj(r,s);if(r.charCodeAt(0)===36)return"$"+Ln(t,r.substr(r.charAt(1)==" "?2:1),s);var a,l,c,u,f=Math.abs(s),h=s<0?"-":"";if(r.match(/^00+$/))return h+Bl(f,r.length);if(r.match(/^[#?]+$/))return a=Bl(s,0),a==="0"&&(a=""),a.length>r.length?a:Ks(r.substr(0,r.length-a.length))+a;if(l=r.match(Ij))return f9(l,f,h);if(r.match(/^#+0+$/))return h+Bl(f,r.length-r.indexOf("0"));if(l=r.match(qj))return a=hb(s,l[1].length).replace(/^([^\.]+)$/,"$1."+Ks(l[1])).replace(/\.$/,"."+Ks(l[1])).replace(/\.(\d*)$/,function(k,S){return"."+S+es("0",Ks(l[1]).length-S.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return h+hb(f,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return h+bi(Bl(f,0));if(l=r.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+Ln(t,r,-s):bi(""+(Math.floor(s)+y9(s,l[1].length)))+"."+Yn(fb(s,l[1].length),l[1].length);if(l=r.match(/^#,#*,#0/))return Ln(t,r.replace(/^#,#*,/,""),s);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Gl(Ln(t,r.replace(/[\\-]/g,""),s)),c=0,Gl(Gl(r.replace(/\\/g,"")).replace(/[0#]/g,function(k){return c<a.length?a.charAt(c++):k==="0"?"0":""}));if(r.match(zj))return a=Ln(t,"##########",s),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var y="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=Vu(f,Math.pow(10,c)-1,!1),a=""+h,y=qa("n",l[1],u[1]),y.charAt(y.length-1)==" "&&(y=y.substr(0,y.length-1)+"0"),a+=y+l[2]+"/"+l[3],y=Qu(u[2],c),y.length<l[4].length&&(y=Ks(l[4].substr(l[4].length-y.length))+y),a+=y,a;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=Vu(f,Math.pow(10,c)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Sh(u[1],c)+l[2]+"/"+l[3]+Qu(u[2],c):es(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return a=Bl(s,0),r.length<=a.length?a:Ks(r.substr(0,r.length-a.length))+a;if(l=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+s.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var w=r.indexOf(".")-c,j=r.length-a.length-w;return Ks(r.substr(0,w)+a+r.substr(r.length-j))}if(l=r.match(/^00,000\.([#0]*0)$/))return c=fb(s,l[1].length),s<0?"-"+Ln(t,r,-s):bi(v9(s)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?Yn(0,3-k.length):"")+k})+"."+Yn(c,l[1].length);switch(r){case"###,##0.00":return Ln(t,"#,##0.00",s);case"###,###":case"##,###":case"#,###":var C=bi(Bl(f,0));return C!=="0"?h+C:"";case"###,###.00":return Ln(t,"###,##0.00",s).replace(/^0\./,".");case"#,###.00":return Ln(t,"#,##0.00",s).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function b9(t,r,s){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return qa(t,r.substr(0,n),s/Math.pow(10,3*(r.length-n)))}function w9(t,r,s){var n=r.replace(Fj,""),a=r.length-n.length;return qa(t,n,s*Math.pow(10,2*a))+es("%",a)}function $j(t,r){var s,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+$j(t,-r);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%a;if(l<0&&(l+=a),s=(r/Math.pow(10,l)).toPrecision(n+1+(a+l)%a),!s.match(/[Ee]/)){var c=Math.floor(Math.log(r)*Math.LOG10E);s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(c-s.length+l):s+="E+"+(c-l),s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,h,y){return f+h+y.substr(0,(a+l)%a)+"."+y.substr(l)+"E"})}else s=r.toExponential(n);return t.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),t.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}function ma(t,r,s){if(t.charCodeAt(0)===40&&!r.match(Bj)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?ma("n",n,s):"("+ma("n",n,-s)+")"}if(r.charCodeAt(r.length-1)===44)return b9(t,r,s);if(r.indexOf("%")!==-1)return w9(t,r,s);if(r.indexOf("E")!==-1)return $j(r,s);if(r.charCodeAt(0)===36)return"$"+ma(t,r.substr(r.charAt(1)==" "?2:1),s);var a,l,c,u,f=Math.abs(s),h=s<0?"-":"";if(r.match(/^00+$/))return h+Yn(f,r.length);if(r.match(/^[#?]+$/))return a=""+s,s===0&&(a=""),a.length>r.length?a:Ks(r.substr(0,r.length-a.length))+a;if(l=r.match(Ij))return g9(l,f,h);if(r.match(/^#+0+$/))return h+Yn(f,r.length-r.indexOf("0"));if(l=r.match(qj))return a=(""+s).replace(/^([^\.]+)$/,"$1."+Ks(l[1])).replace(/\.$/,"."+Ks(l[1])),a=a.replace(/\.(\d*)$/,function(k,S){return"."+S+es("0",Ks(l[1]).length-S.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return h+bi(""+f);if(l=r.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+ma(t,r,-s):bi(""+s)+"."+es("0",l[1].length);if(l=r.match(/^#,#*,#0/))return ma(t,r.replace(/^#,#*,/,""),s);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Gl(ma(t,r.replace(/[\\-]/g,""),s)),c=0,Gl(Gl(r.replace(/\\/g,"")).replace(/[0#]/g,function(k){return c<a.length?a.charAt(c++):k==="0"?"0":""}));if(r.match(zj))return a=ma(t,"##########",s),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var y="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),u=Vu(f,Math.pow(10,c)-1,!1),a=""+h,y=qa("n",l[1],u[1]),y.charAt(y.length-1)==" "&&(y=y.substr(0,y.length-1)+"0"),a+=y+l[2]+"/"+l[3],y=Qu(u[2],c),y.length<l[4].length&&(y=Ks(l[4].substr(l[4].length-y.length))+y),a+=y,a;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),u=Vu(f,Math.pow(10,c)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Sh(u[1],c)+l[2]+"/"+l[3]+Qu(u[2],c):es(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return a=""+s,r.length<=a.length?a:Ks(r.substr(0,r.length-a.length))+a;if(l=r.match(/^([#0]+)\.([#0]+)$/)){a=""+s.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var w=r.indexOf(".")-c,j=r.length-a.length-w;return Ks(r.substr(0,w)+a+r.substr(r.length-j))}if(l=r.match(/^00,000\.([#0]*0)$/))return s<0?"-"+ma(t,r,-s):bi(""+s).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(k){return"00,"+(k.length<3?Yn(0,3-k.length):"")+k})+"."+Yn(0,l[1].length);switch(r){case"###,###":case"##,###":case"#,###":var C=bi(""+f);return C!=="0"?h+C:"";default:if(r.match(/\.[0#?]*$/))return ma(t,r.slice(0,r.lastIndexOf(".")),s)+Ks(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function qa(t,r,s){return(s|0)===s?ma(t,r,s):Ln(t,r,s)}function N9(t){for(var r=[],s=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:s=!s;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=t.substr(a,n-a),a=n+1}if(r[r.length]=t.substr(a),s===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var Qj=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Uj(t){for(var r=0,s="",n="";r<t.length;)switch(s=t.charAt(r)){case"G":Uu(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=s;t.charAt(r++)!=="]"&&r<t.length;)n+=t.charAt(r);if(n.match(Qj))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(s=t.charAt(++r))>-1||s=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===s;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function j9(t,r,s,n){for(var a=[],l="",c=0,u="",f="t",h,y,w,j="H";c<t.length;)switch(u=t.charAt(c)){case"G":if(!Uu(t,c))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(w=t.charCodeAt(++c))!==34&&c<t.length;)l+=String.fromCharCode(w);a[a.length]={t:"t",v:l},++c;break;case"\\":var C=t.charAt(++c),k=C==="("||C===")"?C:"t";a[a.length]={t:k,v:C},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:r},++c;break;case"B":case"b":if(t.charAt(c+1)==="1"||t.charAt(c+1)==="2"){if(h==null&&(h=uu(r,s,t.charAt(c+1)==="2"),h==null))return"";a[a.length]={t:"X",v:t.substr(c,2)},f=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||h==null&&(h=uu(r,s),h==null))return"";for(l=u;++c<t.length&&t.charAt(c).toLowerCase()===u;)l+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=j),a[a.length]={t:u,v:l},f=u;break;case"A":case"a":case"":var S={t:u,v:u};if(h==null&&(h=uu(r,s)),t.substr(c,3).toUpperCase()==="A/P"?(h!=null&&(S.v=h.H>=12?"P":"A"),S.t="T",j="h",c+=3):t.substr(c,5).toUpperCase()==="AM/PM"?(h!=null&&(S.v=h.H>=12?"PM":"AM"),S.t="T",c+=5,j="h"):t.substr(c,5).toUpperCase()==="/"?(h!=null&&(S.v=h.H>=12?"":""),S.t="T",c+=5,j="h"):(S.t="t",++c),h==null&&S.t==="T")return"";a[a.length]=S,f=u;break;case"[":for(l=u;t.charAt(c++)!=="]"&&c<t.length;)l+=t.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Qj)){if(h==null&&(h=uu(r,s),h==null))return"";a[a.length]={t:"Z",v:l.toLowerCase()},f=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Uj(t)||(a[a.length]={t:"t",v:l}));break;case".":if(h!=null){for(l=u;++c<t.length&&(u=t.charAt(c))==="0";)l+=u;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(c))>-1;)l+=u;a[a.length]={t:"n",v:l};break;case"?":for(l=u;t.charAt(++c)===u;)l+=u;a[a.length]={t:u,v:l},f=u;break;case"*":++c,(t.charAt(c)==" "||t.charAt(c)=="*")&&++c;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<t.length&&"0123456789".indexOf(t.charAt(++c))>-1;)l+=t.charAt(c);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++c;break}var _=0,I=0,F;for(c=a.length-1,f="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=j,f="h",_<1&&(_=1);break;case"s":(F=a[c].v.match(/\.0+$/))&&(I=Math.max(I,F[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":f=a[c].t;break;case"m":f==="s"&&(a[c].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[c].v.match(/[Hh]/)&&(_=1),_<2&&a[c].v.match(/[Mm]/)&&(_=2),_<3&&a[c].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var B="",q;for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=p9(a[c].t.charCodeAt(0),a[c].v,h,I),a[c].t="t";break;case"n":case"?":for(q=c+1;a[q]!=null&&((u=a[q].t)==="?"||u==="D"||(u===" "||u==="t")&&a[q+1]!=null&&(a[q+1].t==="?"||a[q+1].t==="t"&&a[q+1].v==="/")||a[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[q].v==="/"||a[q].v===" "&&a[q+1]!=null&&a[q+1].t=="?"));)a[c].v+=a[q].v,a[q]={v:"",t:";"},++q;B+=a[c].v,c=q-1;break;case"G":a[c].t="t",a[c].v=kx(r,s);break}var me="",re,M;if(B.length>0){B.charCodeAt(0)==40?(re=r<0&&B.charCodeAt(0)===45?-r:r,M=qa("n",B,re)):(re=r<0&&n>1?-r:r,M=qa("n",B,re),re<0&&a[0]&&a[0].t=="t"&&(M=M.substr(1),a[0].v="-"+a[0].v)),q=M.length-1;var G=a.length;for(c=0;c<a.length;++c)if(a[c]!=null&&a[c].t!="t"&&a[c].v.indexOf(".")>-1){G=c;break}var le=a.length;if(G===a.length&&M.indexOf("E")===-1){for(c=a.length-1;c>=0;--c)a[c]==null||"n?".indexOf(a[c].t)===-1||(q>=a[c].v.length-1?(q-=a[c].v.length,a[c].v=M.substr(q+1,a[c].v.length)):q<0?a[c].v="":(a[c].v=M.substr(0,q+1),q=-1),a[c].t="t",le=c);q>=0&&le<a.length&&(a[le].v=M.substr(0,q+1)+a[le].v)}else if(G!==a.length&&M.indexOf("E")===-1){for(q=M.indexOf(".")-1,c=G;c>=0;--c)if(!(a[c]==null||"n?".indexOf(a[c].t)===-1)){for(y=a[c].v.indexOf(".")>-1&&c===G?a[c].v.indexOf(".")-1:a[c].v.length-1,me=a[c].v.substr(y+1);y>=0;--y)q>=0&&(a[c].v.charAt(y)==="0"||a[c].v.charAt(y)==="#")&&(me=M.charAt(q--)+me);a[c].v=me,a[c].t="t",le=c}for(q>=0&&le<a.length&&(a[le].v=M.substr(0,q+1)+a[le].v),q=M.indexOf(".")+1,c=G;c<a.length;++c)if(!(a[c]==null||"n?(".indexOf(a[c].t)===-1&&c!==G)){for(y=a[c].v.indexOf(".")>-1&&c===G?a[c].v.indexOf(".")+1:0,me=a[c].v.substr(0,y);y<a[c].v.length;++y)q<M.length&&(me+=M.charAt(q++));a[c].v=me,a[c].t="t",le=c}}}for(c=0;c<a.length;++c)a[c]!=null&&"n?".indexOf(a[c].t)>-1&&(re=n>1&&r<0&&c>0&&a[c-1].v==="-"?-r:r,a[c].v=qa(a[c].t,a[c].v,re),a[c].t="t");var Z="";for(c=0;c!==a.length;++c)a[c]!=null&&(Z+=a[c].v);return Z}var gb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function yb(t,r){if(r==null)return!1;var s=parseFloat(r[2]);switch(r[1]){case"=":if(t==s)return!0;break;case">":if(t>s)return!0;break;case"<":if(t<s)return!0;break;case"<>":if(t!=s)return!0;break;case">=":if(t>=s)return!0;break;case"<=":if(t<=s)return!0;break}return!1}function S9(t,r){var s=N9(t),n=s.length,a=s[n-1].indexOf("@");if(n<4&&a>-1&&--n,s.length>4)throw new Error("cannot find right format for |"+s.join("|")+"|");if(typeof r!="number")return[4,s.length===4||a>-1?s[s.length-1]:"@"];switch(s.length){case 1:s=a>-1?["General","General","General",s[0]]:[s[0],s[0],s[0],"@"];break;case 2:s=a>-1?[s[0],s[0],s[0],s[1]]:[s[0],s[1],s[0],"@"];break;case 3:s=a>-1?[s[0],s[1],s[0],s[2]]:[s[0],s[1],s[2],"@"];break}var l=r>0?s[0]:r<0?s[1]:s[2];if(s[0].indexOf("[")===-1&&s[1].indexOf("[")===-1)return[n,l];if(s[0].match(/\[[=<>]/)!=null||s[1].match(/\[[=<>]/)!=null){var c=s[0].match(gb),u=s[1].match(gb);return yb(r,c)?[n,s[0]]:yb(r,u)?[n,s[1]]:[n,s[c!=null&&u!=null?2:1]]}return[n,l]}function Si(t,r,s){s==null&&(s={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&s.dateNF?n=s.dateNF:n=t;break;case"number":t==14&&s.dateNF?n=s.dateNF:n=(s.table!=null?s.table:as)[t],n==null&&(n=s.table&&s.table[xb[t]]||as[xb[t]]),n==null&&(n=a9[t]||"General");break}if(Uu(n,0))return kx(r,s);r instanceof Date&&(r=Lj(r,s.date1904));var a=S9(n,r);if(Uu(a[1]))return kx(r,s);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return j9(a[1],r,s,a[0])}function Vj(t,r){if(typeof r!="number"){r=+r||-1;for(var s=0;s<392;++s){if(as[s]==null){r<0&&(r=s);continue}if(as[s]==t){r=s;break}}r<0&&(r=391)}return as[r]=t,r}function Pm(t){for(var r=0;r!=392;++r)t[r]!==void 0&&Vj(t[r],r)}function Am(){as=n9()}var Wj=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function k9(t){var r=typeof t=="number"?as[t]:t;return r=r.replace(Wj,"(\\d+)"),new RegExp("^"+r+"$")}function C9(t,r,s){var n=-1,a=-1,l=-1,c=-1,u=-1,f=-1;(r.match(Wj)||[]).forEach(function(w,j){var C=parseInt(s[j+1],10);switch(w.toLowerCase().charAt(0)){case"y":n=C;break;case"d":l=C;break;case"h":c=C;break;case"s":f=C;break;case"m":c>=0?u=C:a=C;break}}),f>=0&&u==-1&&a>=0&&(u=a,a=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var y=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return c==-1&&u==-1&&f==-1?h:n==-1&&a==-1&&l==-1?y:h+"T"+y}var _9=(function(){var t={};t.version="1.2.0";function r(){for(var M=0,G=new Array(256),le=0;le!=256;++le)M=le,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,G[le]=M;return typeof Int32Array<"u"?new Int32Array(G):G}var s=r();function n(M){var G=0,le=0,Z=0,he=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Z=0;Z!=256;++Z)he[Z]=M[Z];for(Z=0;Z!=256;++Z)for(le=M[Z],G=256+Z;G<4096;G+=256)le=he[G]=le>>>8^M[le&255];var ce=[];for(Z=1;Z!=16;++Z)ce[Z-1]=typeof Int32Array<"u"?he.subarray(Z*256,Z*256+256):he.slice(Z*256,Z*256+256);return ce}var a=n(s),l=a[0],c=a[1],u=a[2],f=a[3],h=a[4],y=a[5],w=a[6],j=a[7],C=a[8],k=a[9],S=a[10],_=a[11],I=a[12],F=a[13],B=a[14];function q(M,G){for(var le=G^-1,Z=0,he=M.length;Z<he;)le=le>>>8^s[(le^M.charCodeAt(Z++))&255];return~le}function me(M,G){for(var le=G^-1,Z=M.length-15,he=0;he<Z;)le=B[M[he++]^le&255]^F[M[he++]^le>>8&255]^I[M[he++]^le>>16&255]^_[M[he++]^le>>>24]^S[M[he++]]^k[M[he++]]^C[M[he++]]^j[M[he++]]^w[M[he++]]^y[M[he++]]^h[M[he++]]^f[M[he++]]^u[M[he++]]^c[M[he++]]^l[M[he++]]^s[M[he++]];for(Z+=15;he<Z;)le=le>>>8^s[(le^M[he++])&255];return~le}function re(M,G){for(var le=G^-1,Z=0,he=M.length,ce=0,ke=0;Z<he;)ce=M.charCodeAt(Z++),ce<128?le=le>>>8^s[(le^ce)&255]:ce<2048?(le=le>>>8^s[(le^(192|ce>>6&31))&255],le=le>>>8^s[(le^(128|ce&63))&255]):ce>=55296&&ce<57344?(ce=(ce&1023)+64,ke=M.charCodeAt(Z++)&1023,le=le>>>8^s[(le^(240|ce>>8&7))&255],le=le>>>8^s[(le^(128|ce>>2&63))&255],le=le>>>8^s[(le^(128|ke>>6&15|(ce&3)<<4))&255],le=le>>>8^s[(le^(128|ke&63))&255]):(le=le>>>8^s[(le^(224|ce>>12&15))&255],le=le>>>8^s[(le^(128|ce>>6&63))&255],le=le>>>8^s[(le^(128|ce&63))&255]);return~le}return t.table=s,t.bstr=q,t.buf=me,t.str=re,t})(),Mr=(function(){var r={};r.version="1.2.1";function s(V,ae){for(var J=V.split("/"),K=ae.split("/"),de=0,oe=0,_e=Math.min(J.length,K.length);de<_e;++de){if(oe=J[de].length-K[de].length)return oe;if(J[de]!=K[de])return J[de]<K[de]?-1:1}return J.length-K.length}function n(V){if(V.charAt(V.length-1)=="/")return V.slice(0,-1).indexOf("/")===-1?V:n(V.slice(0,-1));var ae=V.lastIndexOf("/");return ae===-1?V:V.slice(0,ae+1)}function a(V){if(V.charAt(V.length-1)=="/")return a(V.slice(0,-1));var ae=V.lastIndexOf("/");return ae===-1?V:V.slice(ae+1)}function l(V,ae){typeof ae=="string"&&(ae=new Date(ae));var J=ae.getHours();J=J<<6|ae.getMinutes(),J=J<<5|ae.getSeconds()>>>1,V.write_shift(2,J);var K=ae.getFullYear()-1980;K=K<<4|ae.getMonth()+1,K=K<<5|ae.getDate(),V.write_shift(2,K)}function c(V){var ae=V.read_shift(2)&65535,J=V.read_shift(2)&65535,K=new Date,de=J&31;J>>>=5;var oe=J&15;J>>>=4,K.setMilliseconds(0),K.setFullYear(J+1980),K.setMonth(oe-1),K.setDate(de);var _e=ae&31;ae>>>=5;var Be=ae&63;return ae>>>=6,K.setHours(ae),K.setMinutes(Be),K.setSeconds(_e<<1),K}function u(V){wn(V,0);for(var ae={},J=0;V.l<=V.length-4;){var K=V.read_shift(2),de=V.read_shift(2),oe=V.l+de,_e={};switch(K){case 21589:J=V.read_shift(1),J&1&&(_e.mtime=V.read_shift(4)),de>5&&(J&2&&(_e.atime=V.read_shift(4)),J&4&&(_e.ctime=V.read_shift(4))),_e.mtime&&(_e.mt=new Date(_e.mtime*1e3));break}V.l=oe,ae[K]=_e}return ae}var f;function h(){return f||(f={})}function y(V,ae){if(V[0]==80&&V[1]==75)return Qt(V,ae);if((V[0]|32)==109&&(V[1]|32)==105)return Vt(V,ae);if(V.length<512)throw new Error("CFB file size "+V.length+" < 512");var J=3,K=512,de=0,oe=0,_e=0,Be=0,Ae=0,Ne=[],je=V.slice(0,512);wn(je,0);var Me=w(je);switch(J=Me[0],J){case 3:K=512;break;case 4:K=4096;break;case 0:if(Me[1]==0)return Qt(V,ae);default:throw new Error("Major Version: Expected 3 or 4 saw "+J)}K!==512&&(je=V.slice(0,K),wn(je,28));var We=V.slice(0,K);j(je,J);var ge=je.read_shift(4,"i");if(J===3&&ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ge);je.l+=4,_e=je.read_shift(4,"i"),je.l+=4,je.chk("00100000","Mini Stream Cutoff Size: "),Be=je.read_shift(4,"i"),de=je.read_shift(4,"i"),Ae=je.read_shift(4,"i"),oe=je.read_shift(4,"i");for(var W=-1,T=0;T<109&&(W=je.read_shift(4,"i"),!(W<0));++T)Ne[T]=W;var x=C(V,K);_(Ae,oe,x,K,Ne);var P=F(x,_e,Ne,K);P[_e].name="!Directory",de>0&&Be!==ke&&(P[Be].name="!MiniFAT"),P[Ne[0]].name="!FAT",P.fat_addrs=Ne,P.ssz=K;var g={},m=[],v=[],N=[];B(_e,P,x,m,de,g,v,Be),k(v,N,m),m.shift();var A={FileIndex:v,FullPaths:N};return ae&&ae.raw&&(A.raw={header:We,sectors:x}),A}function w(V){if(V[V.l]==80&&V[V.l+1]==75)return[0,0];V.chk(Ee,"Header Signature: "),V.l+=16;var ae=V.read_shift(2,"u");return[V.read_shift(2,"u"),ae]}function j(V,ae){var J=9;switch(V.l+=2,J=V.read_shift(2)){case 9:if(ae!=3)throw new Error("Sector Shift: Expected 9 saw "+J);break;case 12:if(ae!=4)throw new Error("Sector Shift: Expected 12 saw "+J);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+J)}V.chk("0600","Mini Sector Shift: "),V.chk("000000000000","Reserved: ")}function C(V,ae){for(var J=Math.ceil(V.length/ae)-1,K=[],de=1;de<J;++de)K[de-1]=V.slice(de*ae,(de+1)*ae);return K[J-1]=V.slice(J*ae),K}function k(V,ae,J){for(var K=0,de=0,oe=0,_e=0,Be=0,Ae=J.length,Ne=[],je=[];K<Ae;++K)Ne[K]=je[K]=K,ae[K]=J[K];for(;Be<je.length;++Be)K=je[Be],de=V[K].L,oe=V[K].R,_e=V[K].C,Ne[K]===K&&(de!==-1&&Ne[de]!==de&&(Ne[K]=Ne[de]),oe!==-1&&Ne[oe]!==oe&&(Ne[K]=Ne[oe])),_e!==-1&&(Ne[_e]=K),de!==-1&&K!=Ne[K]&&(Ne[de]=Ne[K],je.lastIndexOf(de)<Be&&je.push(de)),oe!==-1&&K!=Ne[K]&&(Ne[oe]=Ne[K],je.lastIndexOf(oe)<Be&&je.push(oe));for(K=1;K<Ae;++K)Ne[K]===K&&(oe!==-1&&Ne[oe]!==oe?Ne[K]=Ne[oe]:de!==-1&&Ne[de]!==de&&(Ne[K]=Ne[de]));for(K=1;K<Ae;++K)if(V[K].type!==0){if(Be=K,Be!=Ne[Be])do Be=Ne[Be],ae[K]=ae[Be]+"/"+ae[K];while(Be!==0&&Ne[Be]!==-1&&Be!=Ne[Be]);Ne[K]=-1}for(ae[0]+="/",K=1;K<Ae;++K)V[K].type!==2&&(ae[K]+="/")}function S(V,ae,J){for(var K=V.start,de=V.size,oe=[],_e=K;J&&de>0&&_e>=0;)oe.push(ae.slice(_e*ce,_e*ce+ce)),de-=ce,_e=Vi(J,_e*4);return oe.length===0?st(0):Ds(oe).slice(0,V.size)}function _(V,ae,J,K,de){var oe=ke;if(V===ke){if(ae!==0)throw new Error("DIFAT chain shorter than expected")}else if(V!==-1){var _e=J[V],Be=(K>>>2)-1;if(!_e)return;for(var Ae=0;Ae<Be&&(oe=Vi(_e,Ae*4))!==ke;++Ae)de.push(oe);_(Vi(_e,K-4),ae-1,J,K,de)}}function I(V,ae,J,K,de){var oe=[],_e=[];de||(de=[]);var Be=K-1,Ae=0,Ne=0;for(Ae=ae;Ae>=0;){de[Ae]=!0,oe[oe.length]=Ae,_e.push(V[Ae]);var je=J[Math.floor(Ae*4/K)];if(Ne=Ae*4&Be,K<4+Ne)throw new Error("FAT boundary crossed: "+Ae+" 4 "+K);if(!V[je])break;Ae=Vi(V[je],Ne)}return{nodes:oe,data:Cb([_e])}}function F(V,ae,J,K){var de=V.length,oe=[],_e=[],Be=[],Ae=[],Ne=K-1,je=0,Me=0,We=0,ge=0;for(je=0;je<de;++je)if(Be=[],We=je+ae,We>=de&&(We-=de),!_e[We]){Ae=[];var W=[];for(Me=We;Me>=0;){W[Me]=!0,_e[Me]=!0,Be[Be.length]=Me,Ae.push(V[Me]);var T=J[Math.floor(Me*4/K)];if(ge=Me*4&Ne,K<4+ge)throw new Error("FAT boundary crossed: "+Me+" 4 "+K);if(!V[T]||(Me=Vi(V[T],ge),W[Me]))break}oe[We]={nodes:Be,data:Cb([Ae])}}return oe}function B(V,ae,J,K,de,oe,_e,Be){for(var Ae=0,Ne=K.length?2:0,je=ae[V].data,Me=0,We=0,ge;Me<je.length;Me+=128){var W=je.slice(Me,Me+128);wn(W,64),We=W.read_shift(2),ge=Ah(W,0,We-Ne),K.push(ge);var T={name:ge,type:W.read_shift(1),color:W.read_shift(1),L:W.read_shift(4,"i"),R:W.read_shift(4,"i"),C:W.read_shift(4,"i"),clsid:W.read_shift(16),state:W.read_shift(4,"i"),start:0,size:0},x=W.read_shift(2)+W.read_shift(2)+W.read_shift(2)+W.read_shift(2);x!==0&&(T.ct=q(W,W.l-8));var P=W.read_shift(2)+W.read_shift(2)+W.read_shift(2)+W.read_shift(2);P!==0&&(T.mt=q(W,W.l-8)),T.start=W.read_shift(4,"i"),T.size=W.read_shift(4,"i"),T.size<0&&T.start<0&&(T.size=T.type=0,T.start=ke,T.name=""),T.type===5?(Ae=T.start,de>0&&Ae!==ke&&(ae[Ae].name="!StreamData")):T.size>=4096?(T.storage="fat",ae[T.start]===void 0&&(ae[T.start]=I(J,T.start,ae.fat_addrs,ae.ssz)),ae[T.start].name=T.name,T.content=ae[T.start].data.slice(0,T.size)):(T.storage="minifat",T.size<0?T.size=0:Ae!==ke&&T.start!==ke&&ae[Ae]&&(T.content=S(T,ae[Ae].data,(ae[Be]||{}).data))),T.content&&wn(T.content,0),oe[ge]=T,_e.push(T)}}function q(V,ae){return new Date((Sn(V,ae+4)/1e7*Math.pow(2,32)+Sn(V,ae)/1e7-11644473600)*1e3)}function me(V,ae){return h(),y(f.readFileSync(V),ae)}function re(V,ae){var J=ae&&ae.type;switch(J||Er&&Buffer.isBuffer(V)&&(J="buffer"),J||"base64"){case"file":return me(V,ae);case"base64":return y(Hn(Va(V)),ae);case"binary":return y(Hn(V),ae)}return y(V,ae)}function M(V,ae){var J=ae||{},K=J.root||"Root Entry";if(V.FullPaths||(V.FullPaths=[]),V.FileIndex||(V.FileIndex=[]),V.FullPaths.length!==V.FileIndex.length)throw new Error("inconsistent CFB structure");V.FullPaths.length===0&&(V.FullPaths[0]=K+"/",V.FileIndex[0]={name:K,type:5}),J.CLSID&&(V.FileIndex[0].clsid=J.CLSID),G(V)}function G(V){var ae="Sh33tJ5";if(!Mr.find(V,"/"+ae)){var J=st(4);J[0]=55,J[1]=J[3]=50,J[2]=54,V.FileIndex.push({name:ae,type:2,content:J,size:4,L:69,R:69,C:69}),V.FullPaths.push(V.FullPaths[0]+ae),le(V)}}function le(V,ae){M(V);for(var J=!1,K=!1,de=V.FullPaths.length-1;de>=0;--de){var oe=V.FileIndex[de];switch(oe.type){case 0:K?J=!0:(V.FileIndex.pop(),V.FullPaths.pop());break;case 1:case 2:case 5:K=!0,isNaN(oe.R*oe.L*oe.C)&&(J=!0),oe.R>-1&&oe.L>-1&&oe.R==oe.L&&(J=!0);break;default:J=!0;break}}if(!(!J&&!ae)){var _e=new Date(1987,1,19),Be=0,Ae=Object.create?Object.create(null):{},Ne=[];for(de=0;de<V.FullPaths.length;++de)Ae[V.FullPaths[de]]=!0,V.FileIndex[de].type!==0&&Ne.push([V.FullPaths[de],V.FileIndex[de]]);for(de=0;de<Ne.length;++de){var je=n(Ne[de][0]);K=Ae[je],K||(Ne.push([je,{name:a(je).replace("/",""),type:1,clsid:X,ct:_e,mt:_e,content:null}]),Ae[je]=!0)}for(Ne.sort(function(ge,W){return s(ge[0],W[0])}),V.FullPaths=[],V.FileIndex=[],de=0;de<Ne.length;++de)V.FullPaths[de]=Ne[de][0],V.FileIndex[de]=Ne[de][1];for(de=0;de<Ne.length;++de){var Me=V.FileIndex[de],We=V.FullPaths[de];if(Me.name=a(We).replace("/",""),Me.L=Me.R=Me.C=-(Me.color=1),Me.size=Me.content?Me.content.length:0,Me.start=0,Me.clsid=Me.clsid||X,de===0)Me.C=Ne.length>1?1:-1,Me.size=0,Me.type=5;else if(We.slice(-1)=="/"){for(Be=de+1;Be<Ne.length&&n(V.FullPaths[Be])!=We;++Be);for(Me.C=Be>=Ne.length?-1:Be,Be=de+1;Be<Ne.length&&n(V.FullPaths[Be])!=n(We);++Be);Me.R=Be>=Ne.length?-1:Be,Me.type=1}else n(V.FullPaths[de+1]||"")==n(We)&&(Me.R=de+1),Me.type=2}}}function Z(V,ae){var J=ae||{};if(J.fileType=="mad")return zt(V,J);switch(le(V),J.fileType){case"zip":return bt(V,J)}var K=(function(ge){for(var W=0,T=0,x=0;x<ge.FileIndex.length;++x){var P=ge.FileIndex[x];if(P.content){var g=P.content.length;g>0&&(g<4096?W+=g+63>>6:T+=g+511>>9)}}for(var m=ge.FullPaths.length+3>>2,v=W+7>>3,N=W+127>>7,A=v+T+m+N,R=A+127>>7,D=R<=109?0:Math.ceil((R-109)/127);A+R+D+127>>7>R;)D=++R<=109?0:Math.ceil((R-109)/127);var Te=[1,D,R,N,m,T,W,0];return ge.FileIndex[0].size=W<<6,Te[7]=(ge.FileIndex[0].start=Te[0]+Te[1]+Te[2]+Te[3]+Te[4]+Te[5])+(Te[6]+7>>3),Te})(V),de=st(K[7]<<9),oe=0,_e=0;{for(oe=0;oe<8;++oe)de.write_shift(1,Fe[oe]);for(oe=0;oe<8;++oe)de.write_shift(2,0);for(de.write_shift(2,62),de.write_shift(2,3),de.write_shift(2,65534),de.write_shift(2,9),de.write_shift(2,6),oe=0;oe<3;++oe)de.write_shift(2,0);for(de.write_shift(4,0),de.write_shift(4,K[2]),de.write_shift(4,K[0]+K[1]+K[2]+K[3]-1),de.write_shift(4,0),de.write_shift(4,4096),de.write_shift(4,K[3]?K[0]+K[1]+K[2]-1:ke),de.write_shift(4,K[3]),de.write_shift(-4,K[1]?K[0]-1:ke),de.write_shift(4,K[1]),oe=0;oe<109;++oe)de.write_shift(-4,oe<K[2]?K[1]+oe:-1)}if(K[1])for(_e=0;_e<K[1];++_e){for(;oe<236+_e*127;++oe)de.write_shift(-4,oe<K[2]?K[1]+oe:-1);de.write_shift(-4,_e===K[1]-1?ke:_e+1)}var Be=function(ge){for(_e+=ge;oe<_e-1;++oe)de.write_shift(-4,oe+1);ge&&(++oe,de.write_shift(-4,ke))};for(_e=oe=0,_e+=K[1];oe<_e;++oe)de.write_shift(-4,ye.DIFSECT);for(_e+=K[2];oe<_e;++oe)de.write_shift(-4,ye.FATSECT);Be(K[3]),Be(K[4]);for(var Ae=0,Ne=0,je=V.FileIndex[0];Ae<V.FileIndex.length;++Ae)je=V.FileIndex[Ae],je.content&&(Ne=je.content.length,!(Ne<4096)&&(je.start=_e,Be(Ne+511>>9)));for(Be(K[6]+7>>3);de.l&511;)de.write_shift(-4,ye.ENDOFCHAIN);for(_e=oe=0,Ae=0;Ae<V.FileIndex.length;++Ae)je=V.FileIndex[Ae],je.content&&(Ne=je.content.length,!(!Ne||Ne>=4096)&&(je.start=_e,Be(Ne+63>>6)));for(;de.l&511;)de.write_shift(-4,ye.ENDOFCHAIN);for(oe=0;oe<K[4]<<2;++oe){var Me=V.FullPaths[oe];if(!Me||Me.length===0){for(Ae=0;Ae<17;++Ae)de.write_shift(4,0);for(Ae=0;Ae<3;++Ae)de.write_shift(4,-1);for(Ae=0;Ae<12;++Ae)de.write_shift(4,0);continue}je=V.FileIndex[oe],oe===0&&(je.start=je.size?je.start-1:ke);var We=oe===0&&J.root||je.name;if(Ne=2*(We.length+1),de.write_shift(64,We,"utf16le"),de.write_shift(2,Ne),de.write_shift(1,je.type),de.write_shift(1,je.color),de.write_shift(-4,je.L),de.write_shift(-4,je.R),de.write_shift(-4,je.C),je.clsid)de.write_shift(16,je.clsid,"hex");else for(Ae=0;Ae<4;++Ae)de.write_shift(4,0);de.write_shift(4,je.state||0),de.write_shift(4,0),de.write_shift(4,0),de.write_shift(4,0),de.write_shift(4,0),de.write_shift(4,je.start),de.write_shift(4,je.size),de.write_shift(4,0)}for(oe=1;oe<V.FileIndex.length;++oe)if(je=V.FileIndex[oe],je.size>=4096)if(de.l=je.start+1<<9,Er&&Buffer.isBuffer(je.content))je.content.copy(de,de.l,0,je.size),de.l+=je.size+511&-512;else{for(Ae=0;Ae<je.size;++Ae)de.write_shift(1,je.content[Ae]);for(;Ae&511;++Ae)de.write_shift(1,0)}for(oe=1;oe<V.FileIndex.length;++oe)if(je=V.FileIndex[oe],je.size>0&&je.size<4096)if(Er&&Buffer.isBuffer(je.content))je.content.copy(de,de.l,0,je.size),de.l+=je.size+63&-64;else{for(Ae=0;Ae<je.size;++Ae)de.write_shift(1,je.content[Ae]);for(;Ae&63;++Ae)de.write_shift(1,0)}if(Er)de.l=de.length;else for(;de.l<de.length;)de.write_shift(1,0);return de}function he(V,ae){var J=V.FullPaths.map(function(Ae){return Ae.toUpperCase()}),K=J.map(function(Ae){var Ne=Ae.split("/");return Ne[Ne.length-(Ae.slice(-1)=="/"?2:1)]}),de=!1;ae.charCodeAt(0)===47?(de=!0,ae=J[0].slice(0,-1)+ae):de=ae.indexOf("/")!==-1;var oe=ae.toUpperCase(),_e=de===!0?J.indexOf(oe):K.indexOf(oe);if(_e!==-1)return V.FileIndex[_e];var Be=!oe.match(du);for(oe=oe.replace(ic,""),Be&&(oe=oe.replace(du,"!")),_e=0;_e<J.length;++_e)if((Be?J[_e].replace(du,"!"):J[_e]).replace(ic,"")==oe||(Be?K[_e].replace(du,"!"):K[_e]).replace(ic,"")==oe)return V.FileIndex[_e];return null}var ce=64,ke=-2,Ee="d0cf11e0a1b11ae1",Fe=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",ye={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ke,FREESECT:-1,HEADER_SIGNATURE:Ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(V,ae,J){h();var K=Z(V,J);f.writeFileSync(ae,K)}function we(V){for(var ae=new Array(V.length),J=0;J<V.length;++J)ae[J]=String.fromCharCode(V[J]);return ae.join("")}function pe(V,ae){var J=Z(V,ae);switch(ae&&ae.type||"buffer"){case"file":return h(),f.writeFileSync(ae.filename,J),J;case"binary":return typeof J=="string"?J:we(J);case"base64":return gc(typeof J=="string"?J:we(J));case"buffer":if(Er)return Buffer.isBuffer(J)?J:Ha(J);case"array":return typeof J=="string"?Hn(J):J}return J}var se;function U(V){try{var ae=V.InflateRaw,J=new ae;if(J._processChunk(new Uint8Array([3,0]),J._finishFlushFlag),J.bytesRead)se=V;else throw new Error("zlib does not expose bytesRead")}catch(K){console.error("cannot use native zlib: "+(K.message||K))}}function ue(V,ae){if(!se)return Bt(V,ae);var J=se.InflateRaw,K=new J,de=K._processChunk(V.slice(V.l),K._finishFlushFlag);return V.l+=K.bytesRead,de}function z(V){return se?se.deflateRawSync(V):ct(V)}var ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ve=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(V){var ae=(V<<1|V<<11)&139536|(V<<5|V<<15)&558144;return(ae>>16|ae>>8|ae)&255}for(var Le=typeof Uint8Array<"u",De=Le?new Uint8Array(256):[],Ve=0;Ve<256;++Ve)De[Ve]=Ce(Ve);function tt(V,ae){var J=De[V&255];return ae<=8?J>>>8-ae:(J=J<<8|De[V>>8&255],ae<=16?J>>>16-ae:(J=J<<8|De[V>>16&255],J>>>24-ae))}function Nt(V,ae){var J=ae&7,K=ae>>>3;return(V[K]|(J<=6?0:V[K+1]<<8))>>>J&3}function lt(V,ae){var J=ae&7,K=ae>>>3;return(V[K]|(J<=5?0:V[K+1]<<8))>>>J&7}function $t(V,ae){var J=ae&7,K=ae>>>3;return(V[K]|(J<=4?0:V[K+1]<<8))>>>J&15}function qe(V,ae){var J=ae&7,K=ae>>>3;return(V[K]|(J<=3?0:V[K+1]<<8))>>>J&31}function Ie(V,ae){var J=ae&7,K=ae>>>3;return(V[K]|(J<=1?0:V[K+1]<<8))>>>J&127}function ut(V,ae,J){var K=ae&7,de=ae>>>3,oe=(1<<J)-1,_e=V[de]>>>K;return J<8-K||(_e|=V[de+1]<<8-K,J<16-K)||(_e|=V[de+2]<<16-K,J<24-K)||(_e|=V[de+3]<<24-K),_e&oe}function it(V,ae,J){var K=ae&7,de=ae>>>3;return K<=5?V[de]|=(J&7)<<K:(V[de]|=J<<K&255,V[de+1]=(J&7)>>8-K),ae+3}function jt(V,ae,J){var K=ae&7,de=ae>>>3;return J=(J&1)<<K,V[de]|=J,ae+1}function mt(V,ae,J){var K=ae&7,de=ae>>>3;return J<<=K,V[de]|=J&255,J>>>=8,V[de+1]=J,ae+8}function xe(V,ae,J){var K=ae&7,de=ae>>>3;return J<<=K,V[de]|=J&255,J>>>=8,V[de+1]=J&255,V[de+2]=J>>>8,ae+16}function Ge(V,ae){var J=V.length,K=2*J>ae?2*J:ae+5,de=0;if(J>=ae)return V;if(Er){var oe=ub(K);if(V.copy)V.copy(oe);else for(;de<V.length;++de)oe[de]=V[de];return oe}else if(Le){var _e=new Uint8Array(K);if(_e.set)_e.set(V);else for(;de<J;++de)_e[de]=V[de];return _e}return V.length=K,V}function ot(V){for(var ae=new Array(V),J=0;J<V;++J)ae[J]=0;return ae}function et(V,ae,J){var K=1,de=0,oe=0,_e=0,Be=0,Ae=V.length,Ne=Le?new Uint16Array(32):ot(32);for(oe=0;oe<32;++oe)Ne[oe]=0;for(oe=Ae;oe<J;++oe)V[oe]=0;Ae=V.length;var je=Le?new Uint16Array(Ae):ot(Ae);for(oe=0;oe<Ae;++oe)Ne[de=V[oe]]++,K<de&&(K=de),je[oe]=0;for(Ne[0]=0,oe=1;oe<=K;++oe)Ne[oe+16]=Be=Be+Ne[oe-1]<<1;for(oe=0;oe<Ae;++oe)Be=V[oe],Be!=0&&(je[oe]=Ne[Be+16]++);var Me=0;for(oe=0;oe<Ae;++oe)if(Me=V[oe],Me!=0)for(Be=tt(je[oe],K)>>K-Me,_e=(1<<K+4-Me)-1;_e>=0;--_e)ae[Be|_e<<Me]=Me&15|oe<<4;return K}var He=Le?new Uint16Array(512):ot(512),It=Le?new Uint16Array(32):ot(32);if(!Le){for(var yt=0;yt<512;++yt)He[yt]=0;for(yt=0;yt<32;++yt)It[yt]=0}(function(){for(var V=[],ae=0;ae<32;ae++)V.push(5);et(V,It,32);var J=[];for(ae=0;ae<=143;ae++)J.push(8);for(;ae<=255;ae++)J.push(9);for(;ae<=279;ae++)J.push(7);for(;ae<=287;ae++)J.push(8);et(J,He,288)})();var St=(function(){for(var ae=Le?new Uint8Array(32768):[],J=0,K=0;J<fe.length-1;++J)for(;K<fe[J+1];++K)ae[K]=J;for(;K<32768;++K)ae[K]=29;var de=Le?new Uint8Array(259):[];for(J=0,K=0;J<ve.length-1;++J)for(;K<ve[J+1];++K)de[K]=J;function oe(Be,Ae){for(var Ne=0;Ne<Be.length;){var je=Math.min(65535,Be.length-Ne),Me=Ne+je==Be.length;for(Ae.write_shift(1,+Me),Ae.write_shift(2,je),Ae.write_shift(2,~je&65535);je-- >0;)Ae[Ae.l++]=Be[Ne++]}return Ae.l}function _e(Be,Ae){for(var Ne=0,je=0,Me=Le?new Uint16Array(32768):[];je<Be.length;){var We=Math.min(65535,Be.length-je);if(We<10){for(Ne=it(Ae,Ne,+(je+We==Be.length)),Ne&7&&(Ne+=8-(Ne&7)),Ae.l=Ne/8|0,Ae.write_shift(2,We),Ae.write_shift(2,~We&65535);We-- >0;)Ae[Ae.l++]=Be[je++];Ne=Ae.l*8;continue}Ne=it(Ae,Ne,+(je+We==Be.length)+2);for(var ge=0;We-- >0;){var W=Be[je];ge=(ge<<5^W)&32767;var T=-1,x=0;if((T=Me[ge])&&(T|=je&-32768,T>je&&(T-=32768),T<je))for(;Be[T+x]==Be[je+x]&&x<250;)++x;if(x>2){W=de[x],W<=22?Ne=mt(Ae,Ne,De[W+1]>>1)-1:(mt(Ae,Ne,3),Ne+=5,mt(Ae,Ne,De[W-23]>>5),Ne+=3);var P=W<8?0:W-4>>2;P>0&&(xe(Ae,Ne,x-ve[W]),Ne+=P),W=ae[je-T],Ne=mt(Ae,Ne,De[W]>>3),Ne-=3;var g=W<4?0:W-2>>1;g>0&&(xe(Ae,Ne,je-T-fe[W]),Ne+=g);for(var m=0;m<x;++m)Me[ge]=je&32767,ge=(ge<<5^Be[je])&32767,++je;We-=x-1}else W<=143?W=W+48:Ne=jt(Ae,Ne,1),Ne=mt(Ae,Ne,De[W]),Me[ge]=je&32767,++je}Ne=mt(Ae,Ne,0)-1}return Ae.l=(Ne+7)/8|0,Ae.l}return function(Ae,Ne){return Ae.length<8?oe(Ae,Ne):_e(Ae,Ne)}})();function ct(V){var ae=st(50+Math.floor(V.length*1.1)),J=St(V,ae);return ae.slice(0,J)}var Yt=Le?new Uint16Array(32768):ot(32768),te=Le?new Uint16Array(32768):ot(32768),Ze=Le?new Uint16Array(128):ot(128),at=1,Ke=1;function kt(V,ae){var J=qe(V,ae)+257;ae+=5;var K=qe(V,ae)+1;ae+=5;var de=$t(V,ae)+4;ae+=4;for(var oe=0,_e=Le?new Uint8Array(19):ot(19),Be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ae=1,Ne=Le?new Uint8Array(8):ot(8),je=Le?new Uint8Array(8):ot(8),Me=_e.length,We=0;We<de;++We)_e[ne[We]]=oe=lt(V,ae),Ae<oe&&(Ae=oe),Ne[oe]++,ae+=3;var ge=0;for(Ne[0]=0,We=1;We<=Ae;++We)je[We]=ge=ge+Ne[We-1]<<1;for(We=0;We<Me;++We)(ge=_e[We])!=0&&(Be[We]=je[ge]++);var W=0;for(We=0;We<Me;++We)if(W=_e[We],W!=0){ge=De[Be[We]]>>8-W;for(var T=(1<<7-W)-1;T>=0;--T)Ze[ge|T<<W]=W&7|We<<3}var x=[];for(Ae=1;x.length<J+K;)switch(ge=Ze[Ie(V,ae)],ae+=ge&7,ge>>>=3){case 16:for(oe=3+Nt(V,ae),ae+=2,ge=x[x.length-1];oe-- >0;)x.push(ge);break;case 17:for(oe=3+lt(V,ae),ae+=3;oe-- >0;)x.push(0);break;case 18:for(oe=11+Ie(V,ae),ae+=7;oe-- >0;)x.push(0);break;default:x.push(ge),Ae<ge&&(Ae=ge);break}var P=x.slice(0,J),g=x.slice(J);for(We=J;We<286;++We)P[We]=0;for(We=K;We<30;++We)g[We]=0;return at=et(P,Yt,286),Ke=et(g,te,30),ae}function vt(V,ae){if(V[0]==3&&!(V[1]&3))return[sl(ae),2];for(var J=0,K=0,de=ub(ae||1<<18),oe=0,_e=de.length>>>0,Be=0,Ae=0;(K&1)==0;){if(K=lt(V,J),J+=3,K>>>1)K>>1==1?(Be=9,Ae=5):(J=kt(V,J),Be=at,Ae=Ke);else{J&7&&(J+=8-(J&7));var Ne=V[J>>>3]|V[(J>>>3)+1]<<8;if(J+=32,Ne>0)for(!ae&&_e<oe+Ne&&(de=Ge(de,oe+Ne),_e=de.length);Ne-- >0;)de[oe++]=V[J>>>3],J+=8;continue}for(;;){!ae&&_e<oe+32767&&(de=Ge(de,oe+32767),_e=de.length);var je=ut(V,J,Be),Me=K>>>1==1?He[je]:Yt[je];if(J+=Me&15,Me>>>=4,(Me>>>8&255)===0)de[oe++]=Me;else{if(Me==256)break;Me-=257;var We=Me<8?0:Me-4>>2;We>5&&(We=0);var ge=oe+ve[Me];We>0&&(ge+=ut(V,J,We),J+=We),je=ut(V,J,Ae),Me=K>>>1==1?It[je]:te[je],J+=Me&15,Me>>>=4;var W=Me<4?0:Me-2>>1,T=fe[Me];for(W>0&&(T+=ut(V,J,W),J+=W),!ae&&_e<ge&&(de=Ge(de,ge+100),_e=de.length);oe<ge;)de[oe]=de[oe-T],++oe}}}return ae?[de,J+7>>>3]:[de.slice(0,oe),J+7>>>3]}function Bt(V,ae){var J=V.slice(V.l||0),K=vt(J,ae);return V.l+=K[1],K[0]}function Et(V,ae){if(V)typeof console<"u"&&console.error(ae);else throw new Error(ae)}function Qt(V,ae){var J=V;wn(J,0);var K=[],de=[],oe={FileIndex:K,FullPaths:de};M(oe,{root:ae.root});for(var _e=J.length-4;(J[_e]!=80||J[_e+1]!=75||J[_e+2]!=5||J[_e+3]!=6)&&_e>=0;)--_e;J.l=_e+4,J.l+=4;var Be=J.read_shift(2);J.l+=6;var Ae=J.read_shift(4);for(J.l=Ae,_e=0;_e<Be;++_e){J.l+=20;var Ne=J.read_shift(4),je=J.read_shift(4),Me=J.read_shift(2),We=J.read_shift(2),ge=J.read_shift(2);J.l+=8;var W=J.read_shift(4),T=u(J.slice(J.l+Me,J.l+Me+We));J.l+=Me+We+ge;var x=J.l;J.l=W+4,Ct(J,Ne,je,oe,T),J.l=x}return oe}function Ct(V,ae,J,K,de){V.l+=2;var oe=V.read_shift(2),_e=V.read_shift(2),Be=c(V);if(oe&8257)throw new Error("Unsupported ZIP encryption");for(var Ae=V.read_shift(4),Ne=V.read_shift(4),je=V.read_shift(4),Me=V.read_shift(2),We=V.read_shift(2),ge="",W=0;W<Me;++W)ge+=String.fromCharCode(V[V.l++]);if(We){var T=u(V.slice(V.l,V.l+We));(T[21589]||{}).mt&&(Be=T[21589].mt),((de||{})[21589]||{}).mt&&(Be=de[21589].mt)}V.l+=We;var x=V.slice(V.l,V.l+Ne);switch(_e){case 8:x=ue(V,je);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+_e)}var P=!1;oe&8&&(Ae=V.read_shift(4),Ae==134695760&&(Ae=V.read_shift(4),P=!0),Ne=V.read_shift(4),je=V.read_shift(4)),Ne!=ae&&Et(P,"Bad compressed size: "+ae+" != "+Ne),je!=J&&Et(P,"Bad uncompressed size: "+J+" != "+je),nr(K,ge,x,{unsafe:!0,mt:Be})}function bt(V,ae){var J=ae||{},K=[],de=[],oe=st(1),_e=J.compression?8:0,Be=0,Ae=0,Ne=0,je=0,Me=0,We=V.FullPaths[0],ge=We,W=V.FileIndex[0],T=[],x=0;for(Ae=1;Ae<V.FullPaths.length;++Ae)if(ge=V.FullPaths[Ae].slice(We.length),W=V.FileIndex[Ae],!(!W.size||!W.content||ge=="Sh33tJ5")){var P=je,g=st(ge.length);for(Ne=0;Ne<ge.length;++Ne)g.write_shift(1,ge.charCodeAt(Ne)&127);g=g.slice(0,g.l),T[Me]=_9.buf(W.content,0);var m=W.content;_e==8&&(m=z(m)),oe=st(30),oe.write_shift(4,67324752),oe.write_shift(2,20),oe.write_shift(2,Be),oe.write_shift(2,_e),W.mt?l(oe,W.mt):oe.write_shift(4,0),oe.write_shift(-4,T[Me]),oe.write_shift(4,m.length),oe.write_shift(4,W.content.length),oe.write_shift(2,g.length),oe.write_shift(2,0),je+=oe.length,K.push(oe),je+=g.length,K.push(g),je+=m.length,K.push(m),oe=st(46),oe.write_shift(4,33639248),oe.write_shift(2,0),oe.write_shift(2,20),oe.write_shift(2,Be),oe.write_shift(2,_e),oe.write_shift(4,0),oe.write_shift(-4,T[Me]),oe.write_shift(4,m.length),oe.write_shift(4,W.content.length),oe.write_shift(2,g.length),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(4,0),oe.write_shift(4,P),x+=oe.l,de.push(oe),x+=g.length,de.push(g),++Me}return oe=st(22),oe.write_shift(4,101010256),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(2,Me),oe.write_shift(2,Me),oe.write_shift(4,x),oe.write_shift(4,je),oe.write_shift(2,0),Ds([Ds(K),Ds(de),oe])}var $e={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function gt(V,ae){if(V.ctype)return V.ctype;var J=V.name||"",K=J.match(/\.([^\.]+)$/);return K&&$e[K[1]]||ae&&(K=(J=ae).match(/[\.\\]([^\.\\])+$/),K&&$e[K[1]])?$e[K[1]]:"application/octet-stream"}function Pt(V){for(var ae=gc(V),J=[],K=0;K<ae.length;K+=76)J.push(ae.slice(K,K+76));return J.join(`\r
`)+`\r
`}function er(V){var ae=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ne){var je=Ne.charCodeAt(0).toString(16).toUpperCase();return"="+(je.length==1?"0"+je:je)});ae=ae.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ae.charAt(0)==`
`&&(ae="=0D"+ae.slice(1)),ae=ae.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var J=[],K=ae.split(`\r
`),de=0;de<K.length;++de){var oe=K[de];if(oe.length==0){J.push("");continue}for(var _e=0;_e<oe.length;){var Be=76,Ae=oe.slice(_e,_e+Be);Ae.charAt(Be-1)=="="?Be--:Ae.charAt(Be-2)=="="?Be-=2:Ae.charAt(Be-3)=="="&&(Be-=3),Ae=oe.slice(_e,_e+Be),_e+=Be,_e<oe.length&&(Ae+="="),J.push(Ae)}}return J.join(`\r
`)}function At(V){for(var ae=[],J=0;J<V.length;++J){for(var K=V[J];J<=V.length&&K.charAt(K.length-1)=="=";)K=K.slice(0,K.length-1)+V[++J];ae.push(K)}for(var de=0;de<ae.length;++de)ae[de]=ae[de].replace(/[=][0-9A-Fa-f]{2}/g,function(oe){return String.fromCharCode(parseInt(oe.slice(1),16))});return Hn(ae.join(`\r
`))}function Ut(V,ae,J){for(var K="",de="",oe="",_e,Be=0;Be<10;++Be){var Ae=ae[Be];if(!Ae||Ae.match(/^\s*$/))break;var Ne=Ae.match(/^(.*?):\s*([^\s].*)$/);if(Ne)switch(Ne[1].toLowerCase()){case"content-location":K=Ne[2].trim();break;case"content-type":oe=Ne[2].trim();break;case"content-transfer-encoding":de=Ne[2].trim();break}}switch(++Be,de.toLowerCase()){case"base64":_e=Hn(Va(ae.slice(Be).join("")));break;case"quoted-printable":_e=At(ae.slice(Be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+de)}var je=nr(V,K.slice(J.length),_e,{unsafe:!0});oe&&(je.ctype=oe)}function Vt(V,ae){if(we(V.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var J=ae&&ae.root||"",K=(Er&&Buffer.isBuffer(V)?V.toString("binary"):we(V)).split(`\r
`),de=0,oe="";for(de=0;de<K.length;++de)if(oe=K[de],!!/^Content-Location:/i.test(oe)&&(oe=oe.slice(oe.indexOf("file")),J||(J=oe.slice(0,oe.lastIndexOf("/")+1)),oe.slice(0,J.length)!=J))for(;J.length>0&&(J=J.slice(0,J.length-1),J=J.slice(0,J.lastIndexOf("/")+1),oe.slice(0,J.length)!=J););var _e=(K[1]||"").match(/boundary="(.*?)"/);if(!_e)throw new Error("MAD cannot find boundary");var Be="--"+(_e[1]||""),Ae=[],Ne=[],je={FileIndex:Ae,FullPaths:Ne};M(je);var Me,We=0;for(de=0;de<K.length;++de){var ge=K[de];ge!==Be&&ge!==Be+"--"||(We++&&Ut(je,K.slice(Me,de),J),Me=de)}return je}function zt(V,ae){var J=ae||{},K=J.boundary||"SheetJS";K="------="+K;for(var de=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+K.slice(2)+'"',"","",""],oe=V.FullPaths[0],_e=oe,Be=V.FileIndex[0],Ae=1;Ae<V.FullPaths.length;++Ae)if(_e=V.FullPaths[Ae].slice(oe.length),Be=V.FileIndex[Ae],!(!Be.size||!Be.content||_e=="Sh33tJ5")){_e=_e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(x){return"_x"+x.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(x){return"_u"+x.charCodeAt(0).toString(16)+"_"});for(var Ne=Be.content,je=Er&&Buffer.isBuffer(Ne)?Ne.toString("binary"):we(Ne),Me=0,We=Math.min(1024,je.length),ge=0,W=0;W<=We;++W)(ge=je.charCodeAt(W))>=32&&ge<128&&++Me;var T=Me>=We*4/5;de.push(K),de.push("Content-Location: "+(J.root||"file:///C:/SheetJS/")+_e),de.push("Content-Transfer-Encoding: "+(T?"quoted-printable":"base64")),de.push("Content-Type: "+gt(Be,_e)),de.push(""),de.push(T?er(je):Pt(je))}return de.push(K+`--\r
`),de.join(`\r
`)}function rr(V){var ae={};return M(ae,V),ae}function nr(V,ae,J,K){var de=K&&K.unsafe;de||M(V);var oe=!de&&Mr.find(V,ae);if(!oe){var _e=V.FullPaths[0];ae.slice(0,_e.length)==_e?_e=ae:(_e.slice(-1)!="/"&&(_e+="/"),_e=(_e+ae).replace("//","/")),oe={name:a(ae),type:2},V.FileIndex.push(oe),V.FullPaths.push(_e),de||Mr.utils.cfb_gc(V)}return oe.content=J,oe.size=J?J.length:0,K&&(K.CLSID&&(oe.clsid=K.CLSID),K.mt&&(oe.mt=K.mt),K.ct&&(oe.ct=K.ct)),oe}function lr(V,ae){M(V);var J=Mr.find(V,ae);if(J){for(var K=0;K<V.FileIndex.length;++K)if(V.FileIndex[K]==J)return V.FileIndex.splice(K,1),V.FullPaths.splice(K,1),!0}return!1}function ir(V,ae,J){M(V);var K=Mr.find(V,ae);if(K){for(var de=0;de<V.FileIndex.length;++de)if(V.FileIndex[de]==K)return V.FileIndex[de].name=a(J),V.FullPaths[de]=J,!0}return!1}function ar(V){le(V,!0)}return r.find=he,r.read=re,r.parse=y,r.write=pe,r.writeFile=Q,r.utils={cfb_new:rr,cfb_add:nr,cfb_del:lr,cfb_mov:ir,cfb_gc:ar,ReadShift:oc,CheckField:dS,prep_blob:wn,bconcat:Ds,use_zlib:U,_deflateRaw:ct,_inflateRaw:Bt,consts:ye},r})();function E9(t){return typeof t=="string"?Em(t):Array.isArray(t)?e9(t):t}function Qc(t,r,s){if(typeof Deno<"u"){if(s&&typeof r=="string")switch(s){case"utf8":r=new TextEncoder(s).encode(r);break;case"binary":r=Em(r);break;default:throw new Error("Unsupported encoding "+s)}return Deno.writeFileSync(t,r)}var n=s=="utf8"?vc(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([E9(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:t,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=t,c.href=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(r)&&(r=$c(r)),u.write(r),u.close(),r}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function Ms(t){for(var r=Object.keys(t),s=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(t,r[n])&&s.push(r[n]);return s}function vb(t,r){for(var s=[],n=Ms(t),a=0;a!==n.length;++a)s[t[n[a]][r]]==null&&(s[t[n[a]][r]]=n[a]);return s}function Ch(t){for(var r=[],s=Ms(t),n=0;n!==s.length;++n)r[t[s[n]]]=s[n];return r}function Tm(t){for(var r=[],s=Ms(t),n=0;n!==s.length;++n)r[t[s[n]]]=parseInt(s[n],10);return r}function P9(t){for(var r=[],s=Ms(t),n=0;n!==s.length;++n)r[t[s[n]]]==null&&(r[t[s[n]]]=[]),r[t[s[n]]].push(s[n]);return r}var Wu=new Date(1899,11,30,0,0,0);function pn(t,r){var s=t.getTime(),n=Wu.getTime()+(t.getTimezoneOffset()-Wu.getTimezoneOffset())*6e4;return(s-n)/(1440*60*1e3)}var Gj=new Date,A9=Wu.getTime()+(Gj.getTimezoneOffset()-Wu.getTimezoneOffset())*6e4,bb=Gj.getTimezoneOffset();function Hj(t){var r=new Date;return r.setTime(t*24*60*60*1e3+A9),r.getTimezoneOffset()!==bb&&r.setTime(r.getTime()+(r.getTimezoneOffset()-bb)*6e4),r}var wb=new Date("2017-02-19T19:06:09.000Z"),Yj=isNaN(wb.getFullYear())?new Date("2/19/17"):wb,T9=Yj.getFullYear()==2017;function Js(t,r){var s=new Date(t);if(T9)return r>0?s.setTime(s.getTime()+s.getTimezoneOffset()*60*1e3):r<0&&s.setTime(s.getTime()-s.getTimezoneOffset()*60*1e3),s;if(t instanceof Date)return t;if(Yj.getFullYear()==1917&&!isNaN(s.getFullYear())){var n=s.getFullYear();return t.indexOf(""+n)>-1||s.setFullYear(s.getFullYear()+100),s}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function Om(t,r){if(Er&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var s={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(l){return s[l]||l})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function xn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=xn(t[s]));return r}function es(t,r){for(var s="";s.length<r;)s+=t;return s}function Ba(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var s=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return s*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,l){return s=-s,l}),!isNaN(r=Number(n)))?r/s:r}var O9=["january","february","march","april","may","june","july","august","september","october","november","december"];function yc(t){var r=new Date(t),s=new Date(NaN),n=r.getYear(),a=r.getMonth(),l=r.getDate();if(isNaN(l))return s;var c=t.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&O9.indexOf(c)==-1)return s}else if(c.match(/[a-z]/))return s;return n<0||n>8099?s:(a>0||l>1)&&n!=101?r:t.match(/[^-0-9:,\/\\]/)?s:r}function fr(t,r,s){if(t.FullPaths){if(typeof s=="string"){var n;return Er?n=Ha(s):n=t9(s),Mr.utils.cfb_add(t,r,n)}Mr.utils.cfb_add(t,r,s)}else t.file(r,s)}function _h(){return Mr.utils.cfb_new()}var ys=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,R9={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Eh=Ch(R9),Ph=/[&<>'"]/g,D9=/[\u0000-\u0008\u000b-\u001f]/g;function Lr(t){var r=t+"";return r.replace(Ph,function(s){return Eh[s]}).replace(D9,function(s){return"_x"+("000"+s.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Nb(t){return Lr(t).replace(/ /g,"_x0020_")}var Kj=/[\u0000-\u001f]/g;function L9(t){var r=t+"";return r.replace(Ph,function(s){return Eh[s]}).replace(/\n/g,"<br/>").replace(Kj,function(s){return"&#x"+("000"+s.charCodeAt(0).toString(16)).slice(-4)+";"})}function F9(t){var r=t+"";return r.replace(Ph,function(s){return Eh[s]}).replace(Kj,function(s){return"&#x"+s.charCodeAt(0).toString(16).toUpperCase()+";"})}function M9(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function I9(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function W0(t){for(var r="",s=0,n=0,a=0,l=0,c=0,u=0;s<t.length;){if(n=t.charCodeAt(s++),n<128){r+=String.fromCharCode(n);continue}if(a=t.charCodeAt(s++),n>191&&n<224){c=(n&31)<<6,c|=a&63,r+=String.fromCharCode(c);continue}if(l=t.charCodeAt(s++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|l&63);continue}c=t.charCodeAt(s++),u=((n&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536,r+=String.fromCharCode(55296+(u>>>10&1023)),r+=String.fromCharCode(56320+(u&1023))}return r}function jb(t){var r=sl(2*t.length),s,n,a=1,l=0,c=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?s=u:u<224?(s=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(s=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,s=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),s-=65536,c=55296+(s>>>10&1023),s=56320+(s&1023)),c!==0&&(r[l++]=c&255,r[l++]=c>>>8,c=0),r[l++]=s%256,r[l++]=s>>>8;return r.slice(0,l).toString("ucs2")}function Sb(t){return Ha(t,"binary").toString("utf8")}var mu="foo bar baz",lc=Er&&(Sb(mu)==W0(mu)&&Sb||jb(mu)==W0(mu)&&jb)||W0,vc=Er?function(t){return Ha(t,"utf8").toString("binary")}:function(t){for(var r=[],s=0,n=0,a=0;s<t.length;)switch(n=t.charCodeAt(s++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(s++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},q9=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(s){for(var n=s.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}})(),Xj=/(^\s|\s$|\n)/;function Ls(t,r){return"<"+t+(r.match(Xj)?' xml:space="preserve"':"")+">"+r+"</"+t+">"}function bc(t){return Ms(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function Lt(t,r,s){return"<"+t+(s!=null?bc(s):"")+(r!=null?(r.match(Xj)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function Cx(t,r){try{return t.toISOString().replace(/\.\d*/,"")}catch(s){if(r)throw s}return""}function B9(t,r){switch(typeof t){case"string":var s=Lt("vt:lpwstr",Lr(t));return s=s.replace(/&quot;/g,"_x0022_"),s;case"number":return Lt((t|0)==t?"vt:i4":"vt:r8",Lr(String(t)));case"boolean":return Lt("vt:bool",t?"true":"false")}if(t instanceof Date)return Lt("vt:filetime",Cx(t));throw new Error("Unable to serialize "+t)}var _s={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},xo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],jn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function z9(t,r){for(var s=1-2*(t[r+7]>>>7),n=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),a=t[r+6]&15,l=5;l>=0;--l)a=a*256+t[r+l];return n==2047?a==0?s*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),s*Math.pow(2,n-52)*a)}function $9(t,r,s){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,l=0,c=n?-r:r;isFinite(c)?c==0?a=l=0:(a=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-a),a<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?a=-1022:(l-=Math.pow(2,52),a+=1023)):(a=2047,l=isNaN(r)?26985:0);for(var u=0;u<=5;++u,l/=256)t[s+u]=l&255;t[s+6]=(a&15)<<4|l&15,t[s+7]=a>>4|n}var kb=function(t){for(var r=[],s=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,l=t[0][n].length;a<l;a+=s)r.push.apply(r,t[0][n].slice(a,a+s));return r},Cb=Er?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:Ha(r)})):kb(t)}:kb,_b=function(t,r,s){for(var n=[],a=r;a<s;a+=2)n.push(String.fromCharCode(nc(t,a)));return n.join("").replace(ic,"")},Ah=Er?function(t,r,s){return Buffer.isBuffer(t)?t.toString("utf16le",r,s).replace(ic,""):_b(t,r,s)}:_b,Eb=function(t,r,s){for(var n=[],a=r;a<r+s;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},Jj=Er?function(t,r,s){return Buffer.isBuffer(t)?t.toString("hex",r,r+s):Eb(t,r,s)}:Eb,Pb=function(t,r,s){for(var n=[],a=r;a<s;a++)n.push(String.fromCharCode(Ql(t,a)));return n.join("")},Uc=Er?function(r,s,n){return Buffer.isBuffer(r)?r.toString("utf8",s,n):Pb(r,s,n)}:Pb,Zj=function(t,r){var s=Sn(t,r);return s>0?Uc(t,r+4,r+4+s-1):""},eS=Zj,tS=function(t,r){var s=Sn(t,r);return s>0?Uc(t,r+4,r+4+s-1):""},rS=tS,sS=function(t,r){var s=2*Sn(t,r);return s>0?Uc(t,r+4,r+4+s-1):""},nS=sS,aS=function(r,s){var n=Sn(r,s);return n>0?Ah(r,s+4,s+4+n):""},iS=aS,lS=function(t,r){var s=Sn(t,r);return s>0?Uc(t,r+4,r+4+s):""},oS=lS,cS=function(t,r){return z9(t,r)},Gu=cS,Th=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Er&&(eS=function(r,s){if(!Buffer.isBuffer(r))return Zj(r,s);var n=r.readUInt32LE(s);return n>0?r.toString("utf8",s+4,s+4+n-1):""},rS=function(r,s){if(!Buffer.isBuffer(r))return tS(r,s);var n=r.readUInt32LE(s);return n>0?r.toString("utf8",s+4,s+4+n-1):""},nS=function(r,s){if(!Buffer.isBuffer(r))return sS(r,s);var n=2*r.readUInt32LE(s);return r.toString("utf16le",s+4,s+4+n-1)},iS=function(r,s){if(!Buffer.isBuffer(r))return aS(r,s);var n=r.readUInt32LE(s);return r.toString("utf16le",s+4,s+4+n)},oS=function(r,s){if(!Buffer.isBuffer(r))return lS(r,s);var n=r.readUInt32LE(s);return r.toString("utf8",s+4,s+4+n)},Gu=function(r,s){return Buffer.isBuffer(r)?r.readDoubleLE(s):cS(r,s)},Th=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Ql=function(t,r){return t[r]},nc=function(t,r){return t[r+1]*256+t[r]},Q9=function(t,r){var s=t[r+1]*256+t[r];return s<32768?s:(65535-s+1)*-1},Sn=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},Vi=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},U9=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function oc(t,r){var s="",n,a,l=[],c,u,f,h;switch(r){case"dbcs":if(h=this.l,Er&&Buffer.isBuffer(this))s=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)s+=String.fromCharCode(nc(this,h)),h+=2;t*=2;break;case"utf8":s=Uc(this,this.l,this.l+t);break;case"utf16le":t*=2,s=Ah(this,this.l,this.l+t);break;case"wstr":return oc.call(this,t,"dbcs");case"lpstr-ansi":s=eS(this,this.l),t=4+Sn(this,this.l);break;case"lpstr-cp":s=rS(this,this.l),t=4+Sn(this,this.l);break;case"lpwstr":s=nS(this,this.l),t=4+2*Sn(this,this.l);break;case"lpp4":t=4+Sn(this,this.l),s=iS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Sn(this,this.l),s=oS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,s="";(c=Ql(this,this.l+t++))!==0;)l.push(cu(c));s=l.join("");break;case"_wstr":for(t=0,s="";(c=nc(this,this.l+t))!==0;)l.push(cu(c)),t+=2;t+=2,s=l.join("");break;case"dbcs-cont":for(s="",h=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return c=Ql(this,h),this.l=h+1,u=oc.call(this,t-f,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(cu(nc(this,h))),h+=2}s=l.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(s="",h=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return c=Ql(this,h),this.l=h+1,u=oc.call(this,t-f,c?"dbcs-cont":"sbcs-cont"),l.join("")+u;l.push(cu(Ql(this,h))),h+=1}s=l.join("");break;default:switch(t){case 1:return n=Ql(this,this.l),this.l++,n;case 2:return n=(r==="i"?Q9:nc)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(t>0?Vi:U9)(this,this.l),this.l+=4,n):(a=Sn(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return t==8?a=Gu(this,this.l):a=Gu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:s=Jj(this,this.l,t);break}}return this.l+=t,s}var V9=function(t,r,s){t[s]=r&255,t[s+1]=r>>>8&255,t[s+2]=r>>>16&255,t[s+3]=r>>>24&255},W9=function(t,r,s){t[s]=r&255,t[s+1]=r>>8&255,t[s+2]=r>>16&255,t[s+3]=r>>24&255},G9=function(t,r,s){t[s]=r&255,t[s+1]=r>>>8&255};function H9(t,r,s){var n=0,a=0;if(s==="dbcs"){for(a=0;a!=r.length;++a)G9(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(s==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(s==="hex"){for(;a<t;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(s==="utf16le"){var l=Math.min(this.l+t,this.length);for(a=0;a<Math.min(r.length,t);++a){var c=r.charCodeAt(a);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,V9(this,r,this.l);break;case 8:if(n=8,s==="f"){$9(this,r,this.l);break}case 16:break;case-4:n=4,W9(this,r,this.l);break}return this.l+=n,this}function dS(t,r){var s=Jj(this,this.l,t.length>>1);if(s!==t)throw new Error(r+"Expected "+t+" saw "+s);this.l+=t.length>>1}function wn(t,r){t.l=r,t.read_shift=oc,t.chk=dS,t.write_shift=H9}function wa(t,r){t.l+=r}function st(t){var r=sl(t);return wn(r,0),r}function mn(){var t=[],r=Er?256:2048,s=function(h){var y=st(h);return wn(y,0),y},n=s(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},l=function(h){return n&&h<n.length-n.l?n:(a(),n=s(Math.max(h+1,r)))},c=function(){return a(),Ds(t)},u=function(h){a(),n=h,n.l==null&&(n.l=n.length),l(r)};return{next:l,push:u,end:c,_bufs:t}}function dt(t,r,s,n){var a=+r,l;if(!isNaN(a)){n||(n=z7[a].p||(s||[]).length||0),l=1+(a>=128?1:0)+1,n>=128&&++l,n>=16384&&++l,n>=2097152&&++l;var c=t.next(l);a<=127?c.write_shift(1,a):(c.write_shift(1,(a&127)+128),c.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)c.write_shift(1,(n&127)+128),n>>=7;else{c.write_shift(1,n);break}n>0&&Th(s)&&t.push(s)}}function cc(t,r,s){var n=xn(t);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!s||s.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Ab(t,r,s){var n=xn(t);return n.s=cc(n.s,r.s,s),n.e=cc(n.e,r.s,s),n}function dc(t,r){if(t.cRel&&t.c<0)for(t=xn(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=xn(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var s=Fr(t);return!t.cRel&&t.cRel!=null&&(s=X9(s)),!t.rRel&&t.rRel!=null&&(s=Y9(s)),s}function G0(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Us(t.s.c)+":"+(t.e.cRel?"":"$")+Us(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Fs(t.s.r)+":"+(t.e.rRel?"":"$")+Fs(t.e.r):dc(t.s,r.biff)+":"+dc(t.e,r.biff)}function Oh(t){return parseInt(K9(t),10)-1}function Fs(t){return""+(t+1)}function Y9(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function K9(t){return t.replace(/\$(\d+)$/,"$1")}function Rh(t){for(var r=J9(t),s=0,n=0;n!==r.length;++n)s=26*s+r.charCodeAt(n)-64;return s-1}function Us(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function X9(t){return t.replace(/^([A-Z])/,"$$$1")}function J9(t){return t.replace(/^\$([A-Z])/,"$1")}function Z9(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Es(t){for(var r=0,s=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(s=26*s+(a-64))}return{c:s-1,r:r-1}}function Fr(t){for(var r=t.c+1,s="";r;r=(r-1)/26|0)s=String.fromCharCode((r-1)%26+65)+s;return s+(t.r+1)}function _n(t){var r=t.indexOf(":");return r==-1?{s:Es(t),e:Es(t)}:{s:Es(t.slice(0,r)),e:Es(t.slice(r+1))}}function fs(t,r){return typeof r>"u"||typeof r=="number"?fs(t.s,t.e):(typeof t!="string"&&(t=Fr(t)),typeof r!="string"&&(r=Fr(r)),t==r?t:t+":"+r)}function Vr(t){var r={s:{c:0,r:0},e:{c:0,r:0}},s=0,n=0,a=0,l=t.length;for(s=0;n<l&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)s=26*s+a;for(r.s.c=--s,s=0;n<l&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)s=10*s+a;if(r.s.r=--s,n===l||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,s=0;n!=l&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)s=26*s+a;for(r.e.c=--s,s=0;n!=l&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)s=10*s+a;return r.e.r=--s,r}function Tb(t,r){var s=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=Si(t.z,s?pn(r):r)}catch{}try{return t.w=Si((t.XF||{}).numFmtId||(s?14:0),s?pn(r):r)}catch{return""+r}}function Wa(t,r,s){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&s&&s.dateNF&&(t.z=s.dateNF),t.t=="e"?Vc[t.v]||t.v:r==null?Tb(t,t.v):Tb(t,r))}function il(t,r){var s=r&&r.sheet?r.sheet:"Sheet1",n={};return n[s]=t,{SheetNames:[s],Sheets:n}}function uS(t,r,s){var n=s||{},a=t?Array.isArray(t):n.dense,l=t||(a?[]:{}),c=0,u=0;if(l&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var f=typeof n.origin=="string"?Es(n.origin):n.origin;c=f.r,u=f.c}l["!ref"]||(l["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var y=Vr(l["!ref"]);h.s.c=y.s.c,h.s.r=y.s.r,h.e.c=Math.max(h.e.c,y.e.c),h.e.r=Math.max(h.e.r,y.e.r),c==-1&&(h.e.r=c=y.e.r+1)}for(var w=0;w!=r.length;++w)if(r[w]){if(!Array.isArray(r[w]))throw new Error("aoa_to_sheet expects an array of arrays");for(var j=0;j!=r[w].length;++j)if(!(typeof r[w][j]>"u")){var C={v:r[w][j]},k=c+w,S=u+j;if(h.s.r>k&&(h.s.r=k),h.s.c>S&&(h.s.c=S),h.e.r<k&&(h.e.r=k),h.e.c<S&&(h.e.c=S),r[w][j]&&typeof r[w][j]=="object"&&!Array.isArray(r[w][j])&&!(r[w][j]instanceof Date))C=r[w][j];else if(Array.isArray(C.v)&&(C.f=r[w][j][1],C.v=C.v[0]),C.v===null)if(C.f)C.t="n";else if(n.nullError)C.t="e",C.v=0;else if(n.sheetStubs)C.t="z";else continue;else typeof C.v=="number"?C.t="n":typeof C.v=="boolean"?C.t="b":C.v instanceof Date?(C.z=n.dateNF||as[14],n.cellDates?(C.t="d",C.w=Si(C.z,pn(C.v))):(C.t="n",C.v=pn(C.v),C.w=Si(C.z,C.v))):C.t="s";if(a)l[k]||(l[k]=[]),l[k][S]&&l[k][S].z&&(C.z=l[k][S].z),l[k][S]=C;else{var _=Fr({c:S,r:k});l[_]&&l[_].z&&(C.z=l[_].z),l[_]=C}}}return h.s.c<1e7&&(l["!ref"]=fs(h)),l}function ho(t,r){return uS(null,t,r)}function eF(t){return t.read_shift(4,"i")}function Kn(t,r){return r||(r=st(4)),r.write_shift(4,t),r}function Vs(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function Ps(t,r){var s=!1;return r==null&&(s=!0,r=st(4+2*t.length)),r.write_shift(4,t.length),t.length>0&&r.write_shift(0,t,"dbcs"),s?r.slice(0,r.l):r}function tF(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function rF(t,r){return r||(r=st(4)),r.write_shift(2,0),r.write_shift(2,0),r}function Dh(t,r){var s=t.l,n=t.read_shift(1),a=Vs(t),l=[],c={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),f=0;f!=u;++f)l.push(tF(t));c.r=l}else c.r=[{ich:0,ifnt:0}];return t.l=s+r,c}function sF(t,r){var s=!1;return r==null&&(s=!0,r=st(15+4*t.t.length)),r.write_shift(1,0),Ps(t.t,r),s?r.slice(0,r.l):r}var nF=Dh;function aF(t,r){var s=!1;return r==null&&(s=!0,r=st(23+4*t.t.length)),r.write_shift(1,1),Ps(t.t,r),r.write_shift(4,1),rF({},r),s?r.slice(0,r.l):r}function In(t){var r=t.read_shift(4),s=t.read_shift(2);return s+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:s}}function ll(t,r){return r==null&&(r=st(8)),r.write_shift(-4,t.c),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}function ol(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}function cl(t,r){return r==null&&(r=st(4)),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}var iF=Vs,mS=Ps;function Lh(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}function Hu(t,r){var s=!1;return r==null&&(s=!0,r=st(127)),r.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&r.write_shift(0,t,"dbcs"),s?r.slice(0,r.l):r}var lF=Vs,_x=Lh,Fh=Hu;function pS(t){var r=t.slice(t.l,t.l+4),s=r[0]&1,n=r[0]&2;t.l+=4;var a=n===0?Gu([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Vi(r,0)>>2;return s?a/100:a}function xS(t,r){r==null&&(r=st(4));var s=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,s=1),n)r.write_shift(-4,((s?a:t)<<2)+(s+2));else throw new Error("unsupported RkNumber "+t)}function hS(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}function oF(t,r){return r||(r=st(16)),r.write_shift(4,t.s.r),r.write_shift(4,t.e.r),r.write_shift(4,t.s.c),r.write_shift(4,t.e.c),r}var dl=hS,fo=oF;function go(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function nl(t,r){return(r||st(8)).write_shift(8,t,"f")}function cF(t){var r={},s=t.read_shift(1),n=s>>>1,a=t.read_shift(1),l=t.read_shift(2,"i"),c=t.read_shift(1),u=t.read_shift(1),f=t.read_shift(1);switch(t.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var h=yF[a];h&&(r.rgb=$b(h));break;case 2:r.rgb=$b([c,u,f]);break;case 3:r.theme=a;break}return l!=0&&(r.tint=l>0?l/32767:l/32768),r}function Yu(t,r){if(r||(r=st(8)),!t||t.auto)return r.write_shift(4,0),r.write_shift(4,0),r;t.index!=null?(r.write_shift(1,2),r.write_shift(1,t.index)):t.theme!=null?(r.write_shift(1,6),r.write_shift(1,t.theme)):(r.write_shift(1,5),r.write_shift(1,0));var s=t.tint||0;if(s>0?s*=32767:s<0&&(s*=32768),r.write_shift(2,s),!t.rgb||t.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function dF(t){var r=t.read_shift(1);t.l++;var s={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return s}function uF(t,r){r||(r=st(2));var s=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return r.write_shift(1,s),r.write_shift(1,0),r}var fS=2,bn=3,pu=11,Ku=19,xu=64,mF=65,pF=71,xF=4108,hF=4126,Rs=80,Ob={1:{n:"CodePage",t:fS},2:{n:"Category",t:Rs},3:{n:"PresentationFormat",t:Rs},4:{n:"ByteCount",t:bn},5:{n:"LineCount",t:bn},6:{n:"ParagraphCount",t:bn},7:{n:"SlideCount",t:bn},8:{n:"NoteCount",t:bn},9:{n:"HiddenCount",t:bn},10:{n:"MultimediaClipCount",t:bn},11:{n:"ScaleCrop",t:pu},12:{n:"HeadingPairs",t:xF},13:{n:"TitlesOfParts",t:hF},14:{n:"Manager",t:Rs},15:{n:"Company",t:Rs},16:{n:"LinksUpToDate",t:pu},17:{n:"CharacterCount",t:bn},19:{n:"SharedDoc",t:pu},22:{n:"HyperlinksChanged",t:pu},23:{n:"AppVersion",t:bn,p:"version"},24:{n:"DigSig",t:mF},26:{n:"ContentType",t:Rs},27:{n:"ContentStatus",t:Rs},28:{n:"Language",t:Rs},29:{n:"Version",t:Rs},255:{},2147483648:{n:"Locale",t:Ku},2147483651:{n:"Behavior",t:Ku},1919054434:{}},Rb={1:{n:"CodePage",t:fS},2:{n:"Title",t:Rs},3:{n:"Subject",t:Rs},4:{n:"Author",t:Rs},5:{n:"Keywords",t:Rs},6:{n:"Comments",t:Rs},7:{n:"Template",t:Rs},8:{n:"LastAuthor",t:Rs},9:{n:"RevNumber",t:Rs},10:{n:"EditTime",t:xu},11:{n:"LastPrinted",t:xu},12:{n:"CreatedDate",t:xu},13:{n:"ModifiedDate",t:xu},14:{n:"PageCount",t:bn},15:{n:"WordCount",t:bn},16:{n:"CharCount",t:bn},17:{n:"Thumbnail",t:pF},18:{n:"Application",t:Rs},19:{n:"DocSecurity",t:bn},255:{},2147483648:{n:"Locale",t:Ku},2147483651:{n:"Behavior",t:Ku},1919054434:{}};function fF(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var gF=fF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),yF=xn(gF),Vc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},vF={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function gS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function yS(t,r){var s=P9(vF),n=[],a;n[n.length]=ys,n[n.length]=Lt("Types",null,{xmlns:_s.CT,"xmlns:xsd":_s.xsd,"xmlns:xsi":_s.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Lt("Default",null,{Extension:f[0],ContentType:f[1]})}));var l=function(f){t[f]&&t[f].length>0&&(a=t[f][0],n[n.length]=Lt("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:hu[f][r.bookType]||hu[f].xlsx}))},c=function(f){(t[f]||[]).forEach(function(h){n[n.length]=Lt("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:hu[f][r.bookType]||hu[f].xlsx})})},u=function(f){(t[f]||[]).forEach(function(h){n[n.length]=Lt("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:s[f][0]})})};return l("workbooks"),c("sheets"),c("charts"),u("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),c("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Cr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vS(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function Hl(t){var r=[ys,Lt("Relationships",null,{xmlns:_s.RELS})];return Ms(t["!id"]).forEach(function(s){r[r.length]=Lt("Relationship",null,t["!id"][s])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Dr(t,r,s,n,a,l){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),r<0)for(r=t["!idx"];t["!id"]["rId"+r];++r);if(t["!idx"]=r+1,a.Id="rId"+r,a.Type=n,a.Target=s,[Cr.HLINK,Cr.XPATH,Cr.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+r);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,r}function bF(t){var r=[ys];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var s=0;s<t.length;++s)r.push('  <manifest:file-entry manifest:full-path="'+t[s][0]+'" manifest:media-type="'+t[s][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Db(t,r,s){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(s||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function wF(t,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function NF(t){var r=[ys];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var s=0;s!=t.length;++s)r.push(Db(t[s][0],t[s][1])),r.push(wF("",t[s][0]));return r.push(Db("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function bS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+zu.version+"</meta:generator></office:meta></office:document-meta>"}var Yi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function H0(t,r,s,n,a){a[t]!=null||r==null||r===""||(a[t]=r,r=Lr(r),n[n.length]=s?Lt(t,r,s):Ls(t,r))}function wS(t,r){var s=r||{},n=[ys,Lt("cp:coreProperties",null,{"xmlns:cp":_s.CORE_PROPS,"xmlns:dc":_s.dc,"xmlns:dcterms":_s.dcterms,"xmlns:dcmitype":_s.dcmitype,"xmlns:xsi":_s.xsi})],a={};if(!t&&!s.Props)return n.join("");t&&(t.CreatedDate!=null&&H0("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Cx(t.CreatedDate,s.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&H0("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Cx(t.ModifiedDate,s.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var l=0;l!=Yi.length;++l){var c=Yi[l],u=s.Props&&s.Props[c[1]]!=null?s.Props[c[1]]:t?t[c[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&H0(c[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Yl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],NS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function jS(t){var r=[],s=Lt;return t||(t={}),t.Application="SheetJS",r[r.length]=ys,r[r.length]=Lt("Properties",null,{xmlns:_s.EXT_PROPS,"xmlns:vt":_s.vt}),Yl.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Lr(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(r[r.length]=s(n[0],a))}}),r[r.length]=s("HeadingPairs",s("vt:vector",s("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+s("vt:variant",s("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=s("TitlesOfParts",s("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Lr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function SS(t){var r=[ys,Lt("Properties",null,{xmlns:_s.CUST_PROPS,"xmlns:vt":_s.vt})];if(!t)return r.join("");var s=1;return Ms(t).forEach(function(a){++s,r[r.length]=Lt("property",B9(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:s,name:Lr(a)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Lb={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function jF(t,r){var s=[];return Ms(Lb).map(function(n){for(var a=0;a<Yi.length;++a)if(Yi[a][1]==n)return Yi[a];for(a=0;a<Yl.length;++a)if(Yl[a][1]==n)return Yl[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),s.push(Ls(Lb[n[1]]||n[1],a))}}),Lt("DocumentProperties",s.join(""),{xmlns:jn.o})}function SF(t,r){var s=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Ms(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)){for(var c=0;c<Yi.length;++c)if(l==Yi[c][1])return;for(c=0;c<Yl.length;++c)if(l==Yl[c][1])return;for(c=0;c<s.length;++c)if(l==s[c])return;var u=t[l],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),a.push(Lt(Nb(l),u,{"dt:dt":f}))}}),r&&Ms(r).forEach(function(l){if(Object.prototype.hasOwnProperty.call(r,l)&&!(t&&Object.prototype.hasOwnProperty.call(t,l))){var c=r[l],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c instanceof Date?(u="dateTime.tz",c=c.toISOString()):c=String(c),a.push(Lt(Nb(l),c,{"dt:dt":u}))}}),"<"+n+' xmlns="'+jn.o+'">'+a.join("")+"</"+n+">"}function kF(t){var r=typeof t=="string"?new Date(Date.parse(t)):t,s=r.getTime()/1e3+11644473600,n=s%Math.pow(2,32),a=(s-n)/Math.pow(2,32);n*=1e7,a*=1e7;var l=n/Math.pow(2,32)|0;l>0&&(n=n%Math.pow(2,32),a+=l);var c=st(8);return c.write_shift(4,n),c.write_shift(4,a),c}function Fb(t,r){var s=st(4),n=st(4);switch(s.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,r);break;case 5:n=st(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=kF(r);break;case 31:case 80:for(n=st(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}return Ds([s,n])}var kS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function CF(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Mb(t,r,s){var n=st(8),a=[],l=[],c=8,u=0,f=st(8),h=st(8);if(f.write_shift(4,2),f.write_shift(4,1200),h.write_shift(4,1),l.push(f),a.push(h),c+=8+f.length,!r){h=st(8),h.write_shift(4,0),a.unshift(h);var y=[st(4)];for(y[0].write_shift(4,t.length),u=0;u<t.length;++u){var w=t[u][0];for(f=st(8+2*(w.length+1)+(w.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,w.length+1),f.write_shift(0,w,"dbcs");f.l!=f.length;)f.write_shift(1,0);y.push(f)}f=Ds(y),l.unshift(f),c+=8+f.length}for(u=0;u<t.length;++u)if(!(r&&!r[t[u][0]])&&!(kS.indexOf(t[u][0])>-1||NS.indexOf(t[u][0])>-1)&&t[u][1]!=null){var j=t[u][1],C=0;if(r){C=+r[t[u][0]];var k=s[C];if(k.p=="version"&&typeof j=="string"){var S=j.split(".");j=(+S[0]<<16)+(+S[1]||0)}f=Fb(k.t,j)}else{var _=CF(j);_==-1&&(_=31,j=String(j)),f=Fb(_,j)}l.push(f),h=st(8),h.write_shift(4,r?C:2+u),a.push(h),c+=8+f.length}var I=8*(l.length+1);for(u=0;u<l.length;++u)a[u].write_shift(4,I),I+=l[u].length;return n.write_shift(4,c),n.write_shift(4,l.length),Ds([n].concat(a).concat(l))}function Ib(t,r,s,n,a,l){var c=st(a?68:48),u=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,Mr.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,a?2:1),c.write_shift(16,r,"hex"),c.write_shift(4,a?68:48);var f=Mb(t,s,n);if(u.push(f),a){var h=Mb(a,null,null);c.write_shift(16,l,"hex"),c.write_shift(4,68+f.length),u.push(h)}return Ds(u)}function _F(t,r){r||(r=st(t));for(var s=0;s<t;++s)r.write_shift(1,0);return r}function EF(t,r){return t.read_shift(r)===1}function Xs(t,r){return r||(r=st(2)),r.write_shift(2,+!!t),r}function CS(t){return t.read_shift(2,"u")}function Fn(t,r){return r||(r=st(2)),r.write_shift(2,t),r}function _S(t,r,s){return s||(s=st(2)),s.write_shift(1,r=="e"?+t:+!!t),s.write_shift(1,r=="e"?1:0),s}function ES(t,r,s){var n=t.read_shift(s&&s.biff>=12?2:1),a="sbcs-cont";if(s&&s.biff>=8,!s||s.biff==8){var l=t.read_shift(1);l&&(a="dbcs-cont")}else s.biff==12&&(a="wstr");s.biff>=2&&s.biff<=5&&(a="cpstr");var c=n?t.read_shift(n,a):"";return c}function PF(t){var r=t.t||"",s=st(3);s.write_shift(2,r.length),s.write_shift(1,1);var n=st(2*r.length);n.write_shift(2*r.length,r,"utf16le");var a=[s,n];return Ds(a)}function AF(t,r,s){var n;if(s){if(s.biff>=2&&s.biff<=5)return t.read_shift(r,"cpstr");if(s.biff>=12)return t.read_shift(r,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(r,"sbcs-cont"):n=t.read_shift(r,"dbcs-cont"),n}function TF(t,r,s){var n=t.read_shift(s&&s.biff==2?1:2);return n===0?(t.l++,""):AF(t,n,s)}function OF(t,r,s){if(s.biff>5)return TF(t,r,s);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,s.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function PS(t,r,s){return s||(s=st(3+2*t.length)),s.write_shift(2,t.length),s.write_shift(1,1),s.write_shift(31,t,"utf16le"),s}function qb(t,r){r||(r=st(6+t.length*2)),r.write_shift(4,1+t.length);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function RF(t){var r=st(512),s=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),l=a>-1?31:23;switch(n.charAt(0)){case"#":l=28;break;case".":l&=-3;break}r.write_shift(4,2),r.write_shift(4,l);var c=[8,6815827,6619237,4849780,83];for(s=0;s<c.length;++s)r.write_shift(4,c[s]);if(l==28)n=n.slice(1),qb(n,r);else if(l&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<c.length;++s)r.write_shift(1,parseInt(c[s],16));var u=a>-1?n.slice(0,a):n;for(r.write_shift(4,2*(u.length+1)),s=0;s<u.length;++s)r.write_shift(2,u.charCodeAt(s));r.write_shift(2,0),l&8&&qb(a>-1?n.slice(a+1):"",r)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),s=0;s<c.length;++s)r.write_shift(1,parseInt(c[s],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(r.write_shift(2,f),r.write_shift(4,n.length-3*f+1),s=0;s<n.length-3*f;++s)r.write_shift(1,n.charCodeAt(s+3*f)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),s=0;s<6;++s)r.write_shift(4,0)}return r.slice(0,r.l)}function al(t,r,s,n){return n||(n=st(6)),n.write_shift(2,t),n.write_shift(2,r),n.write_shift(2,s||0),n}function DF(t,r,s){var n=s.biff>8?4:2,a=t.read_shift(n),l=t.read_shift(n,"i"),c=t.read_shift(n,"i");return[a,l,c]}function LF(t){var r=t.read_shift(2),s=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r},e:{c:a,r:s}}}function AS(t,r){return r||(r=st(8)),r.write_shift(2,t.s.r),r.write_shift(2,t.e.r),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c),r}function Mh(t,r,s){var n=1536,a=16;switch(s.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=st(a);return l.write_shift(2,n),l.write_shift(2,r),a>4&&l.write_shift(2,29282),a>6&&l.write_shift(2,1997),a>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function FF(t,r){var s=!r||r.biff==8,n=st(s?112:54);for(n.write_shift(r.biff==8?2:1,7),s&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(s?0:536870912));n.l<n.length;)n.write_shift(1,s?0:32);return n}function MF(t,r){var s=!r||r.biff>=8?2:1,n=st(8+s*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(s*t.name.length,t.name,r.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function IF(t,r){var s=st(8);s.write_shift(4,t.Count),s.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=PF(t[a]);var l=Ds([s].concat(n));return l.parts=[s.length].concat(n.map(function(c){return c.length})),l}function qF(){var t=st(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function BF(t){var r=st(18),s=1718;return t&&t.RTL&&(s|=64),r.write_shift(2,s),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function zF(t,r){var s=t.name||"Arial",n=r&&r.biff==5,a=n?15+s.length:16+2*s.length,l=st(a);return l.write_shift(2,t.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,s.length),n||l.write_shift(1,1),l.write_shift((n?1:2)*s.length,s,n?"sbcs":"utf16le"),l}function $F(t,r,s,n){var a=st(10);return al(t,r,n,a),a.write_shift(4,s),a}function QF(t,r,s,n,a){var l=!a||a.biff==8,c=st(8+ +l+(1+l)*s.length);return al(t,r,n,c),c.write_shift(2,s.length),l&&c.write_shift(1,1),c.write_shift((1+l)*s.length,s,l?"utf16le":"sbcs"),c}function UF(t,r,s,n){var a=s&&s.biff==5;n||(n=st(a?3+r.length:5+2*r.length)),n.write_shift(2,t),n.write_shift(a?1:2,r.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le");var l=n.length>n.l?n.slice(0,n.l):n;return l.l==null&&(l.l=l.length),l}function VF(t,r){var s=r.biff==8||!r.biff?4:2,n=st(2*s+6);return n.write_shift(s,t.s.r),n.write_shift(s,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function Bb(t,r,s,n){var a=s&&s.biff==5;n||(n=st(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,r<<4));var l=0;return t.numFmtId>0&&a&&(l|=1024),n.write_shift(4,l),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function WF(t){var r=st(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function GF(t,r,s,n,a,l){var c=st(8);return al(t,r,n,c),_S(s,l,c),c}function HF(t,r,s,n){var a=st(14);return al(t,r,n,a),nl(s,a),a}function YF(t,r,s){if(s.biff<8)return KF(t,r,s);for(var n=[],a=t.l+r,l=t.read_shift(s.biff>8?4:2);l--!==0;)n.push(DF(t,s.biff>8?12:6,s));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function KF(t,r,s){t[t.l+1]==3&&t[t.l]++;var n=ES(t,r,s);return n.charCodeAt(0)==3?n.slice(1):n}function XF(t){var r=st(2+t.length*8);r.write_shift(2,t.length);for(var s=0;s<t.length;++s)AS(t[s],r);return r}function JF(t){var r=st(24),s=Es(t[0]);r.write_shift(2,s.r),r.write_shift(2,s.r),r.write_shift(2,s.c),r.write_shift(2,s.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)r.write_shift(1,parseInt(n[a],16));return Ds([r,RF(t[1])])}function ZF(t){var r=t[1].Tooltip,s=st(10+2*(r.length+1));s.write_shift(2,2048);var n=Es(t[0]);s.write_shift(2,n.r),s.write_shift(2,n.r),s.write_shift(2,n.c),s.write_shift(2,n.c);for(var a=0;a<r.length;++a)s.write_shift(2,r.charCodeAt(a));return s.write_shift(2,0),s}function eM(t){return t||(t=st(4)),t.write_shift(2,1),t.write_shift(2,1),t}function tM(t,r,s){if(!s.cellStyles)return wa(t,r);var n=s&&s.biff>=12?4:2,a=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(n),u=t.read_shift(n),f=t.read_shift(2);n==2&&(t.l+=2);var h={s:a,e:l,w:c,ixfe:u,flags:f};return(s.biff>=5||!s.biff)&&(h.level=f>>8&7),h}function rM(t,r){var s=st(12);s.write_shift(2,r),s.write_shift(2,r),s.write_shift(2,t.width*256),s.write_shift(2,0);var n=0;return t.hidden&&(n|=1),s.write_shift(1,n),n=t.level||0,s.write_shift(1,n),s.write_shift(2,0),s}function sM(t){for(var r=st(2*t),s=0;s<t;++s)r.write_shift(2,s+1);return r}function nM(t,r,s){var n=st(15);return Gc(n,t,r),n.write_shift(8,s,"f"),n}function aM(t,r,s){var n=st(9);return Gc(n,t,r),n.write_shift(2,s),n}var iM=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Ch({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function s(u,f){var h=[],y=sl(1);switch(f.type){case"base64":y=Hn(Va(u));break;case"binary":y=Hn(u);break;case"buffer":case"array":y=u;break}wn(y,0);var w=y.read_shift(1),j=!!(w&136),C=!1,k=!1;switch(w){case 2:break;case 3:break;case 48:C=!0,j=!0;break;case 49:C=!0,j=!0;break;case 131:break;case 139:break;case 140:k=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+w.toString(16))}var S=0,_=521;w==2&&(S=y.read_shift(2)),y.l+=3,w!=2&&(S=y.read_shift(4)),S>1048576&&(S=1e6),w!=2&&(_=y.read_shift(2));var I=y.read_shift(2),F=f.codepage||1252;w!=2&&(y.l+=16,y.read_shift(1),y[y.l]!==0&&(F=t[y[y.l]]),y.l+=1,y.l+=2),k&&(y.l+=36);for(var B=[],q={},me=Math.min(y.length,w==2?521:_-10-(C?264:0)),re=k?32:11;y.l<me&&y[y.l]!=13;)switch(q={},q.name=$u.utils.decode(F,y.slice(y.l,y.l+re)).replace(/[\u0000\r\n].*$/g,""),y.l+=re,q.type=String.fromCharCode(y.read_shift(1)),w!=2&&!k&&(q.offset=y.read_shift(4)),q.len=y.read_shift(1),w==2&&(q.offset=y.read_shift(2)),q.dec=y.read_shift(1),q.name.length&&B.push(q),w!=2&&(y.l+=k?13:14),q.type){case"B":(!C||q.len!=8)&&f.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+q.type)}if(y[y.l]!==13&&(y.l=_-1),y.read_shift(1)!==13)throw new Error("DBF Terminator not found "+y.l+" "+y[y.l]);y.l=_;var M=0,G=0;for(h[0]=[],G=0;G!=B.length;++G)h[0][G]=B[G].name;for(;S-- >0;){if(y[y.l]===42){y.l+=I;continue}for(++y.l,h[++M]=[],G=0,G=0;G!=B.length;++G){var le=y.slice(y.l,y.l+B[G].len);y.l+=B[G].len,wn(le,0);var Z=$u.utils.decode(F,le);switch(B[G].type){case"C":Z.trim().length&&(h[M][G]=Z.replace(/\s+$/,""));break;case"D":Z.length===8?h[M][G]=new Date(+Z.slice(0,4),+Z.slice(4,6)-1,+Z.slice(6,8)):h[M][G]=Z;break;case"F":h[M][G]=parseFloat(Z.trim());break;case"+":case"I":h[M][G]=k?le.read_shift(-4,"i")^2147483648:le.read_shift(4,"i");break;case"L":switch(Z.trim().toUpperCase()){case"Y":case"T":h[M][G]=!0;break;case"N":case"F":h[M][G]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Z+"|")}break;case"M":if(!j)throw new Error("DBF Unexpected MEMO for type "+w.toString(16));h[M][G]="##MEMO##"+(k?parseInt(Z.trim(),10):le.read_shift(4));break;case"N":Z=Z.replace(/\u0000/g,"").trim(),Z&&Z!="."&&(h[M][G]=+Z||0);break;case"@":h[M][G]=new Date(le.read_shift(-8,"f")-621356832e5);break;case"T":h[M][G]=new Date((le.read_shift(4)-2440588)*864e5+le.read_shift(4));break;case"Y":h[M][G]=le.read_shift(4,"i")/1e4+le.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[M][G]=-le.read_shift(-8,"f");break;case"B":if(C&&B[G].len==8){h[M][G]=le.read_shift(8,"f");break}case"G":case"P":le.l+=B[G].len;break;case"0":if(B[G].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+B[G].type)}}}if(w!=2&&y.l<y.length&&y[y.l++]!=26)throw new Error("DBF EOF Marker missing "+(y.l-1)+" of "+y.length+" "+y[y.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=B,h}function n(u,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var y=ho(s(u,h),h);return y["!cols"]=h.DBF.map(function(w){return{wch:w.len,DBF:w}}),delete h.DBF,y}function a(u,f){try{return il(n(u,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,f){var h=f||{};if(+h.codepage>=0&&fc(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var y=mn(),w=tm(u,{header:1,raw:!0,cellDates:!0}),j=w[0],C=w.slice(1),k=u["!cols"]||[],S=0,_=0,I=0,F=1;for(S=0;S<j.length;++S){if(((k[S]||{}).DBF||{}).name){j[S]=k[S].DBF.name,++I;continue}if(j[S]!=null){if(++I,typeof j[S]=="number"&&(j[S]=j[S].toString(10)),typeof j[S]!="string")throw new Error("DBF Invalid column name "+j[S]+" |"+typeof j[S]+"|");if(j.indexOf(j[S])!==S){for(_=0;_<1024;++_)if(j.indexOf(j[S]+"_"+_)==-1){j[S]+="_"+_;break}}}}var B=Vr(u["!ref"]),q=[],me=[],re=[];for(S=0;S<=B.e.c-B.s.c;++S){var M="",G="",le=0,Z=[];for(_=0;_<C.length;++_)C[_][S]!=null&&Z.push(C[_][S]);if(Z.length==0||j[S]==null){q[S]="?";continue}for(_=0;_<Z.length;++_){switch(typeof Z[_]){case"number":G="B";break;case"string":G="C";break;case"boolean":G="L";break;case"object":G=Z[_]instanceof Date?"D":"C";break;default:G="C"}le=Math.max(le,String(Z[_]).length),M=M&&M!=G?"C":G}le>250&&(le=250),G=((k[S]||{}).DBF||{}).type,G=="C"&&k[S].DBF.len>le&&(le=k[S].DBF.len),M=="B"&&G=="N"&&(M="N",re[S]=k[S].DBF.dec,le=k[S].DBF.len),me[S]=M=="C"||G=="N"?le:l[M]||0,F+=me[S],q[S]=M}var he=y.next(32);for(he.write_shift(4,318902576),he.write_shift(4,C.length),he.write_shift(2,296+32*I),he.write_shift(2,F),S=0;S<4;++S)he.write_shift(4,0);for(he.write_shift(4,0|(+r[Oj]||3)<<8),S=0,_=0;S<j.length;++S)if(j[S]!=null){var ce=y.next(32),ke=(j[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ce.write_shift(1,ke,"sbcs"),ce.write_shift(1,q[S]=="?"?"C":q[S],"sbcs"),ce.write_shift(4,_),ce.write_shift(1,me[S]||l[q[S]]||0),ce.write_shift(1,re[S]||0),ce.write_shift(1,2),ce.write_shift(4,0),ce.write_shift(1,0),ce.write_shift(4,0),ce.write_shift(4,0),_+=me[S]||l[q[S]]||0}var Ee=y.next(264);for(Ee.write_shift(4,13),S=0;S<65;++S)Ee.write_shift(4,0);for(S=0;S<C.length;++S){var Fe=y.next(F);for(Fe.write_shift(1,0),_=0;_<j.length;++_)if(j[_]!=null)switch(q[_]){case"L":Fe.write_shift(1,C[S][_]==null?63:C[S][_]?84:70);break;case"B":Fe.write_shift(8,C[S][_]||0,"f");break;case"N":var X="0";for(typeof C[S][_]=="number"&&(X=C[S][_].toFixed(re[_]||0)),I=0;I<me[_]-X.length;++I)Fe.write_shift(1,32);Fe.write_shift(1,X,"sbcs");break;case"D":C[S][_]?(Fe.write_shift(4,("0000"+C[S][_].getFullYear()).slice(-4),"sbcs"),Fe.write_shift(2,("00"+(C[S][_].getMonth()+1)).slice(-2),"sbcs"),Fe.write_shift(2,("00"+C[S][_].getDate()).slice(-2),"sbcs")):Fe.write_shift(8,"00000000","sbcs");break;case"C":var ye=String(C[S][_]!=null?C[S][_]:"").slice(0,me[_]);for(Fe.write_shift(1,ye,"sbcs"),I=0;I<me[_]-ye.length;++I)Fe.write_shift(1,32);break}}return y.next(1).write_shift(1,26),y.end()}return{to_workbook:a,to_sheet:n,from_sheet:c}})(),lM=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Ms(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),s=function(j,C){var k=t[C];return typeof k=="number"?db(k):k},n=function(j,C,k){var S=C.charCodeAt(0)-32<<4|k.charCodeAt(0)-48;return S==59?j:db(S)};t["|"]=254;function a(j,C){switch(C.type){case"base64":return l(Va(j),C);case"binary":return l(j,C);case"buffer":return l(Er&&Buffer.isBuffer(j)?j.toString("binary"):$c(j),C);case"array":return l(Om(j),C)}throw new Error("Unrecognized type "+C.type)}function l(j,C){var k=j.split(/[\n\r]+/),S=-1,_=-1,I=0,F=0,B=[],q=[],me=null,re={},M=[],G=[],le=[],Z=0,he;for(+C.codepage>=0&&fc(+C.codepage);I!==k.length;++I){Z=0;var ce=k[I].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,s),ke=ce.replace(/;;/g,"\0").split(";").map(function(ne){return ne.replace(/\u0000/g,";")}),Ee=ke[0],Fe;if(ce.length>0)switch(Ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ke[1].charAt(0)=="P"&&q.push(ce.slice(3).replace(/;;/g,";"));break;case"C":var X=!1,ye=!1,Q=!1,we=!1,pe=-1,se=-1;for(F=1;F<ke.length;++F)switch(ke[F].charAt(0)){case"A":break;case"X":_=parseInt(ke[F].slice(1))-1,ye=!0;break;case"Y":for(S=parseInt(ke[F].slice(1))-1,ye||(_=0),he=B.length;he<=S;++he)B[he]=[];break;case"K":Fe=ke[F].slice(1),Fe.charAt(0)==='"'?Fe=Fe.slice(1,Fe.length-1):Fe==="TRUE"?Fe=!0:Fe==="FALSE"?Fe=!1:isNaN(Ba(Fe))?isNaN(yc(Fe).getDate())||(Fe=Js(Fe)):(Fe=Ba(Fe),me!==null&&Uj(me)&&(Fe=Hj(Fe))),X=!0;break;case"E":we=!0;var U=aI(ke[F].slice(1),{r:S,c:_});B[S][_]=[B[S][_],U];break;case"S":Q=!0,B[S][_]=[B[S][_],"S5S"];break;case"G":break;case"R":pe=parseInt(ke[F].slice(1))-1;break;case"C":se=parseInt(ke[F].slice(1))-1;break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+ce)}if(X&&(B[S][_]&&B[S][_].length==2?B[S][_][0]=Fe:B[S][_]=Fe,me=null),Q){if(we)throw new Error("SYLK shared formula cannot have own formula");var ue=pe>-1&&B[pe][se];if(!ue||!ue[1])throw new Error("SYLK shared formula cannot find base");B[S][_][1]=iI(ue[1],{r:S-pe,c:_-se})}break;case"F":var z=0;for(F=1;F<ke.length;++F)switch(ke[F].charAt(0)){case"X":_=parseInt(ke[F].slice(1))-1,++z;break;case"Y":for(S=parseInt(ke[F].slice(1))-1,he=B.length;he<=S;++he)B[he]=[];break;case"M":Z=parseInt(ke[F].slice(1))/20;break;case"F":break;case"G":break;case"P":me=q[parseInt(ke[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(le=ke[F].slice(1).split(" "),he=parseInt(le[0],10);he<=parseInt(le[1],10);++he)Z=parseInt(le[2],10),G[he-1]=Z===0?{hidden:!0}:{wch:Z},Ih(G[he-1]);break;case"C":_=parseInt(ke[F].slice(1))-1,G[_]||(G[_]={});break;case"R":S=parseInt(ke[F].slice(1))-1,M[S]||(M[S]={}),Z>0?(M[S].hpt=Z,M[S].hpx=LS(Z)):Z===0&&(M[S].hidden=!0);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+ce)}z<1&&(me=null);break;default:if(C&&C.WTF)throw new Error("SYLK bad record "+ce)}}return M.length>0&&(re["!rows"]=M),G.length>0&&(re["!cols"]=G),C&&C.sheetRows&&(B=B.slice(0,C.sheetRows)),[B,re]}function c(j,C){var k=a(j,C),S=k[0],_=k[1],I=ho(S,C);return Ms(_).forEach(function(F){I[F]=_[F]}),I}function u(j,C){return il(c(j,C),C)}function f(j,C,k,S){var _="C;Y"+(k+1)+";X"+(S+1)+";K";switch(j.t){case"n":_+=j.v||0,j.f&&!j.F&&(_+=";E"+Bh(j.f,{r:k,c:S}));break;case"b":_+=j.v?"TRUE":"FALSE";break;case"e":_+=j.w||j.v;break;case"d":_+='"'+(j.w||j.v)+'"';break;case"s":_+='"'+j.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function h(j,C){C.forEach(function(k,S){var _="F;W"+(S+1)+" "+(S+1)+" ";k.hidden?_+="0":(typeof k.width=="number"&&!k.wpx&&(k.wpx=Xu(k.width)),typeof k.wpx=="number"&&!k.wch&&(k.wch=Ju(k.wpx)),typeof k.wch=="number"&&(_+=Math.round(k.wch))),_.charAt(_.length-1)!=" "&&j.push(_)})}function y(j,C){C.forEach(function(k,S){var _="F;";k.hidden?_+="M0;":k.hpt?_+="M"+20*k.hpt+";":k.hpx&&(_+="M"+20*Zu(k.hpx)+";"),_.length>2&&j.push(_+"R"+(S+1))})}function w(j,C){var k=["ID;PWXL;N;E"],S=[],_=Vr(j["!ref"]),I,F=Array.isArray(j),B=`\r
`;k.push("P;PGeneral"),k.push("F;P0;DG0G8;M255"),j["!cols"]&&h(k,j["!cols"]),j["!rows"]&&y(k,j["!rows"]),k.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var q=_.s.r;q<=_.e.r;++q)for(var me=_.s.c;me<=_.e.c;++me){var re=Fr({r:q,c:me});I=F?(j[q]||[])[me]:j[re],!(!I||I.v==null&&(!I.f||I.F))&&S.push(f(I,j,q,me))}return k.join(B)+B+S.join(B)+B+"E"+B}return{to_workbook:u,to_sheet:c,from_sheet:w}})(),oM=(function(){function t(l,c){switch(c.type){case"base64":return r(Va(l),c);case"binary":return r(l,c);case"buffer":return r(Er&&Buffer.isBuffer(l)?l.toString("binary"):$c(l),c);case"array":return r(Om(l),c)}throw new Error("Unrecognized type "+c.type)}function r(l,c){for(var u=l.split(`
`),f=-1,h=-1,y=0,w=[];y!==u.length;++y){if(u[y].trim()==="BOT"){w[++f]=[],h=0;continue}if(!(f<0)){var j=u[y].trim().split(","),C=j[0],k=j[1];++y;for(var S=u[y]||"";(S.match(/["]/g)||[]).length&1&&y<u.length-1;)S+=`
`+u[++y];switch(S=S.trim(),+C){case-1:if(S==="BOT"){w[++f]=[],h=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?w[f][h]=!0:S==="FALSE"?w[f][h]=!1:isNaN(Ba(k))?isNaN(yc(k).getDate())?w[f][h]=k:w[f][h]=Js(k):w[f][h]=Ba(k),++h;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),w[f][h++]=S!==""?S:null;break}if(S==="EOD")break}}return c&&c.sheetRows&&(w=w.slice(0,c.sheetRows)),w}function s(l,c){return ho(t(l,c),c)}function n(l,c){return il(s(l,c),c)}var a=(function(){var l=function(f,h,y,w,j){f.push(h),f.push(y+","+w),f.push('"'+j.replace(/"/g,'""')+'"')},c=function(f,h,y,w){f.push(h+","+y),f.push(h==1?'"'+w.replace(/"/g,'""')+'"':w)};return function(f){var h=[],y=Vr(f["!ref"]),w,j=Array.isArray(f);l(h,"TABLE",0,1,"sheetjs"),l(h,"VECTORS",0,y.e.r-y.s.r+1,""),l(h,"TUPLES",0,y.e.c-y.s.c+1,""),l(h,"DATA",0,0,"");for(var C=y.s.r;C<=y.e.r;++C){c(h,-1,0,"BOT");for(var k=y.s.c;k<=y.e.c;++k){var S=Fr({r:C,c:k});if(w=j?(f[C]||[])[k]:f[S],!w){c(h,1,0,"");continue}switch(w.t){case"n":var _=w.w;!_&&w.v!=null&&(_=w.v),_==null?w.f&&!w.F?c(h,1,0,"="+w.f):c(h,1,0,""):c(h,0,_,"V");break;case"b":c(h,0,w.v?1:0,w.v?"TRUE":"FALSE");break;case"s":c(h,1,0,isNaN(w.v)?w.v:'="'+w.v+'"');break;case"d":w.w||(w.w=Si(w.z||as[14],pn(Js(w.v)))),c(h,0,w.w,"V");break;default:c(h,1,0,"")}}}c(h,-1,0,"EOD");var I=`\r
`,F=h.join(I);return F}})();return{to_workbook:n,to_sheet:s,from_sheet:a}})(),TS=(function(){function t(w){return w.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(w){return w.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function s(w,j){for(var C=w.split(`
`),k=-1,S=-1,_=0,I=[];_!==C.length;++_){var F=C[_].trim().split(":");if(F[0]==="cell"){var B=Es(F[1]);if(I.length<=B.r)for(k=I.length;k<=B.r;++k)I[k]||(I[k]=[]);switch(k=B.r,S=B.c,F[2]){case"t":I[k][S]=t(F[3]);break;case"v":I[k][S]=+F[3];break;case"vtf":var q=F[F.length-1];case"vtc":switch(F[3]){case"nl":I[k][S]=!!+F[4];break;default:I[k][S]=+F[4];break}F[2]=="vtf"&&(I[k][S]=[I[k][S],q])}}}return j&&j.sheetRows&&(I=I.slice(0,j.sheetRows)),I}function n(w,j){return ho(s(w,j),j)}function a(w,j){return il(n(w,j),j)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(w){if(!w||!w["!ref"])return"";for(var j=[],C=[],k,S="",_=_n(w["!ref"]),I=Array.isArray(w),F=_.s.r;F<=_.e.r;++F)for(var B=_.s.c;B<=_.e.c;++B)if(S=Fr({r:F,c:B}),k=I?(w[F]||[])[B]:w[S],!(!k||k.v==null||k.t==="z")){switch(C=["cell",S,"t"],k.t){case"s":case"str":C.push(r(k.v));break;case"n":k.f?(C[2]="vtf",C[3]="n",C[4]=k.v,C[5]=r(k.f)):(C[2]="v",C[3]=k.v);break;case"b":C[2]="vt"+(k.f?"f":"c"),C[3]="nl",C[4]=k.v?"1":"0",C[5]=r(k.f||(k.v?"TRUE":"FALSE"));break;case"d":var q=pn(Js(k.v));C[2]="vtc",C[3]="nd",C[4]=""+q,C[5]=k.w||Si(k.z||as[14],q);break;case"e":continue}j.push(C.join(":"))}return j.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),j.push("valueformat:1:text-wiki"),j.join(`
`)}function y(w){return[l,c,u,c,h(w),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:y}})(),cM=(function(){function t(y,w,j,C,k){k.raw?w[j][C]=y:y===""||(y==="TRUE"?w[j][C]=!0:y==="FALSE"?w[j][C]=!1:isNaN(Ba(y))?isNaN(yc(y).getDate())?w[j][C]=y:w[j][C]=Js(y):w[j][C]=Ba(y))}function r(y,w){var j=w||{},C=[];if(!y||y.length===0)return C;for(var k=y.split(/[\r\n]/),S=k.length-1;S>=0&&k[S].length===0;)--S;for(var _=10,I=0,F=0;F<=S;++F)I=k[F].indexOf(" "),I==-1?I=k[F].length:I++,_=Math.max(_,I);for(F=0;F<=S;++F){C[F]=[];var B=0;for(t(k[F].slice(0,_).trim(),C,F,B,j),B=1;B<=(k[F].length-_)/10+1;++B)t(k[F].slice(_+(B-1)*10,_+B*10).trim(),C,F,B,j)}return j.sheetRows&&(C=C.slice(0,j.sheetRows)),C}var s={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(y){for(var w={},j=!1,C=0,k=0;C<y.length;++C)(k=y.charCodeAt(C))==34?j=!j:!j&&k in s&&(w[k]=(w[k]||0)+1);k=[];for(C in w)Object.prototype.hasOwnProperty.call(w,C)&&k.push([w[C],C]);if(!k.length){w=n;for(C in w)Object.prototype.hasOwnProperty.call(w,C)&&k.push([w[C],C])}return k.sort(function(S,_){return S[0]-_[0]||n[S[1]]-n[_[1]]}),s[k.pop()[1]]||44}function l(y,w){var j=w||{},C="",k=j.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};y.slice(0,4)=="sep="?y.charCodeAt(5)==13&&y.charCodeAt(6)==10?(C=y.charAt(4),y=y.slice(7)):y.charCodeAt(5)==13||y.charCodeAt(5)==10?(C=y.charAt(4),y=y.slice(6)):C=a(y.slice(0,1024)):j&&j.FS?C=j.FS:C=a(y.slice(0,1024));var _=0,I=0,F=0,B=0,q=0,me=C.charCodeAt(0),re=!1,M=0,G=y.charCodeAt(0);y=y.replace(/\r\n/mg,`
`);var le=j.dateNF!=null?k9(j.dateNF):null;function Z(){var he=y.slice(B,q),ce={};if(he.charAt(0)=='"'&&he.charAt(he.length-1)=='"'&&(he=he.slice(1,-1).replace(/""/g,'"')),he.length===0)ce.t="z";else if(j.raw)ce.t="s",ce.v=he;else if(he.trim().length===0)ce.t="s",ce.v=he;else if(he.charCodeAt(0)==61)he.charCodeAt(1)==34&&he.charCodeAt(he.length-1)==34?(ce.t="s",ce.v=he.slice(2,-1).replace(/""/g,'"')):lI(he)?(ce.t="n",ce.f=he.slice(1)):(ce.t="s",ce.v=he);else if(he=="TRUE")ce.t="b",ce.v=!0;else if(he=="FALSE")ce.t="b",ce.v=!1;else if(!isNaN(F=Ba(he)))ce.t="n",j.cellText!==!1&&(ce.w=he),ce.v=F;else if(!isNaN(yc(he).getDate())||le&&he.match(le)){ce.z=j.dateNF||as[14];var ke=0;le&&he.match(le)&&(he=C9(he,j.dateNF,he.match(le)||[]),ke=1),j.cellDates?(ce.t="d",ce.v=Js(he,ke)):(ce.t="n",ce.v=pn(Js(he,ke))),j.cellText!==!1&&(ce.w=Si(ce.z,ce.v instanceof Date?pn(ce.v):ce.v)),j.cellNF||delete ce.z}else ce.t="s",ce.v=he;if(ce.t=="z"||(j.dense?(k[_]||(k[_]=[]),k[_][I]=ce):k[Fr({c:I,r:_})]=ce),B=q+1,G=y.charCodeAt(B),S.e.c<I&&(S.e.c=I),S.e.r<_&&(S.e.r=_),M==me)++I;else if(I=0,++_,j.sheetRows&&j.sheetRows<=_)return!0}e:for(;q<y.length;++q)switch(M=y.charCodeAt(q)){case 34:G===34&&(re=!re);break;case me:case 10:case 13:if(!re&&Z())break e;break}return q-B>0&&Z(),k["!ref"]=fs(S),k}function c(y,w){return!(w&&w.PRN)||w.FS||y.slice(0,4)=="sep="||y.indexOf("	")>=0||y.indexOf(",")>=0||y.indexOf(";")>=0?l(y,w):ho(r(y,w),w)}function u(y,w){var j="",C=w.type=="string"?[0,0,0,0]:wq(y,w);switch(w.type){case"base64":j=Va(y);break;case"binary":j=y;break;case"buffer":w.codepage==65001?j=y.toString("utf8"):w.codepage&&typeof $u<"u"||(j=Er&&Buffer.isBuffer(y)?y.toString("binary"):$c(y));break;case"array":j=Om(y);break;case"string":j=y;break;default:throw new Error("Unrecognized type "+w.type)}return C[0]==239&&C[1]==187&&C[2]==191?j=lc(j.slice(3)):w.type!="string"&&w.type!="buffer"&&w.codepage==65001?j=lc(j):w.type=="binary"&&typeof $u<"u",j.slice(0,19)=="socialcalc:version:"?TS.to_sheet(w.type=="string"?j:lc(j),w):c(j,w)}function f(y,w){return il(u(y,w),w)}function h(y){for(var w=[],j=Vr(y["!ref"]),C,k=Array.isArray(y),S=j.s.r;S<=j.e.r;++S){for(var _=[],I=j.s.c;I<=j.e.c;++I){var F=Fr({r:S,c:I});if(C=k?(y[S]||[])[I]:y[F],!C||C.v==null){_.push("          ");continue}for(var B=(C.w||(Wa(C),C.w)||"").slice(0,10);B.length<10;)B+=" ";_.push(B+(I===0?" ":""))}w.push(_.join(""))}return w.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:h}})(),zb=(function(){function t(U,ue,z){if(U){wn(U,U.l||0);for(var ne=z.Enum||pe;U.l<U.length;){var ve=U.read_shift(2),fe=ne[ve]||ne[65535],Ce=U.read_shift(2),Le=U.l+Ce,De=fe.f&&fe.f(U,Ce,z);if(U.l=Le,ue(De,fe,ve))return}}}function r(U,ue){switch(ue.type){case"base64":return s(Hn(Va(U)),ue);case"binary":return s(Hn(U),ue);case"buffer":case"array":return s(U,ue)}throw"Unsupported type "+ue.type}function s(U,ue){if(!U)return U;var z=ue||{},ne=z.dense?[]:{},ve="Sheet1",fe="",Ce=0,Le={},De=[],Ve=[],tt={s:{r:0,c:0},e:{r:0,c:0}},Nt=z.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)z.Enum=pe,t(U,function(Ie,ut,it){switch(it){case 0:z.vers=Ie,Ie>=4096&&(z.qpro=!0);break;case 6:tt=Ie;break;case 204:Ie&&(fe=Ie);break;case 222:fe=Ie;break;case 15:case 51:z.qpro||(Ie[1].v=Ie[1].v.slice(1));case 13:case 14:case 16:it==14&&(Ie[2]&112)==112&&(Ie[2]&15)>1&&(Ie[2]&15)<15&&(Ie[1].z=z.dateNF||as[14],z.cellDates&&(Ie[1].t="d",Ie[1].v=Hj(Ie[1].v))),z.qpro&&Ie[3]>Ce&&(ne["!ref"]=fs(tt),Le[ve]=ne,De.push(ve),ne=z.dense?[]:{},tt={s:{r:0,c:0},e:{r:0,c:0}},Ce=Ie[3],ve=fe||"Sheet"+(Ce+1),fe="");var jt=z.dense?(ne[Ie[0].r]||[])[Ie[0].c]:ne[Fr(Ie[0])];if(jt){jt.t=Ie[1].t,jt.v=Ie[1].v,Ie[1].z!=null&&(jt.z=Ie[1].z),Ie[1].f!=null&&(jt.f=Ie[1].f);break}z.dense?(ne[Ie[0].r]||(ne[Ie[0].r]=[]),ne[Ie[0].r][Ie[0].c]=Ie[1]):ne[Fr(Ie[0])]=Ie[1];break}},z);else if(U[2]==26||U[2]==14)z.Enum=se,U[2]==14&&(z.qpro=!0,U.l=0),t(U,function(Ie,ut,it){switch(it){case 204:ve=Ie;break;case 22:Ie[1].v=Ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ie[3]>Ce&&(ne["!ref"]=fs(tt),Le[ve]=ne,De.push(ve),ne=z.dense?[]:{},tt={s:{r:0,c:0},e:{r:0,c:0}},Ce=Ie[3],ve="Sheet"+(Ce+1)),Nt>0&&Ie[0].r>=Nt)break;z.dense?(ne[Ie[0].r]||(ne[Ie[0].r]=[]),ne[Ie[0].r][Ie[0].c]=Ie[1]):ne[Fr(Ie[0])]=Ie[1],tt.e.c<Ie[0].c&&(tt.e.c=Ie[0].c),tt.e.r<Ie[0].r&&(tt.e.r=Ie[0].r);break;case 27:Ie[14e3]&&(Ve[Ie[14e3][0]]=Ie[14e3][1]);break;case 1537:Ve[Ie[0]]=Ie[1],Ie[0]==Ce&&(ve=Ie[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(ne["!ref"]=fs(tt),Le[fe||ve]=ne,De.push(fe||ve),!Ve.length)return{SheetNames:De,Sheets:Le};for(var lt={},$t=[],qe=0;qe<Ve.length;++qe)Le[De[qe]]?($t.push(Ve[qe]||De[qe]),lt[Ve[qe]]=Le[Ve[qe]]||Le[De[qe]]):($t.push(Ve[qe]),lt[Ve[qe]]={"!ref":"A1"});return{SheetNames:$t,Sheets:lt}}function n(U,ue){var z=ue||{};if(+z.codepage>=0&&fc(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var ne=mn(),ve=Vr(U["!ref"]),fe=Array.isArray(U),Ce=[];Mt(ne,0,l(1030)),Mt(ne,6,f(ve));for(var Le=Math.min(ve.e.r,8191),De=ve.s.r;De<=Le;++De)for(var Ve=Fs(De),tt=ve.s.c;tt<=ve.e.c;++tt){De===ve.s.r&&(Ce[tt]=Us(tt));var Nt=Ce[tt]+Ve,lt=fe?(U[De]||[])[tt]:U[Nt];if(!(!lt||lt.t=="z"))if(lt.t=="n")(lt.v|0)==lt.v&&lt.v>=-32768&&lt.v<=32767?Mt(ne,13,C(De,tt,lt.v)):Mt(ne,14,S(De,tt,lt.v));else{var $t=Wa(lt);Mt(ne,15,w(De,tt,$t.slice(0,239)))}}return Mt(ne,1),ne.end()}function a(U,ue){var z=ue||{};if(+z.codepage>=0&&fc(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var ne=mn();Mt(ne,0,c(U));for(var ve=0,fe=0;ve<U.SheetNames.length;++ve)(U.Sheets[U.SheetNames[ve]]||{})["!ref"]&&Mt(ne,27,we(U.SheetNames[ve],fe++));var Ce=0;for(ve=0;ve<U.SheetNames.length;++ve){var Le=U.Sheets[U.SheetNames[ve]];if(!(!Le||!Le["!ref"])){for(var De=Vr(Le["!ref"]),Ve=Array.isArray(Le),tt=[],Nt=Math.min(De.e.r,8191),lt=De.s.r;lt<=Nt;++lt)for(var $t=Fs(lt),qe=De.s.c;qe<=De.e.c;++qe){lt===De.s.r&&(tt[qe]=Us(qe));var Ie=tt[qe]+$t,ut=Ve?(Le[lt]||[])[qe]:Le[Ie];if(!(!ut||ut.t=="z"))if(ut.t=="n")Mt(ne,23,Z(lt,qe,Ce,ut.v));else{var it=Wa(ut);Mt(ne,22,M(lt,qe,Ce,it.slice(0,239)))}}++Ce}}return Mt(ne,1),ne.end()}function l(U){var ue=st(2);return ue.write_shift(2,U),ue}function c(U){var ue=st(26);ue.write_shift(2,4096),ue.write_shift(2,4),ue.write_shift(4,0);for(var z=0,ne=0,ve=0,fe=0;fe<U.SheetNames.length;++fe){var Ce=U.SheetNames[fe],Le=U.Sheets[Ce];if(!(!Le||!Le["!ref"])){++ve;var De=_n(Le["!ref"]);z<De.e.r&&(z=De.e.r),ne<De.e.c&&(ne=De.e.c)}}return z>8191&&(z=8191),ue.write_shift(2,z),ue.write_shift(1,ve),ue.write_shift(1,ne),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(1,1),ue.write_shift(1,2),ue.write_shift(4,0),ue.write_shift(4,0),ue}function u(U,ue,z){var ne={s:{c:0,r:0},e:{c:0,r:0}};return ue==8&&z.qpro?(ne.s.c=U.read_shift(1),U.l++,ne.s.r=U.read_shift(2),ne.e.c=U.read_shift(1),U.l++,ne.e.r=U.read_shift(2),ne):(ne.s.c=U.read_shift(2),ne.s.r=U.read_shift(2),ue==12&&z.qpro&&(U.l+=2),ne.e.c=U.read_shift(2),ne.e.r=U.read_shift(2),ue==12&&z.qpro&&(U.l+=2),ne.s.c==65535&&(ne.s.c=ne.e.c=ne.s.r=ne.e.r=0),ne)}function f(U){var ue=st(8);return ue.write_shift(2,U.s.c),ue.write_shift(2,U.s.r),ue.write_shift(2,U.e.c),ue.write_shift(2,U.e.r),ue}function h(U,ue,z){var ne=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(ne[0].c=U.read_shift(1),ne[3]=U.read_shift(1),ne[0].r=U.read_shift(2),U.l+=2):(ne[2]=U.read_shift(1),ne[0].c=U.read_shift(2),ne[0].r=U.read_shift(2)),ne}function y(U,ue,z){var ne=U.l+ue,ve=h(U,ue,z);if(ve[1].t="s",z.vers==20768){U.l++;var fe=U.read_shift(1);return ve[1].v=U.read_shift(fe,"utf8"),ve}return z.qpro&&U.l++,ve[1].v=U.read_shift(ne-U.l,"cstr"),ve}function w(U,ue,z){var ne=st(7+z.length);ne.write_shift(1,255),ne.write_shift(2,ue),ne.write_shift(2,U),ne.write_shift(1,39);for(var ve=0;ve<ne.length;++ve){var fe=z.charCodeAt(ve);ne.write_shift(1,fe>=128?95:fe)}return ne.write_shift(1,0),ne}function j(U,ue,z){var ne=h(U,ue,z);return ne[1].v=U.read_shift(2,"i"),ne}function C(U,ue,z){var ne=st(7);return ne.write_shift(1,255),ne.write_shift(2,ue),ne.write_shift(2,U),ne.write_shift(2,z,"i"),ne}function k(U,ue,z){var ne=h(U,ue,z);return ne[1].v=U.read_shift(8,"f"),ne}function S(U,ue,z){var ne=st(13);return ne.write_shift(1,255),ne.write_shift(2,ue),ne.write_shift(2,U),ne.write_shift(8,z,"f"),ne}function _(U,ue,z){var ne=U.l+ue,ve=h(U,ue,z);if(ve[1].v=U.read_shift(8,"f"),z.qpro)U.l=ne;else{var fe=U.read_shift(2);q(U.slice(U.l,U.l+fe),ve),U.l+=fe}return ve}function I(U,ue,z){var ne=ue&32768;return ue&=-32769,ue=(ne?U:0)+(ue>=8192?ue-16384:ue),(ne?"":"$")+(z?Us(ue):Fs(ue))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},B=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function q(U,ue){wn(U,0);for(var z=[],ne=0,ve="",fe="",Ce="",Le="";U.l<U.length;){var De=U[U.l++];switch(De){case 0:z.push(U.read_shift(8,"f"));break;case 1:fe=I(ue[0].c,U.read_shift(2),!0),ve=I(ue[0].r,U.read_shift(2),!1),z.push(fe+ve);break;case 2:{var Ve=I(ue[0].c,U.read_shift(2),!0),tt=I(ue[0].r,U.read_shift(2),!1);fe=I(ue[0].c,U.read_shift(2),!0),ve=I(ue[0].r,U.read_shift(2),!1),z.push(Ve+tt+":"+fe+ve)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(U.read_shift(2));break;case 6:{for(var Nt="";De=U[U.l++];)Nt+=String.fromCharCode(De);z.push('"'+Nt.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:Le=z.pop(),Ce=z.pop(),z.push(["AND","OR"][De-20]+"("+Ce+","+Le+")");break;default:if(De<32&&B[De])Le=z.pop(),Ce=z.pop(),z.push(Ce+B[De]+Le);else if(F[De]){if(ne=F[De][1],ne==69&&(ne=U[U.l++]),ne>z.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+z.join("|")+"|");return}var lt=z.slice(-ne);z.length-=ne,z.push(F[De][0]+"("+lt.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}z.length==1?ue[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function me(U){var ue=[{c:0,r:0},{t:"n",v:0},0];return ue[0].r=U.read_shift(2),ue[3]=U[U.l++],ue[0].c=U[U.l++],ue}function re(U,ue){var z=me(U);return z[1].t="s",z[1].v=U.read_shift(ue-4,"cstr"),z}function M(U,ue,z,ne){var ve=st(6+ne.length);ve.write_shift(2,U),ve.write_shift(1,z),ve.write_shift(1,ue),ve.write_shift(1,39);for(var fe=0;fe<ne.length;++fe){var Ce=ne.charCodeAt(fe);ve.write_shift(1,Ce>=128?95:Ce)}return ve.write_shift(1,0),ve}function G(U,ue){var z=me(U);z[1].v=U.read_shift(2);var ne=z[1].v>>1;if(z[1].v&1)switch(ne&7){case 0:ne=(ne>>3)*5e3;break;case 1:ne=(ne>>3)*500;break;case 2:ne=(ne>>3)/20;break;case 3:ne=(ne>>3)/200;break;case 4:ne=(ne>>3)/2e3;break;case 5:ne=(ne>>3)/2e4;break;case 6:ne=(ne>>3)/16;break;case 7:ne=(ne>>3)/64;break}return z[1].v=ne,z}function le(U,ue){var z=me(U),ne=U.read_shift(4),ve=U.read_shift(4),fe=U.read_shift(2);if(fe==65535)return ne===0&&ve===3221225472?(z[1].t="e",z[1].v=15):ne===0&&ve===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var Ce=fe&32768;return fe=(fe&32767)-16446,z[1].v=(1-Ce*2)*(ve*Math.pow(2,fe+32)+ne*Math.pow(2,fe)),z}function Z(U,ue,z,ne){var ve=st(14);if(ve.write_shift(2,U),ve.write_shift(1,z),ve.write_shift(1,ue),ne==0)return ve.write_shift(4,0),ve.write_shift(4,0),ve.write_shift(2,65535),ve;var fe=0,Ce=0,Le=0,De=0;return ne<0&&(fe=1,ne=-ne),Ce=Math.log2(ne)|0,ne/=Math.pow(2,Ce-31),De=ne>>>0,(De&2147483648)==0&&(ne/=2,++Ce,De=ne>>>0),ne-=De,De|=2147483648,De>>>=0,ne*=Math.pow(2,32),Le=ne>>>0,ve.write_shift(4,Le),ve.write_shift(4,De),Ce+=16383+(fe?32768:0),ve.write_shift(2,Ce),ve}function he(U,ue){var z=le(U);return U.l+=ue-14,z}function ce(U,ue){var z=me(U),ne=U.read_shift(4);return z[1].v=ne>>6,z}function ke(U,ue){var z=me(U),ne=U.read_shift(8,"f");return z[1].v=ne,z}function Ee(U,ue){var z=ke(U);return U.l+=ue-10,z}function Fe(U,ue){return U[U.l+ue-1]==0?U.read_shift(ue,"cstr"):""}function X(U,ue){var z=U[U.l++];z>ue-1&&(z=ue-1);for(var ne="";ne.length<z;)ne+=String.fromCharCode(U[U.l++]);return ne}function ye(U,ue,z){if(!(!z.qpro||ue<21)){var ne=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var ve=U.read_shift(ue-21,"cstr");return[ne,ve]}}function Q(U,ue){for(var z={},ne=U.l+ue;U.l<ne;){var ve=U.read_shift(2);if(ve==14e3){for(z[ve]=[0,""],z[ve][0]=U.read_shift(2);U[U.l];)z[ve][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return z}function we(U,ue){var z=st(5+U.length);z.write_shift(2,14e3),z.write_shift(2,ue);for(var ne=0;ne<U.length;++ne){var ve=U.charCodeAt(ne);z[z.l++]=ve>127?95:ve}return z[z.l++]=0,z}var pe={0:{n:"BOF",f:CS},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:j},14:{n:"NUMBER",f:k},15:{n:"LABEL",f:y},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:y},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Fe},222:{n:"SHEETNAMELP",f:X},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:re},23:{n:"NUMBER17",f:le},24:{n:"NUMBER18",f:G},25:{n:"FORMULA19",f:he},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ce},38:{n:"??"},39:{n:"NUMBER27",f:ke},40:{n:"FORMULA28",f:Ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Fe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ye},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}})(),dM=/^\s|\s$|[\t\n\r]/;function OS(t,r){if(!r.bookSST)return"";var s=[ys];s[s.length]=Lt("sst",null,{xmlns:xo[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],l="<si>";a.r?l+=a.r:(l+="<t",a.t||(a.t=""),a.t.match(dM)&&(l+=' xml:space="preserve"'),l+=">"+Lr(a.t)+"</t>"),l+="</si>",s[s.length]=l}return s.length>2&&(s[s.length]="</sst>",s[1]=s[1].replace("/>",">")),s.join("")}function uM(t){return[t.read_shift(4),t.read_shift(4)]}function mM(t,r){return r||(r=st(8)),r.write_shift(4,t.Count),r.write_shift(4,t.Unique),r}var pM=sF;function xM(t){var r=mn();dt(r,159,mM(t));for(var s=0;s<t.length;++s)dt(r,19,pM(t[s]));return dt(r,160),r.end()}function hM(t){for(var r=[],s=t.split(""),n=0;n<s.length;++n)r[n]=s[n].charCodeAt(0);return r}function RS(t){var r=0,s,n=hM(t),a=n.length+1,l,c,u,f,h;for(s=sl(a),s[0]=n.length,l=1;l!=a;++l)s[l]=n[l-1];for(l=a-1;l>=0;--l)c=s[l],u=(r&16384)===0?0:1,f=r<<1&32767,h=u|f,r=h^c;return r^52811}var fM=(function(){function t(a,l){switch(l.type){case"base64":return r(Va(a),l);case"binary":return r(a,l);case"buffer":return r(Er&&Buffer.isBuffer(a)?a.toString("binary"):$c(a),l);case"array":return r(Om(a),l)}throw new Error("Unrecognized type "+l.type)}function r(a,l){var c=l||{},u=c.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(y,w){Array.isArray(u)&&(u[w]=[]);for(var j=/\\\w+\b/g,C=0,k,S=-1;k=j.exec(y);){switch(k[0]){case"\\cell":var _=y.slice(C,j.lastIndex-k[0].length);if(_[0]==" "&&(_=_.slice(1)),++S,_.length){var I={v:_,t:"s"};Array.isArray(u)?u[w][S]=I:u[Fr({r:w,c:S})]=I}break}C=j.lastIndex}S>h.e.c&&(h.e.c=S)}),u["!ref"]=fs(h),u}function s(a,l){return il(t(a,l),l)}function n(a){for(var l=["{\\rtf1\\ansi"],c=Vr(a["!ref"]),u,f=Array.isArray(a),h=c.s.r;h<=c.e.r;++h){l.push("\\trowd\\trautofit1");for(var y=c.s.c;y<=c.e.c;++y)l.push("\\cellx"+(y+1));for(l.push("\\pard\\intbl"),y=c.s.c;y<=c.e.c;++y){var w=Fr({r:h,c:y});u=f?(a[h]||[])[y]:a[w],!(!u||u.v==null&&(!u.f||u.F))&&(l.push(" "+(u.w||(Wa(u),u.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:s,to_sheet:t,from_sheet:n}})();function $b(t){for(var r=0,s=1;r!=3;++r)s=s*256+(t[r]>255?255:t[r]<0?0:t[r]);return s.toString(16).toUpperCase().slice(1)}var gM=6,za=gM;function Xu(t){return Math.floor((t+Math.round(128/za)/256)*za)}function Ju(t){return Math.floor((t-5)/za*100+.5)/100}function Ex(t){return Math.round((t*za+5)/za*256)/256}function Ih(t){t.width?(t.wpx=Xu(t.width),t.wch=Ju(t.wpx),t.MDW=za):t.wpx?(t.wch=Ju(t.wpx),t.width=Ex(t.wch),t.MDW=za):typeof t.wch=="number"&&(t.width=Ex(t.wch),t.wpx=Xu(t.width),t.MDW=za),t.customWidth&&delete t.customWidth}var yM=96,DS=yM;function Zu(t){return t*96/DS}function LS(t){return t*DS/96}function vM(t){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)t[n]!=null&&(r[r.length]=Lt("numFmt",null,{numFmtId:n,formatCode:Lr(t[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=Lt("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function bM(t){var r=[];return r[r.length]=Lt("cellXfs",null),t.forEach(function(s){r[r.length]=Lt("xf",null,s)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=Lt("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function FS(t,r){var s=[ys,Lt("styleSheet",null,{xmlns:xo[0],"xmlns:vt":_s.vt})],n;return t.SSF&&(n=vM(t.SSF))!=null&&(s[s.length]=n),s[s.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',s[s.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',s[s.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',s[s.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=bM(r.cellXfs))&&(s[s.length]=n),s[s.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',s[s.length]='<dxfs count="0"/>',s[s.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',s.length>2&&(s[s.length]="</styleSheet>",s[1]=s[1].replace("/>",">")),s.join("")}function wM(t,r){var s=t.read_shift(2),n=Vs(t);return[s,n]}function NM(t,r,s){s||(s=st(6+4*r.length)),s.write_shift(2,t),Ps(r,s);var n=s.length>s.l?s.slice(0,s.l):s;return s.l==null&&(s.l=s.length),n}function jM(t,r,s){var n={};n.sz=t.read_shift(2)/20;var a=dF(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var l=t.read_shift(2);switch(l===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=t.read_shift(1);c!=0&&(n.underline=c);var u=t.read_shift(1);u>0&&(n.family=u);var f=t.read_shift(1);switch(f>0&&(n.charset=f),t.l++,n.color=cF(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Vs(t),n}function SM(t,r){r||(r=st(153)),r.write_shift(2,t.sz*20),uF(t,r),r.write_shift(2,t.bold?700:400);var s=0;t.vertAlign=="superscript"?s=1:t.vertAlign=="subscript"&&(s=2),r.write_shift(2,s),r.write_shift(1,t.underline||0),r.write_shift(1,t.family||0),r.write_shift(1,t.charset||0),r.write_shift(1,0),Yu(t.color,r);var n=0;return n=2,r.write_shift(1,n),Ps(t.name,r),r.length>r.l?r.slice(0,r.l):r}var kM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Y0,CM=wa;function Qb(t,r){r||(r=st(84)),Y0||(Y0=Ch(kM));var s=Y0[t.patternType];s==null&&(s=40),r.write_shift(4,s);var n=0;if(s!=40)for(Yu({auto:1},r),Yu({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function _M(t,r){var s=t.l+r,n=t.read_shift(2),a=t.read_shift(2);return t.l=s,{ixfe:n,numFmtId:a}}function MS(t,r,s){s||(s=st(16)),s.write_shift(2,r||0),s.write_shift(2,t.numFmtId||0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(1,0),s.write_shift(1,0);var n=0;return s.write_shift(1,n),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(1,0),s}function rc(t,r){return r||(r=st(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var EM=wa;function PM(t,r){return r||(r=st(51)),r.write_shift(1,0),rc(null,r),rc(null,r),rc(null,r),rc(null,r),rc(null,r),r.length>r.l?r.slice(0,r.l):r}function AM(t,r){return r||(r=st(52)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),Hu(t.name||"",r),r.length>r.l?r.slice(0,r.l):r}function TM(t,r,s){var n=st(2052);return n.write_shift(4,t),Hu(r,n),Hu(s,n),n.length>n.l?n.slice(0,n.l):n}function OM(t,r){if(r){var s=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&++s}),s!=0&&(dt(t,615,Kn(s)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&dt(t,44,NM(a,r[a]))}),dt(t,616))}}function RM(t){var r=1;dt(t,611,Kn(r)),dt(t,43,SM({sz:12,color:{theme:1},name:"Calibri",family:2})),dt(t,612)}function DM(t){var r=2;dt(t,603,Kn(r)),dt(t,45,Qb({patternType:"none"})),dt(t,45,Qb({patternType:"gray125"})),dt(t,604)}function LM(t){var r=1;dt(t,613,Kn(r)),dt(t,46,PM()),dt(t,614)}function FM(t){var r=1;dt(t,626,Kn(r)),dt(t,47,MS({numFmtId:0},65535)),dt(t,627)}function MM(t,r){dt(t,617,Kn(r.length)),r.forEach(function(s){dt(t,47,MS(s,0))}),dt(t,618)}function IM(t){var r=1;dt(t,619,Kn(r)),dt(t,48,AM({xfId:0,name:"Normal"})),dt(t,620)}function qM(t){var r=0;dt(t,505,Kn(r)),dt(t,506)}function BM(t){var r=0;dt(t,508,TM(r,"TableStyleMedium9","PivotStyleMedium4")),dt(t,509)}function zM(t,r){var s=mn();return dt(s,278),OM(s,t.SSF),RM(s),DM(s),LM(s),FM(s),MM(s,r.cellXfs),IM(s),qM(s),BM(s),dt(s,279),s.end()}function IS(t,r){if(r&&r.themeXLSX)return r.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var s=[ys];return s[s.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',s[s.length]="<a:themeElements>",s[s.length]='<a:clrScheme name="Office">',s[s.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',s[s.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',s[s.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',s[s.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',s[s.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',s[s.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',s[s.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',s[s.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',s[s.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',s[s.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',s[s.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',s[s.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',s[s.length]="</a:clrScheme>",s[s.length]='<a:fontScheme name="Office">',s[s.length]="<a:majorFont>",s[s.length]='<a:latin typeface="Cambria"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Times New Roman"/>',s[s.length]='<a:font script="Hebr" typeface="Times New Roman"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="MoolBoran"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Times New Roman"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:majorFont>",s[s.length]="<a:minorFont>",s[s.length]='<a:latin typeface="Calibri"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface=" "/>',s[s.length]='<a:font script="Hang" typeface=" "/>',s[s.length]='<a:font script="Hans" typeface=""/>',s[s.length]='<a:font script="Hant" typeface=""/>',s[s.length]='<a:font script="Arab" typeface="Arial"/>',s[s.length]='<a:font script="Hebr" typeface="Arial"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="DaunPenh"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Arial"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:minorFont>",s[s.length]="</a:fontScheme>",s[s.length]='<a:fmtScheme name="Office">',s[s.length]="<a:fillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="1"/>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="0"/>',s[s.length]="</a:gradFill>",s[s.length]="</a:fillStyleLst>",s[s.length]="<a:lnStyleLst>",s[s.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]="</a:lnStyleLst>",s[s.length]="<a:effectStyleLst>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',s[s.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',s[s.length]="</a:effectStyle>",s[s.length]="</a:effectStyleLst>",s[s.length]="<a:bgFillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]="</a:bgFillStyleLst>",s[s.length]="</a:fmtScheme>",s[s.length]="</a:themeElements>",s[s.length]="<a:objectDefaults>",s[s.length]="<a:spDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',s[s.length]="</a:spDef>",s[s.length]="<a:lnDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',s[s.length]="</a:lnDef>",s[s.length]="</a:objectDefaults>",s[s.length]="<a:extraClrSchemeLst/>",s[s.length]="</a:theme>",s.join("")}function $M(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:Vs(t)}}function QM(t){var r=st(12+2*t.name.length);return r.write_shift(4,t.flags),r.write_shift(4,t.version),Ps(t.name,r),r.slice(0,r.l)}function UM(t){for(var r=[],s=t.read_shift(4);s-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function VM(t){var r=st(4+8*t.length);r.write_shift(4,t.length);for(var s=0;s<t.length;++s)r.write_shift(4,t[s][0]),r.write_shift(4,t[s][1]);return r}function WM(t,r){var s=st(8+2*r.length);return s.write_shift(4,t),Ps(r,s),s.slice(0,s.l)}function GM(t){return t.l+=4,t.read_shift(4)!=0}function HM(t,r){var s=st(8);return s.write_shift(4,t),s.write_shift(4,1),s}function YM(){var t=mn();return dt(t,332),dt(t,334,Kn(1)),dt(t,335,QM({name:"XLDAPR",version:12e4,flags:3496657072})),dt(t,336),dt(t,339,WM(1,"XLDAPR")),dt(t,52),dt(t,35,Kn(514)),dt(t,4096,Kn(0)),dt(t,4097,Fn(1)),dt(t,36),dt(t,53),dt(t,340),dt(t,337,HM(1)),dt(t,51,VM([[1,0]])),dt(t,338),dt(t,333),t.end()}function qS(){var t=[ys];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function KM(t){var r={};r.i=t.read_shift(4);var s={};s.r=t.read_shift(4),s.c=t.read_shift(4),r.r=Fr(s);var n=t.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}var Ul=1024;function BS(t,r){for(var s=[21600,21600],n=["m0,0l0",s[1],s[0],s[1],s[0],"0xe"].join(","),a=[Lt("xml",null,{"xmlns:v":jn.v,"xmlns:o":jn.o,"xmlns:x":jn.x,"xmlns:mv":jn.mv}).replace(/\/>/,">"),Lt("o:shapelayout",Lt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Lt("v:shapetype",[Lt("v:stroke",null,{joinstyle:"miter"}),Lt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:s.join(","),path:n})];Ul<t*1e3;)Ul+=1e3;return r.forEach(function(l){var c=Es(l[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?Lt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Lt("v:fill",f,u),y={on:"t",obscured:"t"};++Ul,a=a.concat(["<v:shape"+bc({id:"_x0000_s"+Ul,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Lt("v:shadow",null,y),Lt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ls("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),Ls("x:AutoFill","False"),Ls("x:Row",String(c.r)),Ls("x:Column",String(c.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function zS(t){var r=[ys,Lt("comments",null,{xmlns:xo[0]})],s=[];return r.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var l=Lr(a.a);s.indexOf(l)==-1&&(s.push(l),r.push("<author>"+l+"</author>")),a.T&&a.ID&&s.indexOf("tc="+a.ID)==-1&&(s.push("tc="+a.ID),r.push("<author>tc="+a.ID+"</author>"))})}),s.length==0&&(s.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),t.forEach(function(n){var a=0,l=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=s.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=s.indexOf(Lr(f.a))),l.push(f.t||"")}),r.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),l.length<=1)r.push(Ls("t",Lr(l[0]||"")));else{for(var c=`Comment:
    `+l[0]+`
`,u=1;u<l.length;++u)c+=`Reply:
    `+l[u]+`
`;r.push(Ls("t",Lr(c)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function XM(t,r,s){var n=[ys,Lt("ThreadedComments",null,{xmlns:_s.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var l="";(a[1]||[]).forEach(function(c,u){if(!c.T){delete c.ID;return}c.a&&r.indexOf(c.a)==-1&&r.push(c.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+s.tcid++).slice(-12)+"}"};u==0?l=f.id:f.parentId=l,c.ID=f.id,c.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(c.a)).slice(-12)+"}"),n.push(Lt("threadedComment",Ls("text",c.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function JM(t){var r=[ys,Lt("personList",null,{xmlns:_s.TCMNT,"xmlns:x":xo[0]}).replace(/[\/]>/,">")];return t.forEach(function(s,n){r.push(Lt("person",null,{displayName:s,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:s,providerId:"None"}))}),r.push("</personList>"),r.join("")}function ZM(t){var r={};r.iauthor=t.read_shift(4);var s=dl(t);return r.rfx=s.s,r.ref=Fr(s.s),t.l+=16,r}function eI(t,r){return r==null&&(r=st(36)),r.write_shift(4,t[1].iauthor),fo(t[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var tI=Vs;function rI(t){return Ps(t.slice(0,54))}function sI(t){var r=mn(),s=[];return dt(r,628),dt(r,630),t.forEach(function(n){n[1].forEach(function(a){s.indexOf(a.a)>-1||(s.push(a.a.slice(0,54)),dt(r,632,rI(a.a)))})}),dt(r,631),dt(r,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=s.indexOf(a.a);var l={s:Es(n[0]),e:Es(n[0])};dt(r,635,eI([l,a])),a.t&&a.t.length>0&&dt(r,637,aF(a)),dt(r,636),delete a.iauthor})}),dt(r,634),dt(r,629),r.end()}function nI(t,r){r.FullPaths.forEach(function(s,n){if(n!=0){var a=s.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Mr.utils.cfb_add(t,a,r.FileIndex[n].content)}})}var $S=["xlsb","xlsm","xlam","biff8","xla"],aI=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function s(n,a,l,c){var u=!1,f=!1;l.length==0?f=!0:l.charAt(0)=="["&&(f=!0,l=l.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var h=l.length>0?parseInt(l,10)|0:0,y=c.length>0?parseInt(c,10)|0:0;return u?y+=r.c:--y,f?h+=r.r:--h,a+(u?"":"$")+Us(y)+(f?"":"$")+Fs(h)}return function(a,l){return r=l,a.replace(t,s)}})(),qh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Bh=(function(){return function(r,s){return r.replace(qh,function(n,a,l,c,u,f){var h=Rh(c)-(l?0:s.c),y=Oh(f)-(u?0:s.r),w=y==0?"":u?y+1:"["+y+"]",j=h==0?"":l?h+1:"["+h+"]";return a+"R"+w+"C"+j})}})();function iI(t,r){return t.replace(qh,function(s,n,a,l,c,u){return n+(a=="$"?a+l:Us(Rh(l)+r.c))+(c=="$"?c+u:Fs(Oh(u)+r.r))})}function lI(t){return t.length!=1}function hs(t){t.l+=1}function ki(t,r){var s=t.read_shift(2);return[s&16383,s>>14&1,s>>15&1]}function QS(t,r,s){var n=2;if(s){if(s.biff>=2&&s.biff<=5)return US(t);s.biff==12&&(n=4)}var a=t.read_shift(n),l=t.read_shift(n),c=ki(t),u=ki(t);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:u[0],cRel:u[1],rRel:u[2]}}}function US(t){var r=ki(t),s=ki(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:s[0],c:a,cRel:s[1],rRel:s[2]}}}function oI(t,r,s){if(s.biff<8)return US(t);var n=t.read_shift(s.biff==12?4:2),a=t.read_shift(s.biff==12?4:2),l=ki(t),c=ki(t);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function VS(t,r,s){if(s&&s.biff>=2&&s.biff<=5)return cI(t);var n=t.read_shift(s&&s.biff==12?4:2),a=ki(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function cI(t){var r=ki(t),s=t.read_shift(1);return{r:r[0],c:s,cRel:r[1],rRel:r[2]}}function dI(t){var r=t.read_shift(2),s=t.read_shift(2);return{r,c:s&255,fQuoted:!!(s&16384),cRel:s>>15,rRel:s>>15}}function uI(t,r,s){var n=s&&s.biff?s.biff:8;if(n>=2&&n<=5)return mI(t);var a=t.read_shift(n>=12?4:2),l=t.read_shift(2),c=(l&16384)>>14,u=(l&32768)>>15;if(l&=16383,u==1)for(;a>524287;)a-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:a,c:l,cRel:c,rRel:u}}function mI(t){var r=t.read_shift(2),s=t.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&s>=128&&(s=s-256),{r,c:s,cRel:a,rRel:n}}function pI(t,r,s){var n=(t[t.l++]&96)>>5,a=QS(t,s.biff>=2&&s.biff<=5?6:8,s);return[n,a]}function xI(t,r,s){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),l=8;if(s)switch(s.biff){case 5:t.l+=12,l=6;break;case 12:l=12;break}var c=QS(t,l,s);return[n,a,c]}function hI(t,r,s){var n=(t[t.l++]&96)>>5;return t.l+=s&&s.biff>8?12:s.biff<8?6:8,[n]}function fI(t,r,s){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),l=8;if(s)switch(s.biff){case 5:t.l+=12,l=6;break;case 12:l=12;break}return t.l+=l,[n,a]}function gI(t,r,s){var n=(t[t.l++]&96)>>5,a=oI(t,r-1,s);return[n,a]}function yI(t,r,s){var n=(t[t.l++]&96)>>5;return t.l+=s.biff==2?6:s.biff==12?14:7,[n]}function Ub(t){var r=t[t.l+1]&1,s=1;return t.l+=4,[r,s]}function vI(t,r,s){t.l+=2;for(var n=t.read_shift(s&&s.biff==2?1:2),a=[],l=0;l<=n;++l)a.push(t.read_shift(s&&s.biff==2?1:2));return a}function bI(t,r,s){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(s&&s.biff==2?1:2)]}function wI(t,r,s){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(s&&s.biff==2?1:2)]}function NI(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function jI(t,r,s){var n=t[t.l+1]&255?1:0;return t.l+=s&&s.biff==2?3:4,[n]}function WS(t){var r=t.read_shift(1),s=t.read_shift(1);return[r,s]}function SI(t){return t.read_shift(2),WS(t)}function kI(t){return t.read_shift(2),WS(t)}function CI(t,r,s){var n=(t[t.l]&96)>>5;t.l+=1;var a=VS(t,0,s);return[n,a]}function _I(t,r,s){var n=(t[t.l]&96)>>5;t.l+=1;var a=uI(t,0,s);return[n,a]}function EI(t,r,s){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);s&&s.biff==5&&(t.l+=12);var l=VS(t,0,s);return[n,a,l]}function PI(t,r,s){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(s&&s.biff<=3?1:2);return[P6[a],YS[a],n]}function AI(t,r,s){var n=t[t.l++],a=t.read_shift(1),l=s&&s.biff<=3?[n==88?-1:0,t.read_shift(1)]:TI(t);return[a,(l[0]===0?YS:E6)[l[1]]]}function TI(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function OI(t,r,s){t.l+=s&&s.biff==2?3:4}function RI(t,r,s){if(t.l++,s&&s.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(s&&s.biff==2?1:2);return[n,a]}function DI(t){return t.l++,Vc[t.read_shift(1)]}function LI(t){return t.l++,t.read_shift(2)}function FI(t){return t.l++,t.read_shift(1)!==0}function MI(t){return t.l++,go(t)}function II(t,r,s){return t.l++,ES(t,r-1,s)}function qI(t,r){var s=[t.read_shift(1)];if(r==12)switch(s[0]){case 2:s[0]=4;break;case 4:s[0]=16;break;case 0:s[0]=1;break;case 1:s[0]=2;break}switch(s[0]){case 4:s[1]=EF(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:s[1]=Vc[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:s[1]=go(t);break;case 2:s[1]=OF(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+s[0])}return s}function BI(t,r,s){for(var n=t.read_shift(s.biff==12?4:2),a=[],l=0;l!=n;++l)a.push((s.biff==12?dl:LF)(t));return a}function zI(t,r,s){var n=0,a=0;s.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),s.biff>=2&&s.biff<8&&(--n,--a==0&&(a=256));for(var l=0,c=[];l!=n&&(c[l]=[]);++l)for(var u=0;u!=a;++u)c[l][u]=qI(t,s.biff);return c}function $I(t,r,s){var n=t.read_shift(1)>>>5&3,a=!s||s.biff>=8?4:2,l=t.read_shift(a);switch(s.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,l]}function QI(t,r,s){if(s.biff==5)return UI(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),l=t.read_shift(4);return[n,a,l]}function UI(t){var r=t.read_shift(1)>>>5&3,s=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[r,s,n]}function VI(t,r,s){var n=t.read_shift(1)>>>5&3;t.l+=s&&s.biff==2?3:4;var a=t.read_shift(s&&s.biff==2?1:2);return[n,a]}function WI(t,r,s){var n=t.read_shift(1)>>>5&3,a=t.read_shift(s&&s.biff==2?1:2);return[n,a]}function GI(t,r,s){var n=t.read_shift(1)>>>5&3;return t.l+=4,s.biff<8&&t.l--,s.biff==12&&(t.l+=2),[n]}function HI(t,r,s){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),l=4;if(s)switch(s.biff){case 5:l=15;break;case 12:l=6;break}return t.l+=l,[n,a]}var YI=wa,KI=wa,XI=wa;function Wc(t,r,s){return t.l+=2,[dI(t)]}function zh(t){return t.l+=6,[]}var JI=Wc,ZI=zh,e6=zh,t6=Wc;function GS(t){return t.l+=2,[CS(t),t.read_shift(2)&1]}var r6=Wc,s6=GS,n6=zh,a6=Wc,i6=Wc,l6=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function o6(t){t.l+=2;var r=t.read_shift(2),s=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),l=t.read_shift(2),c=l6[s>>2&31];return{ixti:r,coltype:s&3,rt:c,idx:n,c:a,C:l}}function c6(t){return t.l+=2,[t.read_shift(4)]}function d6(t,r,s){return t.l+=5,t.l+=2,t.l+=s.biff==2?1:4,["PTGSHEET"]}function u6(t,r,s){return t.l+=s.biff==2?4:5,["PTGENDSHEET"]}function m6(t){var r=t.read_shift(1)>>>5&3,s=t.read_shift(2);return[r,s]}function p6(t){var r=t.read_shift(1)>>>5&3,s=t.read_shift(2);return[r,s]}function x6(t){return t.l+=4,[0,0]}var Vb={1:{n:"PtgExp",f:RI},2:{n:"PtgTbl",f:XI},3:{n:"PtgAdd",f:hs},4:{n:"PtgSub",f:hs},5:{n:"PtgMul",f:hs},6:{n:"PtgDiv",f:hs},7:{n:"PtgPower",f:hs},8:{n:"PtgConcat",f:hs},9:{n:"PtgLt",f:hs},10:{n:"PtgLe",f:hs},11:{n:"PtgEq",f:hs},12:{n:"PtgGe",f:hs},13:{n:"PtgGt",f:hs},14:{n:"PtgNe",f:hs},15:{n:"PtgIsect",f:hs},16:{n:"PtgUnion",f:hs},17:{n:"PtgRange",f:hs},18:{n:"PtgUplus",f:hs},19:{n:"PtgUminus",f:hs},20:{n:"PtgPercent",f:hs},21:{n:"PtgParen",f:hs},22:{n:"PtgMissArg",f:hs},23:{n:"PtgStr",f:II},26:{n:"PtgSheet",f:d6},27:{n:"PtgEndSheet",f:u6},28:{n:"PtgErr",f:DI},29:{n:"PtgBool",f:FI},30:{n:"PtgInt",f:LI},31:{n:"PtgNum",f:MI},32:{n:"PtgArray",f:yI},33:{n:"PtgFunc",f:PI},34:{n:"PtgFuncVar",f:AI},35:{n:"PtgName",f:$I},36:{n:"PtgRef",f:CI},37:{n:"PtgArea",f:pI},38:{n:"PtgMemArea",f:VI},39:{n:"PtgMemErr",f:YI},40:{n:"PtgMemNoMem",f:KI},41:{n:"PtgMemFunc",f:WI},42:{n:"PtgRefErr",f:GI},43:{n:"PtgAreaErr",f:hI},44:{n:"PtgRefN",f:_I},45:{n:"PtgAreaN",f:gI},46:{n:"PtgMemAreaN",f:m6},47:{n:"PtgMemNoMemN",f:p6},57:{n:"PtgNameX",f:QI},58:{n:"PtgRef3d",f:EI},59:{n:"PtgArea3d",f:xI},60:{n:"PtgRefErr3d",f:HI},61:{n:"PtgAreaErr3d",f:fI},255:{}},h6={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},f6={1:{n:"PtgElfLel",f:GS},2:{n:"PtgElfRw",f:a6},3:{n:"PtgElfCol",f:JI},6:{n:"PtgElfRwV",f:i6},7:{n:"PtgElfColV",f:t6},10:{n:"PtgElfRadical",f:r6},11:{n:"PtgElfRadicalS",f:n6},13:{n:"PtgElfColS",f:ZI},15:{n:"PtgElfColSV",f:e6},16:{n:"PtgElfRadicalLel",f:s6},25:{n:"PtgList",f:o6},29:{n:"PtgSxName",f:c6},255:{}},g6={0:{n:"PtgAttrNoop",f:x6},1:{n:"PtgAttrSemi",f:jI},2:{n:"PtgAttrIf",f:wI},4:{n:"PtgAttrChoose",f:vI},8:{n:"PtgAttrGoto",f:bI},16:{n:"PtgAttrSum",f:OI},32:{n:"PtgAttrBaxcel",f:Ub},33:{n:"PtgAttrBaxcel",f:Ub},64:{n:"PtgAttrSpace",f:SI},65:{n:"PtgAttrSpaceSemi",f:kI},128:{n:"PtgAttrIfError",f:NI},255:{}};function y6(t,r,s,n){if(n.biff<8)return wa(t,r);for(var a=t.l+r,l=[],c=0;c!==s.length;++c)switch(s[c][0]){case"PtgArray":s[c][1]=zI(t,0,n),l.push(s[c][1]);break;case"PtgMemArea":s[c][2]=BI(t,s[c][1],n),l.push(s[c][2]);break;case"PtgExp":n&&n.biff==12&&(s[c][1][1]=t.read_shift(4),l.push(s[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+s[c][0]}return r=a-t.l,r!==0&&l.push(wa(t,r)),l}function v6(t,r,s){for(var n=t.l+r,a,l,c=[];n!=t.l;)r=n-t.l,l=t[t.l],a=Vb[l]||Vb[h6[l]],(l===24||l===25)&&(a=(l===24?f6:g6)[t[t.l+1]]),!a||!a.f?wa(t,r):c.push([a.n,a.f(t,r,s)]);return c}function b6(t){for(var r=[],s=0;s<t.length;++s){for(var n=t[s],a=[],l=0;l<n.length;++l){var c=n[l];if(c)switch(c[0]){case 2:a.push('"'+c[1].replace(/"/g,'""')+'"');break;default:a.push(c[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var w6={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function N6(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function HS(t,r,s){if(!t)return"SH33TJSERR0";if(s.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[r];if(s.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(s.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return s.SID!=null?t.SheetNames[s.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Wb(t,r,s){var n=HS(t,r,s);return n=="#REF"?n:N6(n,s)}function to(t,r,s,n,a){var l=a&&a.biff||8,c={s:{c:0,r:0}},u=[],f,h,y,w=0,j=0,C,k="";if(!t[0]||!t[0][0])return"";for(var S=-1,_="",I=0,F=t[0].length;I<F;++I){var B=t[0][I];switch(B[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),h=u.pop(),S>=0){switch(t[0][S][1][0]){case 0:_=es(" ",t[0][S][1][1]);break;case 1:_=es("\r",t[0][S][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}h=h+_,S=-1}u.push(h+w6[B[0]]+f);break;case"PtgIsect":f=u.pop(),h=u.pop(),u.push(h+" "+f);break;case"PtgUnion":f=u.pop(),h=u.pop(),u.push(h+","+f);break;case"PtgRange":f=u.pop(),h=u.pop(),u.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":y=cc(B[1][1],c,a),u.push(dc(y,l));break;case"PtgRefN":y=s?cc(B[1][1],s,a):B[1][1],u.push(dc(y,l));break;case"PtgRef3d":w=B[1][1],y=cc(B[1][2],c,a),k=Wb(n,w,a),u.push(k+"!"+dc(y,l));break;case"PtgFunc":case"PtgFuncVar":var q=B[1][0],me=B[1][1];q||(q=0),q&=127;var re=q==0?[]:u.slice(-q);u.length-=q,me==="User"&&(me=re.shift()),u.push(me+"("+re.join(",")+")");break;case"PtgBool":u.push(B[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(B[1]);break;case"PtgNum":u.push(String(B[1]));break;case"PtgStr":u.push('"'+B[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(B[1]);break;case"PtgAreaN":C=Ab(B[1][1],s?{s}:c,a),u.push(G0(C,a));break;case"PtgArea":C=Ab(B[1][1],c,a),u.push(G0(C,a));break;case"PtgArea3d":w=B[1][1],C=B[1][2],k=Wb(n,w,a),u.push(k+"!"+G0(C,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":j=B[1][2];var M=(n.names||[])[j-1]||(n[0]||[])[j],G=M?M.Name:"SH33TJSNAME"+String(j);G&&G.slice(0,6)=="_xlfn."&&!a.xlfn&&(G=G.slice(6)),u.push(G);break;case"PtgNameX":var le=B[1][1];j=B[1][2];var Z;if(a.biff<=5)le<0&&(le=-le),n[le]&&(Z=n[le][j]);else{var he="";if(((n[le]||[])[0]||[])[0]==14849||(((n[le]||[])[0]||[])[0]==1025?n[le][j]&&n[le][j].itab>0&&(he=n.SheetNames[n[le][j].itab-1]+"!"):he=n.SheetNames[j-1]+"!"),n[le]&&n[le][j])he+=n[le][j].Name;else if(n[0]&&n[0][j])he+=n[0][j].Name;else{var ce=(HS(n,le,a)||"").split(";;");ce[j-1]?he=ce[j-1]:he+="SH33TJSERRX"}u.push(he);break}Z||(Z={Name:"SH33TJSERRY"}),u.push(Z.Name);break;case"PtgParen":var ke="(",Ee=")";if(S>=0){switch(_="",t[0][S][1][0]){case 2:ke=es(" ",t[0][S][1][1])+ke;break;case 3:ke=es("\r",t[0][S][1][1])+ke;break;case 4:Ee=es(" ",t[0][S][1][1])+Ee;break;case 5:Ee=es("\r",t[0][S][1][1])+Ee;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}S=-1}u.push(ke+u.pop()+Ee);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":y={c:B[1][1],r:B[1][0]};var Fe={c:s.c,r:s.r};if(n.sharedf[Fr(y)]){var X=n.sharedf[Fr(y)];u.push(to(X,c,Fe,n,a))}else{var ye=!1;for(f=0;f!=n.arrayf.length;++f)if(h=n.arrayf[f],!(y.c<h[0].s.c||y.c>h[0].e.c)&&!(y.r<h[0].s.r||y.r>h[0].e.r)){u.push(to(h[1],c,Fe,n,a)),ye=!0;break}ye||u.push(B[1])}break;case"PtgArray":u.push("{"+b6(B[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=I;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+B[1].idx+"[#"+B[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(B));default:throw new Error("Unrecognized Formula Token: "+String(B))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&S>=0&&Q.indexOf(t[0][I][0])==-1){B=t[0][S];var we=!0;switch(B[1][0]){case 4:we=!1;case 0:_=es(" ",B[1][1]);break;case 5:we=!1;case 1:_=es("\r",B[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+B[1][0])}u.push((we?_:"")+u.pop()+(we?"":_)),S=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function j6(t){if(t==null){var r=st(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof t=="number")return nl(t);return nl(0)}function S6(t,r,s,n,a){var l=al(r,s,a),c=j6(t.v),u=st(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var h=st(t.bf.length),y=0;y<t.bf.length;++y)h[y]=t.bf[y];var w=Ds([l,c,u,h]);return w}function Rm(t,r,s){var n=t.read_shift(4),a=v6(t,n,s),l=t.read_shift(4),c=l>0?y6(t,l,a,s):null;return[a,c]}var k6=Rm,Dm=Rm,C6=Rm,_6=Rm,E6={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},YS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},P6={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function A6(t){var r="of:="+t.replace(qh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function T6(t){return t.replace(/\./,"!")}var uc=typeof Map<"u";function $h(t,r,s){var n=0,a=t.length;if(s){if(uc?s.has(r):Object.prototype.hasOwnProperty.call(s,r)){for(var l=uc?s.get(r):s[r];n<l.length;++n)if(t[l[n]].t===r)return t.Count++,l[n]}}else for(;n<a;++n)if(t[n].t===r)return t.Count++,n;return t[a]={t:r},t.Count++,t.Unique++,s&&(uc?(s.has(r)||s.set(r,[]),s.get(r).push(a)):(Object.prototype.hasOwnProperty.call(s,r)||(s[r]=[]),s[r].push(a))),a}function Lm(t,r){var s={min:t+1,max:t+1},n=-1;return r.MDW&&(za=r.MDW),r.width!=null?s.customWidth=1:r.wpx!=null?n=Ju(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(s.width=Ex(n),s.customWidth=1):r.width!=null&&(s.width=r.width),r.hidden&&(s.hidden=!0),r.level!=null&&(s.outlineLevel=s.level=r.level),s}function KS(t,r){if(t){var s=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=s[0]),t.right==null&&(t.right=s[1]),t.top==null&&(t.top=s[2]),t.bottom==null&&(t.bottom=s[3]),t.header==null&&(t.header=s[4]),t.footer==null&&(t.footer=s[5])}}function Ai(t,r,s){var n=s.revssf[r.z!=null?r.z:"General"],a=60,l=t.length;if(n==null&&s.ssf){for(;a<392;++a)if(s.ssf[a]==null){Vj(r.z,a),s.ssf[a]=r.z,s.revssf[r.z]=n=a;break}}for(a=0;a!=l;++a)if(t[a].numFmtId===n)return a;return t[l]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function O6(t,r,s){if(t&&t["!ref"]){var n=Vr(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+s+"): "+t["!ref"])}}function R6(t){if(t.length===0)return"";for(var r='<mergeCells count="'+t.length+'">',s=0;s!=t.length;++s)r+='<mergeCell ref="'+fs(t[s])+'"/>';return r+"</mergeCells>"}function D6(t,r,s,n,a){var l=!1,c={},u=null;if(n.bookType!=="xlsx"&&r.vbaraw){var f=r.SheetNames[s];try{r.Workbook&&(f=r.Workbook.Sheets[s].CodeName||f)}catch{}l=!0,c.codeName=vc(Lr(f))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),u=(u||"")+Lt("outlinePr",null,h)}!l&&!u||(a[a.length]=Lt("sheetPr",u,c))}var L6=["objects","scenarios","selectLockedCells","selectUnlockedCells"],F6=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function M6(t){var r={sheet:1};return L6.forEach(function(s){t[s]!=null&&t[s]&&(r[s]="1")}),F6.forEach(function(s){t[s]!=null&&!t[s]&&(r[s]="0")}),t.password&&(r.password=RS(t.password).toString(16).toUpperCase()),Lt("sheetProtection",null,r)}function I6(t){return KS(t),Lt("pageMargins",null,t)}function q6(t,r){for(var s=["<cols>"],n,a=0;a!=r.length;++a)(n=r[a])&&(s[s.length]=Lt("col",null,Lm(a,n)));return s[s.length]="</cols>",s.join("")}function B6(t,r,s,n){var a=typeof t.ref=="string"?t.ref:fs(t.ref);s.Workbook||(s.Workbook={Sheets:[]}),s.Workbook.Names||(s.Workbook.Names=[]);var l=s.Workbook.Names,c=_n(a);c.s.r==c.e.r&&(c.e.r=_n(r["!ref"]).e.r,a=fs(c));for(var u=0;u<l.length;++u){var f=l[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+s.SheetNames[n]+"'!"+a;break}}return u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+s.SheetNames[n]+"'!"+a}),Lt("autoFilter",null,{ref:a})}function z6(t,r,s,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Lt("sheetViews",Lt("sheetView",null,a),{})}function $6(t,r,s,n){if(t.c&&s["!comments"].push([r,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",l=t.t,c=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Vc[t.v];break;case"d":n&&n.cellDates?a=Js(t.v,-1).toISOString():(t=xn(t),t.t="n",a=""+(t.v=pn(Js(t.v)))),typeof t.z>"u"&&(t.z=as[14]);break;default:a=t.v;break}var u=Ls("v",Lr(a)),f={r},h=Ai(n.cellXfs,t,n);switch(h!==0&&(f.s=h),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=Ls("v",""+$h(n.Strings,t.v,n.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=l&&(t.t=l,t.v=c),typeof t.f=="string"&&t.f){var y=t.F&&t.F.slice(0,r.length)==r?{t:"array",ref:t.F}:null;u=Lt("f",Lr(t.f),y)+(t.v!=null?u:"")}return t.l&&s["!links"].push([r,t.l]),t.D&&(f.cm=1),Lt("c",u,f)}function Q6(t,r,s,n){var a=[],l=[],c=Vr(t["!ref"]),u="",f,h="",y=[],w=0,j=0,C=t["!rows"],k=Array.isArray(t),S={r:h},_,I=-1;for(j=c.s.c;j<=c.e.c;++j)y[j]=Us(j);for(w=c.s.r;w<=c.e.r;++w){for(l=[],h=Fs(w),j=c.s.c;j<=c.e.c;++j){f=y[j]+h;var F=k?(t[w]||[])[j]:t[f];F!==void 0&&(u=$6(F,f,t,r))!=null&&l.push(u)}(l.length>0||C&&C[w])&&(S={r:h},C&&C[w]&&(_=C[w],_.hidden&&(S.hidden=1),I=-1,_.hpx?I=Zu(_.hpx):_.hpt&&(I=_.hpt),I>-1&&(S.ht=I,S.customHeight=1),_.level&&(S.outlineLevel=_.level)),a[a.length]=Lt("row",l.join(""),S))}if(C)for(;w<C.length;++w)C&&C[w]&&(S={r:w+1},_=C[w],_.hidden&&(S.hidden=1),I=-1,_.hpx?I=Zu(_.hpx):_.hpt&&(I=_.hpt),I>-1&&(S.ht=I,S.customHeight=1),_.level&&(S.outlineLevel=_.level),a[a.length]=Lt("row","",S));return a.join("")}function XS(t,r,s,n){var a=[ys,Lt("worksheet",null,{xmlns:xo[0],"xmlns:r":_s.r})],l=s.SheetNames[t],c=0,u="",f=s.Sheets[l];f==null&&(f={});var h=f["!ref"]||"A1",y=Vr(h);if(y.e.c>16383||y.e.r>1048575){if(r.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");y.e.c=Math.min(y.e.c,16383),y.e.r=Math.min(y.e.c,1048575),h=fs(y)}n||(n={}),f["!comments"]=[];var w=[];D6(f,s,t,r,a),a[a.length]=Lt("dimension",null,{ref:h}),a[a.length]=z6(f,r,t,s),r.sheetFormat&&(a[a.length]=Lt("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=q6(f,f["!cols"])),a[c=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=Q6(f,r),u.length>0&&(a[a.length]=u)),a.length>c+1&&(a[a.length]="</sheetData>",a[c]=a[c].replace("/>",">")),f["!protect"]&&(a[a.length]=M6(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=B6(f["!autofilter"],f,s,t)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=R6(f["!merges"]));var j=-1,C,k=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(S){S[1].Target&&(C={ref:S[0]},S[1].Target.charAt(0)!="#"&&(k=Dr(n,-1,Lr(S[1].Target).replace(/#.*$/,""),Cr.HLINK),C["r:id"]="rId"+k),(j=S[1].Target.indexOf("#"))>-1&&(C.location=Lr(S[1].Target.slice(j+1))),S[1].Tooltip&&(C.tooltip=Lr(S[1].Tooltip)),a[a.length]=Lt("hyperlink",null,C))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=I6(f["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(a[a.length]=Ls("ignoredErrors",Lt("ignoredError",null,{numberStoredAsText:1,sqref:h}))),w.length>0&&(k=Dr(n,-1,"../drawings/drawing"+(t+1)+".xml",Cr.DRAW),a[a.length]=Lt("drawing",null,{"r:id":"rId"+k}),f["!drawing"]=w),f["!comments"].length>0&&(k=Dr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Cr.VML),a[a.length]=Lt("legacyDrawing",null,{"r:id":"rId"+k}),f["!legacy"]=k),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function U6(t,r){var s={},n=t.l+r;s.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var l=t.read_shift(1);return t.l=n,l&7&&(s.level=l&7),l&16&&(s.hidden=!0),l&32&&(s.hpt=a/20),s}function V6(t,r,s){var n=st(145),a=(s["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var l=320;a.hpx?l=Zu(a.hpx)*20:a.hpt&&(l=a.hpt*20),n.write_shift(2,l),n.write_shift(1,0);var c=0;a.level&&(c|=a.level),a.hidden&&(c|=16),(a.hpx||a.hpt)&&(c|=32),n.write_shift(1,c),n.write_shift(1,0);var u=0,f=n.l;n.l+=4;for(var h={r:t,c:0},y=0;y<16;++y)if(!(r.s.c>y+1<<10||r.e.c<y<<10)){for(var w=-1,j=-1,C=y<<10;C<y+1<<10;++C){h.c=C;var k=Array.isArray(s)?(s[h.r]||[])[h.c]:s[Fr(h)];k&&(w<0&&(w=C),j=C)}w<0||(++u,n.write_shift(4,w),n.write_shift(4,j))}var S=n.l;return n.l=f,n.write_shift(4,u),n.l=S,n.length>n.l?n.slice(0,n.l):n}function W6(t,r,s,n){var a=V6(n,s,r);(a.length>17||(r["!rows"]||[])[n])&&dt(t,0,a)}var G6=dl,H6=fo;function Y6(){}function K6(t,r){var s={},n=t[t.l];return++t.l,s.above=!(n&64),s.left=!(n&128),t.l+=18,s.name=iF(t),s}function X6(t,r,s){s==null&&(s=st(84+4*t.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),s.write_shift(1,n);for(var a=1;a<3;++a)s.write_shift(1,0);return Yu({auto:1},s),s.write_shift(-4,-1),s.write_shift(-4,-1),mS(t,s),s.slice(0,s.l)}function J6(t){var r=In(t);return[r]}function Z6(t,r,s){return s==null&&(s=st(8)),ll(r,s)}function e8(t){var r=ol(t);return[r]}function t8(t,r,s){return s==null&&(s=st(4)),cl(r,s)}function r8(t){var r=In(t),s=t.read_shift(1);return[r,s,"b"]}function s8(t,r,s){return s==null&&(s=st(9)),ll(r,s),s.write_shift(1,t.v?1:0),s}function n8(t){var r=ol(t),s=t.read_shift(1);return[r,s,"b"]}function a8(t,r,s){return s==null&&(s=st(5)),cl(r,s),s.write_shift(1,t.v?1:0),s}function i8(t){var r=In(t),s=t.read_shift(1);return[r,s,"e"]}function l8(t,r,s){return s==null&&(s=st(9)),ll(r,s),s.write_shift(1,t.v),s}function o8(t){var r=ol(t),s=t.read_shift(1);return[r,s,"e"]}function c8(t,r,s){return s==null&&(s=st(8)),cl(r,s),s.write_shift(1,t.v),s.write_shift(2,0),s.write_shift(1,0),s}function d8(t){var r=In(t),s=t.read_shift(4);return[r,s,"s"]}function u8(t,r,s){return s==null&&(s=st(12)),ll(r,s),s.write_shift(4,r.v),s}function m8(t){var r=ol(t),s=t.read_shift(4);return[r,s,"s"]}function p8(t,r,s){return s==null&&(s=st(8)),cl(r,s),s.write_shift(4,r.v),s}function x8(t){var r=In(t),s=go(t);return[r,s,"n"]}function h8(t,r,s){return s==null&&(s=st(16)),ll(r,s),nl(t.v,s),s}function f8(t){var r=ol(t),s=go(t);return[r,s,"n"]}function g8(t,r,s){return s==null&&(s=st(12)),cl(r,s),nl(t.v,s),s}function y8(t){var r=In(t),s=pS(t);return[r,s,"n"]}function v8(t,r,s){return s==null&&(s=st(12)),ll(r,s),xS(t.v,s),s}function b8(t){var r=ol(t),s=pS(t);return[r,s,"n"]}function w8(t,r,s){return s==null&&(s=st(8)),cl(r,s),xS(t.v,s),s}function N8(t){var r=In(t),s=Dh(t);return[r,s,"is"]}function j8(t){var r=In(t),s=Vs(t);return[r,s,"str"]}function S8(t,r,s){return s==null&&(s=st(12+4*t.v.length)),ll(r,s),Ps(t.v,s),s.length>s.l?s.slice(0,s.l):s}function k8(t){var r=ol(t),s=Vs(t);return[r,s,"str"]}function C8(t,r,s){return s==null&&(s=st(8+4*t.v.length)),cl(r,s),Ps(t.v,s),s.length>s.l?s.slice(0,s.l):s}function _8(t,r,s){var n=t.l+r,a=In(t);a.r=s["!row"];var l=t.read_shift(1),c=[a,l,"b"];if(s.cellFormula){t.l+=2;var u=Dm(t,n-t.l,s);c[3]=to(u,null,a,s.supbooks,s)}else t.l=n;return c}function E8(t,r,s){var n=t.l+r,a=In(t);a.r=s["!row"];var l=t.read_shift(1),c=[a,l,"e"];if(s.cellFormula){t.l+=2;var u=Dm(t,n-t.l,s);c[3]=to(u,null,a,s.supbooks,s)}else t.l=n;return c}function P8(t,r,s){var n=t.l+r,a=In(t);a.r=s["!row"];var l=go(t),c=[a,l,"n"];if(s.cellFormula){t.l+=2;var u=Dm(t,n-t.l,s);c[3]=to(u,null,a,s.supbooks,s)}else t.l=n;return c}function A8(t,r,s){var n=t.l+r,a=In(t);a.r=s["!row"];var l=Vs(t),c=[a,l,"str"];if(s.cellFormula){t.l+=2;var u=Dm(t,n-t.l,s);c[3]=to(u,null,a,s.supbooks,s)}else t.l=n;return c}var T8=dl,O8=fo;function R8(t,r){return r==null&&(r=st(4)),r.write_shift(4,t),r}function D8(t,r){var s=t.l+r,n=dl(t),a=Lh(t),l=Vs(t),c=Vs(t),u=Vs(t);t.l=s;var f={rfx:n,relId:a,loc:l,display:u};return c&&(f.Tooltip=c),f}function L8(t,r){var s=st(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));fo({s:Es(t[0]),e:Es(t[0])},s),Fh("rId"+r,s);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return Ps(a||"",s),Ps(t[1].Tooltip||"",s),Ps("",s),s.slice(0,s.l)}function F8(){}function M8(t,r,s){var n=t.l+r,a=hS(t),l=t.read_shift(1),c=[a];if(c[2]=l,s.cellFormula){var u=k6(t,n-t.l,s);c[1]=u}else t.l=n;return c}function I8(t,r,s){var n=t.l+r,a=dl(t),l=[a];if(s.cellFormula){var c=_6(t,n-t.l,s);l[1]=c,t.l=n}else t.l=n;return l}function q8(t,r,s){s==null&&(s=st(18));var n=Lm(t,r);s.write_shift(-4,t),s.write_shift(-4,t),s.write_shift(4,(n.width||10)*256),s.write_shift(4,0);var a=0;return r.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),r.level&&(a|=r.level<<8),s.write_shift(2,a),s}var JS=["left","right","top","bottom","header","footer"];function B8(t){var r={};return JS.forEach(function(s){r[s]=go(t)}),r}function z8(t,r){return r==null&&(r=st(48)),KS(t),JS.forEach(function(s){nl(t[s],r)}),r}function $8(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function Q8(t,r,s){s==null&&(s=st(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),s.write_shift(2,n),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(2,0),s.write_shift(2,100),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s}function U8(t){var r=st(24);return r.write_shift(4,4),r.write_shift(4,1),fo(t,r),r}function V8(t,r){return r==null&&(r=st(66)),r.write_shift(2,t.password?RS(t.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(s){s[1]?r.write_shift(4,t[s[0]]!=null&&!t[s[0]]?1:0):r.write_shift(4,t[s[0]]!=null&&t[s[0]]?0:1)}),r}function W8(){}function G8(){}function H8(t,r,s,n,a,l,c){if(r.v===void 0)return!1;var u="";switch(r.t){case"b":u=r.v?"1":"0";break;case"d":r=xn(r),r.z=r.z||as[14],r.v=pn(Js(r.v)),r.t="n";break;case"n":case"e":u=""+r.v;break;default:u=r.v;break}var f={r:s,c:n};switch(f.s=Ai(a.cellXfs,r,a),r.l&&l["!links"].push([Fr(f),r.l]),r.c&&l["!comments"].push([Fr(f),r.c]),r.t){case"s":case"str":return a.bookSST?(u=$h(a.Strings,r.v,a.revStrings),f.t="s",f.v=u,c?dt(t,18,p8(r,f)):dt(t,7,u8(r,f))):(f.t="str",c?dt(t,17,C8(r,f)):dt(t,6,S8(r,f))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?c?dt(t,13,w8(r,f)):dt(t,2,v8(r,f)):c?dt(t,16,g8(r,f)):dt(t,5,h8(r,f)),!0;case"b":return f.t="b",c?dt(t,15,a8(r,f)):dt(t,4,s8(r,f)),!0;case"e":return f.t="e",c?dt(t,14,c8(r,f)):dt(t,3,l8(r,f)),!0}return c?dt(t,12,t8(r,f)):dt(t,1,Z6(r,f)),!0}function Y8(t,r,s,n){var a=Vr(r["!ref"]||"A1"),l,c="",u=[];dt(t,145);var f=Array.isArray(r),h=a.e.r;r["!rows"]&&(h=Math.max(a.e.r,r["!rows"].length-1));for(var y=a.s.r;y<=h;++y){c=Fs(y),W6(t,r,a,y);var w=!1;if(y<=a.e.r)for(var j=a.s.c;j<=a.e.c;++j){y===a.s.r&&(u[j]=Us(j)),l=u[j]+c;var C=f?(r[y]||[])[j]:r[l];if(!C){w=!1;continue}w=H8(t,C,y,j,n,r,w)}}dt(t,146)}function K8(t,r){!r||!r["!merges"]||(dt(t,177,R8(r["!merges"].length)),r["!merges"].forEach(function(s){dt(t,176,O8(s))}),dt(t,178))}function X8(t,r){!r||!r["!cols"]||(dt(t,390),r["!cols"].forEach(function(s,n){s&&dt(t,60,q8(n,s))}),dt(t,391))}function J8(t,r){!r||!r["!ref"]||(dt(t,648),dt(t,649,U8(Vr(r["!ref"]))),dt(t,650))}function Z8(t,r,s){r["!links"].forEach(function(n){if(n[1].Target){var a=Dr(s,-1,n[1].Target.replace(/#.*$/,""),Cr.HLINK);dt(t,494,L8(n,a))}}),delete r["!links"]}function e7(t,r,s,n){if(r["!comments"].length>0){var a=Dr(n,-1,"../drawings/vmlDrawing"+(s+1)+".vml",Cr.VML);dt(t,551,Fh("rId"+a)),r["!legacy"]=a}}function t7(t,r,s,n){if(r["!autofilter"]){var a=r["!autofilter"],l=typeof a.ref=="string"?a.ref:fs(a.ref);s.Workbook||(s.Workbook={Sheets:[]}),s.Workbook.Names||(s.Workbook.Names=[]);var c=s.Workbook.Names,u=_n(l);u.s.r==u.e.r&&(u.e.r=_n(r["!ref"]).e.r,l=fs(u));for(var f=0;f<c.length;++f){var h=c[f];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+s.SheetNames[n]+"'!"+l;break}}f==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+s.SheetNames[n]+"'!"+l}),dt(t,161,fo(Vr(l))),dt(t,162)}}function r7(t,r,s){dt(t,133),dt(t,137,Q8(r,s)),dt(t,138),dt(t,134)}function s7(t,r){r["!protect"]&&dt(t,535,V8(r["!protect"]))}function n7(t,r,s,n){var a=mn(),l=s.SheetNames[t],c=s.Sheets[l]||{},u=l;try{s&&s.Workbook&&(u=s.Workbook.Sheets[t].CodeName||u)}catch{}var f=Vr(c["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(r.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],dt(a,129),(s.vbaraw||c["!outline"])&&dt(a,147,X6(u,c["!outline"])),dt(a,148,H6(f)),r7(a,c,s.Workbook),X8(a,c),Y8(a,c,t,r),s7(a,c),t7(a,c,s,t),K8(a,c),Z8(a,c,n),c["!margins"]&&dt(a,476,z8(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&J8(a,c),e7(a,c,t,n),dt(a,130),a.end()}function a7(t,r){t.l+=10;var s=Vs(t);return{name:s}}var i7=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function l7(t){return!t.Workbook||!t.Workbook.WBProps?"false":I9(t.Workbook.WBProps.date1904)?"true":"false"}var o7="][*?/\\".split("");function ZS(t,r){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var s=!0;return o7.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),s}function c7(t,r,s){t.forEach(function(n,a){ZS(n);for(var l=0;l<a;++l)if(n==t[l])throw new Error("Duplicate Sheet Name: "+n);if(s){var c=r&&r[a]&&r[a].CodeName||n;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function d7(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var r=t.Workbook&&t.Workbook.Sheets||[];c7(t.SheetNames,r,!!t.vbaraw);for(var s=0;s<t.SheetNames.length;++s)O6(t.Sheets[t.SheetNames[s]],t.SheetNames[s],s)}function e2(t){var r=[ys];r[r.length]=Lt("workbook",null,{xmlns:xo[0],"xmlns:r":_s.r});var s=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(i7.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=Lt("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],l=0;if(a&&a[0]&&a[0].Hidden){for(r[r.length]="<bookViews>",l=0;l!=t.SheetNames.length&&!(!a[l]||!a[l].Hidden);++l);l==t.SheetNames.length&&(l=0),r[r.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",l=0;l!=t.SheetNames.length;++l){var c={name:Lr(t.SheetNames[l].slice(0,31))};if(c.sheetId=""+(l+1),c["r:id"]="rId"+(l+1),a[l])switch(a[l].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}r[r.length]=Lt("sheet",null,c)}return r[r.length]="</sheets>",s&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(r[r.length]=Lt("definedName",Lr(u.Ref),f))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function u7(t,r){var s={};return s.Hidden=t.read_shift(4),s.iTabID=t.read_shift(4),s.strRelID=_x(t),s.name=Vs(t),s}function m7(t,r){return r||(r=st(127)),r.write_shift(4,t.Hidden),r.write_shift(4,t.iTabID),Fh(t.strRelID,r),Ps(t.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function p7(t,r){var s={},n=t.read_shift(4);s.defaultThemeVersion=t.read_shift(4);var a=r>8?Vs(t):"";return a.length>0&&(s.CodeName=a),s.autoCompressPictures=!!(n&65536),s.backupFile=!!(n&64),s.checkCompatibility=!!(n&4096),s.date1904=!!(n&1),s.filterPrivacy=!!(n&8),s.hidePivotFieldList=!!(n&1024),s.promptedSolutions=!!(n&16),s.publishItems=!!(n&2048),s.refreshAllConnections=!!(n&262144),s.saveExternalLinkValues=!!(n&128),s.showBorderUnselectedTables=!!(n&4),s.showInkAnnotation=!!(n&32),s.showObjects=["all","placeholders","none"][n>>13&3],s.showPivotChartFilter=!!(n&32768),s.updateLinks=["userSet","never","always"][n>>8&3],s}function x7(t,r){r||(r=st(72));var s=0;return t&&t.filterPrivacy&&(s|=8),r.write_shift(4,s),r.write_shift(4,0),mS(t&&t.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function h7(t,r,s){var n=t.l+r;t.l+=4,t.l+=1;var a=t.read_shift(4),l=lF(t),c=C6(t,0,s),u=Lh(t);t.l=n;var f={Name:l,Ptg:c};return a<268435455&&(f.Sheet=a),u&&(f.Comment=u),f}function f7(t,r){dt(t,143);for(var s=0;s!=r.SheetNames.length;++s){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[s]&&r.Workbook.Sheets[s].Hidden||0,a={Hidden:n,iTabID:s+1,strRelID:"rId"+(s+1),name:r.SheetNames[s]};dt(t,156,m7(a))}dt(t,144)}function g7(t,r){r||(r=st(127));for(var s=0;s!=4;++s)r.write_shift(4,0);return Ps("SheetJS",r),Ps(zu.version,r),Ps(zu.version,r),Ps("7262",r),r.length>r.l?r.slice(0,r.l):r}function y7(t,r){r||(r=st(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,t),r.write_shift(4,t);var s=120;return r.write_shift(1,s),r.length>r.l?r.slice(0,r.l):r}function v7(t,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var s=r.Workbook.Sheets,n=0,a=-1,l=-1;n<s.length;++n)!s[n]||!s[n].Hidden&&a==-1?a=n:s[n].Hidden==1&&l==-1&&(l=n);l>a||(dt(t,135),dt(t,158,y7(a)),dt(t,136))}}function b7(t,r){var s=mn();return dt(s,131),dt(s,128,g7()),dt(s,153,x7(t.Workbook&&t.Workbook.WBProps||null)),v7(s,t),f7(s,t),dt(s,132),s.end()}function w7(t,r,s){return(r.slice(-4)===".bin"?b7:e2)(t)}function N7(t,r,s,n,a){return(r.slice(-4)===".bin"?n7:XS)(t,s,n,a)}function j7(t,r,s){return(r.slice(-4)===".bin"?zM:FS)(t,s)}function S7(t,r,s){return(r.slice(-4)===".bin"?xM:OS)(t,s)}function k7(t,r,s){return(r.slice(-4)===".bin"?sI:zS)(t)}function C7(t){return(t.slice(-4)===".bin"?YM:qS)()}function _7(t,r){var s=[];return t.Props&&s.push(jF(t.Props,r)),t.Custprops&&s.push(SF(t.Props,t.Custprops)),s.join("")}function E7(){return""}function P7(t,r){var s=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,a){var l=[];l.push(Lt("NumberFormat",null,{"ss:Format":Lr(as[n.numFmtId])}));var c={"ss:ID":"s"+(21+a)};s.push(Lt("Style",l.join(""),c))}),Lt("Styles",s.join(""))}function t2(t){return Lt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Bh(t.Ref,{r:0,c:0})})}function A7(t){if(!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,s=[],n=0;n<r.length;++n){var a=r[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||s.push(t2(a)))}return Lt("Names",s.join(""))}function T7(t,r,s,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,l=[],c=0;c<a.length;++c){var u=a[c];u.Sheet==s&&(u.Name.match(/^_xlfn\./)||l.push(t2(u)))}return l.join("")}function O7(t,r,s,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Lt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Lt("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Lt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[s])if(n.Workbook.Sheets[s].Hidden)a.push(Lt("Visible",n.Workbook.Sheets[s].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<s&&!(n.Workbook.Sheets[l]&&!n.Workbook.Sheets[l].Hidden);++l);l==s&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(Ls("ProtectContents","True")),t["!protect"].objects&&a.push(Ls("ProtectObjects","True")),t["!protect"].scenarios&&a.push(Ls("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(Ls("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(Ls("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){t["!protect"][c[0]]&&a.push("<"+c[1]+"/>")})),a.length==0?"":Lt("WorksheetOptions",a.join(""),{xmlns:jn.x})}function R7(t){return t.map(function(r){var s=M9(r.t||""),n=Lt("ss:Data",s,{xmlns:"http://www.w3.org/TR/REC-html40"});return Lt("Comment",n,{"ss:Author":r.a})}).join("")}function D7(t,r,s,n,a,l,c){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+Lr(Bh(t.f,c))),t.F&&t.F.slice(0,r.length)==r){var f=Es(t.F.slice(r.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==c.r?"":"["+(f.r-c.r)+"]")+"C"+(f.c==c.c?"":"["+(f.c-c.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=Lr(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=Lr(t.l.Tooltip))),s["!merges"])for(var h=s["!merges"],y=0;y!=h.length;++y)h[y].s.c!=c.c||h[y].s.r!=c.r||(h[y].e.c>h[y].s.c&&(u["ss:MergeAcross"]=h[y].e.c-h[y].s.c),h[y].e.r>h[y].s.r&&(u["ss:MergeDown"]=h[y].e.r-h[y].s.r));var w="",j="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":w="Number",j=String(t.v);break;case"b":w="Boolean",j=t.v?"1":"0";break;case"e":w="Error",j=Vc[t.v];break;case"d":w="DateTime",j=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||as[14]);break;case"s":w="String",j=F9(t.v||"");break}var C=Ai(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+C),u["ss:Index"]=c.c+1;var k=t.v!=null?j:"",S=t.t=="z"?"":'<Data ss:Type="'+w+'">'+k+"</Data>";return(t.c||[]).length>0&&(S+=R7(t.c)),Lt("Cell",S,u)}function L7(t,r){var s='<Row ss:Index="'+(t+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=LS(r.hpt)),r.hpx&&(s+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(s+=' ss:Hidden="1"')),s+">"}function F7(t,r,s,n){if(!t["!ref"])return"";var a=Vr(t["!ref"]),l=t["!merges"]||[],c=0,u=[];t["!cols"]&&t["!cols"].forEach(function(_,I){Ih(_);var F=!!_.width,B=Lm(I,_),q={"ss:Index":I+1};F&&(q["ss:Width"]=Xu(B.width)),_.hidden&&(q["ss:Hidden"]="1"),u.push(Lt("Column",null,q))});for(var f=Array.isArray(t),h=a.s.r;h<=a.e.r;++h){for(var y=[L7(h,(t["!rows"]||[])[h])],w=a.s.c;w<=a.e.c;++w){var j=!1;for(c=0;c!=l.length;++c)if(!(l[c].s.c>w)&&!(l[c].s.r>h)&&!(l[c].e.c<w)&&!(l[c].e.r<h)){(l[c].s.c!=w||l[c].s.r!=h)&&(j=!0);break}if(!j){var C={r:h,c:w},k=Fr(C),S=f?(t[h]||[])[w]:t[k];y.push(D7(S,k,t,r,s,n,C))}}y.push("</Row>"),y.length>2&&u.push(y.join(""))}return u.join("")}function M7(t,r,s){var n=[],a=s.SheetNames[t],l=s.Sheets[a],c=l?T7(l,r,t,s):"";return c.length>0&&n.push("<Names>"+c+"</Names>"),c=l?F7(l,r,t,s):"",c.length>0&&n.push("<Table>"+c+"</Table>"),n.push(O7(l,r,t,s)),n.join("")}function I7(t,r){r||(r={}),t.SSF||(t.SSF=xn(as)),t.SSF&&(Am(),Pm(t.SSF),r.revssf=Tm(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF,r.cellXfs=[],Ai(r.cellXfs,{},{revssf:{General:0}}));var s=[];s.push(_7(t,r)),s.push(E7()),s.push(""),s.push("");for(var n=0;n<t.SheetNames.length;++n)s.push(Lt("Worksheet",M7(n,r,t),{"ss:Name":Lr(t.SheetNames[n])}));return s[2]=P7(t,r),s[3]=A7(t),ys+Lt("Workbook",s.join(""),{xmlns:jn.ss,"xmlns:o":jn.o,"xmlns:x":jn.x,"xmlns:ss":jn.ss,"xmlns:dt":jn.dt,"xmlns:html":jn.html})}var K0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function q7(t,r){var s=[],n=[],a=[],l=0,c,u=vb(Ob,"n"),f=vb(Rb,"n");if(t.Props)for(c=Ms(t.Props),l=0;l<c.length;++l)(Object.prototype.hasOwnProperty.call(u,c[l])?s:Object.prototype.hasOwnProperty.call(f,c[l])?n:a).push([c[l],t.Props[c[l]]]);if(t.Custprops)for(c=Ms(t.Custprops),l=0;l<c.length;++l)Object.prototype.hasOwnProperty.call(t.Props||{},c[l])||(Object.prototype.hasOwnProperty.call(u,c[l])?s:Object.prototype.hasOwnProperty.call(f,c[l])?n:a).push([c[l],t.Custprops[c[l]]]);var h=[];for(l=0;l<a.length;++l)kS.indexOf(a[l][0])>-1||NS.indexOf(a[l][0])>-1||a[l][1]!=null&&h.push(a[l]);n.length&&Mr.utils.cfb_add(r,"/SummaryInformation",Ib(n,K0.SI,f,Rb)),(s.length||h.length)&&Mr.utils.cfb_add(r,"/DocumentSummaryInformation",Ib(s,K0.DSI,u,Ob,h.length?h:null,K0.UDI))}function B7(t,r){var s=r||{},n=Mr.utils.cfb_new({root:"R"}),a="/Workbook";switch(s.bookType||"xls"){case"xls":s.bookType="biff8";case"xla":s.bookType||(s.bookType="xla");case"biff8":a="/Workbook",s.biff=8;break;case"biff5":a="/Book",s.biff=5;break;default:throw new Error("invalid type "+s.bookType+" for XLS CFB")}return Mr.utils.cfb_add(n,a,r2(t,s)),s.biff==8&&(t.Props||t.Custprops)&&q7(t,n),s.biff==8&&t.vbaraw&&nI(n,Mr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var z7={0:{f:U6},1:{f:J6},2:{f:y8},3:{f:i8},4:{f:r8},5:{f:x8},6:{f:j8},7:{f:d8},8:{f:A8},9:{f:P8},10:{f:_8},11:{f:E8},12:{f:e8},13:{f:b8},14:{f:o8},15:{f:n8},16:{f:f8},17:{f:k8},18:{f:m8},19:{f:Dh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:h7},40:{},42:{},43:{f:jM},44:{f:wM},45:{f:CM},46:{f:EM},47:{f:_M},48:{},49:{f:eF},50:{},51:{f:UM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:tM},62:{f:N8},63:{f:KM},64:{f:W8},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:wa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:$8},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:K6},148:{f:G6,p:16},151:{f:F8},152:{},153:{f:p7},154:{},155:{},156:{f:u7},157:{},158:{},159:{T:1,f:uM},160:{T:-1},161:{T:1,f:dl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:T8},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:$M},336:{T:-1},337:{f:GM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:_x},357:{},358:{},359:{},360:{T:1},361:{},362:{f:YF},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:M8},427:{f:I8},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:B8},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Y6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:D8},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:_x},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:tI},633:{T:1},634:{T:-1},635:{T:1,f:ZM},636:{T:-1},637:{f:nF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:a7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:G8},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Mt(t,r,s,n){var a=r;if(!isNaN(a)){var l=n||(s||[]).length||0,c=t.next(4);c.write_shift(2,a),c.write_shift(2,l),l>0&&Th(s)&&t.push(s)}}function $7(t,r,s,n){var a=(s||[]).length||0;if(a<=8224)return Mt(t,r,s,a);var l=r;if(!isNaN(l)){for(var c=s.parts||[],u=0,f=0,h=0;h+(c[u]||8224)<=8224;)h+=c[u]||8224,u++;var y=t.next(4);for(y.write_shift(2,l),y.write_shift(2,h),t.push(s.slice(f,f+h)),f+=h;f<a;){for(y=t.next(4),y.write_shift(2,60),h=0;h+(c[u]||8224)<=8224;)h+=c[u]||8224,u++;y.write_shift(2,h),t.push(s.slice(f,f+h)),f+=h}}}function Gc(t,r,s){return t||(t=st(7)),t.write_shift(2,r),t.write_shift(2,s),t.write_shift(2,0),t.write_shift(1,0),t}function Q7(t,r,s,n){var a=st(9);return Gc(a,t,r),_S(s,n||"b",a),a}function U7(t,r,s){var n=st(8+2*s.length);return Gc(n,t,r),n.write_shift(1,s.length),n.write_shift(s.length,s,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function V7(t,r,s,n){if(r.v!=null)switch(r.t){case"d":case"n":var a=r.t=="d"?pn(Js(r.v)):r.v;a==(a|0)&&a>=0&&a<65536?Mt(t,2,aM(s,n,a)):Mt(t,3,nM(s,n,a));return;case"b":case"e":Mt(t,5,Q7(s,n,r.v,r.t));return;case"s":case"str":Mt(t,4,U7(s,n,(r.v||"").slice(0,255)));return}Mt(t,1,Gc(null,s,n))}function W7(t,r,s,n){var a=Array.isArray(r),l=Vr(r["!ref"]||"A1"),c,u="",f=[];if(l.e.c>255||l.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),c=fs(l)}for(var h=l.s.r;h<=l.e.r;++h){u=Fs(h);for(var y=l.s.c;y<=l.e.c;++y){h===l.s.r&&(f[y]=Us(y)),c=f[y]+u;var w=a?(r[h]||[])[y]:r[c];w&&V7(t,w,h,y)}}}function G7(t,r){for(var s=r||{},n=mn(),a=0,l=0;l<t.SheetNames.length;++l)t.SheetNames[l]==s.sheet&&(a=l);if(a==0&&s.sheet&&t.SheetNames[0]!=s.sheet)throw new Error("Sheet not found: "+s.sheet);return Mt(n,s.biff==4?1033:s.biff==3?521:9,Mh(t,16,s)),W7(n,t.Sheets[t.SheetNames[a]],a,s),Mt(n,10),n.end()}function H7(t,r,s){Mt(t,49,zF({sz:12,name:"Arial"},s))}function Y7(t,r,s){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)r[a]!=null&&Mt(t,1054,UF(a,r[a],s))})}function K7(t,r){var s=st(19);s.write_shift(4,2151),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,3),s.write_shift(1,1),s.write_shift(4,0),Mt(t,2151,s),s=st(39),s.write_shift(4,2152),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,3),s.write_shift(1,0),s.write_shift(4,0),s.write_shift(2,1),s.write_shift(4,4),s.write_shift(2,0),AS(Vr(r["!ref"]||"A1"),s),s.write_shift(4,4),Mt(t,2152,s)}function X7(t,r){for(var s=0;s<16;++s)Mt(t,224,Bb({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){Mt(t,224,Bb(n,0,r))})}function J7(t,r){for(var s=0;s<r["!links"].length;++s){var n=r["!links"][s];Mt(t,440,JF(n)),n[1].Tooltip&&Mt(t,2048,ZF(n))}delete r["!links"]}function Z7(t,r){if(r){var s=0;r.forEach(function(n,a){++s<=256&&n&&Mt(t,125,rM(Lm(a,n),a))})}}function eq(t,r,s,n,a){var l=16+Ai(a.cellXfs,r,a);if(r.v==null&&!r.bf){Mt(t,513,al(s,n,l));return}if(r.bf)Mt(t,6,S6(r,s,n,a,l));else switch(r.t){case"d":case"n":var c=r.t=="d"?pn(Js(r.v)):r.v;Mt(t,515,HF(s,n,c,l));break;case"b":case"e":Mt(t,517,GF(s,n,r.v,l,a,r.t));break;case"s":case"str":if(a.bookSST){var u=$h(a.Strings,r.v,a.revStrings);Mt(t,253,$F(s,n,u,l))}else Mt(t,516,QF(s,n,(r.v||"").slice(0,255),l,a));break;default:Mt(t,513,al(s,n,l))}}function tq(t,r,s){var n=mn(),a=s.SheetNames[t],l=s.Sheets[a]||{},c=(s||{}).Workbook||{},u=(c.Sheets||[])[t]||{},f=Array.isArray(l),h=r.biff==8,y,w="",j=[],C=Vr(l["!ref"]||"A1"),k=h?65536:16384;if(C.e.c>255||C.e.r>=k){if(r.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");C.e.c=Math.min(C.e.c,255),C.e.r=Math.min(C.e.c,k-1)}Mt(n,2057,Mh(s,16,r)),Mt(n,13,Fn(1)),Mt(n,12,Fn(100)),Mt(n,15,Xs(!0)),Mt(n,17,Xs(!1)),Mt(n,16,nl(.001)),Mt(n,95,Xs(!0)),Mt(n,42,Xs(!1)),Mt(n,43,Xs(!1)),Mt(n,130,Fn(1)),Mt(n,128,WF()),Mt(n,131,Xs(!1)),Mt(n,132,Xs(!1)),h&&Z7(n,l["!cols"]),Mt(n,512,VF(C,r)),h&&(l["!links"]=[]);for(var S=C.s.r;S<=C.e.r;++S){w=Fs(S);for(var _=C.s.c;_<=C.e.c;++_){S===C.s.r&&(j[_]=Us(_)),y=j[_]+w;var I=f?(l[S]||[])[_]:l[y];I&&(eq(n,I,S,_,r),h&&I.l&&l["!links"].push([y,I.l]))}}var F=u.CodeName||u.name||a;return h&&Mt(n,574,BF((c.Views||[])[0])),h&&(l["!merges"]||[]).length&&Mt(n,229,XF(l["!merges"])),h&&J7(n,l),Mt(n,442,PS(F)),h&&K7(n,l),Mt(n,10),n.end()}function rq(t,r,s){var n=mn(),a=(t||{}).Workbook||{},l=a.Sheets||[],c=a.WBProps||{},u=s.biff==8,f=s.biff==5;if(Mt(n,2057,Mh(t,5,s)),s.bookType=="xla"&&Mt(n,135),Mt(n,225,u?Fn(1200):null),Mt(n,193,_F(2)),f&&Mt(n,191),f&&Mt(n,192),Mt(n,226),Mt(n,92,FF("SheetJS",s)),Mt(n,66,Fn(u?1200:1252)),u&&Mt(n,353,Fn(0)),u&&Mt(n,448),Mt(n,317,sM(t.SheetNames.length)),u&&t.vbaraw&&Mt(n,211),u&&t.vbaraw){var h=c.CodeName||"ThisWorkbook";Mt(n,442,PS(h))}Mt(n,156,Fn(17)),Mt(n,25,Xs(!1)),Mt(n,18,Xs(!1)),Mt(n,19,Fn(0)),u&&Mt(n,431,Xs(!1)),u&&Mt(n,444,Fn(0)),Mt(n,61,qF()),Mt(n,64,Xs(!1)),Mt(n,141,Fn(0)),Mt(n,34,Xs(l7(t)=="true")),Mt(n,14,Xs(!0)),u&&Mt(n,439,Xs(!1)),Mt(n,218,Fn(0)),H7(n,t,s),Y7(n,t.SSF,s),X7(n,s),u&&Mt(n,352,Xs(!1));var y=n.end(),w=mn();u&&Mt(w,140,eM()),u&&s.Strings&&$7(w,252,IF(s.Strings)),Mt(w,10);var j=w.end(),C=mn(),k=0,S=0;for(S=0;S<t.SheetNames.length;++S)k+=(u?12:11)+(u?2:1)*t.SheetNames[S].length;var _=y.length+k+j.length;for(S=0;S<t.SheetNames.length;++S){var I=l[S]||{};Mt(C,133,MF({pos:_,hs:I.Hidden||0,dt:0,name:t.SheetNames[S]},s)),_+=r[S].length}var F=C.end();if(k!=F.length)throw new Error("BS8 "+k+" != "+F.length);var B=[];return y.length&&B.push(y),F.length&&B.push(F),j.length&&B.push(j),Ds(B)}function sq(t,r){var s=r||{},n=[];t&&!t.SSF&&(t.SSF=xn(as)),t&&t.SSF&&(Am(),Pm(t.SSF),s.revssf=Tm(t.SSF),s.revssf[t.SSF[65535]]=0,s.ssf=t.SSF),s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,Qh(s),s.cellXfs=[],Ai(s.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=tq(a,s,t);return n.unshift(rq(t,n,s)),Ds(n)}function r2(t,r){for(var s=0;s<=t.SheetNames.length;++s){var n=t.Sheets[t.SheetNames[s]];if(!(!n||!n["!ref"])){var a=_n(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[s]+"' extends beyond column IV (255).  Data may be lost.")}}var l=r||{};switch(l.biff||2){case 8:case 5:return sq(t,r);case 4:case 3:case 2:return G7(t,r)}throw new Error("invalid type "+l.bookType+" for BIFF")}function nq(t,r,s,n){for(var a=t["!merges"]||[],l=[],c=r.s.c;c<=r.e.c;++c){for(var u=0,f=0,h=0;h<a.length;++h)if(!(a[h].s.r>s||a[h].s.c>c)&&!(a[h].e.r<s||a[h].e.c<c)){if(a[h].s.r<s||a[h].s.c<c){u=-1;break}u=a[h].e.r-a[h].s.r+1,f=a[h].e.c-a[h].s.c+1;break}if(!(u<0)){var y=Fr({r:s,c}),w=n.dense?(t[s]||[])[c]:t[y],j=w&&w.v!=null&&(w.h||L9(w.w||(Wa(w),w.w)||""))||"",C={};u>1&&(C.rowspan=u),f>1&&(C.colspan=f),n.editable?j='<span contenteditable="true">'+j+"</span>":w&&(C["data-t"]=w&&w.t||"z",w.v!=null&&(C["data-v"]=w.v),w.z!=null&&(C["data-z"]=w.z),w.l&&(w.l.Target||"#").charAt(0)!="#"&&(j='<a href="'+w.l.Target+'">'+j+"</a>")),C.id=(n.id||"sjs")+"-"+y,l.push(Lt("td",j,C))}}var k="<tr>";return k+l.join("")+"</tr>"}var aq='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',iq="</body></html>";function lq(t,r,s){var n=[];return n.join("")+"<table"+(s&&s.id?' id="'+s.id+'"':"")+">"}function s2(t,r){var s=r||{},n=s.header!=null?s.header:aq,a=s.footer!=null?s.footer:iq,l=[n],c=_n(t["!ref"]);s.dense=Array.isArray(t),l.push(lq(t,c,s));for(var u=c.s.r;u<=c.e.r;++u)l.push(nq(t,c,u,s));return l.push("</table>"+a),l.join("")}function n2(t,r,s){var n=s||{},a=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Es(n.origin):n.origin;a=c.r,l=c.c}var u=r.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:a,c:l}};if(t["!ref"]){var y=_n(t["!ref"]);h.s.r=Math.min(h.s.r,y.s.r),h.s.c=Math.min(h.s.c,y.s.c),h.e.r=Math.max(h.e.r,y.e.r),h.e.c=Math.max(h.e.c,y.e.c),a==-1&&(h.e.r=a=y.e.r+1)}var w=[],j=0,C=t["!rows"]||(t["!rows"]=[]),k=0,S=0,_=0,I=0,F=0,B=0;for(t["!cols"]||(t["!cols"]=[]);k<u.length&&S<f;++k){var q=u[k];if(Gb(q)){if(n.display)continue;C[S]={hidden:!0}}var me=q.children;for(_=I=0;_<me.length;++_){var re=me[_];if(!(n.display&&Gb(re))){var M=re.hasAttribute("data-v")?re.getAttribute("data-v"):re.hasAttribute("v")?re.getAttribute("v"):q9(re.innerHTML),G=re.getAttribute("data-z")||re.getAttribute("z");for(j=0;j<w.length;++j){var le=w[j];le.s.c==I+l&&le.s.r<S+a&&S+a<=le.e.r&&(I=le.e.c+1-l,j=-1)}B=+re.getAttribute("colspan")||1,((F=+re.getAttribute("rowspan")||1)>1||B>1)&&w.push({s:{r:S+a,c:I+l},e:{r:S+a+(F||1)-1,c:I+l+(B||1)-1}});var Z={t:"s",v:M},he=re.getAttribute("data-t")||re.getAttribute("t")||"";M!=null&&(M.length==0?Z.t=he||"z":n.raw||M.trim().length==0||he=="s"||(M==="TRUE"?Z={t:"b",v:!0}:M==="FALSE"?Z={t:"b",v:!1}:isNaN(Ba(M))?isNaN(yc(M).getDate())||(Z={t:"d",v:Js(M)},n.cellDates||(Z={t:"n",v:pn(Z.v)}),Z.z=n.dateNF||as[14]):Z={t:"n",v:Ba(M)})),Z.z===void 0&&G!=null&&(Z.z=G);var ce="",ke=re.getElementsByTagName("A");if(ke&&ke.length)for(var Ee=0;Ee<ke.length&&!(ke[Ee].hasAttribute("href")&&(ce=ke[Ee].getAttribute("href"),ce.charAt(0)!="#"));++Ee);ce&&ce.charAt(0)!="#"&&(Z.l={Target:ce}),n.dense?(t[S+a]||(t[S+a]=[]),t[S+a][I+l]=Z):t[Fr({c:I+l,r:S+a})]=Z,h.e.c<I+l&&(h.e.c=I+l),I+=B}}++S}return w.length&&(t["!merges"]=(t["!merges"]||[]).concat(w)),h.e.r=Math.max(h.e.r,S-1+a),t["!ref"]=fs(h),S>=f&&(t["!fullref"]=fs((h.e.r=u.length-k+S-1+a,h))),t}function a2(t,r){var s=r||{},n=s.dense?[]:{};return n2(n,t,r)}function oq(t,r){return il(a2(t,r),r)}function Gb(t){var r="",s=cq(t);return s&&(r=s(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function cq(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var dq=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+bc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return ys+r}})(),Hb=(function(){var t=function(l){return Lr(l).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,s=`          <table:covered-table-cell/>
`,n=function(l,c,u){var f=[];f.push('      <table:table table:name="'+Lr(c.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,y=0,w=_n(l["!ref"]||"A1"),j=l["!merges"]||[],C=0,k=Array.isArray(l);if(l["!cols"])for(y=0;y<=w.e.c;++y)f.push("        <table:table-column"+(l["!cols"][y]?' table:style-name="co'+l["!cols"][y].ods+'"':"")+`></table:table-column>
`);var S="",_=l["!rows"]||[];for(h=0;h<w.s.r;++h)S=_[h]?' table:style-name="ro'+_[h].ods+'"':"",f.push("        <table:table-row"+S+`></table:table-row>
`);for(;h<=w.e.r;++h){for(S=_[h]?' table:style-name="ro'+_[h].ods+'"':"",f.push("        <table:table-row"+S+`>
`),y=0;y<w.s.c;++y)f.push(r);for(;y<=w.e.c;++y){var I=!1,F={},B="";for(C=0;C!=j.length;++C)if(!(j[C].s.c>y)&&!(j[C].s.r>h)&&!(j[C].e.c<y)&&!(j[C].e.r<h)){(j[C].s.c!=y||j[C].s.r!=h)&&(I=!0),F["table:number-columns-spanned"]=j[C].e.c-j[C].s.c+1,F["table:number-rows-spanned"]=j[C].e.r-j[C].s.r+1;break}if(I){f.push(s);continue}var q=Fr({r:h,c:y}),me=k?(l[h]||[])[y]:l[q];if(me&&me.f&&(F["table:formula"]=Lr(A6(me.f)),me.F&&me.F.slice(0,q.length)==q)){var re=_n(me.F);F["table:number-matrix-columns-spanned"]=re.e.c-re.s.c+1,F["table:number-matrix-rows-spanned"]=re.e.r-re.s.r+1}if(!me){f.push(r);continue}switch(me.t){case"b":B=me.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=me.v?"true":"false";break;case"n":B=me.w||String(me.v||0),F["office:value-type"]="float",F["office:value"]=me.v||0;break;case"s":case"str":B=me.v==null?"":me.v,F["office:value-type"]="string";break;case"d":B=me.w||Js(me.v).toISOString(),F["office:value-type"]="date",F["office:date-value"]=Js(me.v).toISOString(),F["table:style-name"]="ce1";break;default:f.push(r);continue}var M=t(B);if(me.l&&me.l.Target){var G=me.l.Target;G=G.charAt(0)=="#"?"#"+T6(G.slice(1)):G,G.charAt(0)!="#"&&!G.match(/^\w+:/)&&(G="../"+G),M=Lt("text:a",M,{"xlink:href":G.replace(/&/g,"&amp;")})}f.push("          "+Lt("table:table-cell",Lt("text:p",M,{}),F)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(l,c){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var u=0;c.SheetNames.map(function(h){return c.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var y=0;y<h["!cols"].length;++y)if(h["!cols"][y]){var w=h["!cols"][y];if(w.width==null&&w.wpx==null&&w.wch==null)continue;Ih(w),w.ods=u;var j=h["!cols"][y].wpx+"px";l.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+j+`"/>
`),l.push(`  </style:style>
`),++u}}});var f=0;c.SheetNames.map(function(h){return c.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var y=0;y<h["!rows"].length;++y)if(h["!rows"][y]){h["!rows"][y].ods=f;var w=h["!rows"][y].hpx+"px";l.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+w+`"/>
`),l.push(`  </style:style>
`),++f}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(c,u){var f=[ys],h=bc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),y=bc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+h+y+`>
`),f.push(bS().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+h+`>
`),a(f,c),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var w=0;w!=c.SheetNames.length;++w)f.push(n(c.Sheets[c.SheetNames[w]],c,w));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function i2(t,r){if(r.bookType=="fods")return Hb(t,r);var s=_h(),n="",a=[],l=[];return n="mimetype",fr(s,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",fr(s,n,Hb(t,r)),a.push([n,"text/xml"]),l.push([n,"ContentFile"]),n="styles.xml",fr(s,n,dq(t,r)),a.push([n,"text/xml"]),l.push([n,"StylesFile"]),n="meta.xml",fr(s,n,ys+bS()),a.push([n,"text/xml"]),l.push([n,"MetadataFile"]),n="manifest.rdf",fr(s,n,NF(l)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",fr(s,n,bF(a)),s}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function em(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function uq(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Hn(vc(t))}function mq(t,r){e:for(var s=0;s<=t.length-r.length;++s){for(var n=0;n<r.length;++n)if(t[s+n]!=r[n])continue e;return!0}return!1}function Ci(t){var r=t.reduce(function(a,l){return a+l.length},0),s=new Uint8Array(r),n=0;return t.forEach(function(a){s.set(a,n),n+=a.length}),s}function pq(t,r,s){var n=Math.floor(s==0?0:Math.LOG10E*Math.log(Math.abs(s)))+6176-20,a=s/Math.pow(10,n-6176);t[r+15]|=n>>7,t[r+14]|=(n&127)<<1;for(var l=0;a>=1;++l,a/=256)t[r+l]=a&255;t[r+15]|=s>=0?0:128}function wc(t,r){var s=r?r[0]:0,n=t[s]&127;e:if(t[s++]>=128&&(n|=(t[s]&127)<<7,t[s++]<128||(n|=(t[s]&127)<<14,t[s++]<128)||(n|=(t[s]&127)<<21,t[s++]<128)||(n+=(t[s]&127)*Math.pow(2,28),++s,t[s++]<128)||(n+=(t[s]&127)*Math.pow(2,35),++s,t[s++]<128)||(n+=(t[s]&127)*Math.pow(2,42),++s,t[s++]<128)))break e;return r&&(r[0]=s),n}function Or(t){var r=new Uint8Array(7);r[0]=t&127;var s=1;e:if(t>127){if(r[s-1]|=128,r[s]=t>>7&127,++s,t<=16383||(r[s-1]|=128,r[s]=t>>14&127,++s,t<=2097151)||(r[s-1]|=128,r[s]=t>>21&127,++s,t<=268435455)||(r[s-1]|=128,r[s]=t/256>>>21&127,++s,t<=34359738367)||(r[s-1]|=128,r[s]=t/65536>>>21&127,++s,t<=4398046511103))break e;r[s-1]|=128,r[s]=t/16777216>>>21&127,++s}return r.slice(0,s)}function Kl(t){var r=0,s=t[r]&127;e:if(t[r++]>=128){if(s|=(t[r]&127)<<7,t[r++]<128||(s|=(t[r]&127)<<14,t[r++]<128)||(s|=(t[r]&127)<<21,t[r++]<128))break e;s|=(t[r]&127)<<28}return s}function Ns(t){for(var r=[],s=[0];s[0]<t.length;){var n=s[0],a=wc(t,s),l=a&7;a=Math.floor(a/8);var c=0,u;if(a==0)break;switch(l){case 0:{for(var f=s[0];t[s[0]++]>=128;);u=t.slice(f,s[0])}break;case 5:c=4,u=t.slice(s[0],s[0]+c),s[0]+=c;break;case 1:c=8,u=t.slice(s[0],s[0]+c),s[0]+=c;break;case 2:c=wc(t,s),u=t.slice(s[0],s[0]+c),s[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(a," at offset ").concat(n))}var h={data:u,type:l};r[a]==null?r[a]=[h]:r[a].push(h)}return r}function Os(t){var r=[];return t.forEach(function(s,n){s.forEach(function(a){a.data&&(r.push(Or(n*8+a.type)),a.type==2&&r.push(Or(a.data.length)),r.push(a.data))})}),Ci(r)}function Vn(t){for(var r,s=[],n=[0];n[0]<t.length;){var a=wc(t,n),l=Ns(t.slice(n[0],n[0]+a));n[0]+=a;var c={id:Kl(l[1][0].data),messages:[]};l[2].forEach(function(u){var f=Ns(u.data),h=Kl(f[3][0].data);c.messages.push({meta:f,data:t.slice(n[0],n[0]+h)}),n[0]+=h}),(r=l[3])!=null&&r[0]&&(c.merge=Kl(l[3][0].data)>>>0>0),s.push(c)}return s}function zl(t){var r=[];return t.forEach(function(s){var n=[];n[1]=[{data:Or(s.id),type:0}],n[2]=[],s.merge!=null&&(n[3]=[{data:Or(+!!s.merge),type:0}]);var a=[];s.messages.forEach(function(c){a.push(c.data),c.meta[3]=[{type:0,data:Or(c.data.length)}],n[2].push({data:Os(c.meta),type:2})});var l=Os(n);r.push(Or(l.length)),r.push(l),a.forEach(function(c){return r.push(c)})}),Ci(r)}function xq(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var s=[0],n=wc(r,s),a=[];s[0]<r.length;){var l=r[s[0]]&3;if(l==0){var c=r[s[0]++]>>2;if(c<60)++c;else{var u=c-59;c=r[s[0]],u>1&&(c|=r[s[0]+1]<<8),u>2&&(c|=r[s[0]+2]<<16),u>3&&(c|=r[s[0]+3]<<24),c>>>=0,c++,s[0]+=u}a.push(r.slice(s[0],s[0]+c)),s[0]+=c;continue}else{var f=0,h=0;if(l==1?(h=(r[s[0]]>>2&7)+4,f=(r[s[0]++]&224)<<3,f|=r[s[0]++]):(h=(r[s[0]++]>>2)+1,l==2?(f=r[s[0]]|r[s[0]+1]<<8,s[0]+=2):(f=(r[s[0]]|r[s[0]+1]<<8|r[s[0]+2]<<16|r[s[0]+3]<<24)>>>0,s[0]+=4)),a=[Ci(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(a.push(a[0].slice(-f)),h-=f;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-f,-f+h))}}var y=Ci(a);if(y.length!=n)throw new Error("Unexpected length: ".concat(y.length," != ").concat(n));return y}function Wn(t){for(var r=[],s=0;s<t.length;){var n=t[s++],a=t[s]|t[s+1]<<8|t[s+2]<<16;s+=3,r.push(xq(n,t.slice(s,s+a))),s+=a}if(s!==t.length)throw new Error("data is not a valid framed stream!");return Ci(r)}function $l(t){for(var r=[],s=0;s<t.length;){var n=Math.min(t.length-s,268435455),a=new Uint8Array(4);r.push(a);var l=Or(n),c=l.length;r.push(l),n<=60?(c++,r.push(new Uint8Array([n-1<<2]))):n<=256?(c+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(c+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(c+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(c+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(t.slice(s,s+n)),c+=n,a[0]=0,a[1]=c&255,a[2]=c>>8&255,a[3]=c>>16&255,s+=n}return Ci(r)}function X0(t,r){var s=new Uint8Array(32),n=em(s),a=12,l=0;switch(s[0]=5,t.t){case"n":s[1]=2,pq(s,a,t.v),l|=1,a+=16;break;case"b":s[1]=6,n.setFloat64(a,t.v?1:0,!0),l|=2,a+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));s[1]=3,n.setUint32(a,r.indexOf(t.v),!0),l|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,l,!0),s.slice(0,a)}function J0(t,r){var s=new Uint8Array(32),n=em(s),a=12,l=0;switch(s[0]=3,t.t){case"n":s[2]=2,n.setFloat64(a,t.v,!0),l|=32,a+=8;break;case"b":s[2]=6,n.setFloat64(a,t.v?1:0,!0),l|=32,a+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));s[2]=3,n.setUint32(a,r.indexOf(t.v),!0),l|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,l,!0),s.slice(0,a)}function fi(t){var r=Ns(t);return wc(r[1][0].data)}function hq(t,r,s){var n,a,l,c;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((c=(l=t[8])==null?void 0:l[0])==null?void 0:c.data)&&Kl(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,h=em(t[7][0].data),y=0,w=[],j=em(t[4][0].data),C=0,k=[],S=0;S<r.length;++S){if(r[S]==null){h.setUint16(S*2,65535,!0),j.setUint16(S*2,65535);continue}h.setUint16(S*2,y,!0),j.setUint16(S*2,C,!0);var _,I;switch(typeof r[S]){case"string":_=X0({t:"s",v:r[S]},s),I=J0({t:"s",v:r[S]},s);break;case"number":_=X0({t:"n",v:r[S]},s),I=J0({t:"n",v:r[S]},s);break;case"boolean":_=X0({t:"b",v:r[S]},s),I=J0({t:"b",v:r[S]},s);break;default:throw new Error("Unsupported value "+r[S])}w.push(_),y+=_.length,k.push(I),C+=I.length,++f}for(t[2][0].data=Or(f);S<t[7][0].data.length/2;++S)h.setUint16(S*2,65535,!0),j.setUint16(S*2,65535,!0);return t[6][0].data=Ci(w),t[3][0].data=Ci(k),f}function fq(t,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var s=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=_n(s["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(fs(n)));var l=tm(s,{range:n,header:1}),c=["~Sh33tJ5~"];l.forEach(function(ue){return ue.forEach(function(z){typeof z=="string"&&c.push(z)})});var u={},f=[],h=Mr.read(r.numbers,{type:"base64"});h.FileIndex.map(function(ue,z){return[ue,h.FullPaths[z]]}).forEach(function(ue){var z=ue[0],ne=ue[1];if(z.type==2&&z.name.match(/\.iwa/)){var ve=z.content,fe=Wn(ve),Ce=Vn(fe);Ce.forEach(function(Le){f.push(Le.id),u[Le.id]={deps:[],location:ne,type:Kl(Le.messages[0].meta[1][0].data)}})}}),f.sort(function(ue,z){return ue-z});var y=f.filter(function(ue){return ue>1}).map(function(ue){return[ue,Or(ue)]});h.FileIndex.map(function(ue,z){return[ue,h.FullPaths[z]]}).forEach(function(ue){var z=ue[0];if(ue[1],!!z.name.match(/\.iwa/)){var ne=Vn(Wn(z.content));ne.forEach(function(ve){ve.messages.forEach(function(fe){y.forEach(function(Ce){ve.messages.some(function(Le){return Kl(Le.meta[1][0].data)!=11006&&mq(Le.data,Ce[1])})&&u[Ce[0]].deps.push(ve.id)})})})}});for(var w=Mr.find(h,u[1].location),j=Vn(Wn(w.content)),C,k=0;k<j.length;++k){var S=j[k];S.id==1&&(C=S)}var _=fi(Ns(C.messages[0].data)[1][0].data);for(w=Mr.find(h,u[_].location),j=Vn(Wn(w.content)),k=0;k<j.length;++k)S=j[k],S.id==_&&(C=S);for(_=fi(Ns(C.messages[0].data)[2][0].data),w=Mr.find(h,u[_].location),j=Vn(Wn(w.content)),k=0;k<j.length;++k)S=j[k],S.id==_&&(C=S);for(_=fi(Ns(C.messages[0].data)[2][0].data),w=Mr.find(h,u[_].location),j=Vn(Wn(w.content)),k=0;k<j.length;++k)S=j[k],S.id==_&&(C=S);var I=Ns(C.messages[0].data);{I[6][0].data=Or(n.e.r+1),I[7][0].data=Or(n.e.c+1);var F=fi(I[46][0].data),B=Mr.find(h,u[F].location),q=Vn(Wn(B.content));{for(var me=0;me<q.length&&q[me].id!=F;++me);if(q[me].id!=F)throw"Bad ColumnRowUIDMapArchive";var re=Ns(q[me].messages[0].data);re[1]=[],re[2]=[],re[3]=[];for(var M=0;M<=n.e.c;++M){var G=[];G[1]=G[2]=[{type:0,data:Or(M+420690)}],re[1].push({type:2,data:Os(G)}),re[2].push({type:0,data:Or(M)}),re[3].push({type:0,data:Or(M)})}re[4]=[],re[5]=[],re[6]=[];for(var le=0;le<=n.e.r;++le)G=[],G[1]=G[2]=[{type:0,data:Or(le+726270)}],re[4].push({type:2,data:Os(G)}),re[5].push({type:0,data:Or(le)}),re[6].push({type:0,data:Or(le)});q[me].messages[0].data=Os(re)}B.content=$l(zl(q)),B.size=B.content.length,delete I[46];var Z=Ns(I[4][0].data);{Z[7][0].data=Or(n.e.r+1);var he=Ns(Z[1][0].data),ce=fi(he[2][0].data);B=Mr.find(h,u[ce].location),q=Vn(Wn(B.content));{if(q[0].id!=ce)throw"Bad HeaderStorageBucket";var ke=Ns(q[0].messages[0].data);for(le=0;le<l.length;++le){var Ee=Ns(ke[2][0].data);Ee[1][0].data=Or(le),Ee[4][0].data=Or(l[le].length),ke[2][le]={type:ke[2][0].type,data:Os(Ee)}}q[0].messages[0].data=Os(ke)}B.content=$l(zl(q)),B.size=B.content.length;var Fe=fi(Z[2][0].data);B=Mr.find(h,u[Fe].location),q=Vn(Wn(B.content));{if(q[0].id!=Fe)throw"Bad HeaderStorageBucket";for(ke=Ns(q[0].messages[0].data),M=0;M<=n.e.c;++M)Ee=Ns(ke[2][0].data),Ee[1][0].data=Or(M),Ee[4][0].data=Or(n.e.r+1),ke[2][M]={type:ke[2][0].type,data:Os(Ee)};q[0].messages[0].data=Os(ke)}B.content=$l(zl(q)),B.size=B.content.length;var X=fi(Z[4][0].data);(function(){for(var ue=Mr.find(h,u[X].location),z=Vn(Wn(ue.content)),ne,ve=0;ve<z.length;++ve){var fe=z[ve];fe.id==X&&(ne=fe)}var Ce=Ns(ne.messages[0].data);{Ce[3]=[];var Le=[];c.forEach(function(tt,Nt){Le[1]=[{type:0,data:Or(Nt)}],Le[2]=[{type:0,data:Or(1)}],Le[3]=[{type:2,data:uq(tt)}],Ce[3].push({type:2,data:Os(Le)})})}ne.messages[0].data=Os(Ce);var De=zl(z),Ve=$l(De);ue.content=Ve,ue.size=ue.content.length})();var ye=Ns(Z[3][0].data);{var Q=ye[1][0];delete ye[2];var we=Ns(Q.data);{var pe=fi(we[2][0].data);(function(){for(var ue=Mr.find(h,u[pe].location),z=Vn(Wn(ue.content)),ne,ve=0;ve<z.length;++ve){var fe=z[ve];fe.id==pe&&(ne=fe)}var Ce=Ns(ne.messages[0].data);{delete Ce[6],delete ye[7];var Le=new Uint8Array(Ce[5][0].data);Ce[5]=[];for(var De=0,Ve=0;Ve<=n.e.r;++Ve){var tt=Ns(Le);De+=hq(tt,l[Ve],c),tt[1][0].data=Or(Ve),Ce[5].push({data:Os(tt),type:2})}Ce[1]=[{type:0,data:Or(n.e.c+1)}],Ce[2]=[{type:0,data:Or(n.e.r+1)}],Ce[3]=[{type:0,data:Or(De)}],Ce[4]=[{type:0,data:Or(n.e.r+1)}]}ne.messages[0].data=Os(Ce);var Nt=zl(z),lt=$l(Nt);ue.content=lt,ue.size=ue.content.length})()}Q.data=Os(we)}Z[3][0].data=Os(ye)}I[4][0].data=Os(Z)}C.messages[0].data=Os(I);var se=zl(j),U=$l(se);return w.content=U,w.size=w.content.length,h}function gq(t){return function(s){for(var n=0;n!=t.length;++n){var a=t[n];s[a[0]]===void 0&&(s[a[0]]=a[1]),a[2]==="n"&&(s[a[0]]=Number(s[a[0]]))}}}function Qh(t){gq([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function yq(t,r){return r.bookType=="ods"?i2(t,r):r.bookType=="numbers"?fq(t,r):r.bookType=="xlsb"?vq(t,r):bq(t,r)}function vq(t,r){Ul=1024,t&&!t.SSF&&(t.SSF=xn(as)),t&&t.SSF&&(Am(),Pm(t.SSF),r.revssf=Tm(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,uc?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var s=r.bookType=="xlsb"?"bin":"xml",n=$S.indexOf(r.bookType)>-1,a=gS();Qh(r=r||{});var l=_h(),c="",u=0;if(r.cellXfs=[],Ai(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),c="docProps/core.xml",fr(l,c,wS(t.Props,r)),a.coreprops.push(c),Dr(r.rels,2,c,Cr.CORE_PROPS),c="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(t.SheetNames[h]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,fr(l,c,jS(t.Props)),a.extprops.push(c),Dr(r.rels,3,c,Cr.EXT_PROPS),t.Custprops!==t.Props&&Ms(t.Custprops||{}).length>0&&(c="docProps/custom.xml",fr(l,c,SS(t.Custprops)),a.custprops.push(c),Dr(r.rels,4,c,Cr.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var y={"!id":{}},w=t.Sheets[t.SheetNames[u-1]],j=(w||{})["!type"]||"sheet";switch(j){case"chart":default:c="xl/worksheets/sheet"+u+"."+s,fr(l,c,N7(u-1,c,r,t,y)),a.sheets.push(c),Dr(r.wbrels,-1,"worksheets/sheet"+u+"."+s,Cr.WS[0])}if(w){var C=w["!comments"],k=!1,S="";C&&C.length>0&&(S="xl/comments"+u+"."+s,fr(l,S,k7(C,S)),a.comments.push(S),Dr(y,-1,"../comments"+u+"."+s,Cr.CMNT),k=!0),w["!legacy"]&&k&&fr(l,"xl/drawings/vmlDrawing"+u+".vml",BS(u,w["!comments"])),delete w["!comments"],delete w["!legacy"]}y["!id"].rId1&&fr(l,vS(c),Hl(y))}return r.Strings!=null&&r.Strings.length>0&&(c="xl/sharedStrings."+s,fr(l,c,S7(r.Strings,c,r)),a.strs.push(c),Dr(r.wbrels,-1,"sharedStrings."+s,Cr.SST)),c="xl/workbook."+s,fr(l,c,w7(t,c)),a.workbooks.push(c),Dr(r.rels,1,c,Cr.WB),c="xl/theme/theme1.xml",fr(l,c,IS(t.Themes,r)),a.themes.push(c),Dr(r.wbrels,-1,"theme/theme1.xml",Cr.THEME),c="xl/styles."+s,fr(l,c,j7(t,c,r)),a.styles.push(c),Dr(r.wbrels,-1,"styles."+s,Cr.STY),t.vbaraw&&n&&(c="xl/vbaProject.bin",fr(l,c,t.vbaraw),a.vba.push(c),Dr(r.wbrels,-1,"vbaProject.bin",Cr.VBA)),c="xl/metadata."+s,fr(l,c,C7(c)),a.metadata.push(c),Dr(r.wbrels,-1,"metadata."+s,Cr.XLMETA),fr(l,"[Content_Types].xml",yS(a,r)),fr(l,"_rels/.rels",Hl(r.rels)),fr(l,"xl/_rels/workbook."+s+".rels",Hl(r.wbrels)),delete r.revssf,delete r.ssf,l}function bq(t,r){Ul=1024,t&&!t.SSF&&(t.SSF=xn(as)),t&&t.SSF&&(Am(),Pm(t.SSF),r.revssf=Tm(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,uc?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var s="xml",n=$S.indexOf(r.bookType)>-1,a=gS();Qh(r=r||{});var l=_h(),c="",u=0;if(r.cellXfs=[],Ai(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),c="docProps/core.xml",fr(l,c,wS(t.Props,r)),a.coreprops.push(c),Dr(r.rels,2,c,Cr.CORE_PROPS),c="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(t.SheetNames[h]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,fr(l,c,jS(t.Props)),a.extprops.push(c),Dr(r.rels,3,c,Cr.EXT_PROPS),t.Custprops!==t.Props&&Ms(t.Custprops||{}).length>0&&(c="docProps/custom.xml",fr(l,c,SS(t.Custprops)),a.custprops.push(c),Dr(r.rels,4,c,Cr.CUST_PROPS));var y=["SheetJ5"];for(r.tcid=0,u=1;u<=t.SheetNames.length;++u){var w={"!id":{}},j=t.Sheets[t.SheetNames[u-1]],C=(j||{})["!type"]||"sheet";switch(C){case"chart":default:c="xl/worksheets/sheet"+u+"."+s,fr(l,c,XS(u-1,r,t,w)),a.sheets.push(c),Dr(r.wbrels,-1,"worksheets/sheet"+u+"."+s,Cr.WS[0])}if(j){var k=j["!comments"],S=!1,_="";if(k&&k.length>0){var I=!1;k.forEach(function(F){F[1].forEach(function(B){B.T==!0&&(I=!0)})}),I&&(_="xl/threadedComments/threadedComment"+u+"."+s,fr(l,_,XM(k,y,r)),a.threadedcomments.push(_),Dr(w,-1,"../threadedComments/threadedComment"+u+"."+s,Cr.TCMNT)),_="xl/comments"+u+"."+s,fr(l,_,zS(k)),a.comments.push(_),Dr(w,-1,"../comments"+u+"."+s,Cr.CMNT),S=!0}j["!legacy"]&&S&&fr(l,"xl/drawings/vmlDrawing"+u+".vml",BS(u,j["!comments"])),delete j["!comments"],delete j["!legacy"]}w["!id"].rId1&&fr(l,vS(c),Hl(w))}return r.Strings!=null&&r.Strings.length>0&&(c="xl/sharedStrings."+s,fr(l,c,OS(r.Strings,r)),a.strs.push(c),Dr(r.wbrels,-1,"sharedStrings."+s,Cr.SST)),c="xl/workbook."+s,fr(l,c,e2(t)),a.workbooks.push(c),Dr(r.rels,1,c,Cr.WB),c="xl/theme/theme1.xml",fr(l,c,IS(t.Themes,r)),a.themes.push(c),Dr(r.wbrels,-1,"theme/theme1.xml",Cr.THEME),c="xl/styles."+s,fr(l,c,FS(t,r)),a.styles.push(c),Dr(r.wbrels,-1,"styles."+s,Cr.STY),t.vbaraw&&n&&(c="xl/vbaProject.bin",fr(l,c,t.vbaraw),a.vba.push(c),Dr(r.wbrels,-1,"vbaProject.bin",Cr.VBA)),c="xl/metadata."+s,fr(l,c,qS()),a.metadata.push(c),Dr(r.wbrels,-1,"metadata."+s,Cr.XLMETA),y.length>1&&(c="xl/persons/person.xml",fr(l,c,JM(y)),a.people.push(c),Dr(r.wbrels,-1,"persons/person.xml",Cr.PEOPLE)),fr(l,"[Content_Types].xml",yS(a,r)),fr(l,"_rels/.rels",Hl(r.rels)),fr(l,"xl/_rels/workbook."+s+".rels",Hl(r.wbrels)),delete r.revssf,delete r.ssf,l}function wq(t,r){var s="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":s=Va(t.slice(0,12));break;case"binary":s=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[s.charCodeAt(0),s.charCodeAt(1),s.charCodeAt(2),s.charCodeAt(3),s.charCodeAt(4),s.charCodeAt(5),s.charCodeAt(6),s.charCodeAt(7)]}function l2(t,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Qc(r.file,Mr.write(t,{type:Er?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Mr.write(t,r)}function Nq(t,r){var s=xn(r||{}),n=yq(t,s);return jq(n,s)}function jq(t,r){var s={},n=Er?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(s.compression="DEFLATE"),r.password)s.type=n;else switch(r.type){case"base64":s.type="base64";break;case"binary":s.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":s.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var a=t.FullPaths?Mr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[s.type]||s.type,compression:!!r.compression}):t.generate(s);if(typeof Deno<"u"&&typeof a=="string"){if(r.type=="binary"||r.type=="base64")return a;a=new Uint8Array(Em(a))}return r.password&&typeof encrypt_agile<"u"?l2(encrypt_agile(a,r.password),r):r.type==="file"?Qc(r.file,a):r.type=="string"?lc(a):a}function Sq(t,r){var s=r||{},n=B7(t,s);return l2(n,s)}function pa(t,r,s){s||(s="");var n=s+t;switch(r.type){case"base64":return gc(vc(n));case"binary":return vc(n);case"string":return t;case"file":return Qc(r.file,n,"utf8");case"buffer":return Er?Ha(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):pa(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function kq(t,r){switch(r.type){case"base64":return gc(t);case"binary":return t;case"string":return t;case"file":return Qc(r.file,t,"binary");case"buffer":return Er?Ha(t,"binary"):t.split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function fu(t,r){switch(r.type){case"string":case"base64":case"binary":for(var s="",n=0;n<t.length;++n)s+=String.fromCharCode(t[n]);return r.type=="base64"?gc(s):r.type=="string"?lc(s):s;case"file":return Qc(r.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+r.type)}}function Jr(t,r){ZL(),d7(t);var s=xn(r||{});if(s.cellStyles&&(s.cellNF=!0,s.sheetStubs=!0),s.type=="array"){s.type="binary";var n=Jr(t,s);return s.type="array",Em(n)}var a=0;if(s.sheet&&(typeof s.sheet=="number"?a=s.sheet:a=t.SheetNames.indexOf(s.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+s.sheet+" : "+typeof s.sheet);switch(s.bookType||"xlsb"){case"xml":case"xlml":return pa(I7(t,s),s);case"slk":case"sylk":return pa(lM.from_sheet(t.Sheets[t.SheetNames[a]],s),s);case"htm":case"html":return pa(s2(t.Sheets[t.SheetNames[a]],s),s);case"txt":return kq(o2(t.Sheets[t.SheetNames[a]],s),s);case"csv":return pa(Uh(t.Sheets[t.SheetNames[a]],s),s,"\uFEFF");case"dif":return pa(oM.from_sheet(t.Sheets[t.SheetNames[a]],s),s);case"dbf":return fu(iM.from_sheet(t.Sheets[t.SheetNames[a]],s),s);case"prn":return pa(cM.from_sheet(t.Sheets[t.SheetNames[a]],s),s);case"rtf":return pa(fM.from_sheet(t.Sheets[t.SheetNames[a]],s),s);case"eth":return pa(TS.from_sheet(t.Sheets[t.SheetNames[a]],s),s);case"fods":return pa(i2(t,s),s);case"wk1":return fu(zb.sheet_to_wk1(t.Sheets[t.SheetNames[a]],s),s);case"wk3":return fu(zb.book_to_wk3(t,s),s);case"biff2":s.biff||(s.biff=2);case"biff3":s.biff||(s.biff=3);case"biff4":return s.biff||(s.biff=4),fu(r2(t,s),s);case"biff5":s.biff||(s.biff=5);case"biff8":case"xla":case"xls":return s.biff||(s.biff=8),Sq(t,s);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Nq(t,s);default:throw new Error("Unrecognized bookType |"+s.bookType+"|")}}function Cq(t){if(!t.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},s=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();s.match(/^\.[a-z]+$/)&&(t.bookType=s.slice(1)),t.bookType=r[t.bookType]||t.bookType}}function Yb(t,r,s){var n={};return n.type="file",n.file=r,Cq(n),Jr(t,n)}function _q(t,r,s,n,a,l,c,u){var f=Fs(s),h=u.defval,y=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),w=!0,j=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(j,"__rowNum__",{value:s,enumerable:!1})}catch{j.__rowNum__=s}else j.__rowNum__=s;if(!c||t[s])for(var C=r.s.c;C<=r.e.c;++C){var k=c?t[s][C]:t[n[C]+f];if(k===void 0||k.t===void 0){if(h===void 0)continue;l[C]!=null&&(j[l[C]]=h);continue}var S=k.v;switch(k.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+k.t)}if(l[C]!=null){if(S==null)if(k.t=="e"&&S===null)j[l[C]]=null;else if(h!==void 0)j[l[C]]=h;else if(y&&S===null)j[l[C]]=null;else continue;else j[l[C]]=y&&(k.t!=="n"||k.t==="n"&&u.rawNumbers!==!1)?S:Wa(k,S,u);S!=null&&(w=!1)}}return{row:j,isempty:w}}function tm(t,r){if(t==null||t["!ref"]==null)return[];var s={t:"n",v:0},n=0,a=1,l=[],c=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},h=r||{},y=h.range!=null?h.range:t["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof y){case"string":f=Vr(y);break;case"number":f=Vr(t["!ref"]),f.s.r=y;break;default:f=y}n>0&&(a=0);var w=Fs(f.s.r),j=[],C=[],k=0,S=0,_=Array.isArray(t),I=f.s.r,F=0,B={};_&&!t[I]&&(t[I]=[]);var q=h.skipHidden&&t["!cols"]||[],me=h.skipHidden&&t["!rows"]||[];for(F=f.s.c;F<=f.e.c;++F)if(!(q[F]||{}).hidden)switch(j[F]=Us(F),s=_?t[I][F]:t[j[F]+w],n){case 1:l[F]=F-f.s.c;break;case 2:l[F]=j[F];break;case 3:l[F]=h.header[F-f.s.c];break;default:if(s==null&&(s={w:"__EMPTY",t:"s"}),u=c=Wa(s,null,h),S=B[c]||0,!S)B[c]=1;else{do u=c+"_"+S++;while(B[u]);B[c]=S,B[u]=1}l[F]=u}for(I=f.s.r+a;I<=f.e.r;++I)if(!(me[I]||{}).hidden){var re=_q(t,f,I,j,n,l,_,h);(re.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(C[k++]=re.row)}return C.length=k,C}var Kb=/"/g;function Eq(t,r,s,n,a,l,c,u){for(var f=!0,h=[],y="",w=Fs(s),j=r.s.c;j<=r.e.c;++j)if(n[j]){var C=u.dense?(t[s]||[])[j]:t[n[j]+w];if(C==null)y="";else if(C.v!=null){f=!1,y=""+(u.rawNumbers&&C.t=="n"?C.v:Wa(C,null,u));for(var k=0,S=0;k!==y.length;++k)if((S=y.charCodeAt(k))===a||S===l||S===34||u.forceQuotes){y='"'+y.replace(Kb,'""')+'"';break}y=="ID"&&(y='"ID"')}else C.f!=null&&!C.F?(f=!1,y="="+C.f,y.indexOf(",")>=0&&(y='"'+y.replace(Kb,'""')+'"')):y="";h.push(y)}return u.blankrows===!1&&f?null:h.join(c)}function Uh(t,r){var s=[],n=r??{};if(t==null||t["!ref"]==null)return"";var a=Vr(t["!ref"]),l=n.FS!==void 0?n.FS:",",c=l.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),h=new RegExp((l=="|"?"\\|":l)+"+$"),y="",w=[];n.dense=Array.isArray(t);for(var j=n.skipHidden&&t["!cols"]||[],C=n.skipHidden&&t["!rows"]||[],k=a.s.c;k<=a.e.c;++k)(j[k]||{}).hidden||(w[k]=Us(k));for(var S=0,_=a.s.r;_<=a.e.r;++_)(C[_]||{}).hidden||(y=Eq(t,a,_,w,c,f,l,n),y!=null&&(n.strip&&(y=y.replace(h,"")),(y||n.blankrows!==!1)&&s.push((S++?u:"")+y)));return delete n.dense,s.join("")}function o2(t,r){r||(r={}),r.FS="	",r.RS=`
`;var s=Uh(t,r);return s}function Pq(t){var r="",s,n="";if(t==null||t["!ref"]==null)return[];var a=Vr(t["!ref"]),l="",c=[],u,f=[],h=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)c[u]=Us(u);for(var y=a.s.r;y<=a.e.r;++y)for(l=Fs(y),u=a.s.c;u<=a.e.c;++u)if(r=c[u]+l,s=h?(t[y]||[])[u]:t[r],n="",s!==void 0){if(s.F!=null){if(r=s.F,!s.f)continue;n=s.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(s.f!=null)n=s.f;else{if(s.t=="z")continue;if(s.t=="n"&&s.v!=null)n=""+s.v;else if(s.t=="b")n=s.v?"TRUE":"FALSE";else if(s.w!==void 0)n="'"+s.w;else{if(s.v===void 0)continue;s.t=="s"?n="'"+s.v:n=""+s.v}}f[f.length]=r+"="+n}return f}function c2(t,r,s){var n=s||{},a=+!n.skipHeader,l=t||{},c=0,u=0;if(l&&n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var f=typeof n.origin=="string"?Es(n.origin):n.origin;c=f.r,u=f.c}var h,y={s:{c:0,r:0},e:{c:u,r:c+r.length-1+a}};if(l["!ref"]){var w=Vr(l["!ref"]);y.e.c=Math.max(y.e.c,w.e.c),y.e.r=Math.max(y.e.r,w.e.r),c==-1&&(c=w.e.r+1,y.e.r=c+r.length-1+a)}else c==-1&&(c=0,y.e.r=r.length-1+a);var j=n.header||[],C=0;r.forEach(function(S,_){Ms(S).forEach(function(I){(C=j.indexOf(I))==-1&&(j[C=j.length]=I);var F=S[I],B="z",q="",me=Fr({c:u+C,r:c+_+a});h=Nc(l,me),F&&typeof F=="object"&&!(F instanceof Date)?l[me]=F:(typeof F=="number"?B="n":typeof F=="boolean"?B="b":typeof F=="string"?B="s":F instanceof Date?(B="d",n.cellDates||(B="n",F=pn(F)),q=n.dateNF||as[14]):F===null&&n.nullError&&(B="e",F=0),h?(h.t=B,h.v=F,delete h.w,delete h.R,q&&(h.z=q)):l[me]=h={t:B,v:F},q&&(h.z=q))})}),y.e.c=Math.max(y.e.c,u+j.length-1);var k=Fs(c);if(a)for(C=0;C<j.length;++C)l[Us(C+u)+k]={t:"s",v:j[C]};return l["!ref"]=fs(y),l}function Aq(t,r){return c2(null,t,r)}function Nc(t,r,s){if(typeof r=="string"){if(Array.isArray(t)){var n=Es(r);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?Nc(t,Fr(r)):Nc(t,Fr({r,c:s||0}))}function Tq(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var s=t.SheetNames.indexOf(r);if(s>-1)return s;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Oq(){return{SheetNames:[],Sheets:{}}}function Rq(t,r,s,n){var a=1;if(!s)for(;a<=65535&&t.SheetNames.indexOf(s="Sheet"+a)!=-1;++a,s=void 0);if(!s||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(s)>=0){var l=s.match(/(^.*?)(\d+)$/);a=l&&+l[2]||0;var c=l&&l[1]||s;for(++a;a<=65535&&t.SheetNames.indexOf(s=c+a)!=-1;++a);}if(ZS(s),t.SheetNames.indexOf(s)>=0)throw new Error("Worksheet with name |"+s+"| already exists!");return t.SheetNames.push(s),t.Sheets[s]=r,s}function Dq(t,r,s){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Tq(t,r);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),s){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+s)}t.Workbook.Sheets[n].Hidden=s}function Lq(t,r){return t.z=r,t}function d2(t,r,s){return r?(t.l={Target:r},s&&(t.l.Tooltip=s)):delete t.l,t}function Fq(t,r,s){return d2(t,"#"+r,s)}function Mq(t,r,s){t.c||(t.c=[]),t.c.push({t:r,a:s||"SheetJS"})}function Iq(t,r,s,n){for(var a=typeof r!="string"?r:Vr(r),l=typeof r=="string"?r:fs(r),c=a.s.r;c<=a.e.r;++c)for(var u=a.s.c;u<=a.e.c;++u){var f=Nc(t,c,u);f.t="n",f.F=l,delete f.v,c==a.s.r&&u==a.s.c&&(f.f=s,n&&(f.D=!0))}return t}var Gt={encode_col:Us,encode_row:Fs,encode_cell:Fr,encode_range:fs,decode_col:Rh,decode_row:Oh,split_cell:Z9,decode_cell:Es,decode_range:_n,format_cell:Wa,sheet_add_aoa:uS,sheet_add_json:c2,sheet_add_dom:n2,aoa_to_sheet:ho,json_to_sheet:Aq,table_to_sheet:a2,table_to_book:oq,sheet_to_csv:Uh,sheet_to_txt:o2,sheet_to_json:tm,sheet_to_html:s2,sheet_to_formulae:Pq,sheet_to_row_object_array:tm,sheet_get_cell:Nc,book_new:Oq,book_append_sheet:Rq,book_set_sheet_visibility:Dq,cell_set_number_format:Lq,cell_set_hyperlink:d2,cell_set_internal_link:Fq,cell_add_comment:Mq,sheet_set_array_formula:Iq,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},_u={exports:{}},qq=_u.exports,Xb;function Bq(){return Xb||(Xb=1,(function(t,r){(function(s,n){n()})(qq,function(){function s(h,y){return typeof y>"u"?y={autoBom:!1}:typeof y!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),y={autoBom:!y}),y.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function n(h,y,w){var j=new XMLHttpRequest;j.open("GET",h),j.responseType="blob",j.onload=function(){f(j.response,y,w)},j.onerror=function(){console.error("could not download file")},j.send()}function a(h){var y=new XMLHttpRequest;y.open("HEAD",h,!1);try{y.send()}catch{}return 200<=y.status&&299>=y.status}function l(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var y=document.createEvent("MouseEvents");y.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(y)}}var c=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Xd=="object"&&Xd.global===Xd?Xd:void 0,u=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),f=c.saveAs||(typeof window!="object"||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(h,y,w){var j=c.URL||c.webkitURL,C=document.createElement("a");y=y||h.name||"download",C.download=y,C.rel="noopener",typeof h=="string"?(C.href=h,C.origin===location.origin?l(C):a(C.href)?n(h,y,w):l(C,C.target="_blank")):(C.href=j.createObjectURL(h),setTimeout(function(){j.revokeObjectURL(C.href)},4e4),setTimeout(function(){l(C)},0))}:"msSaveOrOpenBlob"in navigator?function(h,y,w){if(y=y||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(s(h,w),y);else if(a(h))n(h,y,w);else{var j=document.createElement("a");j.href=h,j.target="_blank",setTimeout(function(){l(j)})}}:function(h,y,w,j){if(j=j||open("","_blank"),j&&(j.document.title=j.document.body.innerText="downloading..."),typeof h=="string")return n(h,y,w);var C=h.type==="application/octet-stream",k=/constructor/i.test(c.HTMLElement)||c.safari,S=/CriOS\/[\d]+/.test(navigator.userAgent);if((S||C&&k||u)&&typeof FileReader<"u"){var _=new FileReader;_.onloadend=function(){var B=_.result;B=S?B:B.replace(/^data:[^;]*;/,"data:attachment/file;"),j?j.location.href=B:location=B,j=null},_.readAsDataURL(h)}else{var I=c.URL||c.webkitURL,F=I.createObjectURL(h);j?j.location=F:location.href=F,j=null,setTimeout(function(){I.revokeObjectURL(F)},4e4)}});c.saveAs=f.saveAs=f,t.exports=f})})(_u)),_u.exports}var ms=Bq();const Vh={planning:["material-issue"],"material-issue":["semi-qc"],"semi-qc":["phosphating"],phosphating:["assembly-a","assembly-b","assembly-c","assembly-d"],"assembly-a":["testing1"],"assembly-b":["testing1"],"assembly-c":["testing1"],"assembly-d":["testing2"],testing1:["marking1"],testing2:["marking2"],marking1:["pdi1"],marking2:["pdi2"],pdi1:["tpi","dispatch"],pdi2:["tpi","dispatch"],svs:["marking1"],dispatch:[],tpi:["dispatch"]},Jb={planning:"Planning","material-issue":"Material Issue","semi-qc":"Semi QC",phosphating:"Phosphating QC","assembly-a":"Assembly A","assembly-b":"Assembly B","assembly-c":"Assembly C","assembly-d":"Assembly D",testing1:"Testing1",testing2:"Testing2",svs:"SVS",marking1:"Marking1",marking2:"Marking2",pdi1:"PDI1",pdi2:"PDI2",tpi:"TPI",dispatch:"Dispatch"},wr=t=>{if(!t)return[];const r=t.trim().toLowerCase().replace(/\s+/g,"-");return Vh[r]||[]},nt=t=>{if(!t)return"";const r=t.trim().toLowerCase();return Jb[r]?Jb[r]:r.replace(/-/g," ").replace(/\b\w/g,s=>s.toUpperCase())},Zb=()=>Object.keys(Vh),hn=t=>{const r=t.trim().toLowerCase().replace(/\s+/g,"-");return(Vh[r]?.length??0)===0};function zq(t,r=[]){let s=[];function n(l,c){const u=d.createContext(c);u.displayName=l+"Context";const f=s.length;s=[...s,c];const h=w=>{const{scope:j,children:C,...k}=w,S=j?.[t]?.[f]||u,_=d.useMemo(()=>k,Object.values(k));return e.jsx(S.Provider,{value:_,children:C})};h.displayName=l+"Provider";function y(w,j){const C=j?.[t]?.[f]||u,k=d.useContext(C);if(k)return k;if(c!==void 0)return c;throw new Error(`\`${w}\` must be used within \`${l}\``)}return[h,y]}const a=()=>{const l=s.map(c=>d.createContext(c));return function(u){const f=u?.[t]||l;return d.useMemo(()=>({[`__scope${t}`]:{...u,[t]:f}}),[u,f])}};return a.scopeName=t,[n,$q(a,...r)]}function $q(...t){const r=t[0];if(t.length===1)return r;const s=()=>{const n=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const c=n.reduce((u,{useScope:f,scopeName:h})=>{const w=f(l)[`__scope${h}`];return{...u,...w}},{});return d.useMemo(()=>({[`__scope${r.scopeName}`]:c}),[c])}};return s.scopeName=r.scopeName,s}var Qq=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Wh=Qq.reduce((t,r)=>{const s=qx(`Primitive.${r}`),n=d.forwardRef((a,l)=>{const{asChild:c,...u}=a,f=c?s:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(f,{...u,ref:l})});return n.displayName=`Primitive.${r}`,{...t,[r]:n}},{}),Z0={exports:{}},ex={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e1;function Uq(){if(e1)return ex;e1=1;var t=nm();function r(w,j){return w===j&&(w!==0||1/w===1/j)||w!==w&&j!==j}var s=typeof Object.is=="function"?Object.is:r,n=t.useState,a=t.useEffect,l=t.useLayoutEffect,c=t.useDebugValue;function u(w,j){var C=j(),k=n({inst:{value:C,getSnapshot:j}}),S=k[0].inst,_=k[1];return l(function(){S.value=C,S.getSnapshot=j,f(S)&&_({inst:S})},[w,C,j]),a(function(){return f(S)&&_({inst:S}),w(function(){f(S)&&_({inst:S})})},[w]),c(C),C}function f(w){var j=w.getSnapshot;w=w.value;try{var C=j();return!s(w,C)}catch{return!0}}function h(w,j){return j()}var y=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:u;return ex.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:y,ex}var t1;function Vq(){return t1||(t1=1,Z0.exports=Uq()),Z0.exports}var Wq=Vq();function Gq(){return Wq.useSyncExternalStore(Hq,()=>!0,()=>!1)}function Hq(){return()=>{}}var Gh="Avatar",[Yq]=zq(Gh),[Kq,u2]=Yq(Gh),m2=d.forwardRef((t,r)=>{const{__scopeAvatar:s,...n}=t,[a,l]=d.useState("idle");return e.jsx(Kq,{scope:s,imageLoadingStatus:a,onImageLoadingStatusChange:l,children:e.jsx(Wh.span,{...n,ref:r})})});m2.displayName=Gh;var p2="AvatarImage",x2=d.forwardRef((t,r)=>{const{__scopeAvatar:s,src:n,onLoadingStatusChange:a=()=>{},...l}=t,c=u2(p2,s),u=Xq(n,l),f=Jn(h=>{a(h),c.onImageLoadingStatusChange(h)});return js(()=>{u!=="idle"&&f(u)},[u,f]),u==="loaded"?e.jsx(Wh.img,{...l,ref:r,src:n}):null});x2.displayName=p2;var h2="AvatarFallback",f2=d.forwardRef((t,r)=>{const{__scopeAvatar:s,delayMs:n,...a}=t,l=u2(h2,s),[c,u]=d.useState(n===void 0);return d.useEffect(()=>{if(n!==void 0){const f=window.setTimeout(()=>u(!0),n);return()=>window.clearTimeout(f)}},[n]),c&&l.imageLoadingStatus!=="loaded"?e.jsx(Wh.span,{...a,ref:r}):null});f2.displayName=h2;function r1(t,r){return t?r?(t.src!==r&&(t.src=r),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Xq(t,{referrerPolicy:r,crossOrigin:s}){const n=Gq(),a=d.useRef(null),l=n?(a.current||(a.current=new window.Image),a.current):null,[c,u]=d.useState(()=>r1(l,t));return js(()=>{u(r1(l,t))},[l,t]),js(()=>{const f=w=>()=>{u(w)};if(!l)return;const h=f("loaded"),y=f("error");return l.addEventListener("load",h),l.addEventListener("error",y),r&&(l.referrerPolicy=r),typeof s=="string"&&(l.crossOrigin=s),()=>{l.removeEventListener("load",h),l.removeEventListener("error",y)}},[l,s,r]),c}var g2=m2,y2=x2,v2=f2;const b2=d.forwardRef(({className:t,...r},s)=>e.jsx(g2,{ref:s,"data-slot":"avatar",className:Nr("relative flex size-10 shrink-0 overflow-hidden rounded-full",t),...r}));b2.displayName=g2.displayName;const w2=d.forwardRef(({className:t,...r},s)=>e.jsx(y2,{ref:s,"data-slot":"avatar-image",className:Nr("aspect-square size-full",t),...r}));w2.displayName=y2.displayName;const N2=d.forwardRef(({className:t,...r},s)=>e.jsx(v2,{ref:s,"data-slot":"avatar-fallback",className:Nr("bg-muted flex size-full items-center justify-center rounded-full",t),...r}));N2.displayName=v2.displayName;var tx="rovingFocusGroup.onEntryFocus",Jq={bubbles:!1,cancelable:!0},Hc="RovingFocusGroup",[Px,j2,Zq]=Xx(Hc),[eB,S2]=Ga(Hc,[Zq]),[tB,rB]=eB(Hc),k2=d.forwardRef((t,r)=>e.jsx(Px.Provider,{scope:t.__scopeRovingFocusGroup,children:e.jsx(Px.Slot,{scope:t.__scopeRovingFocusGroup,children:e.jsx(sB,{...t,ref:r})})}));k2.displayName=Hc;var sB=d.forwardRef((t,r)=>{const{__scopeRovingFocusGroup:s,orientation:n,loop:a=!1,dir:l,currentTabStopId:c,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:f,onEntryFocus:h,preventScrollOnEntryFocus:y=!1,...w}=t,j=d.useRef(null),C=Ar(r,j),k=Jx(l),[S,_]=Ki({prop:c,defaultProp:u??null,onChange:f,caller:Hc}),[I,F]=d.useState(!1),B=Jn(h),q=j2(s),me=d.useRef(!1),[re,M]=d.useState(0);return d.useEffect(()=>{const G=j.current;if(G)return G.addEventListener(tx,B),()=>G.removeEventListener(tx,B)},[B]),e.jsx(tB,{scope:s,orientation:n,dir:k,loop:a,currentTabStopId:S,onItemFocus:d.useCallback(G=>_(G),[_]),onItemShiftTab:d.useCallback(()=>F(!0),[]),onFocusableItemAdd:d.useCallback(()=>M(G=>G+1),[]),onFocusableItemRemove:d.useCallback(()=>M(G=>G-1),[]),children:e.jsx(vr.div,{tabIndex:I||re===0?-1:0,"data-orientation":n,...w,ref:C,style:{outline:"none",...t.style},onMouseDown:Zt(t.onMouseDown,()=>{me.current=!0}),onFocus:Zt(t.onFocus,G=>{const le=!me.current;if(G.target===G.currentTarget&&le&&!I){const Z=new CustomEvent(tx,Jq);if(G.currentTarget.dispatchEvent(Z),!Z.defaultPrevented){const he=q().filter(X=>X.focusable),ce=he.find(X=>X.active),ke=he.find(X=>X.id===S),Fe=[ce,ke,...he].filter(Boolean).map(X=>X.ref.current);E2(Fe,y)}}me.current=!1}),onBlur:Zt(t.onBlur,()=>F(!1))})})}),C2="RovingFocusGroupItem",_2=d.forwardRef((t,r)=>{const{__scopeRovingFocusGroup:s,focusable:n=!0,active:a=!1,tabStopId:l,children:c,...u}=t,f=ga(),h=l||f,y=rB(C2,s),w=y.currentTabStopId===h,j=j2(s),{onFocusableItemAdd:C,onFocusableItemRemove:k,currentTabStopId:S}=y;return d.useEffect(()=>{if(n)return C(),()=>k()},[n,C,k]),e.jsx(Px.ItemSlot,{scope:s,id:h,focusable:n,active:a,children:e.jsx(vr.span,{tabIndex:w?0:-1,"data-orientation":y.orientation,...u,ref:r,onMouseDown:Zt(t.onMouseDown,_=>{n?y.onItemFocus(h):_.preventDefault()}),onFocus:Zt(t.onFocus,()=>y.onItemFocus(h)),onKeyDown:Zt(t.onKeyDown,_=>{if(_.key==="Tab"&&_.shiftKey){y.onItemShiftTab();return}if(_.target!==_.currentTarget)return;const I=iB(_,y.orientation,y.dir);if(I!==void 0){if(_.metaKey||_.ctrlKey||_.altKey||_.shiftKey)return;_.preventDefault();let B=j().filter(q=>q.focusable).map(q=>q.ref.current);if(I==="last")B.reverse();else if(I==="prev"||I==="next"){I==="prev"&&B.reverse();const q=B.indexOf(_.currentTarget);B=y.loop?lB(B,q+1):B.slice(q+1)}setTimeout(()=>E2(B))}}),children:typeof c=="function"?c({isCurrentTabStop:w,hasTabStop:S!=null}):c})})});_2.displayName=C2;var nB={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function aB(t,r){return r!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function iB(t,r,s){const n=aB(t.key,s);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return nB[n]}function E2(t,r=!1){const s=document.activeElement;for(const n of t)if(n===s||(n.focus({preventScroll:r}),document.activeElement!==s))return}function lB(t,r){return t.map((s,n)=>t[(r+n)%t.length])}var oB=k2,cB=_2;function dB(t){const r=uB(t),s=d.forwardRef((n,a)=>{const{children:l,...c}=n,u=d.Children.toArray(l),f=u.find(pB);if(f){const h=f.props.children,y=u.map(w=>w===f?d.Children.count(h)>1?d.Children.only(null):d.isValidElement(h)?h.props.children:null:w);return e.jsx(r,{...c,ref:a,children:d.isValidElement(h)?d.cloneElement(h,void 0,y):null})}return e.jsx(r,{...c,ref:a,children:l})});return s.displayName=`${t}.Slot`,s}function uB(t){const r=d.forwardRef((s,n)=>{const{children:a,...l}=s;if(d.isValidElement(a)){const c=hB(a),u=xB(l,a.props);return a.type!==d.Fragment&&(u.ref=n?Sa(n,c):c),d.cloneElement(a,u)}return d.Children.count(a)>1?d.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var mB=Symbol("radix.slottable");function pB(t){return d.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===mB}function xB(t,r){const s={...r};for(const n in r){const a=t[n],l=r[n];/^on[A-Z]/.test(n)?a&&l?s[n]=(...u)=>{const f=l(...u);return a(...u),f}:a&&(s[n]=a):n==="style"?s[n]={...a,...l}:n==="className"&&(s[n]=[a,l].filter(Boolean).join(" "))}return{...t,...s}}function hB(t){let r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?t.ref:(r=Object.getOwnPropertyDescriptor(t,"ref")?.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var Ax=["Enter"," "],fB=["ArrowDown","PageUp","Home"],P2=["ArrowUp","PageDown","End"],gB=[...fB,...P2],yB={ltr:[...Ax,"ArrowRight"],rtl:[...Ax,"ArrowLeft"]},vB={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Yc="Menu",[jc,bB,wB]=Xx(Yc),[ul,A2]=Ga(Yc,[wB,mo,S2]),Fm=mo(),T2=S2(),[NB,ml]=ul(Yc),[jB,Kc]=ul(Yc),O2=t=>{const{__scopeMenu:r,open:s=!1,children:n,dir:a,onOpenChange:l,modal:c=!0}=t,u=Fm(r),[f,h]=d.useState(null),y=d.useRef(!1),w=Jn(l),j=Jx(a);return d.useEffect(()=>{const C=()=>{y.current=!0,document.addEventListener("pointerdown",k,{capture:!0,once:!0}),document.addEventListener("pointermove",k,{capture:!0,once:!0})},k=()=>y.current=!1;return document.addEventListener("keydown",C,{capture:!0}),()=>{document.removeEventListener("keydown",C,{capture:!0}),document.removeEventListener("pointerdown",k,{capture:!0}),document.removeEventListener("pointermove",k,{capture:!0})}},[]),e.jsx(lh,{...u,children:e.jsx(NB,{scope:r,open:s,onOpenChange:w,content:f,onContentChange:h,children:e.jsx(jB,{scope:r,onClose:d.useCallback(()=>w(!1),[w]),isUsingKeyboardRef:y,dir:j,modal:c,children:n})})})};O2.displayName=Yc;var SB="MenuAnchor",Hh=d.forwardRef((t,r)=>{const{__scopeMenu:s,...n}=t,a=Fm(s);return e.jsx(Nm,{...a,...n,ref:r})});Hh.displayName=SB;var Yh="MenuPortal",[kB,R2]=ul(Yh,{forceMount:void 0}),D2=t=>{const{__scopeMenu:r,forceMount:s,children:n,container:a}=t,l=ml(Yh,r);return e.jsx(kB,{scope:r,forceMount:s,children:e.jsx(na,{present:s||l.open,children:e.jsx(Dc,{asChild:!0,container:a,children:n})})})};D2.displayName=Yh;var Mn="MenuContent",[CB,Kh]=ul(Mn),L2=d.forwardRef((t,r)=>{const s=R2(Mn,t.__scopeMenu),{forceMount:n=s.forceMount,...a}=t,l=ml(Mn,t.__scopeMenu),c=Kc(Mn,t.__scopeMenu);return e.jsx(jc.Provider,{scope:t.__scopeMenu,children:e.jsx(na,{present:n||l.open,children:e.jsx(jc.Slot,{scope:t.__scopeMenu,children:c.modal?e.jsx(_B,{...a,ref:r}):e.jsx(EB,{...a,ref:r})})})})}),_B=d.forwardRef((t,r)=>{const s=ml(Mn,t.__scopeMenu),n=d.useRef(null),a=Ar(r,n);return d.useEffect(()=>{const l=n.current;if(l)return fm(l)},[]),e.jsx(Xh,{...t,ref:a,trapFocus:s.open,disableOutsidePointerEvents:s.open,disableOutsideScroll:!0,onFocusOutside:Zt(t.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>s.onOpenChange(!1)})}),EB=d.forwardRef((t,r)=>{const s=ml(Mn,t.__scopeMenu);return e.jsx(Xh,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>s.onOpenChange(!1)})}),PB=dB("MenuContent.ScrollLock"),Xh=d.forwardRef((t,r)=>{const{__scopeMenu:s,loop:n=!1,trapFocus:a,onOpenAutoFocus:l,onCloseAutoFocus:c,disableOutsidePointerEvents:u,onEntryFocus:f,onEscapeKeyDown:h,onPointerDownOutside:y,onFocusOutside:w,onInteractOutside:j,onDismiss:C,disableOutsideScroll:k,...S}=t,_=ml(Mn,s),I=Kc(Mn,s),F=Fm(s),B=T2(s),q=bB(s),[me,re]=d.useState(null),M=d.useRef(null),G=Ar(r,M,_.onContentChange),le=d.useRef(0),Z=d.useRef(""),he=d.useRef(0),ce=d.useRef(null),ke=d.useRef("right"),Ee=d.useRef(0),Fe=k?Lc:d.Fragment,X=k?{as:PB,allowPinchZoom:!0}:void 0,ye=we=>{const pe=Z.current+we,se=q().filter(fe=>!fe.disabled),U=document.activeElement,ue=se.find(fe=>fe.ref.current===U)?.textValue,z=se.map(fe=>fe.textValue),ne=zB(z,pe,ue),ve=se.find(fe=>fe.textValue===ne)?.ref.current;(function fe(Ce){Z.current=Ce,window.clearTimeout(le.current),Ce!==""&&(le.current=window.setTimeout(()=>fe(""),1e3))})(pe),ve&&setTimeout(()=>ve.focus())};d.useEffect(()=>()=>window.clearTimeout(le.current),[]),xm();const Q=d.useCallback(we=>ke.current===ce.current?.side&&QB(we,ce.current?.area),[]);return e.jsx(CB,{scope:s,searchRef:Z,onItemEnter:d.useCallback(we=>{Q(we)&&we.preventDefault()},[Q]),onItemLeave:d.useCallback(we=>{Q(we)||(M.current?.focus(),re(null))},[Q]),onTriggerLeave:d.useCallback(we=>{Q(we)&&we.preventDefault()},[Q]),pointerGraceTimerRef:he,onPointerGraceIntentChange:d.useCallback(we=>{ce.current=we},[]),children:e.jsx(Fe,{...X,children:e.jsx(Rc,{asChild:!0,trapped:a,onMountAutoFocus:Zt(l,we=>{we.preventDefault(),M.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:c,children:e.jsx(Oc,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:h,onPointerDownOutside:y,onFocusOutside:w,onInteractOutside:j,onDismiss:C,children:e.jsx(oB,{asChild:!0,...B,dir:I.dir,orientation:"vertical",loop:n,currentTabStopId:me,onCurrentTabStopIdChange:re,onEntryFocus:Zt(f,we=>{I.isUsingKeyboardRef.current||we.preventDefault()}),preventScrollOnEntryFocus:!0,children:e.jsx(oh,{role:"menu","aria-orientation":"vertical","data-state":X2(_.open),"data-radix-menu-content":"",dir:I.dir,...F,...S,ref:G,style:{outline:"none",...S.style},onKeyDown:Zt(S.onKeyDown,we=>{const se=we.target.closest("[data-radix-menu-content]")===we.currentTarget,U=we.ctrlKey||we.altKey||we.metaKey,ue=we.key.length===1;se&&(we.key==="Tab"&&we.preventDefault(),!U&&ue&&ye(we.key));const z=M.current;if(we.target!==z||!gB.includes(we.key))return;we.preventDefault();const ve=q().filter(fe=>!fe.disabled).map(fe=>fe.ref.current);P2.includes(we.key)&&ve.reverse(),qB(ve)}),onBlur:Zt(t.onBlur,we=>{we.currentTarget.contains(we.target)||(window.clearTimeout(le.current),Z.current="")}),onPointerMove:Zt(t.onPointerMove,Sc(we=>{const pe=we.target,se=Ee.current!==we.clientX;if(we.currentTarget.contains(pe)&&se){const U=we.clientX>Ee.current?"right":"left";ke.current=U,Ee.current=we.clientX}}))})})})})})})});L2.displayName=Mn;var AB="MenuGroup",Jh=d.forwardRef((t,r)=>{const{__scopeMenu:s,...n}=t;return e.jsx(vr.div,{role:"group",...n,ref:r})});Jh.displayName=AB;var TB="MenuLabel",F2=d.forwardRef((t,r)=>{const{__scopeMenu:s,...n}=t;return e.jsx(vr.div,{...n,ref:r})});F2.displayName=TB;var rm="MenuItem",s1="menu.itemSelect",Mm=d.forwardRef((t,r)=>{const{disabled:s=!1,onSelect:n,...a}=t,l=d.useRef(null),c=Kc(rm,t.__scopeMenu),u=Kh(rm,t.__scopeMenu),f=Ar(r,l),h=d.useRef(!1),y=()=>{const w=l.current;if(!s&&w){const j=new CustomEvent(s1,{bubbles:!0,cancelable:!0});w.addEventListener(s1,C=>n?.(C),{once:!0}),q1(w,j),j.defaultPrevented?h.current=!1:c.onClose()}};return e.jsx(M2,{...a,ref:f,disabled:s,onClick:Zt(t.onClick,y),onPointerDown:w=>{t.onPointerDown?.(w),h.current=!0},onPointerUp:Zt(t.onPointerUp,w=>{h.current||w.currentTarget?.click()}),onKeyDown:Zt(t.onKeyDown,w=>{const j=u.searchRef.current!=="";s||j&&w.key===" "||Ax.includes(w.key)&&(w.currentTarget.click(),w.preventDefault())})})});Mm.displayName=rm;var M2=d.forwardRef((t,r)=>{const{__scopeMenu:s,disabled:n=!1,textValue:a,...l}=t,c=Kh(rm,s),u=T2(s),f=d.useRef(null),h=Ar(r,f),[y,w]=d.useState(!1),[j,C]=d.useState("");return d.useEffect(()=>{const k=f.current;k&&C((k.textContent??"").trim())},[l.children]),e.jsx(jc.ItemSlot,{scope:s,disabled:n,textValue:a??j,children:e.jsx(cB,{asChild:!0,...u,focusable:!n,children:e.jsx(vr.div,{role:"menuitem","data-highlighted":y?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...l,ref:h,onPointerMove:Zt(t.onPointerMove,Sc(k=>{n?c.onItemLeave(k):(c.onItemEnter(k),k.defaultPrevented||k.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Zt(t.onPointerLeave,Sc(k=>c.onItemLeave(k))),onFocus:Zt(t.onFocus,()=>w(!0)),onBlur:Zt(t.onBlur,()=>w(!1))})})})}),OB="MenuCheckboxItem",I2=d.forwardRef((t,r)=>{const{checked:s=!1,onCheckedChange:n,...a}=t;return e.jsx(Q2,{scope:t.__scopeMenu,checked:s,children:e.jsx(Mm,{role:"menuitemcheckbox","aria-checked":sm(s)?"mixed":s,...a,ref:r,"data-state":ef(s),onSelect:Zt(a.onSelect,()=>n?.(sm(s)?!0:!s),{checkForDefaultPrevented:!1})})})});I2.displayName=OB;var q2="MenuRadioGroup",[RB,DB]=ul(q2,{value:void 0,onValueChange:()=>{}}),B2=d.forwardRef((t,r)=>{const{value:s,onValueChange:n,...a}=t,l=Jn(n);return e.jsx(RB,{scope:t.__scopeMenu,value:s,onValueChange:l,children:e.jsx(Jh,{...a,ref:r})})});B2.displayName=q2;var z2="MenuRadioItem",$2=d.forwardRef((t,r)=>{const{value:s,...n}=t,a=DB(z2,t.__scopeMenu),l=s===a.value;return e.jsx(Q2,{scope:t.__scopeMenu,checked:l,children:e.jsx(Mm,{role:"menuitemradio","aria-checked":l,...n,ref:r,"data-state":ef(l),onSelect:Zt(n.onSelect,()=>a.onValueChange?.(s),{checkForDefaultPrevented:!1})})})});$2.displayName=z2;var Zh="MenuItemIndicator",[Q2,LB]=ul(Zh,{checked:!1}),U2=d.forwardRef((t,r)=>{const{__scopeMenu:s,forceMount:n,...a}=t,l=LB(Zh,s);return e.jsx(na,{present:n||sm(l.checked)||l.checked===!0,children:e.jsx(vr.span,{...a,ref:r,"data-state":ef(l.checked)})})});U2.displayName=Zh;var FB="MenuSeparator",V2=d.forwardRef((t,r)=>{const{__scopeMenu:s,...n}=t;return e.jsx(vr.div,{role:"separator","aria-orientation":"horizontal",...n,ref:r})});V2.displayName=FB;var MB="MenuArrow",W2=d.forwardRef((t,r)=>{const{__scopeMenu:s,...n}=t,a=Fm(s);return e.jsx(ch,{...a,...n,ref:r})});W2.displayName=MB;var IB="MenuSub",[b$,G2]=ul(IB),ac="MenuSubTrigger",H2=d.forwardRef((t,r)=>{const s=ml(ac,t.__scopeMenu),n=Kc(ac,t.__scopeMenu),a=G2(ac,t.__scopeMenu),l=Kh(ac,t.__scopeMenu),c=d.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:f}=l,h={__scopeMenu:t.__scopeMenu},y=d.useCallback(()=>{c.current&&window.clearTimeout(c.current),c.current=null},[]);return d.useEffect(()=>y,[y]),d.useEffect(()=>{const w=u.current;return()=>{window.clearTimeout(w),f(null)}},[u,f]),e.jsx(Hh,{asChild:!0,...h,children:e.jsx(M2,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":a.contentId,"data-state":X2(s.open),...t,ref:Sa(r,a.onTriggerChange),onClick:w=>{t.onClick?.(w),!(t.disabled||w.defaultPrevented)&&(w.currentTarget.focus(),s.open||s.onOpenChange(!0))},onPointerMove:Zt(t.onPointerMove,Sc(w=>{l.onItemEnter(w),!w.defaultPrevented&&!t.disabled&&!s.open&&!c.current&&(l.onPointerGraceIntentChange(null),c.current=window.setTimeout(()=>{s.onOpenChange(!0),y()},100))})),onPointerLeave:Zt(t.onPointerLeave,Sc(w=>{y();const j=s.content?.getBoundingClientRect();if(j){const C=s.content?.dataset.side,k=C==="right",S=k?-5:5,_=j[k?"left":"right"],I=j[k?"right":"left"];l.onPointerGraceIntentChange({area:[{x:w.clientX+S,y:w.clientY},{x:_,y:j.top},{x:I,y:j.top},{x:I,y:j.bottom},{x:_,y:j.bottom}],side:C}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>l.onPointerGraceIntentChange(null),300)}else{if(l.onTriggerLeave(w),w.defaultPrevented)return;l.onPointerGraceIntentChange(null)}})),onKeyDown:Zt(t.onKeyDown,w=>{const j=l.searchRef.current!=="";t.disabled||j&&w.key===" "||yB[n.dir].includes(w.key)&&(s.onOpenChange(!0),s.content?.focus(),w.preventDefault())})})})});H2.displayName=ac;var Y2="MenuSubContent",K2=d.forwardRef((t,r)=>{const s=R2(Mn,t.__scopeMenu),{forceMount:n=s.forceMount,...a}=t,l=ml(Mn,t.__scopeMenu),c=Kc(Mn,t.__scopeMenu),u=G2(Y2,t.__scopeMenu),f=d.useRef(null),h=Ar(r,f);return e.jsx(jc.Provider,{scope:t.__scopeMenu,children:e.jsx(na,{present:n||l.open,children:e.jsx(jc.Slot,{scope:t.__scopeMenu,children:e.jsx(Xh,{id:u.contentId,"aria-labelledby":u.triggerId,...a,ref:h,align:"start",side:c.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:y=>{c.isUsingKeyboardRef.current&&f.current?.focus(),y.preventDefault()},onCloseAutoFocus:y=>y.preventDefault(),onFocusOutside:Zt(t.onFocusOutside,y=>{y.target!==u.trigger&&l.onOpenChange(!1)}),onEscapeKeyDown:Zt(t.onEscapeKeyDown,y=>{c.onClose(),y.preventDefault()}),onKeyDown:Zt(t.onKeyDown,y=>{const w=y.currentTarget.contains(y.target),j=vB[c.dir].includes(y.key);w&&j&&(l.onOpenChange(!1),u.trigger?.focus(),y.preventDefault())})})})})})});K2.displayName=Y2;function X2(t){return t?"open":"closed"}function sm(t){return t==="indeterminate"}function ef(t){return sm(t)?"indeterminate":t?"checked":"unchecked"}function qB(t){const r=document.activeElement;for(const s of t)if(s===r||(s.focus(),document.activeElement!==r))return}function BB(t,r){return t.map((s,n)=>t[(r+n)%t.length])}function zB(t,r,s){const a=r.length>1&&Array.from(r).every(h=>h===r[0])?r[0]:r,l=s?t.indexOf(s):-1;let c=BB(t,Math.max(l,0));a.length===1&&(c=c.filter(h=>h!==s));const f=c.find(h=>h.toLowerCase().startsWith(a.toLowerCase()));return f!==s?f:void 0}function $B(t,r){const{x:s,y:n}=t;let a=!1;for(let l=0,c=r.length-1;l<r.length;c=l++){const u=r[l],f=r[c],h=u.x,y=u.y,w=f.x,j=f.y;y>n!=j>n&&s<(w-h)*(n-y)/(j-y)+h&&(a=!a)}return a}function QB(t,r){if(!r)return!1;const s={x:t.clientX,y:t.clientY};return $B(s,r)}function Sc(t){return r=>r.pointerType==="mouse"?t(r):void 0}var UB=O2,VB=Hh,WB=D2,GB=L2,HB=Jh,YB=F2,KB=Mm,XB=I2,JB=B2,ZB=$2,ez=U2,tz=V2,rz=W2,sz=H2,nz=K2,Im="DropdownMenu",[az]=Ga(Im,[A2]),Zs=A2(),[iz,J2]=az(Im),Z2=t=>{const{__scopeDropdownMenu:r,children:s,dir:n,open:a,defaultOpen:l,onOpenChange:c,modal:u=!0}=t,f=Zs(r),h=d.useRef(null),[y,w]=Ki({prop:a,defaultProp:l??!1,onChange:c,caller:Im});return e.jsx(iz,{scope:r,triggerId:ga(),triggerRef:h,contentId:ga(),open:y,onOpenChange:w,onOpenToggle:d.useCallback(()=>w(j=>!j),[w]),modal:u,children:e.jsx(UB,{...f,open:y,onOpenChange:w,dir:n,modal:u,children:s})})};Z2.displayName=Im;var ek="DropdownMenuTrigger",tk=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,disabled:n=!1,...a}=t,l=J2(ek,s),c=Zs(s);return e.jsx(VB,{asChild:!0,...c,children:e.jsx(vr.button,{type:"button",id:l.triggerId,"aria-haspopup":"menu","aria-expanded":l.open,"aria-controls":l.open?l.contentId:void 0,"data-state":l.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:Sa(r,l.triggerRef),onPointerDown:Zt(t.onPointerDown,u=>{!n&&u.button===0&&u.ctrlKey===!1&&(l.onOpenToggle(),l.open||u.preventDefault())}),onKeyDown:Zt(t.onKeyDown,u=>{n||(["Enter"," "].includes(u.key)&&l.onOpenToggle(),u.key==="ArrowDown"&&l.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(u.key)&&u.preventDefault())})})})});tk.displayName=ek;var lz="DropdownMenuPortal",rk=t=>{const{__scopeDropdownMenu:r,...s}=t,n=Zs(r);return e.jsx(WB,{...n,...s})};rk.displayName=lz;var sk="DropdownMenuContent",nk=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=J2(sk,s),l=Zs(s),c=d.useRef(!1);return e.jsx(GB,{id:a.contentId,"aria-labelledby":a.triggerId,...l,...n,ref:r,onCloseAutoFocus:Zt(t.onCloseAutoFocus,u=>{c.current||a.triggerRef.current?.focus(),c.current=!1,u.preventDefault()}),onInteractOutside:Zt(t.onInteractOutside,u=>{const f=u.detail.originalEvent,h=f.button===0&&f.ctrlKey===!0,y=f.button===2||h;(!a.modal||y)&&(c.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});nk.displayName=sk;var oz="DropdownMenuGroup",cz=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Zs(s);return e.jsx(HB,{...a,...n,ref:r})});cz.displayName=oz;var dz="DropdownMenuLabel",uz=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Zs(s);return e.jsx(YB,{...a,...n,ref:r})});uz.displayName=dz;var mz="DropdownMenuItem",ak=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Zs(s);return e.jsx(KB,{...a,...n,ref:r})});ak.displayName=mz;var pz="DropdownMenuCheckboxItem",xz=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Zs(s);return e.jsx(XB,{...a,...n,ref:r})});xz.displayName=pz;var hz="DropdownMenuRadioGroup",fz=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Zs(s);return e.jsx(JB,{...a,...n,ref:r})});fz.displayName=hz;var gz="DropdownMenuRadioItem",yz=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Zs(s);return e.jsx(ZB,{...a,...n,ref:r})});yz.displayName=gz;var vz="DropdownMenuItemIndicator",bz=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Zs(s);return e.jsx(ez,{...a,...n,ref:r})});bz.displayName=vz;var wz="DropdownMenuSeparator",Nz=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Zs(s);return e.jsx(tz,{...a,...n,ref:r})});Nz.displayName=wz;var jz="DropdownMenuArrow",Sz=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Zs(s);return e.jsx(rz,{...a,...n,ref:r})});Sz.displayName=jz;var kz="DropdownMenuSubTrigger",Cz=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Zs(s);return e.jsx(sz,{...a,...n,ref:r})});Cz.displayName=kz;var _z="DropdownMenuSubContent",Ez=d.forwardRef((t,r)=>{const{__scopeDropdownMenu:s,...n}=t,a=Zs(s);return e.jsx(nz,{...a,...n,ref:r,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Ez.displayName=_z;var Pz=Z2,Az=tk,Tz=rk,Oz=nk,Rz=ak;function Dz({...t}){return e.jsx(Pz,{"data-slot":"dropdown-menu",...t})}function Lz({...t}){return e.jsx(Az,{"data-slot":"dropdown-menu-trigger",...t})}function Fz({className:t,sideOffset:r=4,...s}){return e.jsx(Tz,{children:e.jsx(Oz,{"data-slot":"dropdown-menu-content",sideOffset:r,className:Nr("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...s})})}function Mz({className:t,inset:r,variant:s="default",...n}){return e.jsx(Rz,{"data-slot":"dropdown-menu-item","data-inset":r,"data-variant":s,className:Nr("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n})}const ls=({onLogout:t,currentPage:r="Dashboard",onNavigate:s,onUploadSuccess:n,role:a})=>{const[l,c]=d.useState(!1),[u,f]=d.useState(!1),h=pe=>{c(pe),pe&&(I(null),B(null),M(null),le(null),S(!1),w(null),q.current&&(q.current.value=""))},[y,w]=d.useState(null),[j,C]=d.useState(!1),[k,S]=d.useState(!1),[_,I]=d.useState(null),[F,B]=d.useState(null),q=d.useRef(null),me=localStorage.getItem("token"),[re,M]=d.useState(null),[G,le]=d.useState(null),Z=async pe=>{if(pe.preventDefault(),!y){I("warning"),B(" Please select a file first.");return}const se=new FormData;se.append("file",y);try{S(!0),M(null),B("Uploading..."),I(null);const U=await xt.post("https://plan.gmvalve.in/backend/api/upload-order-file",se,{headers:{Authorization:`Bearer ${me}`}}),{Resp_code:ue,Resp_desc:z,file_url:ne}=U.data;if(console.log("Upload Response:",U.data),ue==="true"){I("success"),B("File imported successfully!"),M(null),le(null),w(null),q.current&&(q.current.value=""),n?.(),c(!1);try{window.location.reload()}catch{}}else z?.toLowerCase().includes("header mismatch")?(I("error"),B(" Header mismatch found in your Excel file."),M(ne||null),le("header")):z?.toLowerCase().includes("validation errors")?(I("error"),B("Validation errors found in uploaded data."),M(ne||null),le("validation")):(I("error"),B(` ${z||"Error uploading file."}`),M(null),le(null))}catch(U){console.error("Upload Error:",U),I("error"),B(" Error uploading file.")}finally{S(!1)}},he=pe=>{const se=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"],ue=[".xlsx",".xls",".csv"].some(z=>pe.name.toLowerCase().endsWith(z));se.includes(pe.type)||ue?(w(pe),B(null)):(I("error"),B(" Please select a valid Excel (.xlsx, .xls) or CSV (.csv) file."))},ce=pe=>{pe.preventDefault(),C(!1);const se=pe.dataTransfer.files[0];se&&he(se)},ke=pe=>{pe.preventDefault(),C(!0)},Ee=pe=>{pe.preventDefault(),C(!1)},Fe=()=>q.current?.click(),X=pe=>{const se=pe.target.files?.[0];se&&he(se)},ye=()=>{w(null),q.current&&(q.current.value="")},Q=[{id:"Dashboard",label:"Dashboard"},{id:"Planning",label:"Planning"},{id:"MaterialIssue",label:"Material Issue"},{id:"SemiQC",label:"Semi QC"},{id:"PhosphatingQC",label:"After Phosphating QC"},{id:"Assembly-A",label:"Assembly A"},{id:"Assembly-B",label:"Assembly B"},{id:"Assembly-C",label:"Assembly C"},{id:"Assembly-D",label:"Assembly D"},{id:"Testing",label:"Testing"},{id:"SVS",label:"SVS"},{id:"Marking",label:"Marking"},{id:"PDI",label:"PDI"},{id:"TPI",label:"TPI"},{id:"Dispatch",label:"Dispatch"}],we={planning:["Planning"],"material-issue":["MaterialIssue"],"semi-qc":["SemiQC"],"phosphating-qc":["PhosphatingQC"],"assembly-a":["Assembly-A"],"assembly-b":["Assembly-B"],"assembly-c":["Assembly-C"],"assembly-d":["Assembly-D"],testing:["Testing"],marking:["Marking"],svs:["SVS"],pdi:["PDI"],tpi:["TPI"],dispatch:["Dispatch"],admin:Q.map(pe=>pe.id)};return a&&we[a]&&Q.filter(pe=>we[a].includes(pe.id)),e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"glass-header relative z-50",children:e.jsx("div",{className:"mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx("div",{className:"flex items-center space-x-8",children:e.jsx("img",{src:sw,alt:"GM Logo",className:"h-8 w-auto object-contain"})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[a==="planning"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mobile-only",children:[e.jsx("button",{className:"w-full flex items-center justify-center gap-2 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm px-3 py-2 rounded-md","aria-label":"Menu",onClick:()=>f(pe=>!pe),children:e.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),e.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),e.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),u&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 rounded-md bg-white shadow-lg border z-50",children:[e.jsxs("button",{className:"w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center gap-2",onClick:()=>{const pe=["Assembly Line","SOA No.","SR.No.","Assembly Date","Unique Code","Splitted Code","Party","Customer PO No.","Code No","Product","Po Qty","Qty","Qty Exe.","Qty Pending","finished valve","GM Logo","Name Plate","Special Notes","Product Spcl 1","Product Spcl 2","Product Spcl 3","Inspection","Painting","Remarks"],se={};pe.forEach(z=>se[z]=""),se["Assembly Date"]="(dd-mm-yyyy)";const U=Gt.json_to_sheet([se]),ue=Gt.book_new();Gt.book_append_sheet(ue,U,"Order Format"),Yb(ue,"GMV_Order_Format.xlsx"),f(!1)},children:[e.jsx(dv,{className:"h-4 w-4 text-[#174a9f]"}),"Demo Excel"]}),e.jsxs("button",{className:"w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center gap-2",onClick:()=>{c(!0),f(!1)},children:[e.jsx(mv,{className:"h-4 w-4 text-[#174a9f]"}),"Add New Order"]})]})]}),e.jsxs("div",{className:"desktop-only gap-2 justify-end",children:[e.jsxs(ee,{variant:"outline",onClick:()=>{const pe=["Assembly Line","SOA No.","SR.No.","Assembly Date","Unique Code","Splitted Code","Party","Customer PO No.","Code No","Product","Po Qty","Qty","Qty Exe.","Qty Pending","finished valve","GM Logo","Name Plate","Special Notes","Product Spcl 1","Product Spcl 2","Product Spcl 3","Inspection","Painting","Remarks"],se={};pe.forEach(z=>se[z]=""),se["Assembly Date"]="(dd-mm-yyyy)";const U=Gt.json_to_sheet([se]),ue=Gt.book_new();Gt.book_append_sheet(ue,U,"Order Format"),Yb(ue,"GMV_Order_Format.xlsx")},className:"flex items-center gap-2 border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9] transition-all shadow-sm",children:[e.jsx(dv,{className:"h-4 w-4"}),"Demo Excel"]}),e.jsxs(ee,{onClick:()=>c(!0),className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md transition-all",children:[e.jsx(mv,{className:"h-4 w-4"}),"Add New Order"]})]})]}),e.jsxs(ee,{variant:"ghost",size:"sm",className:"h-9 w-9 p-0 rounded-lg hover:bg-gray-100 relative",children:[e.jsx(FE,{className:"h-4 w-4 text-gray-500"}),e.jsx("div",{className:"absolute -top-1 -right-1 h-2 w-2 bg-red-500 rounded-full"})]}),e.jsxs(Dz,{children:[e.jsx(Lz,{asChild:!0,children:e.jsxs(b2,{className:"h-9 w-9 cursor-pointer ring-2 ring-transparent hover:ring-[#a3c4e7] transition-all duration-300 hover:scale-110",children:[e.jsx(w2,{src:"/api/placeholder/36/36"}),e.jsx(N2,{className:"bg-gradient-to-br from-[#2461c7] to-[#174a9f] text-white text-sm font-medium",children:"GM"})]})}),e.jsx(Fz,{align:"end",className:"w-48 mt-2",children:e.jsxs(Mz,{onClick:t,className:"text-red-600 cursor-pointer focus:bg-red-50",children:[e.jsx(a4,{className:"h-4 w-4 mr-2"}),"Sign Out"]})})]})]})]})})}),e.jsx(Ot,{open:l,onOpenChange:h,children:e.jsxs(Tt,{className:"max-w-lg mx-auto bg-white rounded-2xl shadow-2xl border-0",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-2xl font-semibold text-gray-900 text-center",children:"Add New Order"}),e.jsx(Ft,{className:"text-gray-600 text-center",children:"Upload an Excel or CSV file to add new orders to your system."})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:`
          relative border-2 border-dashed rounded-xl p-8 text-center transition-all duration-200
          ${j?"border-[#174a9f] bg-[#e8f0f9]":"border-gray-300 hover:border-gray-400"}
          ${y?"bg-green-50 border-green-300":""}
        `,onDrop:ce,onDragOver:ke,onDragLeave:Ee,children:y?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(r4,{className:"w-6 h-6 text-green-600"})}),e.jsx("p",{className:"font-medium text-gray-900",children:y.name}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[(y.size/1024).toFixed(1)," KB"]}),e.jsxs(ee,{variant:"outline",size:"sm",onClick:ye,className:"text-red-600 border-red-200 hover:bg-red-50",children:[e.jsx(Qx,{className:"w-4 h-4 mr-2"}),"Remove File"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(y4,{className:"w-6 h-6 text-gray-600"})}),e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"Drag and drop your file here"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"or"}),e.jsx(ee,{variant:"outline",onClick:Fe,className:"border-[#174a9f] text-[#174a9f] hover:bg-[#e8f0f9]",children:"Choose File"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Supports Excel files (.xlsx, .xls) and CSV files (.csv)"})]})}),F&&e.jsxs("div",{className:`flex flex-col gap-2 text-sm p-3 rounded-md ${_==="success"?"bg-green-50 text-green-700 border border-green-200":_==="warning"?"bg-yellow-50 text-yellow-700 border border-yellow-200":_==="error"?"bg-red-50 text-red-700 border border-red-200":"text-gray-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[_==="success"&&e.jsx(WE,{className:"h-4 w-4"}),_==="warning"&&e.jsx(f4,{className:"h-4 w-4"}),_==="error"&&e.jsx(ew,{className:"h-4 w-4"}),e.jsx("span",{children:F})]}),re&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:G==="header"?"Your uploaded Excel headers dont match the required format.":"Validation errors found in uploaded Excel data."}),e.jsx("a",{href:re,download:"Error_Report.xlsx",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline hover:text-blue-800 text-sm",children:"Download error report"})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>c(!1),className:"px-6",children:"Cancel"}),e.jsx(ee,{onClick:Z,disabled:!y||k,className:"px-6 bg-[#1457f6] hover:bg-[#1145d4] text-white shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:k?"Uploading...":"Submit"})]})]}),e.jsx("input",{type:"file",ref:q,onChange:X,accept:".xlsx,.xls,.csv",className:"hidden"})]})})]})};function Iz({className:t,...r}){return e.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:Nr("mx-auto flex w-full justify-center",t),...r})}function qz({className:t,...r}){return e.jsx("ul",{"data-slot":"pagination-content",className:Nr("flex flex-row items-center gap-1",t),...r})}function rx({...t}){return e.jsx("li",{"data-slot":"pagination-item",...t})}function tf({className:t,isActive:r,size:s="icon",...n}){return e.jsx("a",{"aria-current":r?"page":void 0,"data-slot":"pagination-link","data-active":r,className:Nr(Tu({variant:r?"outline":"ghost",size:s}),t),...n})}function Bz({className:t,...r}){return e.jsxs(tf,{"aria-label":"Go to previous page",size:"default",className:Nr("gap-1 px-2.5 sm:pl-2.5",t),...r,children:[e.jsx(K1,{}),e.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function zz({className:t,...r}){return e.jsxs(tf,{"aria-label":"Go to next page",size:"default",className:Nr("gap-1 px-2.5 sm:pr-2.5",t),...r,children:[e.jsx("span",{className:"hidden sm:block",children:"Next"}),e.jsx(X1,{})]})}function os({page:t,perPage:r,total:s,lastPage:n,onChangePage:a,onChangePerPage:l,disabled:c}){const u=t>1,f=t<Math.max(n,1);return e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",t," of ",Math.max(n,1),"  Total ",s]}),e.jsxs("div",{className:"flex items-center gap-3",children:[l&&e.jsxs("select",{value:r,onChange:h=>{a(1),l(Number(h.target.value))},className:"border rounded px-2 py-1 text-sm",disabled:c,children:[e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:300,children:"300"}),e.jsx("option",{value:500,children:"500"})]}),e.jsx(Iz,{className:"justify-end",children:e.jsxs(qz,{children:[e.jsx(rx,{children:e.jsx(Bz,{href:"#",onClick:h=>{h.preventDefault(),u&&a(t-1)},"aria-disabled":!u})}),e.jsx(rx,{children:e.jsx(tf,{href:"#",isActive:!0,children:t})}),e.jsx(rx,{children:e.jsx(zz,{href:"#",onClick:h=>{h.preventDefault(),f&&a(t+1)},"aria-disabled":!f})})]})})]})]})}function rf(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(0),[F,B]=d.useState(1),[q,me]=d.useState(null),[re,M]=d.useState(""),[G,le]=d.useState(!1),[Z,he]=d.useState(!1),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("all"),[X,ye]=d.useState("all"),[Q,we]=d.useState("range"),[pe,se]=d.useState(void 0),[U,ue]=d.useState(void 0),[z,ne]=d.useState(new Set),[ve,fe]=d.useState(!1),[Ce,Le]=d.useState(null),[De,Ve]=d.useState(""),[tt,Nt]=d.useState(""),[lt,$t]=d.useState(!1),[qe,Ie]=d.useState(""),[ut,it]=d.useState(""),[jt,mt]=d.useState({}),[xe,Ge]=d.useState(!1),[ot,et]=d.useState(!1),[He,It]=d.useState(null),[yt,St]=d.useState(!1),[ct,Yt]=d.useState(null),[te,Ze]=d.useState(""),[at,Ke]=d.useState(null),[kt,vt]=d.useState(!1),[Bt,Et]=d.useState(null);d.useRef(null);const Qt=d.useRef(null),Ct=localStorage.getItem("token"),bt=async()=>{try{h(!0),w(null);const v=nt("material-issue"),A=(()=>{try{const rt=localStorage.getItem("user");if(!rt)return"";const Y=JSON.parse(rt),ie=typeof Y.role=="object"?Y.role?.name:Y.role;return String(ie||"").toLowerCase()}catch{return""}})().includes("admin"),R={menu_name:v,page:j,per_page:k},D=await xt.post(`${qt}/order-list`,R,{headers:{Authorization:`Bearer ${Ct}`}});if((D?.data?.Resp_code==="true"||D?.data?.Resp_code===!0||D?.data?.Resp_code==="RCS")&&Array.isArray(D.data.data)){const rt=D.data.data.map((ie,Oe)=>({id:String(ie.id),assemblyLine:ie.assembly_no||"",gmsoaNo:ie.soa_no||"",soaSrNo:ie.soa_sr_no||"",assemblyDate:ie.assembly_date||"",uniqueCode:ie.unique_code||ie.order_no||"",split_id:ie.split_id||"",splittedCode:ie.splitted_code||"",party:ie.party_name||ie.party||"",customerPoNo:ie.customer_po_no||"",codeNo:ie.code_no||"",product:ie.product||"",qty:Number(ie.qty||0),totalQty:Number(ie.totalQty||ie.total_qty||ie.qty||0),qtyExe:Number(ie.qty_executed||0),qtyPending:Number(ie.qty_pending||0),finishedValve:ie.finished_valve||"",gmLogo:ie.gm_logo||"",namePlate:ie.name_plate||"",specialNotes:ie.special_notes||ie.special_note||"",productSpcl1:ie.product_spc1||"",productSpcl2:ie.product_spc2||"",productSpcl3:ie.product_spc3||"",inspection:ie.inspection||"",painting:ie.painting||"",remarks:ie.remarks||"",alertStatus:ie.is_urgent===!0||ie.is_urgent==="true"||ie.alert_status===!0||ie.alert_status==="true"||ie.urgent===1||ie.urgent==="1",originalIndex:Oe}));console.log(" Orders fetched:",rt.length,"records"),l(We(rt)),u(null);const Y=D?.data?.pagination;Y?(I(Number(Y.total||rt.length)),B(Number(Y.last_page||1))):(I(rt.length),B(1)),w(null),Et(null)}else console.warn(" No valid order data received",D.data),l([]),w(D?.data?.Resp_desc||"Failed to fetch orders")}catch(m){console.error("Error fetching orders:",m),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}};nt(De);const $e=d.useMemo(()=>re.trim().length>0||(ce!=="all"||Ee!=="all"||X!=="all")||(!!pe||!!U)||G||Z,[re,ce,Ee,X,pe,U,G,Z]);d.useEffect(()=>{$e?c||gt():u(null)},[$e,k]),d.useEffect(()=>{$e||bt()},[j,k,$e]);const gt=async()=>{try{h(!0);const v=nt("material-issue"),N=await xt.post(`${qt}/order-list`,{menu_name:v,page:1,per_page:k},{headers:{Authorization:`Bearer ${Ct}`}});if(!(N?.data?.Resp_code==="true"||N?.data?.Resp_code===!0||N?.data?.Resp_code==="RCS")){u(null);return}const R=N?.data?.pagination,D=Number(R?.last_page||1),Te=[];for(let ie=1;ie<=D;ie++)Te.push(xt.post(`${qt}/order-list`,{menu_name:v,page:ie,per_page:k},{headers:{Authorization:`Bearer ${Ct}`}}));const rt=await Promise.all(Te);let Y=[];for(const ie of rt)if(Array.isArray(ie?.data?.data)){const Oe=ie.data.data.map((Se,Je)=>({id:String(Se.id),assemblyLine:Se.assembly_no||"",gmsoaNo:Se.soa_no||"",soaSrNo:Se.soa_sr_no||"",assemblyDate:Se.assembly_date||"",uniqueCode:Se.unique_code||Se.order_no||"",split_id:Se.split_id||Se.splitted_code||"",splittedCode:Se.splitted_code||"",party:Se.party_name||Se.party||"",customerPoNo:Se.customer_po_no||"",codeNo:Se.code_no||"",product:Se.product||"",qty:Number(Se.qty||0),totalQty:Number(Se.totalQty||Se.total_qty||Se.qty||0),qtyExe:Number(Se.qty_executed||0),qtyPending:Number(Se.qty_pending||0),finishedValve:Se.finished_valve||"",gmLogo:Se.gm_logo||"",namePlate:Se.name_plate||"",specialNotes:Se.special_notes||Se.special_note||"",productSpcl1:Se.product_spc1||"",productSpcl2:Se.product_spc2||"",productSpcl3:Se.product_spc3||"",inspection:Se.inspection||"",painting:Se.painting||"",remarks:Se.remarks||"",alertStatus:Se.is_urgent===!0||Se.is_urgent==="true"||Se.alert_status===!0||Se.alert_status==="true"||Se.urgent===1||Se.urgent==="1",originalIndex:Je}));Y=Y.concat(Oe)}u(We(Y))}catch{u(null)}finally{h(!1)}};d.useEffect(()=>{$e?c||gt():u(null)},[$e,k]);const Pt=d.useMemo(()=>Array.from(new Set(a.map(m=>m.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(m=>m.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(m=>m.party))).filter(Boolean).sort(),[a]);const er=d.useMemo(()=>{let v=($e&&c?c:a).slice();if(G&&(v=v.filter(N=>n(String(N.id))||N.alertStatus)),Z&&(v=v.filter(N=>typeof N.remarks=="string"&&N.remarks.trim().length>0)),ce!=="all"&&(v=v.filter(N=>N.assemblyLine===ce)),Ee!=="all"&&(v=v.filter(N=>N.gmsoaNo===Ee)),X!=="all"&&(v=v.filter(N=>N.party===X)),(pe||U)&&(v=v.filter(N=>{if(!N.assemblyDate||N.assemblyDate==="HOLD")return!1;const R=N.assemblyDate.split(/[\/-]/).map(Te=>Te.trim()).map(Te=>Number(Te));if(R.some(Te=>isNaN(Te)))return!1;let D=null;if(R.length>=3){const[Te,rt,Y]=R;D=new Date(Y,rt-1,Te)}else if(R.length===2){const[Te,rt]=R;D=new Date(rt,Te-1,1)}else if(R.length===1){const[Te]=R;D=new Date(Te,0,1)}else return!1;if(!D||isNaN(D.getTime()))return!1;if(Q==="year"&&pe)return D.getFullYear()===pe.getFullYear();if(Q==="month"&&pe)return D.getFullYear()===pe.getFullYear()&&D.getMonth()===pe.getMonth();if(Q==="range"){if(pe&&U)return D>=pe&&D<=U;if(pe)return D>=pe;if(U)return D<=U}return!0})),re.trim()){const N=re.toLowerCase();v=v.filter(A=>String(A.uniqueCode).toLowerCase().includes(N)||String(A.party).toLowerCase().includes(N)||String(A.gmsoaNo).toLowerCase().includes(N)||String(A.customerPoNo).toLowerCase().includes(N)||String(A.codeNo).toLowerCase().includes(N)||String(A.product).toLowerCase().includes(N))}return q&&(v=[...v].sort((N,A)=>{const R=parseInt(N.soaSrNo||"0",10),D=parseInt(A.soaSrNo||"0",10);return q==="asc"?R-D:D-R})),v},[a,c,re,G,Z,ce,Ee,X,Q,pe,U,n,q]),At=(m="",v=4)=>{const N=m.trim().split(/\s+/);return N.length<=v?m:N.slice(0,v).join(" ")+"..."},Ut=d.useMemo(()=>{const m=(j-1)*k;return er.slice(m,m+k)},[er,j,k]);d.useEffect(()=>{C(1)},[re,ce,Ee,X,pe,U,G,Z]);const Vt=m=>m.splittedCode?String(m.splittedCode):m.split_id?String(m.split_id):m.uniqueCode||m.soaSrNo||m.gmsoaNo||m.codeNo||m.assemblyLine?[m.uniqueCode,m.soaSrNo,m.gmsoaNo,m.codeNo,m.assemblyLine].map(N=>N??"").join("|"):`${m.id}-${m.originalIndex??""}`,zt=d.useMemo(()=>{const m=er.filter(v=>z.has(Vt(v)));return{count:m.length,qty:m.reduce((v,N)=>v+(N.totalQty||N.qty||0),0),qtyExe:m.reduce((v,N)=>v+(N.qtyExe||0),0),qtyPending:m.reduce((v,N)=>v+(N.qtyPending||0),0)}},[z,er]),rr=m=>{ne(v=>{const N=new Set(v);return N.has(m)?N.delete(m):N.add(m),N})},nr=()=>{ne(m=>m.size===er.length?new Set:new Set(er.map(v=>Vt(v))))},lr=er.length>0&&z.size===er.length,ir="material-issue",ar=wr(ir);console.log("Next step(s):",ar.map(nt)),console.log("Is final step?",hn(ir));const V=m=>{const N=wr("material-issue");Le(m),fe(!0),Ve(N[0]||""),Nt(String(m.qtyPending??m.qty??0)),W(null),x(!1),$t(!1),Ie(""),it(""),mt({})},ae=()=>{const m={},v=Number(Ce?.qtyPending??0),N=Number(tt||0),A=Number(ut||0);if(De||Array.isArray(ar)&&ar[0],De||(m.quickAssignStep="Please select a workflow step."),(!tt||N<=0)&&(m.quickAssignQty="Quantity must be greater than 0."),N>v&&(m.quickAssignQty=`Cannot exceed available (${v})`),lt){qe||(m.splitAssignStep="Choose split step."),(!ut||A<=0)&&(m.splitAssignQty="Split quantity is required."),De===qe&&(m.sameEngineer="Split step cannot be the same as main step.");const R=N+A;R!==v&&(m.totalQtyMismatch=`Total quantity (${R}) must equal available (${v}).`)}return mt(m),Object.keys(m).length===0},J=()=>{x(!1),W(null),fe(!1),Le(null),Ve(""),Nt(""),$t(!1),Ie(""),it(""),mt({})},K=a.filter(m=>z.has(Vt(m))),de=()=>Ge(!0),oe=()=>{const v=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${K.map(R=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${R.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(R.gmsoaNo).replace(/^SOA/i,"")}-${R.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${R.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${R.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${R.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${R.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${R.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${R.specialNotes||""}</span> </div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,N=document.createElement("iframe");N.style.position="fixed",N.style.right="0",N.style.bottom="0",N.style.width="0",N.style.height="0",N.style.border="0",document.body.appendChild(N);const A=N.contentDocument||N.contentWindow?.document;A&&(A.open(),A.write(v),A.close(),setTimeout(()=>{N.contentWindow?.focus(),N.contentWindow?.print(),setTimeout(()=>document.body.removeChild(N),500)},300))},_e=()=>{const m=G===!0,v=Z===!0,N=z.size>0;if(!m&&!v&&!N)return;const A=N?er.filter(R=>z.has(Vt(R))):er;if(!A.length){alert("No data available to export");return}Ae(A)},Be=()=>{const m=c&&c.length>0?c:a;if(!m||m.length===0){alert("No data available to export");return}Ae(m)},Ae=m=>{const v=m.map((D,Te)=>({No:Te+1,"Assembly Line":D.assemblyLine,"GMSOA No":D.gmsoaNo,"SOA Sr No":D.soaSrNo,"Assembly Date":D.assemblyDate,"Unique Code":D.uniqueCode,"Splitted Code":D.splittedCode||"-",Party:D.party,"Customer PO No":D.customerPoNo,"Code No":D.codeNo,Product:D.product,"PO Qty":D.poQty,Qty:D.qty,"Qty Executed":D.qtyExe,"Qty Pending":D.qtyPending,"Finished Valve":D.finishedValve,"GM Logo":D.gmLogo,"Name Plate":D.namePlate,"Special Notes":D.specialNotes||"","Product Special 1":D.productSpcl1,"Product Special 2":D.productSpcl2,"Product Special 3":D.productSpcl3,Inspection:D.inspection,Painting:D.painting,Remarks:D.remarks||""})),N=Gt.json_to_sheet(v),A=Gt.book_new();Gt.book_append_sheet(A,N,"Orders");const R=Jr(A,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([R],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Ne=m=>{It(m),et(!0)},je=m=>{Yt(m),Ze(m.remarks||""),St(!0)},Me=async()=>{if(!ct)return;const m=new FormData;m.append("orderId",String(ct.id)),m.append("remarks",te);try{const v=await xt.post(`${qt}/add-remarks`,m,{headers:{Authorization:`Bearer ${Ct}`}});if(console.log("Add Remarks Response:",v.data),v.data?.Resp_code==="true"||v.data?.Resp_code===!0){l(A=>A.map(R=>R.id===ct.id?{...R,remarks:te}:R));try{t(ct.id,te)}catch{}St(!1),Yt(null),Ze("")}else console.warn("Backend rejected remarks:",v.data)}catch(v){console.error("Error saving remarks:",v)}},We=m=>[...m].sort((v,N)=>(v.originalIndex??0)-(N.originalIndex??0)),[ge,W]=d.useState(null),[T,x]=d.useState(!1),P=async()=>{if(!T&&(x(!0),!!Ce&&ae())){W({type:"info",message:"Assigning order, please wait..."});try{const m=localStorage.getItem("token");if(!m){W({type:"error",message:"Token missing. Please log in again."});return}const v=Number(tt||0),N=Number(ut||0),A=De||(Array.isArray(ar)?ar[0]:"semi-qc"),R=nt(A),D=nt(ir),Te=new FormData;Te.append("orderId",String(Ce.id)),Te.append("totalQty",String(Ce.totalQty??Ce.qty??0)),Te.append("executedQty",String(v)),Te.append("currentSteps",D),Te.append("nextSteps",R),Te.append("split_id",String(Ce.split_id||"")),console.log(" MAIN PAYLOAD:");for(const Oe of Te.entries())console.log(Oe[0],Oe[1]);const rt=await xt.post(`${qt}/assign-order`,Te,{headers:{Authorization:`Bearer ${m}`}});if(!(rt.data?.Resp_code==="true"||rt.data?.Resp_code===!0)){W({type:"error",message:rt.data?.Resp_desc||"Main assignment failed."});return}let ie=` Assigned ${v}  ${R}`;if(lt&&N>0){const Oe=new FormData;Oe.append("orderId",String(Ce.id)),Oe.append("totalQty",String(Ce.totalQty??Ce.qty??0)),Oe.append("executedQty",String(N)),Oe.append("currentSteps",D),Oe.append("nextSteps",R),Oe.append("split_id",String(Ce.split_id||"")),console.log(" SPLIT PAYLOAD:");for(const ft of Oe.entries())console.log("SPLIT:",ft[0],ft[1]);const Se=await xt.post(`${qt}/assign-order`,Oe,{headers:{Authorization:`Bearer ${m}`}});Se.data?.Resp_code==="true"||Se.data?.Resp_code===!0?ie+=`
 Split ${N}  ${R}`:W({type:"error",message:"Main assigned but split failed: "+(Se.data?.Resp_desc||"Unknown error")})}W({type:"success",message:ie}),await bt(),fe(!1)}catch(m){console.error(" Error assigning order:",m),W({type:"error",message:"Server error while assigning."})}finally{x(!1)}}},g=()=>{ke("all"),Fe("all"),ye("all"),we("range"),se(void 0),ue(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:m=>{window.location.href=`/${m.toLowerCase()}`},onUploadSuccess:()=>bt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Material Issue"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:de,variant:"outline",disabled:z.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>le(!G),className:`btn-urgent flex items-center gap-2 ${G?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),G?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>he(!Z),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:Z?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{disabled:er.length===0,onClick:_e,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:Be,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:re,setSearchTerm:M,assemblyLineFilter:ce,setAssemblyLineFilter:ke,dateFilterMode:Q,setDateFilterMode:we,dateFrom:pe,setDateFrom:se,dateTo:U,setDateTo:ue,assemblyLines:Pt,onClearFilters:g,hasActiveFilters:ce!=="all"||Ee!=="all"||X!=="all"||!!pe||!!U})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:Qt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs("div",{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(lr),onClick:nr,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${lr?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>me(m=>m==="asc"?"desc":m==="desc"?null:"asc"),children:["Sr.No.",q==="asc"&&" ",q==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Ut.map(m=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:z.has(Vt(m)),onCheckedChange:()=>rr(Vt(m)),"aria-label":`Select row ${m.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:m.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:m.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:m.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:m.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:m.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:m.party,children:At(m.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:m.product,children:m.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:m.specialNotes,children:m.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:m.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:m.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${m.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>je(m),children:e.jsx(is,{className:`h-4 w-4 ${m.remarks?.trim()?"text-white":"text-blue-600"}`})}),m.remarks?.trim()&&e.jsx("div",{className:`\r
          absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
          hidden group-hover:block\r
          bg-gray-900 text-white text-xs\r
          px-3 py-2 rounded-md shadow-lg\r
          max-w-[260px] break-words z-[999]\r
        `,children:m.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>Ne(m),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>V(m),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${m.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${m.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},Vt(m)))})]}),er.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),zt.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:zt.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:zt.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:zt.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:zt.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:er.length,lastPage:Math.max(1,Math.ceil(er.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:ve,onOpenChange:m=>{m||(fe(!1),x(!1),W(null))},children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",Ce?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:De,onValueChange:Ve,children:[e.jsx(ss,{id:"assignStep",children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:ar.map(m=>e.jsx(Pr,{value:m,children:nt(m)},m))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:tt,onChange:m=>{const v=m.target.value;Nt(v);const N=Number(Ce?.qtyPending??0),A=Number(v||0);mt(R=>{const D={...R};return A>N?D.quickAssignQty=`Cannot exceed available (${N})`:D.quickAssignQty&&delete D.quickAssignQty,D})},max:Ce?.qtyPending}),jt.quickAssignQty&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:jt.quickAssignQty})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:Ce?.qtyPending})]})]})}),ge&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${ge.type==="success"?"bg-green-50 text-green-700 border border-green-200":ge.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:ge.message.split(`
`).map((m,v)=>e.jsx("div",{children:m},v))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:J,disabled:T,children:"Cancel"}),e.jsx(ee,{onClick:P,disabled:T||!!jt.quickAssignQty,className:"bg-black hover:bg-gray-800 text-white",children:T?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:xe,onOpenChange:Ge,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:K.map(m=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",m.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(m.gmsoaNo).replace(/^SOA/i,""),"-",m.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",m.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:m.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:m.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",m.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",m.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:m.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},m.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),e.jsxs(ee,{onClick:oe,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:ot,onOpenChange:et,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",He?.uniqueCode]})]}),He&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>et(!1),children:"Close"})})]})}),e.jsx(Ot,{open:yt,onOpenChange:St,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:ct?`Order: ${ct.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:te,onChange:m=>Ze(m.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>St(!1),children:"Cancel"}),e.jsx(ee,{onClick:Me,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function sf(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),[pe,se]=d.useState(new Set),[U,ue]=d.useState(!1),[z,ne]=d.useState(null),[ve,fe]=d.useState(""),[Ce,Le]=d.useState(""),[De,Ve]=d.useState(!1),[tt,Nt]=d.useState(""),[lt,$t]=d.useState(""),[qe,Ie]=d.useState({}),[ut,it]=d.useState(!1),[jt,mt]=d.useState(!1),[xe,Ge]=d.useState(null),[ot,et]=d.useState(!1),[He,It]=d.useState(null),[yt,St]=d.useState(""),ct=x=>x?.trim().toLowerCase().replace(/\s+/g,"-"),[Yt,te]=d.useState(null),[Ze,at]=d.useState(!1),[Ke,kt]=d.useState(null);d.useRef(null);const vt=d.useRef(null),Bt=localStorage.getItem("token"),Et=async()=>{try{h(!0),w(null);const P=nt("semi-qc"),m=(()=>{try{const R=localStorage.getItem("user");if(!R)return"";const D=JSON.parse(R),Te=typeof D.role=="object"?D.role?.name:D.role;return String(Te||"").toLowerCase()}catch{return""}})().includes("admin"),v={menu_name:P},N=await xt.post(`${qt}/order-list`,v,{headers:{Authorization:`Bearer ${Bt}`}});if((N?.data?.Resp_code==="true"||N?.data?.Resp_code===!0||N?.data?.Resp_code==="RCS")&&Array.isArray(N.data.data)){const R=N.data.data.map(D=>({id:String(D.id),assemblyLine:D.assembly_no||"",gmsoaNo:D.soa_no||"",soaSrNo:D.soa_sr_no||"",assemblyDate:D.assembly_date||"",uniqueCode:D.unique_code||D.order_no||"",splittedCode:D.splitted_code||"",split_id:D.split_id||D.splitted_code||"",party:D.party_name||D.party||"",customerPoNo:D.customer_po_no||"",codeNo:D.code_no||"",product:D.product||"",totalQty:Number(D.semi_qc_total_qty??D.totalQty??D.total_qty??D.qty??0),qty:Number(D.qty??D.semi_qc_qty??0),qtyExe:Number(D.semi_qc_qty_executed??D.qty_executed??D.qtyExe??0),qtyPending:Number(D.semi_qc_qty_pending??D.qty_pending??0),finishedValve:D.finished_valve||"",gmLogo:D.gm_logo||"",namePlate:D.name_plate||"",specialNotes:D.special_notes||D.special_note||"",productSpcl1:D.product_spc1||"",productSpcl2:D.product_spc2||"",productSpcl3:D.product_spc3||"",inspection:D.inspection||"",painting:D.painting||"",remarks:D.remarks||"",currentStage:"Semi QC",alertStatus:D.is_urgent===!0||D.is_urgent==="true"||D.alert_status===!0||D.alert_status==="true"||D.urgent===1||D.urgent==="1"}));console.log(" Orders fetched:",R.length,"records"),l(Ne(R)),u(null),w(null),kt(null)}else console.warn(" No valid order data received",N.data),l([]),w(N?.data?.Resp_desc||"Failed to fetch orders")}catch(x){console.error("Error fetching orders:",x),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Qt=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{Qt||Et()},[j,k,Qt]);const Ct=d.useMemo(()=>Array.from(new Set(a.map(x=>x.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(x=>x.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(x=>x.party))).filter(Boolean).sort(),[a]);const bt=x=>{const P=parseInt(x,10);return isNaN(P)?0:P},$e=d.useMemo(()=>{let P=(Qt&&c?c:a).slice();if(P=P.filter(g=>ct(g.currentStage)==="semi-qc"),q&&(P=P.filter(g=>n(String(g.id))||g.alertStatus)),re&&(P=P.filter(g=>typeof g.remarks=="string"&&g.remarks.trim().length>0)),G!=="all"&&(P=P.filter(g=>g.assemblyLine===G)),Z!=="all"&&(P=P.filter(g=>g.gmsoaNo===Z)),ce!=="all"&&(P=P.filter(g=>g.party===ce)),(X||Q)&&(P=P.filter(g=>{if(!g.assemblyDate||g.assemblyDate==="HOLD")return!1;const v=g.assemblyDate.split(/[\/-]/).map(A=>A.trim()).map(A=>Number(A));if(v.some(A=>isNaN(A)))return!1;let N=null;if(v.length>=3){const[A,R,D]=v;N=new Date(D,R-1,A)}else if(v.length===2){const[A,R]=v;N=new Date(R,A-1,1)}else if(v.length===1){const[A]=v;N=new Date(A,0,1)}else return!1;if(!N||isNaN(N.getTime()))return!1;if(Ee==="year"&&X)return N.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return N.getFullYear()===X.getFullYear()&&N.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return N>=X&&N<=Q;if(X)return N>=X;if(Q)return N<=Q}return!0})),F.trim()){const g=F.toLowerCase();P=P.filter(m=>String(m.uniqueCode).toLowerCase().includes(g)||String(m.party).toLowerCase().includes(g)||String(m.gmsoaNo).toLowerCase().includes(g)||String(m.customerPoNo).toLowerCase().includes(g)||String(m.codeNo).toLowerCase().includes(g)||String(m.product).toLowerCase().includes(g))}return _&&(P=[...P].sort((g,m)=>{const v=bt(g.soaSrNo),N=bt(m.soaSrNo);return _==="asc"?v-N:N-v})),P},[a,c,F,q,re,G,Z,ce,Ee,X,Q,n,_]),gt=(x="",P=4)=>{const g=x.trim().split(/\s+/);return g.length<=P?x:g.slice(0,P).join(" ")+"..."},Pt=d.useMemo(()=>{const x=(j-1)*k;return $e.slice(x,x+k)},[$e,j,k]);d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const er=x=>{se(P=>{const g=new Set(P);return g.has(x)?g.delete(x):g.add(x),g})},At=()=>{se(x=>{if(x.size===$e.length)return new Set;const P=$e.map(g=>g.splittedCode||g.split_id?g.splittedCode||g.split_id:[g.uniqueCode,g.soaSrNo,g.gmsoaNo,g.codeNo,g.assemblyLine].map(m=>m??"").join("|"));return new Set(P)})},Ut=$e.length>0&&pe.size===$e.length,Vt="semi-qc",zt=wr(Vt);console.log("Next step(s):",zt.map(nt)),console.log("Is final step?",hn(Vt));const rr=x=>{const g=wr("semi-qc");ne(x),ue(!0),fe(g[0]||""),Le(String(x.qtyPending??x.qty??0)),Ve(!1),Nt(""),$t(""),Ie({})},nr=()=>{const x={},P=Number(z?.qtyPending??0),g=Number(Ce||0),m=Number(lt||0);if(ve||(x.quickAssignStep="Please select a workflow step."),(!Ce||g<=0)&&(x.quickAssignQty="Quantity must be greater than 0."),g>P&&(x.quickAssignQty=`Cannot exceed available (${P})`),De){tt||(x.splitAssignStep="Choose split step."),(!lt||m<=0)&&(x.splitAssignQty="Split quantity is required."),ve===tt&&(x.sameEngineer="Split step cannot be the same as main step.");const v=g+m;v!==P&&(x.totalQtyMismatch=`Total quantity (${v}) must equal available (${P}).`)}return Ie(x),Object.keys(x).length===0},lr=()=>{ge(!1),Me(null),ue(!1),ne(null),fe(""),Le(""),Ve(!1),Nt(""),$t(""),Ie({})},ir=a.filter(x=>pe.has(x.splittedCode||x.split_id||x.uniqueCode||x.id)),ar=()=>it(!0),V=()=>{const P=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ir.map(v=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${v.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(v.gmsoaNo).replace(/^SOA/i,"")}-${v.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${v.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${v.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${v.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${v.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${v.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${v.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,g=document.createElement("iframe");g.style.position="fixed",g.style.right="0",g.style.bottom="0",g.style.width="0",g.style.height="0",g.style.border="0",document.body.appendChild(g);const m=g.contentDocument||g.contentWindow?.document;m&&(m.open(),m.write(P),m.close(),setTimeout(()=>{g.contentWindow?.focus(),g.contentWindow?.print(),setTimeout(()=>document.body.removeChild(g),500)},300))},ae=x=>x.splittedCode||x.split_id?x.splittedCode||x.split_id:[x.uniqueCode,x.soaSrNo,x.gmsoaNo,x.codeNo,x.assemblyLine].map(P=>P??"").join("|"),J=d.useMemo(()=>{const x=$e.filter(P=>pe.has(ae(P)));return{count:x.length,qty:x.reduce((P,g)=>P+(g.totalQty||g.qty||0),0),qtyExe:x.reduce((P,g)=>P+(g.qtyExe||0),0),qtyPending:x.reduce((P,g)=>P+(g.qtyPending||0),0)}},[pe,$e]),K=()=>{const x=q===!0,P=re===!0,g=pe.size>0;if(!x&&!P&&!g)return;const m=g?$e.filter(v=>pe.has(ae(v))):$e;if(!m.length){alert("No data available to export");return}oe(m)},de=()=>{const x=c&&c.length>0?c:a;if(!x||x.length===0){alert("No data available to export");return}oe(x)},oe=x=>{const P=x.map((N,A)=>({No:A+1,"Assembly Line":N.assemblyLine,"GMSOA No":N.gmsoaNo,"SOA Sr No":N.soaSrNo,"Assembly Date":N.assemblyDate,"Unique Code":N.uniqueCode,"Splitted Code":N.splittedCode||"-",Party:N.party,"Customer PO No":N.customerPoNo,"Code No":N.codeNo,Product:N.product,"PO Qty":N.poQty,Qty:N.qty,"Qty Executed":N.qtyExe,"Qty Pending":N.qtyPending,"Finished Valve":N.finishedValve,"GM Logo":N.gmLogo,"Name Plate":N.namePlate,"Special Notes":N.specialNotes||"","Product Special 1":N.productSpcl1,"Product Special 2":N.productSpcl2,"Product Special 3":N.productSpcl3,Inspection:N.inspection,Painting:N.painting,Remarks:N.remarks||""})),g=Gt.json_to_sheet(P),m=Gt.book_new();Gt.book_append_sheet(m,g,"Orders");const v=Jr(m,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([v],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},_e=x=>{Ge(x),mt(!0)},Be=x=>{It(x),St(x.remarks||""),et(!0)},Ae=async()=>{if(!He)return;const x=new FormData;x.append("orderId",String(He.id)),x.append("remarks",yt);try{const P=await xt.post(`${qt}/add-remarks`,x,{headers:{Authorization:`Bearer ${Bt}`}});if(console.log("Add Remarks Response:",P.data),P.data?.Resp_code==="true"||P.data?.Resp_code===!0){l(m=>m.map(v=>v.id===He.id?{...v,remarks:yt}:v));try{t(He.id,yt)}catch{}et(!1),It(null),St("")}else console.warn("Backend rejected remarks:",P.data)}catch(P){console.error("Error saving remarks:",P)}},Ne=x=>[...x].sort((P,g)=>(P.originalIndex??0)-(g.originalIndex??0)),[je,Me]=d.useState(null),[We,ge]=d.useState(!1),W=async()=>{if(!We&&z&&nr()){ge(!0),Me({type:"info",message:"Assigning order, please wait..."});try{const x=localStorage.getItem("token");if(!x){Me({type:"error",message:"Token missing. Please log in again."});return}const P=nt("semi-qc"),g=Number(Ce||0),m=Number(lt||0),v=ve||(Array.isArray(zt)?zt[0]:"phosphating-qc"),N=nt(v),A=new FormData;A.append("orderId",String(z.id)),A.append("totalQty",String(z.totalQty??z.qty??0)),A.append("executedQty",String(g)),A.append("currentSteps",P),A.append("nextSteps",N),A.append("split_id",String(z.split_id||""));const R=await xt.post(`${qt}/assign-order`,A,{headers:{Authorization:`Bearer ${x}`}});if(!(R.data?.Resp_code==="true"||R.data?.Resp_code===!0)){Me({type:"error",message:R.data?.Resp_desc||"Main assignment failed."});return}let Te=` Assigned ${g}  ${N}`;if(De&&m>0){const ie=new FormData;ie.append("orderId",String(z.id)),ie.append("totalQty",String(z.totalQty??z.qty??0)),ie.append("executedQty",String(m)),ie.append("currentSteps",P),ie.append("nextSteps",N),ie.append("split_id",String(z.split_id||"")),ie.append("splitOrder","true");const Oe=await xt.post(`${qt}/assign-order`,ie,{headers:{Authorization:`Bearer ${x}`}});(Oe.data?.Resp_code==="true"||Oe.data?.Resp_code===!0)&&(Te+=`
 Split ${m}  ${N}`)}Me({type:"success",message:Te});const rt=ie=>ie.splittedCode||ie.split_id?ie.splittedCode||ie.split_id:[ie.uniqueCode,ie.soaSrNo,ie.gmsoaNo,ie.codeNo,ie.assemblyLine].map(Oe=>Oe??"").join("|"),Y=rt(z);l(ie=>ie.filter(Oe=>rt(Oe)!==Y)),se(ie=>{const Oe=new Set(ie);return Oe.delete(Y),Oe}),setTimeout(()=>{ue(!1),Me(null)},1500)}catch(x){console.error(" Error assigning order:",x),Me({type:"error",message:"Server error while assigning."})}finally{ge(!1)}}},T=()=>{le("all"),he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:x=>{window.location.href=`/${x.toLowerCase()}`},onUploadSuccess:()=>Et()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Semi QC"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:ar,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{disabled:$e.length===0,onClick:K,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:de,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:Ct,onClearFilters:T,hasActiveFilters:G!=="all"||Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:vt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ut),onClick:At,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ut?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(x=>x==="asc"?"desc":x==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:Pt.map((x,P)=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:pe.has(x.splittedCode||x.split_id?x.splittedCode||x.split_id:[x.uniqueCode,x.soaSrNo,x.gmsoaNo,x.codeNo,x.assemblyLine].map(g=>g??"").join("|")),onCheckedChange:()=>er(x.splittedCode||x.split_id?x.splittedCode||x.split_id:[x.uniqueCode,x.soaSrNo,x.gmsoaNo,x.codeNo,x.assemblyLine].map(g=>g??"").join("|")),"aria-label":`Select row ${x.splittedCode||x.split_id||x.uniqueCode||x.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:x.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:x.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:x.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:x.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:x.party,children:gt(x.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:x.product,children:x.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:x.specialNotes,children:x.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:x.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:x.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${x.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Be(x),children:e.jsx(is,{className:`h-4 w-4 ${x.remarks?.trim()?"text-white":"text-blue-600"}`})}),x.remarks?.trim()&&e.jsx("div",{className:`\r
                                absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                hidden group-hover:block\r
                                bg-gray-900 text-white text-xs\r
                                px-3 py-2 rounded-md shadow-lg\r
                                max-w-[260px] break-words z-[999]\r
                              `,children:x.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>_e(x),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>rr(x),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${x.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${x.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},x.splittedCode||x.split_id?x.splittedCode||x.split_id:[x.uniqueCode,x.soaSrNo,x.gmsoaNo,x.codeNo,x.assemblyLine,P].map(g=>g??"").join("|")))})]}),$e.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),J.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:J.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:J.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:J.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:J.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:$e.length,lastPage:Math.max(1,Math.ceil($e.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:U,onOpenChange:ue,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:ve,onValueChange:fe,children:[e.jsx(ss,{id:"assignStep",disabled:!0,children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:zt.map(x=>e.jsx(Pr,{value:x,children:nt(x)},x))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Ce,onChange:x=>Le(x.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),je&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${je.type==="success"?"bg-green-50 text-green-700 border border-green-200":je.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:je.message.split(`
`).map((x,P)=>e.jsx("div",{children:x},P))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:lr,disabled:We,children:"Cancel"}),e.jsx(ee,{onClick:W,disabled:We,className:"bg-black hover:bg-gray-800 text-white",children:We?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:ut,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ir.map(x=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",x.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(x.gmsoaNo).replace(/^SOA/i,""),"-",x.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",x.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:x.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:x.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",x.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",x.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:x.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},x.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(ee,{onClick:V,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:jt,onOpenChange:mt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>mt(!1),children:"Close"})})]})}),e.jsx(Ot,{open:ot,onOpenChange:et,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:yt,onChange:x=>St(x.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>et(!1),children:"Cancel"}),e.jsx(ee,{onClick:Ae,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function nf(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),[pe,se]=d.useState(new Set),[U,ue]=d.useState(!1),[z,ne]=d.useState(null),[ve,fe]=d.useState(""),[Ce,Le]=d.useState(""),[De,Ve]=d.useState(!1),[tt,Nt]=d.useState(""),[lt,$t]=d.useState(""),[qe,Ie]=d.useState({}),[ut,it]=d.useState(!1),[jt,mt]=d.useState(!1),[xe,Ge]=d.useState(null),[ot,et]=d.useState(!1),[He,It]=d.useState(null),[yt,St]=d.useState(""),[ct,Yt]=d.useState(null),[te,Ze]=d.useState(!1),[at,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),vt=localStorage.getItem("token"),Bt=async()=>{try{h(!0),w(null);const P=nt("phosphating"),m=(()=>{try{const R=localStorage.getItem("user");if(!R)return"";const D=JSON.parse(R),Te=typeof D.role=="object"?D.role?.name:D.role;return String(Te||"").toLowerCase()}catch{return""}})().includes("admin"),v={menu_name:P},N=await xt.post(`${qt}/order-list`,v,{headers:{Authorization:`Bearer ${vt}`}});if((N?.data?.Resp_code==="true"||N?.data?.Resp_code===!0||N?.data?.Resp_code==="RCS")&&Array.isArray(N.data.data)){const R=N.data.data.map((D,Te)=>({id:String(D.id),originalIndex:Te,assemblyLine:D.assembly_no||"",gmsoaNo:D.soa_no||"",soaSrNo:D.soa_sr_no||"",assemblyDate:D.assembly_date||"",uniqueCode:D.unique_code||D.order_no||"",splittedCode:D.splitted_code||"",split_id:D.split_id||D.splitted_code||"",party:D.party_name||D.party||"",customerPoNo:D.customer_po_no||"",codeNo:D.code_no||"",product:D.product||"",totalQty:Number(D.totalQty||D.total_qty||D.qty||0),qty:Number(D.qty||0),qtyExe:Number(D.qty_executed||0),qtyPending:Number(D.qty_pending||0),finishedValve:D.finished_valve||"",gmLogo:D.gm_logo||"",namePlate:D.name_plate||"",specialNotes:D.special_notes||D.special_note||"",productSpcl1:D.product_spc1||"",productSpcl2:D.product_spc2||"",productSpcl3:D.product_spc3||"",inspection:D.inspection||"",painting:D.painting||"",currentStage:"Phosphating",alertStatus:D.is_urgent===!0||D.is_urgent==="true"||D.alert_status===!0||D.alert_status==="true"||D.urgent===1||D.urgent==="1"}));console.log(" Orders fetched:",R.length,"records"),u(null),l(Ae(R)),w(null),Ke(null)}else console.warn(" No valid order data received",N.data),l([]),w(N?.data?.Resp_desc||"Failed to fetch orders")}catch(x){console.error("Error fetching orders:",x),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Et=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{Et||u(null)},[Et,k]),d.useEffect(()=>{Et||Bt()},[j,k,Et]);const Qt=d.useMemo(()=>Array.from(new Set(a.map(x=>x.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(x=>x.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(x=>x.party))).filter(Boolean).sort(),[a]);const Ct=x=>{const P=parseInt(x,10);return isNaN(P)?0:P},bt=d.useMemo(()=>{let P=(Et&&c?c:a).slice();if(q&&(P=P.filter(g=>n(String(g.id))||g.alertStatus)),re&&(P=P.filter(g=>typeof g.remarks=="string"&&g.remarks.trim().length>0)),G!=="all"&&(P=P.filter(g=>g.assemblyLine===G)),Z!=="all"&&(P=P.filter(g=>g.gmsoaNo===Z)),ce!=="all"&&(P=P.filter(g=>g.party===ce)),(X||Q)&&(P=P.filter(g=>{if(!g.assemblyDate||g.assemblyDate==="HOLD")return!1;const v=g.assemblyDate.split(/[\/-]/).map(A=>A.trim()).map(A=>Number(A));if(v.some(A=>isNaN(A)))return!1;let N=null;if(v.length>=3){const[A,R,D]=v;N=new Date(D,R-1,A)}else if(v.length===2){const[A,R]=v;N=new Date(R,A-1,1)}else if(v.length===1){const[A]=v;N=new Date(A,0,1)}else return!1;if(!N||isNaN(N.getTime()))return!1;if(Ee==="year"&&X)return N.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return N.getFullYear()===X.getFullYear()&&N.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return N>=X&&N<=Q;if(X)return N>=X;if(Q)return N<=Q}return!0})),F.trim()){const g=F.toLowerCase();P=P.filter(m=>String(m.uniqueCode).toLowerCase().includes(g)||String(m.party).toLowerCase().includes(g)||String(m.gmsoaNo).toLowerCase().includes(g)||String(m.customerPoNo).toLowerCase().includes(g)||String(m.codeNo).toLowerCase().includes(g)||String(m.product).toLowerCase().includes(g))}return _&&(P=[...P].sort((g,m)=>{const v=Ct(g.soaSrNo),N=Ct(m.soaSrNo);return _==="asc"?v-N:N-v})),P},[a,c,F,q,re,G,Z,ce,Ee,X,Q,n,_]),$e=(x="",P=4)=>{const g=x.trim().split(/\s+/);return g.length<=P?x:g.slice(0,P).join(" ")+"..."},gt=d.useMemo(()=>{const x=(j-1)*k;return bt.slice(x,x+k)},[bt,j,k]);d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const Pt=x=>{se(P=>{const g=new Set(P);return g.has(x)?g.delete(x):g.add(x),g})},er=()=>{se(x=>x.size===bt.length?new Set:new Set(bt.map(P=>P.id)))},At=bt.length>0&&pe.size===bt.length,Ut="phosphating",Vt=wr(Ut);console.log("Next step(s):",Vt.map(nt)),console.log("Is final step?",hn(Ut));const zt=x=>{const g=wr("phosphating");ne(x),ue(!0),fe(g[0]||""),Le(String(x.qtyPending??x.qty??0)),Ve(!1),Nt(""),$t(""),Ie({})},rr=()=>{const x={},P=Number(z?.qtyPending??0),g=Number(Ce||0),m=Number(lt||0);if(ve||(x.quickAssignStep="Please select a workflow step."),(!Ce||g<=0)&&(x.quickAssignQty="Quantity must be greater than 0."),g>P&&(x.quickAssignQty=`Cannot exceed available (${P})`),De){tt||(x.splitAssignStep="Choose split step."),(!lt||m<=0)&&(x.splitAssignQty="Split quantity is required."),ve===tt&&(x.sameEngineer="Split step cannot be the same as main step.");const v=g+m;v!==P&&(x.totalQtyMismatch=`Total quantity (${v}) must equal available (${P}).`)}return Ie(x),Object.keys(x).length===0},nr=()=>{We(!1),je(null),ue(!1),ne(null),fe(""),Le(""),Ve(!1),Nt(""),$t(""),Ie({})},lr=a.filter(x=>pe.has(x.id)),ir=()=>it(!0),ar=()=>{const P=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${lr.map(v=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${v.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(v.gmsoaNo).replace(/^SOA/i,"")}-${v.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${v.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${v.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${v.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${v.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${v.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${v.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,g=document.createElement("iframe");g.style.position="fixed",g.style.right="0",g.style.bottom="0",g.style.width="0",g.style.height="0",g.style.border="0",document.body.appendChild(g);const m=g.contentDocument||g.contentWindow?.document;m&&(m.open(),m.write(P),m.close(),setTimeout(()=>{g.contentWindow?.focus(),g.contentWindow?.print(),setTimeout(()=>document.body.removeChild(g),500)},300))},V=x=>x.id,ae=d.useMemo(()=>{const x=bt.filter(P=>pe.has(V(P)));return{count:x.length,qty:x.reduce((P,g)=>P+(g.totalQty||g.qty||0),0),qtyExe:x.reduce((P,g)=>P+(g.qtyExe||0),0),qtyPending:x.reduce((P,g)=>P+(g.qtyPending||0),0)}},[pe,bt]),J=()=>{const x=q===!0,P=re===!0,g=pe.size>0;if(!x&&!P&&!g)return;const m=g?bt.filter(v=>pe.has(V(v))):bt;if(!m.length){alert("No data available to export");return}de(m)},K=()=>{const x=c&&c.length>0?c:a;if(!x||x.length===0){alert("No data available to export");return}de(x)},de=x=>{const P=x.map((N,A)=>({No:A+1,"Assembly Line":N.assemblyLine,"GMSOA No":N.gmsoaNo,"SOA Sr No":N.soaSrNo,"Assembly Date":N.assemblyDate,"Unique Code":N.uniqueCode,"Splitted Code":N.splittedCode||"-",Party:N.party,"Customer PO No":N.customerPoNo,"Code No":N.codeNo,Product:N.product,"PO Qty":N.poQty,Qty:N.qty,"Qty Executed":N.qtyExe,"Qty Pending":N.qtyPending,"Finished Valve":N.finishedValve,"GM Logo":N.gmLogo,"Name Plate":N.namePlate,"Special Notes":N.specialNotes||"","Product Special 1":N.productSpcl1,"Product Special 2":N.productSpcl2,"Product Special 3":N.productSpcl3,Inspection:N.inspection,Painting:N.painting,Remarks:N.remarks||""})),g=Gt.json_to_sheet(P),m=Gt.book_new();Gt.book_append_sheet(m,g,"Orders");const v=Jr(m,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([v],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},oe=x=>{Ge(x),mt(!0)},_e=x=>{It(x),St(x.remarks||""),et(!0)},Be=async()=>{if(!He)return;const x=new FormData;x.append("orderId",String(He.id)),x.append("remarks",yt);try{const P=await xt.post(`${qt}/add-remarks`,x,{headers:{Authorization:`Bearer ${vt}`}});if(console.log("Add Remarks Response:",P.data),P.data?.Resp_code==="true"||P.data?.Resp_code===!0){l(m=>m.map(v=>v.id===He.id?{...v,remarks:yt}:v));try{t(He.id,yt)}catch{}et(!1),It(null),St("")}else console.warn("Backend rejected remarks:",P.data)}catch(P){console.error("Error saving remarks:",P)}},Ae=x=>[...x].sort((P,g)=>(P.originalIndex??0)-(g.originalIndex??0)),[Ne,je]=d.useState(null),[Me,We]=d.useState(!1),ge=x=>{const P=(x||"").toLowerCase();return P.includes("assembly a")||P.trim()==="a"?"assembly-a":P.includes("assembly b")||P.trim()==="b"?"assembly-b":P.includes("assembly c")||P.trim()==="c"?"assembly-c":P.includes("assembly d")||P.trim()==="d"?"assembly-d":"assembly-a"},W=async()=>{if(!Me&&(We(!0),!!z&&rr())){je({type:"info",message:"Assigning order, please wait..."});try{const x=localStorage.getItem("token");if(!x){je({type:"error",message:"Token missing. Please log in again."});return}const g=nt("phosphating"),m=Number(Ce||0),v=Number(lt||0),N=wr(Ut);let A=ve||(Array.isArray(N)&&N.length>0?N[0]:"");const R=String(z?.assemblyLine||"").trim().toUpperCase().charAt(0),D={A:"Assembly A",B:"Assembly B",C:"Assembly C",D:"Assembly D"};if(D[R]&&(A=D[R]),!A){je({type:"error",message:"Next step not found."});return}const Te=new FormData;Te.append("orderId",String(z.id)),Te.append("totalQty",String(z.totalQty??z.qty??0)),Te.append("executedQty",String(m)),Te.append("currentSteps",g),Te.append("nextSteps",A),Te.append("split_id",String(z.split_id||"")),console.log(" MAIN PAYLOAD:",Object.fromEntries(Te.entries()));const rt=await xt.post(`${qt}/assign-order`,Te,{headers:{Authorization:`Bearer ${x}`}});if(!(rt.data?.Resp_code==="true"||rt.data?.Resp_code===!0)){je({type:"error",message:rt.data?.Resp_desc||"Main assignment failed."});return}let ie=` Assigned ${m}  ${A}`;if(De&&v>0){const Je=new FormData;Je.append("orderId",String(z.id)),Je.append("totalQty",String(z.totalQty??z.qty??0)),Je.append("executedQty",String(v)),Je.append("currentSteps",g),Je.append("nextSteps",A),Je.append("split_id",String(z.split_id||"")),await xt.post(`${qt}/assign-order`,Je,{headers:{Authorization:`Bearer ${x}`}}),ie+=`
 Split ${v}  ${A}`}je({type:"success",message:ie});const Oe=Je=>Je.splittedCode||Je.split_id?Je.splittedCode||Je.split_id:[Je.uniqueCode,Je.soaSrNo,Je.gmsoaNo,Je.codeNo,Je.assemblyLine].map(ft=>ft??"").join("|"),Se=Oe(z);l(Je=>Je.filter(ft=>Oe(ft)!==Se)),se(Je=>{const ft=new Set(Je);return ft.delete(Se),ft}),setTimeout(()=>{ue(!1),je(null)},1e3)}catch(x){console.error(" Error assigning order:",x),console.error(" Backend Response:",x?.response?.data),je({type:"error",message:x?.response?.data?.message||"Server error while assigning."})}finally{We(!1)}}},T=()=>{le("all"),he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:x=>{window.location.href=`/${x.toLowerCase()}`},onUploadSuccess:()=>Bt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"After Phosphating QC"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:ir,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{disabled:bt.length===0,onClick:J,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:K,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:Qt,onClearFilters:T,hasActiveFilters:G!=="all"||Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(At),onClick:er,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${At?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(x=>x==="asc"?"desc":x==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:gt.map((x,P)=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:pe.has(x.id),onCheckedChange:()=>Pt(x.id)})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:x.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:x.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:x.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:x.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:x.party,children:$e(x.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:x.product,children:x.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:x.specialNotes,children:x.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:x.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:x.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${x.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>_e(x),children:e.jsx(is,{className:`h-4 w-4 ${x.remarks?.trim()?"text-white":"text-blue-600"}`})}),x.remarks?.trim()&&e.jsx("div",{className:`\r
                                                      absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                      hidden group-hover:block\r
                                                      bg-gray-900 text-white text-xs\r
                                                      px-3 py-2 rounded-md shadow-lg\r
                                                      max-w-[260px] break-words z-[999]\r
                                                    `,children:x.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>oe(x),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>zt(x),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${x.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${x.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},V(x)))})]}),bt.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),ae.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:ae.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:ae.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:ae.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:ae.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:bt.length,lastPage:Math.max(1,Math.ceil(bt.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:U,onOpenChange:ue,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:ge(String(z?.assemblyLine||"")),onValueChange:()=>{},children:[e.jsx(ss,{id:"assignStep",disabled:!0,children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:e.jsx(Pr,{value:ge(String(z?.assemblyLine||"")),children:nt(ge(String(z?.assemblyLine||"")))})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Ce,onChange:x=>Le(x.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),Ne&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Ne.type==="success"?"bg-green-50 text-green-700 border border-green-200":Ne.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Ne.message.split(`
`).map((x,P)=>e.jsx("div",{children:x},P))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:nr,disabled:Me,children:"Cancel"}),e.jsx(ee,{onClick:W,disabled:Me,className:"bg-black hover:bg-gray-800 text-white",children:Me?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:ut,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:lr.map(x=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",x.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(x.gmsoaNo).replace(/^SOA/i,""),"-",x.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",x.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:x.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:x.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",x.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",x.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:x.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},x.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(ee,{onClick:ar,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:jt,onOpenChange:mt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>mt(!1),children:"Close"})})]})}),e.jsx(Ot,{open:ot,onOpenChange:et,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:yt,onChange:x=>St(x.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>et(!1),children:"Cancel"}),e.jsx(ee,{onClick:Be,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function af(){const t=d.useRef(null),{updateRemark:r,toggleAlertStatus:s,getRemark:n,getAlertStatus:a}=gs(),[l,c]=d.useState([]),[u,f]=d.useState(null),[h,y]=d.useState(!1),[w,j]=d.useState(null),[C,k]=d.useState(1),[S,_]=d.useState(100),[I,F]=d.useState(""),[B,q]=d.useState(!1),[me,re]=d.useState(!1),[M,G]=d.useState("all"),[le,Z]=d.useState("all"),[he,ce]=d.useState("all"),[ke,Ee]=d.useState("range"),[Fe,X]=d.useState(void 0),[ye,Q]=d.useState(void 0),we=En(),[pe,se]=d.useState(null),[U,ue]=d.useState(new Set),[z,ne]=d.useState(!1),[ve,fe]=d.useState(null),[Ce,Le]=d.useState(""),[De,Ve]=d.useState(""),[tt,Nt]=d.useState(!1),[lt,$t]=d.useState(""),[qe,Ie]=d.useState(""),[ut,it]=d.useState({}),[jt,mt]=d.useState(!1),[xe,Ge]=d.useState(!1),[ot,et]=d.useState(null),[He,It]=d.useState(!1),[yt,St]=d.useState(null),[ct,Yt]=d.useState(""),[te,Ze]=d.useState(null),[at,Ke]=d.useState(!1),[kt,vt]=d.useState(null);d.useRef(null);const Bt=d.useRef(null),Et=localStorage.getItem("token"),Qt=async()=>{try{y(!0),j(null);const v=nt("assembly-a"),A=(()=>{try{const rt=localStorage.getItem("user");if(!rt)return"";const Y=JSON.parse(rt),ie=typeof Y.role=="object"?Y.role?.name:Y.role;return String(ie||"").toLowerCase()}catch{return""}})().includes("admin"),R={menu_name:v},D=await xt.post(`${qt}/order-list`,R,{headers:{Authorization:`Bearer ${Et}`}});if((D?.data?.Resp_code==="true"||D?.data?.Resp_code===!0||D?.data?.Resp_code==="RCS")&&Array.isArray(D.data.data)){const rt=D.data.data.map(Y=>({id:String(Y.id),assemblyLine:Y.assembly_no||"",gmsoaNo:Y.soa_no||"",soaSrNo:Y.soa_sr_no||"",assemblyDate:Y.assembly_date||"",uniqueCode:Y.unique_code||Y.order_no||"",splittedCode:Y.splitted_code||"",split_id:Y.split_id||Y.splitted_code||"",party:Y.party_name||Y.party||"",customerPoNo:Y.customer_po_no||"",codeNo:Y.code_no||"",product:Y.product||"",qty:Number(Y.qty||0),totalQty:Number(Y.totalQty||Y.total_qty||Y.qty||0),qtyExe:Number(Y.qty_executed||0),qtyPending:Number(Y.qty_pending||0),finishedValve:Y.finished_valve||"",gmLogo:Y.gm_logo||"",namePlate:Y.name_plate||"",specialNotes:Y.special_notes||Y.special_note||"",productSpcl1:Y.product_spc1||"",productSpcl2:Y.product_spc2||"",productSpcl3:Y.product_spc3||"",inspection:Y.inspection||"",painting:Y.painting||"",remarks:Y.remarks||"",alertStatus:Y.is_urgent===!0||Y.is_urgent==="true"||Y.alert_status===!0||Y.alert_status==="true"||Y.urgent===1||Y.urgent==="1"}));console.log(" Orders fetched:",rt.length,"records"),c(We(rt)),f(null),j(null),vt(null)}else console.warn(" No valid order data received",D.data),c([]),j(D?.data?.Resp_desc||"Failed to fetch orders")}catch(m){console.error("Error fetching orders:",m),j("Error fetching order list. Please check your token or server.")}finally{y(!1)}},Ct=d.useMemo(()=>I.trim().length>0||(M!=="all"||le!=="all"||he!=="all")||(!!Fe||!!ye)||B||me,[I,M,le,he,Fe,ye,B,me]);d.useEffect(()=>{Ct||Qt()},[C,S,Ct]);const bt=d.useMemo(()=>Array.from(new Set(l.map(m=>m.assemblyLine))).filter(Boolean).sort(),[l]);d.useMemo(()=>Array.from(new Set(l.map(m=>m.gmsoaNo))).filter(Boolean).sort(),[l]),d.useMemo(()=>Array.from(new Set(l.map(m=>m.party))).filter(Boolean).sort(),[l]);const $e=m=>{const v=parseInt(m,10);return isNaN(v)?0:v},gt=d.useMemo(()=>{let m=l.slice();if(B&&(m=m.filter(v=>a(String(v.id))||v.alertStatus)),me&&(m=m.filter(v=>typeof v.remarks=="string"&&v.remarks.trim().length>0)),M!=="all"){const v=M.startsWith("assembly-")?M.split("-")[1].toUpperCase():M.toUpperCase();m=m.filter(N=>{const A=String(N.assemblyLine||"").toUpperCase();return A===v||A.includes(v)})}if(le!=="all"&&(m=m.filter(v=>v.gmsoaNo===le)),he!=="all"&&(m=m.filter(v=>v.party===he)),(Fe||ye)&&(m=m.filter(v=>{if(!v.assemblyDate||v.assemblyDate==="HOLD")return!1;const A=v.assemblyDate.split(/[\/-]/).map(D=>D.trim()).map(D=>Number(D));if(A.some(D=>isNaN(D)))return!1;let R=null;if(A.length>=3){const[D,Te,rt]=A;R=new Date(rt,Te-1,D)}else if(A.length===2){const[D,Te]=A;R=new Date(Te,D-1,1)}else if(A.length===1){const[D]=A;R=new Date(D,0,1)}else return!1;if(!R||isNaN(R.getTime()))return!1;if(ke==="year"&&Fe)return R.getFullYear()===Fe.getFullYear();if(ke==="month"&&Fe)return R.getFullYear()===Fe.getFullYear()&&R.getMonth()===Fe.getMonth();if(ke==="range"){if(Fe&&ye)return R>=Fe&&R<=ye;if(Fe)return R>=Fe;if(ye)return R<=ye}return!0})),I.trim()){const v=I.toLowerCase();m=m.filter(N=>String(N.uniqueCode).toLowerCase().includes(v)||String(N.party).toLowerCase().includes(v)||String(N.gmsoaNo).toLowerCase().includes(v)||String(N.customerPoNo).toLowerCase().includes(v)||String(N.codeNo).toLowerCase().includes(v)||String(N.product).toLowerCase().includes(v))}return pe&&(m=[...m].sort((v,N)=>{const A=$e(v.soaSrNo),R=$e(N.soaSrNo);return pe==="asc"?A-R:R-A})),m},[l,I,B,me,M,le,he,ke,Fe,ye,pe,a]),Pt=(m="",v=4)=>{const N=m.trim().split(/\s+/);return N.length<=v?m:N.slice(0,v).join(" ")+"..."},er=d.useMemo(()=>{const m=(C-1)*S;return gt.slice(m,m+S)},[gt,C,S]);d.useEffect(()=>{k(1)},[I,M,le,he,Fe,ye,B,me]);const At=m=>{ue(v=>{const N=new Set(v);return N.has(m)?N.delete(m):N.add(m),N})},Ut=()=>{ue(m=>{if(m.size===gt.length)return new Set;const v=gt.map(N=>N.splittedCode||N.split_id||N.uniqueCode||N.id);return new Set(v)})},Vt=gt.length>0&&U.size===gt.length,zt="assembly-a",rr=wr(zt),nr=(ve?.assemblyLine||"").toUpperCase().includes("D"),lr=rr.filter(m=>m==="testing1"||m==="testing2"?nr?m==="testing2":m==="testing1":!0);console.log("Next step(s):",rr.map(nt)),console.log("Is final step?",hn(zt));const ir=m=>{const N=wr("assembly-a");fe(m),ne(!0);const A=(m.assemblyLine||"").toUpperCase().includes("D"),R=N.filter(D=>D==="testing1"||D==="testing2"?A?D==="testing2":D==="testing1":!0);Le(R[0]||N[0]||""),Ve(String(m.qtyPending??m.qty??0)),W(null),x(!1),Nt(!1),$t(""),Ie(""),it({})},ar=()=>{const m={},v=Number(ve?.qtyPending??0),N=Number(De||0),A=Number(qe||0);if(Ce||(m.quickAssignStep="Please select a workflow step."),(!De||N<=0)&&(m.quickAssignQty="Quantity must be greater than 0."),N>v&&(m.quickAssignQty=`Cannot exceed available (${v})`),tt){lt||(m.splitAssignStep="Choose split step."),(!qe||A<=0)&&(m.splitAssignQty="Split quantity is required."),Ce===lt&&(m.sameEngineer="Split step cannot be the same as main step.");const R=N+A;R!==v&&(m.totalQtyMismatch=`Total quantity (${R}) must equal available (${v}).`)}return it(m),Object.keys(m).length===0},V=()=>{t.current&&(t.current.abort(),t.current=null),x(!1),W(null),ne(!1),fe(null),Le(""),Ve(""),Nt(!1),$t(""),Ie(""),it({})},ae=l.filter(m=>U.has(m.splittedCode||m.split_id||m.uniqueCode||m.id)),J=()=>mt(!0),K=()=>{const v=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>

        <style>
          @page {
            size: 130mm 85mm;
            margin: 0;
          }

          html, body {
            width: 130mm;
            height: 85mm;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
          }

          .item-label,
          .party-desc {
          padding-bottom: 2mm;}

          .item-label {
          line-height: 1.8em;}

          .bin-card {
            width: 130mm;
            height: 85mm;
            padding: 6mm;
            box-sizing: border-box;
            page-break-after: always;
          }

        .item-label-description {
        padding-top: 50px;}

          .meta-qty {
          width: 50%;}

          .process-border {
          border-top:1px solid #000;
          border-bottom:1px solid #000;
          padding-top: 1.5mm;
          padding-bottom: 1.5mm;
          }

          .detail-logo {
            padding-bottom: 0.9mm;
          }

          .description {
            padding-bottom: 2mm;
          }

          .content {
            width: 100%;
            height: 100%;
            border: 1.5px solid #000;
            border-radius: 10px;
            padding-top: 2mm;
            padding-bottom: 4mm;
              padding-left: 6mm;
                  padding-right: 6mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
          }

          .meta-item {
            padding-top: 2mm;
          }

          /* RESET DEFAULT P TAG SPACE */
          p {
            margin: 0;
          }

          /* HEADER */
          .company-name {
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1mm;
            
          }

          .assembly-title p {
          border: 1px solid #000;
            display: inline-block;
            padding-top: 1mm;
            padding-bottom: 0.9mm;
            padding-left: 1mm;
            padding-right: 1mm;
          }

          .company-address {
            font-size: 8px;
            font-weight: 400;
            text-align: center;
            line-height: 1.2;
            margin: 0 0 1.2mm;
          }

          .tag-title {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1.5mm;
          }

          .doc-row {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            margin-bottom: 0.5mm; /*  reduced */
          }

          /* ASSEMBLY LINE */
          .title {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            margin-top: 0;       /*  no top gap */
            margin-bottom: 0.5mm;
            //  border: 1px solid #000;
            // display: inline-block;
          }

          .title-line {
            border-bottom: 1px solid #000;
            margin-bottom: 1.5mm;
            margin-top: 0.5mm;
          }

          /* META */
          .meta {
            font-size: 10px;
            line-height: 1.25;
            margin-bottom: 0.8mm;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }

          .meta div {
            margin-bottom: 0.5mm;
          }

          /* ITEM */
          .desc {
            font-size: 9px;
            margin-bottom: 0.8mm;
          }

          .desc p {
          padding-bottom: 0.6mm;}

          .desc span {
            display: block;
            padding-bottom: 0.1mm;
          }

          .desc .label {
            display: block;
            font-size: 10px;
            margin-bottom: 0.8mm;
            margin-top: 0.8mm;
          }

          .desc .text {
            word-break: break-word;
            
          }

          /* QTY */
          .qty-logo {
            font-size: 10px;
            line-height: 1.3;
            margin-bottom: 0.4mm;
            margin-top: 0.8mm;
          }

          /* INSPECTION */
          .inspect {
            margin-top: auto;
            font-size: 10px;
          }

          .inspect-line {
            height: 3mm;
            border-bottom: 1px solid #000;
          }

          .label {
            font-weight: 600;
          }
        </style>
      </head>

      <body>${ae.map(R=>`
        <div class="bin-card">
          <div class="content">

            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>

            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${R.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(R.gmsoaNo).replace(/^SOA/i,"")}-${R.soaSrNo}
                </div>

              </div>
                <div class="title assembly-title">
                  <p>Assembly Line: ${R.assemblyLine}</p>
                </div>
                <div class="meta-item">
                  <p>GMV-L4-F-PRD 01 A</p>
                  <p>(02/10.09.2020)</p>
                </div>
          </div>

            

            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${R.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${R.product}</p>
              </div>
            </div>

            <div class="qty-logo">
            <div class="meta meta-logo">
              <div class="meta-qty"><span class="label">QTY:</span> ${R.qty}</div>
              <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${R.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${R.specialNotes||""}</span></div>
              </div>

            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>

          </div>
        </div>`).join("")}</body>
    </html>`,N=document.createElement("iframe");N.style.position="fixed",N.style.right="0",N.style.bottom="0",N.style.width="0",N.style.height="0",N.style.border="0",document.body.appendChild(N);const A=N.contentDocument||N.contentWindow?.document;A&&(A.open(),A.write(v),A.close(),setTimeout(()=>{N.contentWindow?.focus(),N.contentWindow?.print(),setTimeout(()=>document.body.removeChild(N),500)},300))},de=()=>{const m=B===!0,v=me===!0,N=U.size>0;if(!m&&!v&&!N)return;const A=N?gt.filter(R=>U.has(oe(R))):gt;if(!A.length){alert("No data available to export");return}Ae(A)},oe=m=>m.splittedCode||m.split_id?m.splittedCode||m.split_id:[m.uniqueCode,m.soaSrNo,m.gmsoaNo,m.codeNo,m.assemblyLine].map(v=>v??"").join("|"),_e=d.useMemo(()=>{const m=gt.filter(v=>U.has(oe(v)));return{count:m.length,qty:m.reduce((v,N)=>v+(N.totalQty||N.qty||0),0),qtyExe:m.reduce((v,N)=>v+(N.qtyExe||0),0),qtyPending:m.reduce((v,N)=>v+(N.qtyPending||0),0)}},[U,gt]),Be=()=>{const m=u&&u.length>0?u:l;if(!m||m.length===0){alert("No data available to export");return}Ae(m)},Ae=m=>{const v=m.map((D,Te)=>({No:Te+1,"Assembly Line":D.assemblyLine,"GMSOA No":D.gmsoaNo,"SOA Sr No":D.soaSrNo,"Assembly Date":D.assemblyDate,"Unique Code":D.uniqueCode,"Splitted Code":D.splittedCode||"-",Party:D.party,"Customer PO No":D.customerPoNo,"Code No":D.codeNo,Product:D.product,"PO Qty":D.poQty,Qty:D.qty,"Qty Executed":D.qtyExe,"Qty Pending":D.qtyPending,"Finished Valve":D.finishedValve,"GM Logo":D.gmLogo,"Name Plate":D.namePlate,"Special Notes":D.specialNotes||"","Product Special 1":D.productSpcl1,"Product Special 2":D.productSpcl2,"Product Special 3":D.productSpcl3,Inspection:D.inspection,Painting:D.painting,Remarks:D.remarks||""})),N=Gt.json_to_sheet(v),A=Gt.book_new();Gt.book_append_sheet(A,N,"Orders");const R=Jr(A,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([R],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Ne=m=>{et(m),Ge(!0)},je=m=>{St(m),Yt(m.remarks||""),It(!0)},Me=async()=>{if(!yt)return;const m=new FormData;m.append("orderId",String(yt.id)),m.append("remarks",ct);try{const v=await xt.post(`${qt}/add-remarks`,m,{headers:{Authorization:`Bearer ${Et}`}});if(console.log("Add Remarks Response:",v.data),v.data?.Resp_code==="true"||v.data?.Resp_code===!0){c(A=>A.map(R=>R.id===yt.id?{...R,remarks:ct}:R));try{r(yt.id,ct)}catch{}It(!1),St(null),Yt("")}else console.warn("Backend rejected remarks:",v.data)}catch(v){console.error("Error saving remarks:",v)}},We=m=>[...m].sort((v,N)=>(v.originalIndex??0)-(N.originalIndex??0)),[ge,W]=d.useState(null),[T,x]=d.useState(!1),P=async()=>{if(T||!ve||!ar())return;x(!0);const m=new AbortController;t.current=m,W({type:"info",message:"Assigning order, please wait..."});try{const v=localStorage.getItem("token");if(!v){W({type:"error",message:"Token missing. Please log in again."});return}const N="assembly-a",A=Number(De||0),R=Number(qe||0),D=Ce||(Array.isArray(rr)?rr[0]:"Assembly D"),Te=nt(D),rt=nt(N),Y=new FormData;Y.append("orderId",String(ve.id)),Y.append("totalQty",String(ve.totalQty??ve.qty??0)),Y.append("executedQty",String(A)),Y.append("currentSteps",rt),Y.append("nextSteps",Te),Y.append("split_id",String(ve.split_id||""));const ie=await xt.post(`${qt}/assign-order`,Y,{headers:{Authorization:`Bearer ${v}`},signal:m.signal});if(!(ie.data?.Resp_code==="true"||ie.data?.Resp_code===!0)){W({type:"error",message:ie.data?.Resp_desc||"Main assignment failed."});return}let Se=`Assigned ${A}  ${Te}`;if(tt&&R>0){const Je=new FormData;Je.append("orderId",String(ve.id)),Je.append("totalQty",String(ve.totalQty??ve.qty??0)),Je.append("executedQty",String(R)),Je.append("currentSteps",rt),Je.append("nextSteps",Te),Je.append("split_id",String(ve.split_id||""));const ft=await xt.post(`${qt}/assign-order`,Je,{headers:{Authorization:`Bearer ${v}`},signal:m.signal});ft.data?.Resp_code==="true"||ft.data?.Resp_code===!0?Se+=`
 Split ${R}  ${Te}`:W({type:"error",message:"Main assigned but split failed: "+(ft.data?.Resp_desc||"Unknown error")})}W({type:"success",message:` ${Se}`}),c(Je=>Je.map(ft=>{if(ft.id!==ve.id)return ft;const Ue=ft.qtyExe||0,mr=A+(tt?R:0),en=Ue+mr,Ca=(ft.totalQty??ft.qty)-en;return{...ft,qtyExe:en,qtyPending:Ca}})),await Qt(),setTimeout(()=>{ne(!1),W(null)},1e3)}catch(v){if(v?.name==="CanceledError"||v?.code==="ERR_CANCELED"){console.log(" Assign request cancelled");return}console.error(" Error assigning order:",v),W({type:"error",message:"Server error while assigning."})}finally{x(!1),t.current=null}},g=()=>{Z("all"),ce("all"),Ee("range"),X(void 0),Q(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:m=>{window.location.href=`/${m.toLowerCase()}`},onUploadSuccess:()=>Qt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsxs("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold flex gap-3",children:["Assembly A",e.jsx(ee,{onClick:()=>we("/testing-assembly",{state:{source:"assembly-a"}}),variant:"outline",className:"flex items-center gap-2",children:"Testing-1"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:J,variant:"outline",disabled:U.size===0,className:"flex items-center gap-2",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>q(!B),className:`btn-urgent flex items-center gap-2 ${B?"bg-red-600 text-white":"bg-red-50 text-red-700 btn-urgent"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),B?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>re(!me),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:me?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{onClick:de,disabled:gt.length===0,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:Be,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"assembly-a",assemblyLineFilter:M,setAssemblyLineFilter:G,dateFilterMode:ke,setDateFilterMode:Ee,dateFrom:Fe,setDateFrom:X,dateTo:ye,setDateTo:Q,assemblyLines:bt,onClearFilters:g,hasActiveFilters:le!=="all"||he!=="all"||!!Fe||!!ye})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:Bt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:h&&l.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Vt),onClick:Ut,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Vt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>se(m=>m==="asc"?"desc":m==="desc"?null:"asc"),children:["Sr.No.",pe==="asc"&&" ",pe==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:er.map(m=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:U.has(m.splittedCode||m.split_id||m.uniqueCode||m.id),onCheckedChange:()=>At(m.splittedCode||m.split_id||m.uniqueCode||m.id),"aria-label":`Select row ${m.splittedCode||m.split_id||m.uniqueCode||m.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:m.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:m.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:m.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:m.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:m.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:m.party,children:Pt(m.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:m.product,children:m.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:m.specialNotes,children:m.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:m.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:m.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${m.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>je(m),children:e.jsx(is,{className:`h-4 w-4 ${m.remarks?.trim()?"text-white":"text-blue-600"}`})}),m.remarks?.trim()&&e.jsx("div",{className:`\r
                                  absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                  hidden group-hover:block\r
                                  bg-gray-900 text-white text-xs\r
                                  px-3 py-2 rounded-md shadow-lg\r
                                  max-w-[260px] break-words z-[999]\r
                                `,children:m.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>Ne(m),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ir(m),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${m.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${m.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},m.splittedCode||m.split_id||m.uniqueCode||m.id))})]}),gt.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),_e.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:_e.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:_e.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:_e.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:_e.qtyPending})]})]}),e.jsx(os,{page:C,perPage:S,total:gt.length,lastPage:Math.max(1,Math.ceil(gt.length/Math.max(S,1))),onChangePage:k,onChangePerPage:_,disabled:h}),e.jsx(Ot,{open:z,onOpenChange:m=>{m?ne(!0):V()},children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",ve?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:Ce,onValueChange:Le,disabled:!0,children:[e.jsx(ss,{id:"assignStep",children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:lr.map(m=>e.jsx(Pr,{value:m,children:nt(m)},m))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:De,onChange:m=>{const v=m.target.value;Ve(v);const N=Number(ve?.qtyPending??0),A=Number(v||0);it(R=>{const D={...R};return A>N?D.quickAssignQty=`Cannot exceed available (${N})`:D.quickAssignQty&&delete D.quickAssignQty,D})},max:ve?.qtyPending}),ut.quickAssignQty&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:ut.quickAssignQty})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:ve?.qtyPending})]})]})}),ge&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${ge.type==="success"?"bg-green-50 text-green-700 border border-green-200":ge.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:ge.message.split(`
`).map((m,v)=>e.jsx("div",{children:m},v))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:V,disabled:T,children:"Cancel"}),e.jsx(ee,{onClick:P,disabled:T||!!ut.quickAssignQty,className:"bg-black hover:bg-gray-800 text-white",children:T?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:jt,onOpenChange:mt,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ae.map(m=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",m.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(m.gmsoaNo).replace(/^SOA/i,""),"-",m.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",m.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:m.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:m.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",m.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",m.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:m.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},m.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>mt(!1),children:"Cancel"}),e.jsxs(ee,{onClick:K,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:xe,onOpenChange:Ge,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",ot?.uniqueCode]})]}),ot&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>Ge(!1),children:"Close"})})]})}),e.jsx(Ot,{open:He,onOpenChange:It,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:yt?`Order: ${yt.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:ct,onChange:m=>Yt(m.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>It(!1),children:"Cancel"}),e.jsx(ee,{onClick:Me,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function lf(){const t=d.useRef(null),{updateRemark:r,toggleAlertStatus:s,getRemark:n,getAlertStatus:a}=gs(),[l,c]=d.useState([]),[u,f]=d.useState(null),[h,y]=d.useState(!1),[w,j]=d.useState(null),[C,k]=d.useState(1),[S,_]=d.useState(100),[I,F]=d.useState(null),[B,q]=d.useState(""),[me,re]=d.useState(!1),[M,G]=d.useState(!1),[le,Z]=d.useState("all"),[he,ce]=d.useState("all"),[ke,Ee]=d.useState("all"),[Fe,X]=d.useState("range"),[ye,Q]=d.useState(void 0),[we,pe]=d.useState(void 0),se=En(),[U,ue]=d.useState(new Set),[z,ne]=d.useState(!1),[ve,fe]=d.useState(null),[Ce,Le]=d.useState(""),[De,Ve]=d.useState(""),[tt,Nt]=d.useState(!1),[lt,$t]=d.useState(""),[qe,Ie]=d.useState(""),[ut,it]=d.useState({}),[jt,mt]=d.useState(!1),[xe,Ge]=d.useState(!1),[ot,et]=d.useState(null),[He,It]=d.useState(!1),[yt,St]=d.useState(null),[ct,Yt]=d.useState(""),[te,Ze]=d.useState(null),[at,Ke]=d.useState(!1),[kt,vt]=d.useState(null);d.useRef(null);const Bt=d.useRef(null),Et=localStorage.getItem("token"),Qt=async()=>{try{y(!0),j(null);const v=nt("assembly-b"),A=(()=>{try{const rt=localStorage.getItem("user");if(!rt)return"";const Y=JSON.parse(rt),ie=typeof Y.role=="object"?Y.role?.name:Y.role;return String(ie||"").toLowerCase()}catch{return""}})().includes("admin"),R={menu_name:v},D=await xt.post(`${qt}/order-list`,R,{headers:{Authorization:`Bearer ${Et}`}});if((D?.data?.Resp_code==="true"||D?.data?.Resp_code===!0||D?.data?.Resp_code==="RCS")&&Array.isArray(D.data.data)){const rt=D.data.data.map((Y,ie)=>({id:String(Y.id),assemblyLine:Y.assembly_no||"",gmsoaNo:Y.soa_no||"",soaSrNo:Y.soa_sr_no||"",assemblyDate:Y.assembly_date||"",uniqueCode:Y.unique_code||Y.order_no||"",splittedCode:Y.splitted_code||"",split_id:Y.split_id||Y.splitted_code||"",party:Y.party_name||Y.party||"",customerPoNo:Y.customer_po_no||"",codeNo:Y.code_no||"",product:Y.product||"",qty:Number(Y.qty||0),totalQty:Number(Y.totalQty||Y.total_qty||Y.qty||0),qtyExe:Number(Y.qty_executed||0),qtyPending:Number(Y.qty_pending||0),finishedValve:Y.finished_valve||"",gmLogo:Y.gm_logo||"",namePlate:Y.name_plate||"",specialNotes:Y.special_notes||Y.special_note||"",productSpcl1:Y.product_spc1||"",productSpcl2:Y.product_spc2||"",productSpcl3:Y.product_spc3||"",inspection:Y.inspection||"",painting:Y.painting||"",remarks:Y.remarks||"",alertStatus:Y.is_urgent===!0||Y.is_urgent==="true"||Y.alert_status===!0||Y.alert_status==="true"||Y.urgent===1||Y.urgent==="1",originalIndex:ie}));console.log(" Orders fetched:",rt.length,"records"),c(We(rt)),f(null),j(null),vt(null)}else console.warn(" No valid order data received",D.data),c([]),j(D?.data?.Resp_desc||"Failed to fetch orders")}catch(m){console.error("Error fetching orders:",m),j("Error fetching order list. Please check your token or server.")}finally{y(!1)}},Ct=d.useMemo(()=>B.trim().length>0||(le!=="all"||he!=="all"||ke!=="all")||(!!ye||!!we)||me||M,[B,le,he,ke,ye,we,me,M]);d.useEffect(()=>{Ct||Qt()},[C,S,Ct]);const bt=d.useMemo(()=>Array.from(new Set(l.map(m=>m.assemblyLine))).filter(Boolean).sort(),[l]);d.useMemo(()=>Array.from(new Set(l.map(m=>m.gmsoaNo))).filter(Boolean).sort(),[l]),d.useMemo(()=>Array.from(new Set(l.map(m=>m.party))).filter(Boolean).sort(),[l]);const $e=m=>{const v=parseInt(m,10);return isNaN(v)?0:v},gt=d.useMemo(()=>{let m=l.slice();if(me&&(m=m.filter(v=>a(String(v.id))||v.alertStatus)),M&&(m=m.filter(v=>typeof v.remarks=="string"&&v.remarks.trim().length>0)),le!=="all"){const v=le.startsWith("assembly-")?le.split("-")[1].toUpperCase():le.toUpperCase();m=m.filter(N=>{const A=String(N.assemblyLine||"").toUpperCase();return A===v||A.includes(v)})}if(he!=="all"&&(m=m.filter(v=>v.gmsoaNo===he)),ke!=="all"&&(m=m.filter(v=>v.party===ke)),(ye||we)&&(m=m.filter(v=>{if(!v.assemblyDate||v.assemblyDate==="HOLD")return!1;const A=v.assemblyDate.split(/[\/-]/).map(D=>D.trim()).map(D=>Number(D));if(A.some(D=>isNaN(D)))return!1;let R=null;if(A.length>=3){const[D,Te,rt]=A;R=new Date(rt,Te-1,D)}else if(A.length===2){const[D,Te]=A;R=new Date(Te,D-1,1)}else if(A.length===1){const[D]=A;R=new Date(D,0,1)}else return!1;if(!R||isNaN(R.getTime()))return!1;if(Fe==="year"&&ye)return R.getFullYear()===ye.getFullYear();if(Fe==="month"&&ye)return R.getFullYear()===ye.getFullYear()&&R.getMonth()===ye.getMonth();if(Fe==="range"){if(ye&&we)return R>=ye&&R<=we;if(ye)return R>=ye;if(we)return R<=we}return!0})),B.trim()){const v=B.toLowerCase();m=m.filter(N=>String(N.uniqueCode).toLowerCase().includes(v)||String(N.party).toLowerCase().includes(v)||String(N.gmsoaNo).toLowerCase().includes(v)||String(N.customerPoNo).toLowerCase().includes(v)||String(N.codeNo).toLowerCase().includes(v)||String(N.product).toLowerCase().includes(v))}return I&&(m=[...m].sort((v,N)=>{const A=$e(v.soaSrNo),R=$e(N.soaSrNo);return I==="asc"?A-R:R-A})),m},[l,B,me,M,le,he,ke,Fe,ye,we,a,I]),Pt=(m="",v=4)=>{const N=m.trim().split(/\s+/);return N.length<=v?m:N.slice(0,v).join(" ")+"..."},er=d.useMemo(()=>{const m=(C-1)*S;return gt.slice(m,m+S)},[gt,C,S]);d.useEffect(()=>{k(1)},[B,le,he,ke,ye,we,me,M]);const At=m=>{ue(v=>{const N=new Set(v);return N.has(m)?N.delete(m):N.add(m),N})},Ut=()=>{ue(m=>{if(m.size===gt.length)return new Set;const v=gt.map(N=>N.splittedCode||N.split_id||N.uniqueCode||N.id);return new Set(v)})},Vt=gt.length>0&&U.size===gt.length,zt="assembly-b",rr=wr(zt),nr=(ve?.assemblyLine||"").toUpperCase().includes("D"),lr=rr.filter(m=>m==="testing1"||m==="testing2"?nr?m==="testing2":m==="testing1":!0);console.log("Next step(s):",rr.map(nt)),console.log("Is final step?",hn(zt));const ir=m=>{const N=wr("assembly-b");fe(m),ne(!0);const A=(m.assemblyLine||"").toUpperCase().includes("D"),R=N.filter(D=>D==="testing1"||D==="testing2"?A?D==="testing2":D==="testing1":!0);Le(R[0]||N[0]||""),Ve(String(m.qtyPending??m.qty??0)),W(null),x(!1),Nt(!1),$t(""),Ie(""),it({})},ar=()=>{const m={},v=Number(ve?.qtyPending??0),N=Number(De||0),A=Number(qe||0);if(Ce||(m.quickAssignStep="Please select a workflow step."),(!De||N<=0)&&(m.quickAssignQty="Quantity must be greater than 0."),N>v&&(m.quickAssignQty=`Cannot exceed available (${v})`),tt){lt||(m.splitAssignStep="Choose split step."),(!qe||A<=0)&&(m.splitAssignQty="Split quantity is required."),Ce===lt&&(m.sameEngineer="Split step cannot be the same as main step.");const R=N+A;R!==v&&(m.totalQtyMismatch=`Total quantity (${R}) must equal available (${v}).`)}return it(m),Object.keys(m).length===0},V=()=>{t.current&&(t.current.abort(),t.current=null),x(!1),W(null),ne(!1),fe(null),Le(""),Ve(""),Nt(!1),$t(""),Ie(""),it({})},ae=l.filter(m=>U.has(m.splittedCode||m.split_id||m.uniqueCode||m.id)),J=()=>mt(!0),K=()=>{const v=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>

        <style>
          @page {
            size: 130mm 85mm;
            margin: 0;
          }

          html, body {
            width: 130mm;
            height: 85mm;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
          }

          .item-label,
          .party-desc {
          padding-bottom: 2mm;}

          .item-label {
          line-height: 1.8em;}

          .bin-card {
            width: 130mm;
            height: 85mm;
            padding: 6mm;
            box-sizing: border-box;
            page-break-after: always;
          }

        .item-label-description {
        padding-top: 50px;}

          .meta-qty {
          width: 50%;}

          .process-border {
          border-top:1px solid #000;
          border-bottom:1px solid #000;
          padding-top: 1.5mm;
          padding-bottom: 1.5mm;
          }

          .detail-logo {
            padding-bottom: 0.9mm;
          }

          .description {
            padding-bottom: 2mm;
          }

          .content {
            width: 100%;
            height: 100%;
            border: 1.5px solid #000;
            border-radius: 10px;
            padding-top: 2mm;
            padding-bottom: 4mm;
              padding-left: 6mm;
                  padding-right: 6mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
          }

          .meta-item {
            padding-top: 2mm;
          }

          /* RESET DEFAULT P TAG SPACE */
          p {
            margin: 0;
          }

          /* HEADER */
          .company-name {
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1mm;
            
          }

          .assembly-title p {
          border: 1px solid #000;
            display: inline-block;
            padding-top: 1mm;
            padding-bottom: 0.9mm;
            padding-left: 1mm;
            padding-right: 1mm;
          }

          .company-address {
            font-size: 8px;
            font-weight: 400;
            text-align: center;
            line-height: 1.2;
            margin: 0 0 1.2mm;
          }

          .tag-title {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1.5mm;
          }

          .doc-row {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            margin-bottom: 0.5mm; /*  reduced */
          }

          /* ASSEMBLY LINE */
          .title {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            margin-top: 0;       /*  no top gap */
            margin-bottom: 0.5mm;
            //  border: 1px solid #000;
            // display: inline-block;
          }

          .title-line {
            border-bottom: 1px solid #000;
            margin-bottom: 1.5mm;
            margin-top: 0.5mm;
          }

          /* META */
          .meta {
            font-size: 10px;
            line-height: 1.25;
            margin-bottom: 0.8mm;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }

          .meta div {
            margin-bottom: 0.5mm;
          }

          /* ITEM */
          .desc {
            font-size: 9px;
            margin-bottom: 0.8mm;
          }

          .desc p {
          padding-bottom: 0.6mm;}

          .desc span {
            display: block;
            padding-bottom: 0.1mm;
          }

          .desc .label {
            display: block;
            font-size: 10px;
            margin-bottom: 0.8mm;
            margin-top: 0.8mm;
          }

          .desc .text {
            word-break: break-word;
            
          }

          /* QTY */
          .qty-logo {
            font-size: 10px;
            line-height: 1.3;
            margin-bottom: 0.4mm;
            margin-top: 0.8mm;
          }

          /* INSPECTION */
          .inspect {
            margin-top: auto;
            font-size: 10px;
          }

          .inspect-line {
            height: 3mm;
            border-bottom: 1px solid #000;
          }

          .label {
            font-weight: 600;
          }
        </style>
      </head>

      <body>${ae.map(R=>`
        <div class="bin-card">
          <div class="content">

            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>

            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${R.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(R.gmsoaNo).replace(/^SOA/i,"")}-${R.soaSrNo}
                </div>

              </div>
                <div class="title assembly-title">
                  <p>Assembly Line: ${R.assemblyLine}</p>
                </div>
                <div class="meta-item">
                  <p>GMV-L4-F-PRD 01 A</p>
                  <p>(02/10.09.2020)</p>
                </div>
          </div>

            

            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${R.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${R.product}</p>
              </div>
            </div>

            <div class="qty-logo">
            <div class="meta meta-logo">
              <div class="meta-qty"><span class="label">QTY:</span> ${R.qty}</div>
              <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${R.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${R.specialNotes||""}</span></div>
              </div>

            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>

          </div>
        </div>`).join("")}</body>
    </html>`,N=document.createElement("iframe");N.style.position="fixed",N.style.right="0",N.style.bottom="0",N.style.width="0",N.style.height="0",N.style.border="0",document.body.appendChild(N);const A=N.contentDocument||N.contentWindow?.document;A&&(A.open(),A.write(v),A.close(),setTimeout(()=>{N.contentWindow?.focus(),N.contentWindow?.print(),setTimeout(()=>document.body.removeChild(N),500)},300))},de=m=>{et(m),Ge(!0)},oe=m=>m.splittedCode||m.split_id?m.splittedCode||m.split_id:[m.uniqueCode,m.soaSrNo,m.gmsoaNo,m.codeNo,m.assemblyLine].map(v=>v??"").join("|"),_e=d.useMemo(()=>{const m=gt.filter(v=>U.has(oe(v)));return{count:m.length,qty:m.reduce((v,N)=>v+(N.totalQty||N.qty||0),0),qtyExe:m.reduce((v,N)=>v+(N.qtyExe||0),0),qtyPending:m.reduce((v,N)=>v+(N.qtyPending||0),0)}},[U,gt]),Be=()=>{const m=me===!0,v=M===!0,N=U.size>0;if(!m&&!v&&!N)return;const A=N?gt.filter(R=>U.has(oe(R))):gt;if(!A.length){alert("No data available to export");return}Ne(A)},Ae=()=>{const m=u&&u.length>0?u:l;if(!m||m.length===0){alert("No data available to export");return}Ne(m)},Ne=m=>{const v=m.map((D,Te)=>({No:Te+1,"Assembly Line":D.assemblyLine,"GMSOA No":D.gmsoaNo,"SOA Sr No":D.soaSrNo,"Assembly Date":D.assemblyDate,"Unique Code":D.uniqueCode,"Splitted Code":D.splittedCode||"-",Party:D.party,"Customer PO No":D.customerPoNo,"Code No":D.codeNo,Product:D.product,"PO Qty":D.poQty,Qty:D.qty,"Qty Executed":D.qtyExe,"Qty Pending":D.qtyPending,"Finished Valve":D.finishedValve,"GM Logo":D.gmLogo,"Name Plate":D.namePlate,"Special Notes":D.specialNotes||"","Product Special 1":D.productSpcl1,"Product Special 2":D.productSpcl2,"Product Special 3":D.productSpcl3,Inspection:D.inspection,Painting:D.painting,Remarks:D.remarks||""})),N=Gt.json_to_sheet(v),A=Gt.book_new();Gt.book_append_sheet(A,N,"Orders");const R=Jr(A,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([R],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},je=m=>{St(m),Yt(m.remarks||""),It(!0)},Me=async()=>{if(!yt)return;const m=new FormData;m.append("orderId",String(yt.id)),m.append("remarks",ct);try{const v=await xt.post(`${qt}/add-remarks`,m,{headers:{Authorization:`Bearer ${Et}`}});if(console.log("Add Remarks Response:",v.data),v.data?.Resp_code==="true"||v.data?.Resp_code===!0){c(A=>A.map(R=>R.id===yt.id?{...R,remarks:ct}:R));try{r(yt.id,ct)}catch{}It(!1),St(null),Yt("")}else console.warn("Backend rejected remarks:",v.data)}catch(v){console.error("Error saving remarks:",v)}},We=m=>[...m].sort((v,N)=>(v.originalIndex??0)-(N.originalIndex??0)),[ge,W]=d.useState(null),[T,x]=d.useState(!1),P=async()=>{if(T||!ve||!ar())return;x(!0);const m=new AbortController;t.current=m,W({type:"info",message:"Assigning order, please wait..."});try{const v=localStorage.getItem("token");if(!v){W({type:"error",message:"Token missing. Please log in again."});return}const N="assembly-b",A=Number(De||0),R=Number(qe||0),D=Ce||(Array.isArray(rr)?rr[0]:"Assembly D"),Te=nt(D),rt=nt(N),Y=new FormData;Y.append("orderId",String(ve.id)),Y.append("totalQty",String(ve.totalQty??ve.qty??0)),Y.append("executedQty",String(A)),Y.append("currentSteps",rt),Y.append("nextSteps",Te),Y.append("split_id",String(ve.split_id||""));const ie=await xt.post(`${qt}/assign-order`,Y,{headers:{Authorization:`Bearer ${v}`},signal:m.signal});if(!(ie.data?.Resp_code==="true"||ie.data?.Resp_code===!0)){W({type:"error",message:ie.data?.Resp_desc||"Main assignment failed."});return}let Se=`Assigned ${A}  ${Te}`;if(tt&&R>0){const Je=new FormData;Je.append("orderId",String(ve.id)),Je.append("totalQty",String(ve.totalQty??ve.qty??0)),Je.append("executedQty",String(R)),Je.append("currentSteps",rt),Je.append("nextSteps",Te),Je.append("split_id",String(ve.split_id||""));const ft=await xt.post(`${qt}/assign-order`,Je,{headers:{Authorization:`Bearer ${v}`},signal:m.signal});ft.data?.Resp_code==="true"||ft.data?.Resp_code===!0?Se+=`
 Split ${R}  ${Te}`:W({type:"error",message:"Main assigned but split failed: "+(ft.data?.Resp_desc||"Unknown error")})}W({type:"success",message:` ${Se}`}),c(Je=>Je.map(ft=>{if(ft.id!==ve.id)return ft;const Ue=ft.qtyExe||0,mr=A+(tt?R:0),en=Ue+mr,Ca=(ft.totalQty??ft.qty)-en;return{...ft,qtyExe:en,qtyPending:Ca}})),await Qt(),setTimeout(()=>{ne(!1),W(null),ue(new Set)},1e3)}catch(v){if(v?.name==="CanceledError"||v?.code==="ERR_CANCELED"){console.log(" Assign request cancelled");return}console.error(" Error assigning order:",v),W({type:"error",message:"Server error while assigning."})}finally{x(!1),t.current=null}},g=()=>{ce("all"),Ee("all"),X("range"),Q(void 0),pe(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"assembly-b",currentPage:"Assembly-B",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:m=>{const v=m.toLowerCase().replace(/\s+/g,"-");window.location.href=`/${v}`},onUploadSuccess:()=>Qt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4 ",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsxs("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold flex gap-3",children:["Assembly B",e.jsx(ee,{onClick:()=>se("/testing-assembly",{state:{source:"assembly-b"}}),variant:"outline",className:"flex items-center gap-2",children:"Testing-1"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:J,variant:"outline",disabled:U.size===0,className:"flex items-center gap-2",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>re(!me),className:`btn-urgent flex items-center gap-2 ${me?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),me?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>G(!M),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:M?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{disabled:gt.length===0,onClick:Be,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:Ae,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"assembly-b",searchTerm:B,setSearchTerm:q,assemblyLineFilter:le,setAssemblyLineFilter:Z,dateFilterMode:Fe,setDateFilterMode:X,dateFrom:ye,setDateFrom:Q,dateTo:we,setDateTo:pe,assemblyLines:bt,onClearFilters:g,hasActiveFilters:he!=="all"||ke!=="all"||!!ye||!!we})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:Bt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:h&&l.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Vt),onClick:Ut,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Vt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>F(m=>m==="asc"?"desc":m==="desc"?null:"asc"),children:["Sr.No.",I==="asc"&&" ",I==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:er.map(m=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:U.has(m.splittedCode||m.split_id||m.uniqueCode||m.id),onCheckedChange:()=>At(m.splittedCode||m.split_id||m.uniqueCode||m.id),"aria-label":`Select row ${m.splittedCode||m.split_id||m.uniqueCode||m.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:m.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:m.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:m.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:m.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:m.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:m.party,children:Pt(m.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:m.product,children:m.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:m.specialNotes,children:m.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:m.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:m.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${m.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>je(m),children:e.jsx(is,{className:`h-4 w-4 ${m.remarks?.trim()?"text-white":"text-blue-600"}`})}),m.remarks?.trim()&&e.jsx("div",{className:`\r
                                                        absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                        hidden group-hover:block\r
                                                        bg-gray-900 text-white text-xs\r
                                                        px-3 py-2 rounded-md shadow-lg\r
                                                        max-w-[260px] break-words z-[999]\r
                                                      `,children:m.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>de(m),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ir(m),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${m.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${m.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},m.splittedCode||m.split_id||m.uniqueCode||m.id))})]}),gt.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),_e.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:_e.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:_e.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:_e.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:_e.qtyPending})]})]}),e.jsx(os,{page:C,perPage:S,total:gt.length,lastPage:Math.max(1,Math.ceil(gt.length/Math.max(S,1))),onChangePage:k,onChangePerPage:_,disabled:h}),e.jsx(Ot,{open:z,onOpenChange:m=>{m?ne(!0):V()},children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",ve?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:Ce,onValueChange:Le,disabled:!0,children:[e.jsx(ss,{id:"assignStep",children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:lr.map(m=>e.jsx(Pr,{value:m,children:nt(m)},m))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:De,onChange:m=>{const v=m.target.value;Ve(v);const N=Number(ve?.qtyPending??0),A=Number(v||0);it(R=>{const D={...R};return A>N?D.quickAssignQty=`Cannot exceed available (${N})`:D.quickAssignQty&&delete D.quickAssignQty,D})},max:ve?.qtyPending}),ut.quickAssignQty&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:ut.quickAssignQty})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:ve?.qtyPending})]})]})}),ge&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${ge.type==="success"?"bg-green-50 text-green-700 border border-green-200":ge.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:ge.message.split(`
`).map((m,v)=>e.jsx("div",{children:m},v))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:V,disabled:T,children:"Cancel"}),e.jsx(ee,{onClick:P,disabled:T||!!ut.quickAssignQty,className:"bg-black hover:bg-gray-800 text-white",children:T?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:jt,onOpenChange:mt,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ae.map(m=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",m.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(m.gmsoaNo).replace(/^SOA/i,""),"-",m.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",m.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:m.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:m.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",m.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",m.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:m.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},m.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>mt(!1),children:"Cancel"}),e.jsxs(ee,{onClick:K,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:xe,onOpenChange:Ge,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",ot?.uniqueCode]})]}),ot&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:ot.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>Ge(!1),children:"Close"})})]})}),e.jsx(Ot,{open:He,onOpenChange:It,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:yt?`Order: ${yt.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:ct,onChange:m=>Yt(m.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>It(!1),children:"Cancel"}),e.jsx(ee,{onClick:Me,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function of(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),pe=En(),[se,U]=d.useState(new Set),[ue,z]=d.useState(!1),[ne,ve]=d.useState(null),[fe,Ce]=d.useState(""),[Le,De]=d.useState(""),[Ve,tt]=d.useState(!1),[Nt,lt]=d.useState(""),[$t,qe]=d.useState(""),[Ie,ut]=d.useState({}),[it,jt]=d.useState(!1),[mt,xe]=d.useState(!1),[Ge,ot]=d.useState(null),[et,He]=d.useState(!1),[It,yt]=d.useState(null),[St,ct]=d.useState(""),[Yt,te]=d.useState(null),[Ze,at]=d.useState(!1),[Ke,kt]=d.useState(null);d.useRef(null);const vt=d.useRef(null),Bt=localStorage.getItem("token"),Et=async()=>{try{h(!0),w(null);const m=nt("assembly-c"),N=(()=>{try{const rt=localStorage.getItem("user");if(!rt)return"";const Y=JSON.parse(rt),ie=typeof Y.role=="object"?Y.role?.name:Y.role;return String(ie||"").toLowerCase()}catch{return""}})().includes("admin"),A={menu_name:m},R=await xt.post(`${qt}/order-list`,A,{headers:{Authorization:`Bearer ${Bt}`}}),D=R?.data?.Resp_code==="true"||R?.data?.Resp_code===!0||R?.data?.Resp_code==="RCS"||R?.status===200,Te=Array.isArray(R?.data?.data)?R.data.data:Array.isArray(R?.data?.orders)?R.data.orders:Array.isArray(R?.data)?R.data:[];if(D&&Array.isArray(Te)){const rt=Te.map((Y,ie)=>({id:String(Y.id),assemblyLine:Y.assembly_no||"",gmsoaNo:Y.soa_no||"",soaSrNo:Y.soa_sr_no||"",assemblyDate:Y.assembly_date||"",uniqueCode:Y.unique_code||Y.order_no||"",splittedCode:Y.splitted_code||"",split_id:Y.split_id||Y.splitted_code||"",party:Y.party_name||Y.party||"",customerPoNo:Y.customer_po_no||"",codeNo:Y.code_no||"",product:Y.product||"",qty:Number(Y.qty||0),totalQty:Number(Y.totalQty||Y.total_qty||Y.qty||0),qtyExe:Number(Y.qty_executed||0),qtyPending:Number(Y.qty_pending||0),finishedValve:Y.finished_valve||"",gmLogo:Y.gm_logo||"",namePlate:Y.name_plate||"",specialNotes:Y.special_notes||Y.special_note||"",productSpcl1:Y.product_spc1||"",productSpcl2:Y.product_spc2||"",productSpcl3:Y.product_spc3||"",inspection:Y.inspection||"",painting:Y.painting||"",remarks:Y.remarks||"",alertStatus:Y.is_urgent===!0||Y.is_urgent==="true"||Y.alert_status===!0||Y.alert_status==="true"||Y.urgent===1||Y.urgent==="1",originalIndex:ie}));console.log(" Orders fetched:",rt.length,"records"),l(Me(rt)),u(null),w(null),kt(null)}else console.warn(" No valid order data received",R.data),l([]),w(R?.data?.Resp_desc||"Failed to fetch orders")}catch(g){console.error("Error fetching orders:",g),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Qt=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{Qt||Et()},[j,k,Qt]);const Ct=d.useMemo(()=>Array.from(new Set(a.map(g=>g.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(g=>g.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(g=>g.party))).filter(Boolean).sort(),[a]);const bt=g=>{const m=parseInt(g,10);return isNaN(m)?0:m},$e=d.useMemo(()=>{let g=a.slice();if(q&&(g=g.filter(m=>n(String(m.id))||m.alertStatus)),re&&(g=g.filter(m=>typeof m.remarks=="string"&&m.remarks.trim().length>0)),G!=="all"){const m=G.startsWith("assembly-")?G.split("-")[1].toUpperCase():G.toUpperCase();g=g.filter(v=>{const N=String(v.assemblyLine||"").toUpperCase();return N===m||N.includes(m)})}if(Z!=="all"&&(g=g.filter(m=>m.gmsoaNo===Z)),ce!=="all"&&(g=g.filter(m=>m.party===ce)),(X||Q)&&(g=g.filter(m=>{if(!m.assemblyDate||m.assemblyDate==="HOLD")return!1;const N=m.assemblyDate.split(/[\/-]/).map(R=>R.trim()).map(R=>Number(R));if(N.some(R=>isNaN(R)))return!1;let A=null;if(N.length>=3){const[R,D,Te]=N;A=new Date(Te,D-1,R)}else if(N.length===2){const[R,D]=N;A=new Date(D,R-1,1)}else if(N.length===1){const[R]=N;A=new Date(R,0,1)}else return!1;if(!A||isNaN(A.getTime()))return!1;if(Ee==="year"&&X)return A.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return A.getFullYear()===X.getFullYear()&&A.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return A>=X&&A<=Q;if(X)return A>=X;if(Q)return A<=Q}return!0})),F.trim()){const m=F.toLowerCase();g=g.filter(v=>String(v.uniqueCode).toLowerCase().includes(m)||String(v.party).toLowerCase().includes(m)||String(v.gmsoaNo).toLowerCase().includes(m)||String(v.customerPoNo).toLowerCase().includes(m)||String(v.codeNo).toLowerCase().includes(m)||String(v.product).toLowerCase().includes(m))}return _&&(g=[...g].sort((m,v)=>{const N=bt(m.soaSrNo),A=bt(v.soaSrNo);return _==="asc"?N-A:A-N})),g},[a,F,q,re,G,Z,ce,Ee,X,Q,n,_]),gt=d.useMemo(()=>{const g=(j-1)*k;return $e.slice(g,g+k)},[$e,j,k]),Pt=(g="",m=4)=>{const v=g.trim().split(/\s+/);return v.length<=m?g:v.slice(0,m).join(" ")+"..."};d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const er=g=>{U(m=>{const v=new Set(m);return v.has(g)?v.delete(g):v.add(g),v})},At=()=>{U(g=>{if(g.size===$e.length)return new Set;const m=$e.map(v=>v.splittedCode||v.split_id||v.uniqueCode||v.id);return new Set(m)})},Ut=$e.length>0&&se.size===$e.length,Vt="assembly-c",zt=wr(Vt),rr=(ne?.assemblyLine||"").toUpperCase().includes("D"),nr=zt.filter(g=>g==="testing1"||g==="testing2"?rr?g==="testing2":g==="testing1":!0);console.log("Next step(s):",zt.map(nt)),console.log("Is final step?",hn(Vt));const lr=g=>{const v=wr("assembly-c");ve(g),z(!0);const N=(g.assemblyLine||"").toUpperCase().includes("D"),A=v.filter(R=>R==="testing1"||R==="testing2"?N?R==="testing2":R==="testing1":!0);Ce(A[0]||v[0]||""),De(String(g.qtyPending??g.qty??0)),ge(null),T(!1),tt(!1),lt(""),qe(""),ut({})},ir=()=>{const g={},m=Number(ne?.qtyPending??0),v=Number(Le||0),N=Number($t||0);if(fe||(g.quickAssignStep="Please select a workflow step."),(!Le||v<=0)&&(g.quickAssignQty="Quantity must be greater than 0."),v>m&&(g.quickAssignQty=`Cannot exceed available (${m})`),Ve){Nt||(g.splitAssignStep="Choose split step."),(!$t||N<=0)&&(g.splitAssignQty="Split quantity is required."),fe===Nt&&(g.sameEngineer="Split step cannot be the same as main step.");const A=v+N;A!==m&&(g.totalQtyMismatch=`Total quantity (${A}) must equal available (${m}).`)}return ut(g),Object.keys(g).length===0},ar=()=>{T(!1),ge(null),z(!1),ve(null),Ce(""),De(""),tt(!1),lt(""),qe(""),ut({})},V=a.filter(g=>se.has(g.splittedCode||g.split_id||g.uniqueCode||g.id)),ae=()=>jt(!0),J=()=>{const m=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>

        <style>
          @page {
            size: 130mm 85mm;
            margin: 0;
          }

          html, body {
            width: 130mm;
            height: 85mm;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
          }

          .item-label,
          .party-desc {
          padding-bottom: 2mm;}

          .item-label {
          line-height: 1.8em;}

          .bin-card {
            width: 130mm;
            height: 85mm;
            padding: 6mm;
            box-sizing: border-box;
            page-break-after: always;
          }

        .item-label-description {
        padding-top: 50px;}

          .meta-qty {
          width: 50%;}

          .process-border {
          border-top:1px solid #000;
          border-bottom:1px solid #000;
          padding-top: 1.5mm;
          padding-bottom: 1.5mm;
          }

          .detail-logo {
            padding-bottom: 0.9mm;
          }

          .description {
            padding-bottom: 2mm;
          }

          .content {
            width: 100%;
            height: 100%;
            border: 1.5px solid #000;
            border-radius: 10px;
            padding-top: 2mm;
            padding-bottom: 4mm;
              padding-left: 6mm;
                  padding-right: 6mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
          }

          .meta-item {
            padding-top: 2mm;
          }

          /* RESET DEFAULT P TAG SPACE */
          p {
            margin: 0;
          }

          /* HEADER */
          .company-name {
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1mm;
            
          }

          .assembly-title p {
          border: 1px solid #000;
            display: inline-block;
            padding-top: 1mm;
            padding-bottom: 0.9mm;
            padding-left: 1mm;
            padding-right: 1mm;
          }

          .company-address {
            font-size: 8px;
            font-weight: 400;
            text-align: center;
            line-height: 1.2;
            margin: 0 0 1.2mm;
          }

          .tag-title {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1.5mm;
          }

          .doc-row {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            margin-bottom: 0.5mm; /*  reduced */
          }

          /* ASSEMBLY LINE */
          .title {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            margin-top: 0;       /*  no top gap */
            margin-bottom: 0.5mm;
            //  border: 1px solid #000;
            // display: inline-block;
          }

          .title-line {
            border-bottom: 1px solid #000;
            margin-bottom: 1.5mm;
            margin-top: 0.5mm;
          }

          /* META */
          .meta {
            font-size: 10px;
            line-height: 1.25;
            margin-bottom: 0.8mm;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }

          .meta div {
            margin-bottom: 0.5mm;
          }

          /* ITEM */
          .desc {
            font-size: 9px;
            margin-bottom: 0.8mm;
          }

          .desc p {
          padding-bottom: 0.6mm;}

          .desc span {
            display: block;
            padding-bottom: 0.1mm;
          }

          .desc .label {
            display: block;
            font-size: 10px;
            margin-bottom: 0.8mm;
            margin-top: 0.8mm;
          }

          .desc .text {
            word-break: break-word;
            
          }

          /* QTY */
          .qty-logo {
            font-size: 10px;
            line-height: 1.3;
            margin-bottom: 0.4mm;
            margin-top: 0.8mm;
          }

          /* INSPECTION */
          .inspect {
            margin-top: auto;
            font-size: 10px;
          }

          .inspect-line {
            height: 3mm;
            border-bottom: 1px solid #000;
          }

          .label {
            font-weight: 600;
          }
        </style>
      </head>

      <body>${V.map(A=>`
        <div class="bin-card">
          <div class="content">

            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>

            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${A.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(A.gmsoaNo).replace(/^SOA/i,"")}-${A.soaSrNo}
                </div>

              </div>
                <div class="title assembly-title">
                  <p>Assembly Line: ${A.assemblyLine}</p>
                </div>
                <div class="meta-item">
                  <p>GMV-L4-F-PRD 01 A</p>
                  <p>(02/10.09.2020)</p>
                </div>
          </div>

            

            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${A.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${A.product}</p>
              </div>
            </div>

            <div class="qty-logo">
            <div class="meta meta-logo">
              <div class="meta-qty"><span class="label">QTY:</span> ${A.qty}</div>
              <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${A.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${A.specialNotes||""}</span></div>
              </div>

            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>

          </div>
        </div>`).join("")}</body>
    </html>`,v=document.createElement("iframe");v.style.position="fixed",v.style.right="0",v.style.bottom="0",v.style.width="0",v.style.height="0",v.style.border="0",document.body.appendChild(v);const N=v.contentDocument||v.contentWindow?.document;N&&(N.open(),N.write(m),N.close(),setTimeout(()=>{v.contentWindow?.focus(),v.contentWindow?.print(),setTimeout(()=>document.body.removeChild(v),500)},300))},K=g=>{ot(g),xe(!0)},de=g=>g.splittedCode||g.split_id?g.splittedCode||g.split_id:[g.uniqueCode,g.soaSrNo,g.gmsoaNo,g.codeNo,g.assemblyLine].map(m=>m??"").join("|"),oe=d.useMemo(()=>{const g=$e.filter(m=>se.has(de(m)));return{count:g.length,qty:g.reduce((m,v)=>m+(v.totalQty||v.qty||0),0),qtyExe:g.reduce((m,v)=>m+(v.qtyExe||0),0),qtyPending:g.reduce((m,v)=>m+(v.qtyPending||0),0)}},[se,$e]),_e=()=>{const g=q===!0,m=re===!0,v=se.size>0;if(!g&&!m&&!v)return;const N=v?$e.filter(A=>se.has(de(A))):$e;if(!N.length){alert("No data available to export");return}Ae(N)},Be=()=>{const g=c&&c.length>0?c:a;if(!g||g.length===0){alert("No data available to export");return}Ae(g)},Ae=g=>{const m=g.map((R,D)=>({No:D+1,"Assembly Line":R.assemblyLine,"GMSOA No":R.gmsoaNo,"SOA Sr No":R.soaSrNo,"Assembly Date":R.assemblyDate,"Unique Code":R.uniqueCode,"Splitted Code":R.splittedCode||"-",Party:R.party,"Customer PO No":R.customerPoNo,"Code No":R.codeNo,Product:R.product,"PO Qty":R.poQty,Qty:R.qty,"Qty Executed":R.qtyExe,"Qty Pending":R.qtyPending,"Finished Valve":R.finishedValve,"GM Logo":R.gmLogo,"Name Plate":R.namePlate,"Special Notes":R.specialNotes||"","Product Special 1":R.productSpcl1,"Product Special 2":R.productSpcl2,"Product Special 3":R.productSpcl3,Inspection:R.inspection,Painting:R.painting,Remarks:R.remarks||""})),v=Gt.json_to_sheet(m),N=Gt.book_new();Gt.book_append_sheet(N,v,"Orders");const A=Jr(N,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([A],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Ne=g=>{yt(g),ct(g.remarks||""),He(!0)},je=async()=>{if(!It)return;const g=new FormData;g.append("orderId",String(It.id)),g.append("remarks",St);try{const m=await xt.post(`${qt}/add-remarks`,g,{headers:{Authorization:`Bearer ${Bt}`}});if(console.log("Add Remarks Response:",m.data),m.data?.Resp_code==="true"||m.data?.Resp_code===!0){l(N=>N.map(A=>A.id===It.id?{...A,remarks:St}:A));try{t(It.id,St)}catch{}He(!1),yt(null),ct("")}else console.warn("Backend rejected remarks:",m.data)}catch(m){console.error("Error saving remarks:",m)}},Me=g=>[...g].sort((m,v)=>(m.originalIndex??0)-(v.originalIndex??0)),[We,ge]=d.useState(null),[W,T]=d.useState(!1),x=async()=>{if(!W&&ne&&ir()){T(!0),ge({type:"info",message:"Assigning order, please wait..."});try{const g=localStorage.getItem("token");if(!g){ge({type:"error",message:"Token missing. Please log in again."});return}const v=nt("assembly-c"),N=Number(Le||0),A=Number($t||0),R=fe||(Array.isArray(zt)?zt[0]:"assembly-d"),D=nt(R),Te=new FormData;Te.append("orderId",String(ne.id)),Te.append("totalQty",String(ne.totalQty??ne.qty??0)),Te.append("executedQty",String(N)),Te.append("currentSteps",v),Te.append("nextSteps",D),Te.append("split_id",String(ne.split_id||""));const rt=await xt.post(`${qt}/assign-order`,Te,{headers:{Authorization:`Bearer ${g}`}});if(!(rt.data?.Resp_code==="true"||rt.data?.Resp_code===!0)){ge({type:"error",message:rt.data?.Resp_desc||"Main assignment failed."});return}let ie=`Assigned ${N}  ${D}`;if(Ve&&A>0){const Oe=new FormData;Oe.append("orderId",String(ne.id)),Oe.append("totalQty",String(ne.totalQty??ne.qty??0)),Oe.append("executedQty",String(A)),Oe.append("currentSteps",v),Oe.append("nextSteps",D),Oe.append("split_id",String(ne.split_id||"")),Oe.append("splitOrder","true");const Se=await xt.post(`${qt}/assign-order`,Oe,{headers:{Authorization:`Bearer ${g}`}});Se.data?.Resp_code==="true"||Se.data?.Resp_code===!0?ie+=`
 Split ${A}  ${D}`:ge({type:"error",message:"Main assigned but split failed: "+(Se.data?.Resp_desc||"Unknown error")})}ge({type:"success",message:` ${ie}`}),l(Oe=>Oe.map(Se=>{if(Se.id!==ne.id)return Se;const Je=Number(Se.qtyExe||0),ft=Number(Se.totalQty||Se.qty||0),Ue=Je+N+(Ve?A:0),mr=ft-Ue;return{...Se,qtyExe:Ue,qtyPending:mr}})),await Et(),setTimeout(()=>{z(!1),ge(null)},1e3)}catch(g){console.error(" Error assigning order:",g),ge({type:"error",message:"Server error while assigning."})}finally{T(!1)}}},P=()=>{he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"assembly-c",currentPage:"Assembly-C",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:g=>{const m=g.toLowerCase().replace(/\s+/g,"-");window.location.href=`/${m}`},onUploadSuccess:()=>Et()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsxs("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold flex gap-3",children:["Assembly C",e.jsx(ee,{onClick:()=>pe("/testing-assembly",{state:{source:"assembly-c"}}),variant:"outline",className:"flex items-center gap-2",children:"Testing-1"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:ae,variant:"outline",disabled:se.size===0,className:"flex items-center gap-2",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{disabled:$e.length===0,onClick:_e,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:Be,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"assembly-c",searchTerm:F,setSearchTerm:B,assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:Ct,onClearFilters:P,hasActiveFilters:Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:vt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ut),onClick:At,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ut?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(g=>g==="asc"?"desc":g==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:gt.map(g=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:se.has(g.splittedCode||g.split_id||g.uniqueCode||g.id),onCheckedChange:()=>er(g.splittedCode||g.split_id||g.uniqueCode||g.id),"aria-label":`Select row ${g.splittedCode||g.split_id||g.uniqueCode||g.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:g.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:g.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:g.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:g.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:g.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:g.party,children:Pt(g.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:g.product,children:g.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:g.specialNotes,children:g.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:g.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:g.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${g.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Ne(g),children:e.jsx(is,{className:`h-4 w-4 ${g.remarks?.trim()?"text-white":"text-blue-600"}`})}),g.remarks?.trim()&&e.jsx("div",{className:`\r
                                                                              absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                                              hidden group-hover:block\r
                                                                              bg-gray-900 text-white text-xs\r
                                                                              px-3 py-2 rounded-md shadow-lg\r
                                                                              max-w-[260px] break-words z-[999]\r
                                                                            `,children:g.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>K(g),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>lr(g),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${g.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${g.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},g.splittedCode||g.split_id||g.uniqueCode||g.id))})]}),$e.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),oe.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:oe.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:oe.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:oe.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:oe.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:$e.length,lastPage:Math.max(1,Math.ceil($e.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:ue,onOpenChange:z,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",ne?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:fe,onValueChange:Ce,disabled:!0,children:[e.jsx(ss,{id:"assignStep",children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:nr.map(g=>e.jsx(Pr,{value:g,children:nt(g)},g))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Le,onChange:g=>{const m=g.target.value;De(m);const v=Number(ne?.qtyPending??0),N=Number(m||0);ut(A=>{const R={...A};return N>v?R.quickAssignQty=`Cannot exceed available (${v})`:R.quickAssignQty&&delete R.quickAssignQty,R})},max:ne?.qtyPending}),Ie.quickAssignQty&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:Ie.quickAssignQty})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:ne?.qtyPending})]})]})}),We&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${We.type==="success"?"bg-green-50 text-green-700 border border-green-200":We.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:We.message.split(`
`).map((g,m)=>e.jsx("div",{children:g},m))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:ar,disabled:W,children:"Cancel"}),e.jsx(ee,{onClick:x,disabled:W||!!Ie.quickAssignQty,className:"bg-black hover:bg-gray-800 text-white",children:W?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:it,onOpenChange:jt,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:V.map(g=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",g.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(g.gmsoaNo).replace(/^SOA/i,""),"-",g.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",g.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:g.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:g.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",g.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",g.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:g.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},g.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>jt(!1),children:"Cancel"}),e.jsxs(ee,{onClick:J,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:mt,onOpenChange:xe,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",Ge?.uniqueCode]})]}),Ge&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>xe(!1),children:"Close"})})]})}),e.jsx(Ot,{open:et,onOpenChange:He,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:It?`Order: ${It.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:St,onChange:g=>ct(g.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>He(!1),children:"Cancel"}),e.jsx(ee,{onClick:je,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function cf(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(20),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),pe=En(),[se,U]=d.useState(new Set),[ue,z]=d.useState(!1),[ne,ve]=d.useState(null),[fe,Ce]=d.useState(""),[Le,De]=d.useState(""),[Ve,tt]=d.useState(!1),[Nt,lt]=d.useState(""),[$t,qe]=d.useState(""),[Ie,ut]=d.useState({}),[it,jt]=d.useState(!1),[mt,xe]=d.useState(!1),[Ge,ot]=d.useState(null),[et,He]=d.useState(!1),[It,yt]=d.useState(null),[St,ct]=d.useState(""),[Yt,te]=d.useState(null),[Ze,at]=d.useState(!1),[Ke,kt]=d.useState(null);d.useRef(null);const vt=d.useRef(null),Bt=localStorage.getItem("token"),Et=async()=>{try{h(!0),w(null);const m=nt("assembly-d"),N=(()=>{try{const rt=localStorage.getItem("user");if(!rt)return"";const Y=JSON.parse(rt),ie=typeof Y.role=="object"?Y.role?.name:Y.role;return String(ie||"").toLowerCase()}catch{return""}})().includes("admin"),A={menu_name:m},R=await xt.post(`${qt}/order-list`,A,{headers:{Authorization:`Bearer ${Bt}`}}),D=R?.data?.Resp_code==="true"||R?.data?.Resp_code===!0||R?.data?.Resp_code==="RCS"||R?.status===200,Te=Array.isArray(R?.data?.data)?R.data.data:Array.isArray(R?.data?.orders)?R.data.orders:Array.isArray(R?.data)?R.data:[];if(D&&Array.isArray(Te)){const rt=Te.map((Y,ie)=>({id:String(Y.id),assemblyLine:Y.assembly_no||"",gmsoaNo:Y.soa_no||"",soaSrNo:Y.soa_sr_no||"",assemblyDate:Y.assembly_date||"",uniqueCode:Y.unique_code||Y.order_no||"",splittedCode:Y.splitted_code||"",split_id:Y.split_id||Y.splitted_code||"",party:Y.party_name||Y.party||"",customerPoNo:Y.customer_po_no||"",codeNo:Y.code_no||"",product:Y.product||"",qty:Number(Y.qty||0),totalQty:Number(Y.totalQty||Y.total_qty||Y.qty||0),qtyExe:Number(Y.qty_executed||0),qtyPending:Number(Y.qty_pending||0),finishedValve:Y.finished_valve||"",gmLogo:Y.gm_logo||"",namePlate:Y.name_plate||"",specialNotes:Y.special_notes||Y.special_note||"",productSpcl1:Y.product_spc1||"",productSpcl2:Y.product_spc2||"",productSpcl3:Y.product_spc3||"",inspection:Y.inspection||"",painting:Y.painting||"",remarks:Y.remarks||"",alertStatus:Y.is_urgent===!0||Y.is_urgent==="true"||Y.alert_status===!0||Y.alert_status==="true"||Y.urgent===1||Y.urgent==="1",originalIndex:ie}));console.log(" Orders fetched:",rt.length,"records"),l(Me(rt)),u(null),w(null),kt(null)}else console.warn(" No valid order data received",R.data),l([]),w(R?.data?.Resp_desc||"Failed to fetch orders")}catch(g){console.error("Error fetching orders:",g),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Qt=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{Qt||Et()},[j,k,Qt]);const Ct=d.useMemo(()=>Array.from(new Set(a.map(g=>g.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(g=>g.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(g=>g.party))).filter(Boolean).sort(),[a]);const bt=g=>{const m=parseInt(g,10);return isNaN(m)?0:m},$e=d.useMemo(()=>{let g=a.slice();if(q&&(g=g.filter(m=>n(String(m.id))||m.alertStatus)),re&&(g=g.filter(m=>typeof m.remarks=="string"&&m.remarks.trim().length>0)),G!=="all"){const m=G.startsWith("assembly-")?G.split("-")[1].toUpperCase():G.toUpperCase();g=g.filter(v=>{const N=String(v.assemblyLine||"").toUpperCase();return N===m||N.includes(m)})}if(Z!=="all"&&(g=g.filter(m=>m.gmsoaNo===Z)),ce!=="all"&&(g=g.filter(m=>m.party===ce)),(X||Q)&&(g=g.filter(m=>{if(!m.assemblyDate||m.assemblyDate==="HOLD")return!1;const N=m.assemblyDate.split(/[\/-]/).map(R=>R.trim()).map(R=>Number(R));if(N.some(R=>isNaN(R)))return!1;let A=null;if(N.length>=3){const[R,D,Te]=N;A=new Date(Te,D-1,R)}else if(N.length===2){const[R,D]=N;A=new Date(D,R-1,1)}else if(N.length===1){const[R]=N;A=new Date(R,0,1)}else return!1;if(!A||isNaN(A.getTime()))return!1;if(Ee==="year"&&X)return A.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return A.getFullYear()===X.getFullYear()&&A.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return A>=X&&A<=Q;if(X)return A>=X;if(Q)return A<=Q}return!0})),F.trim()){const m=F.toLowerCase();g=g.filter(v=>String(v.uniqueCode).toLowerCase().includes(m)||String(v.party).toLowerCase().includes(m)||String(v.gmsoaNo).toLowerCase().includes(m)||String(v.customerPoNo).toLowerCase().includes(m)||String(v.codeNo).toLowerCase().includes(m)||String(v.product).toLowerCase().includes(m))}return _&&(g=[...g].sort((m,v)=>{const N=bt(m.soaSrNo),A=bt(v.soaSrNo);return _==="asc"?N-A:A-N})),g},[a,F,q,re,G,Z,ce,Ee,X,Q,n,_]),gt=d.useMemo(()=>{const g=(j-1)*k;return $e.slice(g,g+k)},[$e,j,k]),Pt=(g="",m=4)=>{const v=g.trim().split(/\s+/);return v.length<=m?g:v.slice(0,m).join(" ")+"..."};d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const er=g=>{U(m=>{const v=new Set(m);return v.has(g)?v.delete(g):v.add(g),v})},At=()=>{U(g=>{if(g.size===$e.length)return new Set;const m=$e.map(v=>v.splittedCode||v.split_id||v.uniqueCode||v.id);return new Set(m)})},Ut=$e.length>0&&se.size===$e.length,Vt="assembly-d",zt=wr(Vt),rr=(ne?.assemblyLine||"").toUpperCase().includes("D"),nr=zt.filter(g=>g==="testing1"||g==="testing2"?rr?g==="testing2":g==="testing1":!0);console.log("Next step(s):",zt.map(nt)),console.log("Is final step?",hn(Vt));const lr=g=>{const v=wr("assembly-d");ve(g),z(!0);const N=(g.assemblyLine||"").toUpperCase().includes("D"),A=v.filter(R=>R==="testing1"||R==="testing2"?N?R==="testing2":R==="testing1":!0);Ce(A[0]||v[0]||""),De(String(g.qtyPending??g.qty??0)),ge(null),T(!1),tt(!1),lt(""),qe(""),ut({})},ir=()=>{const g={},m=Number(ne?.qtyPending??0),v=Number(Le||0),N=Number($t||0);if(fe||(g.quickAssignStep="Please select a workflow step."),(!Le||v<=0)&&(g.quickAssignQty="Quantity must be greater than 0."),v>m&&(g.quickAssignQty=`Cannot exceed available (${m})`),Ve){Nt||(g.splitAssignStep="Choose split step."),(!$t||N<=0)&&(g.splitAssignQty="Split quantity is required."),fe===Nt&&(g.sameEngineer="Split step cannot be the same as main step.");const A=v+N;A!==m&&(g.totalQtyMismatch=`Total quantity (${A}) must equal available (${m}).`)}return ut(g),Object.keys(g).length===0},ar=()=>{z(!1)},V=a.filter(g=>se.has(g.splittedCode||g.split_id||g.uniqueCode||g.id)),ae=()=>jt(!0),J=()=>{const m=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${V.map(A=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${A.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(A.gmsoaNo).replace(/^SOA/i,"")}-${A.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${A.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${A.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${A.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${A.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${A.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> </div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,v=document.createElement("iframe");v.style.position="fixed",v.style.right="0",v.style.bottom="0",v.style.width="0",v.style.height="0",v.style.border="0",document.body.appendChild(v);const N=v.contentDocument||v.contentWindow?.document;N&&(N.open(),N.write(m),N.close(),setTimeout(()=>{v.contentWindow?.focus(),v.contentWindow?.print(),setTimeout(()=>document.body.removeChild(v),500)},300))},K=g=>{ot(g),xe(!0)},de=g=>g.splittedCode||g.split_id?g.splittedCode||g.split_id:[g.uniqueCode,g.soaSrNo,g.gmsoaNo,g.codeNo,g.assemblyLine].map(m=>m??"").join("|"),oe=d.useMemo(()=>{const g=$e.filter(m=>se.has(de(m)));return{count:g.length,qty:g.reduce((m,v)=>m+(v.totalQty||v.qty||0),0),qtyExe:g.reduce((m,v)=>m+(v.qtyExe||0),0),qtyPending:g.reduce((m,v)=>m+(v.qtyPending||0),0)}},[se,$e]),_e=()=>{const g=q===!0,m=re===!0,v=se.size>0;if(!g&&!m&&!v)return;const N=v?$e.filter(A=>se.has(de(A))):$e;if(!N.length){alert("No data available to export");return}Ae(N)},Be=()=>{const g=c&&c.length>0?c:a;if(!g||g.length===0){alert("No data available to export");return}Ae(g)},Ae=g=>{const m=g.map((R,D)=>({No:D+1,"Assembly Line":R.assemblyLine,"GMSOA No":R.gmsoaNo,"SOA Sr No":R.soaSrNo,"Assembly Date":R.assemblyDate,"Unique Code":R.uniqueCode,"Splitted Code":R.splittedCode||"-",Party:R.party,"Customer PO No":R.customerPoNo,"Code No":R.codeNo,Product:R.product,"PO Qty":R.poQty,Qty:R.qty,"Qty Executed":R.qtyExe,"Qty Pending":R.qtyPending,"Finished Valve":R.finishedValve,"GM Logo":R.gmLogo,"Name Plate":R.namePlate,"Special Notes":R.specialNotes||"","Product Special 1":R.productSpcl1,"Product Special 2":R.productSpcl2,"Product Special 3":R.productSpcl3,Inspection:R.inspection,Painting:R.painting,Remarks:R.remarks||""})),v=Gt.json_to_sheet(m),N=Gt.book_new();Gt.book_append_sheet(N,v,"Orders");const A=Jr(N,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([A],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Ne=g=>{yt(g),ct(g.remarks||""),He(!0)},je=async()=>{if(!It)return;const g=new FormData;g.append("orderId",String(It.id)),g.append("remarks",St);try{const m=await xt.post(`${qt}/add-remarks`,g,{headers:{Authorization:`Bearer ${Bt}`}});if(console.log("Add Remarks Response:",m.data),m.data?.Resp_code==="true"||m.data?.Resp_code===!0){l(N=>N.map(A=>A.id===It.id?{...A,remarks:St}:A));try{t(It.id,St)}catch{}He(!1),yt(null),ct("")}else console.warn("Backend rejected remarks:",m.data)}catch(m){console.error("Error saving remarks:",m)}},Me=g=>[...g].sort((m,v)=>(m.originalIndex??0)-(v.originalIndex??0)),[We,ge]=d.useState(null),[W,T]=d.useState(!1),x=async()=>{if(!W&&ne&&ir()){T(!0),ge({type:"info",message:"Assigning order, please wait..."});try{const g=localStorage.getItem("token");if(!g){ge({type:"error",message:"Token missing. Please log in again."});return}const v=nt("assembly-d"),N=Number(Le||0),A=Number($t||0),R=fe||(Array.isArray(zt)?zt[0]:""),D=nt(R),Te=new FormData;Te.append("orderId",String(ne.id)),Te.append("totalQty",String(ne.totalQty??ne.qty??0)),Te.append("executedQty",String(N)),Te.append("currentSteps",v),Te.append("nextSteps",D),Te.append("split_id",String(ne.split_id||""));const rt=await xt.post(`${qt}/assign-order`,Te,{headers:{Authorization:`Bearer ${g}`}});if(!(rt?.data?.Resp_code==="true"||rt?.data?.Resp_code===!0)){ge({type:"error",message:rt?.data?.Resp_desc||"Main assignment failed."});return}let ie=`Assigned ${N}  ${D}`;if(Ve&&A>0){const Oe=new FormData;Oe.append("orderId",String(ne.id)),Oe.append("totalQty",String(ne.totalQty??ne.qty??0)),Oe.append("executedQty",String(A)),Oe.append("currentSteps",v),Oe.append("nextSteps",D),Oe.append("split_id",String(ne.split_id||"")),Oe.append("splitOrder","true");const Se=await xt.post(`${qt}/assign-order`,Oe,{headers:{Authorization:`Bearer ${g}`}});Se?.data?.Resp_code==="true"||Se?.data?.Resp_code===!0?ie+=`
 Split ${A}  ${D}`:ge({type:"error",message:"Main assigned but split failed: "+(Se?.data?.Resp_desc||"Unknown error")})}l(Oe=>Oe.map(Se=>{if(Se.id!==ne.id)return Se;const Je=Number(Se.qtyExe||0),ft=N+(Ve?A:0),Ue=Number(Se.totalQty??Se.qty??0);return{...Se,qtyExe:Je+ft,qtyPending:Ue-(Je+ft)}})),await Et(),ge({type:"success",message:` ${ie}`}),setTimeout(()=>{z(!1),ge(null)},1e3)}catch(g){console.error(" Error assigning order:",g),ge({type:"error",message:"Server error while assigning."})}finally{T(!1)}}},P=()=>{he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"assembly-d",currentPage:"Assembly-D",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:g=>{const m=g.toLowerCase().replace(/\s+/g,"-");window.location.href=`/${m}`},onUploadSuccess:()=>Et()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsxs("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold flex gap-3",children:["Assembly D",e.jsx(ee,{onClick:()=>pe("/testing-assembly-2",{state:{source:"assembly-d"}}),variant:"outline",className:"flex items-center gap-2",children:"Testing-2"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:ae,variant:"outline",disabled:se.size===0,className:"flex items-center gap-2",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{disabled:$e.length===0,onClick:_e,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:Be,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"assembly-d",assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:Ct,onClearFilters:P,hasActiveFilters:Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:vt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ut),onClick:At,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ut?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(g=>g==="asc"?"desc":g==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:gt.map(g=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:se.has(g.splittedCode||g.split_id||g.uniqueCode||g.id),onCheckedChange:()=>er(g.splittedCode||g.split_id||g.uniqueCode||g.id),"aria-label":`Select row ${g.splittedCode||g.split_id||g.uniqueCode||g.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:g.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:g.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:g.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:g.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:g.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:g.party,children:Pt(g.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:g.product,children:g.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:g.specialNotes,children:g.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:g.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:g.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${g.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Ne(g),children:e.jsx(is,{className:`h-4 w-4 ${g.remarks?.trim()?"text-white":"text-blue-600"}`})}),g.remarks?.trim()&&e.jsx("div",{className:`\r
                                                                                                   absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                                                                   hidden group-hover:block\r
                                                                                                   bg-gray-900 text-white text-xs\r
                                                                                                   px-3 py-2 rounded-md shadow-lg\r
                                                                                                   max-w-[260px] break-words z-[999]\r
                                                                                                 `,children:g.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>K(g),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>lr(g),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${g.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${g.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},g.splittedCode||g.split_id||g.uniqueCode||g.id))})]}),$e.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),oe.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:oe.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:oe.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:oe.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:oe.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:$e.length,lastPage:Math.max(1,Math.ceil($e.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:ue,onOpenChange:z,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",ne?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:fe,onValueChange:Ce,disabled:!0,children:[e.jsx(ss,{id:"assignStep",children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:nr.map(g=>e.jsx(Pr,{value:g,children:nt(g)},g))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Le,onChange:g=>{const m=g.target.value;De(m);const v=Number(ne?.qtyPending??0),N=Number(m||0);ut(A=>{const R={...A};return N>v?R.quickAssignQty=`Cannot exceed available (${v})`:R.quickAssignQty&&delete R.quickAssignQty,R})},max:ne?.qtyPending}),Ie.quickAssignQty&&e.jsx("div",{className:"text-red-600 text-sm mt-1",children:Ie.quickAssignQty})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:ne?.qtyPending})]})]})}),We&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${We.type==="success"?"bg-green-50 text-green-700 border border-green-200":We.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:We.message.split(`
`).map((g,m)=>e.jsx("div",{children:g},m))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:ar,disabled:W,children:"Cancel"}),e.jsx(ee,{onClick:x,disabled:W||!!Ie.quickAssignQty,className:"bg-black hover:bg-gray-800 text-white",children:W?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:it,onOpenChange:jt,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:V.map(g=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",g.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(g.gmsoaNo).replace(/^SOA/i,""),"-",g.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",g.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:g.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:g.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",g.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",g.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:g.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},g.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>jt(!1),children:"Cancel"}),e.jsxs(ee,{onClick:J,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:mt,onOpenChange:xe,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",Ge?.uniqueCode]})]}),Ge&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>xe(!1),children:"Close"})})]})}),e.jsx(Ot,{open:et,onOpenChange:He,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:It?`Order: ${It.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:St,onChange:g=>ct(g.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>He(!1),children:"Cancel"}),e.jsx(ee,{onClick:je,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function df(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),[pe,se]=d.useState(new Set),[U,ue]=d.useState(!1),[z,ne]=d.useState(null),[ve,fe]=d.useState(""),[Ce,Le]=d.useState(""),[De,Ve]=d.useState(!1),[tt,Nt]=d.useState(""),[lt,$t]=d.useState(""),[qe,Ie]=d.useState({}),[ut,it]=d.useState(!1),[jt,mt]=d.useState(!1),[xe,Ge]=d.useState(null),[ot,et]=d.useState(!1),[He,It]=d.useState(null),[yt,St]=d.useState(""),[ct,Yt]=d.useState(null),[te,Ze]=d.useState(!1),[at,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),vt=localStorage.getItem("token"),Bt=async()=>{try{h(!0),w(null);const P=nt("testing1"),m=(()=>{try{const R=localStorage.getItem("user");if(!R)return"";const D=JSON.parse(R),Te=typeof D.role=="object"?D.role?.name:D.role;return String(Te||"").toLowerCase()}catch{return""}})().includes("admin"),v={menu_name:P},N=await xt.post(`${qt}/order-list`,v,{headers:{Authorization:`Bearer ${vt}`}});if((N?.data?.Resp_code==="true"||N?.data?.Resp_code===!0||N?.data?.Resp_code==="RCS")&&Array.isArray(N.data.data)){const R=N.data.data.map(D=>({id:String(D.id),assemblyLine:D.assembly_no||"",gmsoaNo:D.soa_no||"",soaSrNo:D.soa_sr_no||"",assemblyDate:D.assembly_date||"",uniqueCode:D.unique_code||D.order_no||"",splittedCode:D.splitted_code||"",party:D.party_name||D.party||"",customerPoNo:D.customer_po_no||"",codeNo:D.code_no||"",product:D.product||"",qty:Number(D.qty||0),totalQty:Number(D.totalQty||D.total_qty||D.qty||0),qtyExe:Number(D.qty_executed||0),qtyPending:Number(D.qty_pending||0),finishedValve:D.finished_valve||"",gmLogo:D.gm_logo||"",namePlate:D.name_plate||"",specialNotes:D.special_notes||D.special_note||"",productSpcl1:D.product_spc1||"",productSpcl2:D.product_spc2||"",productSpcl3:D.product_spc3||"",inspection:D.inspection||"",painting:D.painting||"",remarks:D.remarks||"",alertStatus:D.is_urgent===!0||D.is_urgent==="true"||D.alert_status===!0||D.alert_status==="true"||D.urgent===1||D.urgent==="1"}));console.log(" Orders fetched:",R.length,"records"),l(Ne(R)),u(null),w(null),Ke(null)}else console.warn(" No valid order data received",N.data),l([]),w(N?.data?.Resp_desc||"Failed to fetch orders")}catch(x){console.error("Error fetching orders:",x),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Et=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{Et||Bt()},[j,k,Et]);const Qt=d.useMemo(()=>Array.from(new Set(a.map(x=>x.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(x=>x.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(x=>x.party))).filter(Boolean).sort(),[a]);const Ct=x=>{const P=parseInt(x,10);return isNaN(P)?0:P},bt=d.useMemo(()=>{let x=a.slice();if(q&&(x=x.filter(P=>n(String(P.id))||P.alertStatus)),re&&(x=x.filter(P=>typeof P.remarks=="string"&&P.remarks.trim().length>0)),G!=="all"&&(x=x.filter(P=>P.assemblyLine===G)),Z!=="all"&&(x=x.filter(P=>P.gmsoaNo===Z)),ce!=="all"&&(x=x.filter(P=>P.party===ce)),(X||Q)&&(x=x.filter(P=>{if(!P.assemblyDate||P.assemblyDate==="HOLD")return!1;const m=P.assemblyDate.split(/[\/-]/).map(N=>N.trim()).map(N=>Number(N));if(m.some(N=>isNaN(N)))return!1;let v=null;if(m.length>=3){const[N,A,R]=m;v=new Date(R,A-1,N)}else if(m.length===2){const[N,A]=m;v=new Date(A,N-1,1)}else if(m.length===1){const[N]=m;v=new Date(N,0,1)}else return!1;if(!v||isNaN(v.getTime()))return!1;if(Ee==="year"&&X)return v.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return v.getFullYear()===X.getFullYear()&&v.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return v>=X&&v<=Q;if(X)return v>=X;if(Q)return v<=Q}return!0})),F.trim()){const P=F.toLowerCase();x=x.filter(g=>String(g.uniqueCode).toLowerCase().includes(P)||String(g.party).toLowerCase().includes(P)||String(g.gmsoaNo).toLowerCase().includes(P)||String(g.customerPoNo).toLowerCase().includes(P)||String(g.codeNo).toLowerCase().includes(P)||String(g.product).toLowerCase().includes(P))}return _&&(x=[...x].sort((P,g)=>{const m=Ct(P.soaSrNo),v=Ct(g.soaSrNo);return _==="asc"?m-v:v-m})),x},[a,F,q,re,G,Z,ce,Ee,X,Q,n,_]),$e=d.useMemo(()=>{const x=(j-1)*k;return bt.slice(x,x+k)},[bt,j,k]);d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const gt=(x="",P=4)=>{const g=x.trim().split(/\s+/);return g.length<=P?x:g.slice(0,P).join(" ")+"..."},Pt=x=>{se(P=>{const g=new Set(P);return g.has(x)?g.delete(x):g.add(x),g})},er=()=>{se(x=>x.size===bt.length?new Set:new Set(bt.map(zt)))},At=bt.length>0&&pe.size===bt.length,Ut=x=>{const P=x.assemblyLine?.toLowerCase();return P==="c"||P==="assembly c"||P==="assembly-c"?["svs","marking1"]:wr("testing1")},Vt=d.useMemo(()=>z?Ut(z):[],[z]),zt=x=>x.splittedCode||x.split_id||x.uniqueCode||x.id,rr=x=>{const P=Ut(x);ne(x),ue(!0),fe(P[0]||""),Le(String(x.qtyPending??x.qty??0)),Ve(!1),Nt(""),$t(""),Ie({})},nr=()=>{const x={},P=Number(z?.qtyPending??0),g=Number(Ce||0),m=Number(lt||0);if(ve||(x.quickAssignStep="Please select a workflow step."),(!Ce||g<=0)&&(x.quickAssignQty="Quantity must be greater than 0."),g>P&&(x.quickAssignQty=`Cannot exceed available (${P})`),De){tt||(x.splitAssignStep="Choose split step."),(!lt||m<=0)&&(x.splitAssignQty="Split quantity is required."),ve===tt&&(x.sameEngineer="Split step cannot be the same as main step.");const v=g+m;v!==P&&(x.totalQtyMismatch=`Total quantity (${v}) must equal available (${P}).`)}return Ie(x),Object.keys(x).length===0},lr=()=>{ge(!1),Me(null),ue(!1),ne(null),fe(""),Le(""),Ve(!1),Nt(""),$t(""),Ie({})},ir=a.filter(x=>pe.has(x.splittedCode||x.split_id||x.uniqueCode||x.id)),ar=()=>it(!0),V=()=>{const P=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ir.map(v=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${v.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(v.gmsoaNo).replace(/^SOA/i,"")}-${v.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${v.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${v.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${v.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${v.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${v.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${v.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,g=document.createElement("iframe");g.style.position="fixed",g.style.right="0",g.style.bottom="0",g.style.width="0",g.style.height="0",g.style.border="0",document.body.appendChild(g);const m=g.contentDocument||g.contentWindow?.document;m&&(m.open(),m.write(P),m.close(),setTimeout(()=>{g.contentWindow?.focus(),g.contentWindow?.print(),setTimeout(()=>document.body.removeChild(g),500)},300))},ae=x=>{Ge(x),mt(!0)},J=x=>x.splittedCode||x.split_id?x.splittedCode||x.split_id:[x.uniqueCode,x.soaSrNo,x.gmsoaNo,x.codeNo,x.assemblyLine].map(P=>P??"").join("|"),K=d.useMemo(()=>{const x=bt.filter(P=>pe.has(J(P)));return{count:x.length,qty:x.reduce((P,g)=>P+(g.totalQty||g.qty||0),0),qtyExe:x.reduce((P,g)=>P+(g.qtyExe||0),0),qtyPending:x.reduce((P,g)=>P+(g.qtyPending||0),0)}},[pe,bt]),de=()=>{const x=q===!0,P=re===!0,g=pe.size>0;if(!x&&!P&&!g)return;const m=g?bt.filter(v=>pe.has(J(v))):bt;if(!m.length){alert("No data available to export");return}_e(m)},oe=()=>{const x=c&&c.length>0?c:a;if(!x||x.length===0){alert("No data available to export");return}_e(x)},_e=x=>{const P=x.map((N,A)=>({No:A+1,"Assembly Line":N.assemblyLine,"GMSOA No":N.gmsoaNo,"SOA Sr No":N.soaSrNo,"Assembly Date":N.assemblyDate,"Unique Code":N.uniqueCode,"Splitted Code":N.splittedCode||"-",Party:N.party,"Customer PO No":N.customerPoNo,"Code No":N.codeNo,Product:N.product,"PO Qty":N.poQty,Qty:N.qty,"Qty Executed":N.qtyExe,"Qty Pending":N.qtyPending,"Finished Valve":N.finishedValve,"GM Logo":N.gmLogo,"Name Plate":N.namePlate,"Special Notes":N.specialNotes||"","Product Special 1":N.productSpcl1,"Product Special 2":N.productSpcl2,"Product Special 3":N.productSpcl3,Inspection:N.inspection,Painting:N.painting,Remarks:N.remarks||""})),g=Gt.json_to_sheet(P),m=Gt.book_new();Gt.book_append_sheet(m,g,"Orders");const v=Jr(m,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([v],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Be=x=>{It(x),St(x.remarks||""),et(!0)},Ae=async()=>{if(!He)return;const x=new FormData;x.append("orderId",String(He.id)),x.append("remarks",yt);try{const P=await xt.post(`${qt}/add-remarks`,x,{headers:{Authorization:`Bearer ${vt}`}});if(console.log("Add Remarks Response:",P.data),P.data?.Resp_code==="true"||P.data?.Resp_code===!0){l(m=>m.map(v=>v.id===He.id?{...v,remarks:yt}:v));try{t(He.id,yt)}catch{}et(!1),It(null),St("")}else console.warn("Backend rejected remarks:",P.data)}catch(P){console.error("Error saving remarks:",P)}},Ne=x=>[...x].sort((P,g)=>{const m=P.alertStatus?1:0,v=g.alertStatus?1:0;return m!==v?v-m:(P.originalIndex??0)-(g.originalIndex??0)}),[je,Me]=d.useState(null),[We,ge]=d.useState(!1),W=async()=>{if(!We&&z&&nr()){ge(!0),Me({type:"info",message:"Assigning order, please wait..."});try{const x=localStorage.getItem("token");if(!x){Me({type:"error",message:"Token missing. Please log in again."});return}const P="testing1",g=nt(P),m=Number(Ce||0),v=Number(lt||0),N=wr(P)[0]||"",R=nt(ve||N),D=new FormData;D.append("orderId",String(z.id)),D.append("totalQty",String(z.totalQty??z.qty??0)),D.append("executedQty",String(m)),D.append("currentSteps",g),D.append("nextSteps",R),D.append("split_id",String(z.split_id||"")),console.log(" MAIN PAYLOAD:",Object.fromEntries(D.entries()));const Te=await xt.post(`${qt}/assign-order`,D,{headers:{Authorization:`Bearer ${x}`}});if(!(Te.data?.Resp_code===!0||Te.data?.Resp_code==="true"||Te.data?.status===!0)){Me({type:"error",message:Te.data?.Resp_desc||"Main assignment failed."});return}let Y=` Assigned ${m}  ${R}`;if(De&&v>0){const Se=new FormData;Se.append("orderId",String(z.id)),Se.append("totalQty",String(z.totalQty??z.qty??0)),Se.append("executedQty",String(v)),Se.append("currentSteps",g),Se.append("nextSteps",R),Se.append("split_id",String(z.split_id||"")),console.log(" SPLIT PAYLOAD:",Object.fromEntries(Se.entries()));const Je=await xt.post(`${qt}/assign-order`,Se,{headers:{Authorization:`Bearer ${x}`}});Je.data?.Resp_code===!0||Je.data?.Resp_code==="true"||Je.data?.status===!0?Y+=`
 Split ${v}  ${R}`:Me({type:"error",message:"Main assigned but split failed: "+(Je.data?.Resp_desc||"Unknown error")})}Me({type:"success",message:Y});const ie=Se=>Se.splittedCode||Se.split_id?Se.splittedCode||Se.split_id:[Se.uniqueCode,Se.soaSrNo,Se.gmsoaNo,Se.codeNo,Se.assemblyLine].map(Je=>Je??"").join("|"),Oe=ie(z);l(Se=>Se.filter(Je=>ie(Je)!==Oe)),se(Se=>{const Je=new Set(Se);return Je.delete(Oe),Je}),setTimeout(()=>{ue(!1),Me(null)},1e3)}catch(x){console.error(" Error assigning order:",x),Me({type:"error",message:x?.response?.data?.Resp_desc||x?.response?.data?.message||"Server error while assigning."})}finally{ge(!1)}}},T=()=>{le("all"),he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:x=>{window.location.href=`/${x.toLowerCase()}`},onUploadSuccess:()=>Bt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Testing 1"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:ar,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{onClick:de,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:oe,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:Qt,onClearFilters:T,hasActiveFilters:G!=="all"||Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(At),onClick:er,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${At?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(x=>x==="asc"?"desc":x==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:$e.map(x=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:pe.has(zt(x)),onCheckedChange:()=>Pt(zt(x))})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:x.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:x.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:x.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:x.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:x.party,children:gt(x.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:x.product,children:x.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:x.specialNotes,children:x.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:x.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:x.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${x.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Be(x),children:e.jsx(is,{className:`h-4 w-4 ${x.remarks?.trim()?"text-white":"text-blue-600"}`})}),x.remarks?.trim()&&e.jsx("div",{className:`\r
                                  absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                  hidden group-hover:block\r
                                  bg-gray-900 text-white text-xs\r
                                  px-3 py-2 rounded-md shadow-lg\r
                                  max-w-[260px] break-words z-[999]\r
                                `,children:x.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>ae(x),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>rr(x),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${x.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${x.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},x.splittedCode||x.split_id||x.uniqueCode||x.id))})]}),bt.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),K.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:K.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:K.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:K.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:K.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:bt.length,lastPage:Math.max(1,Math.ceil(bt.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:U,onOpenChange:ue,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:ve,onValueChange:fe,children:[e.jsx(ss,{id:"assignStep",children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:Vt.map(x=>e.jsx(Pr,{value:x,children:nt(x)},x))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Ce,onChange:x=>Le(x.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),je&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${je.type==="success"?"bg-green-50 text-green-700 border border-green-200":je.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:je.message.split(`
`).map((x,P)=>e.jsx("div",{children:x},P))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:lr,disabled:We,children:"Cancel"}),e.jsx(ee,{onClick:W,disabled:We,className:"bg-black hover:bg-gray-800 text-white",children:We?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:ut,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ir.map(x=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",x.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(x.gmsoaNo).replace(/^SOA/i,""),"-",x.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",x.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:x.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:x.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",x.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",x.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:x.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},x.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(ee,{onClick:V,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:jt,onOpenChange:mt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>mt(!1),children:"Close"})})]})}),e.jsx(Ot,{open:ot,onOpenChange:et,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:yt,onChange:x=>St(x.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>et(!1),children:"Cancel"}),e.jsx(ee,{onClick:Ae,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function uf(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),[pe,se]=d.useState(new Set),[U,ue]=d.useState(!1),[z,ne]=d.useState(null),[ve,fe]=d.useState(""),[Ce,Le]=d.useState(""),[De,Ve]=d.useState(!1),[tt,Nt]=d.useState(""),[lt,$t]=d.useState(""),[qe,Ie]=d.useState({}),[ut,it]=d.useState(!1),[jt,mt]=d.useState(!1),[xe,Ge]=d.useState(null),[ot,et]=d.useState(!1),[He,It]=d.useState(null),[yt,St]=d.useState(""),[ct,Yt]=d.useState(null),[te,Ze]=d.useState(!1),[at,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),vt=localStorage.getItem("token"),Bt=async()=>{try{h(!0),w(null);const x=nt("testing2"),g=(()=>{try{const A=localStorage.getItem("user");if(!A)return"";const R=JSON.parse(A),D=typeof R.role=="object"?R.role?.name:R.role;return String(D||"").toLowerCase()}catch{return""}})().includes("admin"),m={menu_name:x},v=await xt.post(`${qt}/order-list`,m,{headers:{Authorization:`Bearer ${vt}`}});if((v?.data?.Resp_code==="true"||v?.data?.Resp_code===!0||v?.data?.Resp_code==="RCS")&&Array.isArray(v.data.data)){const A=v.data.data.map(R=>({id:String(R.id),assemblyLine:R.assembly_no||"",gmsoaNo:R.soa_no||"",soaSrNo:R.soa_sr_no||"",assemblyDate:R.assembly_date||"",uniqueCode:R.unique_code||R.order_no||"",splittedCode:R.splitted_code||"",split_id:R.split_id||R.splitted_code||"",party:R.party_name||R.party||"",customerPoNo:R.customer_po_no||"",codeNo:R.code_no||"",product:R.product||"",qty:Number(R.qty||0),totalQty:Number(R.totalQty||R.total_qty||R.qty||0),qtyExe:Number(R.qty_executed||0),qtyPending:Number(R.qty_pending||0),finishedValve:R.finished_valve||"",gmLogo:R.gm_logo||"",namePlate:R.name_plate||"",specialNotes:R.special_notes||R.special_note||"",productSpcl1:R.product_spc1||"",productSpcl2:R.product_spc2||"",productSpcl3:R.product_spc3||"",inspection:R.inspection||"",painting:R.painting||"",remarks:R.remarks||"",alertStatus:R.is_urgent===!0||R.is_urgent==="true"||R.alert_status===!0||R.alert_status==="true"||R.urgent===1||R.urgent==="1"}));console.log(" Orders fetched:",A.length,"records"),l(Ae(A)),u(null),w(null),Ke(null)}else console.warn(" No valid order data received",v.data),l([]),w(v?.data?.Resp_desc||"Failed to fetch orders")}catch(T){console.error("Error fetching orders:",T),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Et=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{Et||Bt()},[j,k,Et]);const Qt=d.useMemo(()=>Array.from(new Set(a.map(T=>T.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(T=>T.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(T=>T.party))).filter(Boolean).sort(),[a]);const Ct=d.useMemo(()=>{let T=a.slice();if(q&&(T=T.filter(g=>n(String(g.id))||g.alertStatus)),re&&(T=T.filter(g=>typeof g.remarks=="string"&&g.remarks.trim().length>0)),G!=="all"&&(T=T.filter(g=>g.assemblyLine===G)),Z!=="all"&&(T=T.filter(g=>g.gmsoaNo===Z)),ce!=="all"&&(T=T.filter(g=>g.party===ce)),(X||Q)&&(T=T.filter(g=>{if(!g.assemblyDate||g.assemblyDate==="HOLD")return!1;const v=g.assemblyDate.split(/[\/-]/).map(A=>A.trim()).map(A=>Number(A));if(v.some(A=>isNaN(A)))return!1;let N=null;if(v.length>=3){const[A,R,D]=v;N=new Date(D,R-1,A)}else if(v.length===2){const[A,R]=v;N=new Date(R,A-1,1)}else if(v.length===1){const[A]=v;N=new Date(A,0,1)}else return!1;if(!N||isNaN(N.getTime()))return!1;if(Ee==="year"&&X)return N.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return N.getFullYear()===X.getFullYear()&&N.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return N>=X&&N<=Q;if(X)return N>=X;if(Q)return N<=Q}return!0})),F.trim()){const g=F.toLowerCase();T=T.filter(m=>String(m.uniqueCode).toLowerCase().includes(g)||String(m.party).toLowerCase().includes(g)||String(m.gmsoaNo).toLowerCase().includes(g)||String(m.customerPoNo).toLowerCase().includes(g)||String(m.codeNo).toLowerCase().includes(g)||String(m.product).toLowerCase().includes(g))}const x=new Set,P=g=>g.splittedCode||g.split_id||g.uniqueCode||g.id;return T=T.filter(g=>{const m=P(g);return x.has(m)?!1:(x.add(m),!0)}),_&&(T=[...T].sort((g,m)=>{const v=parseSoaSrNo(g.soaSrNo),N=parseSoaSrNo(m.soaSrNo);return _==="asc"?v-N:N-v})),T},[a,F,q,re,G,Z,ce,Ee,X,Q,n,_]),bt=d.useMemo(()=>{const T=(j-1)*k;return Ct.slice(T,T+k)},[Ct,j,k]);d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const $e=(T="",x=4)=>{const P=T.trim().split(/\s+/);return P.length<=x?T:P.slice(0,x).join(" ")+"..."},gt=T=>{se(x=>{const P=new Set(x);return P.has(T)?P.delete(T):P.add(T),P})},Pt=T=>T.splittedCode||T.split_id||T.uniqueCode||T.id,er=()=>{se(T=>T.size===Ct.length?new Set:new Set(Ct.map(Pt)))},At=Ct.length>0&&pe.size===Ct.length,Ut="testing2",Vt=wr(Ut);console.log("Next step(s):",Vt.map(nt)),console.log("Is final step?",hn(Ut));const zt=T=>{const P=wr("testing2");ne(T),ue(!0),fe(P[0]||""),Le(String(T.qtyPending??T.qty??0)),Ve(!1),Nt(""),$t(""),Ie({})},rr=()=>{const T={},x=Number(z?.qtyPending??0),P=Number(Ce||0),g=Number(lt||0);if(ve||(T.quickAssignStep="Please select a workflow step."),(!Ce||P<=0)&&(T.quickAssignQty="Quantity must be greater than 0."),P>x&&(T.quickAssignQty=`Cannot exceed available (${x})`),De){tt||(T.splitAssignStep="Choose split step."),(!lt||g<=0)&&(T.splitAssignQty="Split quantity is required."),ve===tt&&(T.sameEngineer="Split step cannot be the same as main step.");const m=P+g;m!==x&&(T.totalQtyMismatch=`Total quantity (${m}) must equal available (${x}).`)}return Ie(T),Object.keys(T).length===0},nr=()=>{We(!1),je(null),ue(!1),ne(null),fe(""),Le(""),Ve(!1),Nt(""),$t(""),Ie({})},lr=a.filter(T=>pe.has(T.splittedCode||T.split_id||T.uniqueCode||T.id)),ir=()=>it(!0),ar=()=>{const x=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>

        <style>
          @page {
            size: 130mm 85mm;
            margin: 0;
          }

          html, body {
            width: 130mm;
            height: 85mm;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
          }

          .item-label,
          .party-desc {
          padding-bottom: 2mm;}

          .item-label {
          line-height: 1.8em;}

          .bin-card {
            width: 130mm;
            height: 85mm;
            padding: 6mm;
            box-sizing: border-box;
            page-break-after: always;
          }

        .item-label-description {
        padding-top: 50px;}

          .meta-qty {
          width: 50%;}

          .process-border {
          border-top:1px solid #000;
          border-bottom:1px solid #000;
          padding-top: 1.5mm;
          padding-bottom: 1.5mm;
          }

          .detail-logo {
            padding-bottom: 0.9mm;
          }

          .description {
            padding-bottom: 2mm;
          }

          .content {
            width: 100%;
            height: 100%;
            border: 1.5px solid #000;
            border-radius: 10px;
            padding-top: 2mm;
            padding-bottom: 4mm;
              padding-left: 6mm;
                  padding-right: 6mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
          }

          .meta-item {
            padding-top: 2mm;
          }

          /* RESET DEFAULT P TAG SPACE */
          p {
            margin: 0;
          }

          /* HEADER */
          .company-name {
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1mm;
            
          }

          .assembly-title p {
          border: 1px solid #000;
            display: inline-block;
            padding-top: 1mm;
            padding-bottom: 0.9mm;
            padding-left: 1mm;
            padding-right: 1mm;
          }

          .company-address {
            font-size: 8px;
            font-weight: 400;
            text-align: center;
            line-height: 1.2;
            margin: 0 0 1.2mm;
          }

          .tag-title {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1.5mm;
          }

          .doc-row {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            margin-bottom: 0.5mm; /*  reduced */
          }

          /* ASSEMBLY LINE */
          .title {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            margin-top: 0;       /*  no top gap */
            margin-bottom: 0.5mm;
            //  border: 1px solid #000;
            // display: inline-block;
          }

          .title-line {
            border-bottom: 1px solid #000;
            margin-bottom: 1.5mm;
            margin-top: 0.5mm;
          }

          /* META */
          .meta {
            font-size: 10px;
            line-height: 1.25;
            margin-bottom: 0.8mm;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }

          .meta div {
            margin-bottom: 0.5mm;
          }

          /* ITEM */
          .desc {
            font-size: 9px;
            margin-bottom: 0.8mm;
          }

          .desc p {
          padding-bottom: 0.6mm;}

          .desc span {
            display: block;
            padding-bottom: 0.1mm;
          }

          .desc .label {
            display: block;
            font-size: 10px;
            margin-bottom: 0.8mm;
            margin-top: 0.8mm;
          }

          .desc .text {
            word-break: break-word;
            
          }

          /* QTY */
          .qty-logo {
            font-size: 10px;
            line-height: 1.3;
            margin-bottom: 0.4mm;
            margin-top: 0.8mm;
          }

          /* INSPECTION */
          .inspect {
            margin-top: auto;
            font-size: 10px;
          }

          .inspect-line {
            height: 3mm;
            border-bottom: 1px solid #000;
          }

          .label {
            font-weight: 600;
          }
        </style>
      </head>

      <body>${lr.map(m=>`
        <div class="bin-card">
          <div class="content">

            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>

            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${m.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(m.gmsoaNo).replace(/^SOA/i,"")}-${m.soaSrNo}
                </div>

              </div>
                <div class="title assembly-title">
                  <p>Assembly Line: ${m.assemblyLine}</p>
                </div>
                <div class="meta-item">
                  <p>GMV-L4-F-PRD 01 A</p>
                  <p>(02/10.09.2020)</p>
                </div>
          </div>

            

            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${m.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${m.product}</p>
              </div>
            </div>

            <div class="qty-logo">
            <div class="meta meta-logo">
              <div class="meta-qty"><span class="label">QTY:</span> ${m.qty}</div>
              <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${m.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${m.specialNotes||""}</span></div>
              </div>

            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>

          </div>
        </div>`).join("")}</body>
    </html>`,P=document.createElement("iframe");P.style.position="fixed",P.style.right="0",P.style.bottom="0",P.style.width="0",P.style.height="0",P.style.border="0",document.body.appendChild(P);const g=P.contentDocument||P.contentWindow?.document;g&&(g.open(),g.write(x),g.close(),setTimeout(()=>{P.contentWindow?.focus(),P.contentWindow?.print(),setTimeout(()=>document.body.removeChild(P),500)},300))},V=T=>{Ge(T),mt(!0)},ae=T=>T.splittedCode||T.split_id?T.splittedCode||T.split_id:[T.uniqueCode,T.soaSrNo,T.gmsoaNo,T.codeNo,T.assemblyLine].map(x=>x??"").join("|"),J=d.useMemo(()=>{const T=Ct.filter(x=>pe.has(ae(x)));return{count:T.length,qty:T.reduce((x,P)=>x+(P.totalQty||P.qty||0),0),qtyExe:T.reduce((x,P)=>x+(P.qtyExe||0),0),qtyPending:T.reduce((x,P)=>x+(P.qtyPending||0),0)}},[pe,Ct]),K=()=>{const T=q===!0,x=re===!0,P=pe.size>0;if(!T&&!x&&!P)return;const g=P?Ct.filter(m=>pe.has(ae(m))):Ct;if(!g.length){alert("No data available to export");return}oe(g)},de=()=>{const T=c&&c.length>0?c:a;if(!T||T.length===0){alert("No data available to export");return}oe(T)},oe=T=>{const x=T.map((v,N)=>({No:N+1,"Assembly Line":v.assemblyLine,"GMSOA No":v.gmsoaNo,"SOA Sr No":v.soaSrNo,"Assembly Date":v.assemblyDate,"Unique Code":v.uniqueCode,"Splitted Code":v.splittedCode||"-",Party:v.party,"Customer PO No":v.customerPoNo,"Code No":v.codeNo,Product:v.product,"PO Qty":v.poQty,Qty:v.qty,"Qty Executed":v.qtyExe,"Qty Pending":v.qtyPending,"Finished Valve":v.finishedValve,"GM Logo":v.gmLogo,"Name Plate":v.namePlate,"Special Notes":v.specialNotes||"","Product Special 1":v.productSpcl1,"Product Special 2":v.productSpcl2,"Product Special 3":v.productSpcl3,Inspection:v.inspection,Painting:v.painting,Remarks:v.remarks||""})),P=Gt.json_to_sheet(x),g=Gt.book_new();Gt.book_append_sheet(g,P,"Orders");const m=Jr(g,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([m],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},_e=T=>{It(T),St(T.remarks||""),et(!0)},Be=async()=>{if(!He)return;const T=new FormData;T.append("orderId",String(He.id)),T.append("remarks",yt);try{const x=await xt.post(`${qt}/add-remarks`,T,{headers:{Authorization:`Bearer ${vt}`}});if(console.log("Add Remarks Response:",x.data),x.data?.Resp_code==="true"||x.data?.Resp_code===!0){l(g=>g.map(m=>m.id===He.id?{...m,remarks:yt}:m));try{t(He.id,yt)}catch{}et(!1),It(null),St("")}else console.warn("Backend rejected remarks:",x.data)}catch(x){console.error("Error saving remarks:",x)}},Ae=T=>[...T].sort((x,P)=>(x.originalIndex??0)-(P.originalIndex??0)),[Ne,je]=d.useState(null),[Me,We]=d.useState(!1),ge=async()=>{if(!Me&&z&&rr()){We(!0),je({type:"info",message:"Assigning order, please wait..."});try{const T=localStorage.getItem("token");if(!T){je({type:"error",message:"Token missing. Please log in again."});return}const P=nt("testing2"),g=Number(Ce||0),m=Number(lt||0),v=ve||(Array.isArray(Vt)?Vt[0]:"testing2"),N=nt(v),A=new FormData;A.append("orderId",String(z.id)),A.append("totalQty",String(z.totalQty??z.qty??0)),A.append("executedQty",String(g)),A.append("currentSteps",P),A.append("nextSteps",N),A.append("split_id",String(z.split_id||""));const R=await xt.post(`${qt}/assign-order`,A,{headers:{Authorization:`Bearer ${T}`}});if(!(R.data?.Resp_code===!0||R.data?.Resp_code==="true"||R.data?.status===!0)){je({type:"error",message:R.data?.Resp_desc||"Main assignment failed."});return}let Te=` Assigned ${g}  ${N}`;if(De&&m>0){const ie=new FormData;ie.append("orderId",String(z.id)),ie.append("totalQty",String(z.totalQty??z.qty??0)),ie.append("executedQty",String(m)),ie.append("currentSteps",P),ie.append("nextSteps",N),ie.append("split_id",String(z.split_id||""));const Oe=await xt.post(`${qt}/assign-order`,ie,{headers:{Authorization:`Bearer ${T}`}});Oe.data?.Resp_code===!0||Oe.data?.Resp_code==="true"||Oe.data?.status===!0?Te+=`
 Split ${m}  ${N}`:je({type:"error",message:"Main assigned but split failed: "+(Oe.data?.Resp_desc||"Unknown error")})}je({type:"success",message:Te});const rt=ie=>ie.splittedCode||ie.split_id?ie.splittedCode||ie.split_id:[ie.uniqueCode,ie.soaSrNo,ie.gmsoaNo,ie.codeNo,ie.assemblyLine].map(Oe=>Oe??"").join("|"),Y=rt(z);l(ie=>ie.filter(Oe=>rt(Oe)!==Y)),se(ie=>{const Oe=new Set(ie);return Oe.delete(Y),Oe}),setTimeout(()=>{ue(!1),je(null)},1e3)}catch(T){console.error(" Error assigning order:",T),je({type:"error",message:T?.response?.data?.Resp_desc||T?.response?.data?.message||"Server error while assigning."})}finally{We(!1)}}},W=()=>{le("all"),he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:T=>{window.location.href=`/${T.toLowerCase()}`},onUploadSuccess:()=>Bt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Testing 2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:ir,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{onClick:K,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:de,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:Qt,onClearFilters:W,hasActiveFilters:G!=="all"||Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(At),onClick:er,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${At?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-32",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
              text-xs font-medium text-gray-500 uppercase tracking-wider\r
              border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(T=>T==="asc"?"desc":T==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:bt.map(T=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:pe.has(Pt(T)),onCheckedChange:()=>gt(Pt(T))})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:T.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:T.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:T.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:T.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:T.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:T.party,children:$e(T.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:T.product,children:T.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:T.specialNotes,children:T.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:T.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:T.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${T.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>_e(T),children:e.jsx(is,{className:`h-4 w-4 ${T.remarks?.trim()?"text-white":"text-blue-600"}`})}),T.remarks?.trim()&&e.jsx("div",{className:`\r
                                                          absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                          hidden group-hover:block\r
                                                          bg-gray-900 text-white text-xs\r
                                                          px-3 py-2 rounded-md shadow-lg\r
                                                          max-w-[260px] break-words z-[999]\r
                                                        `,children:T.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>V(T),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>zt(T),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${T.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${T.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},T.splittedCode||T.split_id||T.uniqueCode||T.id))})]}),Ct.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),J.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:J.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:J.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:J.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:J.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:Ct.length,lastPage:Math.max(1,Math.ceil(Ct.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:U,onOpenChange:ue,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:ve,onValueChange:fe,children:[e.jsx(ss,{id:"assignStep",disabled:!0,children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:Vt.map(T=>e.jsx(Pr,{value:T,children:nt(T)},T))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Ce,onChange:T=>Le(T.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),Ne&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Ne.type==="success"?"bg-green-50 text-green-700 border border-green-200":Ne.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Ne.message.split(`
`).map((T,x)=>e.jsx("div",{children:T},x))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:nr,disabled:Me,children:"Cancel"}),e.jsx(ee,{onClick:ge,disabled:Me,className:"bg-black hover:bg-gray-800 text-white",children:Me?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:ut,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:lr.map(T=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",T.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(T.gmsoaNo).replace(/^SOA/i,""),"-",T.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",T.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:T.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:T.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",T.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",T.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:T.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},T.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(ee,{onClick:ar,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:jt,onOpenChange:mt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>mt(!1),children:"Close"})})]})}),e.jsx(Ot,{open:ot,onOpenChange:et,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:yt,onChange:T=>St(T.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>et(!1),children:"Cancel"}),e.jsx(ee,{onClick:Be,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function mf(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),[pe,se]=d.useState(new Set),[U,ue]=d.useState(!1),[z,ne]=d.useState(null),[ve,fe]=d.useState(""),[Ce,Le]=d.useState(""),[De,Ve]=d.useState(!1),[tt,Nt]=d.useState(""),[lt,$t]=d.useState(""),[qe,Ie]=d.useState({}),[ut,it]=d.useState(!1),[jt,mt]=d.useState(!1),[xe,Ge]=d.useState(null),[ot,et]=d.useState(!1),[He,It]=d.useState(null),[yt,St]=d.useState(""),[ct,Yt]=d.useState(null),[te,Ze]=d.useState(!1),[at,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),vt=localStorage.getItem("token");(()=>{try{const x=localStorage.getItem("user");if(!x)return"";const P=JSON.parse(x),g=typeof P.role=="object"?P.role?.name:P.role;return String(g||"").toLowerCase()}catch{return""}})().includes("admin");const Et=async()=>{try{h(!0),w(null);const g={menu_name:nt("marking1")},m=await xt.post(`${qt}/order-list`,g,{headers:{Authorization:`Bearer ${vt}`}});if((m?.data?.Resp_code==="true"||m?.data?.Resp_code===!0||m?.data?.Resp_code==="RCS")&&Array.isArray(m.data.data)){const N=m.data.data.map(A=>({id:String(A.id),assemblyLine:A.assembly_no||"",gmsoaNo:A.soa_no||"",soaSrNo:A.soa_sr_no||"",assemblyDate:A.assembly_date||"",uniqueCode:A.unique_code||A.order_no||"",splittedCode:A.splitted_code||"",split_id:A.split_id||A.splitted_code||"",party:A.party_name||A.party||"",customerPoNo:A.customer_po_no||"",codeNo:A.code_no||"",product:A.product||"",qty:Number(A.qty||0),totalQty:Number(A.totalQty||A.total_qty||A.qty||0),qtyExe:Number(A.qty_executed||0),qtyPending:Number(A.qty_pending||0),finishedValve:A.finished_valve||"",gmLogo:A.gm_logo||"",namePlate:A.name_plate||"",specialNotes:A.special_notes||A.special_note||"",productSpcl1:A.product_spc1||"",productSpcl2:A.product_spc2||"",productSpcl3:A.product_spc3||"",inspection:A.inspection||"",painting:A.painting||"",remarks:A.remarks||"",alertStatus:A.is_urgent===!0||A.is_urgent==="true"||A.alert_status===!0||A.alert_status==="true"||A.urgent===1||A.urgent==="1"}));console.log(" Orders fetched:",N.length,"records"),l(Ne(N)),w(null),Ke(null)}else console.warn(" No valid order data received",m.data),l([]),w(m?.data?.Resp_desc||"Failed to fetch orders")}catch(x){console.error("Error fetching orders:",x),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Qt=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{Qt||Et()},[j,k,Qt]);const Ct=d.useMemo(()=>Array.from(new Set(a.map(x=>x.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(x=>x.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(x=>x.party))).filter(Boolean).sort(),[a]);const bt=x=>{const P=parseInt(x,10);return isNaN(P)?0:P},$e=d.useMemo(()=>{let x=a.slice();if(q&&(x=x.filter(m=>n(String(m.id))||m.alertStatus)),re&&(x=x.filter(m=>typeof m.remarks=="string"&&m.remarks.trim().length>0)),G!=="all"&&(x=x.filter(m=>m.assemblyLine===G)),Z!=="all"&&(x=x.filter(m=>m.gmsoaNo===Z)),ce!=="all"&&(x=x.filter(m=>m.party===ce)),(X||Q)&&(x=x.filter(m=>{if(!m.assemblyDate||m.assemblyDate==="HOLD")return!1;const N=m.assemblyDate.split(/[\/-]/).map(R=>R.trim()).map(R=>Number(R));if(N.some(R=>isNaN(R)))return!1;let A=null;if(N.length>=3){const[R,D,Te]=N;A=new Date(Te,D-1,R)}else if(N.length===2){const[R,D]=N;A=new Date(D,R-1,1)}else if(N.length===1){const[R]=N;A=new Date(R,0,1)}else return!1;if(!A||isNaN(A.getTime()))return!1;if(Ee==="year"&&X)return A.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return A.getFullYear()===X.getFullYear()&&A.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return A>=X&&A<=Q;if(X)return A>=X;if(Q)return A<=Q}return!0})),F.trim()){const m=F.toLowerCase();x=x.filter(v=>String(v.uniqueCode).toLowerCase().includes(m)||String(v.party).toLowerCase().includes(m)||String(v.gmsoaNo).toLowerCase().includes(m)||String(v.customerPoNo).toLowerCase().includes(m)||String(v.codeNo).toLowerCase().includes(m)||String(v.product).toLowerCase().includes(m))}const P=new Set,g=m=>m.splittedCode||m.split_id||m.uniqueCode||m.id;return x=x.filter(m=>{const v=g(m);return P.has(v)?!1:(P.add(v),!0)}),_&&(x=[...x].sort((m,v)=>{const N=bt(m.soaSrNo),A=bt(v.soaSrNo);return _==="asc"?N-A:A-N})),x},[a,F,q,re,G,Z,ce,Ee,X,Q,n,_]),gt=d.useMemo(()=>{const x=(j-1)*k;return $e.slice(x,x+k)},[$e,j,k]);d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const Pt=(x="",P=4)=>{const g=x.trim().split(/\s+/);return g.length<=P?x:g.slice(0,P).join(" ")+"..."},er=x=>{se(P=>{const g=new Set(P);return g.has(x)?g.delete(x):g.add(x),g})},At=()=>{se(x=>x.size===$e.length?new Set:new Set($e.map(P=>P.id)))},Ut=$e.length>0&&pe.size===$e.length,Vt="marking1",zt=wr(Vt);console.log("Next step(s):",zt.map(nt)),console.log("Is final step?",hn(Vt));const rr=x=>{const g=wr("marking1");ne(x),ue(!0),fe(g[0]||""),Le(String(x.qtyPending??x.qty??0)),Me(null),ge(!1),Ve(!1),Nt(""),$t(""),Ie({})},nr=()=>{const x={},P=Number(z?.qtyPending??0),g=Number(Ce||0),m=Number(lt||0);if(ve||(x.quickAssignStep="Please select a workflow step."),(!Ce||g<=0)&&(x.quickAssignQty="Quantity must be greater than 0."),g>P&&(x.quickAssignQty=`Cannot exceed available (${P})`),De){tt||(x.splitAssignStep="Choose split step."),(!lt||m<=0)&&(x.splitAssignQty="Split quantity is required."),ve===tt&&(x.sameEngineer="Split step cannot be the same as main step.");const v=g+m;v!==P&&(x.totalQtyMismatch=`Total quantity (${v}) must equal available (${P}).`)}return Ie(x),Object.keys(x).length===0},lr=()=>{ge(!1),Me(null),ue(!1),ne(null),fe(""),Le(""),Ve(!1),Nt(""),$t(""),Ie({})},ir=a.filter(x=>pe.has(x.id)),ar=()=>it(!0),V=()=>{const P=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ir.map(v=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${v.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(v.gmsoaNo).replace(/^SOA/i,"")}-${v.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${v.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${v.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${v.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${v.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${v.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${v.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,g=document.createElement("iframe");g.style.position="fixed",g.style.right="0",g.style.bottom="0",g.style.width="0",g.style.height="0",g.style.border="0",document.body.appendChild(g);const m=g.contentDocument||g.contentWindow?.document;m&&(m.open(),m.write(P),m.close(),setTimeout(()=>{g.contentWindow?.focus(),g.contentWindow?.print(),setTimeout(()=>document.body.removeChild(g),500)},300))},ae=x=>x.splittedCode||x.split_id?x.splittedCode||x.split_id:[x.uniqueCode,x.soaSrNo,x.gmsoaNo,x.codeNo,x.assemblyLine].map(P=>P??"").join("|"),J=d.useMemo(()=>{const x=$e.filter(P=>pe.has(String(P.id)));return{count:x.length,qty:x.reduce((P,g)=>P+(g.totalQty||g.qty||0),0),qtyExe:x.reduce((P,g)=>P+(g.qtyExe||0),0),qtyPending:x.reduce((P,g)=>P+(g.qtyPending||0),0)}},[pe,$e]),K=()=>{const x=q===!0,P=re===!0,g=pe.size>0;if(!x&&!P&&!g)return;const m=g?$e.filter(v=>pe.has(ae(v))):$e;if(!m.length){alert("No data available to export");return}oe(m)},de=()=>{const x=c&&c.length>0?c:a;if(!x||x.length===0){alert("No data available to export");return}oe(x)},oe=x=>{const P=x.map((N,A)=>({No:A+1,"Assembly Line":N.assemblyLine,"GMSOA No":N.gmsoaNo,"SOA Sr No":N.soaSrNo,"Assembly Date":N.assemblyDate,"Unique Code":N.uniqueCode,"Splitted Code":N.splittedCode||"-",Party:N.party,"Customer PO No":N.customerPoNo,"Code No":N.codeNo,Product:N.product,"PO Qty":N.poQty,Qty:N.qty,"Qty Executed":N.qtyExe,"Qty Pending":N.qtyPending,"Finished Valve":N.finishedValve,"GM Logo":N.gmLogo,"Name Plate":N.namePlate,"Special Notes":N.specialNotes||"","Product Special 1":N.productSpcl1,"Product Special 2":N.productSpcl2,"Product Special 3":N.productSpcl3,Inspection:N.inspection,Painting:N.painting,Remarks:N.remarks||""})),g=Gt.json_to_sheet(P),m=Gt.book_new();Gt.book_append_sheet(m,g,"Orders");const v=Jr(m,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([v],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},_e=x=>{Ge(x),mt(!0)},Be=x=>{It(x),St(s(x.id)||x.remarks||""),et(!0)},Ae=()=>{He&&(t(He.id,yt),et(!1),It(null),St(""))},Ne=x=>[...x].sort((P,g)=>(P.originalIndex??0)-(g.originalIndex??0)),[je,Me]=d.useState(null),[We,ge]=d.useState(!1),W=async()=>{if(!We&&z&&nr()){ge(!0),Me({type:"info",message:"Assigning order, please wait..."});try{const x=localStorage.getItem("token");if(!x){Me({type:"error",message:"Token missing. Please log in again."});return}const P=Number(Ce||0),g=Number(lt||0),v=nt("marking1"),N=ve||(Array.isArray(zt)?zt[0]:"marking2"),A=nt(N),R=new FormData;R.append("orderId",String(z.id)),R.append("totalQty",String(z.totalQty??z.qty??0)),R.append("executedQty",String(P)),R.append("currentSteps",v),R.append("nextSteps",A),R.append("split_id",String(z.split_id||"")),console.log(" MAIN PAYLOAD:",Object.fromEntries(R.entries()));const D=await xt.post(`${qt}/assign-order`,R,{headers:{Authorization:`Bearer ${x}`}});if(!(D.data?.Resp_code==="true"||D.data?.Resp_code===!0||D.data?.status===!0)){Me({type:"error",message:D.data?.Resp_desc||"Main assignment failed."});return}let rt=` Assigned ${P}  ${A}`;if(De&&g>0){const Oe=new FormData;Oe.append("orderId",String(z.id)),Oe.append("totalQty",String(z.totalQty??z.qty??0)),Oe.append("executedQty",String(g)),Oe.append("currentSteps",v),Oe.append("nextSteps",A),Oe.append("split_id",String(z.split_id||"")),console.log(" SPLIT PAYLOAD:",Object.fromEntries(Oe.entries()));const Se=await xt.post(`${qt}/assign-order`,Oe,{headers:{Authorization:`Bearer ${x}`}});Se.data?.Resp_code==="true"||Se.data?.Resp_code===!0||Se.data?.status===!0?rt+=`
 Split ${g}  ${A}`:Me({type:"error",message:"Main assigned but split failed: "+(Se.data?.Resp_desc||"Unknown error")})}Me({type:"success",message:rt});const Y=Oe=>Oe.splittedCode||Oe.split_id?Oe.splittedCode||Oe.split_id:[Oe.uniqueCode,Oe.soaSrNo,Oe.gmsoaNo,Oe.codeNo,Oe.assemblyLine].map(Se=>Se??"").join("|"),ie=Y(z);l(Oe=>Oe.filter(Se=>Y(Se)!==ie)),se(Oe=>{const Se=new Set(Oe);return Se.delete(ie),Se}),setTimeout(()=>{ue(!1),Me(null)},1e3)}catch(x){console.error(" Error assigning order:",x),Me({type:"error",message:"Server error while assigning."})}finally{ge(!1)}}},T=()=>{le("all"),he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:x=>{window.location.href=`/${x.toLowerCase()}`},onUploadSuccess:()=>Et()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Marking 1"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:ar,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{disabled:$e.length===0,onClick:K,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:de,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:Ct,onClearFilters:T,hasActiveFilters:G!=="all"||Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ut),onClick:At,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ut?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(x=>x==="asc"?"desc":x==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:gt.map(x=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:pe.has(x.id),onCheckedChange:()=>er(x.id),"aria-label":`Select row ${x.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:x.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:x.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:x.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:x.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:x.party,children:Pt(x.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:x.product,children:x.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:x.specialNotes,children:x.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:x.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:x.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${x.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Be(x),children:e.jsx(is,{className:`h-4 w-4 ${x.remarks?.trim()?"text-white":"text-blue-600"}`})}),x.remarks?.trim()&&e.jsx("div",{className:`\r
                               absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                               hidden group-hover:block\r
                               bg-gray-900 text-white text-xs\r
                               px-3 py-2 rounded-md shadow-lg\r
                               max-w-[260px] break-words z-[999]\r
                             `,children:x.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>_e(x),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>rr(x),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${x.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${x.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},x.id))})]}),$e.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),J.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:J.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:J.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:J.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:J.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:$e.length,lastPage:Math.max(1,Math.ceil($e.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:U,onOpenChange:ue,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:ve,onValueChange:fe,children:[e.jsx(ss,{id:"assignStep",disabled:!0,children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:zt.map(x=>e.jsx(Pr,{value:x,children:nt(x)},x))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Ce,onChange:x=>Le(x.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),je&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${je.type==="success"?"bg-green-50 text-green-700 border border-green-200":je.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:je.message.split(`
`).map((x,P)=>e.jsx("div",{children:x},P))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:lr,children:"Cancel"}),e.jsx(ee,{onClick:W,disabled:We,className:"bg-black hover:bg-gray-800 text-white",children:We?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:ut,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ir.map(x=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",x.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(x.gmsoaNo).replace(/^SOA/i,""),"-",x.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",x.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:x.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:x.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",x.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",x.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:x.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},x.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(ee,{onClick:V,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:jt,onOpenChange:mt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>mt(!1),children:"Close"})})]})}),e.jsx(Ot,{open:ot,onOpenChange:et,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:yt,onChange:x=>St(x.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:lr,disabled:We,children:"Cancel"}),e.jsx(ee,{onClick:Ae,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function pf(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),[pe,se]=d.useState(new Set),[U,ue]=d.useState(!1),[z,ne]=d.useState(null),[ve,fe]=d.useState(""),[Ce,Le]=d.useState(""),[De,Ve]=d.useState(!1),[tt,Nt]=d.useState(""),[lt,$t]=d.useState(""),[qe,Ie]=d.useState({}),[ut,it]=d.useState(!1),[jt,mt]=d.useState(!1),[xe,Ge]=d.useState(null),[ot,et]=d.useState(!1),[He,It]=d.useState(null),[yt,St]=d.useState(""),[ct,Yt]=d.useState(null),[te,Ze]=d.useState(!1),[at,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),vt=localStorage.getItem("token");(()=>{try{const g=localStorage.getItem("user");if(!g)return"";const m=JSON.parse(g),v=typeof m.role=="object"?m.role?.name:m.role;return String(v||"").toLowerCase()}catch{return""}})().includes("admin");const Et=async()=>{try{h(!0),w(null);const v={menu_name:nt("marking2")},N=await xt.post(`${qt}/order-list`,v,{headers:{Authorization:`Bearer ${vt}`}});if((N?.data?.Resp_code==="true"||N?.data?.Resp_code===!0||N?.data?.Resp_code==="RCS")&&Array.isArray(N.data.data)){const R=N.data.data.map(D=>({id:String(D.id),order_id:String(D.order_id),assemblyLine:D.assembly_no||"",gmsoaNo:D.soa_no||"",soaSrNo:D.soa_sr_no||"",assemblyDate:D.assembly_date||"",uniqueCode:D.unique_code||D.order_no||"",splittedCode:D.splitted_code||"",split_id:D.split_id||D.splitted_code||"",party:D.party_name||D.party||"",customerPoNo:D.customer_po_no||"",codeNo:D.code_no||"",product:D.product||"",totalQty:Number(D.totalQty||D.total_qty||D.qty||0),qty:Number(D.qty||0),qtyExe:Number(D.qty_executed||0),qtyPending:Number(D.qty_pending||0),finishedValve:D.finished_valve||"",gmLogo:D.gm_logo||"",namePlate:D.name_plate||"",specialNotes:D.special_notes||D.special_note||"",productSpcl1:D.product_spc1||"",productSpcl2:D.product_spc2||"",productSpcl3:D.product_spc3||"",inspection:D.inspection||"",painting:D.painting||"",remarks:D.remarks||"",alertStatus:D.is_urgent===!0||D.is_urgent==="true"||D.alert_status===!0||D.alert_status==="true"||D.urgent===1||D.urgent==="1"}));console.log(" Orders fetched:",R.length,"records"),l(je(R)),u(null),w(null),Ke(null)}else console.warn(" No valid order data received",N.data),l([]),w(N?.data?.Resp_desc||"Failed to fetch orders")}catch(g){console.error("Error fetching orders:",g),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Qt=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{Qt||Et()},[j,k,Qt]);const Ct=d.useMemo(()=>Array.from(new Set(a.map(g=>g.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(g=>g.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(g=>g.party))).filter(Boolean).sort(),[a]);const bt=g=>{const m=parseInt(g,10);return isNaN(m)?0:m},$e=d.useMemo(()=>{let g=a.slice();if(q&&(g=g.filter(N=>n(String(N.id))||N.alertStatus)),re&&(g=g.filter(N=>typeof N.remarks=="string"&&N.remarks.trim().length>0)),G!=="all"&&(g=g.filter(N=>N.assemblyLine===G)),Z!=="all"&&(g=g.filter(N=>N.gmsoaNo===Z)),ce!=="all"&&(g=g.filter(N=>N.party===ce)),(X||Q)&&(g=g.filter(N=>{if(!N.assemblyDate||N.assemblyDate==="HOLD")return!1;const R=N.assemblyDate.split(/[\/-]/).map(Te=>Te.trim()).map(Te=>Number(Te));if(R.some(Te=>isNaN(Te)))return!1;let D=null;if(R.length>=3){const[Te,rt,Y]=R;D=new Date(Y,rt-1,Te)}else if(R.length===2){const[Te,rt]=R;D=new Date(rt,Te-1,1)}else if(R.length===1){const[Te]=R;D=new Date(Te,0,1)}else return!1;if(!D||isNaN(D.getTime()))return!1;if(Ee==="year"&&X)return D.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return D.getFullYear()===X.getFullYear()&&D.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return D>=X&&D<=Q;if(X)return D>=X;if(Q)return D<=Q}return!0})),F.trim()){const N=F.toLowerCase();g=g.filter(A=>String(A.uniqueCode).toLowerCase().includes(N)||String(A.party).toLowerCase().includes(N)||String(A.gmsoaNo).toLowerCase().includes(N)||String(A.customerPoNo).toLowerCase().includes(N)||String(A.codeNo).toLowerCase().includes(N)||String(A.product).toLowerCase().includes(N))}const m=new Set,v=N=>N.splittedCode||N.split_id||N.uniqueCode||N.id;return g=g.filter(N=>{const A=v(N);return m.has(A)?!1:(m.add(A),!0)}),_&&(g=[...g].sort((N,A)=>{const R=bt(N.soaSrNo),D=bt(A.soaSrNo);return _==="asc"?R-D:D-R})),g},[a,F,re,q,G,Z,ce,Ee,X,Q,n,_]),gt=g=>g.splittedCode||g.split_id||g.uniqueCode||g.id,Pt=d.useMemo(()=>{const g=$e.filter(m=>pe.has(gt(m)));return{count:g.length,qty:g.reduce((m,v)=>m+(v.totalQty||v.qty||0),0),qtyExe:g.reduce((m,v)=>m+(v.qtyExe||0),0),qtyPending:g.reduce((m,v)=>m+(v.qtyPending||0),0)}},[pe,$e]),er=d.useMemo(()=>{const g=(j-1)*k;return $e.slice(g,g+k)},[$e,j,k]);d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const At=(g="",m=4)=>{const v=g.trim().split(/\s+/);return v.length<=m?g:v.slice(0,m).join(" ")+"..."},Ut=g=>{se(m=>{const v=new Set(m);return v.has(g)?v.delete(g):v.add(g),v})},Vt=()=>{se(g=>{const m=$e.map(gt);return m.every(N=>g.has(N))?new Set:new Set(m)})},zt=$e.length>0&&$e.every(g=>pe.has(gt(g))),rr="marking2",nr=wr(rr);console.log("Next step(s):",nr.map(nt)),console.log("Is final step?",hn(rr));const lr=g=>{const v=wr("marking2");ne(g),ue(!0),fe(v[0]||""),Le(String(g.qtyPending??g.qty??0)),We(null),W(!1),Ve(!1),Nt(""),$t(""),Ie({})},ir=()=>{const g={},m=Number(z?.qtyPending??0),v=Number(Ce||0),N=Number(lt||0);if(ve||(g.quickAssignStep="Please select a workflow step."),(!Ce||v<=0)&&(g.quickAssignQty="Quantity must be greater than 0."),v>m&&(g.quickAssignQty=`Cannot exceed available (${m})`),De){tt||(g.splitAssignStep="Choose split step."),(!lt||N<=0)&&(g.splitAssignQty="Split quantity is required."),ve===tt&&(g.sameEngineer="Split step cannot be the same as main step.");const A=v+N;A!==m&&(g.totalQtyMismatch=`Total quantity (${A}) must equal available (${m}).`)}return Ie(g),Object.keys(g).length===0},ar=()=>{W(!1),We(null),ue(!1),ne(null),fe(""),Le(""),Ve(!1),Nt(""),$t(""),Ie({})},V=a.filter(g=>pe.has(g.id)),ae=()=>it(!0),J=()=>{const m=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${V.map(A=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${A.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(A.gmsoaNo).replace(/^SOA/i,"")}-${A.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${A.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${A.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${A.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${A.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${A.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${A.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,v=document.createElement("iframe");v.style.position="fixed",v.style.right="0",v.style.bottom="0",v.style.width="0",v.style.height="0",v.style.border="0",document.body.appendChild(v);const N=v.contentDocument||v.contentWindow?.document;N&&(N.open(),N.write(m),N.close(),setTimeout(()=>{v.contentWindow?.focus(),v.contentWindow?.print(),setTimeout(()=>document.body.removeChild(v),500)},300))},K=g=>g.splittedCode||g.split_id?g.splittedCode||g.split_id:[g.uniqueCode,g.soaSrNo,g.gmsoaNo,g.codeNo,g.assemblyLine].map(m=>m??"").join("|"),de=()=>{const g=q===!0,m=re===!0,v=pe.size>0;if(!g&&!m&&!v)return;const N=v?$e.filter(A=>pe.has(K(A))):$e;if(!N.length){alert("No data available to export");return}_e(N)},oe=()=>{const g=c&&c.length>0?c:a;if(!g||g.length===0){alert("No data available to export");return}_e(g)},_e=g=>{const m=g.map((R,D)=>({No:D+1,"Assembly Line":R.assemblyLine,"GMSOA No":R.gmsoaNo,"SOA Sr No":R.soaSrNo,"Assembly Date":R.assemblyDate,"Unique Code":R.uniqueCode,"Splitted Code":R.splittedCode||"-",Party:R.party,"Customer PO No":R.customerPoNo,"Code No":R.codeNo,Product:R.product,"PO Qty":R.poQty,Qty:R.qty,"Qty Executed":R.qtyExe,"Qty Pending":R.qtyPending,"Finished Valve":R.finishedValve,"GM Logo":R.gmLogo,"Name Plate":R.namePlate,"Special Notes":R.specialNotes||"","Product Special 1":R.productSpcl1,"Product Special 2":R.productSpcl2,"Product Special 3":R.productSpcl3,Inspection:R.inspection,Painting:R.painting,Remarks:R.remarks||""})),v=Gt.json_to_sheet(m),N=Gt.book_new();Gt.book_append_sheet(N,v,"Orders");const A=Jr(N,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([A],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Be=g=>{Ge(g),mt(!0)},Ae=g=>{It(g),St(s(g.id)||g.remarks||""),et(!0)},Ne=()=>{He&&(t(He.id,yt),l(g=>g.map(m=>m.id===He.id?{...m,remarks:yt}:m)),Ge(g=>g&&g.id===He.id?{...g,remarks:yt}:g),et(!1),It(null),St(""))},je=g=>[...g].sort((m,v)=>(m.originalIndex??0)-(v.originalIndex??0)),[Me,We]=d.useState(null),[ge,W]=d.useState(!1),T="marking2",x=async()=>{if(!ge&&z&&ir()){W(!0),We({type:"info",message:"Assigning order, please wait..."});try{const g=localStorage.getItem("token");if(!g){We({type:"error",message:"Token missing. Please log in again."});return}const m=Number(Ce||0),v=Number(lt||0),N=ve||(Array.isArray(nr)?nr[0]:"marking2"),A=nt(N),R=nt(T),D=new FormData;D.append("orderId",String(z.id)),D.append("totalQty",String(z.totalQty??z.qty??0)),D.append("executedQty",String(m)),D.append("currentSteps",R),D.append("nextSteps",A),D.append("split_id",String(z.split_id||""));const Te=await xt.post(`${qt}/assign-order`,D,{headers:{Authorization:`Bearer ${g}`}});if(!(Te.data?.Resp_code==="true"||Te.data?.Resp_code===!0)){We({type:"error",message:Te.data?.Resp_desc||"Main assignment failed."});return}let Y=` Assigned ${m}  ${A}`;if(De&&v>0){const Se=new FormData;Se.append("orderId",String(z.id)),Se.append("totalQty",String(z.totalQty??z.qty??0)),Se.append("executedQty",String(v)),Se.append("nextSteps",A),Se.append("split_id",String(z.split_id||""));const Je=await xt.post(`${qt}/assign-order`,Se,{headers:{Authorization:`Bearer ${g}`}});Je.data?.Resp_code==="true"||Je.data?.Resp_code===!0?Y+=`
 Split ${v}  ${A}`:We({type:"error",message:"Main assigned but split failed: "+(Je.data?.Resp_desc||"Unknown error")})}We({type:"success",message:Y});const ie=Se=>Se.splittedCode||Se.split_id?Se.splittedCode||Se.split_id:[Se.uniqueCode,Se.soaSrNo,Se.gmsoaNo,Se.codeNo,Se.assemblyLine].map(Je=>Je??"").join("|"),Oe=ie(z);l(Se=>Se.filter(Je=>ie(Je)!==Oe)),se(Se=>{const Je=new Set(Se);return Je.delete(Oe),Je}),setTimeout(()=>{ue(!1),We(null)},1e3)}catch(g){console.error(" Error assigning order:",g),We({type:"error",message:"Server error while assigning."})}finally{W(!1)}}},P=()=>{le("all"),he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:g=>{window.location.href=`/${g.toLowerCase()}`},onUploadSuccess:()=>Et()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Marking 2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:ae,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{disabled:$e.length===0,onClick:de,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:oe,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:Ct,onClearFilters:P,hasActiveFilters:G!=="all"||Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(zt),onClick:Vt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${zt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(g=>g==="asc"?"desc":g==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:er.map(g=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:pe.has(g.splittedCode||g.split_id||g.uniqueCode||g.id),onCheckedChange:()=>Ut(g.splittedCode||g.split_id||g.uniqueCode||g.id),"aria-label":`Select row ${g.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:g.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:g.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:g.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:g.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:g.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:g.party,children:At(g.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:g.product,children:g.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:g.specialNotes,children:g.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:g.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:g.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:g.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${g.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Ae(g),children:e.jsx(is,{className:`h-4 w-4 ${g.remarks?.trim()?"text-white":"text-blue-600"}`})}),g.remarks?.trim()&&e.jsx("div",{className:`\r
                                                                          absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                                          hidden group-hover:block\r
                                                                          bg-gray-900 text-white text-xs\r
                                                                          px-3 py-2 rounded-md shadow-lg\r
                                                                          max-w-[260px] break-words z-[999]\r
                                                                        `,children:g.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>Be(g),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>lr(g),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${g.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${g.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},g.splittedCode||g.split_id||g.uniqueCode||g.id))})]}),$e.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),Pt.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:Pt.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:Pt.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:Pt.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:Pt.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:$e.length,lastPage:Math.max(1,Math.ceil($e.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:U,onOpenChange:ue,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:ve,onValueChange:fe,children:[e.jsx(ss,{id:"assignStep",disabled:!0,children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:nr.map(g=>e.jsx(Pr,{value:g,children:nt(g)},g))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Ce,onChange:g=>Le(g.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),Me&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Me.type==="success"?"bg-green-50 text-green-700 border border-green-200":Me.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Me.message.split(`
`).map((g,m)=>e.jsx("div",{children:g},m))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:ar,disabled:ge,children:"Cancel"}),e.jsx(ee,{onClick:x,disabled:ge,className:"bg-black hover:bg-gray-800 text-white",children:ge?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:ut,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:V.map(g=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",g.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(g.gmsoaNo).replace(/^SOA/i,""),"-",g.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",g.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:g.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:g.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",g.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",g.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:g.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},g.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(ee,{onClick:J,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:jt,onOpenChange:mt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>mt(!1),children:"Close"})})]})}),e.jsx(Ot,{open:ot,onOpenChange:et,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:yt,onChange:g=>St(g.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>et(!1),children:"Cancel"}),e.jsx(ee,{onClick:Ne,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function xf(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),a=En(),[l,c]=d.useState([]),[u,f]=d.useState(null),[h,y]=d.useState(!1),[w,j]=d.useState(null),[C,k]=d.useState(1),[S,_]=d.useState(100),[I,F]=d.useState(null),[B,q]=d.useState(""),[me,re]=d.useState(!1),[M,G]=d.useState(!1),[le,Z]=d.useState("all"),[he,ce]=d.useState("all"),[ke,Ee]=d.useState("all"),[Fe,X]=d.useState("range"),[ye,Q]=d.useState(void 0),[we,pe]=d.useState(void 0),[se,U]=d.useState(new Set),[ue,z]=d.useState(!1),[ne,ve]=d.useState(null),[fe,Ce]=d.useState(""),[Le,De]=d.useState(""),[Ve,tt]=d.useState(!1),[Nt,lt]=d.useState(""),[$t,qe]=d.useState(""),[Ie,ut]=d.useState({}),[it,jt]=d.useState(!1),[mt,xe]=d.useState(!1),[Ge,ot]=d.useState(null),[et,He]=d.useState(!1),[It,yt]=d.useState(null),[St,ct]=d.useState(""),[Yt,te]=d.useState(null),[Ze,at]=d.useState(null),Ke=d.useRef(null),[kt,vt]=d.useState(!1),Bt=localStorage.getItem("token");(()=>{try{const T=localStorage.getItem("user");if(!T)return"";const x=JSON.parse(T),P=typeof x.role=="object"?x.role?.name:x.role;return String(P||"").toLowerCase()}catch{return""}})().includes("admin");const Qt=async()=>{try{y(!0),j(null);const P={menu_name:nt("svs")},g=await xt.post(`${qt}/order-list`,P,{headers:{Authorization:`Bearer ${Bt}`}});if((g?.data?.Resp_code==="true"||g?.data?.Resp_code===!0||g?.data?.Resp_code==="RCS")&&Array.isArray(g.data.data)){const v=g.data.data.map(A=>({id:String(A.id),assemblyLine:A.assembly_no||"",gmsoaNo:A.soa_no||"",soaSrNo:A.soa_sr_no||"",assemblyDate:A.assembly_date||"",uniqueCode:A.unique_code||A.order_no||"",splittedCode:A.splitted_code||"",party:A.party_name||A.party||"",customerPoNo:A.customer_po_no||"",codeNo:A.code_no||"",product:A.product||"",totalQty:Number(A.totalQty||A.total_qty||A.qty||0),qty:Number(A.qty||0),qtyExe:Number(A.qty_executed||0),qtyPending:Number(A.qty_pending||0),finishedValve:A.finished_valve||"",gmLogo:A.gm_logo||"",namePlate:A.name_plate||"",specialNotes:A.special_notes||A.special_note||"",productSpcl1:A.product_spc1||"",productSpcl2:A.product_spc2||"",productSpcl3:A.product_spc3||"",inspection:A.inspection||"",painting:A.painting||"",remarks:A.remarks||"",alertStatus:A.is_urgent===!0||A.is_urgent==="true"||A.alert_status===!0||A.alert_status==="true"||A.urgent===1||A.urgent==="1"}));console.log("SVS orders raw:",v.map(A=>({id:A.id,finishedValve:A.finishedValve})));const N=v.filter(A=>String(A.finishedValve).trim().toLowerCase()==="yes");console.log(" SVS Orders fetched:",N.length,"records"),c(N),f(v),j(null),te(null)}else console.warn(" No valid order data received",g.data),c([]),j(g?.data?.Resp_desc||"Failed to fetch orders")}catch(T){console.error("Error fetching orders:",T),j("Error fetching order list. Please check your token or server.")}finally{y(!1)}};d.useEffect(()=>{Qt()},[]);const Ct=d.useMemo(()=>Array.from(new Set(l.map(T=>T.assemblyLine))).filter(Boolean).sort(),[l]);d.useMemo(()=>Array.from(new Set(l.map(T=>T.gmsoaNo))).filter(Boolean).sort(),[l]),d.useMemo(()=>Array.from(new Set(l.map(T=>T.party))).filter(Boolean).sort(),[l]);const bt=T=>{const x=parseInt(T,10);return isNaN(x)?0:x},$e=d.useMemo(()=>{let T=l.slice();if(me&&(T=T.filter(P=>n(String(P.id))||P.alertStatus)),M&&(T=T.filter(P=>typeof P.remarks=="string"&&P.remarks.trim().length>0)),le!=="all"&&(T=T.filter(P=>P.assemblyLine===le)),he!=="all"&&(T=T.filter(P=>P.gmsoaNo===he)),ke!=="all"&&(T=T.filter(P=>P.party===ke)),(ye||we)&&(T=T.filter(P=>{if(!P.assemblyDate||P.assemblyDate==="HOLD")return!1;const m=P.assemblyDate.split(/[\/-]/).map(N=>N.trim()).map(N=>Number(N));if(m.some(N=>isNaN(N)))return!1;let v=null;if(m.length>=3){const[N,A,R]=m;v=new Date(R,A-1,N)}else if(m.length===2){const[N,A]=m;v=new Date(A,N-1,1)}else if(m.length===1){const[N]=m;v=new Date(N,0,1)}else return!1;if(!v||isNaN(v.getTime()))return!1;if(Fe==="year"&&ye)return v.getFullYear()===ye.getFullYear();if(Fe==="month"&&ye)return v.getFullYear()===ye.getFullYear()&&v.getMonth()===ye.getMonth();if(Fe==="range"){if(ye&&we)return v>=ye&&v<=we;if(ye)return v>=ye;if(we)return v<=we}return!0})),B.trim()){const P=B.toLowerCase();T=T.filter(g=>String(g.uniqueCode).toLowerCase().includes(P)||String(g.party).toLowerCase().includes(P)||String(g.gmsoaNo).toLowerCase().includes(P)||String(g.customerPoNo).toLowerCase().includes(P)||String(g.codeNo).toLowerCase().includes(P)||String(g.product).toLowerCase().includes(P))}const x=new Set;return T=T.filter(P=>x.has(P.id)?!1:(x.add(P.id),!0)),I&&(T=[...T].sort((P,g)=>{const m=bt(P.soaSrNo),v=bt(g.soaSrNo);return I==="asc"?m-v:v-m})),T},[l,B,M,me,le,he,ke,Fe,ye,we,n,I]),gt=d.useMemo(()=>{const T=(C-1)*S;return $e.slice(T,T+S)},[$e,C,S]);d.useEffect(()=>{k(1)},[B,le,he,ke,ye,we,me,M]);const Pt=T=>{U(x=>{const P=new Set(x);return P.has(T)?P.delete(T):P.add(T),P})},er=(T="",x=4)=>{const P=T.trim().split(/\s+/);return P.length<=x?T:P.slice(0,x).join(" ")+"..."},At=()=>{U(T=>T.size===$e.length?new Set:new Set($e.map(x=>x.id)))},Ut=$e.length>0&&se.size===$e.length,Vt=T=>{ve(T),z(!0);const x=T.assemblyLine?.toLowerCase()==="d"?"marking2":"marking1";Ce(x),De(String(T.qtyPending??T.qty??0)),tt(!1),lt(""),qe(""),ut({})},zt=()=>{const T={},x=Number(ne?.qtyPending??0),P=Number(Le||0),g=Number($t||0);if((!Le||P<=0)&&(T.quickAssignQty="Quantity is required and must be > 0"),P>x&&(T.quickAssignQty=`Cannot exceed available (${x})`),Ve){Nt||(T.splitAssignStep="Choose second step"),(!$t||g<=0)&&(T.splitAssignQty="Split qty required"),fe&&Nt&&fe===Nt&&(T.sameEngineer="Choose different steps");const m=P+g;m!==x&&(T.totalQtyMismatch=`Split total must equal ${x} (current ${m})`)}return ut(T),Object.keys(T).length===0},rr=()=>{z(!1)},nr=l.filter(T=>se.has(T.id)),lr=()=>jt(!0),ir=()=>{const x=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${nr.map(m=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${m.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(m.gmsoaNo).replace(/^SOA/i,"")}-${m.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${m.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${m.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${m.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${m.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${m.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${m.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,P=document.createElement("iframe");P.style.position="fixed",P.style.right="0",P.style.bottom="0",P.style.width="0",P.style.height="0",P.style.border="0",document.body.appendChild(P);const g=P.contentDocument||P.contentWindow?.document;g&&(g.open(),g.write(x),g.close(),setTimeout(()=>{P.contentWindow?.focus(),P.contentWindow?.print(),setTimeout(()=>document.body.removeChild(P),500)},300))},ar=T=>{ot(T),xe(!0)},V=T=>T.splittedCode||T.split_id?T.splittedCode||T.split_id:[T.uniqueCode,T.soaSrNo,T.gmsoaNo,T.codeNo,T.assemblyLine].map(x=>x??"").join("|"),ae=d.useMemo(()=>{const T=$e.filter(x=>se.has(String(x.id)));return{count:T.length,qty:T.reduce((x,P)=>x+(P.totalQty||P.qty||0),0),qtyExe:T.reduce((x,P)=>x+(P.qtyExe||0),0),qtyPending:T.reduce((x,P)=>x+(P.qtyPending||0),0)}},[se,$e]),J=()=>{const T=me===!0,x=M===!0,P=se.size>0;if(!T&&!x&&!P)return;const g=P?$e.filter(m=>se.has(V(m))):$e;if(!g.length){alert("No data available to export");return}de(g)},K=()=>{const T=u&&u.length>0?u:l;if(!T||T.length===0){alert("No data available to export");return}de(T)},de=T=>{const x=T.map((v,N)=>({No:N+1,"Assembly Line":v.assemblyLine,"GMSOA No":v.gmsoaNo,"SOA Sr No":v.soaSrNo,"Assembly Date":v.assemblyDate,"Unique Code":v.uniqueCode,"Splitted Code":v.splittedCode||"-",Party:v.party,"Customer PO No":v.customerPoNo,"Code No":v.codeNo,Product:v.product,"PO Qty":v.poQty,Qty:v.qty,"Qty Executed":v.qtyExe,"Qty Pending":v.qtyPending,"Finished Valve":v.finishedValve,"GM Logo":v.gmLogo,"Name Plate":v.namePlate,"Special Notes":v.specialNotes||"","Product Special 1":v.productSpcl1,"Product Special 2":v.productSpcl2,"Product Special 3":v.productSpcl3,Inspection:v.inspection,Painting:v.painting,Remarks:v.remarks||""})),P=Gt.json_to_sheet(x),g=Gt.book_new();Gt.book_append_sheet(g,P,"Orders");const m=Jr(g,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([m],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},oe=T=>{yt(T),ct(s(T.id)||T.remarks||""),He(!0)},_e=async()=>{if(!It)return;const T=new FormData;T.append("orderId",String(It.id)),T.append("remarks",St);try{const x=await xt.post(`${qt}/add-remarks`,T,{headers:{Authorization:`Bearer ${Bt}`}});(x.data?.Resp_code==="true"||x.data?.Resp_code===!0)&&(c(g=>g.map(m=>m.id===It.id?{...m,remarks:St}:m)),t(It.id,St),He(!1),yt(null),ct(""))}catch(x){console.error("Error saving SVS remarks:",x)}},Be=async T=>{const P=l.find(v=>v.id===T)?.alertStatus===!0,g=!P;c(v=>{const N=v.map(A=>A.id===T?{...A,alertStatus:g}:A);return Ae(N)});const m={orderId:String(T),urgent:g?"1":"0"};try{const v=await xt.post(`${qt}/mark-urgent`,m,{headers:{Authorization:`Bearer ${Bt}`}});v.data?.Resp_code==="true"||v.data?.Resp_code===!0||v.data?.status===!0||c(A=>{const R=A.map(D=>D.id===T?{...D,alertStatus:P}:D);return Ae(R)})}catch(v){console.error("Urgent API failed:",v),c(N=>{const A=N.map(R=>R.id===T?{...R,alertStatus:P}:R);return Ae(A)})}},Ae=T=>[...T].sort((x,P)=>(x.originalIndex??0)-(P.originalIndex??0)),[Ne,je]=d.useState(!1),Me="svs",We=async()=>{if(!Ne&&(je(!0),!!ne&&zt())){at({type:"info",message:"Assigning order, please wait..."});try{const T=localStorage.getItem("token");if(!T){at({type:"error",message:"Token missing. Please log in again."});return}const x=Number(Le||0),P=Number($t||0),g=fe||(Array.isArray(nextSteps)?nextSteps[0]:"svs"),m=nt(g),v=nt(Me),N=new FormData;N.append("orderId",String(ne.id)),N.append("totalQty",String(ne.qty)),N.append("executedQty",String(x)),N.append("currentSteps",v),N.append("nextSteps",m),N.append("split_id",String(ne.split_id||"")),console.log(" MAIN PAYLOAD:");for(const Te of N.entries())console.log(Te[0],Te[1]);const A=await xt.post(`${qt}/assign-order`,N,{headers:{Authorization:`Bearer ${T}`}});if(!(A.data?.Resp_code==="true"||A.data?.Resp_code===!0)){at({type:"error",message:A.data?.Resp_desc||"Main assignment failed."});return}let D=` Assigned ${x}  ${m}`;if(Ve&&P>0){const Te=new FormData;Te.append("orderId",String(ne.id)),Te.append("totalQty",String(ne.qty)),Te.append("executedQty",String(P)),Te.append("nextSteps",m),Te.append("split_id",String(ne.split_id||"")),console.log(" SPLIT PAYLOAD:");for(const ie of Te.entries())console.log("SPLIT:",ie[0],ie[1]);const rt=await xt.post(`${qt}/assign-order`,Te,{headers:{Authorization:`Bearer ${T}`}});rt.data?.Resp_code==="true"||rt.data?.Resp_code===!0?D+=`
 Split ${P}  ${m}`:at({type:"error",message:"Main assigned but split failed: "+(rt.data?.Resp_desc||"Unknown error")})}at({type:"success",message:D}),await Qt(),z(!1),at(null)}catch(T){console.error(" Error assigning order:",T),at({type:"error",message:"Server error while assigning."})}finally{je(!1)}}},ge=()=>{Z("all"),ce("all"),Ee("all"),X("range"),Q(void 0),pe(void 0)},W=T=>e.jsxs("table",{className:"w-full border-collapse text-sm",children:[e.jsx("thead",{className:"sticky top-0 z-20 bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-center",children:e.jsx(Ur,{checked:T.length>0&&se.size===T.length,onCheckedChange:At})}),e.jsx("th",{className:"px-3 py-2 text-left",children:"SOA"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center",children:"Executed"}),e.jsx("th",{className:"px-3 py-2 text-center",children:"Pending"}),e.jsx("th",{className:"px-3 py-2 text-center",children:"Urgent"}),e.jsx("th",{className:"px-3 py-2 text-center",children:"Remarks"}),e.jsx("th",{className:"px-3 py-2 text-center",children:"Action"})]})}),e.jsx("tbody",{children:T.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:10,className:"text-center py-6 text-gray-500",children:"No SVS data found"})}):T.map(x=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsx(Ur,{checked:se.has(x.id),onCheckedChange:()=>Pt(x.id)})}),e.jsxs("td",{className:"px-3 py-2",children:[x.gmsoaNo,"-",x.soaSrNo]}),e.jsx("td",{className:"px-3 py-2",children:x.party}),e.jsx("td",{className:"px-3 py-2",children:x.product}),e.jsx("td",{className:"px-3 py-2 text-center",children:x.qty}),e.jsx("td",{className:"px-3 py-2 text-center",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 text-center",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsx(ee,{size:"icon",variant:"ghost",onClick:()=>Be(x.id),children:e.jsx(gr,{className:`h-4 w-4 ${x.alertStatus?"text-red-600":"text-gray-400"}`})})}),e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsx(ee,{size:"icon",variant:"ghost",onClick:()=>oe(x),children:e.jsx(is,{className:"h-4 w-4"})})}),e.jsx("td",{className:"px-3 py-2 text-center",children:e.jsx(ee,{size:"icon",variant:"ghost",onClick:()=>ar(x),children:e.jsx(Hr,{className:"h-4 w-4"})})})]},x.id))})]});return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:T=>{window.location.href=`/${T.toLowerCase()}`},onUploadSuccess:()=>Qt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Stock Valve Store (SVS) Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage stock valve store orders and manufacturing workflow (Finished Valve = Yes)"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:lr,variant:"outline",disabled:se.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>re(!me),className:`btn-urgent flex items-center gap-2 ${me?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),me?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>G(!M),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:M?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{disabled:$e.length===0,onClick:J,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:K,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]}),e.jsx(ee,{className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] text-white shadow-lg hover:shadow-xl",onClick:()=>a("/svs-stock"),children:"Inventory"})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:B,setSearchTerm:q,assemblyLineFilter:le,setAssemblyLineFilter:Z,dateFilterMode:Fe,setDateFilterMode:X,dateFrom:ye,setDateFrom:Q,dateTo:we,setDateTo:pe,assemblyLines:Ct,onClearFilters:ge,hasActiveFilters:le!=="all"||he!=="all"||ke!=="all"||!!ye||!!we})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:Ke,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:h&&l.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ut),onClick:At,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ut?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>F(T=>T==="asc"?"desc":T==="desc"?null:"asc"),children:["Sr.No.",I==="asc"&&" ",I==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:gt.map(T=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:se.has(T.id),onCheckedChange:()=>Pt(T.id),"aria-label":`Select row ${T.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:T.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:T.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:T.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:T.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:T.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:T.party,children:er(T.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:T.product,children:T.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:T.specialNotes,children:T.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:T.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:T.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:T.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${T.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>oe(T),children:e.jsx(is,{className:`h-4 w-4 ${T.remarks?.trim()?"text-white":"text-blue-600"}`})}),T.remarks?.trim()&&e.jsx("div",{className:`\r
                                             absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                             hidden group-hover:block\r
                                             bg-gray-900 text-white text-xs\r
                                             px-3 py-2 rounded-md shadow-lg\r
                                             max-w-[260px] break-words z-[999]\r
                                           `,children:T.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>ar(T),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>Vt(T),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${T.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${T.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},T.id))})]}),$e.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No SVS orders found."})]})})})}),ae.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:ae.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:ae.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:ae.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:ae.qtyPending})]})]}),e.jsx(os,{page:C,perPage:S,total:$e.length,lastPage:Math.max(1,Math.ceil($e.length/Math.max(S,1))),onChangePage:k,onChangePerPage:_,disabled:h}),e.jsx(Ot,{open:ue,onOpenChange:z,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",ne?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:fe,onValueChange:Ce,children:[e.jsx(ss,{id:"assignStep",disabled:!0,children:e.jsx(rs,{placeholder:"Select step"})}),e.jsxs(ns,{children:[e.jsx(Pr,{value:"marking1",children:"Marking 1"}),e.jsx(Pr,{value:"marking2",children:"Marking 2"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Le,onChange:T=>De(T.target.value),max:ne?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:ne?.qtyPending})]})]})}),Ze&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Ze.type==="success"?"bg-green-50 text-green-700 border border-green-200":Ze.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Ze.message.split(`
`).map((T,x)=>e.jsx("div",{children:T},x))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:rr,disabled:Ne,children:"Cancel"}),e.jsx(ee,{onClick:We,disabled:Ne,className:"bg-black hover:bg-gray-800 text-white",children:Ne?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:it,onOpenChange:jt,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:nr.map(T=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",T.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(T.gmsoaNo).replace(/^SOA/i,""),"-",T.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",T.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:T.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:T.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",T.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",T.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold inline-block",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:T.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},T.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>jt(!1),children:"Cancel"}),e.jsxs(ee,{onClick:ir,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:mt,onOpenChange:xe,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",Ge?.uniqueCode]})]}),Ge&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.splittedCode||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.productSpcl1||"N/A"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.productSpcl2||"N/A"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.productSpcl3||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>xe(!1),children:"Close"})})]})}),e.jsx(Ot,{open:et,onOpenChange:He,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:It?`Order: ${It.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:St,onChange:T=>ct(T.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>He(!1),children:"Cancel"}),e.jsx(ee,{onClick:_e,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})}),e.jsx(Ot,{open:kt,onOpenChange:vt,children:e.jsxs(Tt,{className:"max-w-7xl h-[85vh] overflow-hidden assmebly-svs-data",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"SVS Inventory"}),e.jsx(Ft,{children:"Orders received from Assembly C  SVS"})]}),e.jsx("div",{className:"h-full overflow-auto border rounded-md",children:W($e)})]})})]})]})}function hf(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),[pe,se]=d.useState(new Set),[U,ue]=d.useState(!1),[z,ne]=d.useState(null),[ve,fe]=d.useState(""),[Ce,Le]=d.useState(""),[De,Ve]=d.useState(!1),[tt,Nt]=d.useState(""),[lt,$t]=d.useState(""),[qe,Ie]=d.useState({}),[ut,it]=d.useState(!1),[jt,mt]=d.useState(!1),[xe,Ge]=d.useState(null),[ot,et]=d.useState(!1),[He,It]=d.useState(null),[yt,St]=d.useState(""),[ct,Yt]=d.useState(null),[te,Ze]=d.useState(!1),[at,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),vt=localStorage.getItem("token");(()=>{try{const x=localStorage.getItem("user");if(!x)return"";const P=JSON.parse(x),g=typeof P.role=="object"?P.role?.name:P.role;return String(g||"").toLowerCase()}catch{return""}})().includes("admin");const Et=x=>x.splittedCode||x.split_id||x.uniqueCode||x.id,Qt=async()=>{try{h(!0),w(null);const g={menu_name:nt("pdi1")},m=await xt.post(`${qt}/order-list`,g,{headers:{Authorization:`Bearer ${vt}`}});if((m?.data?.Resp_code==="true"||m?.data?.Resp_code===!0||m?.data?.Resp_code==="RCS")&&Array.isArray(m.data.data)){const N=m.data.data.map(A=>({id:String(A.id),assemblyLine:A.assembly_no||"",gmsoaNo:A.soa_no||"",soaSrNo:A.soa_sr_no||"",assemblyDate:A.assembly_date||"",uniqueCode:A.unique_code||A.order_no||"",splittedCode:A.splitted_code||"",split_id:A.split_id||A.splitted_code||"",party:A.party_name||A.party||"",customerPoNo:A.customer_po_no||"",codeNo:A.code_no||"",product:A.product||"",totalQty:Number(A.totalQty||A.total_qty||A.qty||0),qty:Number(A.qty||0),qtyExe:Number(A.qty_executed||0),qtyPending:Number(A.qty_pending||0),finishedValve:A.finished_valve||"",gmLogo:A.gm_logo||"",namePlate:A.name_plate||"",specialNotes:A.special_notes||A.special_note||"",productSpcl1:A.product_spc1||"",productSpcl2:A.product_spc2||"",productSpcl3:A.product_spc3||"",inspection:A.inspection||"",painting:A.painting||"",remarks:A.remarks||"",alertStatus:A.is_urgent===!0||A.is_urgent==="true"||A.alert_status===!0||A.alert_status==="true"||A.urgent===1||A.urgent==="1"}));console.log(" Orders fetched:",N.length,"records"),l(N),u(null),w(null),Ke(null)}else console.warn(" No valid order data received",m.data),l([]),w(m?.data?.Resp_desc||"Failed to fetch orders")}catch(x){console.error("Error fetching orders:",x),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Ct=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{Ct||Qt()},[j,k,Ct]);const bt=d.useMemo(()=>Array.from(new Set(a.map(x=>x.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(x=>x.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(x=>x.party))).filter(Boolean).sort(),[a]);const $e=x=>{const P=parseInt(x,10);return isNaN(P)?0:P},gt=d.useMemo(()=>{let x=a.slice();if(q&&(x=x.filter(P=>n(String(P.id))||P.alertStatus)),re&&(x=x.filter(P=>typeof P.remarks=="string"&&P.remarks.trim().length>0)),G!=="all"&&(x=x.filter(P=>P.assemblyLine===G)),Z!=="all"&&(x=x.filter(P=>P.gmsoaNo===Z)),ce!=="all"&&(x=x.filter(P=>P.party===ce)),(X||Q)&&(x=x.filter(P=>{if(!P.assemblyDate||P.assemblyDate==="HOLD")return!1;const m=P.assemblyDate.split(/[\/-]/).map(N=>N.trim()).map(N=>Number(N));if(m.some(N=>isNaN(N)))return!1;let v=null;if(m.length>=3){const[N,A,R]=m;v=new Date(R,A-1,N)}else if(m.length===2){const[N,A]=m;v=new Date(A,N-1,1)}else if(m.length===1){const[N]=m;v=new Date(N,0,1)}else return!1;if(!v||isNaN(v.getTime()))return!1;if(Ee==="year"&&X)return v.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return v.getFullYear()===X.getFullYear()&&v.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return v>=X&&v<=Q;if(X)return v>=X;if(Q)return v<=Q}return!0})),F.trim()){const P=F.toLowerCase();x=x.filter(g=>String(g.uniqueCode).toLowerCase().includes(P)||String(g.party).toLowerCase().includes(P)||String(g.gmsoaNo).toLowerCase().includes(P)||String(g.customerPoNo).toLowerCase().includes(P)||String(g.codeNo).toLowerCase().includes(P)||String(g.product).toLowerCase().includes(P))}return _&&(x=[...x].sort((P,g)=>{const m=$e(P.soaSrNo),v=$e(g.soaSrNo);return _==="asc"?m-v:v-m})),x},[a,F,q,re,G,Z,ce,Ee,X,Q,n,_]),Pt=d.useMemo(()=>{const x=gt.filter(P=>pe.has(Et(P)));return{count:x.length,qty:x.reduce((P,g)=>P+(g.totalQty||g.qty||0),0),qtyExe:x.reduce((P,g)=>P+(g.qtyExe||0),0),qtyPending:x.reduce((P,g)=>P+(g.qtyPending||0),0)}},[pe,gt]),er=d.useMemo(()=>{const x=(j-1)*k;return gt.slice(x,x+k)},[gt,j,k]);d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const At=(x="",P=4)=>{const g=x.trim().split(/\s+/);return g.length<=P?x:g.slice(0,P).join(" ")+"..."},Ut=x=>{const P=Et(x);se(g=>{const m=new Set(g);return m.has(P)?m.delete(P):m.add(P),m})},Vt=()=>{se(x=>x.size===gt.length?new Set:new Set(gt.map(Et)))},zt=gt.length>0&&pe.size===gt.length,rr="pdi1",nr=wr(rr),lr=nt(rr);console.log("Next step(s):",nr.map(nt)),console.log("Is final step?",hn(rr));const ir=x=>{const g=wr("pdi1");ne(x),ue(!0),fe(g[0]||""),Le(String(x.qtyPending??x.qty??0)),Me(null),ge(!1),Ve(!1),Nt(""),$t(""),Ie({})},ar=()=>{const x={},P=Number(z?.qtyPending??0),g=Number(Ce||0),m=Number(lt||0);if(ve||(x.quickAssignStep="Please select a workflow step."),(!Ce||g<=0)&&(x.quickAssignQty="Quantity must be greater than 0."),g>P&&(x.quickAssignQty=`Cannot exceed available (${P})`),De){tt||(x.splitAssignStep="Choose split step."),(!lt||m<=0)&&(x.splitAssignQty="Split quantity is required."),ve===tt&&(x.sameEngineer="Split step cannot be the same as main step.");const v=g+m;v!==P&&(x.totalQtyMismatch=`Total quantity (${v}) must equal available (${P}).`)}return Ie(x),Object.keys(x).length===0},V=()=>{ge(!1),Me(null),ue(!1),ne(null),fe(""),Le(""),Ve(!1),Nt(""),$t(""),Ie({})},ae=a.filter(x=>pe.has(Et(x))),J=()=>it(!0),K=()=>{const P=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>

        <style>
          @page {
            size: 130mm 85mm;
            margin: 0;
          }

          html, body {
            width: 130mm;
            height: 85mm;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
          }

          .item-label,
          .party-desc {
          padding-bottom: 2mm;}

          .item-label {
          line-height: 1.8em;}

          .bin-card {
            width: 130mm;
            height: 85mm;
            padding: 6mm;
            box-sizing: border-box;
            page-break-after: always;
          }

        .item-label-description {
        padding-top: 50px;}

          .meta-qty {
          width: 50%;}

          .process-border {
          border-top:1px solid #000;
          border-bottom:1px solid #000;
          padding-top: 1.5mm;
          padding-bottom: 1.5mm;
          }

          .detail-logo {
            padding-bottom: 0.9mm;
          }

          .description {
            padding-bottom: 2mm;
          }

          .content {
            width: 100%;
            height: 100%;
            border: 1.5px solid #000;
            border-radius: 10px;
            padding-top: 2mm;
            padding-bottom: 4mm;
              padding-left: 6mm;
                  padding-right: 6mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
          }

          .meta-item {
            padding-top: 2mm;
          }

          /* RESET DEFAULT P TAG SPACE */
          p {
            margin: 0;
          }

          /* HEADER */
          .company-name {
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1mm;
            
          }

          .assembly-title p {
          border: 1px solid #000;
            display: inline-block;
            padding-top: 1mm;
            padding-bottom: 0.9mm;
            padding-left: 1mm;
            padding-right: 1mm;
          }

          .company-address {
            font-size: 8px;
            font-weight: 400;
            text-align: center;
            line-height: 1.2;
            margin: 0 0 1.2mm;
          }

          .tag-title {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1.5mm;
          }

          .doc-row {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            margin-bottom: 0.5mm; /*  reduced */
          }

          /* ASSEMBLY LINE */
          .title {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            margin-top: 0;       /*  no top gap */
            margin-bottom: 0.5mm;
            //  border: 1px solid #000;
            // display: inline-block;
          }

          .title-line {
            border-bottom: 1px solid #000;
            margin-bottom: 1.5mm;
            margin-top: 0.5mm;
          }

          /* META */
          .meta {
            font-size: 10px;
            line-height: 1.25;
            margin-bottom: 0.8mm;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }

          .meta div {
            margin-bottom: 0.5mm;
          }

          /* ITEM */
          .desc {
            font-size: 9px;
            margin-bottom: 0.8mm;
          }

          .desc p {
          padding-bottom: 0.6mm;}

          .desc span {
            display: block;
            padding-bottom: 0.1mm;
          }

          .desc .label {
            display: block;
            font-size: 10px;
            margin-bottom: 0.8mm;
            margin-top: 0.8mm;
          }

          .desc .text {
            word-break: break-word;
            
          }

          /* QTY */
          .qty-logo {
            font-size: 10px;
            line-height: 1.3;
            margin-bottom: 0.4mm;
            margin-top: 0.8mm;
          }

          /* INSPECTION */
          .inspect {
            margin-top: auto;
            font-size: 10px;
          }

          .inspect-line {
            height: 3mm;
            border-bottom: 1px solid #000;
          }

          .label {
            font-weight: 600;
          }
        </style>
      </head>

      <body>${ae.map(v=>`
        <div class="bin-card">
          <div class="content">

            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>

            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${v.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(v.gmsoaNo).replace(/^SOA/i,"")}-${v.soaSrNo}
                </div>

              </div>
                <div class="title assembly-title">
                  <p>Assembly Line: ${v.assemblyLine}</p>
                </div>
                <div class="meta-item">
                  <p>GMV-L4-F-PRD 01 A</p>
                  <p>(02/10.09.2020)</p>
                </div>
          </div>

            

            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${v.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${v.product}</p>
              </div>
            </div>

            <div class="qty-logo">
            <div class="meta meta-logo">
              <div class="meta-qty"><span class="label">QTY:</span> ${v.qty}</div>
              <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${v.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${v.specialNotes||""}</span></div>
              </div>

            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>

          </div>
        </div>`).join("")}</body>
    </html>`,g=document.createElement("iframe");g.style.position="fixed",g.style.right="0",g.style.bottom="0",g.style.width="0",g.style.height="0",g.style.border="0",document.body.appendChild(g);const m=g.contentDocument||g.contentWindow?.document;m&&(m.open(),m.write(P),m.close(),setTimeout(()=>{g.contentWindow?.focus(),g.contentWindow?.print(),setTimeout(()=>document.body.removeChild(g),500)},300))},de=()=>{const x=q===!0,P=re===!0,g=pe.size>0;if(!x&&!P&&!g)return;const m=g?gt.filter(v=>pe.has(Et(v))):gt;if(!m.length){alert("No data available to export");return}_e(m)},oe=()=>{const x=c&&c.length>0?c:a;if(!x||x.length===0){alert("No data available to export");return}_e(x)},_e=x=>{const P=x.map((N,A)=>({No:A+1,"Assembly Line":N.assemblyLine,"GMSOA No":N.gmsoaNo,"SOA Sr No":N.soaSrNo,"Assembly Date":N.assemblyDate,"Unique Code":N.uniqueCode,"Splitted Code":N.splittedCode||"-",Party:N.party,"Customer PO No":N.customerPoNo,"Code No":N.codeNo,Product:N.product,"PO Qty":N.poQty,Qty:N.qty,"Qty Executed":N.qtyExe,"Qty Pending":N.qtyPending,"Finished Valve":N.finishedValve,"GM Logo":N.gmLogo,"Name Plate":N.namePlate,"Special Notes":N.specialNotes||"","Product Special 1":N.productSpcl1,"Product Special 2":N.productSpcl2,"Product Special 3":N.productSpcl3,Inspection:N.inspection,Painting:N.painting,Remarks:N.remarks||""})),g=Gt.json_to_sheet(P),m=Gt.book_new();Gt.book_append_sheet(m,g,"Orders");const v=Jr(m,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([v],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},Be=x=>{Ge(x),mt(!0)},Ae=x=>{It(x),St(s(x.id)||x.remarks||""),et(!0)},Ne=async()=>{if(!He)return;const x=new FormData;x.append("orderId",String(He.id)),x.append("remarks",yt);try{const P=await xt.post(`${qt}/add-remarks`,x,{headers:{Authorization:`Bearer ${vt}`}});(P.data?.Resp_code==="true"||P.data?.Resp_code===!0)&&(l(m=>m.map(v=>v.id===He.id?{...v,remarks:yt}:v)),t(He.id,yt),et(!1),It(null),St(""))}catch(P){console.error("Error saving SVS remarks:",P)}},[je,Me]=d.useState(null),[We,ge]=d.useState(!1),W=async()=>{if(z&&ar()){ge(!0),Me({type:"info",message:"Assigning order, please wait..."});try{const x=localStorage.getItem("token");if(!x){Me({type:"error",message:"Token missing. Please log in again."});return}const P=Number(Ce||0),g=Number(lt||0),m=wr(rr)[0]||"",v=ve||m,N=nt(v),R=nt(tt||v),D=new FormData;D.append("orderId",String(z.id)),D.append("totalQty",String(z.totalQty??z.qty??0)),D.append("executedQty",String(P)),D.append("nextSteps",N),D.append("currentSteps",lr),console.log(" MAIN PAYLOAD");for(const Oe of D.entries())console.log(Oe[0],Oe[1]);const Te=await xt.post(`${qt}/assign-order`,D,{headers:{Authorization:`Bearer ${x}`}});if(!(Te.data?.Resp_code===!0||Te.data?.Resp_code==="true"||Te.data?.status===!0)){Me({type:"error",message:Te.data?.Resp_desc||"Order assignment failed."});return}let Y=` Assigned ${P}  ${N}`;if(De&&g>0){const Oe=tt||v,Se=new FormData;Se.append("orderId",String(z.id)),Se.append("totalQty",String(z.totalQty??z.qty??0)),Se.append("executedQty",String(g)),Se.append("nextSteps",R),Se.append("currentSteps",lr),console.log(" SPLIT PAYLOAD");for(const Ue of Se.entries())console.log("SPLIT:",Ue[0],Ue[1]);const Je=await xt.post(`${qt}/assign-order`,Se,{headers:{Authorization:`Bearer ${x}`}});Je.data?.Resp_code===!0||Je.data?.Resp_code==="true"?Y+=`
 Split ${g}  ${R}`:Me({type:"error",message:"Main assigned but split failed: "+(Je.data?.Resp_desc||"Unknown error")})}Me({type:"success",message:Y});const ie=Et(z);l(Oe=>Oe.filter(Se=>Et(Se)!==ie)),se(Oe=>{const Se=new Set(Oe);return Se.delete(ie),Se}),setTimeout(()=>{ue(!1),Me(null)},1e3)}catch(x){if(x?.name==="CanceledError"||x?.code==="ERR_CANCELED"){console.log(" Assignment request cancelled by user");return}if(console.error(" Error assigning order:",x),x.response){const P=x.response.data?.message||x.response.data?.Resp_desc||"Validation failed.",g=x.response.data?.errors&&Object.entries(x.response.data.errors).map(([m,v])=>`${m}: ${v}`).join(`
`);Me({type:"error",message:` ${P}
${g||""}`})}else x.request?Me({type:"error",message:" No response from server. Please check your connection."}):Me({type:"error",message:` ${x.message}`})}finally{ge(!1)}}},T=()=>{le("all"),he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:x=>{window.location.href=`/${x.toLowerCase()}`},onUploadSuccess:()=>Qt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Pre-Delivery Inspection"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:J,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{disabled:gt.length===0,onClick:de,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:oe,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:bt,onClearFilters:T,hasActiveFilters:G!=="all"||Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(zt),onClick:Vt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${zt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(x=>x==="asc"?"desc":x==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:er.map(x=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:pe.has(Et(x)),onCheckedChange:()=>Ut(x)})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:x.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:x.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:x.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:x.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:x.party,children:At(x.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:x.product,children:x.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:x.specialNotes,children:x.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:x.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:x.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${x.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Ae(x),children:e.jsx(is,{className:`h-4 w-4 ${x.remarks?.trim()?"text-white":"text-blue-600"}`})}),x.remarks?.trim()&&e.jsx("div",{className:`\r
                                                                                               absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                                                               hidden group-hover:block\r
                                                                                               bg-gray-900 text-white text-xs\r
                                                                                               px-3 py-2 rounded-md shadow-lg\r
                                                                                               max-w-[260px] break-words z-[999]\r
                                                                                             `,children:x.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>Be(x),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ir(x),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${n(x.id)||x.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${n(x.id)||x.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},Et(x)))})]}),gt.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),Pt.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:Pt.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:Pt.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:Pt.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:Pt.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:gt.length,lastPage:Math.max(1,Math.ceil(gt.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:U,onOpenChange:x=>{x?ue(!0):V()},children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:ve,onValueChange:fe,children:[e.jsx(ss,{id:"assignStep",children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:nr.map(x=>e.jsx(Pr,{value:x,children:nt(x)},x))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Ce,onChange:x=>Le(x.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),je&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${je.type==="success"?"bg-green-50 text-green-700 border border-green-200":je.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:je.message.split(`
`).map((x,P)=>e.jsx("div",{children:x},P))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:V,disabled:We,children:"Cancel"}),e.jsx(ee,{onClick:W,disabled:We,className:"bg-black hover:bg-gray-800 text-white",children:We?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:ut,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ae.map(x=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",x.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(x.gmsoaNo).replace(/^SOA/i,""),"-",x.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",x.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:x.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:x.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",x.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",x.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5 border-b border-black",children:x.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},x.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(ee,{onClick:K,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:jt,onOpenChange:mt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>mt(!1),children:"Close"})})]})}),e.jsx(Ot,{open:ot,onOpenChange:et,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:yt,onChange:x=>St(x.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>et(!1),children:"Cancel"}),e.jsx(ee,{onClick:Ne,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function ff(){d.useRef(null);const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),[pe,se]=d.useState(new Set),[U,ue]=d.useState(!1),[z,ne]=d.useState(null),[ve,fe]=d.useState(""),[Ce,Le]=d.useState(""),[De,Ve]=d.useState(!1),[tt,Nt]=d.useState(""),[lt,$t]=d.useState(""),[qe,Ie]=d.useState({}),[ut,it]=d.useState(!1),[jt,mt]=d.useState(!1),[xe,Ge]=d.useState(null),[ot,et]=d.useState(!1),[He,It]=d.useState(null),[yt,St]=d.useState(""),[ct,Yt]=d.useState(null),[te,Ze]=d.useState(!1),[at,Ke]=d.useState(null);d.useRef(null),d.useRef(null);const kt=localStorage.getItem("token");(()=>{try{const W=localStorage.getItem("user");if(!W)return"";const T=JSON.parse(W),x=typeof T.role=="object"?T.role?.name:T.role;return String(x||"").toLowerCase()}catch{return""}})().includes("admin");const Bt=W=>W.splittedCode||W.split_id||W.uniqueCode||W.id,Et=async()=>{try{h(!0),w(null);const x={menu_name:nt("pdi2")},P=await xt.post(`${qt}/order-list`,x,{headers:{Authorization:`Bearer ${kt}`}});if((P?.data?.Resp_code==="true"||P?.data?.Resp_code===!0||P?.data?.Resp_code==="RCS")&&Array.isArray(P.data.data)){const m=P.data.data.map(v=>({id:String(v.id),assemblyLine:v.assembly_no||"",gmsoaNo:v.soa_no||"",soaSrNo:v.soa_sr_no||"",assemblyDate:v.assembly_date||"",uniqueCode:v.unique_code||v.order_no||"",splittedCode:v.splitted_code||"",split_id:v.split_id||v.splitted_code||"",party:v.party_name||v.party||"",customerPoNo:v.customer_po_no||"",codeNo:v.code_no||"",product:v.product||"",totalQty:Number(v.totalQty||v.total_qty||v.qty||0),qty:Number(v.qty||0),qtyExe:Number(v.qty_executed||0),qtyPending:Number(v.qty_pending||0),finishedValve:v.finished_valve||"",gmLogo:v.gm_logo||"",namePlate:v.name_plate||"",specialNotes:v.special_notes||v.special_note||"",productSpcl1:v.product_spc1||"",productSpcl2:v.product_spc2||"",productSpcl3:v.product_spc3||"",inspection:v.inspection||"",painting:v.painting||"",remarks:v.remarks||"",alertStatus:v.is_urgent===!0||v.is_urgent==="true"||v.alert_status===!0||v.alert_status==="true"||v.urgent===1||v.urgent==="1"}));console.log(" Orders fetched:",m.length,"records"),l(m),u(null),w(null),Ke(null)}else console.warn(" No valid order data received",P.data),l([]),w(P?.data?.Resp_desc||"Failed to fetch orders")}catch(W){console.error("Error fetching orders:",W),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Qt=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{Qt||Et()},[j,k,Qt]);const Ct=d.useMemo(()=>Array.from(new Set(a.map(W=>W.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(W=>W.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(W=>W.party))).filter(Boolean).sort(),[a]);const bt=W=>{const T=parseInt(W,10);return isNaN(T)?0:T},$e=d.useMemo(()=>{let W=a.slice();if(q&&(W=W.filter(T=>n(String(T.id))||T.alertStatus)),re&&(W=W.filter(T=>typeof T.remarks=="string"&&T.remarks.trim().length>0)),G!=="all"&&(W=W.filter(T=>T.assemblyLine===G)),Z!=="all"&&(W=W.filter(T=>T.gmsoaNo===Z)),ce!=="all"&&(W=W.filter(T=>T.party===ce)),(X||Q)&&(W=W.filter(T=>{if(!T.assemblyDate||T.assemblyDate==="HOLD")return!1;const P=T.assemblyDate.split(/[\/-]/).map(m=>m.trim()).map(m=>Number(m));if(P.some(m=>isNaN(m)))return!1;let g=null;if(P.length>=3){const[m,v,N]=P;g=new Date(N,v-1,m)}else if(P.length===2){const[m,v]=P;g=new Date(v,m-1,1)}else if(P.length===1){const[m]=P;g=new Date(m,0,1)}else return!1;if(!g||isNaN(g.getTime()))return!1;if(Ee==="year"&&X)return g.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return g.getFullYear()===X.getFullYear()&&g.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return g>=X&&g<=Q;if(X)return g>=X;if(Q)return g<=Q}return!0})),F.trim()){const T=F.toLowerCase();W=W.filter(x=>String(x.uniqueCode).toLowerCase().includes(T)||String(x.party).toLowerCase().includes(T)||String(x.gmsoaNo).toLowerCase().includes(T)||String(x.customerPoNo).toLowerCase().includes(T)||String(x.codeNo).toLowerCase().includes(T)||String(x.product).toLowerCase().includes(T))}return _&&(W=[...W].sort((T,x)=>{const P=bt(T.soaSrNo),g=bt(x.soaSrNo);return _==="asc"?P-g:g-P})),W},[a,F,q,re,G,Z,ce,Ee,X,Q,n,_]),gt=d.useMemo(()=>{const W=(j-1)*k;return $e.slice(W,W+k)},[$e,j,k]),Pt=d.useMemo(()=>{const W=$e.filter(T=>pe.has(Bt(T)));return{count:W.length,qty:W.reduce((T,x)=>T+(x.totalQty||x.qty||0),0),qtyExe:W.reduce((T,x)=>T+(x.qtyExe||0),0),qtyPending:W.reduce((T,x)=>T+(x.qtyPending||0),0)}},[pe,$e]);d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const er=(W="",T=4)=>{const x=W.trim().split(/\s+/);return x.length<=T?W:x.slice(0,T).join(" ")+"..."},At=W=>{const T=Bt(W);se(x=>{const P=new Set(x);return P.has(T)?P.delete(T):P.add(T),P})},Ut=()=>{se(W=>W.size===$e.length?new Set:new Set($e.map(Bt)))},Vt=$e.length>0&&pe.size===$e.length,zt="pdi2",rr=wr(zt);console.log("Next step(s):",rr.map(nt)),console.log("Is final step?",hn(zt));const nr=W=>{const x=wr("pdi2");ne(W),ue(!0),Ne(null),fe(x[0]||""),Le(String(W.qtyPending??W.qty??0)),Ne(null),Me(!1),Ve(!1),Nt(""),$t(""),Ie({})},lr=()=>{const W={},T=Number(z?.qtyPending??0),x=Number(Ce||0),P=Number(lt||0);if(ve||(W.quickAssignStep="Please select a workflow step."),(!Ce||x<=0)&&(W.quickAssignQty="Quantity must be greater than 0."),x>T&&(W.quickAssignQty=`Cannot exceed available (${T})`),De){tt||(W.splitAssignStep="Choose split step."),(!lt||P<=0)&&(W.splitAssignQty="Split quantity is required."),ve===tt&&(W.sameEngineer="Split step cannot be the same as main step.");const g=x+P;g!==T&&(W.totalQtyMismatch=`Total quantity (${g}) must equal available (${T}).`)}return Ie(W),Object.keys(W).length===0},ir=()=>{Me(!1),Ne(null),ue(!1),ne(null),fe(""),Le(""),Ve(!1),Nt(""),$t(""),Ie({})},ar=a.filter(W=>pe.has(Bt(W))),V=()=>it(!0),ae=()=>{const T=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ar.map(g=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${g.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(g.gmsoaNo).replace(/^SOA/i,"")}-${g.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${g.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${g.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${g.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${g.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${g.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${g.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,x=document.createElement("iframe");x.style.position="fixed",x.style.right="0",x.style.bottom="0",x.style.width="0",x.style.height="0",x.style.border="0",document.body.appendChild(x);const P=x.contentDocument||x.contentWindow?.document;P&&(P.open(),P.write(T),P.close(),setTimeout(()=>{x.contentWindow?.focus(),x.contentWindow?.print(),setTimeout(()=>document.body.removeChild(x),500)},300))},J=()=>{const W=q===!0,T=re===!0,x=pe.size>0;if(!W&&!T&&!x)return;const P=x?$e.filter(g=>pe.has(Bt(g))):$e;if(!P.length){alert("No data available to export");return}de(P)},K=()=>{const W=c&&c.length>0?c:a;if(!W||W.length===0){alert("No data available to export");return}de(W)},de=W=>{const T=W.map((m,v)=>({No:v+1,"Assembly Line":m.assemblyLine,"GMSOA No":m.gmsoaNo,"SOA Sr No":m.soaSrNo,"Assembly Date":m.assemblyDate,"Unique Code":m.uniqueCode,"Splitted Code":m.splittedCode||"-",Party:m.party,"Customer PO No":m.customerPoNo,"Code No":m.codeNo,Product:m.product,"PO Qty":m.poQty,Qty:m.qty,"Qty Executed":m.qtyExe,"Qty Pending":m.qtyPending,"Finished Valve":m.finishedValve,"GM Logo":m.gmLogo,"Name Plate":m.namePlate,"Special Notes":m.specialNotes||"","Product Special 1":m.productSpcl1,"Product Special 2":m.productSpcl2,"Product Special 3":m.productSpcl3,Inspection:m.inspection,Painting:m.painting,Remarks:m.remarks||""})),x=Gt.json_to_sheet(T),P=Gt.book_new();Gt.book_append_sheet(P,x,"Orders");const g=Jr(P,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([g],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},oe=W=>{Ge(W),mt(!0)},_e=W=>{It(W),St(s(W.id)||W.remarks||""),et(!0)},Be=async()=>{if(!He)return;const W=new FormData;W.append("orderId",String(He.id)),W.append("remarks",yt);try{const T=await xt.post(`${qt}/add-remarks`,W,{headers:{Authorization:`Bearer ${kt}`}});(T.data?.Resp_code==="true"||T.data?.Resp_code===!0)&&(l(P=>P.map(g=>g.id===He.id?{...g,remarks:yt}:g)),t(He.id,yt),et(!1),It(null),St(""))}catch(T){console.error("Error saving SVS remarks:",T)}},[Ae,Ne]=d.useState(null),[je,Me]=d.useState(!1),We=async()=>{if(z&&lr()){Me(!0),Ne({type:"info",message:"Assigning order, please wait..."});try{const W=localStorage.getItem("token");if(!W){Ne({type:"error",message:"Token missing. Please log in again."});return}const T=Number(Ce||0),x=Number(lt||0),P=nt(zt),g=wr(zt)[0]||"",m=ve||g,v=nt(m),A=nt(tt||m),R=new FormData;R.append("orderId",String(z.id)),R.append("totalQty",String(z.totalQty??z.qty??0)),R.append("executedQty",String(T)),R.append("nextSteps",v),R.append("currentSteps",P),console.log(" MAIN PAYLOAD");for(const ie of R.entries())console.log(ie[0],ie[1]);const D=await xt.post(`${qt}/assign-order`,R,{headers:{Authorization:`Bearer ${W}`}});if(!(D.data?.Resp_code===!0||D.data?.Resp_code==="true"||D.data?.status===!0)){Ne({type:"error",message:D.data?.Resp_desc||"Order assignment failed."});return}let rt=` Assigned ${T}  ${v}`;if(De&&x>0){const ie=tt||m,Oe=new FormData;Oe.append("orderId",String(z.id)),Oe.append("totalQty",String(z.totalQty??z.qty??0)),Oe.append("executedQty",String(x)),Oe.append("nextSteps",A),Oe.append("currentSteps",P),console.log(" SPLIT PAYLOAD");for(const ft of Oe.entries())console.log("SPLIT:",ft[0],ft[1]);const Se=await xt.post(`${qt}/assign-order`,Oe,{headers:{Authorization:`Bearer ${W}`},signal:controller.signal});Se.data?.Resp_code===!0||Se.data?.Resp_code==="true"?rt+=`
 Split ${x}  ${A}`:Ne({type:"error",message:"Main assigned but split failed: "+(Se.data?.Resp_desc||"Unknown error")})}Ne({type:"success",message:rt});const Y=Bt(z);l(ie=>ie.filter(Oe=>Bt(Oe)!==Y)),se(ie=>{const Oe=new Set(ie);return Oe.delete(Y),Oe}),setTimeout(()=>{ue(!1),Ne(null)},1e3)}catch(W){if(W?.name==="CanceledError"||W?.code==="ERR_CANCELED"){console.log(" Assignment request cancelled by user");return}if(console.error(" Error assigning order:",W),W.response){const T=W.response.data?.message||W.response.data?.Resp_desc||"Validation failed.",x=W.response.data?.errors&&Object.entries(W.response.data.errors).map(([P,g])=>`${P}: ${g}`).join(`
`);Ne({type:"error",message:` ${T}
${x||""}`})}else W.request?Ne({type:"error",message:" No response from server. Please check your connection."}):Ne({type:"error",message:` ${W.message}`})}finally{Me(!1)}}},ge=()=>{le("all"),he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:W=>{window.location.href=`/${W.toLowerCase()}`},onUploadSuccess:()=>Et()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Pre-Delivery Inspection"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:V,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{disabled:$e.length===0,onClick:J,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:K,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:Ct,onClearFilters:ge,hasActiveFilters:G!=="all"||Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Vt),onClick:Ut,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Vt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(W=>W==="asc"?"desc":W==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:gt.map(W=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:pe.has(Bt(W)),onCheckedChange:()=>At(W)})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:W.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:W.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:W.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:W.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:W.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:W.party,children:er(W.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:W.product,children:W.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:W.specialNotes,children:W.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:W.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:W.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:W.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${W.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>_e(W),children:e.jsx(is,{className:`h-4 w-4 ${W.remarks?.trim()?"text-white":"text-blue-600"}`})}),W.remarks?.trim()&&e.jsx("div",{className:`\r
                                  absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                  hidden group-hover:block\r
                                  bg-gray-900 text-white text-xs\r
                                  px-3 py-2 rounded-md shadow-lg\r
                                  max-w-[260px] break-words z-[999]\r
                                `,children:W.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>oe(W),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>nr(W),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${n(W.id)||W.alertStatus?"bg-red-100 border border-red-200 shadow-sm cursor-default":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${n(W.id)||W.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},Bt(W)))})]}),$e.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),Pt.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:Pt.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:Pt.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:Pt.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:Pt.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:$e.length,lastPage:Math.max(1,Math.ceil($e.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:U,onOpenChange:W=>{W?ue(!0):ir()},children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:ve,onValueChange:fe,children:[e.jsx(ss,{id:"assignStep",children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:rr.map(W=>e.jsx(Pr,{value:W,children:nt(W)},W))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Ce,onChange:W=>Le(W.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),Ae&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Ae.type==="success"?"bg-green-50 text-green-700 border border-green-200":Ae.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Ae.message.split(`
`).map((W,T)=>e.jsx("div",{children:W},T))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:ir,disabled:je,children:"Cancel"}),e.jsx(ee,{onClick:We,disabled:je,className:"bg-black hover:bg-gray-800 text-white",children:je?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:ut,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ar.map(W=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",W.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(W.gmsoaNo).replace(/^SOA/i,""),"-",W.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",W.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:W.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:W.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",W.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",W.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:W.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},W.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(ee,{onClick:ae,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:jt,onOpenChange:mt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>mt(!1),children:"Close"})})]})}),e.jsx(Ot,{open:ot,onOpenChange:et,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:yt,onChange:W=>St(W.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>et(!1),children:"Cancel"}),e.jsx(ee,{onClick:Be,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function gf(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),[pe,se]=d.useState(new Set),[U,ue]=d.useState(!1),[z,ne]=d.useState(null),[ve,fe]=d.useState(""),[Ce,Le]=d.useState(""),[De,Ve]=d.useState(!1),[tt,Nt]=d.useState(""),[lt,$t]=d.useState(""),[qe,Ie]=d.useState({}),[ut,it]=d.useState(!1),[jt,mt]=d.useState(!1),[xe,Ge]=d.useState(null),[ot,et]=d.useState(!1),[He,It]=d.useState(null),[yt,St]=d.useState(""),[ct,Yt]=d.useState(null),[te,Ze]=d.useState(!1),[at,Ke]=d.useState(null);d.useRef(null);const kt=d.useRef(null),vt=localStorage.getItem("token"),Bt=async()=>{try{h(!0),w(null);const P=nt("tpi"),g=await xt.post(`${qt}/order-list`,{menu_name:P},{headers:{Authorization:`Bearer ${vt}`}});if((g?.data?.Resp_code==="true"||g?.data?.Resp_code===!0||g?.data?.Resp_code==="RCS")&&Array.isArray(g.data.data)){const v=g.data.data.map(N=>({id:String(N.id),assemblyLine:N.assembly_no||"",gmsoaNo:N.soa_no||"",soaSrNo:N.soa_sr_no||"",assemblyDate:N.assembly_date||"",uniqueCode:N.unique_code||N.order_no||"",splittedCode:N.splitted_code||"",split_id:N.split_id||N.splitted_code||"",party:N.party_name||N.party||"",customerPoNo:N.customer_po_no||"",codeNo:N.code_no||"",product:N.product||"",totalQty:Number(N.totalQty||N.total_qty||N.qty||0),qty:Number(N.qty||0),qtyExe:Number(N.qty_executed||0),qtyPending:Number(N.qty_pending||0),finishedValve:N.finished_valve||"",gmLogo:N.gm_logo||"",namePlate:N.name_plate||"",specialNotes:N.special_notes||N.special_note||"",productSpcl1:N.product_spc1||"",productSpcl2:N.product_spc2||"",productSpcl3:N.product_spc3||"",inspection:N.inspection||"",painting:N.painting||"",remarks:N.remarks||"",alertStatus:N.is_urgent===!0||N.is_urgent==="true"||N.alert_status===!0||N.alert_status==="true"||N.urgent===1||N.urgent==="1"}));console.log(" Orders fetched:",v.length,"records"),l(W(v)),u(null),w(null),Ke(null)}else console.warn(" No valid order data received",g.data),l([]),w(g?.data?.Resp_desc||"Failed to fetch orders")}catch(x){console.error("Error fetching orders:",x),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},Et=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{Et||Bt()},[j,k,Et]);const Qt=d.useMemo(()=>Array.from(new Set(a.map(x=>x.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(x=>x.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(x=>x.party))).filter(Boolean).sort(),[a]);const Ct=x=>{const P=parseInt(x,10);return isNaN(P)?0:P},bt=d.useMemo(()=>{let x=a.slice();if(q&&(x=x.filter(P=>n(String(P.id))||P.alertStatus)),re&&(x=x.filter(P=>typeof P.remarks=="string"&&P.remarks.trim().length>0)),G!=="all"&&(x=x.filter(P=>P.assemblyLine===G)),Z!=="all"&&(x=x.filter(P=>P.gmsoaNo===Z)),ce!=="all"&&(x=x.filter(P=>P.party===ce)),(X||Q)&&(x=x.filter(P=>{if(!P.assemblyDate||P.assemblyDate==="HOLD")return!1;const m=P.assemblyDate.split(/[\/-]/).map(N=>N.trim()).map(N=>Number(N));if(m.some(N=>isNaN(N)))return!1;let v=null;if(m.length>=3){const[N,A,R]=m;v=new Date(R,A-1,N)}else if(m.length===2){const[N,A]=m;v=new Date(A,N-1,1)}else if(m.length===1){const[N]=m;v=new Date(N,0,1)}else return!1;if(!v||isNaN(v.getTime()))return!1;if(Ee==="year"&&X)return v.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return v.getFullYear()===X.getFullYear()&&v.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return v>=X&&v<=Q;if(X)return v>=X;if(Q)return v<=Q}return!0})),F.trim()){const P=F.toLowerCase();x=x.filter(g=>String(g.uniqueCode).toLowerCase().includes(P)||String(g.party).toLowerCase().includes(P)||String(g.gmsoaNo).toLowerCase().includes(P)||String(g.customerPoNo).toLowerCase().includes(P)||String(g.codeNo).toLowerCase().includes(P)||String(g.product).toLowerCase().includes(P))}return _&&(x=[...x].sort((P,g)=>{const m=Ct(P.soaSrNo),v=Ct(g.soaSrNo);return _==="asc"?m-v:v-m})),x},[a,F,q,re,G,Z,ce,Ee,X,Q,n,_]),$e=d.useMemo(()=>{const x=(j-1)*k;return bt.slice(x,x+k)},[bt,j,k]);d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const gt=(x="",P=4)=>{const g=x.trim().split(/\s+/);return g.length<=P?x:g.slice(0,P).join(" ")+"..."},Pt=x=>x.id,er=x=>{se(P=>{const g=new Set(P);return g.has(x)?g.delete(x):g.add(x),g})},At=()=>{se(x=>{const P=$e.map(v=>v.id);if(P.every(v=>x.has(v))){const v=new Set(x);return P.forEach(N=>v.delete(N)),v}const m=new Set(x);return P.forEach(v=>m.add(v)),m})},Ut=d.useMemo(()=>$e.length===0?!1:$e.every(x=>pe.has(x.id)),[$e,pe]),Vt="tpi",zt=wr(Vt);console.log("Next step(s):",zt.map(nt)),console.log("Is final step?",hn(Vt));const rr=x=>{const g=wr("tpi");ne(x),ue(!0),Ne(null),fe(g[0]||""),Le(String(x.qtyPending??x.qty??0)),Ne(null),Me(!1),Ve(!1),Nt(""),$t(""),Ie({})},nr=()=>{const x={},P=Number(z?.qtyPending??0),g=Number(Ce||0),m=Number(lt||0);if(ve||(x.quickAssignStep="Please select a workflow step."),(!Ce||g<=0)&&(x.quickAssignQty="Quantity must be greater than 0."),g>P&&(x.quickAssignQty=`Cannot exceed available (${P})`),De){tt||(x.splitAssignStep="Choose split step."),(!lt||m<=0)&&(x.splitAssignQty="Split quantity is required."),ve===tt&&(x.sameEngineer="Split step cannot be the same as main step.");const v=g+m;v!==P&&(x.totalQtyMismatch=`Total quantity (${v}) must equal available (${P}).`)}return Ie(x),Object.keys(x).length===0},lr=()=>{je&&We.current&&We.current.abort(),Me(!1),Ne(null),ue(!1),ne(null),fe(""),Le(""),Ve(!1),Nt(""),$t(""),Ie({})},ir=a.filter(x=>pe.has(x.id)),ar=()=>it(!0),V=()=>{const P=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ir.map(v=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${v.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(v.gmsoaNo).replace(/^SOA/i,"")}-${v.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${v.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${v.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${v.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${v.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${v.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${v.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,g=document.createElement("iframe");g.style.position="fixed",g.style.right="0",g.style.bottom="0",g.style.width="0",g.style.height="0",g.style.border="0",document.body.appendChild(g);const m=g.contentDocument||g.contentWindow?.document;m&&(m.open(),m.write(P),m.close(),setTimeout(()=>{g.contentWindow?.focus(),g.contentWindow?.print(),setTimeout(()=>document.body.removeChild(g),500)},300))},ae=d.useMemo(()=>{const x=bt.filter(P=>pe.has(P.id));return{count:x.length,qty:x.reduce((P,g)=>P+(g.totalQty||g.qty||0),0),qtyExe:x.reduce((P,g)=>P+(g.qtyExe||0),0),qtyPending:x.reduce((P,g)=>P+(g.qtyPending||0),0)}},[pe,bt]),J=()=>{const x=q===!0,P=re===!0,g=pe.size>0;if(!x&&!P&&!g)return;const m=g?bt.filter(v=>pe.has(v.id)):bt;if(!m.length){alert("No data available to export");return}de(m)},K=()=>{const x=c&&c.length>0?c:a;if(!x||x.length===0){alert("No data available to export");return}de(x)},de=x=>{const P=x.map((N,A)=>({No:A+1,"Assembly Line":N.assemblyLine,"GMSOA No":N.gmsoaNo,"SOA Sr No":N.soaSrNo,"Assembly Date":N.assemblyDate,"Unique Code":N.uniqueCode,"Splitted Code":N.splittedCode||"-",Party:N.party,"Customer PO No":N.customerPoNo,"Code No":N.codeNo,Product:N.product,"PO Qty":N.poQty,Qty:N.qty,"Qty Executed":N.qtyExe,"Qty Pending":N.qtyPending,"Finished Valve":N.finishedValve,"GM Logo":N.gmLogo,"Name Plate":N.namePlate,"Special Notes":N.specialNotes||"","Product Special 1":N.productSpcl1,"Product Special 2":N.productSpcl2,"Product Special 3":N.productSpcl3,Inspection:N.inspection,Painting:N.painting,Remarks:N.remarks||""})),g=Gt.json_to_sheet(P),m=Gt.book_new();Gt.book_append_sheet(m,g,"Orders");const v=Jr(m,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([v],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},oe=x=>{Ge(x),mt(!0)},_e=x=>{It(x),St(s(x.id)||x.remarks||""),et(!0)},Be=()=>{He&&(t(He.id,yt),et(!1),It(null),St(""))},[Ae,Ne]=d.useState(null),[je,Me]=d.useState(!1),We=d.useRef(null),ge=async()=>{if(!je&&z&&nr()){Me(!0),Ne({type:"info",message:"Assigning order, please wait..."});try{const x=localStorage.getItem("token");if(!x){Ne({type:"error",message:"Token missing. Please log in again."});return}const P=Number(Ce||0),g=Number(lt||0),m=z?.currentStep||z?.stage||"TPI",v=nt(m)||m||"",N=wr(m)[0]||"",A=ve||N||m,R=nt(A)||A||"",D=new FormData;D.append("orderId",String(z.id)),D.append("totalQty",String(z.totalQty??z.qty??0)),D.append("executedQty",String(P)),z.split_id&&D.append("split_id",String(z.split_id)),D.append("currentSteps",v),R&&D.append("nextSteps",R),console.log(" MAIN PAYLOAD");for(const Je of D.entries())console.log(Je[0],Je[1]);We.current?.abort();const Te=new AbortController;We.current=Te;const rt=await xt.post(`${qt}/assign-order`,D,{headers:{Authorization:`Bearer ${x}`},signal:Te.signal});if(!(rt.data?.Resp_code===!0||rt.data?.Resp_code==="true"||rt.data?.status===!0)){Ne({type:"error",message:rt.data?.Resp_desc||"Order assignment failed."});return}let ie=` Assigned ${P}  ${R||"next stage"}`;if(De&&g>0){const Je=tt||A,ft=nt(Je)||Je||"",Ue=new FormData;Ue.append("orderId",String(z.id)),Ue.append("totalQty",String(z.totalQty??z.qty??0)),Ue.append("executedQty",String(g)),z.split_id&&Ue.append("split_id",String(z.split_id)),Ue.append("splitOrder","true"),Ue.append("currentSteps",v),ft&&Ue.append("nextSteps",ft),console.log(" SPLIT PAYLOAD");for(const Ca of Ue.entries())console.log("SPLIT:",Ca[0],Ca[1]);const mr=await xt.post(`${qt}/assign-order`,Ue,{headers:{Authorization:`Bearer ${x}`},signal:Te.signal});if(mr.data?.Resp_code===!0||mr.data?.Resp_code==="true"||mr.data?.status===!0)ie+=`
 Split ${g}  ${ft||"next stage"}`;else{Ne({type:"error",message:"Main assigned but split failed: "+(mr.data?.Resp_desc||"Unknown error")});return}}Ne({type:"success",message:ie});const Oe=Je=>Je.splittedCode||Je.split_id?Je.splittedCode||Je.split_id:[Je.uniqueCode,Je.soaSrNo,Je.gmsoaNo,Je.codeNo,Je.assemblyLine].map(ft=>ft??"").join("|"),Se=Oe(z);l(Je=>Je.filter(ft=>Oe(ft)!==Se)),se(Je=>{const ft=new Set(Je);return ft.delete(Se),ft}),await Bt(),setTimeout(()=>{ue(!1),Ne(null)},1e3)}catch(x){if(x?.name==="CanceledError"||x?.code==="ERR_CANCELED")Ne({type:"info",message:"Assignment canceled."});else if(x.response){const P=x.response.data?.message||x.response.data?.Resp_desc||"Validation failed.",g=x.response.data?.errors&&Object.entries(x.response.data.errors).map(([m,v])=>`${m}: ${v}`).join(`
`);Ne({type:"error",message:` ${P}
${g||""}`})}else x.request?Ne({type:"error",message:" No response from server. Please check your connection."}):(console.error(" Error assigning order:",x),Ne({type:"error",message:"Server error while assigning."}))}finally{Me(!1)}}},W=x=>[...x].sort((P,g)=>(P.originalIndex??0)-(g.originalIndex??0)),T=()=>{le("all"),he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:x=>{window.location.href=`/${x.toLowerCase()}`},onUploadSuccess:()=>Bt()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Test and Performance Inspection"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:ar,variant:"outline",disabled:pe.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{onClick:J,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:K,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:Qt,onClearFilters:T,hasActiveFilters:G!=="all"||Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:kt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ut),onClick:At,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ut?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(x=>x==="asc"?"desc":x==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:$e.map(x=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:pe.has(x.id),onCheckedChange:()=>er(x.id),"aria-label":`Select row ${Pt(x)}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:x.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:x.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:x.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:x.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:x.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:x.party,children:gt(x.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:x.product,children:x.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:x.specialNotes,children:x.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:x.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:x.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:x.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${x.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>_e(x),children:e.jsx(is,{className:`h-4 w-4 ${x.remarks?.trim()?"text-white":"text-blue-600"}`})}),x.remarks?.trim()&&e.jsx("div",{className:`\r
                                               absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                               hidden group-hover:block\r
                                               bg-gray-900 text-white text-xs\r
                                               px-3 py-2 rounded-md shadow-lg\r
                                               max-w-[260px] break-words z-[999]\r
                                             `,children:x.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>oe(x),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>rr(x),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${n(x.id)||x.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${n(x.id)||x.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},[x.id,x.splittedCode||x.split_id,x.uniqueCode,x.soaSrNo].join("-")))})]}),bt.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),ae.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:ae.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:ae.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:ae.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:ae.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:bt.length,lastPage:Math.max(1,Math.ceil(bt.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:U,onOpenChange:x=>{ue(x),x||Ne(null)},children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",z?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:ve,onValueChange:fe,children:[e.jsx(ss,{id:"assignStep",disabled:!0,children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:zt.map(x=>e.jsx(Pr,{value:x,children:nt(x)},x))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Ce,onChange:x=>Le(x.target.value),max:z?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:z?.qtyPending})]})]})}),Ae&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${Ae.type==="success"?"bg-green-50 text-green-700 border border-green-200":Ae.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:Ae.message.split(`
`).map((x,P)=>e.jsx("div",{children:x},P))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:lr,disabled:je,children:"Cancel"}),e.jsx(ee,{onClick:ge,disabled:je,className:"bg-black hover:bg-gray-800 text-white",children:je?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:ut,onOpenChange:it,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ir.map(x=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",x.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(x.gmsoaNo).replace(/^SOA/i,""),"-",x.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",x.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:x.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:x.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",x.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",x.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:x.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},x.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>it(!1),children:"Cancel"}),e.jsxs(ee,{onClick:V,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:jt,onOpenChange:mt,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",xe?.uniqueCode]})]}),xe&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:xe.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>mt(!1),children:"Close"})})]})}),e.jsx(Ot,{open:ot,onOpenChange:et,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:He?`Order: ${He.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:yt,onChange:x=>St(x.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>et(!1),children:"Cancel"}),e.jsx(ee,{onClick:Be,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function yf(){const t=En(),{updateRemark:r,toggleAlertStatus:s,getRemark:n,getAlertStatus:a}=gs(),[l,c]=d.useState([]),[u,f]=d.useState(null),[h,y]=d.useState(!1),[w,j]=d.useState(null),[C,k]=d.useState(1),[S,_]=d.useState(100),[I,F]=d.useState(null),[B,q]=d.useState(""),[me,re]=d.useState(!1),[M,G]=d.useState(!1),[le,Z]=d.useState("all"),[he,ce]=d.useState("all"),[ke,Ee]=d.useState("all"),[Fe,X]=d.useState("range"),[ye,Q]=d.useState(void 0),[we,pe]=d.useState(void 0),[se,U]=d.useState(new Set),[ue,z]=d.useState(!1),[ne,ve]=d.useState(null),[fe,Ce]=d.useState(""),[Le,De]=d.useState(""),[Ve,tt]=d.useState(!1),[Nt,lt]=d.useState(""),[$t,qe]=d.useState(""),[Ie,ut]=d.useState({}),[it,jt]=d.useState(!1),[mt,xe]=d.useState(!1),[Ge,ot]=d.useState(null),[et,He]=d.useState(!1),[It,yt]=d.useState(null),[St,ct]=d.useState(""),[Yt,te]=d.useState(null),[Ze,at]=d.useState(!1),[Ke,kt]=d.useState(null);d.useRef(null);const vt=d.useRef(null),Bt=localStorage.getItem("token"),[Et,Qt]=d.useState(!1),[Ct,bt]=d.useState(null),[$e,gt]=d.useState(""),[Pt,er]=d.useState(!1),[At,Ut]=d.useState(!1),[Vt,zt]=d.useState(!1),rr=async(ie,Oe)=>{if(ie)try{const Se=localStorage.getItem("token");zt(!0),setTimeout(()=>zt(!1),2e3);const Je=new FormData;Je.append("split_id",String(Oe.split_id)),Je.append("packaging","1"),await xt.post(`${qt}/change-to-packaging`,Je,{headers:{Authorization:`Bearer ${Se}`}}),c(ft=>ft.map(Ue=>Ue.id===Oe.id?{...Ue,packaging:1}:Ue)),Ut(!0),setTimeout(()=>Ut(!1),1e3)}catch(Se){console.error("Packaging toggle failed",Se)}},nr=ie=>{console.log("Opening OCL for order:",ie),bt(ie),gt(""),Qt(!0)},lr=async()=>{if(console.log("CONFIRM CLICKED",Ct,$e),!Ct?.id){alert("Order ID missing");return}if(!$e.trim()){alert("Enter OCL number");return}try{er(!0);const ie=localStorage.getItem("token");if(!ie){alert("Token missing. Please login again.");return}const Oe=new FormData;Oe.append("split_id",Ct.split_id),Oe.append("order_id",Ct.id),Oe.append("currentSteps","Dispatch"),Oe.append("nextSteps","Packaging"),Oe.append("ocl_no",$e),await xt.post(`${qt}/dispatch-to-packaging`,Oe,{headers:{Authorization:`Bearer ${ie}`}}),alert("OCL Number saved successfully"),Qt(!1),bt(null),gt(""),ar()}catch(ie){console.error("Dispatch to packaging failed",ie),alert(ie.response?.data?.message||ie.response?.data?.Resp_desc||"Failed to move order to Packaging")}finally{er(!1)}},ir=()=>{Qt(!1),bt(null),gt("")},ar=async()=>{try{y(!0),j(null);const Oe=nt("dispatch"),Se=await xt.post(`${qt}/order-list`,{menu_name:Oe},{headers:{Authorization:`Bearer ${Bt}`}});if((Se?.data?.Resp_code==="true"||Se?.data?.Resp_code===!0||Se?.data?.Resp_code==="RCS")&&Array.isArray(Se.data.data)){const ft=Se.data.data.map(Ue=>({id:String(Ue.id),assemblyLine:Ue.assembly_no||"",gmsoaNo:Ue.soa_no||"",soaSrNo:Ue.soa_sr_no||"",assemblyDate:Ue.assembly_date||"",uniqueCode:Ue.unique_code||Ue.order_no||"",splittedCode:Ue.splitted_code||"",split_id:Ue.split_id||Ue.splitted_code||"",party:Ue.party_name||Ue.party||"",customerPoNo:Ue.customer_po_no||"",codeNo:Ue.code_no||"",product:Ue.product||"",qty:Number(Ue.totalQty||Ue.total_qty||Ue.qty||0),totalQty:Number(Ue.totalQty||Ue.total_qty||Ue.qty||0),qtyExe:Number(Ue.qty_executed||0),qtyPending:Number(Ue.qty_pending||0),finishedValve:Ue.finished_valve||"",gmLogo:Ue.gm_logo||"",namePlate:Ue.name_plate||"",specialNotes:Ue.special_notes||Ue.special_note||"",productSpcl1:Ue.product_spc1||"",productSpcl2:Ue.product_spc2||"",productSpcl3:Ue.product_spc3||"",inspection:Ue.inspection||"",painting:Ue.painting||"",remarks:Ue.remarks||"",packaging:Ue.packaging===1||Ue.packaging==="1"?1:0,alertStatus:Ue.is_urgent===!0||Ue.is_urgent==="true"||Ue.alert_status===!0||Ue.alert_status==="true"||Ue.urgent===1||Ue.urgent==="1"}));console.log(" Orders fetched:",ft.length,"records"),c(A(ft)),f(null),j(null),kt(null)}else console.warn(" No valid order data received",Se.data),c([]),j(Se?.data?.Resp_desc||"Failed to fetch orders")}catch(ie){console.error("Error fetching orders:",ie),j("Error fetching order list. Please check your token or server.")}finally{y(!1)}},V=d.useMemo(()=>B.trim().length>0||(le!=="all"||he!=="all"||ke!=="all")||(!!ye||!!we)||me||M,[B,le,he,ke,ye,we,me,M]);d.useEffect(()=>{V||ar()},[C,S,V]);const ae=d.useMemo(()=>Array.from(new Set(l.map(ie=>ie.assemblyLine))).filter(Boolean).sort(),[l]);d.useMemo(()=>Array.from(new Set(l.map(ie=>ie.gmsoaNo))).filter(Boolean).sort(),[l]),d.useMemo(()=>Array.from(new Set(l.map(ie=>ie.party))).filter(Boolean).sort(),[l]);const J=ie=>{const Oe=parseInt(ie,10);return isNaN(Oe)?0:Oe},K=d.useMemo(()=>{let ie=l.slice();if(me&&(ie=ie.filter(Oe=>a(String(Oe.id))||Oe.alertStatus)),M&&(ie=ie.filter(Oe=>typeof Oe.remarks=="string"&&Oe.remarks.trim().length>0)),le!=="all"&&(ie=ie.filter(Oe=>Oe.assemblyLine===le)),he!=="all"&&(ie=ie.filter(Oe=>Oe.gmsoaNo===he)),ke!=="all"&&(ie=ie.filter(Oe=>Oe.party===ke)),(ye||we)&&(ie=ie.filter(Oe=>{if(!Oe.assemblyDate||Oe.assemblyDate==="HOLD")return!1;const Je=Oe.assemblyDate.split(/[\/-]/).map(Ue=>Ue.trim()).map(Ue=>Number(Ue));if(Je.some(Ue=>isNaN(Ue)))return!1;let ft=null;if(Je.length>=3){const[Ue,mr,en]=Je;ft=new Date(en,mr-1,Ue)}else if(Je.length===2){const[Ue,mr]=Je;ft=new Date(mr,Ue-1,1)}else if(Je.length===1){const[Ue]=Je;ft=new Date(Ue,0,1)}else return!1;if(!ft||isNaN(ft.getTime()))return!1;if(Fe==="year"&&ye)return ft.getFullYear()===ye.getFullYear();if(Fe==="month"&&ye)return ft.getFullYear()===ye.getFullYear()&&ft.getMonth()===ye.getMonth();if(Fe==="range"){if(ye&&we)return ft>=ye&&ft<=we;if(ye)return ft>=ye;if(we)return ft<=we}return!0})),B.trim()){const Oe=B.toLowerCase();ie=ie.filter(Se=>String(Se.uniqueCode).toLowerCase().includes(Oe)||String(Se.party).toLowerCase().includes(Oe)||String(Se.gmsoaNo).toLowerCase().includes(Oe)||String(Se.customerPoNo).toLowerCase().includes(Oe)||String(Se.codeNo).toLowerCase().includes(Oe)||String(Se.product).toLowerCase().includes(Oe))}return I&&(ie=[...ie].sort((Oe,Se)=>{const Je=J(Oe.soaSrNo),ft=J(Se.soaSrNo);return I==="asc"?Je-ft:ft-Je})),ie},[l,B,me,M,le,he,ke,Fe,ye,we,a,I]),de=d.useMemo(()=>{const ie=(C-1)*S;return K.slice(ie,ie+S)},[K,C,S]);d.useEffect(()=>{k(1)},[B,le,he,ke,ye,we,me,M]);const oe=(ie="",Oe=4)=>{const Se=ie.trim().split(/\s+/);return Se.length<=Oe?ie:Se.slice(0,Oe).join(" ")+"..."},_e=ie=>{U(Oe=>{const Se=new Set(Oe);return Se.has(ie)?Se.delete(ie):Se.add(ie),Se})},Be=()=>{U(ie=>ie.size===K.length?new Set:new Set(K.map(Oe=>Oe.id)))},Ae=K.length>0&&se.size===K.length,Ne="dispatch",je=wr(Ne);console.log("Next step(s):",je.map(nt)),console.log("Is final step?",hn(Ne));const Me=l.filter(ie=>se.has(ie.id)),We=()=>jt(!0),ge=()=>{const Oe=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${Me.map(ft=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${ft.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(ft.gmsoaNo).replace(/^SOA/i,"")}-${ft.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${ft.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${ft.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${ft.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${ft.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${ft.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${ft.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,Se=document.createElement("iframe");Se.style.position="fixed",Se.style.right="0",Se.style.bottom="0",Se.style.width="0",Se.style.height="0",Se.style.border="0",document.body.appendChild(Se);const Je=Se.contentDocument||Se.contentWindow?.document;Je&&(Je.open(),Je.write(Oe),Je.close(),setTimeout(()=>{Se.contentWindow?.focus(),Se.contentWindow?.print(),setTimeout(()=>document.body.removeChild(Se),500)},300))},W=ie=>ie.splittedCode||ie.split_id?ie.splittedCode||ie.split_id:[ie.uniqueCode,ie.soaSrNo,ie.gmsoaNo,ie.codeNo,ie.assemblyLine].map(Oe=>Oe??"").join("|"),T=d.useMemo(()=>{const ie=K.filter(Oe=>se.has(W(Oe)));return{count:ie.length,qty:ie.reduce((Oe,Se)=>Oe+(Se.totalQty||Se.qty||0),0),qtyExe:ie.reduce((Oe,Se)=>Oe+(Se.qtyExe||0),0),qtyPending:ie.reduce((Oe,Se)=>Oe+(Se.qtyPending||0),0)}},[se,K]),x=()=>{const ie=me===!0,Oe=M===!0,Se=se.size>0;if(!ie&&!Oe&&!Se)return;const Je=Se?K.filter(ft=>se.has(W(ft))):K;if(!Je.length){alert("No data available to export");return}g(Je)},P=()=>{const ie=u&&u.length>0?u:l;if(!ie||ie.length===0){alert("No data available to export");return}g(ie)},g=ie=>{const Oe=ie.map((Ue,mr)=>({No:mr+1,"Assembly Line":Ue.assemblyLine,"GMSOA No":Ue.gmsoaNo,"SOA Sr No":Ue.soaSrNo,"Assembly Date":Ue.assemblyDate,"Unique Code":Ue.uniqueCode,"Splitted Code":Ue.splittedCode||"-",Party:Ue.party,"Customer PO No":Ue.customerPoNo,"Code No":Ue.codeNo,Product:Ue.product,"PO Qty":Ue.poQty,Qty:Ue.qty,"Qty Executed":Ue.qtyExe,"Qty Pending":Ue.qtyPending,"Finished Valve":Ue.finishedValve,"GM Logo":Ue.gmLogo,"Name Plate":Ue.namePlate,"Special Notes":Ue.specialNotes||"","Product Special 1":Ue.productSpcl1,"Product Special 2":Ue.productSpcl2,"Product Special 3":Ue.productSpcl3,Inspection:Ue.inspection,Painting:Ue.painting,Remarks:Ue.remarks||""})),Se=Gt.json_to_sheet(Oe),Je=Gt.book_new();Gt.book_append_sheet(Je,Se,"Orders");const ft=Jr(Je,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([ft],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},m=ie=>{ot(ie),xe(!0)},v=ie=>{yt(ie),ct(n(ie.id)||ie.remarks||""),He(!0)},N=()=>{It&&(r(It.id,St),He(!1),yt(null),ct(""))},A=ie=>[...ie].sort((Oe,Se)=>(Oe.originalIndex??0)-(Se.originalIndex??0)),[R,D]=d.useState(null),[Te,rt]=d.useState(!1),Y=()=>{Z("all"),ce("all"),Ee("all"),X("range"),Q(void 0),pe(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:ie=>{window.location.href=`/${ie.toLowerCase()}`},onUploadSuccess:()=>ar()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Dispatch"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:We,variant:"outline",disabled:se.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>re(!me),className:`btn-urgent flex items-center gap-2 ${me?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),me?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>G(!M),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:M?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{disabled:K.length===0,onClick:x,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:P,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]}),e.jsx(ee,{className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] text-white shadow-lg hover:shadow-xl",onClick:()=>t("/packaging"),children:"Completed Projects"})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:B,setSearchTerm:q,assemblyLineFilter:le,setAssemblyLineFilter:Z,dateFilterMode:Fe,setDateFilterMode:X,dateFrom:ye,setDateFrom:Q,dateTo:we,setDateTo:pe,assemblyLines:ae,onClearFilters:Y,hasActiveFilters:le!=="all"||he!=="all"||ke!=="all"||!!ye||!!we})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:vt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:h&&l.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ae),onClick:Be,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ae?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>F(ie=>ie==="asc"?"desc":ie==="desc"?null:"asc"),children:["Sr.No.",I==="asc"&&" ",I==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:de.map(ie=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:se.has(ie.id),onCheckedChange:()=>_e(ie.id),"aria-label":`Select row ${ie.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:ie.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:ie.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:ie.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:ie.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:ie.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:ie.party,children:oe(ie.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:ie.product,children:ie.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:ie.specialNotes,children:ie.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:ie.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ie.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:ie.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${ie.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>v(ie),children:e.jsx(is,{className:`h-4 w-4 ${ie.remarks?.trim()?"text-white":"text-blue-600"}`})}),ie.remarks?.trim()&&e.jsx("div",{className:`\r
                                                                    absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                                                    hidden group-hover:block\r
                                                                    bg-gray-900 text-white text-xs\r
                                                                    px-3 py-2 rounded-md shadow-lg\r
                                                                    max-w-[260px] break-words z-[999]\r
                                                                  `,children:ie.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>m(ie),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${ie.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${ie.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})}),e.jsxs("div",{onClick:Oe=>Oe.stopPropagation(),className:"flex items-center gap-2",children:[e.jsx(Ur,{checked:ie.packaging===1,disabled:ie.packaging===1,onCheckedChange:Oe=>{rr(!!Oe,ie)},title:"Toggle Packaging"}),Vt&&e.jsx(Ot,{open:Vt,onOpenChange:zt,children:e.jsx(Tt,{className:"max-w-[400px]",children:e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Moved to Packaging"}),e.jsx(Ft,{})]})})}),ie.packaging===1&&e.jsx(ee,{size:"sm",variant:"outline",onClick:()=>nr(ie),children:"OCL"})]})]})})]},[ie.id,ie.splittedCode||ie.split_id,ie.uniqueCode,ie.soaSrNo].join("-")))})]}),K.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),T.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:T.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:T.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:T.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:T.qtyPending})]})]}),e.jsx(os,{page:C,perPage:S,total:K.length,lastPage:Math.max(1,Math.ceil(K.length/Math.max(S,1))),onChangePage:k,onChangePerPage:_,disabled:h}),e.jsx(Ot,{open:it,onOpenChange:jt,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:Me.map(ie=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",ie.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(ie.gmsoaNo).replace(/^SOA/i,""),"-",ie.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",ie.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:ie.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:ie.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",ie.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",ie.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:ie.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},ie.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>jt(!1),children:"Cancel"}),e.jsxs(ee,{onClick:ge,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:Et,onOpenChange:Qt,children:e.jsxs(Tt,{className:"max-w-[400px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Move to Packaging"}),e.jsx(Ft,{children:"Enter OCL Number to continue"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{children:"OCL Number"}),e.jsx(Xr,{value:$e,onChange:ie=>gt(ie.target.value),placeholder:"Enter OCL No"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(ee,{variant:"outline",onClick:ir,children:"Cancel"}),e.jsx(ee,{onClick:lr,disabled:Pt,children:Pt?"Processing...":"Confirm"})]})]})}),e.jsx(Ot,{open:mt,onOpenChange:xe,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",Ge?.uniqueCode]})]}),Ge&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ge.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>xe(!1),children:"Close"})})]})}),e.jsx(Ot,{open:et,onOpenChange:He,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:It?`Order: ${It.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:St,onChange:ie=>ct(ie.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>He(!1),children:"Cancel"}),e.jsx(ee,{onClick:N,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function ik(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(0),[F,B]=d.useState(1),[q,me]=d.useState(null),[re,M]=d.useState(""),[G,le]=d.useState(!1),[Z,he]=d.useState(!1),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("all"),[X,ye]=d.useState("all"),[Q,we]=d.useState("range"),[pe,se]=d.useState(void 0),[U,ue]=d.useState(void 0),[z,ne]=d.useState(new Set),[ve,fe]=d.useState(!1),[Ce,Le]=d.useState(null),[De,Ve]=d.useState(""),[tt,Nt]=d.useState(""),[lt,$t]=d.useState(!1),[qe,Ie]=d.useState(""),[ut,it]=d.useState(""),[jt,mt]=d.useState({}),[xe,Ge]=d.useState(!1),[ot,et]=d.useState(!1),[He,It]=d.useState(null),[yt,St]=d.useState(!1),[ct,Yt]=d.useState(null),[te,Ze]=d.useState(""),[at,Ke]=d.useState(null),[kt,vt]=d.useState(!1),[Bt,Et]=d.useState(null);d.useRef(null);const Qt=d.useRef(null),Ct=localStorage.getItem("token");(()=>{try{const ge=localStorage.getItem("user");if(!ge)return"";const W=JSON.parse(ge),T=typeof W.role=="object"?W.role?.name:W.role;return String(T||"").toLowerCase()}catch{return""}})().includes("admin");const $e=async()=>{try{h(!0),w(null);const T={menu_name:nt("planning"),page:j,per_page:k},x=await xt.post(`${qt}/order-list`,T,{headers:{Authorization:`Bearer ${Ct}`}});if((x?.data?.Resp_code==="true"||x?.data?.Resp_code===!0||x?.data?.Resp_code==="RCS")&&Array.isArray(x.data.data)){const g=x.data.data.map((v,N)=>({id:String(v.id),assemblyLine:v.assembly_no||"",gmsoaNo:v.soa_no||"",soaSrNo:v.soa_sr_no||"",assemblyDate:v.assembly_date||"",uniqueCode:v.unique_code||v.order_no||"",splittedCode:v.splitted_code||"",split_id:v.split_id||v.splitted_code||"",party:v.party_name||v.party||"",customerPoNo:v.customer_po_no||"",codeNo:v.code_no||"",product:v.product||"",poQty:Number(v.po_qty??v.qty??0),qty:Number(v.qty||0),qtyExe:Number(v.qty_executed||0),qtyPending:Number(v.qty_pending||0),finishedValve:v.finished_valve||"",gmLogo:v.gm_logo||"",namePlate:v.name_plate||"",specialNotes:v.special_notes||v.special_note||"",productSpcl1:v.product_spc1||"",productSpcl2:v.product_spc2||"",productSpcl3:v.product_spc3||"",inspection:v.inspection||"",painting:v.painting||"",remarks:v.remarks||"",alertStatus:v.is_urgent===!0||v.is_urgent==="true"||v.alert_status===!0||v.alert_status==="true"||v.urgent===1||v.urgent==="1",originalIndex:N}));console.log(" Orders fetched:",g.length,"records"),l(Ne(g)),u(null);const m=x?.data?.pagination;if(m){const v=Number(m.total??g.length),N=Number(m.current_page??j),A=m.last_page??Math.ceil(v/Math.max(k,1)),R=Number(A||1);I(v),C(N),B(R)}else{const v=g.length;I(v),B(Math.max(1,Math.ceil(v/Math.max(k,1))))}w(null),Et(null)}else console.warn(" No valid order data received",x.data),l([]),w(x?.data?.Resp_desc||"Failed to fetch orders")}catch(ge){console.error("Error fetching orders:",ge),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},gt=d.useMemo(()=>re.trim().length>0||(ce!=="all"||Ee!=="all"||X!=="all")||(!!pe||!!U)||G||Z,[re,ce,Ee,X,pe,U,G,Z]);d.useEffect(()=>{gt?c||er():u(null)},[gt,k]),d.useEffect(()=>{gt||$e()},[j,k,gt]);const Pt=ge=>{const W=parseInt(ge,10);return isNaN(W)?0:W},er=async()=>{try{h(!0);const W=nt("planning"),T=await xt.post(`${qt}/order-list`,{menu_name:W,page:1,per_page:k},{headers:{Authorization:`Bearer ${Ct}`}});if(!(T?.data?.Resp_code==="true"||T?.data?.Resp_code===!0||T?.data?.Resp_code==="RCS")){u(null);return}const P=T?.data?.pagination,g=Number(P?.last_page||1),m=[];for(let Te=1;Te<=g;Te++)m.push(xt.post(`${qt}/order-list`,{menu_name:W,page:Te,per_page:k},{headers:{Authorization:`Bearer ${Ct}`}}));const v=await Promise.all(m);let N=[];for(const Te of v)if(Array.isArray(Te?.data?.data)){const rt=Te.data.data.map((Y,ie)=>({id:String(Y.id),assemblyLine:Y.assembly_no||"",gmsoaNo:Y.soa_no||"",soaSrNo:Y.soa_sr_no||"",assemblyDate:Y.assembly_date||"",uniqueCode:Y.unique_code||Y.order_no||"",splittedCode:Y.splitted_code||"",split_id:Y.split_id||Y.splitted_code||"",party:Y.party_name||Y.party||"",customerPoNo:Y.customer_po_no||"",codeNo:Y.code_no||"",product:Y.product||"",poQty:Number(Y.po_qty??Y.qty??0),qty:Number(Y.qty||0),qtyExe:Number(Y.qty_executed||0),qtyPending:Number(Y.qty_pending||0),finishedValve:Y.finished_valve||"",gmLogo:Y.gm_logo||"",namePlate:Y.name_plate||"",specialNotes:Y.special_notes||Y.special_note||"",productSpcl1:Y.product_spc1||"",productSpcl2:Y.product_spc2||"",productSpcl3:Y.product_spc3||"",inspection:Y.inspection||"",painting:Y.painting||"",remarks:Y.remarks||"",alertStatus:Y.is_urgent===!0||Y.is_urgent==="true"||Y.alert_status===!0||Y.alert_status==="true"||Y.urgent===1||Y.urgent==="1",originalIndex:ie}));N=N.concat(rt)}const A=new Set,R=Te=>Te.splittedCode||Te.split_id||Te.uniqueCode||Te.id,D=N.filter(Te=>{const rt=R(Te);return A.has(rt)?!1:(A.add(rt),!0)});u(Ne(D))}catch{u(null)}finally{h(!1)}},At=d.useMemo(()=>Array.from(new Set(a.map(ge=>ge.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(ge=>ge.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(ge=>ge.party))).filter(Boolean).sort(),[a]);const Ut=d.useMemo(()=>{let W=(gt&&c?c:a).slice();if(G&&(W=W.filter(T=>n(String(T.id))||T.alertStatus)),Z&&(W=W.filter(T=>typeof T.remarks=="string"&&T.remarks.trim().length>0)),ce!=="all"&&(W=W.filter(T=>T.assemblyLine===ce)),Ee!=="all"&&(W=W.filter(T=>T.gmsoaNo===Ee)),X!=="all"&&(W=W.filter(T=>T.party===X)),(pe||U)&&(W=W.filter(T=>{if(!T.assemblyDate||T.assemblyDate==="HOLD")return!1;const P=(g=>{if(!g)return null;const m=g.trim().match(/^(\d{1,2})-(\d{1,2})-(\d{4})$/);if(!m)return null;const[,v,N,A]=m,R=Number(v),D=Number(N),Te=Number(A),rt=new Date(Te,D-1,R);return rt.getFullYear()!==Te||rt.getMonth()!==D-1||rt.getDate()!==R?null:rt})(T.assemblyDate);if(!P)return!1;if(Q==="year"&&pe)return P.getFullYear()===pe.getFullYear();if(Q==="month"&&pe)return P.getFullYear()===pe.getFullYear()&&P.getMonth()===pe.getMonth();if(Q==="range"){if(pe&&U)return P>=pe&&P<=U;if(pe)return P>=pe;if(U)return P<=U}return!0})),re.trim()){const T=re.toLowerCase();W=W.filter(x=>String(x.uniqueCode).toLowerCase().includes(T)||String(x.party).toLowerCase().includes(T)||String(x.gmsoaNo).toLowerCase().includes(T)||String(x.customerPoNo).toLowerCase().includes(T)||String(x.codeNo).toLowerCase().includes(T)||String(x.product).toLowerCase().includes(T))}return q&&(W=[...W].sort((T,x)=>{const P=Pt(T.soaSrNo),g=Pt(x.soaSrNo);return q==="asc"?P-g:g-P})),W},[a,c,gt,re,G,Z,ce,Ee,X,Q,pe,U,n,q]),Vt=(ge="",W=4)=>{const T=ge.trim().split(/\s+/);return T.length<=W?ge:T.slice(0,W).join(" ")+"..."},zt=d.useMemo(()=>{const ge=(j-1)*k;return Ut.slice(ge,ge+k)},[Ut,j,k]);d.useEffect(()=>{C(1)},[re,ce,Ee,X,pe,U,G,Z]);const rr=ge=>{ne(W=>{const T=new Set(W);return T.has(ge)?T.delete(ge):T.add(ge),T})},nr=d.useMemo(()=>{const ge=Ut.filter(W=>z.has(W.id));return{count:ge.length,qty:ge.reduce((W,T)=>W+(T.qty||0),0),qtyExe:ge.reduce((W,T)=>W+(T.qtyExe||0),0),qtyPending:ge.reduce((W,T)=>W+(T.qtyPending||0),0)}},[z,Ut]),lr=()=>{ne(ge=>ge.size===Ut.length?new Set:new Set(Ut.map(W=>W.id)))},ir=Ut.length>0&&z.size===Ut.length,ar=a.filter(ge=>z.has(ge.id)),V=()=>Ge(!0),ae=()=>{const W=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>

        <style>
          @page {
            size: 130mm 85mm;
            margin: 0;
          }

          html, body {
            width: 130mm;
            height: 85mm;
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
          }

          .item-label,
          .party-desc {
          padding-bottom: 2mm;}

          .item-label {
          line-height: 1.8em;}

          .bin-card {
            width: 130mm;
            height: 85mm;
            padding: 6mm;
            box-sizing: border-box;
            page-break-after: always;
          }

        .item-label-description {
        padding-top: 50px;}

          .meta-qty {
          width: 50%;}

          .process-border {
          border-top:1px solid #000;
          border-bottom:1px solid #000;
          padding-top: 1.5mm;
          padding-bottom: 1.5mm;
          }

          .detail-logo {
            padding-bottom: 0.9mm;
          }

          .description {
            padding-bottom: 2mm;
          }

          .content {
            width: 100%;
            height: 100%;
            border: 1.5px solid #000;
            border-radius: 10px;
            padding-top: 2mm;
            padding-bottom: 4mm;
              padding-left: 6mm;
                  padding-right: 6mm;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
          }

          .meta-item {
            padding-top: 2mm;
          }

          /* RESET DEFAULT P TAG SPACE */
          p {
            margin: 0;
          }

          /* HEADER */
          .company-name {
            font-size: 12px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1mm;
            
          }

          .assembly-title p {
          border: 1px solid #000;
            display: inline-block;
            padding-top: 1mm;
            padding-bottom: 0.9mm;
            padding-left: 1mm;
            padding-right: 1mm;
          }

          .company-address {
            font-size: 8px;
            font-weight: 400;
            text-align: center;
            line-height: 1.2;
            margin: 0 0 1.2mm;
          }

          .tag-title {
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            margin: 0 0 1.5mm;
          }

          .doc-row {
            display: flex;
            justify-content: space-between;
            font-size: 9px;
            margin-bottom: 0.5mm; /*  reduced */
          }

          /* ASSEMBLY LINE */
          .title {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            margin-top: 0;       /*  no top gap */
            margin-bottom: 0.5mm;
            //  border: 1px solid #000;
            // display: inline-block;
          }

          .title-line {
            border-bottom: 1px solid #000;
            margin-bottom: 1.5mm;
            margin-top: 0.5mm;
          }

          /* META */
          .meta {
            font-size: 10px;
            line-height: 1.25;
            margin-bottom: 0.8mm;
            display: flex;
            align-items: center;
            justify-content: space-between;
          }

          .meta div {
            margin-bottom: 0.5mm;
          }

          /* ITEM */
          .desc {
            font-size: 9px;
            margin-bottom: 0.8mm;
          }

          .desc p {
          padding-bottom: 0.6mm;}

          .desc span {
            display: block;
            padding-bottom: 0.1mm;
          }

          .desc .label {
            display: block;
            font-size: 10px;
            margin-bottom: 0.8mm;
            margin-top: 0.8mm;
          }

          .desc .text {
            word-break: break-word;
            
          }

          /* QTY */
          .qty-logo {
            font-size: 10px;
            line-height: 1.3;
            margin-bottom: 0.4mm;
            margin-top: 0.8mm;
          }

          /* INSPECTION */
          .inspect {
            margin-top: auto;
            font-size: 10px;
          }

          .inspect-line {
            height: 3mm;
            border-bottom: 1px solid #000;
          }

          .label {
            font-weight: 600;
          }
        </style>
      </head>

      <body>${ar.map(P=>`
        <div class="bin-card">
          <div class="content">

            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>

            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${P.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(P.gmsoaNo).replace(/^SOA/i,"")}-${P.soaSrNo}
                </div>

              </div>
                <div class="title assembly-title">
                  <p>Assembly Line: ${P.assemblyLine}</p>
                </div>
                <div class="meta-item">
                  <p>GMV-L4-F-PRD 01 A</p>
                  <p>(02/10.09.2020)</p>
                </div>
          </div>

            

            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${P.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${P.product}</p>
              </div>
            </div>

            <div class="qty-logo">
            <div class="meta meta-logo">
              <div class="meta-qty"><span class="label">QTY:</span> ${P.qty}</div>
              <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${P.gmLogo}</div>
              </div>
              <div class="detail-items">
  <span class="label">Special Note:</span>
  <span>${P.specialNotes||""}</span>
</div>

              </div>

            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>

          </div>
        </div>`).join("")}</body>
    </html>`,T=document.createElement("iframe");T.style.position="fixed",T.style.right="0",T.style.bottom="0",T.style.width="0",T.style.height="0",T.style.border="0",document.body.appendChild(T);const x=T.contentDocument||T.contentWindow?.document;x&&(x.open(),x.write(W),x.close(),setTimeout(()=>{T.contentWindow?.focus(),T.contentWindow?.print(),setTimeout(()=>document.body.removeChild(T),500)},300))},J=()=>{const ge=G===!0,W=Z===!0,T=z.size>0;if(!ge&&!W&&!T)return;let x=[];if(T?x=Ut.filter(P=>z.has(P.id)):x=Ut,!x||x.length===0){alert("No data available to export");return}de(x)},K=()=>{const ge=c&&c.length>0?c:a;if(!ge||ge.length===0){alert("No data available to export");return}de(ge)},de=ge=>{const W=ge.map((g,m)=>({No:m+1,"Assembly Line":g.assemblyLine,"GMSOA No":g.gmsoaNo,"SOA Sr No":g.soaSrNo,"Assembly Date":g.assemblyDate,"Unique Code":g.uniqueCode,"Splitted Code":g.splittedCode||"-",Party:g.party,"Customer PO No":g.customerPoNo,"Code No":g.codeNo,Product:g.product,"PO Qty":g.poQty,Qty:g.qty,"Qty Executed":g.qtyExe,"Qty Pending":g.qtyPending,"Finished Valve":g.finishedValve,"GM Logo":g.gmLogo,"Name Plate":g.namePlate,"Special Notes":g.specialNotes||"","Product Special 1":g.productSpcl1,"Product Special 2":g.productSpcl2,"Product Special 3":g.productSpcl3,Inspection:g.inspection,Painting:g.painting,Remarks:g.remarks||""})),T=Gt.json_to_sheet(W),x=Gt.book_new();Gt.book_append_sheet(x,T,"Orders");const P=Jr(x,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([P],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},oe=ge=>{It(ge),et(!0)},_e=ge=>{Yt(ge),Ze(ge.remarks||""),St(!0)},Be=async()=>{if(!ct)return;const ge=new FormData;ge.append("orderId",String(ct.id)),ge.append("remarks",te);try{const W=await xt.post(`${qt}/add-remarks`,ge,{headers:{Authorization:`Bearer ${Ct}`}});if(console.log("Add Remarks Response:",W.data),W.data?.Resp_code==="true"||W.data?.Resp_code===!0){l(x=>x.map(P=>P.id===ct.id?{...P,remarks:te}:P));try{t(ct.id,te)}catch{}St(!1),Yt(null),Ze("")}else console.warn("Backend rejected remarks:",W.data)}catch(W){console.error("Error saving remarks:",W)}},Ae=async ge=>{const T=a.find(g=>g.id===ge)?.alertStatus===!0,x=!T;l(g=>{const m=g.map(v=>v.id===ge?{...v,alertStatus:x}:v);return Ne(m)});const P={orderId:String(ge),urgent:x?"1":"0"};try{const g=await xt.post(`${qt}/mark-urgent`,P,{headers:{Authorization:`Bearer ${Ct}`}});g.data?.Resp_code==="true"||g.data?.Resp_code===!0||g.data?.status===!0||l(v=>{const N=v.map(A=>A.id===ge?{...A,alertStatus:T}:A);return Ne(N)})}catch(g){console.error("Urgent API failed:",g),l(m=>{const v=m.map(N=>N.id===ge?{...N,alertStatus:T}:N);return Ne(v)})}},Ne=ge=>[...ge].sort((W,T)=>(W.originalIndex??0)-(T.originalIndex??0)),[je,Me]=d.useState(null),We=()=>{M(""),ke("all"),Fe("all"),ye("all"),we("range"),se(void 0),ue(void 0)};return d.useEffect(()=>{console.log(" SEARCH TERM:",re)},[re]),e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"printable-bin-card",style:{display:"none"}}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4 flex-",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Orders Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow."})]}),e.jsx("div",{className:"flex flex-col gap-4 w-full",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end flex-inner-wrapper",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:V,variant:"outline",disabled:z.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>le(!G),className:`btn-urgent flex items-center gap-2 ${G?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),G?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>he(!Z),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:Z?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{onClick:J,disabled:Ut.length===0,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:K,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{searchTerm:re,setSearchTerm:M,currentStage:"default",assemblyLineFilter:ce,setAssemblyLineFilter:ke,dateFilterMode:Q,setDateFilterMode:we,dateFrom:pe,setDateFrom:se,dateTo:U,setDateTo:ue,assemblyLines:At,onClearFilters:We,hasActiveFilters:ce!=="all"||Ee!=="all"||X!=="all"||!!pe||!!U})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm",children:e.jsx("div",{ref:Qt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle table-sticky",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(ir),onClick:lr,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${ir?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA No."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
                                    text-xs font-medium text-gray-500 uppercase tracking-wider\r
                                    border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>me(ge=>ge==="asc"?"desc":ge==="desc"?null:"asc"),children:["SR.No.",q==="asc"&&" ",q==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-20",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PO QTY"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:zt.map(ge=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:z.has(ge.id),onCheckedChange:()=>rr(ge.id),"aria-label":`Select row ${ge.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:ge.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:ge.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:ge.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:ge.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:ge.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:ge.party,children:Vt(ge.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 min-w-90",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:ge.product,children:ge.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.poQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.qty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:ge.specialNotes,children:ge.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:ge.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:ge.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:ge.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${ge.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>_e(ge),children:e.jsx(is,{className:`h-4 w-4 ${ge.remarks?.trim()?"text-white":"text-blue-600"}`})}),ge.remarks?.trim()&&e.jsx("div",{className:`\r
          absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
          hidden group-hover:block\r
          bg-gray-900 text-white text-xs\r
          px-3 py-2 rounded-md shadow-lg\r
          max-w-[260px] break-words z-[999]\r
        `,children:ge.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>oe(ge),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${ge.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:ge.alertStatus?"Click to unmark urgent":"Click to mark as urgent",onClick:()=>{console.clear(),console.log("BUTTON CLICKED  orderId:",ge.id),console.log("BEFORE CLICK  alertStatus:",ge.alertStatus),Ae(ge.id)},children:e.jsx(gr,{className:`h-4 w-4 ${ge.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},ge.id))})]}),Ut.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),nr.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:nr.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:nr.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:nr.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:nr.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:Ut.length,lastPage:Math.max(1,Math.ceil(Ut.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:xe,onOpenChange:Ge,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ar.map(ge=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",ge.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(ge.gmsoaNo).replace(/^SOA/i,""),"-",ge.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",ge.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:ge.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:ge.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",ge.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",ge.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:ge.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},ge.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>Ge(!1),children:"Cancel"}),e.jsxs(ee,{onClick:ae,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:ot,onOpenChange:et,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",He?.uniqueCode]})]}),He&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.qty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm ",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:He.remarks||"-"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>et(!1),children:"Close"})})]})}),e.jsx(Ot,{open:yt,onOpenChange:St,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:ct?`Order: ${ct.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:te,onChange:ge=>Ze(ge.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>St(!1),children:"Cancel"}),e.jsx(ee,{onClick:Be,children:"Save Remarks"})]})]})})]})]})}const $z={blue:{bg:"from-[#174a9f] to-indigo-600",light:"from-blue-50 to-indigo-50",text:"text-[#174a9f]",glow:"shadow-[#174a9f]/20"},green:{bg:"from-green-500 to-emerald-600",light:"from-green-50 to-emerald-50",text:"text-green-600",glow:"shadow-green-500/20"},purple:{bg:"from-purple-500 to-violet-600",light:"from-purple-50 to-violet-50",text:"text-purple-600",glow:"shadow-purple-500/20"},orange:{bg:"from-orange-500 to-amber-600",light:"from-orange-50 to-amber-50",text:"text-orange-600",glow:"shadow-orange-500/20"}};function sx({title:t,value:r,change:s,icon:n,gradient:a,trend:l}){const c=$z[a];return e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:`absolute -inset-0.5 bg-gradient-to-r ${c.bg} rounded-2xl blur opacity-0 group-hover:opacity-30 transition duration-500`}),e.jsxs("div",{className:"relative bg-white/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/60 p-6 transition-all duration-300 hover:shadow-2xl hover:-translate-y-2 overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${c.light} opacity-50 rounded-bl-full transition-all duration-500 group-hover:w-48 group-hover:h-48`}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm mb-2 group-hover:text-gray-700 transition-colors",children:t}),e.jsx("h3",{className:`text-4xl ${c.text} transition-all duration-300 group-hover:scale-105 inline-block`,children:r})]}),e.jsx("div",{className:`p-3 bg-gradient-to-br ${c.bg} rounded-xl shadow-lg ${c.glow} transition-all duration-300 group-hover:scale-110 group-hover:rotate-6`,children:e.jsx(n,{className:"h-6 w-6 text-white"})})]}),s&&e.jsxs("div",{className:`flex items-center gap-1.5 text-sm ${s.positive?"text-green-600":"text-red-600"}`,children:[e.jsx("span",{className:`text-base transition-transform duration-300 ${s.positive?"":"rotate-180-deg"}`,children:""}),e.jsx("span",{className:"font-medium",children:s.value}),e.jsx("span",{className:"text-gray-500",children:"from last month"})]}),l&&e.jsx("div",{className:"mt-4 h-12 flex items-end gap-1",children:l.map((u,f)=>e.jsx("div",{className:`flex-1 bg-gradient-to-t ${c.bg} rounded-t opacity-30 group-hover:opacity-60 transition-all duration-300`,style:{height:`${u}%`,transitionDelay:`${f*50}ms`}},f))})]}),e.jsx("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"})]})]})}function Ma({className:t,...r}){return e.jsx("div",{"data-slot":"card",className:Nr("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border transition-all duration-300 hover:shadow-lg",t),...r})}const Qz=`${qt}/order-counts`;function lk({onLogout:t}){const[r,s]=d.useState("Dashboard"),[n,a]=d.useState({}),[l,c]=d.useState(!1),[u,f]=d.useState(!0),[h,y]=d.useState(""),[w,j]=d.useState("");(()=>{try{const Z=localStorage.getItem("user")||localStorage.getItem("userData");if(!Z)return"";const he=JSON.parse(Z),ce=typeof he?.role=="object"?he.role?.name:he?.role;return String(ce||"").toLowerCase()}catch{return""}})().includes("admin");const k=d.useRef(!1),S=d.useRef(null),_=Z=>{if(!Z)return Z;const he=Z.toLowerCase().replace(/[\s_-]+/g,"");return he.includes("material")?"materialIssue":he.includes("semi")?"semiQc":he.includes("phosphat")?"phosphatingQc":he==="svs"?"svs":he.includes("testing1")?"testing1":he.includes("testing2")?"testing2":he.includes("marking1")?"marking1":he.includes("marking2")?"marking2":he.includes("pdi1")?"pdi1":he.includes("pdi2")?"pdi2":he.includes("tpi")?"tpi":he.includes("assemblya")||he.includes("linea")?"assemblyA":he.includes("assemblyb")||he.includes("lineb")?"assemblyB":he.includes("assemblyc")||he.includes("linec")?"assemblyC":he.includes("assemblyd")||he.includes("lined")?"assemblyD":Z},I=Z=>{const he={};if(!Z)return he;const ce=Z.counts??Z;if(ce&&typeof ce=="object"){ce.totalOrders!=null&&(he.totalOrders=Number(ce.totalOrders)||0);const ke=[["pendingMaterialIssue","materialIssue"],["pendingSemiQC","semiQc"],["pendingPhosphatingQC","phosphatingQc"],["pendingSVS","svs"],["pendingTesting1","testing1"],["pendingTesting2","testing2"],["pendingMarking1","marking1"],["pendingMarking2","marking2"],["pendingPDI1","pdi1"],["pendingPDI2","pdi2"],["pendingTPI","tpi"],["pendingAssemblyA","assemblyA"],["pendingAssemblyB","assemblyB"],["pendingAssemblyC","assemblyC"],["pendingAssemblyD","assemblyD"],["inProgress","inProgress"],["completed","completed"],["efficiency","efficiency"],["pendingDispatch","dispatch"]];for(const[Ee,Fe]of ke)ce[Ee]!=null&&(he[Fe]=Number(ce[Ee])||0);ce.totalOrdersCompare!=null&&(he.totalOrdersCompare=ce.totalOrdersCompare),ce.inProgressCompare!=null&&(he.inProgressCompare=ce.inProgressCompare),ce.completedCompare!=null&&(he.completedCompare=ce.completedCompare),ce.efficiencyCompare!=null&&(he.efficiencyCompare=ce.efficiencyCompare)}return Z.stages&&Array.isArray(Z.stages)&&Z.stages.forEach(ke=>{he[_(ke.stage)]=Number(ke.pending??0)}),Z.assembly&&Array.isArray(Z.assembly)&&Z.assembly.forEach(ke=>{const Ee=_("assembly"+ke.line);he[Ee]=Number(ke.pending??0)}),he};async function F(Z=!1,he){const ce=localStorage.getItem("token"),ke=ce?{Authorization:`Bearer ${ce}`}:{};ke["Content-Type"]="application/json";try{Z?c(!0):f(!0);const Ee=he?{assemblyDate:he}:{},Fe=await xt.post(Qz,Ee,{headers:ke});a(I(Fe.data))}catch(Ee){console.error("Dashboard summary error:",Ee)}finally{Z?c(!1):f(!1)}}d.useEffect(()=>{if(!k.current)return k.current=!0,F(!1,h||void 0),()=>{S.current&&(clearInterval(S.current),S.current=null)}},[]);const B=Z=>{const he={materialIssue:"Material Issue",semiQc:"Semi QC",phosphatingQc:"Phosphating QC",svs:"SVS",testing1:"Testing-1",testing2:"Testing-2",marking1:"Marking-1",marking2:"Marking-2",pdi1:"PDI-1",pdi2:"PDI-2",tpi:"TPI",dispatch:"Dispatch"};return he[Z]?he[Z]:Z.startsWith("assembly")?"Assembly Line "+Z.slice(-1).toUpperCase():Z},q={materialIssue:"purple",semiQc:"yellow",phosphatingQc:"orange",svs:"green",testing1:"blue",testing2:"blue",marking1:"teal",marking2:"teal",pdi1:"violet",pdi2:"violet",tpi:"rose",dispatch:"green"},me=Object.keys(q),re=["assemblyA","assemblyB","assemblyC","assemblyD"],M={Planning:e.jsx(ik,{}),MaterialIssue:e.jsx(rf,{}),SemiQC:e.jsx(sf,{}),Phosphating:e.jsx(nf,{}),AssemblyA:e.jsx(af,{}),AssemblyB:e.jsx(lf,{}),AssemblyC:e.jsx(of,{}),AssemblyD:e.jsx(cf,{}),Testing1:e.jsx(df,{}),Testing2:e.jsx(uf,{}),SVS:e.jsx(xf,{}),Marking1:e.jsx(mf,{}),Marking2:e.jsx(pf,{}),PDI1:e.jsx(hf,{}),PDI2:e.jsx(ff,{}),TPI:e.jsx(gf,{}),Dispatch:e.jsx(yf,{})};if(r!=="Dashboard")return e.jsx(e.Fragment,{children:M[r]});const G=d.useMemo(()=>n.totalOrders!=null?Number(n.totalOrders):[...me,...re].reduce((he,ce)=>he+Number(n[ce]||0),0),[n]),le=Z=>{if(!Z)return!1;const he=parseFloat(Z.replace("%",""));return!isNaN(he)&&he>=0};return e.jsx("div",{className:"page-container",children:e.jsxs("div",{className:"max-w-7xl mx-auto py-10 px-6 space-y-10 main-content",children:[e.jsxs("div",{className:"top-title",children:[e.jsxs("h1",{className:"text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-[#174a9f] to-[#1a5cb8] rounded-xl shadow-lg",children:e.jsx(Wi,{className:"h-6 w-6 text-white"})}),"Dashboard Overview",e.jsxs("button",{className:"ml-4 flex items-center px-3 py-1 border rounded-md",onClick:()=>{S.current&&(clearInterval(S.current),S.current=null),F(!0,h||void 0)},children:[e.jsx(tw,{className:"h-4 w-4 mr-1"}),"Refresh"]})]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Real-time insights into your manufacturing operations"})]}),e.jsx(e.Fragment,{children:u||l?e.jsx("div",{className:"text-center font-700",children:"Loading...."}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(sx,{title:"Total Orders",value:G,icon:Wi,gradient:"blue",change:{value:String(n.totalOrdersCompare??""),positive:le(n.totalOrdersCompare)},trend:[30,40,50,60,80]}),e.jsx(sx,{title:"In Progress",value:n.inProgress??0,icon:vu,gradient:"orange",change:{value:String(n.inProgressCompare??""),positive:le(n.inProgressCompare)},trend:[20,30,40,60,75]}),e.jsx(sx,{title:"Completed",value:n.completed??0,icon:Z1,gradient:"green",change:{value:String(n.completedCompare??""),positive:le(n.completedCompare)},trend:[40,50,70,90,100]})]})}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h2",{className:"text-gray-900 flex items-center gap-2 top-title",children:[e.jsx(vu,{className:"h-5 w-5 text-[#174a9f]"}),"Stage-wise Pending Quantity"]})}),u||l?e.jsx("div",{className:"text-center font-700",children:"Loading..."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:me.map(Z=>{const he=q[Z];return e.jsx(Ma,{className:`p-4 rounded-xl border bg-gradient-to-br from-${he}-50 to-white border-${he}-200 hover:-translate-y-1 hover:shadow-lg transition`,children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("div",{className:`p-2 rounded-lg bg-${he}-100`,children:e.jsx(Wi,{className:`h-4 w-4 text-${he}-600`})}),e.jsx(Ir,{className:`bg-${he}-100 text-${he}-700 border-${he}-200 text-xs`,children:"Pending"})]}),e.jsx("p",{className:"text-gray-700 text-xs",children:B(Z)}),e.jsx("p",{className:`text-xl font-semibold text-${he}-900`,children:n[Z]??0})]})},Z)})})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-gray-900 flex items-center gap-2 top-title",children:[e.jsx(vu,{className:"text-[#174a9f] pt-5 mt-5"}),"Assembly Line-wise Pending Quantity"]}),u||l?e.jsx("div",{className:"text-center font-700",children:"Loading...."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:re.map(Z=>e.jsx(Ma,{className:"p-4 rounded-xl border bg-gradient-to-br from-purple-50 to-white border-purple-200 hover:-translate-y-1 hover:shadow-lg transition",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-100",children:e.jsx(Wi,{className:"h-4 w-4 text-purple-600"})}),e.jsx(Ir,{className:"bg-purple-100 text-purple-700 border-purple-200 text-xs",children:"Pending"})]}),e.jsx("p",{className:"text-gray-700 text-xs",children:B(Z)}),e.jsx("p",{className:"text-xl font-semibold text-purple-900",children:n[Z]??0})]})},Z))})]})]})})}const Uz="modulepreload",Vz=function(t){return"/"+t},n1={},Wz=function(r,s,n){let a=Promise.resolve();if(s&&s.length>0){let c=function(h){return Promise.all(h.map(y=>Promise.resolve(y).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=u?.nonce||u?.getAttribute("nonce");a=c(s.map(h=>{if(h=Vz(h),h in n1)return;n1[h]=!0;const y=h.endsWith(".css"),w=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${w}`))return;const j=document.createElement("link");if(j.rel=y?"stylesheet":Uz,y||(j.as="script"),j.crossOrigin="",j.href=h,f&&j.setAttribute("nonce",f),document.head.appendChild(j),y)return new Promise((C,k)=>{j.addEventListener("load",C),j.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return a.then(c=>{for(const u of c||[])u.status==="rejected"&&l(u.reason);return r().catch(l)})},Gz=`${qt}/customer-support`;function ok(){const t=te=>{if(!te)return"";const[Ze,at,Ke]=te.split("-");return`${Ke}-${at}-${Ze}`},[r,s]=d.useState(""),[n,a]=d.useState("all"),[l,c]=d.useState("all"),[u,f]=d.useState(null),[h,y]=d.useState(!1),[w,j]=d.useState({}),[C,k]=d.useState(!1),[S,_]=d.useState(null),[I,F]=d.useState(null),[B,q]=d.useState(1),[me,re]=d.useState(100),[M,G]=d.useState({}),[le,Z]=d.useState(!1),[he,ce]=d.useState([]),ke=localStorage.getItem("token"),Ee=d.useMemo(()=>{let te="";try{const at=localStorage.getItem("user")||localStorage.getItem("userData");if(at){const Ke=JSON.parse(at),kt=typeof Ke?.role=="object"?Ke.role?.name:Ke?.role;te=String(kt||"").toLowerCase()}}catch{}return Zb().map(at=>({key:at,display:nt(at)}))},[]),Fe=d.useMemo(()=>{const te={};return Zb().forEach(Ze=>{const at=nt(Ze).replace(/-/g," ").replace(/\s+/g," ").trim().toLowerCase();te[at]=Ze}),te["phosphating qc"]="phosphating",te["after phosphating qc"]="phosphating",te},[]),X=te=>{const Ze=String(te).replace(/-/g," ").replace(/\s+/g," ").trim().toLowerCase();return Fe[Ze]||Ze.replace(/\s+/g,"-")||"planning"},ye=te=>{const Ze=te.status||te.stage||te.stage_name||te.current_stage||te.menu_name||"Planning",at=X(Ze),Ke={};return Object.entries(te.stage_progress||{}).forEach(([kt,vt])=>{const Bt=kt.replace(/-/g," ").replace(/\s+/g," ").trim();Ke[Bt]=vt}),{id:String(te.id),assemblyLine:te.assembly_no||"",gmsoaNo:te.soa_no||"",soaSrNo:te.soa_sr_no||"",assemblyDate:te.assembly_date||"",uniqueCode:te.unique_code||te.order_no||"",splittedCode:te.splitted_code||"",party:te.party_name||te.party||"",customerPoNo:te.customer_po_no||"",codeNo:te.code_no||"",product:te.product||"",totalQty:Number(te.totalQty||te.total_qty||te.qty||0),qty:Number(te.qty||0),qtyExe:Number(te.qty_executed||0),qtyPending:Number(te.qty_pending||0),poQty:Number(te.po_qty||0),finishedValve:te.finished_valve||"",gmLogo:te.gm_logo||"",namePlate:te.name_plate||"",specialNotes:te.special_notes||te.special_note||"",productSpcl1:te.product_spc1||"",productSpcl2:te.product_spc2||"",productSpcl3:te.product_spc3||"",inspection:te.inspection||"",painting:te.painting||"",remarks:te.remarks||"",alertStatus:te.is_urgent===!0||te.is_urgent==="true"||te.alert_status===!0||te.alert_status==="true"||te.urgent===1||te.urgent==="1",expectedDeliveryDate:(()=>{const kt=te.deliveryDate||te.expected_delivery_date||te.expectedDeliveryDate||te.delivery_date||"";if(typeof kt=="string"&&/^\d{2}-\d{2}-\d{4}$/.test(kt)){const[vt,Bt,Et]=kt.split("-");return`${Et}-${Bt}-${vt}`}return kt})(),stage:Ze,stageKey:at,workflowHistory:te.workflowHistory||[],stageProgress:Ke}},Q=async te=>{try{const at=(await xt.post(`${qt}/order-history`,{per_page:20,current_page:1,orderId:te.id},{headers:{Authorization:`Bearer ${ke}`}}))?.data?.splits||{},Ke=Object.values(at).flat();ce(Array.isArray(Ke)?Ke:[]),Z(!0)}catch(Ze){console.error("Error fetching order history",Ze),ce([]),Z(!0)}},we=d.useRef(!1),[pe,se]=d.useState(!1),U=async()=>{if(we.current)return;we.current=!0,se(!0),k(!0),_(null);const te={};try{const Ze=Ge(n),at={per_page:1e3,current_page:1};Ze&&(at.stage=Ze);const Ke=await xt.post(Gz,at,{headers:{Authorization:`Bearer ${ke}`}}),vt=(Array.isArray(Ke?.data?.data)?Ke.data.data:[]).map((Bt,Et)=>{const Qt=ye(Bt);return{...Qt,expectedDeliveryDate:Qt.expectedDeliveryDate||"",originalIndex:Et}});F(Ke?.data?.counts||null),vt.forEach(Bt=>{const Et=Bt.stageKey||"planning";te[Et]||(te[Et]=[]),te[Et].push(Bt)})}catch(Ze){console.warn("GET /customer-support failed",Ze)}G(te),j({}),k(!1),se(!1),we.current=!1},ue=async(te,Ze)=>{try{const at=new FormData;at.append("orderId",String(te.id)),at.append("unique_code",te.uniqueCode),at.append("date",t(Ze)),(await xt.post(`${qt}/add-delivery-date`,at,{headers:{Authorization:`Bearer ${ke}`}}))?.data?.Resp_code&&(await U(),j(kt=>{const vt={...kt};return delete vt[te.uniqueCode],vt}))}catch(at){console.error("Date save failed:",at)}};d.useEffect(()=>{U()},[n,l]),M.planning;const z=M["material-issue"]||[],ne=M["semi-qc"]||[],ve=M.phosphating||[],fe=M["assembly-a"]||[],Ce=M["assembly-b"]||[],Le=M["assembly-c"]||[],De=M["assembly-d"]||[],Ve=[...fe,...Ce,...Le,...De],tt=M.testing1||[],Nt=M.testing2||[],lt=M.svs||[],$t=[...M.marking1||[],...M.marking2||[]],qe=M.pdi1||[],Ie=M.pdi2||[],ut=M.tpi||[],it=M.dispatch||[],jt=d.useMemo(()=>Object.values(M).flat().map(te=>({...te,stageKey:te.stageKey,currentStage:te.stage||nt(te.stageKey)})).sort((te,Ze)=>(te.originalIndex??0)-(Ze.originalIndex??0)),[M]),mt=he.reduce((te,Ze)=>{const at=Ze.split_code||"UNKNOWN";return te[at]||(te[at]=[]),te[at].push(Ze),te},{}),xe=d.useMemo(()=>jt.filter(te=>{const Ze=r.toLowerCase(),at=te.uniqueCode.toLowerCase().includes(Ze)||te.gmsoaNo.toLowerCase().includes(Ze)||te.party.toLowerCase().includes(Ze)||te.customerPoNo.toLowerCase().includes(Ze)||te.product.toLowerCase().includes(Ze)||te.codeNo.toLowerCase().includes(Ze),Ke=l==="all"||te.assemblyLine===l;return at&&Ke}),[jt,r,l]),Ge=te=>te==="all"?"":nt(te),ot=d.useMemo(()=>{const te=(B-1)*me;return xe.slice(te,te+me)},[xe,B,me]);d.useEffect(()=>{q(1)},[r,n,l]);const et=d.useMemo(()=>{const te=I?.totalOrders??jt.length,Ze=I?.totalQty??jt.reduce((N,A)=>N+(A.totalQty||0),0),at=I?.completeOrders??jt.reduce((N,A)=>N+A.qtyExe,0),Ke=I?.pendingQty??jt.reduce((N,A)=>N+A.qtyPending,0),kt=I?.urgentOrders??jt.filter(N=>N.alertStatus).length,vt=z.reduce((N,A)=>N+A.qtyPending,0),Bt=ne.reduce((N,A)=>N+A.qtyPending,0),Et=ve.reduce((N,A)=>N+A.qtyPending,0),Qt=Ve.reduce((N,A)=>N+A.qtyPending,0),Ct=fe.reduce((N,A)=>N+A.qtyPending,0),bt=Ce.reduce((N,A)=>N+A.qtyPending,0),$e=Le.reduce((N,A)=>N+A.qtyPending,0),gt=De.reduce((N,A)=>N+A.qtyPending,0),Pt=tt.reduce((N,A)=>N+A.qtyPending,0),er=Nt.reduce((N,A)=>N+A.qtyPending,0),At=lt.reduce((N,A)=>N+A.qtyPending,0),Ut=$t.reduce((N,A)=>N+A.qtyPending,0),Vt=(M.testing1||[]).reduce((N,A)=>N+A.qtyPending,0),zt=(M.testing2||[]).reduce((N,A)=>N+A.qtyPending,0),rr=(M.marking1||[]).reduce((N,A)=>N+A.qtyPending,0),nr=(M.marking2||[]).reduce((N,A)=>N+A.qtyPending,0),lr=qe.reduce((N,A)=>N+A.qtyPending,0),ir=Ie.reduce((N,A)=>N+A.qtyPending,0),ar=ut.reduce((N,A)=>N+A.qtyPending,0),V=it.reduce((N,A)=>N+A.qtyPending,0),ae=["A","B","C","D","S"],J={};ae.forEach(N=>{J[N]=jt.filter(A=>A.assemblyLine===N).reduce((A,R)=>A+R.qtyPending,0)});const K=N=>({inProgress:N.filter(A=>A.qtyExe>0&&A.qtyPending>0).length,done:N.filter(A=>A.qtyPending===0&&(A.totalQty>0||A.qtyExe>0)).length}),de=K(z),oe=K(ne),_e=K(ve),Be=K(Ve),Ae=K(fe),Ne=K(Ce),je=K(Le),Me=K(De),We=K(M.testing1||[]),ge=K(M.testing2||[]),W=K(lt),T=K(M.marking1||[]),x=K(M.marking2||[]),P=K(qe),g=K(Ie),m=K(ut),v=K(it);return{totalOrders:te,totalQty:Ze,totalCompleted:at,totalPending:Ke,alertCount:kt,materialIssuePending:vt,semiQcPending:Bt,phosphatingQcPending:Et,assemblyPending:Qt,assemblyAPending:Ct,assemblyBPending:bt,assemblyCPending:$e,assemblyDPending:gt,testingPending:Pt,testingPending2:er,svsPending:At,markingPending:Ut,testing1Pending:Vt,testing2Pending:zt,marking1Pending:rr,marking2Pending:nr,pdi1Pending:lr,pdi2Pending:ir,tpiPending:ar,dispatchPending:V,materialIssueCounts:de,semiQcCounts:oe,phosphatingCounts:_e,assemblyCounts:Be,assemblyACounts:Ae,assemblyBCounts:Ne,assemblyCCounts:je,assemblyDCounts:Me,testing1Counts:We,testing2Counts:ge,svsCounts:W,marking1Counts:T,marking2Counts:x,pdi1Counts:P,pdi2Counts:g,tpiCounts:m,dispatchCounts:v,assemblyLinePending:J}},[jt,M]),He=te=>{f(te),y(!0)},It=()=>{Wz(()=>import("./exceljs.min-BG0guFzc.js").then(te=>te.e),[]).then(async te=>{const Ze=te.default||te,at=new Ze.Workbook,Ke=at.addWorksheet("Customer Support"),kt=new Date,vt=kt.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),Bt=kt.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0});Ke.columns=[{header:"Assembly Line",key:"assemblyLine",width:15},{header:"GMSOA NO.",key:"gmsoaNo",width:12},{header:"SOA SR NO.",key:"soaSrNo",width:12},{header:"Assembly Date",key:"assemblyDate",width:15},{header:"Party",key:"party",width:30},{header:"Order No.",key:"orderNo",width:15},{header:"Code No.",key:"codeNo",width:25},{header:"Product",key:"product",width:50},{header:"Qty",key:"qty",width:8},{header:"Qty Executed",key:"qtyExecuted",width:12},{header:"Qty Pending",key:"qtyPending",width:12},{header:"Planning",key:"planning",width:14},{header:"Material Issue",key:"materialIssue",width:15},{header:"Semi QC",key:"semiQc",width:12},{header:"Phosphating QC",key:"phosphating",width:15},{header:"Assembly A",key:"assemblyA",width:12},{header:"Assembly B",key:"assemblyB",width:12},{header:"Assembly C",key:"assemblyC",width:12},{header:"Assembly D",key:"assemblyD",width:12},{header:"Testing1",key:"testing1",width:12},{header:"Testing2",key:"testing2",width:12},{header:"SVS",key:"svs",width:10},{header:"Marking1",key:"marking1",width:12},{header:"Marking2",key:"marking2",width:12},{header:"PDI1",key:"pdi1",width:12},{header:"PDI2",key:"pdi2",width:12},{header:"TPI",key:"tpi",width:10},{header:"Dispatch",key:"dispatch",width:12}],Ke.spliceRows(1,0,[],[],[]),Ke.getCell("A1").value="Date",Ke.getCell("B1").value=vt,Ke.getCell("A1").font={bold:!0,size:12},Ke.getCell("B1").font={size:12},Ke.getCell("A2").value="Time",Ke.getCell("B2").value=Bt,Ke.getCell("A2").font={bold:!0,size:12},Ke.getCell("B2").font={size:12};const Et=Ke.getRow(4);Et.height=20,Et.font={bold:!0,size:11},Et.alignment={vertical:"middle",horizontal:"center"};const Qt={12:"DBEAFE",13:"E9D5FF",14:"FEF3C7",15:"FED7AA",16:"E0E7FF",17:"E0E7FF",18:"E0E7FF",19:"E0E7FF",20:"FCE7F3",21:"FCE7F3",22:"D1FAE5",23:"CCFBF1",24:"CCFBF1",25:"F3F4F6",26:"F3F4F6",27:"FFE4E6",28:"DCFCE7"};Et.eachCell((At,Ut)=>{At.fill={type:"pattern",pattern:"solid",fgColor:{argb:Qt[Ut]?"FF"+Qt[Ut]:"FFF3F4F6"}},At.border={top:{style:"thin",color:{argb:"FFD1D5DB"}},left:{style:"thin",color:{argb:"FFD1D5DB"}},bottom:{style:"thin",color:{argb:"FFD1D5DB"}},right:{style:"thin",color:{argb:"FFD1D5DB"}}}}),xe.forEach(At=>{Ke.addRow({assemblyLine:At.assemblyLine,gmsoaNo:At.gmsoaNo,soaSrNo:At.soaSrNo,assemblyDate:At.assemblyDate,party:At.party,orderNo:At.customerPoNo,codeNo:At.codeNo,product:At.product,qty:At.totalQty,qtyExecuted:At.qtyExe,qtyPending:At.qtyPending,planning:ct(At,nt("planning")),materialIssue:ct(At,nt("material-issue")),semiQc:ct(At,nt("semi-qc")),phosphating:ct(At,nt("phosphating")),assemblyA:ct(At,nt("assembly-a")),assemblyB:ct(At,nt("assembly-b")),assemblyC:ct(At,nt("assembly-c")),assemblyD:ct(At,nt("assembly-d")),testing1:ct(At,nt("testing1")),testing2:ct(At,nt("testing2")),svs:ct(At,nt("svs")),marking1:ct(At,nt("marking1")),marking2:ct(At,nt("marking2")),pdi1:ct(At,nt("pdi1")),pdi2:ct(At,nt("pdi2")),tpi:ct(At,nt("tpi")),dispatch:ct(At,nt("dispatch")),materialIssueLegacy:ct(At,"Material Issue"),semiQcLegacy:ct(At,"Semi QC"),phosphatingQcLegacy:ct(At,"After Phosphating QC"),assemblyLegacy:ct(At,"Assembly"),testingLegacy:ct(At,"Testing"),svsLegacy:ct(At,"SVS"),markingLegacy:ct(At,"Marking")})}),Ke.eachRow((At,Ut)=>{Ut>3&&At.eachCell((Vt,zt)=>{if(Vt.alignment={vertical:"middle",horizontal:"left"},Vt.border={top:{style:"thin",color:{argb:"FFE5E7EB"}},left:{style:"thin",color:{argb:"FFE5E7EB"}},bottom:{style:"thin",color:{argb:"FFE5E7EB"}},right:{style:"thin",color:{argb:"FFE5E7EB"}}},zt>=12&&zt<=28){const rr=Vt.value;rr==="OK"?(Vt.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF86EFAC"}},Vt.font={bold:!0,color:{argb:"FF166534"}},Vt.alignment={vertical:"middle",horizontal:"center"}):rr==="IN PROCESS"?(Vt.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF93C5FD"}},Vt.font={bold:!0,color:{argb:"FF1E40AF"}},Vt.alignment={vertical:"middle",horizontal:"center"}):Vt.alignment={vertical:"middle",horizontal:"center"}}})});const bt=`Customer_Support_Export_${new Date().toISOString().split("T")[0]}.xlsx`,$e=await at.xlsx.writeBuffer(),gt=new Blob([$e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),Pt=window.URL.createObjectURL(gt),er=document.createElement("a");er.href=Pt,er.download=bt,er.click(),window.URL.revokeObjectURL(Pt)}).catch(te=>{console.error("Error exporting data:",te),alert("Failed to export data. Please try again.")})},yt=te=>({Planning:"bg-blue-100 text-blue-700 border-blue-200","Material Issue":"bg-purple-100 text-purple-700 border-purple-200","Semi QC":"bg-yellow-100 text-yellow-700 border-yellow-200",Phosphating:"bg-orange-100 text-orange-700 border-orange-200","Phosphating QC":"bg-orange-100 text-orange-700 border-orange-200","Assembly A":"bg-indigo-100 text-indigo-700 border-indigo-200","Assembly B":"bg-indigo-100 text-indigo-700 border-indigo-200","Assembly C":"bg-indigo-100 text-indigo-700 border-indigo-200","Assembly D":"bg-indigo-100 text-indigo-700 border-indigo-200",Testing1:"bg-pink-100 text-pink-700 border-pink-200",Testing2:"bg-pink-100 text-pink-700 border-pink-200",SVS:"bg-green-100 text-green-700 border-green-200",Marking1:"bg-teal-100 text-teal-700 border-teal-200",Marking2:"bg-teal-100 text-teal-700 border-teal-200",PDI1:"bg-gray-100 text-gray-700 border-gray-200",PDI2:"bg-gray-100 text-gray-700 border-gray-200",TPI:"bg-rose-100 text-rose-700 border-rose-200",Dispatch:"bg-emerald-100 text-emerald-700 border-emerald-200"})[te]||"bg-gray-100 text-gray-700 border-gray-200",St=te=>te==="Phosphating QC"?"Phosphating":te,ct=(te,Ze)=>{const at=te.stageProgress||{},Ke=St(Ze),kt=Ze.replace(/-/g," ").replace(/\s+/g," ").trim(),vt=at[kt]||at[kt.toUpperCase()]||at[kt.toLowerCase()]||at[Ke];if(vt!=null){const Ct=String(vt).trim().toLowerCase().replace(/\s+/g,"_");if(Ct==="ok")return"OK";if(Ct==="pending")return"pending";if(Ct==="in_progress"||Ct==="inprogress")return"IN PROCESS";if(Ct==="skip")return"SKIP"}if(!te.workflowHistory)return"";const Bt=Ct=>String(Ct||"").toLowerCase().replace(/-/g," ").replace(/\s+/g," ").trim().replace(/\s+qc$/,""),Et=Bt(Ze),Qt=te.workflowHistory.findIndex(Ct=>Bt(Ct.stage)===Et);return Qt===-1?"":te.workflowHistory[Qt].exitedAt?"OK":Bt(te.currentStage)===Et?"IN PROCESS":""},Yt=te=>{const Ze=te?.toLowerCase();return Ze==="ok"?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 border border-green-200 rounded text-xs font-medium",children:"OK"})}):Ze==="in process"||Ze==="in_progress"?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 border border-purple-200 rounded text-xs font-medium",children:"In Progress"})}):Ze==="pending"?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 border border-blue-200 rounded text-xs font-medium",children:"Pending"})}):Ze==="skip"?e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 border border-gray-300 rounded text-xs font-medium",children:"Skip"})}):e.jsx("div",{className:"text-center text-gray-300",children:"-"})};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:te=>{window.location.href=`/${te.toLowerCase()}`},onUploadSuccess:()=>U()}),e.jsxs("div",{className:"p-6 max-w-[1920px] mx-auto space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between ctm-wrap",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-[#174a9f] to-[#1a5cb8] rounded-xl shadow-lg",children:e.jsx(Wi,{className:"h-6 w-6 text-white"})}),"Customer Support"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive view of all orders across all workflow stages"})]}),e.jsxs(ee,{onClick:U,disabled:pe||C,className:"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50",children:[e.jsx(tw,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs(ee,{disabled:xe.length===0,onClick:It,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsx(Ma,{className:"p-4 bg-white/70 backdrop-blur-sm border-gray-200 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(Wi,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Total Orders"}),e.jsx("p",{className:"text-2xl text-gray-900",children:et.totalOrders})]})]})}),e.jsx(Ma,{className:"p-4 bg-white/70 backdrop-blur-sm border-gray-200 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-indigo-100 rounded-xl",children:e.jsx(Wi,{className:"h-5 w-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Total Quantity"}),e.jsx("p",{className:"text-2xl text-gray-900",children:et.totalQty})]})]})}),e.jsx(Ma,{className:"p-4 bg-white/70 backdrop-blur-sm border-gray-200 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-xl",children:e.jsx(Z1,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Completed"}),e.jsx("p",{className:"text-2xl text-gray-900",children:et.totalCompleted})]})]})}),e.jsx(Ma,{className:"p-4 bg-white/70 backdrop-blur-sm border-gray-200 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-xl",children:e.jsx(vu,{className:"h-5 w-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Pending"}),e.jsx("p",{className:"text-2xl text-gray-900",children:et.totalPending})]})]})}),e.jsx(Ma,{className:"p-4 bg-white/70 backdrop-blur-sm border-gray-200 hover:shadow-xl transition-all duration-300",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-red-100 rounded-xl",children:e.jsx(cv,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Urgent"}),e.jsx("p",{className:"text-2xl text-gray-900",children:et.alertCount})]})]})})]}),e.jsx(Ma,{className:"p-4 bg-white/70 backdrop-blur-sm border-gray-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(rw,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Xr,{placeholder:"Search by Order ID, SOA NO., Party, Customer PO, Product, or Code No...",value:r,onChange:te=>s(te.target.value),className:"pl-10 border-gray-300 focus:border-[#174a9f] focus:ring-[#174a9f]"})]}),e.jsxs(ts,{value:n,onValueChange:a,children:[e.jsx(ss,{className:"w-full md:w-[200px] border-gray-300",children:e.jsx(rs,{placeholder:"Filter by Stage"})}),e.jsxs(ns,{children:[e.jsx(Pr,{value:"all",children:"All Stages"}),Ee.map(te=>e.jsx(Pr,{value:te.key,children:te.display},te.key))]})]}),e.jsxs(ts,{value:l,onValueChange:c,children:[e.jsx(ss,{className:"w-full md:w-[200px] border-gray-300",children:e.jsx(rs,{placeholder:"Filter by Line"})}),e.jsxs(ns,{children:[e.jsx(Pr,{value:"all",children:"All Lines"}),e.jsx(Pr,{value:"A",children:"Line A"}),e.jsx(Pr,{value:"B",children:"Line B"}),e.jsx(Pr,{value:"C",children:"Line C"}),e.jsx(Pr,{value:"D",children:"Line D"})]})]})]})}),e.jsx(Ma,{className:"bg-white/70 backdrop-blur-sm border-gray-200 overflow-hidden",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{className:"bg-gradient-to-r from-[#174a9f]/10 to-indigo-50/50 border-b border-gray-200",children:[e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 sticky left-0 bg-gradient-to-r from-[#174a9f]/10 to-indigo-50/50 z-10 ctm-opacity",children:"Assembly Line"}),e.jsx("th",{className:"px-4 py-3 text-gray-700 truncate text-center",children:"SOA NO."}),e.jsx("th",{className:"px-4 py-3 text-gray-700 text-center truncate",children:"SR.NO."}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 truncate text-center",children:"Assembly Date"}),e.jsx("th",{className:"px-4 py-3 text-gray-700 truncate text-center",children:"Unique Code"}),e.jsx("th",{className:"px-4 py-3 text-gray-700 truncate text-center",children:"Party"}),e.jsx("th",{className:"px-4 py-3 text-gray-700 truncate text-center",children:"Order No."}),e.jsx("th",{className:"px-4 py-3 text-gray-700 truncate text-center",children:"Code No."}),e.jsx("th",{className:"px-4 py-3 text-gray-700 truncate text-center",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 truncate text-center",children:"PO Qty"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-sky-50/80 truncate text-center",children:"Expected Delivery Date"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 truncate text-center",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 truncate text-center",children:"Qty Executed"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700",children:"Qty Pending"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-blue-50/80",children:"Planning"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-purple-50/80",children:"Material Issue"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-yellow-50/80",children:"Semi QC"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-orange-50/80",children:"Phosphating QC"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-indigo-50/80",children:"Assembly A"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-indigo-50/80",children:"Assembly B"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-indigo-50/80",children:"Assembly C"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-indigo-50/80",children:"Assembly D"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-pink-50/80",children:"Testing1"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-pink-50/80",children:"Testing2"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-green-50/80",children:"SVS"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-teal-50/80",children:"Marking1"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-teal-50/80",children:"Marking2"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-gray-50/80",children:"PDI1"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-gray-50/80",children:"PDI2"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-rose-50/80",children:"TPI"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700 bg-emerald-50/80",children:"Dispatch"}),e.jsx("th",{className:"px-4 py-3 text-center text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:C?e.jsx("tr",{children:e.jsx("td",{colSpan:30,className:"px-4 py-12 text-center text-gray-500",children:"Loading..."})}):xe.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:30,className:"px-4 py-12 text-center text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(ew,{className:"h-12 w-12 text-gray-400"}),e.jsx("p",{children:"No orders found matching your criteria"})]})})}):ot.map(te=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-blue-50/50 transition-colors duration-150",children:[e.jsx("td",{className:"px-4 py-3 sticky left-0 bg-white hover:bg-blue-50/50 z-10",children:e.jsxs("div",{className:"flex items-center gap-2",children:[te.alertStatus&&e.jsx(cv,{className:"h-4 w-4 text-red-500 animate-pulse-soft"}),e.jsx(Ir,{className:"bg-gray-100 text-gray-700 border-gray-200",children:te.assemblyLine})]})}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700",children:te.gmsoaNo}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700",children:te.soaSrNo}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700 truncate",children:te.assemblyDate}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700 truncate",children:te.uniqueCode}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700 max-w-[200px] truncate",title:te.party,children:te.party}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700",children:te.customerPoNo}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700",children:te.codeNo}),e.jsx("td",{className:"px-4 py-3 text-center text-gray-700 max-w-[300px] truncate",title:te.product,children:te.product}),e.jsx("td",{className:"px-4 py-3 text-center",children:te.poQty}),e.jsxs("td",{className:"px-4 py-3 bg-sky-50/30 text-center",children:[e.jsx(Xr,{type:"date",value:w[te.uniqueCode]?w[te.uniqueCode]:te.expectedDeliveryDate||"",onChange:Ze=>{const at=Ze.target.value;ue(te,at),j(Ke=>({...Ke,[te.uniqueCode]:at}))},className:"w-40 mx-auto text-sm border-gray-300"}),(w[te.uniqueCode]||te.expectedDeliveryDate)&&e.jsx("div",{className:"text-xs text-gray-600 mt-1 hidden",children:(()=>{const Ze=w[te.uniqueCode]||te.expectedDeliveryDate;if(!Ze)return"";const[at,Ke,kt]=Ze.split("-");return`${kt}-${Ke}-${at}`})()})]}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(Ir,{className:"bg-blue-100 text-blue-700 border-blue-200",children:te.totalQty})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(Ir,{className:te.qtyPending===0?"bg-blue-100 text-blue-700 border-blue-200":"bg-green-100 text-green-700 border-green-200",children:te.qtyExe})}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(Ir,{className:te.qtyPending===0?"bg-blue-100 text-blue-700 border-blue-200":"bg-orange-100 text-orange-700 border-orange-200",children:te.qtyPending})}),e.jsx("td",{className:"px-4 py-3 bg-blue-50/30 truncate",children:Yt(ct(te,nt("planning")))}),e.jsx("td",{className:"px-4 py-3 bg-purple-50/30 truncate",children:Yt(ct(te,nt("material-issue")))}),e.jsx("td",{className:"px-4 py-3 bg-yellow-50/30 truncate",children:Yt(ct(te,nt("semi-qc")))}),e.jsx("td",{className:"px-4 py-3 bg-orange-50/30 truncate",children:Yt(ct(te,nt("phosphating")))}),e.jsx("td",{className:"px-4 py-3 bg-indigo-50/30 truncate",children:Yt(ct(te,nt("assembly-a")))}),e.jsx("td",{className:"px-4 py-3 bg-indigo-50/30 truncate",children:Yt(ct(te,nt("assembly-b")))}),e.jsx("td",{className:"px-4 py-3 bg-indigo-50/30 truncate",children:Yt(ct(te,nt("assembly-c")))}),e.jsx("td",{className:"px-4 py-3 bg-indigo-50/30 truncate",children:Yt(ct(te,nt("assembly-d")))}),e.jsx("td",{className:"px-4 py-3 bg-pink-50/30 truncate",children:Yt(ct(te,nt("testing1")))}),e.jsx("td",{className:"px-4 py-3 bg-pink-50/30 truncate",children:Yt(ct(te,nt("testing2")))}),e.jsx("td",{className:"px-4 py-3 bg-green-50/30 truncate",children:Yt(ct(te,nt("svs")))}),e.jsx("td",{className:"px-4 py-3 bg-teal-50/30 truncate",children:Yt(ct(te,nt("marking1")))}),e.jsx("td",{className:"px-4 py-3 bg-teal-50/30 truncate",children:Yt(ct(te,nt("marking2")))}),e.jsx("td",{className:"px-4 py-3 bg-gray-50/30 truncate",children:Yt(ct(te,nt("pdi1")))}),e.jsx("td",{className:"px-4 py-3 bg-gray-50/30 truncate",children:Yt(ct(te,nt("pdi2")))}),e.jsx("td",{className:"px-4 py-3 bg-rose-50/30 truncate",children:Yt(ct(te,nt("tpi")))}),e.jsx("td",{className:"px-4 py-3 bg-emerald-50/30 truncate",children:Yt(ct(te,nt("dispatch")))}),e.jsxs("td",{className:"px-4 py-3 text-center truncate",children:[e.jsx(ee,{size:"sm",variant:"ghost",onClick:()=>He(te),className:"hover:bg-[#174a9f]/10 hover:text-[#174a9f]",children:e.jsx(Hr,{className:"h-4 w-4"})}),e.jsx(ee,{size:"sm",variant:"ghost",onClick:()=>Q(te),className:"hover:bg-[#174a9f]/10 hover:text-[#174a9f]",children:e.jsx(uv,{className:"h-4 w-4"})})]})]},`${te.id}-${te.uniqueCode}-${Math.random()}`))})]})})}),e.jsx(os,{page:B,perPage:me,total:xe.length,lastPage:Math.max(1,Math.ceil(xe.length/Math.max(me,1))),onChangePage:q,onChangePerPage:re,disabled:C}),e.jsxs("div",{className:"text-center text-gray-600 text-sm",children:["Showing ",xe.length," of ",jt.length," orders"]}),e.jsx(Ot,{open:h,onOpenChange:y,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",u?.uniqueCode]})]}),u&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.qty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.gmLogo||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.namePlate||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special Notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.inspection||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.painting||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:u.remarks||"-"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>y(!1),children:"Close"})})]})}),e.jsx(Ot,{open:le,onOpenChange:Z,children:e.jsxs(Tt,{className:"max-w-[800px] w-full modal-main overflow-y-auto rounded-xl shadow-lg flex flex-col",children:[e.jsxs(Rt,{children:[e.jsxs(Dt,{className:"text-xl flex items-center gap-2",children:[e.jsx(uv,{className:"h-5 w-5 text-[#174a9f]"}),"Order History"]}),e.jsx(Ft,{className:"text-gray-600",children:"Stage-by-stage workflow with timestamps and quantities."})]}),e.jsx("div",{className:"border rounded-lg bg-white",children:e.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700 text-sm border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left w-[25%]",children:"Split Code"}),e.jsx("th",{className:"px-4 py-3 text-left w-[40%]",children:"Stage / Time"}),e.jsx("th",{className:"px-4 py-3 text-center w-[20%]",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-center w-[20%]",children:"Assigned"}),e.jsx("th",{className:"px-4 py-3 text-center w-[20%]",children:"Duration"})]})}),e.jsx("tbody",{className:"text-sm",children:Object.keys(mt).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center text-gray-500 py-4",children:"No history found"})}):Object.entries(mt).flatMap(([te,Ze])=>Ze.map((at,Ke)=>e.jsxs("tr",{className:"border-b hover:bg-blue-50/40 transition",children:[e.jsx("td",{className:"px-4 py-4 font-semibold text-blue-700",children:te}),e.jsxs("td",{className:"px-4 py-4 align-top",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium border ${yt(at.currentStage)}`,children:at.currentStage}),e.jsxs("div",{className:"text-xs text-gray-700 mt-1",children:[e.jsx("div",{children:at.entered}),at.exited&&e.jsx("div",{children:at.exited})]})]}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 border border-blue-200 rounded text-xs font-medium",children:at.qty})}),e.jsx("td",{className:"px-4 py-4 text-center",children:at.assigned_qty==="-"||at.assigned_qty==="0"||at.assigned_qty===0?e.jsx("span",{className:"text-gray-400 font-medium",children:"-"}):e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 border border-green-200 rounded text-xs font-medium",children:at.assigned_qty})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-700 border border-indigo-200 rounded text-xs font-medium",children:at.duration||"-"})})]},`${te}-${Ke}`)))})]})})})]})})]})]})}const Hz=()=>{const[t,r]=d.useState(()=>{try{return sessionStorage.getItem("superAdminActiveTab")||"dashboard"}catch{return"dashboard"}}),s=d.useMemo(()=>[{key:"dashboard",label:"Dashboard",component:e.jsx(lk,{onLogout:()=>{try{localStorage.clear()}catch{}window.location.href="/login"}})},{key:"planning",label:"Planning",component:e.jsx(ik,{})},{key:"material-issue",label:"Material Issue",component:e.jsx(rf,{})},{key:"semi-qc",label:"Semi QC",component:e.jsx(sf,{})},{key:"phosphating",label:"Phosphating",component:e.jsx(nf,{})},{key:"assembly-a",label:"Assembly A",component:e.jsx(af,{})},{key:"assembly-b",label:"Assembly B",component:e.jsx(lf,{})},{key:"assembly-c",label:"Assembly C",component:e.jsx(of,{})},{key:"assembly-d",label:"Assembly D",component:e.jsx(cf,{})},{key:"testing1",label:"Testing 1",component:e.jsx(df,{})},{key:"testing2",label:"Testing 2",component:e.jsx(uf,{})},{key:"svs",label:"SVS",component:e.jsx(xf,{})},{key:"marking1",label:"Marking 1",component:e.jsx(mf,{})},{key:"marking2",label:"Marking 2",component:e.jsx(pf,{})},{key:"pdi1",label:"PDI 1",component:e.jsx(hf,{})},{key:"pdi2",label:"PDI 2",component:e.jsx(ff,{})},{key:"tpi",label:"TPI",component:e.jsx(gf,{})},{key:"dispatch",label:"Dispatch",component:e.jsx(yf,{})},{key:"customer-support",label:"Customer Support",component:e.jsx(ok,{})}],[]),n=s.find(a=>a.key===t)??s[0];return d.useEffect(()=>{try{sessionStorage.setItem("superAdminActiveTab",t)}catch{}},[t]),e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(ls,{role:"planning",currentPage:t==="dashboard"?"Dashboard":t==="planning"?"Planning":t,onLogout:()=>{try{localStorage.clear()}catch{}window.location.href="/login"},onNavigate:a=>{const l=a.toLowerCase().replace(/\s+/g,"-");r(l)}}),e.jsx("div",{className:"z-30 bg-white/80 backdrop-blur border-b px-4 py-2 flex flex-wrap gap-2 main-admin-tabbing",children:s.map(a=>e.jsx(ee,{variant:a.key===t?"default":"outline",className:a.key===t?"":"bg-white",onClick:()=>r(a.key),children:a.label},a.key))}),e.jsx("div",{className:"flex-1 inner-header-main overflow-y-auto overflow-x-hidden",children:n.component})]})};function Yz(){const t=En(),[r,s]=d.useState([]),[n,a]=d.useState(!1),[l,c]=d.useState(1),[u,f]=d.useState(20),[h,y]=d.useState(""),[w,j]=d.useState("all"),[C,k]=d.useState("range"),[S,_]=d.useState(),[I,F]=d.useState(),[B,q]=d.useState(new Set),[me,re]=d.useState(!1),[M,G]=d.useState(null),[le,Z]=d.useState(!1),[he,ce]=d.useState(!1),[ke,Ee]=d.useState(null),[Fe,X]=d.useState(""),[ye,Q]=d.useState(null),we=d.useRef(null),pe=localStorage.getItem("token"),se=async()=>{try{a(!0);const qe=await xt.post(`${qt}/get-svs-orders`,{menu_name:nt("svs")},{headers:{Authorization:`Bearer ${pe}`}});if((qe.data?.Resp_code===!0||qe.data?.Resp_code==="true"||qe.data?.Resp_code==="RCS")&&Array.isArray(qe.data.data)){const ut=qe.data.data.map(it=>({id:String(it.id),assemblyLine:it.assembly_no||"",gmsoaNo:it.soa_no||"",soaSrNo:it.soa_sr_no||"",assemblyDate:it.assembly_date||"",uniqueCode:it.unique_code||"",splittedCode:it.split_code||"",party:it.party_name||"",customerPoNo:it.customer_po_no||"",codeNo:it.code_no||"",product:it.product||"",totalQty:Number(it.totalQty||it.qty||0),qtyExe:Number(it.qty_executed||0),qtyPending:Number(it.qty_pending||0),finishedValve:it.finished_valve||"",gmLogo:it.gm_logo||"",namePlate:it.name_plate||"",specialNotes:it.special_notes||"",productSpcl1:it.product_spc1||"",productSpcl2:it.product_spc2||"",productSpcl3:it.product_spc3||"",inspection:it.inspection||"",painting:it.painting||"",remarks:it.remarks||""}));s(ut)}else s([])}catch(qe){console.error("SVS Stock fetch error",qe)}finally{a(!1)}};d.useEffect(()=>{se()},[]);const U=d.useMemo(()=>Array.from(new Set(r.map(qe=>qe.assemblyLine))).filter(Boolean),[r]),ue=(qe="",Ie=4)=>{const ut=qe.trim().split(/\s+/);return ut.length<=Ie?qe:ut.slice(0,Ie).join(" ")+"..."},z=d.useMemo(()=>{let qe=r.slice();if(w!=="all"&&(qe=qe.filter(Ie=>Ie.assemblyLine===w)),h.trim()){const Ie=h.toLowerCase();qe=qe.filter(ut=>ut.uniqueCode.toLowerCase().includes(Ie)||ut.party.toLowerCase().includes(Ie)||ut.product.toLowerCase().includes(Ie)||ut.gmsoaNo.toLowerCase().includes(Ie))}return ye&&qe.sort((Ie,ut)=>{const it=Number(Ie.soaSrNo)||0,jt=Number(ut.soaSrNo)||0;return ye==="asc"?it-jt:jt-it}),qe},[r,w,h,ye]),ne=d.useMemo(()=>{const qe=(l-1)*u;return z.slice(qe,qe+u)},[z,l,u]);d.useEffect(()=>c(1),[w,h]);const ve=qe=>{q(Ie=>{const ut=new Set(Ie);return ut.has(qe)?ut.delete(qe):ut.add(qe),ut})},fe=()=>{q(qe=>qe.size===z.length?new Set:new Set(z.map(Ie=>Ie.id)))},Ce=z.length>0&&B.size===z.length,Le=r.filter(qe=>B.has(qe.id)),De=()=>Z(!0),Ve=()=>{const Ie=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>
        <style>
          @page { size: 130mm 85mm; margin: 0; }
          html, body { width: 130mm; height: 85mm; margin: 0; padding: 0; font-family: Arial, Helvetica, sans-serif; }
          .item-label, .party-desc { padding-bottom: 2mm; }
          .item-label { line-height: 1.8em; }
          .bin-card { width: 130mm; height: 85mm; padding: 6mm; box-sizing: border-box; page-break-after: always; }
          .item-label-description { padding-top: 50px; }
          .meta-qty { width: 50%; }
          .process-border { border-top:1px solid #000; border-bottom:1px solid #000; padding-top: 1.5mm; padding-bottom: 1.5mm; }
          .detail-logo { padding-bottom: 0.9mm; }
          .description { padding-bottom: 2mm; }
          .content { width: 100%; height: 100%; border: 1.5px solid #000; border-radius: 10px; padding-top: 2mm; padding-bottom: 4mm; padding-left: 6mm; padding-right: 6mm; box-sizing: border-box; display: flex; flex-direction: column; }
          .meta-item { padding-top: 2mm; }
          p { margin: 0; }
          .company-name { font-size: 12px; font-weight: 700; text-align: center; margin: 0 0 1mm; }
          .assembly-title p { border: 1px solid #000; display: inline-block; padding-top: 1mm; padding-bottom: 0.9mm; padding-left: 1mm; padding-right: 1mm; }
          .company-address { font-size: 8px; font-weight: 400; text-align: center; line-height: 1.2; margin: 0 0 1.2mm; }
          .tag-title { font-size: 11px; font-weight: 700; text-align: center; margin: 0 0 1.5mm; }
          .doc-row { display: flex; justify-content: space-between; font-size: 9px; margin-bottom: 0.5mm; }
          .title { text-align: center; font-size: 11px; font-weight: 700; margin-top: 0; margin-bottom: 0.5mm; }
          .title-line { border-bottom: 1px solid #000; margin-bottom: 1.5mm; margin-top: 0.5mm; }
          .meta { font-size: 10px; line-height: 1.25; margin-bottom: 0.8mm; display: flex; align-items: center; justify-content: space-between; }
          .meta div { margin-bottom: 0.5mm; }
          .desc { font-size: 9px; margin-bottom: 0.8mm; }
          .desc p { padding-bottom: 0.6mm; }
          .desc span { display: block; padding-bottom: 0.1mm; }
          .desc .label { display: block; font-size: 10px; margin-bottom: 0.8mm; margin-top: 0.8mm; }
          .desc .text { word-break: break-word; }
          .qty-logo { font-size: 10px; line-height: 1.3; margin-bottom: 0.4mm; margin-top: 0.8mm; }
          .inspect { margin-top: auto; font-size: 10px; }
          .inspect-line { height: 3mm; border-bottom: 1px solid #000; }
          .label { font-weight: 600; }
        </style>
      </head>
      <body>${Le.map(jt=>`
        <div class="bin-card">
          <div class="content">
            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>
            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>
            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${jt.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(jt.gmsoaNo).replace(/^SOA/i,"")}-${jt.soaSrNo}
                </div>
              </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${jt.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
            </div>
            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${jt.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${jt.product}</p>
              </div>
            </div>
            <div class="qty-logo">
              <div class="meta meta-logo">
                <div class="meta-qty"><span class="label">QTY:</span> ${jt.totalQty}</div>
                <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${jt.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${jt.specialNotes||""}</span></div>
            </div>
            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>
          </div>
        </div>`).join("")}</body>
    </html>`,ut=document.createElement("iframe");ut.style.position="fixed",ut.style.right="0",ut.style.bottom="0",ut.style.width="0",ut.style.height="0",ut.style.border="0",document.body.appendChild(ut);const it=ut.contentDocument||ut.contentWindow?.document;it&&(it.open(),it.write(Ie),it.close(),setTimeout(()=>{ut.contentWindow?.focus(),ut.contentWindow?.print(),setTimeout(()=>document.body.removeChild(ut),500)},300))},tt=qe=>{G(qe),re(!0)},Nt=qe=>{Ee(qe),X(qe.remarks||""),ce(!0)},lt=()=>{const qe=B.size>0?z.filter(Ie=>B.has(Ie.id)):z;if(!qe.length){alert("No data available to export");return}$t(qe)},$t=qe=>{const Ie=qe.map((mt,xe)=>({No:xe+1,"Assembly Line":mt.assemblyLine,"GMSOA No":mt.gmsoaNo,"SOA Sr No":mt.soaSrNo,"Assembly Date":mt.assemblyDate,"Unique Code":mt.uniqueCode,"Splitted Code":mt.splittedCode||"-",Party:mt.party,"Customer PO No":mt.customerPoNo,"Code No":mt.codeNo,Product:mt.product,Qty:mt.totalQty,"Qty Executed":mt.qtyExe,"Qty Pending":mt.qtyPending,"Finished Valve":mt.finishedValve,"GM Logo":mt.gmLogo,"Name Plate":mt.namePlate,"Special Notes":mt.specialNotes||"","Product Special 1":mt.productSpcl1,"Product Special 2":mt.productSpcl2,"Product Special 3":mt.productSpcl3,Inspection:mt.inspection,Painting:mt.painting,Remarks:mt.remarks||""})),ut=Gt.json_to_sheet(Ie),it=Gt.book_new();Gt.book_append_sheet(it,ut,"SVS Stock");const jt=Jr(it,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([jt],{type:"application/octet-stream"}),`SVS_Stock_${new Date().toISOString().slice(0,10)}.xlsx`)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"SVS Stock",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:qe=>window.location.href=`/${qe.toLowerCase()}`}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 bg-white min-h-screen animate-fade-in",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"SVS Inventory (Stock)"}),e.jsx("p",{className:"text-gray-600",children:"Read-only inventory view (Finished Valve = Yes)"}),e.jsx("div",{className:"mt-4",children:e.jsxs(ee,{variant:"outline",className:"flex items-center gap-2",onClick:()=>{try{const qe=localStorage.getItem("user"),Ie=qe?JSON.parse(qe):null,ut=Ie?.role?.name||Ie?.role||"";String(ut||"").toLowerCase().includes("planning")?t("/planning"):t("/svs")}catch{t("/svs")}},title:"Back to SVS",children:[e.jsx(om,{className:"h-4 w-4"}),"Back to SVS"]})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(ee,{onClick:De,variant:"outline",disabled:B.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:lt,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:h,setSearchTerm:y,assemblyLineFilter:w,setAssemblyLineFilter:j,dateFilterMode:C,setDateFilterMode:k,dateFrom:S,setDateFrom:_,dateTo:I,setDateTo:F,assemblyLines:U,onClearFilters:()=>{j("all"),y(""),_(void 0),F(void 0)},hasActiveFilters:w!=="all"||!!S||!!I})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:we,className:"relative overflow-x-auto max-w-full",style:{scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:n&&r.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(Ce),onClick:fe,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${Ce?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24 cursor-pointer select-none",onClick:()=>Q(qe=>qe==="asc"?"desc":qe==="desc"?null:"asc"),children:["Sr.No.",ye==="asc"&&" ",ye==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Finished Valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:ne.map((qe,Ie)=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:B.has(qe.id),onCheckedChange:()=>ve(qe.id),"aria-label":`Select row ${qe.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:qe.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:qe.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:qe.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:qe.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:qe.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:qe.party,children:ue(qe.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:qe.product,children:qe.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:qe.specialNotes,children:qe.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:qe.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:qe.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:qe.remarks||"View Remarks",className:`h-7 w-7 p-0 ${qe.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>Nt(qe),children:e.jsx(is,{className:`h-4 w-4 ${qe.remarks?.trim()?"text-white":"text-blue-600"}`})}),qe.remarks?.trim()&&e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block bg-gray-900 text-white text-xs px-3 py-2 rounded-md shadow-lg max-w-[260px] break-words z-[999]",children:qe.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>tt(qe),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})})})})]},`${qe.id}-${qe.soaSrNo}-${qe.uniqueCode}-${Ie}`))})]}),z.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No SVS stock found"})]})})})}),e.jsx(os,{page:l,perPage:u,total:z.length,lastPage:Math.max(1,Math.ceil(z.length/Math.max(u,1))),onChangePage:c,onChangePerPage:f,disabled:n})]}),e.jsx(Ot,{open:le,onOpenChange:Z,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:Le.map(qe=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",qe.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(qe.gmsoaNo).replace(/^SOA/i,""),"-",qe.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",qe.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:qe.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:qe.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",qe.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",qe.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:qe.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},qe.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),e.jsxs(ee,{onClick:Ve,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:me,onOpenChange:re,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",M?.uniqueCode]})]}),M&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.splittedCode||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special Notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.specialNotes||"N/A"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.productSpcl1||"N/A"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.productSpcl2||"N/A"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.productSpcl3||"N/A"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:M.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>re(!1),children:"Close"})})]})}),e.jsx(Ot,{open:he,onOpenChange:ce,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"View Remarks"}),e.jsx(Ft,{children:ke?`Order: ${ke.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",value:Fe,readOnly:!0,rows:6,className:"resize-none bg-gray-50"})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>ce(!1),children:"Close"})})]})})]})}const Kz=(t,r)=>{if(!t)return"";const s=String(t).trim().split(/\s+/);return s.length<=r?t:s.slice(0,r).join(" ")+"..."};function Xz(){const t=En(),{updateRemark:r,getRemark:s,getAlertStatus:n}=gs(),a=localStorage.getItem("token"),[l,c]=d.useState([]),[u,f]=d.useState(null),[h,y]=d.useState(!1),[w,j]=d.useState(null),[C,k]=d.useState(1),[S,_]=d.useState(20),[I,F]=d.useState(null),[B,q]=d.useState(""),[me,re]=d.useState(!1),[M,G]=d.useState(!1),[le,Z]=d.useState("all"),[he,ce]=d.useState("all"),[ke,Ee]=d.useState("all"),[Fe,X]=d.useState("range"),[ye,Q]=d.useState(void 0),[we,pe]=d.useState(void 0),[se,U]=d.useState(new Set),[ue,z]=d.useState(!1),[ne,ve]=d.useState(null),[fe,Ce]=d.useState(""),[Le,De]=d.useState(!1),[Ve,tt]=d.useState(null),Nt=d.useRef(null),lt=async()=>{try{y(!0),j(null);const te=await xt.post(`${qt}/packaging-orders`,{},{headers:{Authorization:`Bearer ${a}`}});if((te.data?.status===!0||te.data?.status==="true"||Array.isArray(te.data?.data))&&Array.isArray(te.data.data)){const at=te.data.data.map((Ke,kt)=>({id:String(Ke.id),assemblyLine:Ke.assembly_no||"",gmsoaNo:Ke.soa_no||"",soaSrNo:Ke.soa_sr_no||"",assemblyDate:Ke.assembly_date||"",uniqueCode:Ke.unique_code||Ke.order_no||"",splittedCode:Ke.split_code||Ke.splitted_code||"",split_id:Ke.split_id||Ke.split_code||Ke.splitted_code||"",party:Ke.party_name||Ke.party||"",customerPoNo:Ke.customer_po_no||"",codeNo:Ke.code_no||"",product:Ke.product||"",totalQty:Number(Ke.totalQty||Ke.total_qty||Ke.qty||Ke.po_qty||0),qtyExe:Number(Ke.qty_executed||Ke.assigned_qty||0),qtyPending:Number(Ke.qty_pending||Ke.remaining_qty||0),finishedValve:Ke.finished_valve||"",gmLogo:Ke.gm_logo||"",namePlate:Ke.name_plate||"",productSpcl1:Ke.product_spc1||"",productSpcl2:Ke.product_spc2||"",productSpcl3:Ke.product_spc3||"",inspection:Ke.inspection||"",painting:Ke.painting||"",remarks:Ke.remarks||"",specialNotes:Ke.special_notes||Ke.special_note||"",alertStatus:Ke.is_urgent===!0||Ke.is_urgent==="true"||Ke.alert_status===!0||Ke.alert_status==="true"||Ke.urgent===1||Ke.urgent==="1",packaging:Ke.is_packaging===1||Ke.is_packaging==="1"||Ke.packaging===1||Ke.packaging==="1"?1:0,oclNo:Ke.ocl_no||"",completedDate:Ke.completed_date||"",originalIndex:kt}));c(at),f(at)}else c([]),j(te?.data?.message||te?.data?.Resp_desc||"Failed to fetch packaging orders")}catch{j("Error fetching packaging orders")}finally{y(!1)}};d.useEffect(()=>{lt()},[]);const $t=d.useMemo(()=>Array.from(new Set(l.map(te=>te.assemblyLine))).filter(Boolean).sort(),[l]);d.useMemo(()=>Array.from(new Set(l.map(te=>te.gmsoaNo))).filter(Boolean).sort(),[l]),d.useMemo(()=>Array.from(new Set(l.map(te=>te.party))).filter(Boolean).sort(),[l]);const qe=te=>{const Ze=parseInt(te,10);return isNaN(Ze)?0:Ze},Ie=d.useMemo(()=>{let te=l.slice();if(me&&(te=te.filter(Ze=>n(String(Ze.id))||Ze.alertStatus)),M&&(te=te.filter(Ze=>typeof Ze.remarks=="string"&&Ze.remarks.trim().length>0)),le!=="all"&&(te=te.filter(Ze=>Ze.assemblyLine===le)),he!=="all"&&(te=te.filter(Ze=>Ze.gmsoaNo===he)),ke!=="all"&&(te=te.filter(Ze=>Ze.party===ke)),(ye||we)&&(te=te.filter(Ze=>{if(!Ze.assemblyDate||Ze.assemblyDate==="HOLD")return!1;const Ke=Ze.assemblyDate.split(/[\/-]/).map(vt=>vt.trim()).map(vt=>Number(vt));if(Ke.some(vt=>isNaN(vt)))return!1;let kt=null;if(Ke.length>=3){const[vt,Bt,Et]=Ke;kt=new Date(Et,Bt-1,vt)}else if(Ke.length===2){const[vt,Bt]=Ke;kt=new Date(Bt,vt-1,1)}else if(Ke.length===1){const[vt]=Ke;kt=new Date(vt,0,1)}else return!1;if(!kt||isNaN(kt.getTime()))return!1;if(Fe==="year"&&ye)return kt.getFullYear()===ye.getFullYear();if(Fe==="month"&&ye)return kt.getFullYear()===ye.getFullYear()&&kt.getMonth()===ye.getMonth();if(Fe==="range"){if(ye&&we)return kt>=ye&&kt<=we;if(ye)return kt>=ye;if(we)return kt<=we}return!0})),B.trim()){const Ze=B.toLowerCase();te=te.filter(at=>String(at.uniqueCode).toLowerCase().includes(Ze)||String(at.party).toLowerCase().includes(Ze)||String(at.gmsoaNo).toLowerCase().includes(Ze)||String(at.customerPoNo).toLowerCase().includes(Ze)||String(at.codeNo).toLowerCase().includes(Ze)||String(at.product).toLowerCase().includes(Ze))}return I&&(te=[...te].sort((Ze,at)=>{const Ke=qe(Ze.soaSrNo),kt=qe(at.soaSrNo);return I==="asc"?Ke-kt:kt-Ke})),te},[l,B,me,M,le,he,ke,Fe,ye,we,n,I]),ut=d.useMemo(()=>{const te=(C-1)*S;return Ie.slice(te,te+S)},[Ie,C,S]),it=te=>te.splittedCode||te.split_id?te.splittedCode||te.split_id:[te.uniqueCode,te.soaSrNo,te.gmsoaNo,te.codeNo,te.assemblyLine].map(Ze=>Ze??"").join("|"),jt=te=>{U(Ze=>{const at=new Set(Ze);return at.has(te)?at.delete(te):at.add(te),at})},mt=()=>{se.size===Ie.length?U(new Set):U(new Set(Ie.map(it)))},xe=d.useMemo(()=>l.filter(te=>se.has(it(te))),[l,se]),[Ge,ot]=d.useState(!1),et=()=>ot(!0),He=()=>{const Ze=`<!doctype html>
    <html>
      <head>
        <meta charset="utf-8" />
        <title>Bin Card</title>
        <style>
          @page { size: 130mm 85mm; margin: 0; }
          html, body { width: 130mm; height: 85mm; margin: 0; padding: 0; font-family: Arial, Helvetica, sans-serif; }
          .item-label, .party-desc { padding-bottom: 2mm; }
          .item-label { line-height: 1.8em; }
          .bin-card { width: 130mm; height: 85mm; padding: 6mm; box-sizing: border-box; page-break-after: always; }
          .item-label-description { padding-top: 50px; }
          .meta-qty { width: 50%; }
          .process-border { border-top:1px solid #000; border-bottom:1px solid #000; padding-top: 1.5mm; padding-bottom: 1.5mm; }
          .detail-logo { padding-bottom: 0.9mm; }
          .description { padding-bottom: 2mm; }
          .content { width: 100%; height: 100%; border: 1.5px solid #000; border-radius: 10px; padding-top: 2mm; padding-bottom: 4mm; padding-left: 6mm; padding-right: 6mm; box-sizing: border-box; display: flex; flex-direction: column; }
          .meta-item { padding-top: 2mm; }
          p { margin: 0; }
          .company-name { font-size: 12px; font-weight: 700; text-align: center; margin: 0 0 1mm; }
          .assembly-title p { border: 1px solid #000; display: inline-block; padding-top: 1mm; padding-bottom: 0.9mm; padding-left: 1mm; padding-right: 1mm; }
          .company-address { font-size: 8px; font-weight: 400; text-align: center; line-height: 1.2; margin: 0 0 1.2mm; }
          .tag-title { font-size: 11px; font-weight: 700; text-align: center; margin: 0 0 1.5mm; }
          .doc-row { display: flex; justify-content: space-between; font-size: 9px; margin-bottom: 0.5mm; }
          .title { text-align: center; font-size: 11px; font-weight: 700; margin-top: 0; margin-bottom: 0.5mm; }
          .title-line { border-bottom: 1px solid #000; margin-bottom: 1.5mm; margin-top: 0.5mm; }
          .meta { font-size: 10px; line-height: 1.25; margin-bottom: 0.8mm; display: flex; align-items: center; justify-content: space-between; }
          .meta div { margin-bottom: 0.5mm; }
          .desc { font-size: 9px; margin-bottom: 0.8mm; }
          .desc p { padding-bottom: 0.6mm; }
          .desc span { display: block; padding-bottom: 0.1mm; }
          .desc .label { display: block; font-size: 10px; margin-bottom: 0.8mm; margin-top: 0.8mm; }
          .desc .text { word-break: break-word; }
          .qty-logo { font-size: 10px; line-height: 1.3; margin-bottom: 0.4mm; margin-top: 0.8mm; }
          .inspect { margin-top: auto; font-size: 10px; }
          .inspect-line { height: 3mm; border-bottom: 1px solid #000; }
          .label { font-weight: 600; }
        </style>
      </head>
      <body>${xe.map(kt=>`
        <div class="bin-card">
          <div class="content">
            <h1 class="company-name">G M Valve Pvt. Ltd.</h1>
            <h6 class="company-address">
              Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
              Village Metoda, Dist. Rajkot-360 021
            </h6>
            <h3 class="tag-title process-border">In Process Material Tag</h3>
            <div class="meta">
              <div class="meta-item">
                <div><span class="label">Date:</span> ${kt.assemblyDate}</div>
                <div>
                  <span class="label">SOA:</span>
                  ${String(kt.gmsoaNo).replace(/^SOA/i,"")}-${kt.soaSrNo}
                </div>
              </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${kt.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
            </div>
            <div class="desc">
              <div clas="description party-desc">
                <span class="label">Party:</span><p>${kt.party}</p>
              </div>
              <div clas="description item-label-description">
                <span class="label item-label">Item:</span><p>${kt.product}</p>
              </div>
            </div>
            <div class="qty-logo">
              <div class="meta meta-logo">
                <div class="meta-qty"><span class="label">QTY:</span> ${kt.totalQty}</div>
                <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${kt.gmLogo}</div>
              </div>
              <div class="detail-items"><span class="label ">Special Note:</span> <span>${kt.specialNotes||""}</span></div>
            </div>
            <div class="inspect">
              <span class="label">Inspected by:</span>
              <div class="inspect-line"></div>
            </div>
          </div>
        </div>`).join("")}</body>
    </html>`,at=document.createElement("iframe");at.style.position="fixed",at.style.right="0",at.style.bottom="0",at.style.width="0",at.style.height="0",at.style.border="0",document.body.appendChild(at);const Ke=at.contentDocument||at.contentWindow?.document;Ke&&(Ke.open(),Ke.write(Ze),Ke.close(),setTimeout(()=>{at.contentWindow?.focus(),at.contentWindow?.print(),setTimeout(()=>document.body.removeChild(at),500)},300))},It=Ie.length>0&&se.size===Ie.length,yt=te=>{const Ze=te.map((vt,Bt)=>({No:Bt+1,"Assembly Line":vt.assemblyLine,"GMSOA No":vt.gmsoaNo,"SOA Sr No":vt.soaSrNo,"Assembly Date":vt.assemblyDate,"Unique Code":vt.uniqueCode,"Splitted Code":vt.splittedCode||"-",Party:vt.party,"Customer PO No":vt.customerPoNo,"Code No":vt.codeNo,Product:vt.product,Qty:vt.totalQty,"Qty Executed":vt.qtyExe,"Qty Pending":vt.qtyPending,"Finished Valve":vt.finishedValve,"GM Logo":vt.gmLogo,"Name Plate":vt.namePlate,"Special Notes":vt.specialNotes||"","Product Special 1":vt.productSpcl1,"Product Special 2":vt.productSpcl2,"Product Special 3":vt.productSpcl3,Inspection:vt.inspection,Painting:vt.painting,OCL:vt.oclNo,"Completed Date":vt.completedDate,Remarks:vt.remarks||""})),at=Gt.json_to_sheet(Ze),Ke=Gt.book_new();Gt.book_append_sheet(Ke,at,"Packaging");const kt=Jr(Ke,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([kt]),"Packaging.xlsx")},St=()=>{const te=se.size>0?Ie.filter(Ze=>se.has(it(Ze))):Ie;yt(te)},ct=te=>{ve(te),Ce(s(te.id)||te.remarks||""),z(!0)},Yt=()=>{ne&&(r(ne.id,fe),z(!1))};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:"svs",currentPage:"Packaging",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:te=>window.location.href=`/${te.toLowerCase()}`}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Packaging"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Completed and packaged orders"})]}),e.jsxs("div",{className:"flex gap-4 w-full justify-end",children:[e.jsx("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center justify-end",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(ee,{onClick:et,variant:"outline",disabled:se.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]})})}),e.jsxs(ee,{disabled:Ie.length===0,onClick:St,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(ee,{variant:"outline",onClick:()=>{try{const te=localStorage.getItem("user"),Ze=te?JSON.parse(te):null,at=Ze?.role?.name||Ze?.role||"";String(at||"").toLowerCase().includes("planning")?t("/planning"):t("/dispatch")}catch{t("/dispatch")}},className:"flex items-center gap-2",children:[e.jsx(om,{className:"h-4 w-4"}),"Back to Dispatch"]})}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:B,setSearchTerm:q,assemblyLineFilter:le,setAssemblyLineFilter:Z,dateFilterMode:Fe,setDateFilterMode:X,dateFrom:ye,setDateFrom:Q,dateTo:we,setDateTo:pe,assemblyLines:$t,onClearFilters:()=>{Z("all"),ce("all"),Ee("all"),X("range"),Q(void 0),pe(void 0)},hasActiveFilters:le!=="all"||he!=="all"||ke!=="all"||!!ye||!!we})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:Nt,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:h&&l.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(It),onClick:mt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${It?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:"sticky left-274 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-24 cursor-pointer select-none",onClick:()=>F(te=>te==="asc"?"desc":te==="desc"?null:"asc"),children:["Sr.No.",I==="asc"&&" ",I==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"OCL Number"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:ut.map(te=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:se.has(it(te)),onCheckedChange:()=>jt(it(te)),"aria-label":`Select row ${te.id}`})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:te.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:te.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:te.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:te.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:te.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:te.party,children:Kz(te.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:te.product,children:te.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:te.specialNotes,children:te.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:te.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:te.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${te.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>ct(te),children:e.jsx(is,{className:`h-4 w-4 ${te.remarks?.trim()?"text-white":"text-blue-600"}`})}),te.remarks?.trim()&&e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 hidden group-hover:block bg-gray-900 text-white text-xs px-3 py-2 rounded-md shadow-lg max-w-[260px] break-words z-[999]",children:te.remarks})]})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:te.oclNo||"-"}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>tt(te)||De(!0),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${te.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${te.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},[te.id,te.splittedCode||te.split_id,te.uniqueCode,te.soaSrNo].join("-")))})]}),Ie.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),e.jsx(os,{page:C,perPage:S,total:Ie.length,lastPage:Math.max(1,Math.ceil(Ie.length/Math.max(S,1))),onChangePage:k,onChangePerPage:_,disabled:h})]}),e.jsx(Ot,{open:ue,onOpenChange:z,children:e.jsxs(Tt,{children:[e.jsx(Rt,{children:e.jsx(Dt,{children:"Remarks"})}),e.jsx(ds,{value:fe,onChange:te=>Ce(te.target.value)}),e.jsx(ee,{onClick:Yt,children:"Save"})]})}),e.jsx(Ot,{open:Le,onOpenChange:De,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",Ve?.uniqueCode]})]}),Ve&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:Ve.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>De(!1),children:"Close"})})]})}),e.jsx(Ot,{open:Ge,onOpenChange:ot,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:xe.map(te=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",te.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(te.gmsoaNo).replace(/^SOA/i,""),"-",te.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",te.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:te.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:te.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",te.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",te.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:te.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},te.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>ot(!1),children:"Cancel"}),e.jsxs(ee,{onClick:He,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})})]})}function Jz(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),pe=En(),U=ja().state?.source||"assembly-a",[ue,z]=d.useState(new Set),[ne,ve]=d.useState(!1),[fe,Ce]=d.useState(null),[Le,De]=d.useState(""),[Ve,tt]=d.useState(""),[Nt,lt]=d.useState(!1),[$t,qe]=d.useState(""),[Ie,ut]=d.useState(""),[it,jt]=d.useState({}),[mt,xe]=d.useState(!1),[Ge,ot]=d.useState(!1),[et,He]=d.useState(null),[It,yt]=d.useState(!1),[St,ct]=d.useState(null),[Yt,te]=d.useState(""),[Ze,at]=d.useState(null),[Ke,kt]=d.useState(!1),[vt,Bt]=d.useState(null);d.useRef(null);const Et=d.useRef(null),Qt=localStorage.getItem("token"),Ct=async()=>{try{h(!0),w(null);const v=nt("testing1"),A=(()=>{try{const rt=localStorage.getItem("user");if(!rt)return"";const Y=JSON.parse(rt),ie=typeof Y.role=="object"?Y.role?.name:Y.role;return String(ie||"").toLowerCase()}catch{return""}})().includes("admin"),R={menu_name:v},D=await xt.post(`${qt}/order-list`,R,{headers:{Authorization:`Bearer ${Qt}`}});if((D?.data?.Resp_code==="true"||D?.data?.Resp_code===!0||D?.data?.Resp_code==="RCS")&&Array.isArray(D.data.data)){const rt=D.data.data.map(Y=>({id:String(Y.id),assemblyLine:Y.assembly_no||"",gmsoaNo:Y.soa_no||"",soaSrNo:Y.soa_sr_no||"",assemblyDate:Y.assembly_date||"",uniqueCode:Y.unique_code||Y.order_no||"",splittedCode:Y.splitted_code||"",party:Y.party_name||Y.party||"",customerPoNo:Y.customer_po_no||"",codeNo:Y.code_no||"",product:Y.product||"",qty:Number(Y.qty||0),totalQty:Number(Y.totalQty||Y.total_qty||Y.qty||0),qtyExe:Number(Y.qty_executed||0),qtyPending:Number(Y.qty_pending||0),finishedValve:Y.finished_valve||"",gmLogo:Y.gm_logo||"",namePlate:Y.name_plate||"",specialNotes:Y.special_notes||Y.special_note||"",productSpcl1:Y.product_spc1||"",productSpcl2:Y.product_spc2||"",productSpcl3:Y.product_spc3||"",inspection:Y.inspection||"",painting:Y.painting||"",remarks:Y.remarks||"",alertStatus:Y.is_urgent===!0||Y.is_urgent==="true"||Y.alert_status===!0||Y.alert_status==="true"||Y.urgent===1||Y.urgent==="1"}));console.log(" Orders fetched:",rt.length,"records"),l(We(rt)),u(null),w(null),Bt(null)}else console.warn(" No valid order data received",D.data),l([]),w(D?.data?.Resp_desc||"Failed to fetch orders")}catch(m){console.error("Error fetching orders:",m),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},bt=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{bt||Ct()},[j,k,bt]);const $e=d.useMemo(()=>Array.from(new Set(a.map(m=>m.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(m=>m.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(m=>m.party))).filter(Boolean).sort(),[a]);const gt=m=>{const v=parseInt(m,10);return isNaN(v)?0:v},Pt=d.useMemo(()=>{let m=a.slice();q&&(m=m.filter(v=>n(String(v.id))||v.alertStatus)),re&&(m=m.filter(v=>typeof v.remarks=="string"&&v.remarks.trim().length>0));{const v=U.replace("assembly-","").toLowerCase();m=m.filter(N=>(N.assemblyLine||"").toLowerCase().includes(v))}if(G!=="all"&&(m=m.filter(v=>v.assemblyLine===G)),Z!=="all"&&(m=m.filter(v=>v.gmsoaNo===Z)),ce!=="all"&&(m=m.filter(v=>v.party===ce)),(X||Q)&&(m=m.filter(v=>{if(!v.assemblyDate||v.assemblyDate==="HOLD")return!1;const A=v.assemblyDate.split(/[\/-]/).map(D=>D.trim()).map(D=>Number(D));if(A.some(D=>isNaN(D)))return!1;let R=null;if(A.length>=3){const[D,Te,rt]=A;R=new Date(rt,Te-1,D)}else if(A.length===2){const[D,Te]=A;R=new Date(Te,D-1,1)}else if(A.length===1){const[D]=A;R=new Date(D,0,1)}else return!1;if(!R||isNaN(R.getTime()))return!1;if(Ee==="year"&&X)return R.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return R.getFullYear()===X.getFullYear()&&R.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return R>=X&&R<=Q;if(X)return R>=X;if(Q)return R<=Q}return!0})),F.trim()){const v=F.toLowerCase();m=m.filter(N=>String(N.uniqueCode).toLowerCase().includes(v)||String(N.party).toLowerCase().includes(v)||String(N.gmsoaNo).toLowerCase().includes(v)||String(N.customerPoNo).toLowerCase().includes(v)||String(N.codeNo).toLowerCase().includes(v)||String(N.product).toLowerCase().includes(v))}return _&&(m=[...m].sort((v,N)=>{const A=gt(v.soaSrNo),R=gt(N.soaSrNo);return _==="asc"?A-R:R-A})),m},[a,F,q,re,G,Z,ce,Ee,X,Q,n,_]),er=d.useMemo(()=>{const m=(j-1)*k;return Pt.slice(m,m+k)},[Pt,j,k]);d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const At=(m="",v=4)=>{const N=m.trim().split(/\s+/);return N.length<=v?m:N.slice(0,v).join(" ")+"..."},Ut=m=>{z(v=>{const N=new Set(v);return N.has(m)?N.delete(m):N.add(m),N})},Vt=()=>{z(m=>m.size===Pt.length?new Set:new Set(Pt.map(lr)))},zt=Pt.length>0&&ue.size===Pt.length,rr=m=>{const v=m.assemblyLine?.toLowerCase();return v==="c"||v==="assembly c"||v==="assembly-c"?["svs","marking1"]:wr("testing1")},nr=d.useMemo(()=>fe?rr(fe):[],[fe]),lr=m=>m.splittedCode||m.split_id||m.uniqueCode||m.id,ir=m=>{const v=rr(m);Ce(m),ve(!0),De(v[0]||""),tt(String(m.qtyPending??m.qty??0)),lt(!1),qe(""),ut(""),jt({})},ar=()=>{const m={},v=Number(fe?.qtyPending??0),N=Number(Ve||0),A=Number(Ie||0);if(Le||(m.quickAssignStep="Please select a workflow step."),(!Ve||N<=0)&&(m.quickAssignQty="Quantity must be greater than 0."),N>v&&(m.quickAssignQty=`Cannot exceed available (${v})`),Nt){$t||(m.splitAssignStep="Choose split step."),(!Ie||A<=0)&&(m.splitAssignQty="Split quantity is required."),Le===$t&&(m.sameEngineer="Split step cannot be the same as main step.");const R=N+A;R!==v&&(m.totalQtyMismatch=`Total quantity (${R}) must equal available (${v}).`)}return jt(m),Object.keys(m).length===0},V=()=>{x(!1),W(null),ve(!1),Ce(null),De(""),tt(""),lt(!1),qe(""),ut(""),jt({})},ae=a.filter(m=>ue.has(m.splittedCode||m.split_id||m.uniqueCode||m.id)),J=()=>xe(!0),K=()=>{const v=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ae.map(R=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${R.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(R.gmsoaNo).replace(/^SOA/i,"")}-${R.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${R.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${R.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${R.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${R.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${R.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${R.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,N=document.createElement("iframe");N.style.position="fixed",N.style.right="0",N.style.bottom="0",N.style.width="0",N.style.height="0",N.style.border="0",document.body.appendChild(N);const A=N.contentDocument||N.contentWindow?.document;A&&(A.open(),A.write(v),A.close(),setTimeout(()=>{N.contentWindow?.focus(),N.contentWindow?.print(),setTimeout(()=>document.body.removeChild(N),500)},300))},de=m=>{He(m),ot(!0)},oe=m=>m.splittedCode||m.split_id?m.splittedCode||m.split_id:[m.uniqueCode,m.soaSrNo,m.gmsoaNo,m.codeNo,m.assemblyLine].map(v=>v??"").join("|"),_e=d.useMemo(()=>{const m=Pt.filter(v=>ue.has(oe(v)));return{count:m.length,qty:m.reduce((v,N)=>v+(N.totalQty||N.qty||0),0),qtyExe:m.reduce((v,N)=>v+(N.qtyExe||0),0),qtyPending:m.reduce((v,N)=>v+(N.qtyPending||0),0)}},[ue,Pt]),Be=()=>{const m=q===!0,v=re===!0,N=ue.size>0;if(!m&&!v&&!N)return;const A=N?Pt.filter(R=>ue.has(oe(R))):Pt;if(!A.length){alert("No data available to export");return}Ne(A)},Ae=()=>{const m=c&&c.length>0?c:a;if(!m||m.length===0){alert("No data available to export");return}Ne(m)},Ne=m=>{const v=m.map((D,Te)=>({No:Te+1,"Assembly Line":D.assemblyLine,"GMSOA No":D.gmsoaNo,"SOA Sr No":D.soaSrNo,"Assembly Date":D.assemblyDate,"Unique Code":D.uniqueCode,"Splitted Code":D.splittedCode||"-",Party:D.party,"Customer PO No":D.customerPoNo,"Code No":D.codeNo,Product:D.product,"PO Qty":D.poQty,Qty:D.qty,"Qty Executed":D.qtyExe,"Qty Pending":D.qtyPending,"Finished Valve":D.finishedValve,"GM Logo":D.gmLogo,"Name Plate":D.namePlate,"Special Notes":D.specialNotes||"","Product Special 1":D.productSpcl1,"Product Special 2":D.productSpcl2,"Product Special 3":D.productSpcl3,Inspection:D.inspection,Painting:D.painting,Remarks:D.remarks||""})),N=Gt.json_to_sheet(v),A=Gt.book_new();Gt.book_append_sheet(A,N,"Orders");const R=Jr(A,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([R],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},je=m=>{ct(m),te(m.remarks||""),yt(!0)},Me=async()=>{if(!St)return;const m=new FormData;m.append("orderId",String(St.id)),m.append("remarks",Yt);try{const v=await xt.post(`${qt}/add-remarks`,m,{headers:{Authorization:`Bearer ${Qt}`}});if(console.log("Add Remarks Response:",v.data),v.data?.Resp_code==="true"||v.data?.Resp_code===!0){l(A=>A.map(R=>R.id===St.id?{...R,remarks:Yt}:R));try{t(St.id,Yt)}catch{}yt(!1),ct(null),te("")}else console.warn("Backend rejected remarks:",v.data)}catch(v){console.error("Error saving remarks:",v)}},We=m=>[...m].sort((v,N)=>{const A=v.alertStatus?1:0,R=N.alertStatus?1:0;return A!==R?R-A:(v.originalIndex??0)-(N.originalIndex??0)}),[ge,W]=d.useState(null),[T,x]=d.useState(!1),P=async()=>{if(!T&&fe&&ar()){x(!0),W({type:"info",message:"Assigning order, please wait..."});try{const m=localStorage.getItem("token");if(!m){W({type:"error",message:"Token missing. Please log in again."});return}const v="testing1",N=nt(v),A=Number(Ve||0),R=Number(Ie||0),D=wr(v)[0]||"",rt=nt(Le||D),Y=new FormData;Y.append("orderId",String(fe.id)),Y.append("totalQty",String(fe.totalQty??fe.qty??0)),Y.append("executedQty",String(A)),Y.append("currentSteps",N),Y.append("nextSteps",rt),Y.append("split_id",String(fe.split_id||"")),console.log(" MAIN PAYLOAD:",Object.fromEntries(Y.entries()));const ie=await xt.post(`${qt}/assign-order`,Y,{headers:{Authorization:`Bearer ${m}`}});if(!(ie.data?.Resp_code===!0||ie.data?.Resp_code==="true"||ie.data?.status===!0)){W({type:"error",message:ie.data?.Resp_desc||"Main assignment failed."});return}let Se=` Assigned ${A}  ${rt}`;if(Nt&&R>0){const Ue=new FormData;Ue.append("orderId",String(fe.id)),Ue.append("totalQty",String(fe.totalQty??fe.qty??0)),Ue.append("executedQty",String(R)),Ue.append("currentSteps",N),Ue.append("nextSteps",rt),Ue.append("split_id",String(fe.split_id||"")),console.log(" SPLIT PAYLOAD:",Object.fromEntries(Ue.entries()));const mr=await xt.post(`${qt}/assign-order`,Ue,{headers:{Authorization:`Bearer ${m}`}});mr.data?.Resp_code===!0||mr.data?.Resp_code==="true"||mr.data?.status===!0?Se+=`
 Split ${R}  ${rt}`:W({type:"error",message:"Main assigned but split failed: "+(mr.data?.Resp_desc||"Unknown error")})}W({type:"success",message:Se});const Je=Ue=>Ue.splittedCode||Ue.split_id?Ue.splittedCode||Ue.split_id:[Ue.uniqueCode,Ue.soaSrNo,Ue.gmsoaNo,Ue.codeNo,Ue.assemblyLine].map(mr=>mr??"").join("|"),ft=Je(fe);l(Ue=>Ue.filter(mr=>Je(mr)!==ft)),z(Ue=>{const mr=new Set(Ue);return mr.delete(ft),mr}),setTimeout(()=>{ve(!1),W(null)},1e3)}catch(m){console.error(" Error assigning order:",m),W({type:"error",message:m?.response?.data?.Resp_desc||m?.response?.data?.message||"Server error while assigning."})}finally{x(!1)}}},g=()=>{le("all"),he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:U,currentPage:`Testing Assembly (${U.replace("assembly-","Line ").toUpperCase()})`,onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:m=>{window.location.href=`/${m.toLowerCase()}`},onUploadSuccess:()=>Ct()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Testing 1"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"}),e.jsx("div",{className:"mt-4",children:e.jsxs(ee,{variant:"outline",className:"flex items-center gap-2",onClick:()=>{try{const m=localStorage.getItem("user"),v=m?JSON.parse(m):null,N=v?.role?.name||v?.role||"",A=String(N||"").toLowerCase();A.includes("planning")||A.includes("admin")?pe("/planning"):pe(`/${U}`)}catch{pe(`/${U}`)}},title:`Back to ${U.replace("-"," ").toUpperCase()}`,children:[e.jsx(om,{className:"h-4 w-4"}),"Back to ",U.replace(/-/g," ").replace(/\b\w/g,m=>m.toUpperCase())]})})]}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center flex-inner-wrapper justify-end",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:J,variant:"outline",disabled:ue.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{onClick:Be,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:Ae,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:$e,onClearFilters:g,disableAssemblyFilter:!0,hasActiveFilters:G!=="all"||Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:Et,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(zt),onClick:Vt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${zt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(m=>m==="asc"?"desc":m==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:er.map(m=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:ue.has(lr(m)),onCheckedChange:()=>Ut(lr(m))})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:m.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:m.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:m.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:m.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:m.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:m.party,children:At(m.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:m.product,children:m.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:m.specialNotes,children:m.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:m.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:m.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${m.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>je(m),children:e.jsx(is,{className:`h-4 w-4 ${m.remarks?.trim()?"text-white":"text-blue-600"}`})}),m.remarks?.trim()&&e.jsx("div",{className:`\r
                                  absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                  hidden group-hover:block\r
                                  bg-gray-900 text-white text-xs\r
                                  px-3 py-2 rounded-md shadow-lg\r
                                  max-w-[260px] break-words z-[999]\r
                                `,children:m.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>de(m),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{disabled:!0,size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ir(m),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${m.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${m.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},m.splittedCode||m.split_id||m.uniqueCode||m.id))})]}),Pt.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),_e.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:_e.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:_e.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:_e.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:_e.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:Pt.length,lastPage:Math.max(1,Math.ceil(Pt.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:ne,onOpenChange:ve,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",fe?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:Le,onValueChange:De,children:[e.jsx(ss,{id:"assignStep",children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:nr.map(m=>e.jsx(Pr,{value:m,children:nt(m)},m))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Ve,onChange:m=>tt(m.target.value),max:fe?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:fe?.qtyPending})]})]})}),ge&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${ge.type==="success"?"bg-green-50 text-green-700 border border-green-200":ge.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:ge.message.split(`
`).map((m,v)=>e.jsx("div",{children:m},v))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:V,disabled:T,children:"Cancel"}),e.jsx(ee,{onClick:P,disabled:T,className:"bg-black hover:bg-gray-800 text-white",children:T?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:mt,onOpenChange:xe,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ae.map(m=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",m.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(m.gmsoaNo).replace(/^SOA/i,""),"-",m.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",m.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:m.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:m.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",m.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",m.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:m.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},m.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>xe(!1),children:"Cancel"}),e.jsxs(ee,{onClick:K,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:Ge,onOpenChange:ot,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",et?.uniqueCode]})]}),et&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>ot(!1),children:"Close"})})]})}),e.jsx(Ot,{open:It,onOpenChange:yt,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:St?`Order: ${St.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:Yt,onChange:m=>te(m.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>yt(!1),children:"Cancel"}),e.jsx(ee,{onClick:Me,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function Zz(){const{updateRemark:t,toggleAlertStatus:r,getRemark:s,getAlertStatus:n}=gs(),[a,l]=d.useState([]),[c,u]=d.useState(null),[f,h]=d.useState(!1),[y,w]=d.useState(null),[j,C]=d.useState(1),[k,S]=d.useState(100),[_,I]=d.useState(null),[F,B]=d.useState(""),[q,me]=d.useState(!1),[re,M]=d.useState(!1),[G,le]=d.useState("all"),[Z,he]=d.useState("all"),[ce,ke]=d.useState("all"),[Ee,Fe]=d.useState("range"),[X,ye]=d.useState(void 0),[Q,we]=d.useState(void 0),pe=En(),U=ja().state?.source||"assembly-a",[ue,z]=d.useState(new Set),[ne,ve]=d.useState(!1),[fe,Ce]=d.useState(null),[Le,De]=d.useState(""),[Ve,tt]=d.useState(""),[Nt,lt]=d.useState(!1),[$t,qe]=d.useState(""),[Ie,ut]=d.useState(""),[it,jt]=d.useState({}),[mt,xe]=d.useState(!1),[Ge,ot]=d.useState(!1),[et,He]=d.useState(null),[It,yt]=d.useState(!1),[St,ct]=d.useState(null),[Yt,te]=d.useState(""),[Ze,at]=d.useState(null),[Ke,kt]=d.useState(!1),[vt,Bt]=d.useState(null);d.useRef(null);const Et=d.useRef(null),Qt=localStorage.getItem("token"),Ct=async()=>{try{h(!0),w(null);const v=nt("testing2"),A=(()=>{try{const rt=localStorage.getItem("user");if(!rt)return"";const Y=JSON.parse(rt),ie=typeof Y.role=="object"?Y.role?.name:Y.role;return String(ie||"").toLowerCase()}catch{return""}})().includes("admin"),R={menu_name:v},D=await xt.post(`${qt}/order-list`,R,{headers:{Authorization:`Bearer ${Qt}`}});if((D?.data?.Resp_code==="true"||D?.data?.Resp_code===!0||D?.data?.Resp_code==="RCS")&&Array.isArray(D.data.data)){const rt=D.data.data.map(Y=>({id:String(Y.id),assemblyLine:Y.assembly_no||"",gmsoaNo:Y.soa_no||"",soaSrNo:Y.soa_sr_no||"",assemblyDate:Y.assembly_date||"",uniqueCode:Y.unique_code||Y.order_no||"",splittedCode:Y.splitted_code||"",party:Y.party_name||Y.party||"",customerPoNo:Y.customer_po_no||"",codeNo:Y.code_no||"",product:Y.product||"",qty:Number(Y.qty||0),totalQty:Number(Y.totalQty||Y.total_qty||Y.qty||0),qtyExe:Number(Y.qty_executed||0),qtyPending:Number(Y.qty_pending||0),finishedValve:Y.finished_valve||"",gmLogo:Y.gm_logo||"",namePlate:Y.name_plate||"",specialNotes:Y.special_notes||Y.special_note||"",productSpcl1:Y.product_spc1||"",productSpcl2:Y.product_spc2||"",productSpcl3:Y.product_spc3||"",inspection:Y.inspection||"",painting:Y.painting||"",remarks:Y.remarks||"",alertStatus:Y.is_urgent===!0||Y.is_urgent==="true"||Y.alert_status===!0||Y.alert_status==="true"||Y.urgent===1||Y.urgent==="1"}));console.log(" Orders fetched:",rt.length,"records"),l(We(rt)),u(null),w(null),Bt(null)}else console.warn(" No valid order data received",D.data),l([]),w(D?.data?.Resp_desc||"Failed to fetch orders")}catch(m){console.error("Error fetching orders:",m),w("Error fetching order list. Please check your token or server.")}finally{h(!1)}},bt=d.useMemo(()=>F.trim().length>0||(G!=="all"||Z!=="all"||ce!=="all")||(!!X||!!Q)||q||re,[F,G,Z,ce,X,Q,q,re]);d.useEffect(()=>{bt||Ct()},[j,k,bt]);const $e=d.useMemo(()=>Array.from(new Set(a.map(m=>m.assemblyLine))).filter(Boolean).sort(),[a]);d.useMemo(()=>Array.from(new Set(a.map(m=>m.gmsoaNo))).filter(Boolean).sort(),[a]),d.useMemo(()=>Array.from(new Set(a.map(m=>m.party))).filter(Boolean).sort(),[a]);const gt=m=>{const v=parseInt(m,10);return isNaN(v)?0:v},Pt=d.useMemo(()=>{let m=a.slice();q&&(m=m.filter(v=>n(String(v.id))||v.alertStatus)),re&&(m=m.filter(v=>typeof v.remarks=="string"&&v.remarks.trim().length>0));{const v=U.replace("assembly-","").toLowerCase();m=m.filter(N=>(N.assemblyLine||"").toLowerCase().includes(v))}if(G!=="all"&&(m=m.filter(v=>v.assemblyLine===G)),Z!=="all"&&(m=m.filter(v=>v.gmsoaNo===Z)),ce!=="all"&&(m=m.filter(v=>v.party===ce)),(X||Q)&&(m=m.filter(v=>{if(!v.assemblyDate||v.assemblyDate==="HOLD")return!1;const A=v.assemblyDate.split(/[\/-]/).map(D=>D.trim()).map(D=>Number(D));if(A.some(D=>isNaN(D)))return!1;let R=null;if(A.length>=3){const[D,Te,rt]=A;R=new Date(rt,Te-1,D)}else if(A.length===2){const[D,Te]=A;R=new Date(Te,D-1,1)}else if(A.length===1){const[D]=A;R=new Date(D,0,1)}else return!1;if(!R||isNaN(R.getTime()))return!1;if(Ee==="year"&&X)return R.getFullYear()===X.getFullYear();if(Ee==="month"&&X)return R.getFullYear()===X.getFullYear()&&R.getMonth()===X.getMonth();if(Ee==="range"){if(X&&Q)return R>=X&&R<=Q;if(X)return R>=X;if(Q)return R<=Q}return!0})),F.trim()){const v=F.toLowerCase();m=m.filter(N=>String(N.uniqueCode).toLowerCase().includes(v)||String(N.party).toLowerCase().includes(v)||String(N.gmsoaNo).toLowerCase().includes(v)||String(N.customerPoNo).toLowerCase().includes(v)||String(N.codeNo).toLowerCase().includes(v)||String(N.product).toLowerCase().includes(v))}return _&&(m=[...m].sort((v,N)=>{const A=gt(v.soaSrNo),R=gt(N.soaSrNo);return _==="asc"?A-R:R-A})),m},[a,F,q,re,G,Z,ce,Ee,X,Q,n,_]),er=d.useMemo(()=>{const m=(j-1)*k;return Pt.slice(m,m+k)},[Pt,j,k]);d.useEffect(()=>{C(1)},[F,G,Z,ce,X,Q,q,re]);const At=(m="",v=4)=>{const N=m.trim().split(/\s+/);return N.length<=v?m:N.slice(0,v).join(" ")+"..."},Ut=m=>{z(v=>{const N=new Set(v);return N.has(m)?N.delete(m):N.add(m),N})},Vt=()=>{z(m=>m.size===Pt.length?new Set:new Set(Pt.map(lr)))},zt=Pt.length>0&&ue.size===Pt.length,rr=m=>{const v=m.assemblyLine?.toLowerCase();return v==="c"||v==="assembly c"||v==="assembly-c"?["svs","marking1"]:wr("testing2")},nr=d.useMemo(()=>fe?rr(fe):[],[fe]),lr=m=>m.splittedCode||m.split_id||m.uniqueCode||m.id,ir=m=>{const v=rr(m);Ce(m),ve(!0),De(v[0]||""),tt(String(m.qtyPending??m.qty??0)),lt(!1),qe(""),ut(""),jt({})},ar=()=>{const m={},v=Number(fe?.qtyPending??0),N=Number(Ve||0),A=Number(Ie||0);if(Le||(m.quickAssignStep="Please select a workflow step."),(!Ve||N<=0)&&(m.quickAssignQty="Quantity must be greater than 0."),N>v&&(m.quickAssignQty=`Cannot exceed available (${v})`),Nt){$t||(m.splitAssignStep="Choose split step."),(!Ie||A<=0)&&(m.splitAssignQty="Split quantity is required."),Le===$t&&(m.sameEngineer="Split step cannot be the same as main step.");const R=N+A;R!==v&&(m.totalQtyMismatch=`Total quantity (${R}) must equal available (${v}).`)}return jt(m),Object.keys(m).length===0},V=()=>{x(!1),W(null),ve(!1),Ce(null),De(""),tt(""),lt(!1),qe(""),ut(""),jt({})},ae=a.filter(m=>ue.has(m.splittedCode||m.split_id||m.uniqueCode||m.id)),J=()=>xe(!0),K=()=>{const v=`<!doctype html>
  <html>
    <head>
      <meta charset="utf-8" />
      <title>Bin Card</title>

      <style>
        @page {
          size: 130mm 85mm;
          margin: 0;
        }

        html, body {
          width: 130mm;
          height: 85mm;
          margin: 0;
          padding: 0;
          font-family: Arial, Helvetica, sans-serif;
        }

        .item-label,
        .party-desc {
        padding-bottom: 2mm;}

        .item-label {
        line-height: 1.8em;}

        .bin-card {
          width: 130mm;
          height: 85mm;
          padding: 6mm;
          box-sizing: border-box;
          page-break-after: always;
        }

      .item-label-description {
      padding-top: 50px;}

        .meta-qty {
        width: 50%;}

        .process-border {
        border-top:1px solid #000;
        border-bottom:1px solid #000;
        padding-top: 1.5mm;
        padding-bottom: 1.5mm;
        }

        .detail-logo {
          padding-bottom: 0.9mm;
        }

        .description {
          padding-bottom: 2mm;
        }

        .content {
          width: 100%;
          height: 100%;
          border: 1.5px solid #000;
          border-radius: 10px;
          padding-top: 2mm;
          padding-bottom: 4mm;
             padding-left: 6mm;
                padding-right: 6mm;
          box-sizing: border-box;
          display: flex;
          flex-direction: column;
        }

        .meta-item {
          padding-top: 2mm;
        }

        /* RESET DEFAULT P TAG SPACE */
        p {
          margin: 0;
        }

        /* HEADER */
        .company-name {
          font-size: 12px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1mm;
          
        }

        .assembly-title p {
        border: 1px solid #000;
          display: inline-block;
          padding-top: 1mm;
          padding-bottom: 0.9mm;
          padding-left: 1mm;
          padding-right: 1mm;
        }

        .company-address {
          font-size: 8px;
          font-weight: 400;
          text-align: center;
          line-height: 1.2;
          margin: 0 0 1.2mm;
        }

        .tag-title {
          font-size: 11px;
          font-weight: 700;
          text-align: center;
          margin: 0 0 1.5mm;
        }

        .doc-row {
          display: flex;
          justify-content: space-between;
          font-size: 9px;
          margin-bottom: 0.5mm; /*  reduced */
        }

        /* ASSEMBLY LINE */
        .title {
          text-align: center;
          font-size: 11px;
          font-weight: 700;
          margin-top: 0;       /*  no top gap */
          margin-bottom: 0.5mm;
          //  border: 1px solid #000;
          // display: inline-block;
        }

        .title-line {
          border-bottom: 1px solid #000;
          margin-bottom: 1.5mm;
          margin-top: 0.5mm;
        }

        /* META */
        .meta {
          font-size: 10px;
          line-height: 1.25;
          margin-bottom: 0.8mm;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .meta div {
          margin-bottom: 0.5mm;
        }

        /* ITEM */
        .desc {
          font-size: 9px;
          margin-bottom: 0.8mm;
        }

        .desc p {
        padding-bottom: 0.6mm;}

        .desc span {
          display: block;
          padding-bottom: 0.1mm;
        }

        .desc .label {
          display: block;
          font-size: 10px;
          margin-bottom: 0.8mm;
          margin-top: 0.8mm;
        }

        .desc .text {
          word-break: break-word;
          
        }

        /* QTY */
        .qty-logo {
          font-size: 10px;
          line-height: 1.3;
          margin-bottom: 0.4mm;
           margin-top: 0.8mm;
        }

        /* INSPECTION */
        .inspect {
          margin-top: auto;
          font-size: 10px;
        }

        .inspect-line {
          height: 3mm;
          border-bottom: 1px solid #000;
        }

        .label {
          font-weight: 600;
        }
      </style>
    </head>

    <body>${ae.map(R=>`
      <div class="bin-card">
        <div class="content">

          <h1 class="company-name">G M Valve Pvt. Ltd.</h1>

          <h6 class="company-address">
            Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika,
            Village Metoda, Dist. Rajkot-360 021
          </h6>

          <h3 class="tag-title process-border">In Process Material Tag</h3>
          <div class="meta">
            <div class="meta-item">
              <div><span class="label">Date:</span> ${R.assemblyDate}</div>
              <div>
                <span class="label">SOA:</span>
                ${String(R.gmsoaNo).replace(/^SOA/i,"")}-${R.soaSrNo}
              </div>

            </div>
              <div class="title assembly-title">
                <p>Assembly Line: ${R.assemblyLine}</p>
              </div>
              <div class="meta-item">
                <p>GMV-L4-F-PRD 01 A</p>
                <p>(02/10.09.2020)</p>
              </div>
         </div>

           

          <div class="desc">
            <div clas="description party-desc">
              <span class="label">Party:</span><p>${R.party}</p>
            </div>
            <div clas="description item-label-description">
              <span class="label item-label">Item:</span><p>${R.product}</p>
            </div>
          </div>

          <div class="qty-logo">
           <div class="meta meta-logo">
            <div class="meta-qty"><span class="label">QTY:</span> ${R.qty}</div>
            <div class="detail-items meta-qty detail-logo"><span class="label ">Logo:</span> ${R.gmLogo}</div>
             </div>
            <div class="detail-items"><span class="label ">Special Note:</span> <span>${R.specialNotes||""}</span></div>
            </div>

          <div class="inspect">
            <span class="label">Inspected by:</span>
            <div class="inspect-line"></div>
          </div>

        </div>
      </div>`).join("")}</body>
  </html>`,N=document.createElement("iframe");N.style.position="fixed",N.style.right="0",N.style.bottom="0",N.style.width="0",N.style.height="0",N.style.border="0",document.body.appendChild(N);const A=N.contentDocument||N.contentWindow?.document;A&&(A.open(),A.write(v),A.close(),setTimeout(()=>{N.contentWindow?.focus(),N.contentWindow?.print(),setTimeout(()=>document.body.removeChild(N),500)},300))},de=m=>{He(m),ot(!0)},oe=m=>m.splittedCode||m.split_id?m.splittedCode||m.split_id:[m.uniqueCode,m.soaSrNo,m.gmsoaNo,m.codeNo,m.assemblyLine].map(v=>v??"").join("|"),_e=d.useMemo(()=>{const m=Pt.filter(v=>ue.has(oe(v)));return{count:m.length,qty:m.reduce((v,N)=>v+(N.totalQty||N.qty||0),0),qtyExe:m.reduce((v,N)=>v+(N.qtyExe||0),0),qtyPending:m.reduce((v,N)=>v+(N.qtyPending||0),0)}},[ue,Pt]),Be=()=>{const m=q===!0,v=re===!0,N=ue.size>0;if(!m&&!v&&!N)return;const A=N?Pt.filter(R=>ue.has(oe(R))):Pt;if(!A.length){alert("No data available to export");return}Ne(A)},Ae=()=>{const m=c&&c.length>0?c:a;if(!m||m.length===0){alert("No data available to export");return}Ne(m)},Ne=m=>{const v=m.map((D,Te)=>({No:Te+1,"Assembly Line":D.assemblyLine,"GMSOA No":D.gmsoaNo,"SOA Sr No":D.soaSrNo,"Assembly Date":D.assemblyDate,"Unique Code":D.uniqueCode,"Splitted Code":D.splittedCode||"-",Party:D.party,"Customer PO No":D.customerPoNo,"Code No":D.codeNo,Product:D.product,"PO Qty":D.poQty,Qty:D.qty,"Qty Executed":D.qtyExe,"Qty Pending":D.qtyPending,"Finished Valve":D.finishedValve,"GM Logo":D.gmLogo,"Name Plate":D.namePlate,"Special Notes":D.specialNotes||"","Product Special 1":D.productSpcl1,"Product Special 2":D.productSpcl2,"Product Special 3":D.productSpcl3,Inspection:D.inspection,Painting:D.painting,Remarks:D.remarks||""})),N=Gt.json_to_sheet(v),A=Gt.book_new();Gt.book_append_sheet(A,N,"Orders");const R=Jr(A,{bookType:"xlsx",type:"array"});ms.saveAs(new Blob([R],{type:"application/octet-stream"}),`Orders_${new Date().toISOString().slice(0,10)}.xlsx`)},je=m=>{ct(m),te(m.remarks||""),yt(!0)},Me=async()=>{if(!St)return;const m=new FormData;m.append("orderId",String(St.id)),m.append("remarks",Yt);try{const v=await xt.post(`${qt}/add-remarks`,m,{headers:{Authorization:`Bearer ${Qt}`}});if(console.log("Add Remarks Response:",v.data),v.data?.Resp_code==="true"||v.data?.Resp_code===!0){l(A=>A.map(R=>R.id===St.id?{...R,remarks:Yt}:R));try{t(St.id,Yt)}catch{}yt(!1),ct(null),te("")}else console.warn("Backend rejected remarks:",v.data)}catch(v){console.error("Error saving remarks:",v)}},We=m=>[...m].sort((v,N)=>{const A=v.alertStatus?1:0,R=N.alertStatus?1:0;return A!==R?R-A:(v.originalIndex??0)-(N.originalIndex??0)}),[ge,W]=d.useState(null),[T,x]=d.useState(!1),P=async()=>{if(!T&&fe&&ar()){x(!0),W({type:"info",message:"Assigning order, please wait..."});try{const m=localStorage.getItem("token");if(!m){W({type:"error",message:"Token missing. Please log in again."});return}const v="testing2",N=nt(v),A=Number(Ve||0),R=Number(Ie||0),D=wr(v)[0]||"",rt=nt(Le||D),Y=new FormData;Y.append("orderId",String(fe.id)),Y.append("totalQty",String(fe.totalQty??fe.qty??0)),Y.append("executedQty",String(A)),Y.append("currentSteps",N),Y.append("nextSteps",rt),Y.append("split_id",String(fe.split_id||"")),console.log(" MAIN PAYLOAD:",Object.fromEntries(Y.entries()));const ie=await xt.post(`${qt}/assign-order`,Y,{headers:{Authorization:`Bearer ${m}`}});if(!(ie.data?.Resp_code===!0||ie.data?.Resp_code==="true"||ie.data?.status===!0)){W({type:"error",message:ie.data?.Resp_desc||"Main assignment failed."});return}let Se=` Assigned ${A}  ${rt}`;if(Nt&&R>0){const Ue=new FormData;Ue.append("orderId",String(fe.id)),Ue.append("totalQty",String(fe.totalQty??fe.qty??0)),Ue.append("executedQty",String(R)),Ue.append("currentSteps",N),Ue.append("nextSteps",rt),Ue.append("split_id",String(fe.split_id||"")),console.log(" SPLIT PAYLOAD:",Object.fromEntries(Ue.entries()));const mr=await xt.post(`${qt}/assign-order`,Ue,{headers:{Authorization:`Bearer ${m}`}});mr.data?.Resp_code===!0||mr.data?.Resp_code==="true"||mr.data?.status===!0?Se+=`
 Split ${R}  ${rt}`:W({type:"error",message:"Main assigned but split failed: "+(mr.data?.Resp_desc||"Unknown error")})}W({type:"success",message:Se});const Je=Ue=>Ue.splittedCode||Ue.split_id?Ue.splittedCode||Ue.split_id:[Ue.uniqueCode,Ue.soaSrNo,Ue.gmsoaNo,Ue.codeNo,Ue.assemblyLine].map(mr=>mr??"").join("|"),ft=Je(fe);l(Ue=>Ue.filter(mr=>Je(mr)!==ft)),z(Ue=>{const mr=new Set(Ue);return mr.delete(ft),mr}),setTimeout(()=>{ve(!1),W(null)},1e3)}catch(m){console.error(" Error assigning order:",m),W({type:"error",message:m?.response?.data?.Resp_desc||m?.response?.data?.message||"Server error while assigning."})}finally{x(!1)}}},g=()=>{le("all"),he("all"),ke("all"),Fe("range"),ye(void 0),we(void 0)};return e.jsxs(e.Fragment,{children:[e.jsx(ls,{role:U,currentPage:"Testing 2",onLogout:()=>{localStorage.removeItem("token"),window.location.href="/login"},onNavigate:m=>{window.location.href=`/${m.toLowerCase()}`},onUploadSuccess:()=>Ct()}),e.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8 animate-fade-in bg-white min-h-screen",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-wrap flex-wrap flex-col lg:flex-row lg:justify-between lg:items-start gap-6",children:[e.jsxs("div",{className:"flex-row-main",children:[e.jsx("h1",{className:"text-gray-900 mb-2 text-2xl font-semibold",children:"Testing 2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage assembly line orders and manufacturing workflow"}),e.jsx("div",{className:"mt-4",children:e.jsxs(ee,{variant:"outline",className:"flex items-center gap-2",onClick:()=>{try{const m=localStorage.getItem("user"),v=m?JSON.parse(m):null,N=v?.role?.name||v?.role||"",A=String(N||"").toLowerCase();A.includes("planning")||A.includes("admin")?pe("/planning"):pe(`/${U}`)}catch{pe(`/${U}`)}},title:`Back to ${U.replace("-"," ").toUpperCase()}`,children:[e.jsx(om,{className:"h-4 w-4"}),"Back to ",U.replace(/-/g," ").replace(/\b\w/g,m=>m.toUpperCase())]})})]}),e.jsx("div",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 lg:items-center flex-inner-wrapper justify-end",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-inner-wrapper",children:[e.jsxs(ee,{onClick:J,variant:"outline",disabled:ue.size===0,className:"flex items-center gap-2 ctm-btn-disable",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print Bin Card"]}),e.jsxs(ee,{onClick:()=>me(!q),className:`btn-urgent flex items-center gap-2 ${q?"bg-red-600 text-white":"bg-red-50 text-red-700"}`,children:[e.jsx(gr,{className:"h-4 w-4"}),q?"Show All Projects":"Urgent Projects Only"]}),e.jsx(ee,{onClick:()=>M(!re),className:"btn-urgent flex items-center gap-2 bg-btn-gradient text-white shadow-md transition-all btn-remark",children:re?"Show All Projects":"Remarks only"})]}),e.jsxs(ee,{onClick:Be,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export Data"]}),e.jsxs(ee,{onClick:Ae,className:"bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(hr,{className:"h-4 w-4 mr-2"}),"Export all Data"]})]})})]}),e.jsx("div",{className:"mt-4",children:e.jsx(us,{currentStage:"default",searchTerm:F,setSearchTerm:B,assemblyLineFilter:G,setAssemblyLineFilter:le,dateFilterMode:Ee,setDateFilterMode:Fe,dateFrom:X,setDateFrom:ye,dateTo:Q,setDateTo:we,assemblyLines:$e,onClearFilters:g,disableAssemblyFilter:!0,hasActiveFilters:G!=="all"||Z!=="all"||ce!=="all"||!!X||!!Q})})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:e.jsx("div",{ref:Et,className:"relative overflow-x-auto max-w-full",style:{maxHeight:"80vh",overflowY:"auto",scrollbarGutter:"stable"},children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:f&&a.length===0?e.jsx("div",{className:"p-10 text-center text-gray-600 ctm-load",children:"Loading..."}):e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full border-collapse",children:[e.jsx("thead",{className:"table-head sticky top-16 z-30 bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 z-20 bg-white px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx("button",{type:"button",role:"checkbox","aria-checked":String(zt),onClick:Vt,className:"peer rounded border p-0.5","aria-label":"Select all rows",children:e.jsx("div",{className:`w-4 h-4 ${zt?"bg-blue-600":"bg-white border"}`})})}),e.jsx("th",{className:"sticky left-10 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Assembly Line"}),e.jsx("th",{className:"sticky left-164 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-28",children:"SOA NO."}),e.jsxs("th",{className:`sticky left-274 z-20 bg-white px-3 py-2 text-center\r
             text-xs font-medium text-gray-500 uppercase tracking-wider\r
             border-r border-gray-200 min-w-24 cursor-pointer select-none`,onClick:()=>I(m=>m==="asc"?"desc":m==="desc"?null:"asc"),children:["Sr.No.",_==="asc"&&" ",_==="desc"&&" "]}),e.jsx("th",{className:"sticky left-364 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:"Assembly Date"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 min-w-36",children:"Unique Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Splitted Code"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-20",children:"Party"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Customer PO No."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Code No"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200 w-80",children:"Product"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Exe."}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"Qty Pending"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"finished valve"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"GM LOGO"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"NAME PLATE"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"SPECIAL NOTES"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL1"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PRODUCT SPCL2"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",style:{width:"400px"},children:"PRODUCT SPCL3"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"INSPECTION"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"PAINTING"}),e.jsx("th",{className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-r border-gray-200",children:"remarks"}),e.jsx("th",{className:"sticky right-0 z-20 bg-white px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-200",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:er.map(m=>e.jsxs("tr",{className:"group hover:bg-gray-50",children:[e.jsx("td",{className:"sticky left-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 text-center border-r border-gray-200 w-12",children:e.jsx(Ur,{checked:ue.has(lr(m)),onCheckedChange:()=>Ut(lr(m))})}),e.jsx("td",{className:"sticky left-10 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center border-r border-gray-200 w-20",children:e.jsx(Ir,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:m.assemblyLine})}),e.jsx("td",{className:"sticky left-164 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-28",children:m.gmsoaNo}),e.jsx("td",{className:"sticky left-274 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r border-gray-200 min-w-24",children:m.soaSrNo}),e.jsx("td",{className:"sticky left-364 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-r-2 border-gray-300 min-w-32 shadow-[2px_0_5px_-2px_rgba(0,0,0,0.1)]",children:m.assemblyDate}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 font-mono min-w-36",children:m.uniqueCode}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.splittedCode}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 max-w-xs",children:e.jsx("div",{style:{width:"120px"},title:m.party,children:At(m.party,4)})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.customerPoNo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.codeNo}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900 w-80",children:e.jsx("div",{className:"line-clamp-2",style:{width:"300px"},title:m.product,children:m.product})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.totalQty}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.qtyExe}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.qtyPending}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.finishedValve}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.gmLogo}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.namePlate}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsx("div",{className:"line-clamp-2",style:{width:"200px"},title:m.specialNotes,children:m.specialNotes||"-"})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.productSpcl1}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.productSpcl2}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",style:{width:"400px"},children:e.jsx("div",{className:"line-clamp-2",children:m.productSpcl3})}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.inspection}),e.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900",children:m.painting}),e.jsx("td",{className:"px-3 py-2 text-center text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block group",children:[e.jsx(ee,{size:"sm",variant:"ghost",title:m.remarks||"Add / Edit Remarks",className:`h-7 w-7 p-0 ${m.remarks?.trim()?"bg-[#174a9f] hover:bg-[#123a7f]":"hover:bg-[#d1e2f3]"}`,onClick:()=>je(m),children:e.jsx(is,{className:`h-4 w-4 ${m.remarks?.trim()?"text-white":"text-blue-600"}`})}),m.remarks?.trim()&&e.jsx("div",{className:`\r
                                  absolute bottom-full left-1/2 -translate-x-1/2 mb-2\r
                                  hidden group-hover:block\r
                                  bg-gray-900 text-white text-xs\r
                                  px-3 py-2 rounded-md shadow-lg\r
                                  max-w-[260px] break-words z-[999]\r
                                `,children:m.remarks})]})}),e.jsx("td",{className:"sticky right-0 z-10 bg-white group-hover:bg-gray-50 px-3 py-2 whitespace-nowrap border-l border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ee,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-blue-100",title:"View Details",onClick:()=>de(m),children:e.jsx(Hr,{className:"h-4 w-4 text-blue-600"})}),e.jsx(ee,{disabled:!0,size:"sm",variant:"ghost",className:"h-7 w-7 p-0 hover:bg-green-100",title:"Assign Next",onClick:()=>ir(m),children:e.jsx(Is,{className:"h-4 w-4 text-green-600"})}),e.jsx(ee,{size:"sm",variant:"ghost",className:`h-7 w-7 p-0 transition-all duration-200 ${m.alertStatus?"bg-red-100 border border-red-200 shadow-sm":"hover:bg-red-50"}`,title:"Urgent status is read-only",disabled:!0,children:e.jsx(gr,{className:`h-4 w-4 ${m.alertStatus?"text-red-600 animate-siren-pulse":"text-gray-400"}`})})]})})]},m.splittedCode||m.split_id||m.uniqueCode||m.id))})]}),Pt.length===0&&e.jsx("div",{className:"p-6 text-center text-gray-500",children:"No orders found."})]})})})}),_e.count>0&&e.jsxs("div",{className:"border-t bg-gray-50 px-6 py-3 flex flex-wrap gap-6 justify-end text-sm font-semibold",children:[e.jsxs("div",{children:["Selected Rows:"," ",e.jsx("span",{className:"text-blue-700",children:_e.count})]}),e.jsxs("div",{children:["Total Qty:"," ",e.jsx("span",{className:"text-gray-900",children:_e.qty})]}),e.jsxs("div",{children:["Qty Executed:"," ",e.jsx("span",{className:"text-green-700",children:_e.qtyExe})]}),e.jsxs("div",{children:["Qty Pending:"," ",e.jsx("span",{className:"text-red-600",children:_e.qtyPending})]})]}),e.jsx(os,{page:j,perPage:k,total:Pt.length,lastPage:Math.max(1,Math.ceil(Pt.length/Math.max(k,1))),onChangePage:C,onChangePerPage:S,disabled:f}),e.jsx(Ot,{open:ne,onOpenChange:ve,children:e.jsxs(Tt,{className:"sm:max-w-[500px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Quick Assign Order"}),e.jsxs(Ft,{children:["Assign ",fe?.uniqueCode," to the next workflow step"]})]}),e.jsx("div",{className:"space-y-6 py-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignStep",children:"Assign to Workflow Step"}),e.jsxs(ts,{value:Le,onValueChange:De,children:[e.jsx(ss,{id:"assignStep",children:e.jsx(rs,{placeholder:"Select next step"})}),e.jsx(ns,{children:nr.map(m=>e.jsx(Pr,{value:m,children:nt(m)},m))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"assignQty",children:"Quantity"}),e.jsx(Xr,{id:"assignQty",type:"number",value:Ve,onChange:m=>tt(m.target.value),max:fe?.qtyPending,disabled:!0})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Available Quantity:"," ",e.jsx("span",{className:"font-medium text-gray-900",children:fe?.qtyPending})]})]})}),ge&&e.jsx("div",{className:`p-3 mt-3 rounded-md text-sm ${ge.type==="success"?"bg-green-50 text-green-700 border border-green-200":ge.type==="error"?"bg-red-50 text-red-700 border border-red-200":"bg-blue-50 text-blue-700 border border-blue-200"}`,children:ge.message.split(`
`).map((m,v)=>e.jsx("div",{children:m},v))}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:V,disabled:T,children:"Cancel"}),e.jsx(ee,{onClick:P,disabled:T,className:"bg-black hover:bg-gray-800 text-white",children:T?"Assigning...":"Assign"})]})]})}),e.jsx(Ot,{open:mt,onOpenChange:xe,children:e.jsxs(Tt,{className:"!max-w-[700px] max-h-[90vh] overflow-y-auto dialog-content-wrp",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{className:"text-lg font-semibold text-gray-900",children:"Bin Card Preview"}),e.jsx(Ft,{className:"text-sm text-gray-500",children:"This preview matches the printed bin card layout."})]}),e.jsx("div",{className:"py-6 space-y-8",children:ae.map(m=>e.jsxs("div",{className:"mx-auto w-full max-w-[640px] rounded-[16px] border-2 border-black bg-white px-6 py-5 dialog-inline",children:[e.jsx("h1",{className:"text-center text-lg font-bold",children:"G M Valve Pvt. Ltd."}),e.jsx("p",{className:"mt-1 text-center text-[11px] leading-tight",children:"Plot no. 2732-33, Road No. 1-1, Kranti Gate, G.I.D.C. Lodhika, Village Metoda, Dist. Rajkot-360 021"}),e.jsx("div",{className:"mt-3 border-y-2 border-black py-1 text-center text-sm font-semibold",children:"In Process Material Tag"}),e.jsxs("div",{className:"mt-3 grid grid-cols-3 items-start text-sm",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",m.assemblyDate]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"SOA:"})," ",String(m.gmsoaNo).replace(/^SOA/i,""),"-",m.soaSrNo]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("span",{className:"border-2 border-black px-3 py-1 text-sm font-semibold",children:["Assembly Line: ",m.assemblyLine]})}),e.jsxs("div",{className:"text-right text-xs leading-tight",children:[e.jsx("div",{children:"GMV-L4-F-PRD 01 A"}),e.jsx("div",{children:"(02/10.09.2020)"})]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Party:"}),e.jsx("div",{className:"mt-1",children:m.party})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-start",children:[e.jsx("span",{className:"font-semibold",children:"Item:"}),e.jsx("div",{className:"mt-1 leading-snug",children:m.product})]}),e.jsxs("div",{className:"mt-4 flex justify-between text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"QTY:"})," ",m.qty]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Logo:"})," ",m.gmLogo]})]}),e.jsxs("div",{className:"mt-4 text-sm flex gap-2 items-center",children:[e.jsx("span",{className:"font-semibold",children:"Special Note:"}),e.jsx("div",{className:"mt-1 h-5",children:m.specialNotes||""})]}),e.jsxs("div",{className:"mt-6 inspected text-sm",children:[e.jsx("span",{className:"font-semibold",children:"Inspected by:"}),e.jsx("div",{className:"mt-1 h-6 border-b border-black"})]})]},m.id))}),e.jsxs("div",{className:"flex justify-end gap-3 border-t pt-4",children:[e.jsx(ee,{variant:"outline",onClick:()=>xe(!1),children:"Cancel"}),e.jsxs(ee,{onClick:K,className:"flex items-center gap-2 bg-gradient-to-r from-[#174a9f] to-[#1a5cb8] hover:from-[#123a80] hover:to-[#174a9f] text-white shadow-md",children:[e.jsx(xr,{className:"h-4 w-4"}),"Print"]})]})]})}),e.jsx(Ot,{open:Ge,onOpenChange:ot,children:e.jsxs(Tt,{className:"sm:max-w-[900px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Order Details"}),e.jsxs(Ft,{children:["Complete information for ",et?.uniqueCode]})]}),et&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-blue-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Line"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.assemblyLine})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"SOA No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.gmsoaNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Sr. No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.soaSrNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Assembly Date"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.assemblyDate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Unique Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.uniqueCode})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Splitted Code"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.splittedCode||"-"})]})]})]}),e.jsxs("div",{className:"bg-green-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Customer & Product Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Party"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.party})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Customer PO No."}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.customerPoNo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Code No"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.codeNo})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.product})]})]})]}),e.jsxs("div",{className:"bg-purple-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Quantity Information"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.totalQty})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Exe."}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.qtyExe})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Qty Pending"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.qtyPending})]})]})]}),e.jsxs("div",{className:"bg-amber-50/50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Product Specifications"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Finished Valve"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.finishedValve||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"GM Logo"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.gmLogo})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Name Plate"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.namePlate})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL1"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.productSpcl1||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL2"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.productSpcl2||"-"})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Special notes"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.specialNotes||"-"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Product SPCL3"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.productSpcl3||"-"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Inspection"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.inspection})]}),e.jsxs("div",{children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Painting"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.painting})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(L,{className:"text-gray-500 text-sm",children:"Remarks"}),e.jsx("p",{className:"text-gray-900 mt-1",children:et.remarks||"No remarks"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-gray-100",children:e.jsx(ee,{variant:"outline",onClick:()=>ot(!1),children:"Close"})})]})}),e.jsx(Ot,{open:It,onOpenChange:yt,children:e.jsxs(Tt,{className:"sm:max-w-[600px]",children:[e.jsxs(Rt,{children:[e.jsx(Dt,{children:"Add/Edit Remarks"}),e.jsx(Ft,{children:St?`Order: ${St.uniqueCode}`:""})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(L,{htmlFor:"remarks",children:"Remarks"}),e.jsx(ds,{id:"remarks",placeholder:"Enter remarks...",value:Yt,onChange:m=>te(m.target.value),rows:6,className:"resize-none"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[e.jsx(ee,{variant:"outline",onClick:()=>yt(!1),children:"Cancel"}),e.jsx(ee,{onClick:Me,className:"bg-blue-600 text-white",children:"Save Remarks"})]})]})})]})]})}function e$(){return e.jsx(S4,{children:e.jsx(c3,{children:e.jsxs("div",{className:"relative min-h-screen",children:[e.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-slate-50 via-blue-50/30 to-indigo-100/40 -z-10",children:[e.jsx("div",{className:"absolute top-0 right-0 w-[600px] h-[600px] bg-gradient-to-bl from-[#174a9f]/10 via-indigo-300/5 to-transparent rounded-full blur-3xl animate-pulse-soft"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-[500px] h-[500px] bg-gradient-to-tr from-purple-300/5 via-blue-300/5 to-transparent rounded-full blur-3xl animate-pulse-soft",style:{animationDelay:"1s"}})]}),e.jsxs(B_,{children:[e.jsx(Br,{path:"/svs-stock",element:e.jsx(Yz,{})}),e.jsx(Br,{path:"/packaging",element:e.jsx(Xz,{})}),e.jsx(Br,{path:"/testing-assembly",element:e.jsx(xs,{allowedRole:"assembly-shared",children:e.jsx(Jz,{})})}),e.jsx(Br,{path:"/testing-assembly-2",element:e.jsx(xs,{allowedRole:"assembly-shared",children:e.jsx(Zz,{})})}),e.jsx(Br,{path:"/login",element:e.jsx(j4,{})}),e.jsx(Br,{path:"/dashboard",element:e.jsx(k4,{children:e.jsx(lk,{})})}),e.jsx(Br,{path:"/planning",element:e.jsx(xs,{allowedRole:"planning",children:e.jsx(Hz,{})})}),e.jsx(Br,{path:"/material-issue",element:e.jsx(xs,{allowedRole:"material-issue",children:e.jsx(rf,{})})}),e.jsx(Br,{path:"/semi-qc",element:e.jsx(xs,{allowedRole:"semi-qc",children:e.jsx(sf,{})})}),e.jsx(Br,{path:"/assembly-b",element:e.jsx(xs,{allowedRole:"assembly-b",children:e.jsx(lf,{})})}),e.jsx(Br,{path:"/phosphating",element:e.jsx(xs,{allowedRole:"phosphating",children:e.jsx(nf,{})})}),e.jsx(Br,{path:"/assembly-a",element:e.jsx(xs,{allowedRole:"assembly-a",children:e.jsx(af,{})})}),e.jsx(Br,{path:"/assembly-c",element:e.jsx(xs,{allowedRole:"assembly-c",children:e.jsx(of,{})})}),e.jsx(Br,{path:"/assembly-d",element:e.jsx(xs,{allowedRole:"assembly-d",children:e.jsx(cf,{})})}),e.jsx(Br,{path:"/testing1",element:e.jsx(xs,{allowedRole:"testing1",children:e.jsx(df,{})})}),e.jsx(Br,{path:"/testing2",element:e.jsx(xs,{allowedRole:"testing2",children:e.jsx(uf,{})})}),e.jsx(Br,{path:"/marking1",element:e.jsx(xs,{allowedRole:"marking1",children:e.jsx(mf,{})})}),e.jsx(Br,{path:"/marking2",element:e.jsx(xs,{allowedRole:"marking2",children:e.jsx(pf,{})})}),e.jsx(Br,{path:"/svs",element:e.jsx(xs,{allowedRole:"svs",children:e.jsx(xf,{})})}),e.jsx(Br,{path:"/pdi1",element:e.jsx(xs,{allowedRole:"pdi1",children:e.jsx(hf,{})})}),e.jsx(Br,{path:"/pdi2",element:e.jsx(xs,{allowedRole:"pdi2",children:e.jsx(ff,{})})}),e.jsx(Br,{path:"/tpi",element:e.jsx(xs,{allowedRole:"tpi",children:e.jsx(gf,{})})}),e.jsx(Br,{path:"/dispatch",element:e.jsx(xs,{allowedRole:"dispatch",children:e.jsx(yf,{})})}),e.jsx(Br,{path:"/customer-support",element:e.jsx(xs,{allowedRole:"customer-support",children:e.jsx(ok,{})})}),e.jsx(Br,{path:"*",element:e.jsx(Pu,{to:"/login",replace:!0})})]})]})})})}KC.createRoot(document.getElementById("root")).render(e.jsx(e$,{}));export{Xd as c,a1 as g};
